{
  "edge_schema": {
    "dim": 530,
    "module": "edge/edge_plus_min_agg_lap_hybrid/v1",
    "variant": "edge_plus_min_agg_topo/lean",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "include_cosine": true,
      "include_minmax": false,
      "include_norms": true,
      "jobs": 16,
      "scale_histogram": true,
      "variant": "lean"
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/lapl_edge_min_lean_10A/graph_data/graph_metadata.json",
    "alias": "Legacy 11D Edge + 519D {(hist + agg + norms + cosine) from 172D laplacian_hybrid} = Edge 530D (Lean)",
    "jobs": 16,
    "summary": "Legacy 11D histogram + hybrid topo concat/abs-diff (PH+Lap 172D)."
  },
  "node_schema": {
    "columns": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1",
      "SS8_2",
      "SS8_3",
      "SS8_4",
      "SS8_5",
      "SS8_6",
      "SS8_7",
      "AA_0",
      "AA_1",
      "AA_2",
      "AA_3",
      "AA_4",
      "AA_5",
      "AA_6",
      "AA_7",
      "AA_8",
      "AA_9",
      "AA_10",
      "AA_11",
      "AA_12",
      "AA_13",
      "AA_14",
      "AA_15",
      "AA_16",
      "AA_17",
      "AA_18",
      "AA_19",
      "AA_20",
      "f0_C_death_sum",
      "f0_C_death_min",
      "f0_C_death_max",
      "f0_C_death_mean",
      "f0_C_death_std",
      "f0_N_death_sum",
      "f0_N_death_min",
      "f0_N_death_max",
      "f0_N_death_mean",
      "f0_N_death_std",
      "f0_O_death_sum",
      "f0_O_death_min",
      "f0_O_death_max",
      "f0_O_death_mean",
      "f0_O_death_std",
      "f0_CN_death_sum",
      "f0_CN_death_min",
      "f0_CN_death_max",
      "f0_CN_death_mean",
      "f0_CN_death_std",
      "f0_CO_death_sum",
      "f0_CO_death_min",
      "f0_CO_death_max",
      "f0_CO_death_mean",
      "f0_CO_death_std",
      "f0_NO_death_sum",
      "f0_NO_death_min",
      "f0_NO_death_max",
      "f0_NO_death_mean",
      "f0_NO_death_std",
      "f0_CNO_death_sum",
      "f0_CNO_death_min",
      "f0_CNO_death_max",
      "f0_CNO_death_mean",
      "f0_CNO_death_std",
      "f1_C_len_sum",
      "f1_C_len_min",
      "f1_C_len_max",
      "f1_C_len_mean",
      "f1_C_len_std",
      "f1_C_birth_sum",
      "f1_C_birth_min",
      "f1_C_birth_max",
      "f1_C_birth_mean",
      "f1_C_birth_std",
      "f1_C_death_sum",
      "f1_C_death_min",
      "f1_C_death_max",
      "f1_C_death_mean",
      "f1_C_death_std",
      "f1_N_len_sum",
      "f1_N_len_min",
      "f1_N_len_max",
      "f1_N_len_mean",
      "f1_N_len_std",
      "f1_N_birth_sum",
      "f1_N_birth_min",
      "f1_N_birth_max",
      "f1_N_birth_mean",
      "f1_N_birth_std",
      "f1_N_death_sum",
      "f1_N_death_min",
      "f1_N_death_max",
      "f1_N_death_mean",
      "f1_N_death_std",
      "f1_O_len_sum",
      "f1_O_len_min",
      "f1_O_len_max",
      "f1_O_len_mean",
      "f1_O_len_std",
      "f1_O_birth_sum",
      "f1_O_birth_min",
      "f1_O_birth_max",
      "f1_O_birth_mean",
      "f1_O_birth_std",
      "f1_O_death_sum",
      "f1_O_death_min",
      "f1_O_death_max",
      "f1_O_death_mean",
      "f1_O_death_std",
      "f1_CN_len_sum",
      "f1_CN_len_min",
      "f1_CN_len_max",
      "f1_CN_len_mean",
      "f1_CN_len_std",
      "f1_CN_birth_sum",
      "f1_CN_birth_min",
      "f1_CN_birth_max",
      "f1_CN_birth_mean",
      "f1_CN_birth_std",
      "f1_CN_death_sum",
      "f1_CN_death_min",
      "f1_CN_death_max",
      "f1_CN_death_mean",
      "f1_CN_death_std",
      "f1_CO_len_sum",
      "f1_CO_len_min",
      "f1_CO_len_max",
      "f1_CO_len_mean",
      "f1_CO_len_std",
      "f1_CO_birth_sum",
      "f1_CO_birth_min",
      "f1_CO_birth_max",
      "f1_CO_birth_mean",
      "f1_CO_birth_std",
      "f1_CO_death_sum",
      "f1_CO_death_min",
      "f1_CO_death_max",
      "f1_CO_death_mean",
      "f1_CO_death_std",
      "f1_NO_len_sum",
      "f1_NO_len_min",
      "f1_NO_len_max",
      "f1_NO_len_mean",
      "f1_NO_len_std",
      "f1_NO_birth_sum",
      "f1_NO_birth_min",
      "f1_NO_birth_max",
      "f1_NO_birth_mean",
      "f1_NO_birth_std",
      "f1_NO_death_sum",
      "f1_NO_death_min",
      "f1_NO_death_max",
      "f1_NO_death_mean",
      "f1_NO_death_std",
      "f1_CNO_len_sum",
      "f1_CNO_len_min",
      "f1_CNO_len_max",
      "f1_CNO_len_mean",
      "f1_CNO_len_std",
      "f1_CNO_birth_sum",
      "f1_CNO_birth_min",
      "f1_CNO_birth_max",
      "f1_CNO_birth_mean",
      "f1_CNO_birth_std",
      "f1_CNO_death_sum",
      "f1_CNO_death_min",
      "f1_CNO_death_max",
      "f1_CNO_death_mean",
      "f1_CNO_death_std",
      "lap_num_nodes",
      "lap_eig_01",
      "lap_eig_02",
      "lap_eig_03",
      "lap_eig_04",
      "lap_eig_05",
      "lap_eig_06",
      "lap_eig_07",
      "lap_eig_08",
      "lap_eig_09",
      "lap_eig_10",
      "lap_eig_11",
      "lap_eig_12",
      "lap_eig_13",
      "lap_eig_14",
      "lap_eig_15",
      "lap_eig_16",
      "lap_lambda_min",
      "lap_lambda_max",
      "lap_lambda_2",
      "lap_lambda_mean",
      "lap_lambda_var",
      "lap_spectral_radius",
      "lap_condition_guarded",
      "lap_entropy",
      "lap_moment_k1_0",
      "lap_moment_k2_0",
      "lap_moment_k3_0",
      "lap_moment_k4_0",
      "lap_heat_t0_1",
      "lap_heat_t1_0",
      "lap_heat_t5_0"
    ],
    "dim": 204,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/lapl_edge_min_lean_10A/graph_data/graph_metadata.json"
  },
  "module_registry": {
    "edge": {
      "alias": "Legacy 11D Edge + 519D {(hist + agg + norms + cosine) from 172D laplacian_hybrid} = Edge 530D (Lean)",
      "defaults": {
        "distance_max": 10.0,
        "distance_min": 0.0,
        "include_cosine": true,
        "include_minmax": false,
        "include_norms": true,
        "jobs": 16,
        "scale_histogram": true,
        "variant": "lean"
      },
      "description": "Same aggregation as edge_plus_min_agg_topo/v1, intended for use with topology/persistence_laplacian_hybrid/v1 (per-residue PH + Laplacian vectors, expected topo_dim\u2248172). Concatenates (u_topo, v_topo, |u-v|) and optional norms/cosine; heavy variant adds min/max. Prepends the legacy 11D distance histogram and preserves deterministic edge ordering (src_idx, dst_idx, distance).",
      "id": "edge/edge_plus_min_agg_lap_hybrid/v1",
      "inputs": [
        "interface_residues",
        "pdb_structure",
        "topology_csv"
      ],
      "jobs": 16,
      "kind": "edge",
      "notes": {
        "expected_topology_dim": 172
      },
      "outputs": [
        "edge_index",
        "edge_attr"
      ],
      "parameters": {
        "distance_max": "Maximum interface C\u03b1 distance (\u00c5) to include an edge.",
        "distance_min": "Minimum interface C\u03b1 distance (\u00c5) to include an edge.",
        "include_cosine": "Include cosine similarity between endpoint topology vectors.",
        "include_minmax": "Include per-dimension min/max across endpoints (used by heavy variant).",
        "include_norms": "Include L2 norms of endpoint topology vectors.",
        "jobs": "Optional override for edge assembly worker count.",
        "scale_histogram": "Apply MinMax scaling across the legacy distance + histogram block only.",
        "variant": "Aggregation variant: lean (default) or heavy (adds min/max block)."
      },
      "summary": "Legacy 11D histogram + hybrid topo concat/abs-diff (PH+Lap 172D)."
    },
    "interface": {
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "defaults": {
        "coordinate_decimals": -1,
        "cutoff": 10.0,
        "jobs": 16
      },
      "description": "Identifies interface residues across chains using the polar interface routine (new_calculate_interface.process_pdb_file) with configurable distance cutoff and coordinate rounding.",
      "id": "interface/polar_cutoff/v1",
      "inputs": [
        "pdb_file"
      ],
      "jobs": 16,
      "kind": "interface",
      "notes": {},
      "outputs": [
        "interface_file"
      ],
      "parameters": {
        "coordinate_decimals": "Decimal places for coordinate rounding in output files (-1 skips rounding).",
        "cutoff": "Distance cutoff in \u00c5 for interface residue detection.",
        "jobs": "Optional override for parallel worker count."
      },
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "alias": "Passthrough (all dims from topology module) + 32D DSSP = Node Dynamic Dims",
      "defaults": {
        "drop_na": true,
        "jobs": 16
      },
      "description": "Runs DSSP/basic feature extraction and merges with the provided topology CSV using all non-ID topology columns (no hardcoded list). Topology columns are MinMax scaled per file; output columns ordered as ID, DSSP/basic 32D, then topology columns in file order. Suitable for hybrid topology (PH+Lap) or any dynamic topo layout.",
      "id": "node/dssp_topo_merge_passthrough/v1",
      "inputs": [
        "pdb_file",
        "interface_file",
        "topology_csv"
      ],
      "jobs": 16,
      "kind": "node",
      "notes": {},
      "outputs": [
        "node_csv"
      ],
      "parameters": {
        "drop_na": "Drop rows containing NA values after merging.",
        "jobs": "Optional override for thread worker count."
      },
      "summary": "DSSP/basic features merged with all topology columns (passthrough)."
    },
    "topology": {
      "alias": "140D PH (Betti 0 and Betti 1 topology summaries on interface coords) + 32D Laplacian = 172D",
      "defaults": {
        "dedup_sort": false,
        "element_filters": [
          [
            "C"
          ],
          [
            "N"
          ],
          [
            "O"
          ],
          [
            "C",
            "N"
          ],
          [
            "C",
            "O"
          ],
          [
            "N",
            "O"
          ],
          [
            "C",
            "N",
            "O"
          ]
        ],
        "filtration_cutoff": 8.0,
        "jobs": 16,
        "lap_distance_cutoff": null,
        "lap_edge_weight": "gaussian",
        "lap_eigs_count": 16,
        "lap_graph_mode": "cross_chain",
        "lap_heat_times": [
          0.1,
          1.0,
          5.0
        ],
        "lap_include_entropy": true,
        "lap_k_neighbors": null,
        "lap_max_neighbors": 128,
        "lap_moment_orders": [
          1,
          2,
          3,
          4
        ],
        "lap_normalize": "sym",
        "lap_sigma": null,
        "min_persistence": 0.01,
        "neighbor_distance": 8.0
      },
      "description": "Extends the 140D persistent homology descriptors with Laplacian spectral features computed on local interface residue graphs (cross-chain by default). Laplacian block includes per-eigen values, spectral stats, entropy, moments, and heat traces.",
      "id": "topology/persistence_laplacian_hybrid/v1",
      "inputs": [
        "pdb_file",
        "interface_file"
      ],
      "jobs": 16,
      "kind": "topology",
      "notes": {},
      "outputs": [
        "topology_csv"
      ],
      "parameters": {
        "dedup_sort": "Enable deduplication & sorting of persistence pairs.",
        "element_filters": "Sequence of element subsets considered for PH statistics.",
        "filtration_cutoff": "Maximum filtration value in \u00c5 for PH.",
        "jobs": "Optional override for parallel worker count.",
        "lap_distance_cutoff": "\u00c5 radius for Laplacian neighborhood (defaults to neighbor_distance).",
        "lap_edge_weight": "Edge weighting: gaussian (default), inverse, or binary.",
        "lap_eigs_count": "Number of smallest nonzero eigenvalues to keep (padded).",
        "lap_graph_mode": "cross_chain (default) or all to include same-chain neighbors.",
        "lap_heat_times": "List of heat kernel times to emit traces for.",
        "lap_include_entropy": "Include spectral entropy over nonzero eigenvalues.",
        "lap_k_neighbors": "Optional deterministic k-NN cap for Laplacian neighborhood.",
        "lap_max_neighbors": "Cap on Laplacian neighborhood size (includes target residue).",
        "lap_moment_orders": "List of spectral moment orders to emit.",
        "lap_normalize": "sym (default symmetric normalized) or rw (random-walk) Laplacian.",
        "lap_sigma": "Sigma for Gaussian edge weights (defaults to neighbor_distance/2).",
        "min_persistence": "Minimum persistence threshold for PH features.",
        "neighbor_distance": "Neighbourhood radius in \u00c5 for PH computation."
      },
      "summary": "Persistent homology + Laplacian spectral moments per interface residue."
    }
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/lapl_edge_min_lean_10A/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training/training_runs/polish_seed101_2025-12-01_17-16-30/schema_summary.json",
  "notes": [],
  "sample_graph": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/lapl_edge_min_lean_10A/graph_data/19HC/19HC.pt",
  "sample_edge_count": 40,
  "sample_node_count": 10,
  "builder": {
    "command": [
      "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/graph_builder2.py",
      "--pdb-warnings",
      "--no-sort-artifacts",
      "--dataset-dir",
      "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/datasets/training/adjusted/Dockground_MAF2",
      "--work-dir",
      "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/lapl_edge_min_lean_10A/work",
      "--graph-dir",
      "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/lapl_edge_min_lean_10A/graph_data",
      "--log-dir",
      "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/logs_output/lapl_edge_min_lean_10A",
      "--jobs",
      "16",
      "--feature-config",
      "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/feature-config.yaml.lapl_edge_min_lean_10A"
    ],
    "edge_dumps": {
      "configured_directory": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/lapl_edge_min_lean_10A/work/edge_features",
      "enabled": true,
      "output_directory": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/lapl_edge_min_lean_10A/work/edge_features"
    },
    "feature_config": {
      "path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/feature-config.yaml.lapl_edge_min_lean_10A",
      "sha256": "0ce961a4d62a453cab5fdf4463ac2f1418cb00d73312c8ae02acb03498f629af",
      "text": "# Auto-generated feature-config template\n# Pick one module per required stage. Edit parameter values as needed.\n# Run `./run_graph_builder2.sh --list-modules` for detailed descriptions.\ndefaults:\n  jobs: 16  # Optional global worker override; remove if unused.\n\n# REQUIRED stage: interface\ninterface:\n  module: interface/polar_cutoff/v1  # alias: n x 3D TopoQA default 10A cutoff\n  alias: \"residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA\"\n  summary: \"Polar interface detection using distance cutoff.\"\n  description: \"Identifies interface residues across chains using the polar interface routine (new_calculate_interface.process_pdb_file) with configurable distance cutoff and coordinate rounding.\"\n  params:\n    cutoff: 10.0\n    coordinate_decimals: -1  # skip rounding to keep raw coords\n    jobs: 16\n\n# OPTIONAL stage: topology\ntopology:\n  module: topology/persistence_laplacian_hybrid/v1  # alias: 140D topology + 32D Laplacian\n  alias: \"140D PH (Betti 0 and Betti 1 topology summaries on interface coords) + 32D Laplacian = 172D\"\n  summary: \"Persistent homology + Laplacian spectral moments per interface residue.\"\n  description: \"Extends the 140D persistent homology descriptors with Laplacian spectral features computed on local interface residue graphs (cross-chain by default). Laplacian block includes per-eigen values, spectral stats, entropy, moments, and heat traces.\"\n  params:\n    neighbor_distance: 8.0\n    filtration_cutoff: 8.0\n    min_persistence: 0.01\n    dedup_sort: false\n    element_filters:\n      - [C]\n      - [N]\n      - [O]\n      - [C, N]\n      - [C, O]\n      - [N, O]\n      - [C, N, O]\n    lap_graph_mode: cross_chain  # cross_chain (default) or all to include same-chain neighbors\n    lap_distance_cutoff: 8.0\n    lap_k_neighbors: null  # optional deterministic k-NN cap; otherwise cutoff-based\n    lap_edge_weight: gaussian  # gaussian (default, sigma ~ neighbor_distance/2), inverse, or binary\n    lap_sigma: 4.0\n    lap_eigs_count: 16\n    lap_moment_orders: [1, 2, 3, 4]\n    lap_heat_times: [0.1, 1.0, 5.0]\n    lap_include_entropy: true\n    lap_max_neighbors: 128  # cap neighborhood size (includes target residue)\n    lap_normalize: sym\n    jobs: 16\n\n# REQUIRED stage: node\nnode:\n  module: node/dssp_topo_merge_passthrough/v1  # alias: Passthrough (all dims from topology module) + 32D DSSP = Node Dynamic Dims\n  alias: \"Passthrough (all dims from topology module) + 32D DSSP = Node Dynamic Dims\"\n  summary: \"DSSP/basic features merged with all topology columns (passthrough).\"\n  description: \"Runs DSSP/basic feature extraction and merges with the provided topology CSV using all non-ID topology columns (no hardcoded list). Topology columns are MinMax scaled per file; output columns ordered as ID, DSSP/basic 32D, then topology columns in file order. Suitable for hybrid topology (PH+Lap) or any dynamic topo layout.\"\n  params:\n    drop_na: true  # matches fea_df_clean = fea_df.dropna() in both inference_model.py and k_mac_inference_pca_tsne4.py\n    jobs: 16\n\n# REQUIRED stage: edge\nedge:\n  module: edge/edge_plus_min_agg_lap_hybrid/v1  # alias: 11D Legacy + hybrid topo (PH+Lap 172D)\n  alias: \"Legacy 11D Edge + 519D {(hist + agg + norms + cosine) from 172D laplacian_hybrid} = Edge 530D (Lean)\"\n  summary: \"Legacy 11D histogram + hybrid topo concat/abs-diff (PH+Lap 172D).\"\n  description: \"Same aggregation as edge_plus_min_agg_topo/v1, intended for use with topology/persistence_laplacian_hybrid/v1 (per-residue PH + Laplacian vectors, expected topo_dim\\u2248172). Concatenates (u_topo, v_topo, |u-v|) and optional norms/cosine; heavy variant adds min/max. Prepends the legacy 11D distance histogram and preserves deterministic edge ordering (src_idx, dst_idx, distance).\"\n  params:\n    distance_min: 0.0\n    distance_max: 10.0\n    scale_histogram: true\n    include_norms: true\n    include_cosine: true\n    include_minmax: false  # heavy variant only; adds per-dimension min/max blocks\n    variant: lean  # lean or heavy\n    jobs: 16\n"
    },
    "id": "graph_builder2",
    "module": "qtdaqa.new_dynamic_features.graph_builder2.graph_builder2",
    "options": {
      "default_jobs": 16,
      "edge_dump": true
    },
    "schema_version": 1,
    "version": "2.0.0"
  },
  "topology_schema": {}
}