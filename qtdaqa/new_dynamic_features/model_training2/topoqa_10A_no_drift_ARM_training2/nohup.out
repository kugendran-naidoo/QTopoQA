Skipped Validating graphs using standalone tool ...
Starting model training ...
[run_full_pipeline] Validating graphs before training...
[validate_graphs] OK: validated 14391 graph(s) in /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data
[run_full_pipeline] Starting sweep at 2025-12-22T16:26:35.282134+00:00 using manifest /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/manifests/run_lean.yaml
[train_cli][batch] (1/3) running job 'sched_boost_lean_seed222' -> run_name=sched_boost_lean_seed222_2025-12-22_16-26-35
[train_cli] run_id=sched_boost_lean_seed222_2025-12-22_16-26-35 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-22_16-26-35/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-22_16-26-35 --git-commit 150d1dcbd1 --git-dirty
2025-12-22 16:26:38 INFO git_commit = 150d1dcbd1 (dirty)
2025-12-22 16:26:38 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-22 16:26:38 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-22_16-26-35/config/config.yaml
2025-12-22 16:26:38 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data
2025-12-22 16:26:38 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-22 16:26:38 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-22 16:26:38 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-22_16-26-35
2025-12-22 16:26:38 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-22 16:26:38 INFO   metadata_path = None
2025-12-22 16:26:38 INFO   summary_path = None
2025-12-22 16:26:38 INFO   accelerator = cpu
2025-12-22 16:26:38 INFO   devices = 1
2025-12-22 16:26:38 INFO   attention_head = 8
2025-12-22 16:26:38 INFO   pooling_type = mean
2025-12-22 16:26:38 INFO   model_self_loops = False
2025-12-22 16:26:38 INFO   model_self_loop_fill = mean
2025-12-22 16:26:38 INFO   model_residual = False
2025-12-22 16:26:38 INFO   batch_size = 48
2025-12-22 16:26:38 INFO   learning_rate = 0.005
2025-12-22 16:26:38 INFO   num_epochs = 140
2025-12-22 16:26:38 INFO   accumulate_grad_batches = 8
2025-12-22 16:26:38 INFO   seed = 222
2025-12-22 16:26:38 INFO   num_workers = 2
2025-12-22 16:26:38 INFO   precision = 32
2025-12-22 16:26:38 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-22 16:26:38 INFO   early_stopping_patience = 24
2025-12-22 16:26:38 INFO   lr_scheduler_patience = 6
2025-12-22 16:26:38 INFO   lr_scheduler_factor = 0.2
2025-12-22 16:26:38 INFO   fast_dev_run = False
2025-12-22 16:26:38 INFO   limit_train_batches = None
2025-12-22 16:26:38 INFO   limit_val_batches = None
2025-12-22 16:26:38 INFO   log_lr = False
2025-12-22 16:26:38 INFO   progress_bar_refresh_rate = 0
2025-12-22 16:26:38 INFO   log_every_n_steps = 100
2025-12-22 16:26:38 INFO   use_val_spearman_as_secondary = True
2025-12-22 16:26:38 INFO   spearman_secondary_min_delta = 0.0
2025-12-22 16:26:38 INFO   spearman_secondary_weight = 1.0
2025-12-22 16:26:38 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-22 16:26:38 INFO   tuning_max_samples = 500
2025-12-22 16:26:38 INFO   tuning_fraction = None
2025-12-22 16:26:38 INFO   tuning_eval_every = 1
2025-12-22 16:26:38 INFO   rank_loss_weight = 0.0
2025-12-22 16:26:38 INFO   rank_loss_margin = 0.0
2025-12-22 16:26:38 INFO   rank_loss_mode = hinge
2025-12-22 16:26:38 INFO   rank_loss_grouped = True
2025-12-22 16:26:38 INFO   variance_reduction_enabled = False
2025-12-22 16:26:38 INFO   variance_reduction_method = topk_avg
2025-12-22 16:26:38 INFO   variance_reduction_top_k = 3
2025-12-22 16:26:38 INFO   coverage_minimum = 0.0
2025-12-22 16:26:38 INFO   coverage_fail_on_missing = False
2025-12-22 16:26:38 INFO   graph_load_profiling = False
2025-12-22 16:26:38 INFO   graph_load_top_k = 5
2025-12-22 16:26:38 INFO   enable_graph_cache = True
2025-12-22 16:26:38 INFO   graph_cache_size = 256
2025-12-22 16:26:38 INFO   canonicalize_on_load = False
2025-12-22 16:26:38 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-22 16:26:38 INFO   edge_schema = {}
2025-12-22 16:26:38 INFO   topology_schema = {}
Seed set to 222
2025-12-22 16:26:38 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-22 16:26:38 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 16:26:38 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-22 16:26:38 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 16:26:38 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-22 16:26:38 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 16:26:39 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-22 16:26:39 INFO Tuning group stats: groups=352 groups>=2=34 singletons=318 max_group=11
2025-12-22 16:26:39 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-22_16-26-35/dataset_coverage.json
2025-12-22 16:26:39 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-22_16-26-35/dataset_coverage.json for details.
2025-12-22 16:26:39 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-22_16-26-35/dataset_coverage.json for details.
2025-12-22 16:26:39 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-22_16-26-35/dataset_coverage.json for details.
2025-12-22 16:26:39 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-22_16-26-35/schema_summary.json
2025-12-22 16:26:39 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-22_16-26-35/feature_metadata.json
2025-12-22 16:26:39 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-22 16:26:39 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/feature-config.yaml.topoqa.10A.2, sha256=5c62898155179232a565e24d9fbd7b208f9ce480d1a19d6139de19454e173ff0
2025-12-22 16:26:39 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/work/edge_features)
2025-12-22 16:26:39 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json
2025-12-22 16:26:39 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-22_16-26-35/schema_summary.json
2025-12-22 16:26:39 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-22 16:26:39 INFO Topology: topology/persistence_basic/v1 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 172-dimensional node features.
2025-12-22 16:26:39 INFO Node: node/dssp_topo_merge/v1; metadata lists 172 feature columns matching the .pt tensor.
2025-12-22 16:26:39 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-22 16:26:39 INFO → Total feature dimensionality observed and confirmed: node_dim = 172, edge_dim = 11.
2025-12-22 16:26:39 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-22 16:26:39 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 172,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 172,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-22_16-26-35/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge/v1",
      "alias": "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA",
      "jobs": 16,
      "summary": "DSSP-derived node features merged with topology statistics."
    },
    "topology": {
      "id": "topology/persistence_basic/v1",
      "alias": "Betti 0 and Betti 1 topology summaries on interface coords = 140D PH | TopoQA",
      "jobs": 16,
      "summary": "Persistent homology features with configurable distance thresholds."
    }
  },
  "notes": []
}
2025-12-22 16:26:39 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-22 16:26:40 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=bff0319027e246fdae1c4d3c40941c51)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-22 16:26:40 INFO Starting training (fast_dev_run=False)
2025-12-22 16:26:40 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-22_16-26-35/model_checkpoints exists and is not empty.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 5.5 K  | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
165 K     Trainable params
0         Non-trainable params
165 K     Total params
0.662     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-22 16:26:54 INFO Epoch 000 | 25% complete (batch 46/181)
2025-12-22 16:26:55 INFO Epoch 000 | 50% complete (batch 91/181)
2025-12-22 16:26:56 INFO Epoch 000 | 75% complete (batch 136/181)
2025-12-22 16:27:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.140718
2025-12-22 16:27:10 INFO Tuning ranking metrics: regret=0.168534 spearman=-0.212974 (groups=34, skipped=318)
2025-12-22 16:27:10 INFO Epoch 000 | val_loss=0.140718
Metric tuning_rank_spearman improved. New best score: -0.213
2025-12-22 16:27:18 INFO Epoch 001 | 25% complete (batch 46/181)
2025-12-22 16:27:19 INFO Epoch 001 | 50% complete (batch 91/181)
2025-12-22 16:27:20 INFO Epoch 001 | 75% complete (batch 136/181)
2025-12-22 16:27:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.137793
2025-12-22 16:27:34 INFO Tuning ranking metrics: regret=0.160242 spearman=-0.082308 (groups=34, skipped=318)
2025-12-22 16:27:34 INFO Epoch 001 | train_mse=0.144865 | val_loss=0.142340 | best_val_loss=-0.212974
Metric tuning_rank_spearman improved by 0.131 >= min_delta = 0.0. New best score: -0.082
2025-12-22 16:27:42 INFO Epoch 002 | 25% complete (batch 46/181)
2025-12-22 16:27:43 INFO Epoch 002 | 50% complete (batch 91/181)
2025-12-22 16:27:44 INFO Epoch 002 | 75% complete (batch 136/181)
2025-12-22 16:27:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.140757
2025-12-22 16:27:58 INFO Tuning ranking metrics: regret=0.170584 spearman=-0.048810 (groups=34, skipped=318)
2025-12-22 16:27:58 INFO Epoch 002 | train_mse=0.151277 | val_loss=0.140757 | best_val_loss=-0.082308
Metric tuning_rank_spearman improved by 0.033 >= min_delta = 0.0. New best score: -0.049
2025-12-22 16:28:06 INFO Epoch 003 | 25% complete (batch 46/181)
2025-12-22 16:28:07 INFO Epoch 003 | 50% complete (batch 91/181)
2025-12-22 16:28:08 INFO Epoch 003 | 75% complete (batch 136/181)
2025-12-22 16:28:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.140202
2025-12-22 16:28:22 INFO Tuning ranking metrics: regret=0.131508 spearman=-0.043046 (groups=34, skipped=318)
2025-12-22 16:28:22 INFO Epoch 003 | train_mse=0.155567 | val_loss=0.140202 | best_val_loss=-0.048810
Metric tuning_rank_spearman improved by 0.006 >= min_delta = 0.0. New best score: -0.043
2025-12-22 16:28:30 INFO Epoch 004 | 25% complete (batch 46/181)
2025-12-22 16:28:31 INFO Epoch 004 | 50% complete (batch 91/181)
2025-12-22 16:28:32 INFO Epoch 004 | 75% complete (batch 136/181)
2025-12-22 16:28:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.333675
2025-12-22 16:28:46 INFO Tuning ranking metrics: regret=0.141321 spearman=-0.174898 (groups=34, skipped=318)
2025-12-22 16:28:46 INFO Epoch 004 | train_mse=0.145738 | val_loss=0.140524 | best_val_loss=-0.043046
2025-12-22 16:28:55 INFO Epoch 005 | 25% complete (batch 46/181)
2025-12-22 16:28:56 INFO Epoch 005 | 50% complete (batch 91/181)
2025-12-22 16:28:57 INFO Epoch 005 | 75% complete (batch 136/181)
2025-12-22 16:29:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.425419
2025-12-22 16:29:11 INFO Tuning ranking metrics: regret=0.143885 spearman=-0.150497 (groups=34, skipped=318)
2025-12-22 16:29:11 INFO Epoch 005 | train_mse=0.152656 | val_loss=0.136893 | best_val_loss=-0.043046
2025-12-22 16:29:20 INFO Epoch 006 | 25% complete (batch 46/181)
2025-12-22 16:29:21 INFO Epoch 006 | 50% complete (batch 91/181)
2025-12-22 16:29:22 INFO Epoch 006 | 75% complete (batch 136/181)
2025-12-22 16:29:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.488362
2025-12-22 16:29:36 INFO Tuning ranking metrics: regret=0.156104 spearman=0.181825 (groups=34, skipped=318)
2025-12-22 16:29:36 INFO Epoch 006 | train_mse=0.141636 | val_loss=0.141154 | best_val_loss=-0.043046
Metric tuning_rank_spearman improved by 0.225 >= min_delta = 0.0. New best score: 0.182
2025-12-22 16:29:44 INFO Epoch 007 | 25% complete (batch 46/181)
2025-12-22 16:29:45 INFO Epoch 007 | 50% complete (batch 91/181)
2025-12-22 16:29:46 INFO Epoch 007 | 75% complete (batch 136/181)
2025-12-22 16:29:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.204291
2025-12-22 16:30:00 INFO Tuning ranking metrics: regret=0.136743 spearman=0.103692 (groups=34, skipped=318)
2025-12-22 16:30:00 INFO Epoch 007 | train_mse=0.150149 | val_loss=0.141319 | best_val_loss=0.181825
2025-12-22 16:30:09 INFO Epoch 008 | 25% complete (batch 46/181)
2025-12-22 16:30:09 INFO Epoch 008 | 50% complete (batch 91/181)
2025-12-22 16:30:10 INFO Epoch 008 | 75% complete (batch 136/181)
2025-12-22 16:30:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.171882
2025-12-22 16:30:24 INFO Tuning ranking metrics: regret=0.113559 spearman=0.107143 (groups=34, skipped=318)
2025-12-22 16:30:24 INFO Epoch 008 | train_mse=0.140651 | val_loss=0.135347 | best_val_loss=0.181825
2025-12-22 16:30:32 INFO Epoch 009 | 25% complete (batch 46/181)
2025-12-22 16:30:33 INFO Epoch 009 | 50% complete (batch 91/181)
2025-12-22 16:30:34 INFO Epoch 009 | 75% complete (batch 136/181)
2025-12-22 16:30:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.160451
2025-12-22 16:30:49 INFO Tuning ranking metrics: regret=0.177051 spearman=0.050554 (groups=34, skipped=318)
2025-12-22 16:30:49 INFO Epoch 009 | train_mse=0.146430 | val_loss=0.139669 | best_val_loss=0.181825
2025-12-22 16:30:57 INFO Epoch 010 | 25% complete (batch 46/181)
2025-12-22 16:30:58 INFO Epoch 010 | 50% complete (batch 91/181)
2025-12-22 16:30:59 INFO Epoch 010 | 75% complete (batch 136/181)
2025-12-22 16:31:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.126515
2025-12-22 16:31:13 INFO Tuning ranking metrics: regret=0.118578 spearman=-0.052852 (groups=34, skipped=318)
2025-12-22 16:31:13 INFO Epoch 010 | train_mse=0.138100 | val_loss=0.126515 | best_val_loss=0.181825
2025-12-22 16:31:21 INFO Epoch 011 | 25% complete (batch 46/181)
2025-12-22 16:31:22 INFO Epoch 011 | 50% complete (batch 91/181)
2025-12-22 16:31:23 INFO Epoch 011 | 75% complete (batch 136/181)
2025-12-22 16:31:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.273470
2025-12-22 16:31:37 INFO Tuning ranking metrics: regret=0.135612 spearman=0.024058 (groups=34, skipped=318)
2025-12-22 16:31:37 INFO Epoch 011 | train_mse=0.130095 | val_loss=0.139579 | best_val_loss=0.181825
2025-12-22 16:31:45 INFO Epoch 012 | 25% complete (batch 46/181)
2025-12-22 16:31:46 INFO Epoch 012 | 50% complete (batch 91/181)
2025-12-22 16:31:47 INFO Epoch 012 | 75% complete (batch 136/181)
2025-12-22 16:31:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.166269
2025-12-22 16:32:01 INFO Tuning ranking metrics: regret=0.132492 spearman=-0.060453 (groups=34, skipped=318)
2025-12-22 16:32:01 INFO Epoch 012 | train_mse=0.136574 | val_loss=0.133012 | best_val_loss=0.181825
2025-12-22 16:32:09 INFO Epoch 013 | 25% complete (batch 46/181)
2025-12-22 16:32:10 INFO Epoch 013 | 50% complete (batch 91/181)
2025-12-22 16:32:11 INFO Epoch 013 | 75% complete (batch 136/181)
2025-12-22 16:32:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.368485
2025-12-22 16:32:25 INFO Tuning ranking metrics: regret=0.112357 spearman=-0.095690 (groups=34, skipped=318)
2025-12-22 16:32:25 INFO Epoch 013 | train_mse=0.119926 | val_loss=0.127663 | best_val_loss=0.181825
2025-12-22 16:32:33 INFO Epoch 014 | 25% complete (batch 46/181)
2025-12-22 16:32:34 INFO Epoch 014 | 50% complete (batch 91/181)
2025-12-22 16:32:35 INFO Epoch 014 | 75% complete (batch 136/181)
2025-12-22 16:32:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.439173
2025-12-22 16:32:48 INFO Tuning ranking metrics: regret=0.108135 spearman=-0.045003 (groups=34, skipped=318)
2025-12-22 16:32:48 INFO Epoch 014 | train_mse=0.116793 | val_loss=0.109574 | best_val_loss=0.181825
2025-12-22 16:32:57 INFO Epoch 015 | 25% complete (batch 46/181)
2025-12-22 16:32:58 INFO Epoch 015 | 50% complete (batch 91/181)
2025-12-22 16:32:58 INFO Epoch 015 | 75% complete (batch 136/181)
2025-12-22 16:33:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.493973
2025-12-22 16:33:12 INFO Tuning ranking metrics: regret=0.109776 spearman=-0.076229 (groups=34, skipped=318)
2025-12-22 16:33:12 INFO Epoch 015 | train_mse=0.123432 | val_loss=0.106334 | best_val_loss=0.181825
2025-12-22 16:33:21 INFO Epoch 016 | 25% complete (batch 46/181)
2025-12-22 16:33:22 INFO Epoch 016 | 50% complete (batch 91/181)
2025-12-22 16:33:23 INFO Epoch 016 | 75% complete (batch 136/181)
2025-12-22 16:33:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.496606
2025-12-22 16:33:37 INFO Tuning ranking metrics: regret=0.110634 spearman=-0.075847 (groups=34, skipped=318)
2025-12-22 16:33:37 INFO Epoch 016 | train_mse=0.119205 | val_loss=0.073787 | best_val_loss=0.181825
2025-12-22 16:33:45 INFO Epoch 017 | 25% complete (batch 46/181)
2025-12-22 16:33:46 INFO Epoch 017 | 50% complete (batch 91/181)
2025-12-22 16:33:47 INFO Epoch 017 | 75% complete (batch 136/181)
2025-12-22 16:33:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.610721
2025-12-22 16:34:02 INFO Tuning ranking metrics: regret=0.140279 spearman=-0.069780 (groups=34, skipped=318)
2025-12-22 16:34:02 INFO Epoch 017 | train_mse=0.112657 | val_loss=0.092386 | best_val_loss=0.181825
2025-12-22 16:34:10 INFO Epoch 018 | 25% complete (batch 46/181)
2025-12-22 16:34:11 INFO Epoch 018 | 50% complete (batch 91/181)
2025-12-22 16:34:12 INFO Epoch 018 | 75% complete (batch 136/181)
2025-12-22 16:34:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.595816
2025-12-22 16:34:26 INFO Tuning ranking metrics: regret=0.114304 spearman=-0.095474 (groups=34, skipped=318)
2025-12-22 16:34:26 INFO Epoch 018 | train_mse=0.100275 | val_loss=0.119532 | best_val_loss=0.181825
2025-12-22 16:34:35 INFO Epoch 019 | 25% complete (batch 46/181)
2025-12-22 16:34:36 INFO Epoch 019 | 50% complete (batch 91/181)
2025-12-22 16:34:37 INFO Epoch 019 | 75% complete (batch 136/181)
2025-12-22 16:34:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.546479
2025-12-22 16:34:51 INFO Tuning ranking metrics: regret=0.111597 spearman=-0.073408 (groups=34, skipped=318)
2025-12-22 16:34:51 INFO Epoch 019 | train_mse=0.093417 | val_loss=0.119723 | best_val_loss=0.181825
2025-12-22 16:35:00 INFO Epoch 020 | 25% complete (batch 46/181)
2025-12-22 16:35:01 INFO Epoch 020 | 50% complete (batch 91/181)
2025-12-22 16:35:01 INFO Epoch 020 | 75% complete (batch 136/181)
2025-12-22 16:35:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.545118
2025-12-22 16:35:16 INFO Tuning ranking metrics: regret=0.112180 spearman=-0.058429 (groups=34, skipped=318)
2025-12-22 16:35:16 INFO Epoch 020 | train_mse=0.090404 | val_loss=0.082016 | best_val_loss=0.181825
2025-12-22 16:35:24 INFO Epoch 021 | 25% complete (batch 46/181)
2025-12-22 16:35:25 INFO Epoch 021 | 50% complete (batch 91/181)
2025-12-22 16:35:26 INFO Epoch 021 | 75% complete (batch 136/181)
2025-12-22 16:35:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.589272
2025-12-22 16:35:40 INFO Tuning ranking metrics: regret=0.114308 spearman=-0.085447 (groups=34, skipped=318)
2025-12-22 16:35:40 INFO Epoch 021 | train_mse=0.103332 | val_loss=0.089321 | best_val_loss=0.181825
2025-12-22 16:35:49 INFO Epoch 022 | 25% complete (batch 46/181)
2025-12-22 16:35:50 INFO Epoch 022 | 50% complete (batch 91/181)
2025-12-22 16:35:51 INFO Epoch 022 | 75% complete (batch 136/181)
2025-12-22 16:36:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.621037
2025-12-22 16:36:05 INFO Tuning ranking metrics: regret=0.109090 spearman=-0.022619 (groups=34, skipped=318)
2025-12-22 16:36:05 INFO Epoch 022 | train_mse=0.096615 | val_loss=0.077124 | best_val_loss=0.181825
2025-12-22 16:36:13 INFO Epoch 023 | 25% complete (batch 46/181)
2025-12-22 16:36:14 INFO Epoch 023 | 50% complete (batch 91/181)
2025-12-22 16:36:15 INFO Epoch 023 | 75% complete (batch 136/181)
2025-12-22 16:36:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.563045
2025-12-22 16:36:29 INFO Tuning ranking metrics: regret=0.108990 spearman=-0.013515 (groups=34, skipped=318)
2025-12-22 16:36:29 INFO Epoch 023 | train_mse=0.108188 | val_loss=0.073764 | best_val_loss=0.181825
2025-12-22 16:36:38 INFO Epoch 024 | 25% complete (batch 46/181)
2025-12-22 16:36:39 INFO Epoch 024 | 50% complete (batch 91/181)
2025-12-22 16:36:40 INFO Epoch 024 | 75% complete (batch 136/181)
2025-12-22 16:36:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.534494
2025-12-22 16:36:54 INFO Tuning ranking metrics: regret=0.092547 spearman=0.004329 (groups=34, skipped=318)
2025-12-22 16:36:54 INFO Epoch 024 | train_mse=0.072342 | val_loss=0.107883 | best_val_loss=0.181825
2025-12-22 16:37:03 INFO Epoch 025 | 25% complete (batch 46/181)
2025-12-22 16:37:04 INFO Epoch 025 | 50% complete (batch 91/181)
2025-12-22 16:37:05 INFO Epoch 025 | 75% complete (batch 136/181)
2025-12-22 16:37:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.636698
2025-12-22 16:37:19 INFO Tuning ranking metrics: regret=0.113465 spearman=0.054571 (groups=34, skipped=318)
2025-12-22 16:37:19 INFO Epoch 025 | train_mse=0.075391 | val_loss=0.074424 | best_val_loss=0.181825
2025-12-22 16:37:29 INFO Epoch 026 | 25% complete (batch 46/181)
2025-12-22 16:37:31 INFO Epoch 026 | 50% complete (batch 91/181)
2025-12-22 16:37:32 INFO Epoch 026 | 75% complete (batch 136/181)
2025-12-22 16:37:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.610615
2025-12-22 16:37:48 INFO Tuning ranking metrics: regret=0.115329 spearman=0.060371 (groups=34, skipped=318)
2025-12-22 16:37:48 INFO Epoch 026 | train_mse=0.093852 | val_loss=0.075994 | best_val_loss=0.181825
2025-12-22 16:37:58 INFO Epoch 027 | 25% complete (batch 46/181)
2025-12-22 16:37:59 INFO Epoch 027 | 50% complete (batch 91/181)
2025-12-22 16:38:01 INFO Epoch 027 | 75% complete (batch 136/181)
2025-12-22 16:38:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.586266
2025-12-22 16:38:17 INFO Tuning ranking metrics: regret=0.113749 spearman=-0.050509 (groups=34, skipped=318)
2025-12-22 16:38:17 INFO Epoch 027 | train_mse=0.072455 | val_loss=0.090869 | best_val_loss=0.181825
2025-12-22 16:38:27 INFO Epoch 028 | 25% complete (batch 46/181)
2025-12-22 16:38:28 INFO Epoch 028 | 50% complete (batch 91/181)
2025-12-22 16:38:30 INFO Epoch 028 | 75% complete (batch 136/181)
2025-12-22 16:38:40 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.650987
2025-12-22 16:38:45 INFO Tuning ranking metrics: regret=0.112961 spearman=-0.047772 (groups=34, skipped=318)
2025-12-22 16:38:45 INFO Epoch 028 | train_mse=0.080303 | val_loss=0.084599 | best_val_loss=0.181825
2025-12-22 16:38:55 INFO Epoch 029 | 25% complete (batch 46/181)
2025-12-22 16:38:56 INFO Epoch 029 | 50% complete (batch 91/181)
2025-12-22 16:38:57 INFO Epoch 029 | 75% complete (batch 136/181)
2025-12-22 16:39:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.574461
2025-12-22 16:39:12 INFO Tuning ranking metrics: regret=0.111181 spearman=0.064190 (groups=34, skipped=318)
2025-12-22 16:39:12 INFO Epoch 029 | train_mse=0.098489 | val_loss=0.092764 | best_val_loss=0.181825
2025-12-22 16:39:21 INFO Epoch 030 | 25% complete (batch 46/181)
2025-12-22 16:39:22 INFO Epoch 030 | 50% complete (batch 91/181)
2025-12-22 16:39:23 INFO Epoch 030 | 75% complete (batch 136/181)
2025-12-22 16:39:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.543913
2025-12-22 16:39:39 INFO Tuning ranking metrics: regret=0.092630 spearman=0.011555 (groups=34, skipped=318)
2025-12-22 16:39:39 INFO Epoch 030 | train_mse=0.087137 | val_loss=0.079986 | best_val_loss=0.181825
Monitored metric tuning_rank_spearman did not improve in the last 24 records. Best score: 0.182. Signaling Trainer to stop.
2025-12-22 16:39:40 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.10369_val-0.14132_epoch007.chkpt, checkpoint.tuning_rank_spearman-0.10714_val-0.13535_epoch008.chkpt, checkpoint.tuning_rank_spearman-0.18182_val-0.14115_epoch006.chkpt
2025-12-22 16:39:40 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-22_16-26-35/model_checkpoints/checkpoint.tuning_rank_spearman-0.18182_val-0.14115_epoch006.chkpt
2025-12-22 16:39:40 INFO Best validation loss: tensor(0.1818)
2025-12-22 16:39:40 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-22_16-26-35/model_checkpoints/checkpoint.tuning_rank_spearman-0.18182_val-0.14115_epoch006.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-22_16-26-35/model_checkpoints/checkpoint.tuning_rank_spearman-0.18182_val-0.14115_epoch006.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-22 16:39:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.141154
2025-12-22 16:39:54 INFO Tuning ranking metrics: regret=0.156104 spearman=0.181825 (groups=34, skipped=318)
2025-12-22 16:39:54 INFO Epoch 031 | val_loss=0.141154 | best_val_loss=0.181825
2025-12-22 16:39:54 INFO Validation metrics: [{'val_loss': 0.14115405082702637, 'tuning_rank_regret': 0.15610408782958984, 'tuning_rank_spearman': 0.18182455003261566, 'val_pearson_corr': 0.3346993029117584, 'val_spearman_corr': 0.3456098735332489, 'val_rank_regret': 0.16878865659236908, 'val_rank_spearman': -0.4444444477558136}]
2025-12-22 16:39:54 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.18182_val-0.14115_epoch006.chkpt
2025-12-22 16:39:54 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.10369_val-0.14132_epoch007.chkpt
2025-12-22 16:39:54 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.10714_val-0.13535_epoch008.chkpt
2025-12-22 16:39:54 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.13689_epoch005.ckpt
2025-12-22 16:39:55 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.15610408782958984
  tuning_rank_spearman      0.18182455003261566
        val_loss            0.14115405082702637
    val_pearson_corr        0.3346993029117584
     val_rank_regret        0.16878865659236908
    val_rank_spearman       -0.4444444477558136
    val_spearman_corr       0.3456098735332489
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run sched_boost_lean_seed222_2025-12-22_16-26-35 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-22_16-26-35
[train_cli][batch] job 'sched_boost_lean_seed222' finished.
[train_cli][batch] (2/3) running job 'sched_boost_lr035_lean_seed222' -> run_name=sched_boost_lr035_lean_seed222_2025-12-22_16-39-57
[train_cli] run_id=sched_boost_lr035_lean_seed222_2025-12-22_16-39-57 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57 --git-commit 150d1dcbd1 --git-dirty
2025-12-22 16:40:01 INFO git_commit = 150d1dcbd1 (dirty)
2025-12-22 16:40:01 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-22 16:40:01 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57/config/config.yaml
2025-12-22 16:40:01 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data
2025-12-22 16:40:01 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-22 16:40:01 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-22 16:40:01 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57
2025-12-22 16:40:01 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-22 16:40:01 INFO   metadata_path = None
2025-12-22 16:40:01 INFO   summary_path = None
2025-12-22 16:40:01 INFO   accelerator = cpu
2025-12-22 16:40:01 INFO   devices = 1
2025-12-22 16:40:01 INFO   attention_head = 8
2025-12-22 16:40:01 INFO   pooling_type = mean
2025-12-22 16:40:01 INFO   model_self_loops = False
2025-12-22 16:40:01 INFO   model_self_loop_fill = mean
2025-12-22 16:40:01 INFO   model_residual = False
2025-12-22 16:40:01 INFO   batch_size = 48
2025-12-22 16:40:01 INFO   learning_rate = 0.0035
2025-12-22 16:40:01 INFO   num_epochs = 140
2025-12-22 16:40:01 INFO   accumulate_grad_batches = 8
2025-12-22 16:40:01 INFO   seed = 222
2025-12-22 16:40:01 INFO   num_workers = 2
2025-12-22 16:40:01 INFO   precision = 32
2025-12-22 16:40:01 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-22 16:40:01 INFO   early_stopping_patience = 24
2025-12-22 16:40:01 INFO   lr_scheduler_patience = 6
2025-12-22 16:40:01 INFO   lr_scheduler_factor = 0.2
2025-12-22 16:40:01 INFO   fast_dev_run = False
2025-12-22 16:40:01 INFO   limit_train_batches = None
2025-12-22 16:40:01 INFO   limit_val_batches = None
2025-12-22 16:40:01 INFO   log_lr = False
2025-12-22 16:40:01 INFO   progress_bar_refresh_rate = 0
2025-12-22 16:40:01 INFO   log_every_n_steps = 100
2025-12-22 16:40:01 INFO   use_val_spearman_as_secondary = True
2025-12-22 16:40:01 INFO   spearman_secondary_min_delta = 0.0
2025-12-22 16:40:01 INFO   spearman_secondary_weight = 1.0
2025-12-22 16:40:01 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-22 16:40:01 INFO   tuning_max_samples = 500
2025-12-22 16:40:01 INFO   tuning_fraction = None
2025-12-22 16:40:01 INFO   tuning_eval_every = 1
2025-12-22 16:40:01 INFO   rank_loss_weight = 0.0
2025-12-22 16:40:01 INFO   rank_loss_margin = 0.0
2025-12-22 16:40:01 INFO   rank_loss_mode = hinge
2025-12-22 16:40:01 INFO   rank_loss_grouped = True
2025-12-22 16:40:01 INFO   variance_reduction_enabled = False
2025-12-22 16:40:01 INFO   variance_reduction_method = topk_avg
2025-12-22 16:40:01 INFO   variance_reduction_top_k = 3
2025-12-22 16:40:01 INFO   coverage_minimum = 0.0
2025-12-22 16:40:01 INFO   coverage_fail_on_missing = False
2025-12-22 16:40:01 INFO   graph_load_profiling = False
2025-12-22 16:40:01 INFO   graph_load_top_k = 5
2025-12-22 16:40:01 INFO   enable_graph_cache = True
2025-12-22 16:40:01 INFO   graph_cache_size = 256
2025-12-22 16:40:01 INFO   canonicalize_on_load = False
2025-12-22 16:40:01 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-22 16:40:01 INFO   edge_schema = {}
2025-12-22 16:40:01 INFO   topology_schema = {}
Seed set to 222
2025-12-22 16:40:02 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-22 16:40:02 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 16:40:02 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-22 16:40:02 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 16:40:02 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-22 16:40:02 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 16:40:03 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-22 16:40:03 INFO Tuning group stats: groups=352 groups>=2=34 singletons=318 max_group=11
2025-12-22 16:40:03 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57/dataset_coverage.json
2025-12-22 16:40:03 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57/dataset_coverage.json for details.
2025-12-22 16:40:03 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57/dataset_coverage.json for details.
2025-12-22 16:40:03 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57/dataset_coverage.json for details.
2025-12-22 16:40:03 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57/schema_summary.json
2025-12-22 16:40:03 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57/feature_metadata.json
2025-12-22 16:40:03 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-22 16:40:03 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/feature-config.yaml.topoqa.10A.2, sha256=5c62898155179232a565e24d9fbd7b208f9ce480d1a19d6139de19454e173ff0
2025-12-22 16:40:03 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/work/edge_features)
2025-12-22 16:40:03 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json
2025-12-22 16:40:03 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57/schema_summary.json
2025-12-22 16:40:03 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-22 16:40:03 INFO Topology: topology/persistence_basic/v1 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 172-dimensional node features.
2025-12-22 16:40:03 INFO Node: node/dssp_topo_merge/v1; metadata lists 172 feature columns matching the .pt tensor.
2025-12-22 16:40:03 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-22 16:40:03 INFO → Total feature dimensionality observed and confirmed: node_dim = 172, edge_dim = 11.
2025-12-22 16:40:03 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-22 16:40:03 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 172,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 172,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge/v1",
      "alias": "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA",
      "jobs": 16,
      "summary": "DSSP-derived node features merged with topology statistics."
    },
    "topology": {
      "id": "topology/persistence_basic/v1",
      "alias": "Betti 0 and Betti 1 topology summaries on interface coords = 140D PH | TopoQA",
      "jobs": 16,
      "summary": "Persistent homology features with configurable distance thresholds."
    }
  },
  "notes": []
}
2025-12-22 16:40:03 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-22 16:40:03 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=36b4fca647c54a41a8919687de008959)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-22 16:40:03 INFO Starting training (fast_dev_run=False)
2025-12-22 16:40:03 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57/model_checkpoints exists and is not empty.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 5.5 K  | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
165 K     Trainable params
0         Non-trainable params
165 K     Total params
0.662     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-22 16:40:20 INFO Epoch 000 | 25% complete (batch 46/181)
2025-12-22 16:40:21 INFO Epoch 000 | 50% complete (batch 91/181)
2025-12-22 16:40:22 INFO Epoch 000 | 75% complete (batch 136/181)
2025-12-22 16:40:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.140984
2025-12-22 16:40:37 INFO Tuning ranking metrics: regret=0.165143 spearman=-0.145015 (groups=34, skipped=318)
2025-12-22 16:40:37 INFO Epoch 000 | val_loss=0.140984
Metric tuning_rank_spearman improved. New best score: -0.145
2025-12-22 16:40:47 INFO Epoch 001 | 25% complete (batch 46/181)
2025-12-22 16:40:48 INFO Epoch 001 | 50% complete (batch 91/181)
2025-12-22 16:40:49 INFO Epoch 001 | 75% complete (batch 136/181)
2025-12-22 16:40:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.129981
2025-12-22 16:41:04 INFO Tuning ranking metrics: regret=0.157273 spearman=-0.272377 (groups=34, skipped=318)
2025-12-22 16:41:04 INFO Epoch 001 | train_mse=0.144844 | val_loss=0.140629 | best_val_loss=-0.145015
2025-12-22 16:41:14 INFO Epoch 002 | 25% complete (batch 46/181)
2025-12-22 16:41:15 INFO Epoch 002 | 50% complete (batch 91/181)
2025-12-22 16:41:16 INFO Epoch 002 | 75% complete (batch 136/181)
2025-12-22 16:41:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.187110
2025-12-22 16:41:32 INFO Tuning ranking metrics: regret=0.139120 spearman=-0.013738 (groups=34, skipped=318)
2025-12-22 16:41:32 INFO Epoch 002 | train_mse=0.150463 | val_loss=0.140391 | best_val_loss=-0.145015
Metric tuning_rank_spearman improved by 0.131 >= min_delta = 0.0. New best score: -0.014
2025-12-22 16:41:41 INFO Epoch 003 | 25% complete (batch 46/181)
2025-12-22 16:41:42 INFO Epoch 003 | 50% complete (batch 91/181)
2025-12-22 16:41:44 INFO Epoch 003 | 75% complete (batch 136/181)
2025-12-22 16:41:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.476998
2025-12-22 16:42:00 INFO Tuning ranking metrics: regret=0.126472 spearman=-0.163961 (groups=34, skipped=318)
2025-12-22 16:42:00 INFO Epoch 003 | train_mse=0.154652 | val_loss=0.140143 | best_val_loss=-0.013738
2025-12-22 16:42:11 INFO Epoch 004 | 25% complete (batch 46/181)
2025-12-22 16:42:13 INFO Epoch 004 | 50% complete (batch 91/181)
2025-12-22 16:42:14 INFO Epoch 004 | 75% complete (batch 136/181)
2025-12-22 16:42:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.131887
2025-12-22 16:42:32 INFO Tuning ranking metrics: regret=0.101515 spearman=-0.111606 (groups=34, skipped=318)
2025-12-22 16:42:32 INFO Epoch 004 | train_mse=0.144048 | val_loss=0.131887 | best_val_loss=-0.013738
2025-12-22 16:42:41 INFO Epoch 005 | 25% complete (batch 46/181)
2025-12-22 16:42:42 INFO Epoch 005 | 50% complete (batch 91/181)
2025-12-22 16:42:43 INFO Epoch 005 | 75% complete (batch 136/181)
2025-12-22 16:42:53 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.538292
2025-12-22 16:42:59 INFO Tuning ranking metrics: regret=0.109144 spearman=-0.057665 (groups=34, skipped=318)
2025-12-22 16:42:59 INFO Epoch 005 | train_mse=0.146973 | val_loss=0.109148 | best_val_loss=-0.013738
2025-12-22 16:43:08 INFO Epoch 006 | 25% complete (batch 46/181)
2025-12-22 16:43:09 INFO Epoch 006 | 50% complete (batch 91/181)
2025-12-22 16:43:10 INFO Epoch 006 | 75% complete (batch 136/181)
2025-12-22 16:43:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.589835
2025-12-22 16:43:26 INFO Tuning ranking metrics: regret=0.114772 spearman=-0.082601 (groups=34, skipped=318)
2025-12-22 16:43:26 INFO Epoch 006 | train_mse=0.120957 | val_loss=0.092330 | best_val_loss=-0.013738
2025-12-22 16:43:36 INFO Epoch 007 | 25% complete (batch 46/181)
2025-12-22 16:43:37 INFO Epoch 007 | 50% complete (batch 91/181)
2025-12-22 16:43:38 INFO Epoch 007 | 75% complete (batch 136/181)
2025-12-22 16:43:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.531911
2025-12-22 16:43:54 INFO Tuning ranking metrics: regret=0.091171 spearman=-0.008760 (groups=34, skipped=318)
2025-12-22 16:43:54 INFO Epoch 007 | train_mse=0.128834 | val_loss=0.121331 | best_val_loss=-0.013738
Metric tuning_rank_spearman improved by 0.005 >= min_delta = 0.0. New best score: -0.009
2025-12-22 16:44:04 INFO Epoch 008 | 25% complete (batch 46/181)
2025-12-22 16:44:04 INFO Epoch 008 | 50% complete (batch 91/181)
2025-12-22 16:44:06 INFO Epoch 008 | 75% complete (batch 136/181)
2025-12-22 16:44:15 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.574995
2025-12-22 16:44:21 INFO Tuning ranking metrics: regret=0.089704 spearman=-0.031245 (groups=34, skipped=318)
2025-12-22 16:44:21 INFO Epoch 008 | train_mse=0.086499 | val_loss=0.097093 | best_val_loss=-0.008760
2025-12-22 16:44:30 INFO Epoch 009 | 25% complete (batch 46/181)
2025-12-22 16:44:31 INFO Epoch 009 | 50% complete (batch 91/181)
2025-12-22 16:44:32 INFO Epoch 009 | 75% complete (batch 136/181)
2025-12-22 16:44:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.568358
2025-12-22 16:44:47 INFO Tuning ranking metrics: regret=0.093194 spearman=-0.015101 (groups=34, skipped=318)
2025-12-22 16:44:47 INFO Epoch 009 | train_mse=0.081871 | val_loss=0.115300 | best_val_loss=-0.008760
2025-12-22 16:44:55 INFO Epoch 010 | 25% complete (batch 46/181)
2025-12-22 16:44:56 INFO Epoch 010 | 50% complete (batch 91/181)
2025-12-22 16:44:57 INFO Epoch 010 | 75% complete (batch 136/181)
2025-12-22 16:45:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.597826
2025-12-22 16:45:10 INFO Tuning ranking metrics: regret=0.113913 spearman=-0.019328 (groups=34, skipped=318)
2025-12-22 16:45:10 INFO Epoch 010 | train_mse=0.106233 | val_loss=0.083786 | best_val_loss=-0.008760
2025-12-22 16:45:18 INFO Epoch 011 | 25% complete (batch 46/181)
2025-12-22 16:45:19 INFO Epoch 011 | 50% complete (batch 91/181)
2025-12-22 16:45:19 INFO Epoch 011 | 75% complete (batch 136/181)
2025-12-22 16:45:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.521977
2025-12-22 16:45:32 INFO Tuning ranking metrics: regret=0.148406 spearman=-0.001515 (groups=34, skipped=318)
2025-12-22 16:45:32 INFO Epoch 011 | train_mse=0.096809 | val_loss=0.116576 | best_val_loss=-0.008760
Metric tuning_rank_spearman improved by 0.007 >= min_delta = 0.0. New best score: -0.002
2025-12-22 16:45:40 INFO Epoch 012 | 25% complete (batch 46/181)
2025-12-22 16:45:41 INFO Epoch 012 | 50% complete (batch 91/181)
2025-12-22 16:45:42 INFO Epoch 012 | 75% complete (batch 136/181)
2025-12-22 16:45:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.549942
2025-12-22 16:45:55 INFO Tuning ranking metrics: regret=0.128792 spearman=-0.000528 (groups=34, skipped=318)
2025-12-22 16:45:55 INFO Epoch 012 | train_mse=0.103711 | val_loss=0.109587 | best_val_loss=-0.001515
Metric tuning_rank_spearman improved by 0.001 >= min_delta = 0.0. New best score: -0.001
2025-12-22 16:46:03 INFO Epoch 013 | 25% complete (batch 46/181)
2025-12-22 16:46:03 INFO Epoch 013 | 50% complete (batch 91/181)
2025-12-22 16:46:04 INFO Epoch 013 | 75% complete (batch 136/181)
2025-12-22 16:46:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.513792
2025-12-22 16:46:17 INFO Tuning ranking metrics: regret=0.094845 spearman=-0.083480 (groups=34, skipped=318)
2025-12-22 16:46:17 INFO Epoch 013 | train_mse=0.115411 | val_loss=0.138929 | best_val_loss=-0.000528
2025-12-22 16:46:25 INFO Epoch 014 | 25% complete (batch 46/181)
2025-12-22 16:46:26 INFO Epoch 014 | 50% complete (batch 91/181)
2025-12-22 16:46:26 INFO Epoch 014 | 75% complete (batch 136/181)
2025-12-22 16:46:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.589387
2025-12-22 16:46:40 INFO Tuning ranking metrics: regret=0.111398 spearman=0.007417 (groups=34, skipped=318)
2025-12-22 16:46:40 INFO Epoch 014 | train_mse=0.088970 | val_loss=0.071249 | best_val_loss=-0.000528
Metric tuning_rank_spearman improved by 0.008 >= min_delta = 0.0. New best score: 0.007
2025-12-22 16:46:48 INFO Epoch 015 | 25% complete (batch 46/181)
2025-12-22 16:46:49 INFO Epoch 015 | 50% complete (batch 91/181)
2025-12-22 16:46:49 INFO Epoch 015 | 75% complete (batch 136/181)
2025-12-22 16:46:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.638149
2025-12-22 16:47:02 INFO Tuning ranking metrics: regret=0.110071 spearman=-0.010460 (groups=34, skipped=318)
2025-12-22 16:47:02 INFO Epoch 015 | train_mse=0.096274 | val_loss=0.068195 | best_val_loss=0.007417
2025-12-22 16:47:10 INFO Epoch 016 | 25% complete (batch 46/181)
2025-12-22 16:47:11 INFO Epoch 016 | 50% complete (batch 91/181)
2025-12-22 16:47:12 INFO Epoch 016 | 75% complete (batch 136/181)
2025-12-22 16:47:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.639468
2025-12-22 16:47:25 INFO Tuning ranking metrics: regret=0.092304 spearman=-0.033569 (groups=34, skipped=318)
2025-12-22 16:47:25 INFO Epoch 016 | train_mse=0.099097 | val_loss=0.069777 | best_val_loss=0.007417
2025-12-22 16:47:33 INFO Epoch 017 | 25% complete (batch 46/181)
2025-12-22 16:47:34 INFO Epoch 017 | 50% complete (batch 91/181)
2025-12-22 16:47:34 INFO Epoch 017 | 75% complete (batch 136/181)
2025-12-22 16:47:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.655022
2025-12-22 16:47:47 INFO Tuning ranking metrics: regret=0.092103 spearman=0.021944 (groups=34, skipped=318)
2025-12-22 16:47:47 INFO Epoch 017 | train_mse=0.096461 | val_loss=0.079659 | best_val_loss=0.007417
Metric tuning_rank_spearman improved by 0.015 >= min_delta = 0.0. New best score: 0.022
2025-12-22 16:47:56 INFO Epoch 018 | 25% complete (batch 46/181)
2025-12-22 16:47:57 INFO Epoch 018 | 50% complete (batch 91/181)
2025-12-22 16:47:58 INFO Epoch 018 | 75% complete (batch 136/181)
2025-12-22 16:48:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.613570
2025-12-22 16:48:12 INFO Tuning ranking metrics: regret=0.079295 spearman=0.036688 (groups=34, skipped=318)
2025-12-22 16:48:12 INFO Epoch 018 | train_mse=0.084834 | val_loss=0.117623 | best_val_loss=0.021944
Metric tuning_rank_spearman improved by 0.015 >= min_delta = 0.0. New best score: 0.037
2025-12-22 16:48:20 INFO Epoch 019 | 25% complete (batch 46/181)
2025-12-22 16:48:21 INFO Epoch 019 | 50% complete (batch 91/181)
2025-12-22 16:48:21 INFO Epoch 019 | 75% complete (batch 136/181)
2025-12-22 16:48:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.632694
2025-12-22 16:48:35 INFO Tuning ranking metrics: regret=0.092114 spearman=-0.038573 (groups=34, skipped=318)
2025-12-22 16:48:35 INFO Epoch 019 | train_mse=0.081979 | val_loss=0.072862 | best_val_loss=0.036688
2025-12-22 16:48:43 INFO Epoch 020 | 25% complete (batch 46/181)
2025-12-22 16:48:44 INFO Epoch 020 | 50% complete (batch 91/181)
2025-12-22 16:48:45 INFO Epoch 020 | 75% complete (batch 136/181)
2025-12-22 16:48:53 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.649571
2025-12-22 16:48:58 INFO Tuning ranking metrics: regret=0.092304 spearman=-0.054329 (groups=34, skipped=318)
2025-12-22 16:48:58 INFO Epoch 020 | train_mse=0.089260 | val_loss=0.064821 | best_val_loss=0.036688
2025-12-22 16:49:06 INFO Epoch 021 | 25% complete (batch 46/181)
2025-12-22 16:49:07 INFO Epoch 021 | 50% complete (batch 91/181)
2025-12-22 16:49:07 INFO Epoch 021 | 75% complete (batch 136/181)
2025-12-22 16:49:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.665537
2025-12-22 16:49:21 INFO Tuning ranking metrics: regret=0.088760 spearman=-0.002196 (groups=34, skipped=318)
2025-12-22 16:49:21 INFO Epoch 021 | train_mse=0.066119 | val_loss=0.072028 | best_val_loss=0.036688
2025-12-22 16:49:29 INFO Epoch 022 | 25% complete (batch 46/181)
2025-12-22 16:49:30 INFO Epoch 022 | 50% complete (batch 91/181)
2025-12-22 16:49:31 INFO Epoch 022 | 75% complete (batch 136/181)
2025-12-22 16:49:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.636718
2025-12-22 16:49:45 INFO Tuning ranking metrics: regret=0.090616 spearman=0.008270 (groups=34, skipped=318)
2025-12-22 16:49:45 INFO Epoch 022 | train_mse=0.088892 | val_loss=0.087014 | best_val_loss=0.036688
2025-12-22 16:49:53 INFO Epoch 023 | 25% complete (batch 46/181)
2025-12-22 16:49:54 INFO Epoch 023 | 50% complete (batch 91/181)
2025-12-22 16:49:54 INFO Epoch 023 | 75% complete (batch 136/181)
2025-12-22 16:50:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.635506
2025-12-22 16:50:08 INFO Tuning ranking metrics: regret=0.093368 spearman=-0.016673 (groups=34, skipped=318)
2025-12-22 16:50:08 INFO Epoch 023 | train_mse=0.106138 | val_loss=0.069631 | best_val_loss=0.036688
2025-12-22 16:50:16 INFO Epoch 024 | 25% complete (batch 46/181)
2025-12-22 16:50:17 INFO Epoch 024 | 50% complete (batch 91/181)
2025-12-22 16:50:18 INFO Epoch 024 | 75% complete (batch 136/181)
2025-12-22 16:50:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.637738
2025-12-22 16:50:31 INFO Tuning ranking metrics: regret=0.075172 spearman=0.032175 (groups=34, skipped=318)
2025-12-22 16:50:31 INFO Epoch 024 | train_mse=0.080407 | val_loss=0.074894 | best_val_loss=0.036688
2025-12-22 16:50:39 INFO Epoch 025 | 25% complete (batch 46/181)
2025-12-22 16:50:40 INFO Epoch 025 | 50% complete (batch 91/181)
2025-12-22 16:50:41 INFO Epoch 025 | 75% complete (batch 136/181)
2025-12-22 16:50:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.624308
2025-12-22 16:50:54 INFO Tuning ranking metrics: regret=0.075201 spearman=-0.020875 (groups=34, skipped=318)
2025-12-22 16:50:54 INFO Epoch 025 | train_mse=0.063464 | val_loss=0.071573 | best_val_loss=0.036688
2025-12-22 16:51:02 INFO Epoch 026 | 25% complete (batch 46/181)
2025-12-22 16:51:03 INFO Epoch 026 | 50% complete (batch 91/181)
2025-12-22 16:51:03 INFO Epoch 026 | 75% complete (batch 136/181)
2025-12-22 16:51:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.633984
2025-12-22 16:51:17 INFO Tuning ranking metrics: regret=0.073553 spearman=0.011555 (groups=34, skipped=318)
2025-12-22 16:51:17 INFO Epoch 026 | train_mse=0.086723 | val_loss=0.069811 | best_val_loss=0.036688
2025-12-22 16:51:25 INFO Epoch 027 | 25% complete (batch 46/181)
2025-12-22 16:51:26 INFO Epoch 027 | 50% complete (batch 91/181)
2025-12-22 16:51:27 INFO Epoch 027 | 75% complete (batch 136/181)
2025-12-22 16:51:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.608144
2025-12-22 16:51:40 INFO Tuning ranking metrics: regret=0.110892 spearman=-0.067641 (groups=34, skipped=318)
2025-12-22 16:51:40 INFO Epoch 027 | train_mse=0.075732 | val_loss=0.112754 | best_val_loss=0.036688
2025-12-22 16:51:49 INFO Epoch 028 | 25% complete (batch 46/181)
2025-12-22 16:51:50 INFO Epoch 028 | 50% complete (batch 91/181)
2025-12-22 16:51:51 INFO Epoch 028 | 75% complete (batch 136/181)
2025-12-22 16:51:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.679224
2025-12-22 16:52:04 INFO Tuning ranking metrics: regret=0.088635 spearman=0.016539 (groups=34, skipped=318)
2025-12-22 16:52:04 INFO Epoch 028 | train_mse=0.063304 | val_loss=0.063740 | best_val_loss=0.036688
2025-12-22 16:52:12 INFO Epoch 029 | 25% complete (batch 46/181)
2025-12-22 16:52:13 INFO Epoch 029 | 50% complete (batch 91/181)
2025-12-22 16:52:14 INFO Epoch 029 | 75% complete (batch 136/181)
2025-12-22 16:52:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.653414
2025-12-22 16:52:27 INFO Tuning ranking metrics: regret=0.075588 spearman=0.025802 (groups=34, skipped=318)
2025-12-22 16:52:27 INFO Epoch 029 | train_mse=0.086104 | val_loss=0.072480 | best_val_loss=0.036688
2025-12-22 16:52:36 INFO Epoch 030 | 25% complete (batch 46/181)
2025-12-22 16:52:37 INFO Epoch 030 | 50% complete (batch 91/181)
2025-12-22 16:52:38 INFO Epoch 030 | 75% complete (batch 136/181)
2025-12-22 16:52:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.665849
2025-12-22 16:52:51 INFO Tuning ranking metrics: regret=0.088635 spearman=0.027254 (groups=34, skipped=318)
2025-12-22 16:52:51 INFO Epoch 030 | train_mse=0.079755 | val_loss=0.064087 | best_val_loss=0.036688
2025-12-22 16:53:00 INFO Epoch 031 | 25% complete (batch 46/181)
2025-12-22 16:53:00 INFO Epoch 031 | 50% complete (batch 91/181)
2025-12-22 16:53:01 INFO Epoch 031 | 75% complete (batch 136/181)
2025-12-22 16:53:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.664402
2025-12-22 16:53:15 INFO Tuning ranking metrics: regret=0.088635 spearman=0.028425 (groups=34, skipped=318)
2025-12-22 16:53:15 INFO Epoch 031 | train_mse=0.078147 | val_loss=0.063270 | best_val_loss=0.036688
2025-12-22 16:53:23 INFO Epoch 032 | 25% complete (batch 46/181)
2025-12-22 16:53:24 INFO Epoch 032 | 50% complete (batch 91/181)
2025-12-22 16:53:25 INFO Epoch 032 | 75% complete (batch 136/181)
2025-12-22 16:53:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.669575
2025-12-22 16:53:38 INFO Tuning ranking metrics: regret=0.088635 spearman=0.026120 (groups=34, skipped=318)
2025-12-22 16:53:38 INFO Epoch 032 | train_mse=0.077891 | val_loss=0.062809 | best_val_loss=0.036688
2025-12-22 16:53:46 INFO Epoch 033 | 25% complete (batch 46/181)
2025-12-22 16:53:47 INFO Epoch 033 | 50% complete (batch 91/181)
2025-12-22 16:53:48 INFO Epoch 033 | 75% complete (batch 136/181)
2025-12-22 16:53:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.664541
2025-12-22 16:54:02 INFO Tuning ranking metrics: regret=0.112971 spearman=-0.026171 (groups=34, skipped=318)
2025-12-22 16:54:02 INFO Epoch 033 | train_mse=0.073615 | val_loss=0.068715 | best_val_loss=0.036688
2025-12-22 16:54:10 INFO Epoch 034 | 25% complete (batch 46/181)
2025-12-22 16:54:11 INFO Epoch 034 | 50% complete (batch 91/181)
2025-12-22 16:54:11 INFO Epoch 034 | 75% complete (batch 136/181)
2025-12-22 16:54:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.665273
2025-12-22 16:54:25 INFO Tuning ranking metrics: regret=0.075584 spearman=0.013598 (groups=34, skipped=318)
2025-12-22 16:54:25 INFO Epoch 034 | train_mse=0.068852 | val_loss=0.068418 | best_val_loss=0.036688
2025-12-22 16:54:33 INFO Epoch 035 | 25% complete (batch 46/181)
2025-12-22 16:54:34 INFO Epoch 035 | 50% complete (batch 91/181)
2025-12-22 16:54:35 INFO Epoch 035 | 75% complete (batch 136/181)
2025-12-22 16:54:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.670717
2025-12-22 16:54:48 INFO Tuning ranking metrics: regret=0.088635 spearman=0.021276 (groups=34, skipped=318)
2025-12-22 16:54:48 INFO Epoch 035 | train_mse=0.061313 | val_loss=0.062036 | best_val_loss=0.036688
2025-12-22 16:54:57 INFO Epoch 036 | 25% complete (batch 46/181)
2025-12-22 16:54:58 INFO Epoch 036 | 50% complete (batch 91/181)
2025-12-22 16:54:58 INFO Epoch 036 | 75% complete (batch 136/181)
2025-12-22 16:55:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.668081
2025-12-22 16:55:12 INFO Tuning ranking metrics: regret=0.073557 spearman=0.006277 (groups=34, skipped=318)
2025-12-22 16:55:12 INFO Epoch 036 | train_mse=0.083349 | val_loss=0.065677 | best_val_loss=0.036688
2025-12-22 16:55:20 INFO Epoch 037 | 25% complete (batch 46/181)
2025-12-22 16:55:21 INFO Epoch 037 | 50% complete (batch 91/181)
2025-12-22 16:55:22 INFO Epoch 037 | 75% complete (batch 136/181)
2025-12-22 16:55:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.670184
2025-12-22 16:55:35 INFO Tuning ranking metrics: regret=0.088635 spearman=0.024166 (groups=34, skipped=318)
2025-12-22 16:55:35 INFO Epoch 037 | train_mse=0.082135 | val_loss=0.066023 | best_val_loss=0.036688
2025-12-22 16:55:44 INFO Epoch 038 | 25% complete (batch 46/181)
2025-12-22 16:55:44 INFO Epoch 038 | 50% complete (batch 91/181)
2025-12-22 16:55:45 INFO Epoch 038 | 75% complete (batch 136/181)
2025-12-22 16:55:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.670112
2025-12-22 16:55:59 INFO Tuning ranking metrics: regret=0.073557 spearman=0.001636 (groups=34, skipped=318)
2025-12-22 16:55:59 INFO Epoch 038 | train_mse=0.057473 | val_loss=0.062959 | best_val_loss=0.036688
2025-12-22 16:56:07 INFO Epoch 039 | 25% complete (batch 46/181)
2025-12-22 16:56:08 INFO Epoch 039 | 50% complete (batch 91/181)
2025-12-22 16:56:09 INFO Epoch 039 | 75% complete (batch 136/181)
2025-12-22 16:56:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.672331
2025-12-22 16:56:22 INFO Tuning ranking metrics: regret=0.071178 spearman=0.020264 (groups=34, skipped=318)
2025-12-22 16:56:22 INFO Epoch 039 | train_mse=0.077034 | val_loss=0.062820 | best_val_loss=0.036688
2025-12-22 16:56:30 INFO Epoch 040 | 25% complete (batch 46/181)
2025-12-22 16:56:31 INFO Epoch 040 | 50% complete (batch 91/181)
2025-12-22 16:56:32 INFO Epoch 040 | 75% complete (batch 136/181)
2025-12-22 16:56:40 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.674084
2025-12-22 16:56:45 INFO Tuning ranking metrics: regret=0.090663 spearman=-0.033741 (groups=34, skipped=318)
2025-12-22 16:56:45 INFO Epoch 040 | train_mse=0.062544 | val_loss=0.060848 | best_val_loss=0.036688
2025-12-22 16:56:53 INFO Epoch 041 | 25% complete (batch 46/181)
2025-12-22 16:56:54 INFO Epoch 041 | 50% complete (batch 91/181)
2025-12-22 16:56:55 INFO Epoch 041 | 75% complete (batch 136/181)
2025-12-22 16:57:04 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.674976
2025-12-22 16:57:09 INFO Tuning ranking metrics: regret=0.110862 spearman=-0.026611 (groups=34, skipped=318)
2025-12-22 16:57:09 INFO Epoch 041 | train_mse=0.075651 | val_loss=0.060426 | best_val_loss=0.036688
2025-12-22 16:57:18 INFO Epoch 042 | 25% complete (batch 46/181)
2025-12-22 16:57:19 INFO Epoch 042 | 50% complete (batch 91/181)
2025-12-22 16:57:19 INFO Epoch 042 | 75% complete (batch 136/181)
2025-12-22 16:57:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.673665
2025-12-22 16:57:33 INFO Tuning ranking metrics: regret=0.110015 spearman=-0.045665 (groups=34, skipped=318)
2025-12-22 16:57:33 INFO Epoch 042 | train_mse=0.078407 | val_loss=0.066465 | best_val_loss=0.036688
Monitored metric tuning_rank_spearman did not improve in the last 24 records. Best score: 0.037. Signaling Trainer to stop.
2025-12-22 16:57:34 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.02843_val-0.06327_epoch031.chkpt, checkpoint.tuning_rank_spearman-0.03217_val-0.07489_epoch024.chkpt, checkpoint.tuning_rank_spearman-0.03669_val-0.11762_epoch018.chkpt
2025-12-22 16:57:34 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57/model_checkpoints/checkpoint.tuning_rank_spearman-0.03669_val-0.11762_epoch018.chkpt
2025-12-22 16:57:34 INFO Best validation loss: tensor(0.0367)
2025-12-22 16:57:34 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57/model_checkpoints/checkpoint.tuning_rank_spearman-0.03669_val-0.11762_epoch018.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57/model_checkpoints/checkpoint.tuning_rank_spearman-0.03669_val-0.11762_epoch018.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-22 16:57:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.117623
2025-12-22 16:57:46 INFO Tuning ranking metrics: regret=0.079295 spearman=0.036688 (groups=34, skipped=318)
2025-12-22 16:57:46 INFO Epoch 043 | val_loss=0.117623 | best_val_loss=0.036688
2025-12-22 16:57:47 INFO Validation metrics: [{'val_loss': 0.11762342602014542, 'tuning_rank_regret': 0.07929473370313644, 'tuning_rank_spearman': 0.03668831288814545, 'val_pearson_corr': 0.6253012418746948, 'val_spearman_corr': 0.7055558562278748, 'val_rank_regret': 0.006356073077768087, 'val_rank_spearman': 0.6666666865348816}]
2025-12-22 16:57:47 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.03669_val-0.11762_epoch018.chkpt
2025-12-22 16:57:47 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.03217_val-0.07489_epoch024.chkpt
2025-12-22 16:57:47 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.02843_val-0.06327_epoch031.chkpt
2025-12-22 16:57:47 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.06820_epoch015.ckpt
2025-12-22 16:57:47 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.07929473370313644
  tuning_rank_spearman      0.03668831288814545
        val_loss            0.11762342602014542
    val_pearson_corr        0.6253012418746948
     val_rank_regret       0.006356073077768087
    val_rank_spearman       0.6666666865348816
    val_spearman_corr       0.7055558562278748
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run sched_boost_lr035_lean_seed222_2025-12-22_16-39-57 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57
[train_cli][batch] job 'sched_boost_lr035_lean_seed222' finished.
[train_cli][batch] (3/3) running job 'large_batch_sched_boost_lean_seed222' -> run_name=large_batch_sched_boost_lean_seed222_2025-12-22_16-57-49
[train_cli] run_id=large_batch_sched_boost_lean_seed222_2025-12-22_16-57-49 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-22_16-57-49/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-22_16-57-49 --git-commit 150d1dcbd1 --git-dirty
2025-12-22 16:57:53 INFO git_commit = 150d1dcbd1 (dirty)
2025-12-22 16:57:53 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-22 16:57:53 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-22_16-57-49/config/config.yaml
2025-12-22 16:57:53 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data
2025-12-22 16:57:53 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-22 16:57:53 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-22 16:57:53 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-22_16-57-49
2025-12-22 16:57:53 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-22 16:57:53 INFO   metadata_path = None
2025-12-22 16:57:53 INFO   summary_path = None
2025-12-22 16:57:53 INFO   accelerator = cpu
2025-12-22 16:57:53 INFO   devices = 1
2025-12-22 16:57:53 INFO   attention_head = 8
2025-12-22 16:57:53 INFO   pooling_type = mean
2025-12-22 16:57:53 INFO   model_self_loops = False
2025-12-22 16:57:53 INFO   model_self_loop_fill = mean
2025-12-22 16:57:53 INFO   model_residual = False
2025-12-22 16:57:53 INFO   batch_size = 48
2025-12-22 16:57:53 INFO   learning_rate = 0.004
2025-12-22 16:57:53 INFO   num_epochs = 120
2025-12-22 16:57:53 INFO   accumulate_grad_batches = 8
2025-12-22 16:57:53 INFO   seed = 222
2025-12-22 16:57:53 INFO   num_workers = 2
2025-12-22 16:57:53 INFO   precision = 32
2025-12-22 16:57:53 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-22 16:57:53 INFO   early_stopping_patience = 20
2025-12-22 16:57:53 INFO   lr_scheduler_patience = 5
2025-12-22 16:57:53 INFO   lr_scheduler_factor = 0.2
2025-12-22 16:57:53 INFO   fast_dev_run = False
2025-12-22 16:57:53 INFO   limit_train_batches = None
2025-12-22 16:57:53 INFO   limit_val_batches = None
2025-12-22 16:57:53 INFO   log_lr = False
2025-12-22 16:57:53 INFO   progress_bar_refresh_rate = 0
2025-12-22 16:57:53 INFO   log_every_n_steps = 100
2025-12-22 16:57:53 INFO   use_val_spearman_as_secondary = True
2025-12-22 16:57:53 INFO   spearman_secondary_min_delta = 0.0
2025-12-22 16:57:53 INFO   spearman_secondary_weight = 1.0
2025-12-22 16:57:53 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-22 16:57:53 INFO   tuning_max_samples = 500
2025-12-22 16:57:53 INFO   tuning_fraction = None
2025-12-22 16:57:53 INFO   tuning_eval_every = 1
2025-12-22 16:57:53 INFO   rank_loss_weight = 0.0
2025-12-22 16:57:53 INFO   rank_loss_margin = 0.0
2025-12-22 16:57:53 INFO   rank_loss_mode = hinge
2025-12-22 16:57:53 INFO   rank_loss_grouped = True
2025-12-22 16:57:53 INFO   variance_reduction_enabled = False
2025-12-22 16:57:53 INFO   variance_reduction_method = topk_avg
2025-12-22 16:57:53 INFO   variance_reduction_top_k = 3
2025-12-22 16:57:53 INFO   coverage_minimum = 0.0
2025-12-22 16:57:53 INFO   coverage_fail_on_missing = False
2025-12-22 16:57:53 INFO   graph_load_profiling = False
2025-12-22 16:57:53 INFO   graph_load_top_k = 5
2025-12-22 16:57:53 INFO   enable_graph_cache = True
2025-12-22 16:57:53 INFO   graph_cache_size = 256
2025-12-22 16:57:53 INFO   canonicalize_on_load = False
2025-12-22 16:57:53 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-22 16:57:53 INFO   edge_schema = {}
2025-12-22 16:57:53 INFO   topology_schema = {}
Seed set to 222
2025-12-22 16:57:54 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-22 16:57:54 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 16:57:54 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-22 16:57:54 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 16:57:54 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-22 16:57:54 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 16:57:54 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-22 16:57:54 INFO Tuning group stats: groups=352 groups>=2=34 singletons=318 max_group=11
2025-12-22 16:57:54 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-22_16-57-49/dataset_coverage.json
2025-12-22 16:57:54 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-22_16-57-49/dataset_coverage.json for details.
2025-12-22 16:57:54 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-22_16-57-49/dataset_coverage.json for details.
2025-12-22 16:57:54 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-22_16-57-49/dataset_coverage.json for details.
2025-12-22 16:57:54 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-22_16-57-49/schema_summary.json
2025-12-22 16:57:54 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-22_16-57-49/feature_metadata.json
2025-12-22 16:57:54 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-22 16:57:54 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/feature-config.yaml.topoqa.10A.2, sha256=5c62898155179232a565e24d9fbd7b208f9ce480d1a19d6139de19454e173ff0
2025-12-22 16:57:54 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/work/edge_features)
2025-12-22 16:57:54 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json
2025-12-22 16:57:54 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-22_16-57-49/schema_summary.json
2025-12-22 16:57:54 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-22 16:57:54 INFO Topology: topology/persistence_basic/v1 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 172-dimensional node features.
2025-12-22 16:57:54 INFO Node: node/dssp_topo_merge/v1; metadata lists 172 feature columns matching the .pt tensor.
2025-12-22 16:57:54 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-22 16:57:54 INFO → Total feature dimensionality observed and confirmed: node_dim = 172, edge_dim = 11.
2025-12-22 16:57:54 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-22 16:57:54 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 172,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 172,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-22_16-57-49/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge/v1",
      "alias": "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA",
      "jobs": 16,
      "summary": "DSSP-derived node features merged with topology statistics."
    },
    "topology": {
      "id": "topology/persistence_basic/v1",
      "alias": "Betti 0 and Betti 1 topology summaries on interface coords = 140D PH | TopoQA",
      "jobs": 16,
      "summary": "Persistent homology features with configurable distance thresholds."
    }
  },
  "notes": []
}
2025-12-22 16:57:54 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-22 16:57:55 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=9025e196588b4ea48d5f10084c4ca0d3)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-22 16:57:55 INFO Starting training (fast_dev_run=False)
2025-12-22 16:57:55 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-22_16-57-49/model_checkpoints exists and is not empty.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 5.5 K  | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
165 K     Trainable params
0         Non-trainable params
165 K     Total params
0.662     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-22 16:58:10 INFO Epoch 000 | 25% complete (batch 46/181)
2025-12-22 16:58:10 INFO Epoch 000 | 50% complete (batch 91/181)
2025-12-22 16:58:11 INFO Epoch 000 | 75% complete (batch 136/181)
2025-12-22 16:58:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.140895
2025-12-22 16:58:26 INFO Tuning ranking metrics: regret=0.166004 spearman=-0.155449 (groups=34, skipped=318)
2025-12-22 16:58:26 INFO Epoch 000 | val_loss=0.140895
Metric tuning_rank_spearman improved. New best score: -0.155
2025-12-22 16:58:34 INFO Epoch 001 | 25% complete (batch 46/181)
2025-12-22 16:58:35 INFO Epoch 001 | 50% complete (batch 91/181)
2025-12-22 16:58:35 INFO Epoch 001 | 75% complete (batch 136/181)
2025-12-22 16:58:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.177562
2025-12-22 16:58:49 INFO Tuning ranking metrics: regret=0.184962 spearman=-0.194296 (groups=34, skipped=318)
2025-12-22 16:58:49 INFO Epoch 001 | train_mse=0.145038 | val_loss=0.142410 | best_val_loss=-0.155449
2025-12-22 16:58:57 INFO Epoch 002 | 25% complete (batch 46/181)
2025-12-22 16:58:58 INFO Epoch 002 | 50% complete (batch 91/181)
2025-12-22 16:58:58 INFO Epoch 002 | 75% complete (batch 136/181)
2025-12-22 16:59:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.140835
2025-12-22 16:59:11 INFO Tuning ranking metrics: regret=0.170931 spearman=0.074764 (groups=34, skipped=318)
2025-12-22 16:59:11 INFO Epoch 002 | train_mse=0.150288 | val_loss=0.140835 | best_val_loss=-0.155449
Metric tuning_rank_spearman improved by 0.230 >= min_delta = 0.0. New best score: 0.075
2025-12-22 16:59:20 INFO Epoch 003 | 25% complete (batch 46/181)
2025-12-22 16:59:20 INFO Epoch 003 | 50% complete (batch 91/181)
2025-12-22 16:59:21 INFO Epoch 003 | 75% complete (batch 136/181)
2025-12-22 16:59:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.139700
2025-12-22 16:59:34 INFO Tuning ranking metrics: regret=0.122254 spearman=0.039661 (groups=34, skipped=318)
2025-12-22 16:59:34 INFO Epoch 003 | train_mse=0.155875 | val_loss=0.139700 | best_val_loss=0.074764
2025-12-22 16:59:42 INFO Epoch 004 | 25% complete (batch 46/181)
2025-12-22 16:59:43 INFO Epoch 004 | 50% complete (batch 91/181)
2025-12-22 16:59:44 INFO Epoch 004 | 75% complete (batch 136/181)
2025-12-22 16:59:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.443775
2025-12-22 16:59:58 INFO Tuning ranking metrics: regret=0.123319 spearman=-0.140037 (groups=34, skipped=318)
2025-12-22 16:59:58 INFO Epoch 004 | train_mse=0.145399 | val_loss=0.137300 | best_val_loss=0.074764
2025-12-22 17:00:06 INFO Epoch 005 | 25% complete (batch 46/181)
2025-12-22 17:00:06 INFO Epoch 005 | 50% complete (batch 91/181)
2025-12-22 17:00:07 INFO Epoch 005 | 75% complete (batch 136/181)
2025-12-22 17:00:15 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.527402
2025-12-22 17:00:20 INFO Tuning ranking metrics: regret=0.109032 spearman=0.001840 (groups=34, skipped=318)
2025-12-22 17:00:20 INFO Epoch 005 | train_mse=0.152311 | val_loss=0.103689 | best_val_loss=0.074764
2025-12-22 17:00:28 INFO Epoch 006 | 25% complete (batch 46/181)
2025-12-22 17:00:29 INFO Epoch 006 | 50% complete (batch 91/181)
2025-12-22 17:00:30 INFO Epoch 006 | 75% complete (batch 136/181)
2025-12-22 17:00:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.575014
2025-12-22 17:00:43 INFO Tuning ranking metrics: regret=0.113128 spearman=-0.123396 (groups=34, skipped=318)
2025-12-22 17:00:43 INFO Epoch 006 | train_mse=0.128602 | val_loss=0.108928 | best_val_loss=0.074764
2025-12-22 17:00:51 INFO Epoch 007 | 25% complete (batch 46/181)
2025-12-22 17:00:52 INFO Epoch 007 | 50% complete (batch 91/181)
2025-12-22 17:00:52 INFO Epoch 007 | 75% complete (batch 136/181)
2025-12-22 17:01:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.607079
2025-12-22 17:01:06 INFO Tuning ranking metrics: regret=0.084260 spearman=-0.154125 (groups=34, skipped=318)
2025-12-22 17:01:06 INFO Epoch 007 | train_mse=0.127600 | val_loss=0.084225 | best_val_loss=0.074764
2025-12-22 17:01:14 INFO Epoch 008 | 25% complete (batch 46/181)
2025-12-22 17:01:14 INFO Epoch 008 | 50% complete (batch 91/181)
2025-12-22 17:01:15 INFO Epoch 008 | 75% complete (batch 136/181)
2025-12-22 17:01:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.538713
2025-12-22 17:01:28 INFO Tuning ranking metrics: regret=0.079456 spearman=-0.073319 (groups=34, skipped=318)
2025-12-22 17:01:28 INFO Epoch 008 | train_mse=0.120129 | val_loss=0.148332 | best_val_loss=0.074764
2025-12-22 17:01:37 INFO Epoch 009 | 25% complete (batch 46/181)
2025-12-22 17:01:37 INFO Epoch 009 | 50% complete (batch 91/181)
2025-12-22 17:01:38 INFO Epoch 009 | 75% complete (batch 136/181)
2025-12-22 17:01:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.583234
2025-12-22 17:01:51 INFO Tuning ranking metrics: regret=0.092565 spearman=-0.008887 (groups=34, skipped=318)
2025-12-22 17:01:51 INFO Epoch 009 | train_mse=0.076249 | val_loss=0.105018 | best_val_loss=0.074764
2025-12-22 17:01:59 INFO Epoch 010 | 25% complete (batch 46/181)
2025-12-22 17:02:00 INFO Epoch 010 | 50% complete (batch 91/181)
2025-12-22 17:02:01 INFO Epoch 010 | 75% complete (batch 136/181)
2025-12-22 17:02:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.612862
2025-12-22 17:02:14 INFO Tuning ranking metrics: regret=0.098475 spearman=0.025153 (groups=34, skipped=318)
2025-12-22 17:02:14 INFO Epoch 010 | train_mse=0.120616 | val_loss=0.089156 | best_val_loss=0.074764
2025-12-22 17:02:22 INFO Epoch 011 | 25% complete (batch 46/181)
2025-12-22 17:02:23 INFO Epoch 011 | 50% complete (batch 91/181)
2025-12-22 17:02:24 INFO Epoch 011 | 75% complete (batch 136/181)
2025-12-22 17:02:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.565927
2025-12-22 17:02:37 INFO Tuning ranking metrics: regret=0.091874 spearman=0.056659 (groups=34, skipped=318)
2025-12-22 17:02:37 INFO Epoch 011 | train_mse=0.093264 | val_loss=0.101214 | best_val_loss=0.074764
2025-12-22 17:02:45 INFO Epoch 012 | 25% complete (batch 46/181)
2025-12-22 17:02:46 INFO Epoch 012 | 50% complete (batch 91/181)
2025-12-22 17:02:47 INFO Epoch 012 | 75% complete (batch 136/181)
2025-12-22 17:02:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.596035
2025-12-22 17:03:00 INFO Tuning ranking metrics: regret=0.101727 spearman=-0.063503 (groups=34, skipped=318)
2025-12-22 17:03:00 INFO Epoch 012 | train_mse=0.106847 | val_loss=0.109269 | best_val_loss=0.074764
2025-12-22 17:03:08 INFO Epoch 013 | 25% complete (batch 46/181)
2025-12-22 17:03:09 INFO Epoch 013 | 50% complete (batch 91/181)
2025-12-22 17:03:10 INFO Epoch 013 | 75% complete (batch 136/181)
2025-12-22 17:03:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.600249
2025-12-22 17:03:23 INFO Tuning ranking metrics: regret=0.099154 spearman=-0.014388 (groups=34, skipped=318)
2025-12-22 17:03:23 INFO Epoch 013 | train_mse=0.097606 | val_loss=0.090585 | best_val_loss=0.074764
2025-12-22 17:03:31 INFO Epoch 014 | 25% complete (batch 46/181)
2025-12-22 17:03:32 INFO Epoch 014 | 50% complete (batch 91/181)
2025-12-22 17:03:33 INFO Epoch 014 | 75% complete (batch 136/181)
2025-12-22 17:03:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.647788
2025-12-22 17:03:46 INFO Tuning ranking metrics: regret=0.096789 spearman=0.002636 (groups=34, skipped=318)
2025-12-22 17:03:46 INFO Epoch 014 | train_mse=0.079869 | val_loss=0.068029 | best_val_loss=0.074764
2025-12-22 17:03:54 INFO Epoch 015 | 25% complete (batch 46/181)
2025-12-22 17:03:54 INFO Epoch 015 | 50% complete (batch 91/181)
2025-12-22 17:03:55 INFO Epoch 015 | 75% complete (batch 136/181)
2025-12-22 17:04:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.660355
2025-12-22 17:04:09 INFO Tuning ranking metrics: regret=0.096346 spearman=-0.001343 (groups=34, skipped=318)
2025-12-22 17:04:09 INFO Epoch 015 | train_mse=0.087037 | val_loss=0.067519 | best_val_loss=0.074764
2025-12-22 17:04:18 INFO Epoch 016 | 25% complete (batch 46/181)
2025-12-22 17:04:19 INFO Epoch 016 | 50% complete (batch 91/181)
2025-12-22 17:04:21 INFO Epoch 016 | 75% complete (batch 136/181)
2025-12-22 17:04:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.649915
2025-12-22 17:04:36 INFO Tuning ranking metrics: regret=0.098744 spearman=-0.027171 (groups=34, skipped=318)
2025-12-22 17:04:36 INFO Epoch 016 | train_mse=0.084708 | val_loss=0.074404 | best_val_loss=0.074764
2025-12-22 17:04:45 INFO Epoch 017 | 25% complete (batch 46/181)
2025-12-22 17:04:47 INFO Epoch 017 | 50% complete (batch 91/181)
2025-12-22 17:04:48 INFO Epoch 017 | 75% complete (batch 136/181)
2025-12-22 17:04:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.653530
2025-12-22 17:05:02 INFO Tuning ranking metrics: regret=0.096728 spearman=-0.023281 (groups=34, skipped=318)
2025-12-22 17:05:02 INFO Epoch 017 | train_mse=0.090356 | val_loss=0.069346 | best_val_loss=0.074764
2025-12-22 17:05:12 INFO Epoch 018 | 25% complete (batch 46/181)
2025-12-22 17:05:13 INFO Epoch 018 | 50% complete (batch 91/181)
2025-12-22 17:05:14 INFO Epoch 018 | 75% complete (batch 136/181)
2025-12-22 17:05:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.657749
2025-12-22 17:05:29 INFO Tuning ranking metrics: regret=0.096728 spearman=-0.026012 (groups=34, skipped=318)
2025-12-22 17:05:29 INFO Epoch 018 | train_mse=0.073043 | val_loss=0.067776 | best_val_loss=0.074764
2025-12-22 17:05:37 INFO Epoch 019 | 25% complete (batch 46/181)
2025-12-22 17:05:38 INFO Epoch 019 | 50% complete (batch 91/181)
2025-12-22 17:05:39 INFO Epoch 019 | 75% complete (batch 136/181)
2025-12-22 17:05:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.655442
2025-12-22 17:05:52 INFO Tuning ranking metrics: regret=0.096728 spearman=-0.030984 (groups=34, skipped=318)
2025-12-22 17:05:52 INFO Epoch 019 | train_mse=0.077005 | val_loss=0.069949 | best_val_loss=0.074764
2025-12-22 17:06:00 INFO Epoch 020 | 25% complete (batch 46/181)
2025-12-22 17:06:01 INFO Epoch 020 | 50% complete (batch 91/181)
2025-12-22 17:06:02 INFO Epoch 020 | 75% complete (batch 136/181)
2025-12-22 17:06:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.656715
2025-12-22 17:06:15 INFO Tuning ranking metrics: regret=0.097753 spearman=-0.028393 (groups=34, skipped=318)
2025-12-22 17:06:15 INFO Epoch 020 | train_mse=0.067753 | val_loss=0.070102 | best_val_loss=0.074764
2025-12-22 17:06:24 INFO Epoch 021 | 25% complete (batch 46/181)
2025-12-22 17:06:25 INFO Epoch 021 | 50% complete (batch 91/181)
2025-12-22 17:06:25 INFO Epoch 021 | 75% complete (batch 136/181)
2025-12-22 17:06:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.643646
2025-12-22 17:06:39 INFO Tuning ranking metrics: regret=0.096579 spearman=-0.025993 (groups=34, skipped=318)
2025-12-22 17:06:39 INFO Epoch 021 | train_mse=0.067998 | val_loss=0.075977 | best_val_loss=0.074764
2025-12-22 17:06:47 INFO Epoch 022 | 25% complete (batch 46/181)
2025-12-22 17:06:48 INFO Epoch 022 | 50% complete (batch 91/181)
2025-12-22 17:06:49 INFO Epoch 022 | 75% complete (batch 136/181)
2025-12-22 17:06:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.645122
2025-12-22 17:07:02 INFO Tuning ranking metrics: regret=0.097753 spearman=-0.031614 (groups=34, skipped=318)
2025-12-22 17:07:02 INFO Epoch 022 | train_mse=0.083667 | val_loss=0.069589 | best_val_loss=0.074764
Monitored metric tuning_rank_spearman did not improve in the last 20 records. Best score: 0.075. Signaling Trainer to stop.
2025-12-22 17:07:03 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.03966_val-0.13970_epoch003.chkpt, checkpoint.tuning_rank_spearman-0.05666_val-0.10121_epoch011.chkpt, checkpoint.tuning_rank_spearman-0.07476_val-0.14084_epoch002.chkpt
2025-12-22 17:07:03 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-22_16-57-49/model_checkpoints/checkpoint.tuning_rank_spearman-0.07476_val-0.14084_epoch002.chkpt
2025-12-22 17:07:03 INFO Best validation loss: tensor(0.0748)
2025-12-22 17:07:03 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-22_16-57-49/model_checkpoints/checkpoint.tuning_rank_spearman-0.07476_val-0.14084_epoch002.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-22_16-57-49/model_checkpoints/checkpoint.tuning_rank_spearman-0.07476_val-0.14084_epoch002.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-22 17:07:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.140835
2025-12-22 17:07:15 INFO Tuning ranking metrics: regret=0.170931 spearman=0.074764 (groups=34, skipped=318)
2025-12-22 17:07:15 INFO Epoch 023 | val_loss=0.140835 | best_val_loss=0.074764
2025-12-22 17:07:15 INFO Validation metrics: [{'val_loss': 0.14083541929721832, 'tuning_rank_regret': 0.17093133926391602, 'tuning_rank_spearman': 0.07476445287466049, 'val_pearson_corr': -0.5378274321556091, 'val_spearman_corr': -0.6024363040924072, 'val_rank_regret': 0.23782885074615479, 'val_rank_spearman': -0.4444444477558136}]
2025-12-22 17:07:15 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.07476_val-0.14084_epoch002.chkpt
2025-12-22 17:07:15 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.03966_val-0.13970_epoch003.chkpt
2025-12-22 17:07:15 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.05666_val-0.10121_epoch011.chkpt
2025-12-22 17:07:15 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.14090_epoch000.ckpt
2025-12-22 17:07:15 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.17093133926391602
  tuning_rank_spearman      0.07476445287466049
        val_loss            0.14083541929721832
    val_pearson_corr        -0.5378274321556091
     val_rank_regret        0.23782885074615479
    val_rank_spearman       -0.4444444477558136
    val_spearman_corr       -0.6024363040924072
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run large_batch_sched_boost_lean_seed222_2025-12-22_16-57-49 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-22_16-57-49
[train_cli][batch] job 'large_batch_sched_boost_lean_seed222' finished.
[run_full_pipeline] Best run: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57 (tuning_rank_spearman=0.03668831288814545)
[run_full_pipeline] Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57/model_checkpoints/checkpoint.tuning_rank_spearman-0.03669_val-0.11762_epoch018.chkpt
[run_full_pipeline] Phase 1 fine-tuning -> sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase1
[train_cli] run_id=sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase1 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase1/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase1 --git-commit 150d1dcbd1 --git-dirty --resume-from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57/model_checkpoints/checkpoint.tuning_rank_spearman-0.03669_val-0.11762_epoch018.chkpt
2025-12-22 17:07:21 INFO git_commit = 150d1dcbd1 (dirty)
2025-12-22 17:07:21 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-22 17:07:21 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase1/config/config.yaml
2025-12-22 17:07:21 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data
2025-12-22 17:07:21 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-22 17:07:21 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-22 17:07:21 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase1
2025-12-22 17:07:21 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-22 17:07:21 INFO   metadata_path = None
2025-12-22 17:07:21 INFO   summary_path = None
2025-12-22 17:07:21 INFO   accelerator = cpu
2025-12-22 17:07:21 INFO   devices = 1
2025-12-22 17:07:21 INFO   attention_head = 8
2025-12-22 17:07:21 INFO   pooling_type = mean
2025-12-22 17:07:21 INFO   model_self_loops = False
2025-12-22 17:07:21 INFO   model_self_loop_fill = mean
2025-12-22 17:07:21 INFO   model_residual = False
2025-12-22 17:07:21 INFO   batch_size = 48
2025-12-22 17:07:21 INFO   learning_rate = 0.001
2025-12-22 17:07:21 INFO   num_epochs = 320
2025-12-22 17:07:21 INFO   accumulate_grad_batches = 8
2025-12-22 17:07:21 INFO   seed = 222
2025-12-22 17:07:21 INFO   num_workers = 2
2025-12-22 17:07:21 INFO   precision = 32
2025-12-22 17:07:21 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-22 17:07:21 INFO   early_stopping_patience = 20
2025-12-22 17:07:21 INFO   lr_scheduler_patience = 4
2025-12-22 17:07:21 INFO   lr_scheduler_factor = 0.2
2025-12-22 17:07:21 INFO   fast_dev_run = False
2025-12-22 17:07:21 INFO   limit_train_batches = None
2025-12-22 17:07:21 INFO   limit_val_batches = None
2025-12-22 17:07:21 INFO   log_lr = False
2025-12-22 17:07:21 INFO   progress_bar_refresh_rate = 0
2025-12-22 17:07:21 INFO   log_every_n_steps = 100
2025-12-22 17:07:21 INFO   use_val_spearman_as_secondary = True
2025-12-22 17:07:21 INFO   spearman_secondary_min_delta = 0.0
2025-12-22 17:07:21 INFO   spearman_secondary_weight = 1.0
2025-12-22 17:07:21 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-22 17:07:21 INFO   tuning_max_samples = 500
2025-12-22 17:07:21 INFO   tuning_fraction = None
2025-12-22 17:07:21 INFO   tuning_eval_every = 1
2025-12-22 17:07:21 INFO   rank_loss_weight = 0.0
2025-12-22 17:07:21 INFO   rank_loss_margin = 0.0
2025-12-22 17:07:21 INFO   rank_loss_mode = hinge
2025-12-22 17:07:21 INFO   rank_loss_grouped = True
2025-12-22 17:07:21 INFO   variance_reduction_enabled = False
2025-12-22 17:07:21 INFO   variance_reduction_method = topk_avg
2025-12-22 17:07:21 INFO   variance_reduction_top_k = 3
2025-12-22 17:07:21 INFO   coverage_minimum = 0.0
2025-12-22 17:07:21 INFO   coverage_fail_on_missing = False
2025-12-22 17:07:21 INFO   graph_load_profiling = False
2025-12-22 17:07:21 INFO   graph_load_top_k = 5
2025-12-22 17:07:21 INFO   enable_graph_cache = True
2025-12-22 17:07:21 INFO   graph_cache_size = 256
2025-12-22 17:07:21 INFO   canonicalize_on_load = False
2025-12-22 17:07:21 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-22 17:07:21 INFO   edge_schema = {}
2025-12-22 17:07:21 INFO   topology_schema = {}
Seed set to 222
2025-12-22 17:07:22 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-22 17:07:22 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 17:07:22 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-22 17:07:22 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 17:07:22 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-22 17:07:22 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 17:07:23 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-22 17:07:23 INFO Tuning group stats: groups=352 groups>=2=34 singletons=318 max_group=11
2025-12-22 17:07:23 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase1/dataset_coverage.json
2025-12-22 17:07:23 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase1/dataset_coverage.json for details.
2025-12-22 17:07:23 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase1/dataset_coverage.json for details.
2025-12-22 17:07:23 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase1/dataset_coverage.json for details.
2025-12-22 17:07:23 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase1/schema_summary.json
2025-12-22 17:07:23 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase1/feature_metadata.json
2025-12-22 17:07:23 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-22 17:07:23 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/feature-config.yaml.topoqa.10A.2, sha256=5c62898155179232a565e24d9fbd7b208f9ce480d1a19d6139de19454e173ff0
2025-12-22 17:07:23 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/work/edge_features)
2025-12-22 17:07:23 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json
2025-12-22 17:07:23 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase1/schema_summary.json
2025-12-22 17:07:23 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-22 17:07:23 INFO Topology: topology/persistence_basic/v1 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 172-dimensional node features.
2025-12-22 17:07:23 INFO Node: node/dssp_topo_merge/v1; metadata lists 172 feature columns matching the .pt tensor.
2025-12-22 17:07:23 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-22 17:07:23 INFO → Total feature dimensionality observed and confirmed: node_dim = 172, edge_dim = 11.
2025-12-22 17:07:23 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-22 17:07:23 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 172,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 172,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase1/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge/v1",
      "alias": "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA",
      "jobs": 16,
      "summary": "DSSP-derived node features merged with topology statistics."
    },
    "topology": {
      "id": "topology/persistence_basic/v1",
      "alias": "Betti 0 and Betti 1 topology summaries on interface coords = 140D PH | TopoQA",
      "jobs": 16,
      "summary": "Persistent homology features with configurable distance thresholds."
    }
  },
  "notes": []
}
2025-12-22 17:07:23 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-22 17:07:23 INFO Resuming from checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57/model_checkpoints/checkpoint.tuning_rank_spearman-0.03669_val-0.11762_epoch018.chkpt (epoch=18)
2025-12-22 17:07:23 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=9eded39a18c1472d9e41725f6b00458c)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-22 17:07:23 INFO Starting training (fast_dev_run=False)
2025-12-22 17:07:23 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase1/model_checkpoints exists and is not empty.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57/model_checkpoints/checkpoint.tuning_rank_spearman-0.03669_val-0.11762_epoch018.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57/model_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase1/model_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57/model_checkpoints/val_loss_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase1/model_checkpoints/val_loss_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 5.5 K  | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
165 K     Trainable params
0         Non-trainable params
165 K     Total params
0.662     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
Restored all states from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57/model_checkpoints/checkpoint.tuning_rank_spearman-0.03669_val-0.11762_epoch018.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-22 17:07:37 INFO Epoch 019 | 25% complete (batch 46/181)
2025-12-22 17:07:38 INFO Epoch 019 | 50% complete (batch 91/181)
2025-12-22 17:07:39 INFO Epoch 019 | 75% complete (batch 136/181)
2025-12-22 17:07:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.079805
2025-12-22 17:07:52 INFO Tuning ranking metrics: regret=0.094115 spearman=-0.028457 (groups=34, skipped=318)
2025-12-22 17:07:52 INFO Epoch 019 | val_loss=0.079805
2025-12-22 17:08:00 INFO Epoch 020 | 25% complete (batch 46/181)
2025-12-22 17:08:01 INFO Epoch 020 | 50% complete (batch 91/181)
2025-12-22 17:08:01 INFO Epoch 020 | 75% complete (batch 136/181)
2025-12-22 17:08:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.635020
2025-12-22 17:08:15 INFO Tuning ranking metrics: regret=0.088764 spearman=-0.012962 (groups=34, skipped=318)
2025-12-22 17:08:15 INFO Epoch 020 | train_mse=0.090688 | val_loss=0.065590 | best_val_loss=-0.028457
2025-12-22 17:08:23 INFO Epoch 021 | 25% complete (batch 46/181)
2025-12-22 17:08:24 INFO Epoch 021 | 50% complete (batch 91/181)
2025-12-22 17:08:25 INFO Epoch 021 | 75% complete (batch 136/181)
2025-12-22 17:08:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.651137
2025-12-22 17:08:39 INFO Tuning ranking metrics: regret=0.090951 spearman=-0.009657 (groups=34, skipped=318)
2025-12-22 17:08:39 INFO Epoch 021 | train_mse=0.077708 | val_loss=0.063540 | best_val_loss=-0.012962
2025-12-22 17:08:47 INFO Epoch 022 | 25% complete (batch 46/181)
2025-12-22 17:08:47 INFO Epoch 022 | 50% complete (batch 91/181)
2025-12-22 17:08:48 INFO Epoch 022 | 75% complete (batch 136/181)
2025-12-22 17:08:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.672370
2025-12-22 17:09:02 INFO Tuning ranking metrics: regret=0.091401 spearman=-0.022409 (groups=34, skipped=318)
2025-12-22 17:09:02 INFO Epoch 022 | train_mse=0.065755 | val_loss=0.073210 | best_val_loss=-0.009657
2025-12-22 17:09:10 INFO Epoch 023 | 25% complete (batch 46/181)
2025-12-22 17:09:11 INFO Epoch 023 | 50% complete (batch 91/181)
2025-12-22 17:09:12 INFO Epoch 023 | 75% complete (batch 136/181)
2025-12-22 17:09:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.648936
2025-12-22 17:09:26 INFO Tuning ranking metrics: regret=0.106426 spearman=-0.014706 (groups=34, skipped=318)
2025-12-22 17:09:26 INFO Epoch 023 | train_mse=0.075215 | val_loss=0.082660 | best_val_loss=-0.009657
2025-12-22 17:09:34 INFO Epoch 024 | 25% complete (batch 46/181)
2025-12-22 17:09:35 INFO Epoch 024 | 50% complete (batch 91/181)
2025-12-22 17:09:36 INFO Epoch 024 | 75% complete (batch 136/181)
2025-12-22 17:09:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.656215
2025-12-22 17:09:50 INFO Tuning ranking metrics: regret=0.107884 spearman=-0.066017 (groups=34, skipped=318)
2025-12-22 17:09:50 INFO Epoch 024 | train_mse=0.077219 | val_loss=0.076252 | best_val_loss=-0.009657
2025-12-22 17:09:59 INFO Epoch 025 | 25% complete (batch 46/181)
2025-12-22 17:10:00 INFO Epoch 025 | 50% complete (batch 91/181)
2025-12-22 17:10:01 INFO Epoch 025 | 75% complete (batch 136/181)
2025-12-22 17:10:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.615344
2025-12-22 17:10:14 INFO Tuning ranking metrics: regret=0.107423 spearman=-0.046244 (groups=34, skipped=318)
2025-12-22 17:10:14 INFO Epoch 025 | train_mse=0.079045 | val_loss=0.107080 | best_val_loss=-0.009657
2025-12-22 17:10:22 INFO Epoch 026 | 25% complete (batch 46/181)
2025-12-22 17:10:23 INFO Epoch 026 | 50% complete (batch 91/181)
2025-12-22 17:10:24 INFO Epoch 026 | 75% complete (batch 136/181)
2025-12-22 17:10:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.665205
2025-12-22 17:10:38 INFO Tuning ranking metrics: regret=0.090214 spearman=-0.056602 (groups=34, skipped=318)
2025-12-22 17:10:38 INFO Epoch 026 | train_mse=0.082979 | val_loss=0.063456 | best_val_loss=-0.009657
2025-12-22 17:10:46 INFO Epoch 027 | 25% complete (batch 46/181)
2025-12-22 17:10:47 INFO Epoch 027 | 50% complete (batch 91/181)
2025-12-22 17:10:47 INFO Epoch 027 | 75% complete (batch 136/181)
2025-12-22 17:10:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.651110
2025-12-22 17:11:01 INFO Tuning ranking metrics: regret=0.077965 spearman=-0.029794 (groups=34, skipped=318)
2025-12-22 17:11:01 INFO Epoch 027 | train_mse=0.081397 | val_loss=0.081978 | best_val_loss=-0.009657
2025-12-22 17:11:09 INFO Epoch 028 | 25% complete (batch 46/181)
2025-12-22 17:11:10 INFO Epoch 028 | 50% complete (batch 91/181)
2025-12-22 17:11:11 INFO Epoch 028 | 75% complete (batch 136/181)
2025-12-22 17:11:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.664530
2025-12-22 17:11:24 INFO Tuning ranking metrics: regret=0.074992 spearman=-0.060396 (groups=34, skipped=318)
2025-12-22 17:11:24 INFO Epoch 028 | train_mse=0.045711 | val_loss=0.072850 | best_val_loss=-0.009657
2025-12-22 17:11:33 INFO Epoch 029 | 25% complete (batch 46/181)
2025-12-22 17:11:34 INFO Epoch 029 | 50% complete (batch 91/181)
2025-12-22 17:11:35 INFO Epoch 029 | 75% complete (batch 136/181)
2025-12-22 17:11:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.653450
2025-12-22 17:11:48 INFO Tuning ranking metrics: regret=0.072110 spearman=0.061968 (groups=34, skipped=318)
2025-12-22 17:11:48 INFO Epoch 029 | train_mse=0.083397 | val_loss=0.073769 | best_val_loss=-0.009657
Metric tuning_rank_spearman improved by 0.025 >= min_delta = 0.0. New best score: 0.062
2025-12-22 17:11:57 INFO Epoch 030 | 25% complete (batch 46/181)
2025-12-22 17:11:57 INFO Epoch 030 | 50% complete (batch 91/181)
2025-12-22 17:11:58 INFO Epoch 030 | 75% complete (batch 136/181)
2025-12-22 17:12:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.651800
2025-12-22 17:12:12 INFO Tuning ranking metrics: regret=0.087240 spearman=0.000509 (groups=34, skipped=318)
2025-12-22 17:12:12 INFO Epoch 030 | train_mse=0.068565 | val_loss=0.070020 | best_val_loss=0.061968
2025-12-22 17:12:20 INFO Epoch 031 | 25% complete (batch 46/181)
2025-12-22 17:12:21 INFO Epoch 031 | 50% complete (batch 91/181)
2025-12-22 17:12:22 INFO Epoch 031 | 75% complete (batch 136/181)
2025-12-22 17:12:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.662184
2025-12-22 17:12:36 INFO Tuning ranking metrics: regret=0.071708 spearman=-0.000051 (groups=34, skipped=318)
2025-12-22 17:12:36 INFO Epoch 031 | train_mse=0.093543 | val_loss=0.069932 | best_val_loss=0.061968
2025-12-22 17:12:45 INFO Epoch 032 | 25% complete (batch 46/181)
2025-12-22 17:12:46 INFO Epoch 032 | 50% complete (batch 91/181)
2025-12-22 17:12:47 INFO Epoch 032 | 75% complete (batch 136/181)
2025-12-22 17:12:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.657862
2025-12-22 17:13:02 INFO Tuning ranking metrics: regret=0.071948 spearman=0.051859 (groups=34, skipped=318)
2025-12-22 17:13:02 INFO Epoch 032 | train_mse=0.075698 | val_loss=0.074975 | best_val_loss=0.061968
2025-12-22 17:13:10 INFO Epoch 033 | 25% complete (batch 46/181)
2025-12-22 17:13:11 INFO Epoch 033 | 50% complete (batch 91/181)
2025-12-22 17:13:12 INFO Epoch 033 | 75% complete (batch 136/181)
2025-12-22 17:13:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.663332
2025-12-22 17:13:27 INFO Tuning ranking metrics: regret=0.081474 spearman=-0.088484 (groups=34, skipped=318)
2025-12-22 17:13:27 INFO Epoch 033 | train_mse=0.065450 | val_loss=0.064893 | best_val_loss=0.061968
2025-12-22 17:13:35 INFO Epoch 034 | 25% complete (batch 46/181)
2025-12-22 17:13:36 INFO Epoch 034 | 50% complete (batch 91/181)
2025-12-22 17:13:37 INFO Epoch 034 | 75% complete (batch 136/181)
2025-12-22 17:13:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.694136
2025-12-22 17:13:50 INFO Tuning ranking metrics: regret=0.074226 spearman=0.015966 (groups=34, skipped=318)
2025-12-22 17:13:50 INFO Epoch 034 | train_mse=0.072002 | val_loss=0.067858 | best_val_loss=0.061968
2025-12-22 17:13:59 INFO Epoch 035 | 25% complete (batch 46/181)
2025-12-22 17:13:59 INFO Epoch 035 | 50% complete (batch 91/181)
2025-12-22 17:14:00 INFO Epoch 035 | 75% complete (batch 136/181)
2025-12-22 17:14:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.694690
2025-12-22 17:14:15 INFO Tuning ranking metrics: regret=0.074226 spearman=0.001362 (groups=34, skipped=318)
2025-12-22 17:14:15 INFO Epoch 035 | train_mse=0.083211 | val_loss=0.066266 | best_val_loss=0.061968
2025-12-22 17:14:24 INFO Epoch 036 | 25% complete (batch 46/181)
2025-12-22 17:14:25 INFO Epoch 036 | 50% complete (batch 91/181)
2025-12-22 17:14:26 INFO Epoch 036 | 75% complete (batch 136/181)
2025-12-22 17:14:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.695364
2025-12-22 17:14:42 INFO Tuning ranking metrics: regret=0.081698 spearman=-0.098472 (groups=34, skipped=318)
2025-12-22 17:14:42 INFO Epoch 036 | train_mse=0.075841 | val_loss=0.060259 | best_val_loss=0.061968
2025-12-22 17:14:51 INFO Epoch 037 | 25% complete (batch 46/181)
2025-12-22 17:14:52 INFO Epoch 037 | 50% complete (batch 91/181)
2025-12-22 17:14:53 INFO Epoch 037 | 75% complete (batch 136/181)
2025-12-22 17:15:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.702407
2025-12-22 17:15:09 INFO Tuning ranking metrics: regret=0.078971 spearman=-0.036077 (groups=34, skipped=318)
2025-12-22 17:15:09 INFO Epoch 037 | train_mse=0.072847 | val_loss=0.058850 | best_val_loss=0.061968
2025-12-22 17:15:17 INFO Epoch 038 | 25% complete (batch 46/181)
2025-12-22 17:15:18 INFO Epoch 038 | 50% complete (batch 91/181)
2025-12-22 17:15:19 INFO Epoch 038 | 75% complete (batch 136/181)
2025-12-22 17:15:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.690077
2025-12-22 17:15:32 INFO Tuning ranking metrics: regret=0.083015 spearman=-0.094245 (groups=34, skipped=318)
2025-12-22 17:15:32 INFO Epoch 038 | train_mse=0.065279 | val_loss=0.062109 | best_val_loss=0.061968
2025-12-22 17:15:41 INFO Epoch 039 | 25% complete (batch 46/181)
2025-12-22 17:15:41 INFO Epoch 039 | 50% complete (batch 91/181)
2025-12-22 17:15:42 INFO Epoch 039 | 75% complete (batch 136/181)
2025-12-22 17:15:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.689557
2025-12-22 17:15:56 INFO Tuning ranking metrics: regret=0.073295 spearman=0.002317 (groups=34, skipped=318)
2025-12-22 17:15:56 INFO Epoch 039 | train_mse=0.061885 | val_loss=0.062226 | best_val_loss=0.061968
2025-12-22 17:16:04 INFO Epoch 040 | 25% complete (batch 46/181)
2025-12-22 17:16:05 INFO Epoch 040 | 50% complete (batch 91/181)
2025-12-22 17:16:05 INFO Epoch 040 | 75% complete (batch 136/181)
2025-12-22 17:16:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.675492
2025-12-22 17:16:19 INFO Tuning ranking metrics: regret=0.073295 spearman=0.013337 (groups=34, skipped=318)
2025-12-22 17:16:19 INFO Epoch 040 | train_mse=0.057751 | val_loss=0.066667 | best_val_loss=0.061968
2025-12-22 17:16:27 INFO Epoch 041 | 25% complete (batch 46/181)
2025-12-22 17:16:28 INFO Epoch 041 | 50% complete (batch 91/181)
2025-12-22 17:16:29 INFO Epoch 041 | 75% complete (batch 136/181)
2025-12-22 17:16:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.676513
2025-12-22 17:16:43 INFO Tuning ranking metrics: regret=0.073295 spearman=0.018608 (groups=34, skipped=318)
2025-12-22 17:16:43 INFO Epoch 041 | train_mse=0.079518 | val_loss=0.062310 | best_val_loss=0.061968
2025-12-22 17:16:51 INFO Epoch 042 | 25% complete (batch 46/181)
2025-12-22 17:16:52 INFO Epoch 042 | 50% complete (batch 91/181)
2025-12-22 17:16:52 INFO Epoch 042 | 75% complete (batch 136/181)
2025-12-22 17:17:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.671161
2025-12-22 17:17:06 INFO Tuning ranking metrics: regret=0.081683 spearman=-0.064738 (groups=34, skipped=318)
2025-12-22 17:17:06 INFO Epoch 042 | train_mse=0.074551 | val_loss=0.070579 | best_val_loss=0.061968
2025-12-22 17:17:14 INFO Epoch 043 | 25% complete (batch 46/181)
2025-12-22 17:17:15 INFO Epoch 043 | 50% complete (batch 91/181)
2025-12-22 17:17:16 INFO Epoch 043 | 75% complete (batch 136/181)
2025-12-22 17:17:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.684972
2025-12-22 17:17:29 INFO Tuning ranking metrics: regret=0.077464 spearman=-0.035606 (groups=34, skipped=318)
2025-12-22 17:17:29 INFO Epoch 043 | train_mse=0.062221 | val_loss=0.062502 | best_val_loss=0.061968
2025-12-22 17:17:37 INFO Epoch 044 | 25% complete (batch 46/181)
2025-12-22 17:17:38 INFO Epoch 044 | 50% complete (batch 91/181)
2025-12-22 17:17:39 INFO Epoch 044 | 75% complete (batch 136/181)
2025-12-22 17:17:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.678234
2025-12-22 17:17:52 INFO Tuning ranking metrics: regret=0.076937 spearman=-0.013611 (groups=34, skipped=318)
2025-12-22 17:17:52 INFO Epoch 044 | train_mse=0.056569 | val_loss=0.062969 | best_val_loss=0.061968
2025-12-22 17:18:00 INFO Epoch 045 | 25% complete (batch 46/181)
2025-12-22 17:18:01 INFO Epoch 045 | 50% complete (batch 91/181)
2025-12-22 17:18:02 INFO Epoch 045 | 75% complete (batch 136/181)
2025-12-22 17:18:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.680979
2025-12-22 17:18:15 INFO Tuning ranking metrics: regret=0.072878 spearman=0.046339 (groups=34, skipped=318)
2025-12-22 17:18:15 INFO Epoch 045 | train_mse=0.070148 | val_loss=0.062605 | best_val_loss=0.061968
2025-12-22 17:18:23 INFO Epoch 046 | 25% complete (batch 46/181)
2025-12-22 17:18:24 INFO Epoch 046 | 50% complete (batch 91/181)
2025-12-22 17:18:25 INFO Epoch 046 | 75% complete (batch 136/181)
2025-12-22 17:18:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.679479
2025-12-22 17:18:38 INFO Tuning ranking metrics: regret=0.081683 spearman=-0.063802 (groups=34, skipped=318)
2025-12-22 17:18:38 INFO Epoch 046 | train_mse=0.063607 | val_loss=0.061573 | best_val_loss=0.061968
2025-12-22 17:18:47 INFO Epoch 047 | 25% complete (batch 46/181)
2025-12-22 17:18:48 INFO Epoch 047 | 50% complete (batch 91/181)
2025-12-22 17:18:49 INFO Epoch 047 | 75% complete (batch 136/181)
2025-12-22 17:18:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.686064
2025-12-22 17:19:02 INFO Tuning ranking metrics: regret=0.081683 spearman=-0.063802 (groups=34, skipped=318)
2025-12-22 17:19:02 INFO Epoch 047 | train_mse=0.052155 | val_loss=0.061595 | best_val_loss=0.061968
2025-12-22 17:19:10 INFO Epoch 048 | 25% complete (batch 46/181)
2025-12-22 17:19:11 INFO Epoch 048 | 50% complete (batch 91/181)
2025-12-22 17:19:12 INFO Epoch 048 | 75% complete (batch 136/181)
2025-12-22 17:19:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.685438
2025-12-22 17:19:26 INFO Tuning ranking metrics: regret=0.076922 spearman=-0.010861 (groups=34, skipped=318)
2025-12-22 17:19:26 INFO Epoch 048 | train_mse=0.055025 | val_loss=0.062137 | best_val_loss=0.061968
2025-12-22 17:19:35 INFO Epoch 049 | 25% complete (batch 46/181)
2025-12-22 17:19:35 INFO Epoch 049 | 50% complete (batch 91/181)
2025-12-22 17:19:36 INFO Epoch 049 | 75% complete (batch 136/181)
2025-12-22 17:19:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.681262
2025-12-22 17:19:49 INFO Tuning ranking metrics: regret=0.081683 spearman=-0.063802 (groups=34, skipped=318)
2025-12-22 17:19:49 INFO Epoch 049 | train_mse=0.070845 | val_loss=0.061366 | best_val_loss=0.061968
2025-12-22 17:19:57 INFO Epoch 050 | 25% complete (batch 46/181)
2025-12-22 17:19:58 INFO Epoch 050 | 50% complete (batch 91/181)
2025-12-22 17:19:59 INFO Epoch 050 | 75% complete (batch 136/181)
2025-12-22 17:20:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.680894
2025-12-22 17:20:12 INFO Tuning ranking metrics: regret=0.082100 spearman=-0.063713 (groups=34, skipped=318)
2025-12-22 17:20:12 INFO Epoch 050 | train_mse=0.068725 | val_loss=0.061517 | best_val_loss=0.061968
2025-12-22 17:20:20 INFO Epoch 051 | 25% complete (batch 46/181)
2025-12-22 17:20:21 INFO Epoch 051 | 50% complete (batch 91/181)
2025-12-22 17:20:22 INFO Epoch 051 | 75% complete (batch 136/181)
2025-12-22 17:20:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.683292
2025-12-22 17:20:36 INFO Tuning ranking metrics: regret=0.073280 spearman=0.039579 (groups=34, skipped=318)
2025-12-22 17:20:36 INFO Epoch 051 | train_mse=0.072190 | val_loss=0.062020 | best_val_loss=0.061968
2025-12-22 17:20:46 INFO Epoch 052 | 25% complete (batch 46/181)
2025-12-22 17:20:47 INFO Epoch 052 | 50% complete (batch 91/181)
2025-12-22 17:20:48 INFO Epoch 052 | 75% complete (batch 136/181)
2025-12-22 17:20:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.682804
2025-12-22 17:21:04 INFO Tuning ranking metrics: regret=0.077338 spearman=-0.019245 (groups=34, skipped=318)
2025-12-22 17:21:04 INFO Epoch 052 | train_mse=0.068154 | val_loss=0.061769 | best_val_loss=0.061968
2025-12-22 17:21:13 INFO Epoch 053 | 25% complete (batch 46/181)
2025-12-22 17:21:14 INFO Epoch 053 | 50% complete (batch 91/181)
2025-12-22 17:21:15 INFO Epoch 053 | 75% complete (batch 136/181)
2025-12-22 17:21:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.683008
2025-12-22 17:21:31 INFO Tuning ranking metrics: regret=0.082100 spearman=-0.069245 (groups=34, skipped=318)
2025-12-22 17:21:31 INFO Epoch 053 | train_mse=0.066184 | val_loss=0.061549 | best_val_loss=0.061968
Monitored metric tuning_rank_spearman did not improve in the last 24 records. Best score: 0.062. Signaling Trainer to stop.
2025-12-22 17:21:32 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.04634_val-0.06261_epoch045.chkpt, checkpoint.tuning_rank_spearman-0.05186_val-0.07497_epoch032.chkpt, checkpoint.tuning_rank_spearman-0.06197_val-0.07377_epoch029.chkpt
2025-12-22 17:21:32 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.06197_val-0.07377_epoch029.chkpt
2025-12-22 17:21:32 INFO Best validation loss: tensor(0.0620)
2025-12-22 17:21:32 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.06197_val-0.07377_epoch029.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.06197_val-0.07377_epoch029.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-22 17:21:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.073769
2025-12-22 17:21:45 INFO Tuning ranking metrics: regret=0.072110 spearman=0.061968 (groups=34, skipped=318)
2025-12-22 17:21:45 INFO Epoch 054 | val_loss=0.073769 | best_val_loss=0.061968
2025-12-22 17:21:45 INFO Validation metrics: [{'val_loss': 0.07376911491155624, 'tuning_rank_regret': 0.07211048901081085, 'tuning_rank_spearman': 0.061968423426151276, 'val_pearson_corr': 0.7142950892448425, 'val_spearman_corr': 0.7218202948570251, 'val_rank_regret': 0.006356073077768087, 'val_rank_spearman': 0.6666666865348816}]
2025-12-22 17:21:45 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.06197_val-0.07377_epoch029.chkpt
2025-12-22 17:21:45 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.05186_val-0.07497_epoch032.chkpt
2025-12-22 17:21:45 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.04634_val-0.06261_epoch045.chkpt
2025-12-22 17:21:45 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.06346_epoch026.ckpt
2025-12-22 17:21:45 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.07211048901081085
  tuning_rank_spearman     0.061968423426151276
        val_loss            0.07376911491155624
    val_pearson_corr        0.7142950892448425
     val_rank_regret       0.006356073077768087
    val_rank_spearman       0.6666666865348816
    val_spearman_corr       0.7218202948570251
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase1 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase1
[run_full_pipeline] Phase 1 best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.06197_val-0.07377_epoch029.chkpt (tuning_rank_spearman=0.061968423426151276)
[run_full_pipeline] Phase 2 fine-tuning (seed 101) -> sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed101
[train_cli] run_id=sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed101 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed101/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed101 --git-commit 150d1dcbd1 --git-dirty --resume-from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.06197_val-0.07377_epoch029.chkpt
2025-12-22 17:21:51 INFO git_commit = 150d1dcbd1 (dirty)
2025-12-22 17:21:51 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-22 17:21:51 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed101/config/config.yaml
2025-12-22 17:21:51 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data
2025-12-22 17:21:51 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-22 17:21:51 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-22 17:21:51 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed101
2025-12-22 17:21:51 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-22 17:21:51 INFO   metadata_path = None
2025-12-22 17:21:51 INFO   summary_path = None
2025-12-22 17:21:51 INFO   accelerator = cpu
2025-12-22 17:21:51 INFO   devices = 1
2025-12-22 17:21:51 INFO   attention_head = 8
2025-12-22 17:21:51 INFO   pooling_type = mean
2025-12-22 17:21:51 INFO   model_self_loops = False
2025-12-22 17:21:51 INFO   model_self_loop_fill = mean
2025-12-22 17:21:51 INFO   model_residual = False
2025-12-22 17:21:51 INFO   batch_size = 48
2025-12-22 17:21:51 INFO   learning_rate = 0.001
2025-12-22 17:21:51 INFO   num_epochs = 320
2025-12-22 17:21:51 INFO   accumulate_grad_batches = 8
2025-12-22 17:21:51 INFO   seed = 101
2025-12-22 17:21:51 INFO   num_workers = 2
2025-12-22 17:21:51 INFO   precision = 32
2025-12-22 17:21:51 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-22 17:21:51 INFO   early_stopping_patience = 20
2025-12-22 17:21:51 INFO   lr_scheduler_patience = 4
2025-12-22 17:21:51 INFO   lr_scheduler_factor = 0.2
2025-12-22 17:21:51 INFO   fast_dev_run = False
2025-12-22 17:21:51 INFO   limit_train_batches = None
2025-12-22 17:21:51 INFO   limit_val_batches = None
2025-12-22 17:21:51 INFO   log_lr = False
2025-12-22 17:21:51 INFO   progress_bar_refresh_rate = 0
2025-12-22 17:21:51 INFO   log_every_n_steps = 100
2025-12-22 17:21:51 INFO   use_val_spearman_as_secondary = True
2025-12-22 17:21:51 INFO   spearman_secondary_min_delta = 0.0
2025-12-22 17:21:51 INFO   spearman_secondary_weight = 1.0
2025-12-22 17:21:51 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-22 17:21:51 INFO   tuning_max_samples = 500
2025-12-22 17:21:51 INFO   tuning_fraction = None
2025-12-22 17:21:51 INFO   tuning_eval_every = 1
2025-12-22 17:21:51 INFO   rank_loss_weight = 0.0
2025-12-22 17:21:51 INFO   rank_loss_margin = 0.0
2025-12-22 17:21:51 INFO   rank_loss_mode = hinge
2025-12-22 17:21:51 INFO   rank_loss_grouped = True
2025-12-22 17:21:51 INFO   variance_reduction_enabled = False
2025-12-22 17:21:51 INFO   variance_reduction_method = topk_avg
2025-12-22 17:21:51 INFO   variance_reduction_top_k = 3
2025-12-22 17:21:51 INFO   coverage_minimum = 0.0
2025-12-22 17:21:51 INFO   coverage_fail_on_missing = False
2025-12-22 17:21:51 INFO   graph_load_profiling = False
2025-12-22 17:21:51 INFO   graph_load_top_k = 5
2025-12-22 17:21:51 INFO   enable_graph_cache = True
2025-12-22 17:21:51 INFO   graph_cache_size = 256
2025-12-22 17:21:51 INFO   canonicalize_on_load = False
2025-12-22 17:21:51 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-22 17:21:51 INFO   edge_schema = {}
2025-12-22 17:21:51 INFO   topology_schema = {}
Seed set to 101
2025-12-22 17:21:52 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-22 17:21:52 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 17:21:52 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-22 17:21:52 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 17:21:52 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-22 17:21:52 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 17:21:53 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-22 17:21:53 INFO Tuning group stats: groups=348 groups>=2=37 singletons=311 max_group=11
2025-12-22 17:21:53 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed101/dataset_coverage.json
2025-12-22 17:21:53 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed101/dataset_coverage.json for details.
2025-12-22 17:21:53 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed101/dataset_coverage.json for details.
2025-12-22 17:21:53 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed101/dataset_coverage.json for details.
2025-12-22 17:21:53 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed101/schema_summary.json
2025-12-22 17:21:53 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed101/feature_metadata.json
2025-12-22 17:21:53 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-22 17:21:53 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/feature-config.yaml.topoqa.10A.2, sha256=5c62898155179232a565e24d9fbd7b208f9ce480d1a19d6139de19454e173ff0
2025-12-22 17:21:53 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/work/edge_features)
2025-12-22 17:21:53 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json
2025-12-22 17:21:53 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed101/schema_summary.json
2025-12-22 17:21:53 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-22 17:21:53 INFO Topology: topology/persistence_basic/v1 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 172-dimensional node features.
2025-12-22 17:21:53 INFO Node: node/dssp_topo_merge/v1; metadata lists 172 feature columns matching the .pt tensor.
2025-12-22 17:21:53 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-22 17:21:53 INFO → Total feature dimensionality observed and confirmed: node_dim = 172, edge_dim = 11.
2025-12-22 17:21:53 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-22 17:21:53 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 172,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 172,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed101/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge/v1",
      "alias": "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA",
      "jobs": 16,
      "summary": "DSSP-derived node features merged with topology statistics."
    },
    "topology": {
      "id": "topology/persistence_basic/v1",
      "alias": "Betti 0 and Betti 1 topology summaries on interface coords = 140D PH | TopoQA",
      "jobs": 16,
      "summary": "Persistent homology features with configurable distance thresholds."
    }
  },
  "notes": []
}
2025-12-22 17:21:53 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-22 17:21:53 INFO Resuming from checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.06197_val-0.07377_epoch029.chkpt (epoch=29)
2025-12-22 17:21:53 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=8ea45d8568fc4815becc0d413646305a)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-22 17:21:53 INFO Starting training (fast_dev_run=False)
2025-12-22 17:21:53 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed101/model_checkpoints exists and is not empty.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.06197_val-0.07377_epoch029.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase1/model_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed101/model_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase1/model_checkpoints/val_loss_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed101/model_checkpoints/val_loss_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 5.5 K  | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
165 K     Trainable params
0         Non-trainable params
165 K     Total params
0.662     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
Restored all states from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.06197_val-0.07377_epoch029.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-22 17:22:07 INFO Epoch 030 | 25% complete (batch 46/181)
2025-12-22 17:22:08 INFO Epoch 030 | 50% complete (batch 91/181)
2025-12-22 17:22:09 INFO Epoch 030 | 75% complete (batch 136/181)
2025-12-22 17:22:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.070997
2025-12-22 17:22:22 INFO Tuning ranking metrics: regret=0.159368 spearman=0.093875 (groups=37, skipped=311)
2025-12-22 17:22:22 INFO Epoch 030 | val_loss=0.070997
Metric tuning_rank_spearman improved by 0.032 >= min_delta = 0.0. New best score: 0.094
2025-12-22 17:22:30 INFO Epoch 031 | 25% complete (batch 46/181)
2025-12-22 17:22:31 INFO Epoch 031 | 50% complete (batch 91/181)
2025-12-22 17:22:32 INFO Epoch 031 | 75% complete (batch 136/181)
2025-12-22 17:22:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.619858
2025-12-22 17:22:46 INFO Tuning ranking metrics: regret=0.158565 spearman=0.019504 (groups=37, skipped=311)
2025-12-22 17:22:46 INFO Epoch 031 | train_mse=0.089894 | val_loss=0.099498 | best_val_loss=0.093875
2025-12-22 17:22:54 INFO Epoch 032 | 25% complete (batch 46/181)
2025-12-22 17:22:55 INFO Epoch 032 | 50% complete (batch 91/181)
2025-12-22 17:22:55 INFO Epoch 032 | 75% complete (batch 136/181)
2025-12-22 17:23:04 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.672372
2025-12-22 17:23:09 INFO Tuning ranking metrics: regret=0.154235 spearman=0.037656 (groups=37, skipped=311)
2025-12-22 17:23:09 INFO Epoch 032 | train_mse=0.085219 | val_loss=0.059760 | best_val_loss=0.093875
2025-12-22 17:23:18 INFO Epoch 033 | 25% complete (batch 46/181)
2025-12-22 17:23:19 INFO Epoch 033 | 50% complete (batch 91/181)
2025-12-22 17:23:20 INFO Epoch 033 | 75% complete (batch 136/181)
2025-12-22 17:23:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.688732
2025-12-22 17:23:34 INFO Tuning ranking metrics: regret=0.162381 spearman=0.055838 (groups=37, skipped=311)
2025-12-22 17:23:34 INFO Epoch 033 | train_mse=0.082759 | val_loss=0.077103 | best_val_loss=0.093875
2025-12-22 17:23:42 INFO Epoch 034 | 25% complete (batch 46/181)
2025-12-22 17:23:43 INFO Epoch 034 | 50% complete (batch 91/181)
2025-12-22 17:23:44 INFO Epoch 034 | 75% complete (batch 136/181)
2025-12-22 17:23:53 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.695532
2025-12-22 17:23:58 INFO Tuning ranking metrics: regret=0.162625 spearman=0.054288 (groups=37, skipped=311)
2025-12-22 17:23:58 INFO Epoch 034 | train_mse=0.083969 | val_loss=0.062908 | best_val_loss=0.093875
2025-12-22 17:24:06 INFO Epoch 035 | 25% complete (batch 46/181)
2025-12-22 17:24:07 INFO Epoch 035 | 50% complete (batch 91/181)
2025-12-22 17:24:08 INFO Epoch 035 | 75% complete (batch 136/181)
2025-12-22 17:24:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.678192
2025-12-22 17:24:22 INFO Tuning ranking metrics: regret=0.165125 spearman=0.031321 (groups=37, skipped=311)
2025-12-22 17:24:22 INFO Epoch 035 | train_mse=0.078784 | val_loss=0.068628 | best_val_loss=0.093875
2025-12-22 17:24:31 INFO Epoch 036 | 25% complete (batch 46/181)
2025-12-22 17:24:32 INFO Epoch 036 | 50% complete (batch 91/181)
2025-12-22 17:24:33 INFO Epoch 036 | 75% complete (batch 136/181)
2025-12-22 17:24:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.672913
2025-12-22 17:24:47 INFO Tuning ranking metrics: regret=0.138257 spearman=0.124125 (groups=37, skipped=311)
2025-12-22 17:24:47 INFO Epoch 036 | train_mse=0.077940 | val_loss=0.083263 | best_val_loss=0.093875
Metric tuning_rank_spearman improved by 0.030 >= min_delta = 0.0. New best score: 0.124
2025-12-22 17:24:55 INFO Epoch 037 | 25% complete (batch 46/181)
2025-12-22 17:24:56 INFO Epoch 037 | 50% complete (batch 91/181)
2025-12-22 17:24:57 INFO Epoch 037 | 75% complete (batch 136/181)
2025-12-22 17:25:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.662346
2025-12-22 17:25:10 INFO Tuning ranking metrics: regret=0.140715 spearman=0.125161 (groups=37, skipped=311)
2025-12-22 17:25:10 INFO Epoch 037 | train_mse=0.087072 | val_loss=0.077751 | best_val_loss=0.124125
Metric tuning_rank_spearman improved by 0.001 >= min_delta = 0.0. New best score: 0.125
2025-12-22 17:25:19 INFO Epoch 038 | 25% complete (batch 46/181)
2025-12-22 17:25:20 INFO Epoch 038 | 50% complete (batch 91/181)
2025-12-22 17:25:21 INFO Epoch 038 | 75% complete (batch 136/181)
2025-12-22 17:25:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.628396
2025-12-22 17:25:34 INFO Tuning ranking metrics: regret=0.160331 spearman=0.071587 (groups=37, skipped=311)
2025-12-22 17:25:34 INFO Epoch 038 | train_mse=0.078198 | val_loss=0.105027 | best_val_loss=0.125161
2025-12-22 17:25:44 INFO Epoch 039 | 25% complete (batch 46/181)
2025-12-22 17:25:45 INFO Epoch 039 | 50% complete (batch 91/181)
2025-12-22 17:25:46 INFO Epoch 039 | 75% complete (batch 136/181)
2025-12-22 17:25:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.663095
2025-12-22 17:26:01 INFO Tuning ranking metrics: regret=0.159512 spearman=0.116392 (groups=37, skipped=311)
2025-12-22 17:26:01 INFO Epoch 039 | train_mse=0.085924 | val_loss=0.068400 | best_val_loss=0.125161
2025-12-22 17:26:10 INFO Epoch 040 | 25% complete (batch 46/181)
2025-12-22 17:26:11 INFO Epoch 040 | 50% complete (batch 91/181)
2025-12-22 17:26:12 INFO Epoch 040 | 75% complete (batch 136/181)
2025-12-22 17:26:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.647144
2025-12-22 17:26:27 INFO Tuning ranking metrics: regret=0.159512 spearman=0.111238 (groups=37, skipped=311)
2025-12-22 17:26:27 INFO Epoch 040 | train_mse=0.083235 | val_loss=0.066427 | best_val_loss=0.125161
2025-12-22 17:26:36 INFO Epoch 041 | 25% complete (batch 46/181)
2025-12-22 17:26:37 INFO Epoch 041 | 50% complete (batch 91/181)
2025-12-22 17:26:38 INFO Epoch 041 | 75% complete (batch 136/181)
2025-12-22 17:26:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.651874
2025-12-22 17:26:52 INFO Tuning ranking metrics: regret=0.159689 spearman=0.112993 (groups=37, skipped=311)
2025-12-22 17:26:52 INFO Epoch 041 | train_mse=0.071558 | val_loss=0.064564 | best_val_loss=0.125161
2025-12-22 17:27:01 INFO Epoch 042 | 25% complete (batch 46/181)
2025-12-22 17:27:01 INFO Epoch 042 | 50% complete (batch 91/181)
2025-12-22 17:27:02 INFO Epoch 042 | 75% complete (batch 136/181)
2025-12-22 17:27:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.650990
2025-12-22 17:27:16 INFO Tuning ranking metrics: regret=0.159737 spearman=0.099696 (groups=37, skipped=311)
2025-12-22 17:27:16 INFO Epoch 042 | train_mse=0.072062 | val_loss=0.068366 | best_val_loss=0.125161
2025-12-22 17:28:10 INFO Epoch 043 | 25% complete (batch 46/181)
2025-12-22 17:29:16 INFO Epoch 043 | 50% complete (batch 91/181)
2025-12-22 17:30:25 INFO Epoch 043 | 75% complete (batch 136/181)
2025-12-22 17:33:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.665263
2025-12-22 17:34:08 INFO Tuning ranking metrics: regret=0.159512 spearman=0.105546 (groups=37, skipped=311)
2025-12-22 17:34:08 INFO Epoch 043 | train_mse=0.056953 | val_loss=0.066517 | best_val_loss=0.125161
2025-12-22 17:36:11 INFO Epoch 044 | 25% complete (batch 46/181)
2025-12-22 17:36:58 INFO Epoch 044 | 50% complete (batch 91/181)
2025-12-22 17:38:01 INFO Epoch 044 | 75% complete (batch 136/181)
2025-12-22 17:40:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.660330
2025-12-22 17:40:46 INFO Tuning ranking metrics: regret=0.159512 spearman=0.100608 (groups=37, skipped=311)
2025-12-22 17:40:46 INFO Epoch 044 | train_mse=0.064629 | val_loss=0.064609 | best_val_loss=0.125161
2025-12-22 17:42:00 INFO Epoch 045 | 25% complete (batch 46/181)
2025-12-22 17:42:39 INFO Epoch 045 | 50% complete (batch 91/181)
2025-12-22 17:43:42 INFO Epoch 045 | 75% complete (batch 136/181)
2025-12-22 17:46:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.665798
2025-12-22 17:47:09 INFO Tuning ranking metrics: regret=0.159689 spearman=0.111390 (groups=37, skipped=311)
2025-12-22 17:47:09 INFO Epoch 045 | train_mse=0.072012 | val_loss=0.062444 | best_val_loss=0.125161
2025-12-22 17:49:13 INFO Epoch 046 | 25% complete (batch 46/181)
2025-12-22 17:50:39 INFO Epoch 046 | 50% complete (batch 91/181)
2025-12-22 17:51:32 INFO Epoch 046 | 75% complete (batch 136/181)
2025-12-22 17:52:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.670119
2025-12-22 17:53:22 INFO Tuning ranking metrics: regret=0.159707 spearman=0.110571 (groups=37, skipped=311)
2025-12-22 17:53:22 INFO Epoch 046 | train_mse=0.089386 | val_loss=0.062130 | best_val_loss=0.125161
2025-12-22 17:54:11 INFO Epoch 047 | 25% complete (batch 46/181)
2025-12-22 17:54:47 INFO Epoch 047 | 50% complete (batch 91/181)
2025-12-22 17:55:14 INFO Epoch 047 | 75% complete (batch 136/181)
2025-12-22 17:56:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.669867
2025-12-22 17:56:29 INFO Tuning ranking metrics: regret=0.159512 spearman=0.112969 (groups=37, skipped=311)
2025-12-22 17:56:29 INFO Epoch 047 | train_mse=0.073257 | val_loss=0.063623 | best_val_loss=0.125161
2025-12-22 17:56:39 INFO Epoch 048 | 25% complete (batch 46/181)
2025-12-22 17:56:41 INFO Epoch 048 | 50% complete (batch 91/181)
2025-12-22 17:56:42 INFO Epoch 048 | 75% complete (batch 136/181)
2025-12-22 17:56:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.665243
2025-12-22 17:56:58 INFO Tuning ranking metrics: regret=0.159512 spearman=0.118890 (groups=37, skipped=311)
2025-12-22 17:56:58 INFO Epoch 048 | train_mse=0.059532 | val_loss=0.064223 | best_val_loss=0.125161
2025-12-22 17:57:08 INFO Epoch 049 | 25% complete (batch 46/181)
2025-12-22 17:57:09 INFO Epoch 049 | 50% complete (batch 91/181)
2025-12-22 17:57:10 INFO Epoch 049 | 75% complete (batch 136/181)
2025-12-22 17:57:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.665895
2025-12-22 17:57:26 INFO Tuning ranking metrics: regret=0.161970 spearman=0.108336 (groups=37, skipped=311)
2025-12-22 17:57:26 INFO Epoch 049 | train_mse=0.062316 | val_loss=0.062683 | best_val_loss=0.125161
2025-12-22 17:57:36 INFO Epoch 050 | 25% complete (batch 46/181)
2025-12-22 17:57:37 INFO Epoch 050 | 50% complete (batch 91/181)
2025-12-22 17:57:38 INFO Epoch 050 | 75% complete (batch 136/181)
2025-12-22 17:57:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.671551
2025-12-22 17:57:55 INFO Tuning ranking metrics: regret=0.161970 spearman=0.099134 (groups=37, skipped=311)
2025-12-22 17:57:55 INFO Epoch 050 | train_mse=0.063652 | val_loss=0.062309 | best_val_loss=0.125161
2025-12-22 17:58:05 INFO Epoch 051 | 25% complete (batch 46/181)
2025-12-22 17:58:06 INFO Epoch 051 | 50% complete (batch 91/181)
2025-12-22 17:58:08 INFO Epoch 051 | 75% complete (batch 136/181)
2025-12-22 17:58:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.668720
2025-12-22 17:58:24 INFO Tuning ranking metrics: regret=0.161970 spearman=0.107693 (groups=37, skipped=311)
2025-12-22 17:58:24 INFO Epoch 051 | train_mse=0.052051 | val_loss=0.063094 | best_val_loss=0.125161
2025-12-22 17:58:34 INFO Epoch 052 | 25% complete (batch 46/181)
2025-12-22 17:58:35 INFO Epoch 052 | 50% complete (batch 91/181)
2025-12-22 17:58:36 INFO Epoch 052 | 75% complete (batch 136/181)
2025-12-22 17:58:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.671455
2025-12-22 17:58:52 INFO Tuning ranking metrics: regret=0.162165 spearman=0.098508 (groups=37, skipped=311)
2025-12-22 17:58:52 INFO Epoch 052 | train_mse=0.063731 | val_loss=0.062404 | best_val_loss=0.125161
2025-12-22 17:59:03 INFO Epoch 053 | 25% complete (batch 46/181)
2025-12-22 17:59:05 INFO Epoch 053 | 50% complete (batch 91/181)
2025-12-22 17:59:06 INFO Epoch 053 | 75% complete (batch 136/181)
2025-12-22 17:59:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.671329
2025-12-22 17:59:23 INFO Tuning ranking metrics: regret=0.162165 spearman=0.100111 (groups=37, skipped=311)
2025-12-22 17:59:23 INFO Epoch 053 | train_mse=0.052601 | val_loss=0.062061 | best_val_loss=0.125161
2025-12-22 17:59:33 INFO Epoch 054 | 25% complete (batch 46/181)
2025-12-22 17:59:35 INFO Epoch 054 | 50% complete (batch 91/181)
2025-12-22 17:59:36 INFO Epoch 054 | 75% complete (batch 136/181)
2025-12-22 17:59:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.671122
2025-12-22 17:59:52 INFO Tuning ranking metrics: regret=0.162165 spearman=0.101656 (groups=37, skipped=311)
2025-12-22 17:59:52 INFO Epoch 054 | train_mse=0.054759 | val_loss=0.062033 | best_val_loss=0.125161
2025-12-22 18:00:02 INFO Epoch 055 | 25% complete (batch 46/181)
2025-12-22 18:00:04 INFO Epoch 055 | 50% complete (batch 91/181)
2025-12-22 18:00:05 INFO Epoch 055 | 75% complete (batch 136/181)
2025-12-22 18:00:15 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.670968
2025-12-22 18:00:21 INFO Tuning ranking metrics: regret=0.162165 spearman=0.100111 (groups=37, skipped=311)
2025-12-22 18:00:21 INFO Epoch 055 | train_mse=0.059473 | val_loss=0.062187 | best_val_loss=0.125161
2025-12-22 18:00:32 INFO Epoch 056 | 25% complete (batch 46/181)
2025-12-22 18:00:33 INFO Epoch 056 | 50% complete (batch 91/181)
2025-12-22 18:00:34 INFO Epoch 056 | 75% complete (batch 136/181)
2025-12-22 18:00:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.671361
2025-12-22 18:00:51 INFO Tuning ranking metrics: regret=0.162165 spearman=0.102124 (groups=37, skipped=311)
2025-12-22 18:00:51 INFO Epoch 056 | train_mse=0.065133 | val_loss=0.061794 | best_val_loss=0.125161
2025-12-22 18:01:01 INFO Epoch 057 | 25% complete (batch 46/181)
2025-12-22 18:01:03 INFO Epoch 057 | 50% complete (batch 91/181)
2025-12-22 18:01:04 INFO Epoch 057 | 75% complete (batch 136/181)
2025-12-22 18:01:15 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.673339
2025-12-22 18:01:21 INFO Tuning ranking metrics: regret=0.162165 spearman=0.102124 (groups=37, skipped=311)
2025-12-22 18:01:21 INFO Epoch 057 | train_mse=0.062098 | val_loss=0.061660 | best_val_loss=0.125161
2025-12-22 18:01:32 INFO Epoch 058 | 25% complete (batch 46/181)
2025-12-22 18:01:34 INFO Epoch 058 | 50% complete (batch 91/181)
2025-12-22 18:01:35 INFO Epoch 058 | 75% complete (batch 136/181)
2025-12-22 18:01:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.673925
2025-12-22 18:01:54 INFO Tuning ranking metrics: regret=0.162165 spearman=0.104826 (groups=37, skipped=311)
2025-12-22 18:01:54 INFO Epoch 058 | train_mse=0.057008 | val_loss=0.061644 | best_val_loss=0.125161
2025-12-22 18:02:04 INFO Epoch 059 | 25% complete (batch 46/181)
2025-12-22 18:02:06 INFO Epoch 059 | 50% complete (batch 91/181)
2025-12-22 18:02:08 INFO Epoch 059 | 75% complete (batch 136/181)
2025-12-22 18:02:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.673824
2025-12-22 18:02:25 INFO Tuning ranking metrics: regret=0.162165 spearman=0.102124 (groups=37, skipped=311)
2025-12-22 18:02:25 INFO Epoch 059 | train_mse=0.060833 | val_loss=0.061746 | best_val_loss=0.125161
2025-12-22 18:02:36 INFO Epoch 060 | 25% complete (batch 46/181)
2025-12-22 18:02:38 INFO Epoch 060 | 50% complete (batch 91/181)
2025-12-22 18:02:39 INFO Epoch 060 | 75% complete (batch 136/181)
2025-12-22 18:02:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.673321
2025-12-22 18:02:55 INFO Tuning ranking metrics: regret=0.162165 spearman=0.099456 (groups=37, skipped=311)
2025-12-22 18:02:55 INFO Epoch 060 | train_mse=0.074198 | val_loss=0.062014 | best_val_loss=0.125161
2025-12-22 18:03:06 INFO Epoch 061 | 25% complete (batch 46/181)
2025-12-22 18:03:07 INFO Epoch 061 | 50% complete (batch 91/181)
2025-12-22 18:03:09 INFO Epoch 061 | 75% complete (batch 136/181)
2025-12-22 18:03:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.672656
2025-12-22 18:03:25 INFO Tuning ranking metrics: regret=0.162165 spearman=0.100111 (groups=37, skipped=311)
2025-12-22 18:03:25 INFO Epoch 061 | train_mse=0.058177 | val_loss=0.062041 | best_val_loss=0.125161
Monitored metric tuning_rank_spearman did not improve in the last 24 records. Best score: 0.125. Signaling Trainer to stop.
2025-12-22 18:03:26 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.11889_val-0.06422_epoch048.chkpt, checkpoint.tuning_rank_spearman-0.12413_val-0.08326_epoch036.chkpt, checkpoint.tuning_rank_spearman-0.12516_val-0.07775_epoch037.chkpt
2025-12-22 18:03:26 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed101/model_checkpoints/checkpoint.tuning_rank_spearman-0.12516_val-0.07775_epoch037.chkpt
2025-12-22 18:03:26 INFO Best validation loss: tensor(0.1252)
2025-12-22 18:03:26 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed101/model_checkpoints/checkpoint.tuning_rank_spearman-0.12516_val-0.07775_epoch037.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed101/model_checkpoints/checkpoint.tuning_rank_spearman-0.12516_val-0.07775_epoch037.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-22 18:03:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.077751
2025-12-22 18:03:40 INFO Tuning ranking metrics: regret=0.140715 spearman=0.125161 (groups=37, skipped=311)
2025-12-22 18:03:40 INFO Epoch 062 | val_loss=0.077751 | best_val_loss=0.125161
2025-12-22 18:03:41 INFO Validation metrics: [{'val_loss': 0.07775099575519562, 'tuning_rank_regret': 0.14071454107761383, 'tuning_rank_spearman': 0.12516087293624878, 'val_pearson_corr': 0.7294501662254333, 'val_spearman_corr': 0.7334232926368713, 'val_rank_regret': 0.0033600511960685253, 'val_rank_spearman': 0.8333333134651184}]
2025-12-22 18:03:41 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.12516_val-0.07775_epoch037.chkpt
2025-12-22 18:03:41 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.12413_val-0.08326_epoch036.chkpt
2025-12-22 18:03:41 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.11889_val-0.06422_epoch048.chkpt
2025-12-22 18:03:41 INFO Renamed checkpoint file: alt_val.val-0.05976_epoch032.ckpt -> alt_val.val-0.05976_epoch032.chkpt
2025-12-22 18:03:41 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.05976_epoch032.chkpt
2025-12-22 18:03:41 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.14071454107761383
  tuning_rank_spearman      0.12516087293624878
        val_loss            0.07775099575519562
    val_pearson_corr        0.7294501662254333
     val_rank_regret       0.0033600511960685253
    val_rank_spearman       0.8333333134651184
    val_spearman_corr       0.7334232926368713
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed101 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed101
[run_full_pipeline] Phase 2 (seed 101) best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed101/model_checkpoints/checkpoint.tuning_rank_spearman-0.12516_val-0.07775_epoch037.chkpt (tuning_rank_spearman=0.12516087293624878)
[run_full_pipeline] Phase 2 fine-tuning (seed 555) -> sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed555
[train_cli] run_id=sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed555 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed555/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed555 --git-commit 150d1dcbd1 --git-dirty --resume-from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.06197_val-0.07377_epoch029.chkpt
2025-12-22 18:03:47 INFO git_commit = 150d1dcbd1 (dirty)
2025-12-22 18:03:47 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-22 18:03:47 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed555/config/config.yaml
2025-12-22 18:03:47 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data
2025-12-22 18:03:47 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-22 18:03:47 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-22 18:03:47 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed555
2025-12-22 18:03:47 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-22 18:03:47 INFO   metadata_path = None
2025-12-22 18:03:47 INFO   summary_path = None
2025-12-22 18:03:47 INFO   accelerator = cpu
2025-12-22 18:03:47 INFO   devices = 1
2025-12-22 18:03:47 INFO   attention_head = 8
2025-12-22 18:03:47 INFO   pooling_type = mean
2025-12-22 18:03:47 INFO   model_self_loops = False
2025-12-22 18:03:47 INFO   model_self_loop_fill = mean
2025-12-22 18:03:47 INFO   model_residual = False
2025-12-22 18:03:47 INFO   batch_size = 48
2025-12-22 18:03:47 INFO   learning_rate = 0.001
2025-12-22 18:03:47 INFO   num_epochs = 320
2025-12-22 18:03:47 INFO   accumulate_grad_batches = 8
2025-12-22 18:03:47 INFO   seed = 555
2025-12-22 18:03:47 INFO   num_workers = 2
2025-12-22 18:03:47 INFO   precision = 32
2025-12-22 18:03:47 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-22 18:03:47 INFO   early_stopping_patience = 20
2025-12-22 18:03:47 INFO   lr_scheduler_patience = 4
2025-12-22 18:03:47 INFO   lr_scheduler_factor = 0.2
2025-12-22 18:03:47 INFO   fast_dev_run = False
2025-12-22 18:03:47 INFO   limit_train_batches = None
2025-12-22 18:03:47 INFO   limit_val_batches = None
2025-12-22 18:03:47 INFO   log_lr = False
2025-12-22 18:03:47 INFO   progress_bar_refresh_rate = 0
2025-12-22 18:03:47 INFO   log_every_n_steps = 100
2025-12-22 18:03:47 INFO   use_val_spearman_as_secondary = True
2025-12-22 18:03:47 INFO   spearman_secondary_min_delta = 0.0
2025-12-22 18:03:47 INFO   spearman_secondary_weight = 1.0
2025-12-22 18:03:47 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-22 18:03:47 INFO   tuning_max_samples = 500
2025-12-22 18:03:47 INFO   tuning_fraction = None
2025-12-22 18:03:47 INFO   tuning_eval_every = 1
2025-12-22 18:03:47 INFO   rank_loss_weight = 0.0
2025-12-22 18:03:47 INFO   rank_loss_margin = 0.0
2025-12-22 18:03:47 INFO   rank_loss_mode = hinge
2025-12-22 18:03:47 INFO   rank_loss_grouped = True
2025-12-22 18:03:47 INFO   variance_reduction_enabled = False
2025-12-22 18:03:47 INFO   variance_reduction_method = topk_avg
2025-12-22 18:03:47 INFO   variance_reduction_top_k = 3
2025-12-22 18:03:47 INFO   coverage_minimum = 0.0
2025-12-22 18:03:47 INFO   coverage_fail_on_missing = False
2025-12-22 18:03:47 INFO   graph_load_profiling = False
2025-12-22 18:03:47 INFO   graph_load_top_k = 5
2025-12-22 18:03:47 INFO   enable_graph_cache = True
2025-12-22 18:03:47 INFO   graph_cache_size = 256
2025-12-22 18:03:47 INFO   canonicalize_on_load = False
2025-12-22 18:03:47 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-22 18:03:47 INFO   edge_schema = {}
2025-12-22 18:03:47 INFO   topology_schema = {}
Seed set to 555
2025-12-22 18:03:48 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-22 18:03:48 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 18:03:48 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-22 18:03:48 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 18:03:48 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-22 18:03:48 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 18:03:49 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-22 18:03:49 INFO Tuning group stats: groups=368 groups>=2=39 singletons=329 max_group=9
2025-12-22 18:03:49 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed555/dataset_coverage.json
2025-12-22 18:03:49 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed555/dataset_coverage.json for details.
2025-12-22 18:03:49 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed555/dataset_coverage.json for details.
2025-12-22 18:03:49 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed555/dataset_coverage.json for details.
2025-12-22 18:03:49 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed555/schema_summary.json
2025-12-22 18:03:49 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed555/feature_metadata.json
2025-12-22 18:03:49 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-22 18:03:49 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/feature-config.yaml.topoqa.10A.2, sha256=5c62898155179232a565e24d9fbd7b208f9ce480d1a19d6139de19454e173ff0
2025-12-22 18:03:49 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/work/edge_features)
2025-12-22 18:03:49 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json
2025-12-22 18:03:49 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed555/schema_summary.json
2025-12-22 18:03:49 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-22 18:03:49 INFO Topology: topology/persistence_basic/v1 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 172-dimensional node features.
2025-12-22 18:03:49 INFO Node: node/dssp_topo_merge/v1; metadata lists 172 feature columns matching the .pt tensor.
2025-12-22 18:03:49 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-22 18:03:49 INFO → Total feature dimensionality observed and confirmed: node_dim = 172, edge_dim = 11.
2025-12-22 18:03:49 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-22 18:03:49 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 172,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 172,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed555/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge/v1",
      "alias": "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA",
      "jobs": 16,
      "summary": "DSSP-derived node features merged with topology statistics."
    },
    "topology": {
      "id": "topology/persistence_basic/v1",
      "alias": "Betti 0 and Betti 1 topology summaries on interface coords = 140D PH | TopoQA",
      "jobs": 16,
      "summary": "Persistent homology features with configurable distance thresholds."
    }
  },
  "notes": []
}
2025-12-22 18:03:49 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-22 18:03:49 INFO Resuming from checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.06197_val-0.07377_epoch029.chkpt (epoch=29)
2025-12-22 18:03:50 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=b7f43991c0e84d1e998374bb30512b91)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-22 18:03:50 INFO Starting training (fast_dev_run=False)
2025-12-22 18:03:50 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed555/model_checkpoints exists and is not empty.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.06197_val-0.07377_epoch029.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase1/model_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed555/model_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase1/model_checkpoints/val_loss_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed555/model_checkpoints/val_loss_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 5.5 K  | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
165 K     Trainable params
0         Non-trainable params
165 K     Total params
0.662     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
Restored all states from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.06197_val-0.07377_epoch029.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-22 18:04:07 INFO Epoch 030 | 25% complete (batch 46/181)
2025-12-22 18:04:08 INFO Epoch 030 | 50% complete (batch 91/181)
2025-12-22 18:04:09 INFO Epoch 030 | 75% complete (batch 136/181)
2025-12-22 18:04:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.072779
2025-12-22 18:04:27 INFO Tuning ranking metrics: regret=0.115583 spearman=0.254640 (groups=39, skipped=329)
2025-12-22 18:04:27 INFO Epoch 030 | val_loss=0.072779
Metric tuning_rank_spearman improved by 0.193 >= min_delta = 0.0. New best score: 0.255
2025-12-22 18:04:36 INFO Epoch 031 | 25% complete (batch 46/181)
2025-12-22 18:04:37 INFO Epoch 031 | 50% complete (batch 91/181)
2025-12-22 18:04:38 INFO Epoch 031 | 75% complete (batch 136/181)
2025-12-22 18:04:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.657973
2025-12-22 18:04:53 INFO Tuning ranking metrics: regret=0.115088 spearman=0.269719 (groups=39, skipped=329)
2025-12-22 18:04:53 INFO Epoch 031 | train_mse=0.093596 | val_loss=0.070017 | best_val_loss=0.254640
Metric tuning_rank_spearman improved by 0.015 >= min_delta = 0.0. New best score: 0.270
2025-12-22 18:05:03 INFO Epoch 032 | 25% complete (batch 46/181)
2025-12-22 18:05:04 INFO Epoch 032 | 50% complete (batch 91/181)
2025-12-22 18:05:05 INFO Epoch 032 | 75% complete (batch 136/181)
2025-12-22 18:05:15 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.662550
2025-12-22 18:05:20 INFO Tuning ranking metrics: regret=0.116720 spearman=0.183578 (groups=39, skipped=329)
2025-12-22 18:05:20 INFO Epoch 032 | train_mse=0.103663 | val_loss=0.061316 | best_val_loss=0.269719
2025-12-22 18:05:30 INFO Epoch 033 | 25% complete (batch 46/181)
2025-12-22 18:05:31 INFO Epoch 033 | 50% complete (batch 91/181)
2025-12-22 18:05:32 INFO Epoch 033 | 75% complete (batch 136/181)
2025-12-22 18:05:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.692428
2025-12-22 18:05:47 INFO Tuning ranking metrics: regret=0.114243 spearman=0.205372 (groups=39, skipped=329)
2025-12-22 18:05:47 INFO Epoch 033 | train_mse=0.085055 | val_loss=0.056221 | best_val_loss=0.269719
2025-12-22 18:05:57 INFO Epoch 034 | 25% complete (batch 46/181)
2025-12-22 18:05:58 INFO Epoch 034 | 50% complete (batch 91/181)
2025-12-22 18:05:59 INFO Epoch 034 | 75% complete (batch 136/181)
2025-12-22 18:06:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.693424
2025-12-22 18:06:14 INFO Tuning ranking metrics: regret=0.092002 spearman=0.206960 (groups=39, skipped=329)
2025-12-22 18:06:14 INFO Epoch 034 | train_mse=0.081220 | val_loss=0.070566 | best_val_loss=0.269719
2025-12-22 18:06:23 INFO Epoch 035 | 25% complete (batch 46/181)
2025-12-22 18:06:25 INFO Epoch 035 | 50% complete (batch 91/181)
2025-12-22 18:06:26 INFO Epoch 035 | 75% complete (batch 136/181)
2025-12-22 18:06:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.687864
2025-12-22 18:06:41 INFO Tuning ranking metrics: regret=0.114291 spearman=0.185592 (groups=39, skipped=329)
2025-12-22 18:06:41 INFO Epoch 035 | train_mse=0.098842 | val_loss=0.067877 | best_val_loss=0.269719
2025-12-22 18:06:50 INFO Epoch 036 | 25% complete (batch 46/181)
2025-12-22 18:06:51 INFO Epoch 036 | 50% complete (batch 91/181)
2025-12-22 18:06:52 INFO Epoch 036 | 75% complete (batch 136/181)
2025-12-22 18:07:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.664080
2025-12-22 18:07:07 INFO Tuning ranking metrics: regret=0.115009 spearman=0.248779 (groups=39, skipped=329)
2025-12-22 18:07:07 INFO Epoch 036 | train_mse=0.083680 | val_loss=0.075128 | best_val_loss=0.269719
2025-12-22 18:07:17 INFO Epoch 037 | 25% complete (batch 46/181)
2025-12-22 18:07:18 INFO Epoch 037 | 50% complete (batch 91/181)
2025-12-22 18:07:19 INFO Epoch 037 | 75% complete (batch 136/181)
2025-12-22 18:07:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.669444
2025-12-22 18:07:34 INFO Tuning ranking metrics: regret=0.097928 spearman=0.206899 (groups=39, skipped=329)
2025-12-22 18:07:34 INFO Epoch 037 | train_mse=0.101888 | val_loss=0.057557 | best_val_loss=0.269719
2025-12-22 18:07:44 INFO Epoch 038 | 25% complete (batch 46/181)
2025-12-22 18:07:45 INFO Epoch 038 | 50% complete (batch 91/181)
2025-12-22 18:07:46 INFO Epoch 038 | 75% complete (batch 136/181)
2025-12-22 18:07:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.681547
2025-12-22 18:08:01 INFO Tuning ranking metrics: regret=0.092469 spearman=0.208242 (groups=39, skipped=329)
2025-12-22 18:08:01 INFO Epoch 038 | train_mse=0.080562 | val_loss=0.076189 | best_val_loss=0.269719
2025-12-22 18:08:10 INFO Epoch 039 | 25% complete (batch 46/181)
2025-12-22 18:08:11 INFO Epoch 039 | 50% complete (batch 91/181)
2025-12-22 18:08:12 INFO Epoch 039 | 75% complete (batch 136/181)
2025-12-22 18:08:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.630720
2025-12-22 18:08:28 INFO Tuning ranking metrics: regret=0.102384 spearman=0.321368 (groups=39, skipped=329)
2025-12-22 18:08:28 INFO Epoch 039 | train_mse=0.083333 | val_loss=0.080118 | best_val_loss=0.269719
Metric tuning_rank_spearman improved by 0.052 >= min_delta = 0.0. New best score: 0.321
2025-12-22 18:08:37 INFO Epoch 040 | 25% complete (batch 46/181)
2025-12-22 18:08:38 INFO Epoch 040 | 50% complete (batch 91/181)
2025-12-22 18:08:39 INFO Epoch 040 | 75% complete (batch 136/181)
2025-12-22 18:08:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.647853
2025-12-22 18:08:55 INFO Tuning ranking metrics: regret=0.116798 spearman=0.160806 (groups=39, skipped=329)
2025-12-22 18:08:55 INFO Epoch 040 | train_mse=0.088337 | val_loss=0.066187 | best_val_loss=0.321368
2025-12-22 18:09:04 INFO Epoch 041 | 25% complete (batch 46/181)
2025-12-22 18:09:05 INFO Epoch 041 | 50% complete (batch 91/181)
2025-12-22 18:09:06 INFO Epoch 041 | 75% complete (batch 136/181)
2025-12-22 18:09:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.678311
2025-12-22 18:09:21 INFO Tuning ranking metrics: regret=0.117179 spearman=0.145788 (groups=39, skipped=329)
2025-12-22 18:09:21 INFO Epoch 041 | train_mse=0.075341 | val_loss=0.059673 | best_val_loss=0.321368
2025-12-22 18:09:31 INFO Epoch 042 | 25% complete (batch 46/181)
2025-12-22 18:09:32 INFO Epoch 042 | 50% complete (batch 91/181)
2025-12-22 18:09:33 INFO Epoch 042 | 75% complete (batch 136/181)
2025-12-22 18:09:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.674524
2025-12-22 18:09:48 INFO Tuning ranking metrics: regret=0.105299 spearman=0.264957 (groups=39, skipped=329)
2025-12-22 18:09:48 INFO Epoch 042 | train_mse=0.075807 | val_loss=0.063460 | best_val_loss=0.321368
2025-12-22 18:09:57 INFO Epoch 043 | 25% complete (batch 46/181)
2025-12-22 18:09:59 INFO Epoch 043 | 50% complete (batch 91/181)
2025-12-22 18:10:00 INFO Epoch 043 | 75% complete (batch 136/181)
2025-12-22 18:10:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.670903
2025-12-22 18:10:14 INFO Tuning ranking metrics: regret=0.118481 spearman=0.167399 (groups=39, skipped=329)
2025-12-22 18:10:14 INFO Epoch 043 | train_mse=0.068487 | val_loss=0.059855 | best_val_loss=0.321368
2025-12-22 18:10:24 INFO Epoch 044 | 25% complete (batch 46/181)
2025-12-22 18:10:25 INFO Epoch 044 | 50% complete (batch 91/181)
2025-12-22 18:10:26 INFO Epoch 044 | 75% complete (batch 136/181)
2025-12-22 18:10:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.679902
2025-12-22 18:10:41 INFO Tuning ranking metrics: regret=0.113073 spearman=0.175702 (groups=39, skipped=329)
2025-12-22 18:10:41 INFO Epoch 044 | train_mse=0.074356 | val_loss=0.058099 | best_val_loss=0.321368
2025-12-22 18:10:50 INFO Epoch 045 | 25% complete (batch 46/181)
2025-12-22 18:10:51 INFO Epoch 045 | 50% complete (batch 91/181)
2025-12-22 18:10:52 INFO Epoch 045 | 75% complete (batch 136/181)
2025-12-22 18:11:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.680247
2025-12-22 18:11:08 INFO Tuning ranking metrics: regret=0.113073 spearman=0.173260 (groups=39, skipped=329)
2025-12-22 18:11:08 INFO Epoch 045 | train_mse=0.062772 | val_loss=0.057603 | best_val_loss=0.321368
2025-12-22 18:11:18 INFO Epoch 046 | 25% complete (batch 46/181)
2025-12-22 18:11:19 INFO Epoch 046 | 50% complete (batch 91/181)
2025-12-22 18:11:20 INFO Epoch 046 | 75% complete (batch 136/181)
2025-12-22 18:11:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.681915
2025-12-22 18:11:34 INFO Tuning ranking metrics: regret=0.112978 spearman=0.171856 (groups=39, skipped=329)
2025-12-22 18:11:34 INFO Epoch 046 | train_mse=0.075800 | val_loss=0.062641 | best_val_loss=0.321368
2025-12-22 18:11:44 INFO Epoch 047 | 25% complete (batch 46/181)
2025-12-22 18:11:45 INFO Epoch 047 | 50% complete (batch 91/181)
2025-12-22 18:11:46 INFO Epoch 047 | 75% complete (batch 136/181)
2025-12-22 18:11:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.695253
2025-12-22 18:12:01 INFO Tuning ranking metrics: regret=0.123362 spearman=0.122650 (groups=39, skipped=329)
2025-12-22 18:12:01 INFO Epoch 047 | train_mse=0.074270 | val_loss=0.055793 | best_val_loss=0.321368
2025-12-22 18:12:11 INFO Epoch 048 | 25% complete (batch 46/181)
2025-12-22 18:12:12 INFO Epoch 048 | 50% complete (batch 91/181)
2025-12-22 18:12:13 INFO Epoch 048 | 75% complete (batch 136/181)
2025-12-22 18:12:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.698632
2025-12-22 18:12:28 INFO Tuning ranking metrics: regret=0.118022 spearman=0.120696 (groups=39, skipped=329)
2025-12-22 18:12:28 INFO Epoch 048 | train_mse=0.059834 | val_loss=0.056991 | best_val_loss=0.321368
2025-12-22 18:12:37 INFO Epoch 049 | 25% complete (batch 46/181)
2025-12-22 18:12:38 INFO Epoch 049 | 50% complete (batch 91/181)
2025-12-22 18:12:39 INFO Epoch 049 | 75% complete (batch 136/181)
2025-12-22 18:12:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.696625
2025-12-22 18:12:54 INFO Tuning ranking metrics: regret=0.118022 spearman=0.124847 (groups=39, skipped=329)
2025-12-22 18:12:54 INFO Epoch 049 | train_mse=0.063026 | val_loss=0.056869 | best_val_loss=0.321368
2025-12-22 18:13:04 INFO Epoch 050 | 25% complete (batch 46/181)
2025-12-22 18:13:05 INFO Epoch 050 | 50% complete (batch 91/181)
2025-12-22 18:13:07 INFO Epoch 050 | 75% complete (batch 136/181)
2025-12-22 18:13:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.692818
2025-12-22 18:13:22 INFO Tuning ranking metrics: regret=0.118022 spearman=0.112637 (groups=39, skipped=329)
2025-12-22 18:13:22 INFO Epoch 050 | train_mse=0.052610 | val_loss=0.057038 | best_val_loss=0.321368
2025-12-22 18:13:31 INFO Epoch 051 | 25% complete (batch 46/181)
2025-12-22 18:13:32 INFO Epoch 051 | 50% complete (batch 91/181)
2025-12-22 18:13:33 INFO Epoch 051 | 75% complete (batch 136/181)
2025-12-22 18:13:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.692292
2025-12-22 18:13:48 INFO Tuning ranking metrics: regret=0.117937 spearman=0.115690 (groups=39, skipped=329)
2025-12-22 18:13:48 INFO Epoch 051 | train_mse=0.062675 | val_loss=0.056255 | best_val_loss=0.321368
2025-12-22 18:13:58 INFO Epoch 052 | 25% complete (batch 46/181)
2025-12-22 18:13:59 INFO Epoch 052 | 50% complete (batch 91/181)
2025-12-22 18:14:00 INFO Epoch 052 | 75% complete (batch 136/181)
2025-12-22 18:14:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.689875
2025-12-22 18:14:15 INFO Tuning ranking metrics: regret=0.117574 spearman=0.123565 (groups=39, skipped=329)
2025-12-22 18:14:15 INFO Epoch 052 | train_mse=0.069086 | val_loss=0.059176 | best_val_loss=0.321368
2025-12-22 18:14:25 INFO Epoch 053 | 25% complete (batch 46/181)
2025-12-22 18:14:26 INFO Epoch 053 | 50% complete (batch 91/181)
2025-12-22 18:14:27 INFO Epoch 053 | 75% complete (batch 136/181)
2025-12-22 18:14:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.687205
2025-12-22 18:14:42 INFO Tuning ranking metrics: regret=0.112995 spearman=0.170391 (groups=39, skipped=329)
2025-12-22 18:14:42 INFO Epoch 053 | train_mse=0.078601 | val_loss=0.060018 | best_val_loss=0.321368
2025-12-22 18:14:51 INFO Epoch 054 | 25% complete (batch 46/181)
2025-12-22 18:14:52 INFO Epoch 054 | 50% complete (batch 91/181)
2025-12-22 18:14:53 INFO Epoch 054 | 75% complete (batch 136/181)
2025-12-22 18:15:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.690900
2025-12-22 18:15:09 INFO Tuning ranking metrics: regret=0.112989 spearman=0.164652 (groups=39, skipped=329)
2025-12-22 18:15:09 INFO Epoch 054 | train_mse=0.061202 | val_loss=0.058369 | best_val_loss=0.321368
2025-12-22 18:15:18 INFO Epoch 055 | 25% complete (batch 46/181)
2025-12-22 18:15:19 INFO Epoch 055 | 50% complete (batch 91/181)
2025-12-22 18:15:20 INFO Epoch 055 | 75% complete (batch 136/181)
2025-12-22 18:15:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.696494
2025-12-22 18:15:35 INFO Tuning ranking metrics: regret=0.117937 spearman=0.113370 (groups=39, skipped=329)
2025-12-22 18:15:35 INFO Epoch 055 | train_mse=0.078618 | val_loss=0.056598 | best_val_loss=0.321368
2025-12-22 18:15:45 INFO Epoch 056 | 25% complete (batch 46/181)
2025-12-22 18:15:46 INFO Epoch 056 | 50% complete (batch 91/181)
2025-12-22 18:15:47 INFO Epoch 056 | 75% complete (batch 136/181)
2025-12-22 18:15:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.698851
2025-12-22 18:16:02 INFO Tuning ranking metrics: regret=0.117937 spearman=0.115934 (groups=39, skipped=329)
2025-12-22 18:16:02 INFO Epoch 056 | train_mse=0.057089 | val_loss=0.056689 | best_val_loss=0.321368
2025-12-22 18:16:12 INFO Epoch 057 | 25% complete (batch 46/181)
2025-12-22 18:16:13 INFO Epoch 057 | 50% complete (batch 91/181)
2025-12-22 18:16:15 INFO Epoch 057 | 75% complete (batch 136/181)
2025-12-22 18:16:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.699162
2025-12-22 18:16:29 INFO Tuning ranking metrics: regret=0.117937 spearman=0.119597 (groups=39, skipped=329)
2025-12-22 18:16:29 INFO Epoch 057 | train_mse=0.066136 | val_loss=0.056378 | best_val_loss=0.321368
2025-12-22 18:16:39 INFO Epoch 058 | 25% complete (batch 46/181)
2025-12-22 18:16:40 INFO Epoch 058 | 50% complete (batch 91/181)
2025-12-22 18:16:41 INFO Epoch 058 | 75% complete (batch 136/181)
2025-12-22 18:16:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.697414
2025-12-22 18:16:56 INFO Tuning ranking metrics: regret=0.112989 spearman=0.169048 (groups=39, skipped=329)
2025-12-22 18:16:56 INFO Epoch 058 | train_mse=0.063730 | val_loss=0.056617 | best_val_loss=0.321368
2025-12-22 18:17:06 INFO Epoch 059 | 25% complete (batch 46/181)
2025-12-22 18:17:07 INFO Epoch 059 | 50% complete (batch 91/181)
2025-12-22 18:17:08 INFO Epoch 059 | 75% complete (batch 136/181)
2025-12-22 18:17:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.701101
2025-12-22 18:17:23 INFO Tuning ranking metrics: regret=0.117937 spearman=0.114652 (groups=39, skipped=329)
2025-12-22 18:17:23 INFO Epoch 059 | train_mse=0.063327 | val_loss=0.055478 | best_val_loss=0.321368
2025-12-22 18:17:32 INFO Epoch 060 | 25% complete (batch 46/181)
2025-12-22 18:17:33 INFO Epoch 060 | 50% complete (batch 91/181)
2025-12-22 18:17:34 INFO Epoch 060 | 75% complete (batch 136/181)
2025-12-22 18:17:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.697954
2025-12-22 18:17:50 INFO Tuning ranking metrics: regret=0.117937 spearman=0.120452 (groups=39, skipped=329)
2025-12-22 18:17:50 INFO Epoch 060 | train_mse=0.061070 | val_loss=0.055322 | best_val_loss=0.321368
2025-12-22 18:17:59 INFO Epoch 061 | 25% complete (batch 46/181)
2025-12-22 18:18:00 INFO Epoch 061 | 50% complete (batch 91/181)
2025-12-22 18:18:01 INFO Epoch 061 | 75% complete (batch 136/181)
2025-12-22 18:18:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.699234
2025-12-22 18:18:16 INFO Tuning ranking metrics: regret=0.117937 spearman=0.120452 (groups=39, skipped=329)
2025-12-22 18:18:16 INFO Epoch 061 | train_mse=0.087472 | val_loss=0.055366 | best_val_loss=0.321368
2025-12-22 18:18:26 INFO Epoch 062 | 25% complete (batch 46/181)
2025-12-22 18:18:27 INFO Epoch 062 | 50% complete (batch 91/181)
2025-12-22 18:18:28 INFO Epoch 062 | 75% complete (batch 136/181)
2025-12-22 18:18:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.700634
2025-12-22 18:18:43 INFO Tuning ranking metrics: regret=0.117937 spearman=0.120452 (groups=39, skipped=329)
2025-12-22 18:18:43 INFO Epoch 062 | train_mse=0.065782 | val_loss=0.055375 | best_val_loss=0.321368
2025-12-22 18:18:53 INFO Epoch 063 | 25% complete (batch 46/181)
2025-12-22 18:18:54 INFO Epoch 063 | 50% complete (batch 91/181)
2025-12-22 18:18:55 INFO Epoch 063 | 75% complete (batch 136/181)
2025-12-22 18:19:04 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.697351
2025-12-22 18:19:10 INFO Tuning ranking metrics: regret=0.117937 spearman=0.118315 (groups=39, skipped=329)
2025-12-22 18:19:10 INFO Epoch 063 | train_mse=0.056111 | val_loss=0.055372 | best_val_loss=0.321368
Monitored metric tuning_rank_spearman did not improve in the last 24 records. Best score: 0.321. Signaling Trainer to stop.
2025-12-22 18:19:11 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.26496_val-0.06346_epoch042.chkpt, checkpoint.tuning_rank_spearman-0.26972_val-0.07002_epoch031.chkpt, checkpoint.tuning_rank_spearman-0.32137_val-0.08012_epoch039.chkpt
2025-12-22 18:19:11 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed555/model_checkpoints/checkpoint.tuning_rank_spearman-0.32137_val-0.08012_epoch039.chkpt
2025-12-22 18:19:11 INFO Best validation loss: tensor(0.3214)
2025-12-22 18:19:11 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed555/model_checkpoints/checkpoint.tuning_rank_spearman-0.32137_val-0.08012_epoch039.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed555/model_checkpoints/checkpoint.tuning_rank_spearman-0.32137_val-0.08012_epoch039.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-22 18:19:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.080118
2025-12-22 18:19:25 INFO Tuning ranking metrics: regret=0.102384 spearman=0.321368 (groups=39, skipped=329)
2025-12-22 18:19:25 INFO Epoch 064 | val_loss=0.080118 | best_val_loss=0.321368
2025-12-22 18:19:26 INFO Validation metrics: [{'val_loss': 0.08011805266141891, 'tuning_rank_regret': 0.102383553981781, 'tuning_rank_spearman': 0.3213675320148468, 'val_pearson_corr': 0.7201362252235413, 'val_spearman_corr': 0.714040219783783, 'val_rank_regret': 0.006180476862937212, 'val_rank_spearman': 0.7222222089767456}]
2025-12-22 18:19:26 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.32137_val-0.08012_epoch039.chkpt
2025-12-22 18:19:26 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.26972_val-0.07002_epoch031.chkpt
2025-12-22 18:19:26 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.26496_val-0.06346_epoch042.chkpt
2025-12-22 18:19:26 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.05622_epoch033.ckpt
2025-12-22 18:19:26 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret        0.102383553981781
  tuning_rank_spearman      0.3213675320148468
        val_loss            0.08011805266141891
    val_pearson_corr        0.7201362252235413
     val_rank_regret       0.006180476862937212
    val_rank_spearman       0.7222222089767456
    val_spearman_corr        0.714040219783783
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed555 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed555
[run_full_pipeline] Phase 2 (seed 555) best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed555/model_checkpoints/checkpoint.tuning_rank_spearman-0.32137_val-0.08012_epoch039.chkpt (tuning_rank_spearman=0.3213675320148468)
[run_full_pipeline] Phase 2 fine-tuning (seed 888) -> sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed888
[train_cli] run_id=sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed888 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed888/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed888 --git-commit 150d1dcbd1 --git-dirty --resume-from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.06197_val-0.07377_epoch029.chkpt
2025-12-22 18:19:33 INFO git_commit = 150d1dcbd1 (dirty)
2025-12-22 18:19:33 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-22 18:19:33 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed888/config/config.yaml
2025-12-22 18:19:33 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data
2025-12-22 18:19:33 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-22 18:19:33 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-22 18:19:33 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed888
2025-12-22 18:19:33 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-22 18:19:33 INFO   metadata_path = None
2025-12-22 18:19:33 INFO   summary_path = None
2025-12-22 18:19:33 INFO   accelerator = cpu
2025-12-22 18:19:33 INFO   devices = 1
2025-12-22 18:19:33 INFO   attention_head = 8
2025-12-22 18:19:33 INFO   pooling_type = mean
2025-12-22 18:19:33 INFO   model_self_loops = False
2025-12-22 18:19:33 INFO   model_self_loop_fill = mean
2025-12-22 18:19:33 INFO   model_residual = False
2025-12-22 18:19:33 INFO   batch_size = 48
2025-12-22 18:19:33 INFO   learning_rate = 0.001
2025-12-22 18:19:33 INFO   num_epochs = 320
2025-12-22 18:19:33 INFO   accumulate_grad_batches = 8
2025-12-22 18:19:33 INFO   seed = 888
2025-12-22 18:19:33 INFO   num_workers = 2
2025-12-22 18:19:33 INFO   precision = 32
2025-12-22 18:19:33 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-22 18:19:33 INFO   early_stopping_patience = 20
2025-12-22 18:19:33 INFO   lr_scheduler_patience = 4
2025-12-22 18:19:33 INFO   lr_scheduler_factor = 0.2
2025-12-22 18:19:33 INFO   fast_dev_run = False
2025-12-22 18:19:33 INFO   limit_train_batches = None
2025-12-22 18:19:33 INFO   limit_val_batches = None
2025-12-22 18:19:33 INFO   log_lr = False
2025-12-22 18:19:33 INFO   progress_bar_refresh_rate = 0
2025-12-22 18:19:33 INFO   log_every_n_steps = 100
2025-12-22 18:19:33 INFO   use_val_spearman_as_secondary = True
2025-12-22 18:19:33 INFO   spearman_secondary_min_delta = 0.0
2025-12-22 18:19:33 INFO   spearman_secondary_weight = 1.0
2025-12-22 18:19:33 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-22 18:19:33 INFO   tuning_max_samples = 500
2025-12-22 18:19:33 INFO   tuning_fraction = None
2025-12-22 18:19:33 INFO   tuning_eval_every = 1
2025-12-22 18:19:33 INFO   rank_loss_weight = 0.0
2025-12-22 18:19:33 INFO   rank_loss_margin = 0.0
2025-12-22 18:19:33 INFO   rank_loss_mode = hinge
2025-12-22 18:19:33 INFO   rank_loss_grouped = True
2025-12-22 18:19:33 INFO   variance_reduction_enabled = False
2025-12-22 18:19:33 INFO   variance_reduction_method = topk_avg
2025-12-22 18:19:33 INFO   variance_reduction_top_k = 3
2025-12-22 18:19:33 INFO   coverage_minimum = 0.0
2025-12-22 18:19:33 INFO   coverage_fail_on_missing = False
2025-12-22 18:19:33 INFO   graph_load_profiling = False
2025-12-22 18:19:33 INFO   graph_load_top_k = 5
2025-12-22 18:19:33 INFO   enable_graph_cache = True
2025-12-22 18:19:33 INFO   graph_cache_size = 256
2025-12-22 18:19:33 INFO   canonicalize_on_load = False
2025-12-22 18:19:33 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-22 18:19:33 INFO   edge_schema = {}
2025-12-22 18:19:33 INFO   topology_schema = {}
Seed set to 888
2025-12-22 18:19:33 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-22 18:19:33 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 18:19:33 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-22 18:19:33 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 18:19:33 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-22 18:19:33 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 18:19:34 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-22 18:19:34 INFO Tuning group stats: groups=351 groups>=2=40 singletons=311 max_group=10
2025-12-22 18:19:34 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed888/dataset_coverage.json
2025-12-22 18:19:34 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed888/dataset_coverage.json for details.
2025-12-22 18:19:34 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed888/dataset_coverage.json for details.
2025-12-22 18:19:34 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed888/dataset_coverage.json for details.
2025-12-22 18:19:34 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed888/schema_summary.json
2025-12-22 18:19:34 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed888/feature_metadata.json
2025-12-22 18:19:34 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-22 18:19:34 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/feature-config.yaml.topoqa.10A.2, sha256=5c62898155179232a565e24d9fbd7b208f9ce480d1a19d6139de19454e173ff0
2025-12-22 18:19:34 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/work/edge_features)
2025-12-22 18:19:34 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json
2025-12-22 18:19:34 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed888/schema_summary.json
2025-12-22 18:19:34 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-22 18:19:34 INFO Topology: topology/persistence_basic/v1 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 172-dimensional node features.
2025-12-22 18:19:34 INFO Node: node/dssp_topo_merge/v1; metadata lists 172 feature columns matching the .pt tensor.
2025-12-22 18:19:34 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-22 18:19:34 INFO → Total feature dimensionality observed and confirmed: node_dim = 172, edge_dim = 11.
2025-12-22 18:19:34 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-22 18:19:34 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 172,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 172,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed888/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge/v1",
      "alias": "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA",
      "jobs": 16,
      "summary": "DSSP-derived node features merged with topology statistics."
    },
    "topology": {
      "id": "topology/persistence_basic/v1",
      "alias": "Betti 0 and Betti 1 topology summaries on interface coords = 140D PH | TopoQA",
      "jobs": 16,
      "summary": "Persistent homology features with configurable distance thresholds."
    }
  },
  "notes": []
}
2025-12-22 18:19:34 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-22 18:19:34 INFO Resuming from checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.06197_val-0.07377_epoch029.chkpt (epoch=29)
2025-12-22 18:19:35 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=cbdb20ce46424daa8d5106c34da4be74)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-22 18:19:35 INFO Starting training (fast_dev_run=False)
2025-12-22 18:19:35 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed888/model_checkpoints exists and is not empty.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.06197_val-0.07377_epoch029.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase1/model_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed888/model_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase1/model_checkpoints/val_loss_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed888/model_checkpoints/val_loss_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 5.5 K  | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
165 K     Trainable params
0         Non-trainable params
165 K     Total params
0.662     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
Restored all states from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.06197_val-0.07377_epoch029.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-22 18:19:49 INFO Epoch 030 | 25% complete (batch 46/181)
2025-12-22 18:19:50 INFO Epoch 030 | 50% complete (batch 91/181)
2025-12-22 18:19:50 INFO Epoch 030 | 75% complete (batch 136/181)
2025-12-22 18:19:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.069507
2025-12-22 18:20:04 INFO Tuning ranking metrics: regret=0.146434 spearman=0.249746 (groups=40, skipped=311)
2025-12-22 18:20:04 INFO Epoch 030 | val_loss=0.069507
Metric tuning_rank_spearman improved by 0.188 >= min_delta = 0.0. New best score: 0.250
2025-12-22 18:20:12 INFO Epoch 031 | 25% complete (batch 46/181)
2025-12-22 18:20:13 INFO Epoch 031 | 50% complete (batch 91/181)
2025-12-22 18:20:14 INFO Epoch 031 | 75% complete (batch 136/181)
2025-12-22 18:20:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.613237
2025-12-22 18:20:27 INFO Tuning ranking metrics: regret=0.177929 spearman=-0.027922 (groups=40, skipped=311)
2025-12-22 18:20:27 INFO Epoch 031 | train_mse=0.081391 | val_loss=0.120438 | best_val_loss=0.249746
2025-12-22 18:20:35 INFO Epoch 032 | 25% complete (batch 46/181)
2025-12-22 18:20:36 INFO Epoch 032 | 50% complete (batch 91/181)
2025-12-22 18:20:37 INFO Epoch 032 | 75% complete (batch 136/181)
2025-12-22 18:20:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.681007
2025-12-22 18:20:50 INFO Tuning ranking metrics: regret=0.166789 spearman=0.152803 (groups=40, skipped=311)
2025-12-22 18:20:50 INFO Epoch 032 | train_mse=0.071198 | val_loss=0.067172 | best_val_loss=0.249746
2025-12-22 18:20:59 INFO Epoch 033 | 25% complete (batch 46/181)
2025-12-22 18:20:59 INFO Epoch 033 | 50% complete (batch 91/181)
2025-12-22 18:21:00 INFO Epoch 033 | 75% complete (batch 136/181)
2025-12-22 18:21:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.618661
2025-12-22 18:21:14 INFO Tuning ranking metrics: regret=0.129196 spearman=0.067684 (groups=40, skipped=311)
2025-12-22 18:21:14 INFO Epoch 033 | train_mse=0.089502 | val_loss=0.105540 | best_val_loss=0.249746
2025-12-22 18:21:24 INFO Epoch 034 | 25% complete (batch 46/181)
2025-12-22 18:21:25 INFO Epoch 034 | 50% complete (batch 91/181)
2025-12-22 18:21:25 INFO Epoch 034 | 75% complete (batch 136/181)
2025-12-22 18:21:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.650919
2025-12-22 18:21:40 INFO Tuning ranking metrics: regret=0.167739 spearman=0.054692 (groups=40, skipped=311)
2025-12-22 18:21:40 INFO Epoch 034 | train_mse=0.071059 | val_loss=0.095214 | best_val_loss=0.249746
2025-12-22 18:21:49 INFO Epoch 035 | 25% complete (batch 46/181)
2025-12-22 18:21:50 INFO Epoch 035 | 50% complete (batch 91/181)
2025-12-22 18:21:51 INFO Epoch 035 | 75% complete (batch 136/181)
2025-12-22 18:22:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.660836
2025-12-22 18:22:06 INFO Tuning ranking metrics: regret=0.138338 spearman=0.259232 (groups=40, skipped=311)
2025-12-22 18:22:06 INFO Epoch 035 | train_mse=0.113153 | val_loss=0.072704 | best_val_loss=0.249746
Metric tuning_rank_spearman improved by 0.009 >= min_delta = 0.0. New best score: 0.259
2025-12-22 18:22:14 INFO Epoch 036 | 25% complete (batch 46/181)
2025-12-22 18:22:15 INFO Epoch 036 | 50% complete (batch 91/181)
2025-12-22 18:22:16 INFO Epoch 036 | 75% complete (batch 136/181)
2025-12-22 18:22:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.663400
2025-12-22 18:22:31 INFO Tuning ranking metrics: regret=0.166562 spearman=0.184805 (groups=40, skipped=311)
2025-12-22 18:22:31 INFO Epoch 036 | train_mse=0.089857 | val_loss=0.065547 | best_val_loss=0.259232
2025-12-22 18:22:39 INFO Epoch 037 | 25% complete (batch 46/181)
2025-12-22 18:22:40 INFO Epoch 037 | 50% complete (batch 91/181)
2025-12-22 18:22:41 INFO Epoch 037 | 75% complete (batch 136/181)
2025-12-22 18:22:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.669026
2025-12-22 18:22:55 INFO Tuning ranking metrics: regret=0.166153 spearman=0.192803 (groups=40, skipped=311)
2025-12-22 18:22:55 INFO Epoch 037 | train_mse=0.067143 | val_loss=0.064347 | best_val_loss=0.259232
2025-12-22 18:23:04 INFO Epoch 038 | 25% complete (batch 46/181)
2025-12-22 18:23:05 INFO Epoch 038 | 50% complete (batch 91/181)
2025-12-22 18:23:06 INFO Epoch 038 | 75% complete (batch 136/181)
2025-12-22 18:23:15 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.663094
2025-12-22 18:23:20 INFO Tuning ranking metrics: regret=0.166153 spearman=0.186494 (groups=40, skipped=311)
2025-12-22 18:23:20 INFO Epoch 038 | train_mse=0.069277 | val_loss=0.066255 | best_val_loss=0.259232
2025-12-22 18:23:29 INFO Epoch 039 | 25% complete (batch 46/181)
2025-12-22 18:23:30 INFO Epoch 039 | 50% complete (batch 91/181)
2025-12-22 18:23:31 INFO Epoch 039 | 75% complete (batch 136/181)
2025-12-22 18:23:40 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.662899
2025-12-22 18:23:45 INFO Tuning ranking metrics: regret=0.151066 spearman=0.201872 (groups=40, skipped=311)
2025-12-22 18:23:45 INFO Epoch 039 | train_mse=0.070569 | val_loss=0.065008 | best_val_loss=0.259232
2025-12-22 18:23:54 INFO Epoch 040 | 25% complete (batch 46/181)
2025-12-22 18:23:55 INFO Epoch 040 | 50% complete (batch 91/181)
2025-12-22 18:23:56 INFO Epoch 040 | 75% complete (batch 136/181)
2025-12-22 18:24:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.658125
2025-12-22 18:24:10 INFO Tuning ranking metrics: regret=0.150890 spearman=0.265124 (groups=40, skipped=311)
2025-12-22 18:24:10 INFO Epoch 040 | train_mse=0.072488 | val_loss=0.070822 | best_val_loss=0.259232
Metric tuning_rank_spearman improved by 0.006 >= min_delta = 0.0. New best score: 0.265
2025-12-22 18:24:19 INFO Epoch 041 | 25% complete (batch 46/181)
2025-12-22 18:24:19 INFO Epoch 041 | 50% complete (batch 91/181)
2025-12-22 18:24:20 INFO Epoch 041 | 75% complete (batch 136/181)
2025-12-22 18:24:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.654565
2025-12-22 18:24:35 INFO Tuning ranking metrics: regret=0.167103 spearman=0.143220 (groups=40, skipped=311)
2025-12-22 18:24:35 INFO Epoch 041 | train_mse=0.075592 | val_loss=0.068043 | best_val_loss=0.265124
2025-12-22 18:24:43 INFO Epoch 042 | 25% complete (batch 46/181)
2025-12-22 18:24:44 INFO Epoch 042 | 50% complete (batch 91/181)
2025-12-22 18:24:45 INFO Epoch 042 | 75% complete (batch 136/181)
2025-12-22 18:24:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.668433
2025-12-22 18:24:59 INFO Tuning ranking metrics: regret=0.166153 spearman=0.196515 (groups=40, skipped=311)
2025-12-22 18:24:59 INFO Epoch 042 | train_mse=0.069512 | val_loss=0.064269 | best_val_loss=0.265124
2025-12-22 18:25:08 INFO Epoch 043 | 25% complete (batch 46/181)
2025-12-22 18:25:09 INFO Epoch 043 | 50% complete (batch 91/181)
2025-12-22 18:25:10 INFO Epoch 043 | 75% complete (batch 136/181)
2025-12-22 18:25:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.668074
2025-12-22 18:25:24 INFO Tuning ranking metrics: regret=0.166153 spearman=0.197348 (groups=40, skipped=311)
2025-12-22 18:25:24 INFO Epoch 043 | train_mse=0.069124 | val_loss=0.064209 | best_val_loss=0.265124
2025-12-22 18:25:32 INFO Epoch 044 | 25% complete (batch 46/181)
2025-12-22 18:25:33 INFO Epoch 044 | 50% complete (batch 91/181)
2025-12-22 18:25:34 INFO Epoch 044 | 75% complete (batch 136/181)
2025-12-22 18:25:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.668349
2025-12-22 18:25:49 INFO Tuning ranking metrics: regret=0.150915 spearman=0.204075 (groups=40, skipped=311)
2025-12-22 18:25:49 INFO Epoch 044 | train_mse=0.081415 | val_loss=0.064487 | best_val_loss=0.265124
2025-12-22 18:25:57 INFO Epoch 045 | 25% complete (batch 46/181)
2025-12-22 18:25:58 INFO Epoch 045 | 50% complete (batch 91/181)
2025-12-22 18:25:59 INFO Epoch 045 | 75% complete (batch 136/181)
2025-12-22 18:26:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.665966
2025-12-22 18:26:13 INFO Tuning ranking metrics: regret=0.150915 spearman=0.202884 (groups=40, skipped=311)
2025-12-22 18:26:13 INFO Epoch 045 | train_mse=0.065662 | val_loss=0.064607 | best_val_loss=0.265124
2025-12-22 18:26:22 INFO Epoch 046 | 25% complete (batch 46/181)
2025-12-22 18:26:23 INFO Epoch 046 | 50% complete (batch 91/181)
2025-12-22 18:26:23 INFO Epoch 046 | 75% complete (batch 136/181)
2025-12-22 18:26:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.667006
2025-12-22 18:26:37 INFO Tuning ranking metrics: regret=0.151066 spearman=0.201753 (groups=40, skipped=311)
2025-12-22 18:26:37 INFO Epoch 046 | train_mse=0.073061 | val_loss=0.063600 | best_val_loss=0.265124
2025-12-22 18:26:47 INFO Epoch 047 | 25% complete (batch 46/181)
2025-12-22 18:26:48 INFO Epoch 047 | 50% complete (batch 91/181)
2025-12-22 18:26:49 INFO Epoch 047 | 75% complete (batch 136/181)
2025-12-22 18:26:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.669542
2025-12-22 18:27:03 INFO Tuning ranking metrics: regret=0.166153 spearman=0.200563 (groups=40, skipped=311)
2025-12-22 18:27:03 INFO Epoch 047 | train_mse=0.076359 | val_loss=0.063546 | best_val_loss=0.265124
2025-12-22 18:27:12 INFO Epoch 048 | 25% complete (batch 46/181)
2025-12-22 18:27:12 INFO Epoch 048 | 50% complete (batch 91/181)
2025-12-22 18:27:13 INFO Epoch 048 | 75% complete (batch 136/181)
2025-12-22 18:27:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.666950
2025-12-22 18:27:27 INFO Tuning ranking metrics: regret=0.150915 spearman=0.210898 (groups=40, skipped=311)
2025-12-22 18:27:27 INFO Epoch 048 | train_mse=0.080444 | val_loss=0.064461 | best_val_loss=0.265124
2025-12-22 18:27:36 INFO Epoch 049 | 25% complete (batch 46/181)
2025-12-22 18:27:37 INFO Epoch 049 | 50% complete (batch 91/181)
2025-12-22 18:27:38 INFO Epoch 049 | 75% complete (batch 136/181)
2025-12-22 18:27:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.665670
2025-12-22 18:27:52 INFO Tuning ranking metrics: regret=0.150915 spearman=0.210898 (groups=40, skipped=311)
2025-12-22 18:27:52 INFO Epoch 049 | train_mse=0.061392 | val_loss=0.064567 | best_val_loss=0.265124
2025-12-22 18:28:01 INFO Epoch 050 | 25% complete (batch 46/181)
2025-12-22 18:28:02 INFO Epoch 050 | 50% complete (batch 91/181)
2025-12-22 18:28:03 INFO Epoch 050 | 75% complete (batch 136/181)
2025-12-22 18:28:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.665166
2025-12-22 18:28:17 INFO Tuning ranking metrics: regret=0.150915 spearman=0.210898 (groups=40, skipped=311)
2025-12-22 18:28:17 INFO Epoch 050 | train_mse=0.061761 | val_loss=0.064132 | best_val_loss=0.265124
2025-12-22 18:28:26 INFO Epoch 051 | 25% complete (batch 46/181)
2025-12-22 18:28:27 INFO Epoch 051 | 50% complete (batch 91/181)
2025-12-22 18:28:28 INFO Epoch 051 | 75% complete (batch 136/181)
2025-12-22 18:28:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.666320
2025-12-22 18:28:41 INFO Tuning ranking metrics: regret=0.150915 spearman=0.208777 (groups=40, skipped=311)
2025-12-22 18:28:41 INFO Epoch 051 | train_mse=0.056011 | val_loss=0.064052 | best_val_loss=0.265124
2025-12-22 18:28:50 INFO Epoch 052 | 25% complete (batch 46/181)
2025-12-22 18:28:50 INFO Epoch 052 | 50% complete (batch 91/181)
2025-12-22 18:28:51 INFO Epoch 052 | 75% complete (batch 136/181)
2025-12-22 18:29:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.666451
2025-12-22 18:29:05 INFO Tuning ranking metrics: regret=0.150915 spearman=0.208360 (groups=40, skipped=311)
2025-12-22 18:29:05 INFO Epoch 052 | train_mse=0.068027 | val_loss=0.063921 | best_val_loss=0.265124
2025-12-22 18:29:14 INFO Epoch 053 | 25% complete (batch 46/181)
2025-12-22 18:29:15 INFO Epoch 053 | 50% complete (batch 91/181)
2025-12-22 18:29:16 INFO Epoch 053 | 75% complete (batch 136/181)
2025-12-22 18:29:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.666127
2025-12-22 18:29:30 INFO Tuning ranking metrics: regret=0.151066 spearman=0.199372 (groups=40, skipped=311)
2025-12-22 18:29:30 INFO Epoch 053 | train_mse=0.072766 | val_loss=0.063322 | best_val_loss=0.265124
2025-12-22 18:29:38 INFO Epoch 054 | 25% complete (batch 46/181)
2025-12-22 18:29:39 INFO Epoch 054 | 50% complete (batch 91/181)
2025-12-22 18:29:39 INFO Epoch 054 | 75% complete (batch 136/181)
2025-12-22 18:29:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.668391
2025-12-22 18:29:53 INFO Tuning ranking metrics: regret=0.151066 spearman=0.199372 (groups=40, skipped=311)
2025-12-22 18:29:53 INFO Epoch 054 | train_mse=0.074031 | val_loss=0.063221 | best_val_loss=0.265124
2025-12-22 18:30:01 INFO Epoch 055 | 25% complete (batch 46/181)
2025-12-22 18:30:02 INFO Epoch 055 | 50% complete (batch 91/181)
2025-12-22 18:30:03 INFO Epoch 055 | 75% complete (batch 136/181)
2025-12-22 18:30:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.668512
2025-12-22 18:30:16 INFO Tuning ranking metrics: regret=0.151066 spearman=0.203658 (groups=40, skipped=311)
2025-12-22 18:30:16 INFO Epoch 055 | train_mse=0.071142 | val_loss=0.063201 | best_val_loss=0.265124
2025-12-22 18:30:25 INFO Epoch 056 | 25% complete (batch 46/181)
2025-12-22 18:30:25 INFO Epoch 056 | 50% complete (batch 91/181)
2025-12-22 18:30:27 INFO Epoch 056 | 75% complete (batch 136/181)
2025-12-22 18:30:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.669618
2025-12-22 18:30:41 INFO Tuning ranking metrics: regret=0.151066 spearman=0.203658 (groups=40, skipped=311)
2025-12-22 18:30:41 INFO Epoch 056 | train_mse=0.063523 | val_loss=0.063202 | best_val_loss=0.265124
2025-12-22 18:30:50 INFO Epoch 057 | 25% complete (batch 46/181)
2025-12-22 18:30:50 INFO Epoch 057 | 50% complete (batch 91/181)
2025-12-22 18:30:51 INFO Epoch 057 | 75% complete (batch 136/181)
2025-12-22 18:31:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.669282
2025-12-22 18:31:06 INFO Tuning ranking metrics: regret=0.151066 spearman=0.204075 (groups=40, skipped=311)
2025-12-22 18:31:06 INFO Epoch 057 | train_mse=0.056006 | val_loss=0.063303 | best_val_loss=0.265124
2025-12-22 18:31:16 INFO Epoch 058 | 25% complete (batch 46/181)
2025-12-22 18:31:17 INFO Epoch 058 | 50% complete (batch 91/181)
2025-12-22 18:31:18 INFO Epoch 058 | 75% complete (batch 136/181)
2025-12-22 18:31:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.670905
2025-12-22 18:31:32 INFO Tuning ranking metrics: regret=0.151066 spearman=0.204075 (groups=40, skipped=311)
2025-12-22 18:31:32 INFO Epoch 058 | train_mse=0.063836 | val_loss=0.063340 | best_val_loss=0.265124
2025-12-22 18:31:41 INFO Epoch 059 | 25% complete (batch 46/181)
2025-12-22 18:31:42 INFO Epoch 059 | 50% complete (batch 91/181)
2025-12-22 18:31:43 INFO Epoch 059 | 75% complete (batch 136/181)
2025-12-22 18:31:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.668829
2025-12-22 18:31:58 INFO Tuning ranking metrics: regret=0.151066 spearman=0.205741 (groups=40, skipped=311)
2025-12-22 18:31:58 INFO Epoch 059 | train_mse=0.078538 | val_loss=0.063571 | best_val_loss=0.265124
2025-12-22 18:32:08 INFO Epoch 060 | 25% complete (batch 46/181)
2025-12-22 18:32:09 INFO Epoch 060 | 50% complete (batch 91/181)
2025-12-22 18:32:10 INFO Epoch 060 | 75% complete (batch 136/181)
2025-12-22 18:32:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.669025
2025-12-22 18:32:24 INFO Tuning ranking metrics: regret=0.151066 spearman=0.204075 (groups=40, skipped=311)
2025-12-22 18:32:24 INFO Epoch 060 | train_mse=0.059029 | val_loss=0.063376 | best_val_loss=0.265124
2025-12-22 18:32:34 INFO Epoch 061 | 25% complete (batch 46/181)
2025-12-22 18:32:34 INFO Epoch 061 | 50% complete (batch 91/181)
2025-12-22 18:32:35 INFO Epoch 061 | 75% complete (batch 136/181)
2025-12-22 18:32:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.669109
2025-12-22 18:32:50 INFO Tuning ranking metrics: regret=0.151066 spearman=0.204075 (groups=40, skipped=311)
2025-12-22 18:32:50 INFO Epoch 061 | train_mse=0.070676 | val_loss=0.063291 | best_val_loss=0.265124
2025-12-22 18:32:59 INFO Epoch 062 | 25% complete (batch 46/181)
2025-12-22 18:33:00 INFO Epoch 062 | 50% complete (batch 91/181)
2025-12-22 18:33:00 INFO Epoch 062 | 75% complete (batch 136/181)
2025-12-22 18:33:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.670678
2025-12-22 18:33:15 INFO Tuning ranking metrics: regret=0.151066 spearman=0.204075 (groups=40, skipped=311)
2025-12-22 18:33:15 INFO Epoch 062 | train_mse=0.066630 | val_loss=0.063265 | best_val_loss=0.265124
2025-12-22 18:33:23 INFO Epoch 063 | 25% complete (batch 46/181)
2025-12-22 18:33:24 INFO Epoch 063 | 50% complete (batch 91/181)
2025-12-22 18:33:25 INFO Epoch 063 | 75% complete (batch 136/181)
2025-12-22 18:33:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.670681
2025-12-22 18:33:40 INFO Tuning ranking metrics: regret=0.151066 spearman=0.204075 (groups=40, skipped=311)
2025-12-22 18:33:40 INFO Epoch 063 | train_mse=0.073924 | val_loss=0.063262 | best_val_loss=0.265124
2025-12-22 18:33:48 INFO Epoch 064 | 25% complete (batch 46/181)
2025-12-22 18:33:49 INFO Epoch 064 | 50% complete (batch 91/181)
2025-12-22 18:33:50 INFO Epoch 064 | 75% complete (batch 136/181)
2025-12-22 18:33:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.670727
2025-12-22 18:34:04 INFO Tuning ranking metrics: regret=0.151066 spearman=0.204075 (groups=40, skipped=311)
2025-12-22 18:34:04 INFO Epoch 064 | train_mse=0.063637 | val_loss=0.063216 | best_val_loss=0.265124
Monitored metric tuning_rank_spearman did not improve in the last 24 records. Best score: 0.265. Signaling Trainer to stop.
2025-12-22 18:34:06 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.24975_val-0.06951_epoch030.chkpt, checkpoint.tuning_rank_spearman-0.25923_val-0.07270_epoch035.chkpt, checkpoint.tuning_rank_spearman-0.26512_val-0.07082_epoch040.chkpt
2025-12-22 18:34:06 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed888/model_checkpoints/checkpoint.tuning_rank_spearman-0.26512_val-0.07082_epoch040.chkpt
2025-12-22 18:34:06 INFO Best validation loss: tensor(0.2651)
2025-12-22 18:34:06 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed888/model_checkpoints/checkpoint.tuning_rank_spearman-0.26512_val-0.07082_epoch040.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed888/model_checkpoints/checkpoint.tuning_rank_spearman-0.26512_val-0.07082_epoch040.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-22 18:34:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.070822
2025-12-22 18:34:19 INFO Tuning ranking metrics: regret=0.150890 spearman=0.265124 (groups=40, skipped=311)
2025-12-22 18:34:19 INFO Epoch 065 | val_loss=0.070822 | best_val_loss=0.265124
2025-12-22 18:34:19 INFO Validation metrics: [{'val_loss': 0.07082174718379974, 'tuning_rank_regret': 0.1508900672197342, 'tuning_rank_spearman': 0.26512446999549866, 'val_pearson_corr': 0.7289369106292725, 'val_spearman_corr': 0.7226083278656006, 'val_rank_regret': 0.006356073077768087, 'val_rank_spearman': 0.5555555820465088}]
2025-12-22 18:34:19 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.26512_val-0.07082_epoch040.chkpt
2025-12-22 18:34:19 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.24975_val-0.06951_epoch030.chkpt
2025-12-22 18:34:19 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.25923_val-0.07270_epoch035.chkpt
2025-12-22 18:34:19 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.06435_epoch037.ckpt
2025-12-22 18:34:19 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.1508900672197342
  tuning_rank_spearman      0.26512446999549866
        val_loss            0.07082174718379974
    val_pearson_corr        0.7289369106292725
     val_rank_regret       0.006356073077768087
    val_rank_spearman       0.5555555820465088
    val_spearman_corr       0.7226083278656006
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed888 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed888
[run_full_pipeline] Phase 2 (seed 888) best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed888/model_checkpoints/checkpoint.tuning_rank_spearman-0.26512_val-0.07082_epoch040.chkpt (tuning_rank_spearman=0.26512446999549866)
[run_full_pipeline] Pipeline complete at 2025-12-22T18:34:22Z
Starting post model training polishing ...
[polish_from_best] Manifest written to manifests/run_polish_lean.yaml
[polish_from_best] Best run: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-22_16-39-57_phase2_seed555
[polish_from_best] Base config: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/configs/sched_boost_finetune_seed555.yaml
[polish_from_best] Seeds: 101 555 888
[polish_from_best] Launching run_full_pipeline.sh with manifests/run_polish_lean.yaml
[run_full_pipeline] Validating graphs before training...
[validate_graphs] OK: validated 14391 graph(s) in /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data
[run_full_pipeline] Starting sweep at 2025-12-22T18:34:49.794717+00:00 using manifest /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/manifests/run_polish_lean.yaml
[train_cli][batch] (1/6) running job 'polish_seed101' -> run_name=polish_seed101_2025-12-22_18-34-49
[train_cli] run_id=polish_seed101_2025-12-22_18-34-49 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49 --git-commit 150d1dcbd1 --git-dirty
2025-12-22 18:34:53 INFO git_commit = 150d1dcbd1 (dirty)
2025-12-22 18:34:53 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-22 18:34:53 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49/config/config.yaml
2025-12-22 18:34:53 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data
2025-12-22 18:34:53 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-22 18:34:53 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-22 18:34:53 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49
2025-12-22 18:34:53 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-22 18:34:53 INFO   metadata_path = None
2025-12-22 18:34:53 INFO   summary_path = None
2025-12-22 18:34:53 INFO   accelerator = cpu
2025-12-22 18:34:53 INFO   devices = 1
2025-12-22 18:34:53 INFO   attention_head = 8
2025-12-22 18:34:53 INFO   pooling_type = mean
2025-12-22 18:34:53 INFO   model_self_loops = False
2025-12-22 18:34:53 INFO   model_self_loop_fill = mean
2025-12-22 18:34:53 INFO   model_residual = False
2025-12-22 18:34:53 INFO   batch_size = 48
2025-12-22 18:34:53 INFO   learning_rate = 0.003
2025-12-22 18:34:53 INFO   num_epochs = 320
2025-12-22 18:34:53 INFO   accumulate_grad_batches = 8
2025-12-22 18:34:53 INFO   seed = 101
2025-12-22 18:34:53 INFO   num_workers = 2
2025-12-22 18:34:53 INFO   precision = 32
2025-12-22 18:34:53 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-22 18:34:53 INFO   early_stopping_patience = 40
2025-12-22 18:34:53 INFO   lr_scheduler_patience = 20
2025-12-22 18:34:53 INFO   lr_scheduler_factor = 0.3
2025-12-22 18:34:53 INFO   fast_dev_run = False
2025-12-22 18:34:53 INFO   limit_train_batches = None
2025-12-22 18:34:53 INFO   limit_val_batches = None
2025-12-22 18:34:53 INFO   log_lr = False
2025-12-22 18:34:53 INFO   progress_bar_refresh_rate = 0
2025-12-22 18:34:53 INFO   log_every_n_steps = 100
2025-12-22 18:34:53 INFO   use_val_spearman_as_secondary = True
2025-12-22 18:34:53 INFO   spearman_secondary_min_delta = 0.0
2025-12-22 18:34:53 INFO   spearman_secondary_weight = 1.0
2025-12-22 18:34:53 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-22 18:34:53 INFO   tuning_max_samples = 500
2025-12-22 18:34:53 INFO   tuning_fraction = None
2025-12-22 18:34:53 INFO   tuning_eval_every = 1
2025-12-22 18:34:53 INFO   rank_loss_weight = 0.0
2025-12-22 18:34:53 INFO   rank_loss_margin = 0.0
2025-12-22 18:34:53 INFO   rank_loss_mode = hinge
2025-12-22 18:34:53 INFO   rank_loss_grouped = True
2025-12-22 18:34:53 INFO   variance_reduction_enabled = False
2025-12-22 18:34:53 INFO   variance_reduction_method = topk_avg
2025-12-22 18:34:53 INFO   variance_reduction_top_k = 3
2025-12-22 18:34:53 INFO   coverage_minimum = 0.0
2025-12-22 18:34:53 INFO   coverage_fail_on_missing = False
2025-12-22 18:34:53 INFO   graph_load_profiling = False
2025-12-22 18:34:53 INFO   graph_load_top_k = 5
2025-12-22 18:34:53 INFO   enable_graph_cache = True
2025-12-22 18:34:53 INFO   graph_cache_size = 256
2025-12-22 18:34:53 INFO   canonicalize_on_load = False
2025-12-22 18:34:53 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-22 18:34:53 INFO   edge_schema = {}
2025-12-22 18:34:53 INFO   topology_schema = {}
Seed set to 101
2025-12-22 18:34:53 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-22 18:34:53 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 18:34:53 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-22 18:34:53 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 18:34:53 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-22 18:34:53 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 18:34:54 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-22 18:34:54 INFO Tuning group stats: groups=348 groups>=2=37 singletons=311 max_group=11
2025-12-22 18:34:54 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49/dataset_coverage.json
2025-12-22 18:34:54 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49/dataset_coverage.json for details.
2025-12-22 18:34:54 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49/dataset_coverage.json for details.
2025-12-22 18:34:54 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49/dataset_coverage.json for details.
2025-12-22 18:34:54 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49/schema_summary.json
2025-12-22 18:34:54 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49/feature_metadata.json
2025-12-22 18:34:54 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-22 18:34:54 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/feature-config.yaml.topoqa.10A.2, sha256=5c62898155179232a565e24d9fbd7b208f9ce480d1a19d6139de19454e173ff0
2025-12-22 18:34:54 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/work/edge_features)
2025-12-22 18:34:54 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json
2025-12-22 18:34:54 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49/schema_summary.json
2025-12-22 18:34:54 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-22 18:34:54 INFO Topology: topology/persistence_basic/v1 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 172-dimensional node features.
2025-12-22 18:34:54 INFO Node: node/dssp_topo_merge/v1; metadata lists 172 feature columns matching the .pt tensor.
2025-12-22 18:34:54 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-22 18:34:54 INFO → Total feature dimensionality observed and confirmed: node_dim = 172, edge_dim = 11.
2025-12-22 18:34:54 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-22 18:34:54 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 172,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 172,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge/v1",
      "alias": "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA",
      "jobs": 16,
      "summary": "DSSP-derived node features merged with topology statistics."
    },
    "topology": {
      "id": "topology/persistence_basic/v1",
      "alias": "Betti 0 and Betti 1 topology summaries on interface coords = 140D PH | TopoQA",
      "jobs": 16,
      "summary": "Persistent homology features with configurable distance thresholds."
    }
  },
  "notes": []
}
2025-12-22 18:34:54 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-22 18:34:54 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=68c344727a104ec2979498fc4489e835)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-22 18:34:54 INFO Starting training (fast_dev_run=False)
2025-12-22 18:34:54 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49/model_checkpoints exists and is not empty.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 5.5 K  | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
165 K     Trainable params
0         Non-trainable params
165 K     Total params
0.662     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-22 18:35:09 INFO Epoch 000 | 25% complete (batch 46/181)
2025-12-22 18:35:09 INFO Epoch 000 | 50% complete (batch 91/181)
2025-12-22 18:35:10 INFO Epoch 000 | 75% complete (batch 136/181)
2025-12-22 18:35:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.147866
2025-12-22 18:35:23 INFO Tuning ranking metrics: regret=0.181193 spearman=-0.099397 (groups=37, skipped=311)
2025-12-22 18:35:23 INFO Epoch 000 | val_loss=0.147866
Metric tuning_rank_spearman improved. New best score: -0.099
2025-12-22 18:35:31 INFO Epoch 001 | 25% complete (batch 46/181)
2025-12-22 18:35:32 INFO Epoch 001 | 50% complete (batch 91/181)
2025-12-22 18:35:33 INFO Epoch 001 | 75% complete (batch 136/181)
2025-12-22 18:35:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.063807
2025-12-22 18:36:21 INFO Tuning ranking metrics: regret=0.184422 spearman=-0.086410 (groups=37, skipped=311)
2025-12-22 18:36:21 INFO Epoch 001 | train_mse=0.140802 | val_loss=0.140320 | best_val_loss=-0.099397
Metric tuning_rank_spearman improved by 0.013 >= min_delta = 0.0. New best score: -0.086
2025-12-22 18:38:14 INFO Epoch 002 | 25% complete (batch 46/181)
2025-12-22 18:39:10 INFO Epoch 002 | 50% complete (batch 91/181)
2025-12-22 18:40:14 INFO Epoch 002 | 75% complete (batch 136/181)
2025-12-22 18:42:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.327879
2025-12-22 18:43:32 INFO Tuning ranking metrics: regret=0.210254 spearman=-0.059939 (groups=37, skipped=311)
2025-12-22 18:43:32 INFO Epoch 002 | train_mse=0.145474 | val_loss=0.140368 | best_val_loss=-0.086410
Metric tuning_rank_spearman improved by 0.026 >= min_delta = 0.0. New best score: -0.060
2025-12-22 18:45:42 INFO Epoch 003 | 25% complete (batch 46/181)
2025-12-22 18:47:05 INFO Epoch 003 | 50% complete (batch 91/181)
2025-12-22 18:48:16 INFO Epoch 003 | 75% complete (batch 136/181)
2025-12-22 18:50:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.401907
2025-12-22 18:51:03 INFO Tuning ranking metrics: regret=0.214091 spearman=-0.085082 (groups=37, skipped=311)
2025-12-22 18:51:03 INFO Epoch 003 | train_mse=0.147111 | val_loss=0.139697 | best_val_loss=-0.059939
2025-12-22 18:52:59 INFO Epoch 004 | 25% complete (batch 46/181)
2025-12-22 18:53:38 INFO Epoch 004 | 50% complete (batch 91/181)
2025-12-22 18:54:01 INFO Epoch 004 | 75% complete (batch 136/181)
2025-12-22 18:56:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.403173
2025-12-22 18:56:57 INFO Tuning ranking metrics: regret=0.197971 spearman=0.039815 (groups=37, skipped=311)
2025-12-22 18:56:57 INFO Epoch 004 | train_mse=0.135344 | val_loss=0.142137 | best_val_loss=-0.059939
Metric tuning_rank_spearman improved by 0.100 >= min_delta = 0.0. New best score: 0.040
2025-12-22 18:58:53 INFO Epoch 005 | 25% complete (batch 46/181)
2025-12-22 18:59:34 INFO Epoch 005 | 50% complete (batch 91/181)
2025-12-22 19:00:03 INFO Epoch 005 | 75% complete (batch 136/181)
2025-12-22 19:01:04 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.338743
2025-12-22 19:01:34 INFO Tuning ranking metrics: regret=0.205369 spearman=-0.018117 (groups=37, skipped=311)
2025-12-22 19:01:34 INFO Epoch 005 | train_mse=0.147019 | val_loss=0.136713 | best_val_loss=0.039815
2025-12-22 19:02:25 INFO Epoch 006 | 25% complete (batch 46/181)
2025-12-22 19:02:44 INFO Epoch 006 | 50% complete (batch 91/181)
2025-12-22 19:03:06 INFO Epoch 006 | 75% complete (batch 136/181)
2025-12-22 19:03:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.381472
2025-12-22 19:04:28 INFO Tuning ranking metrics: regret=0.146448 spearman=-0.133842 (groups=37, skipped=311)
2025-12-22 19:04:28 INFO Epoch 006 | train_mse=0.145481 | val_loss=0.147138 | best_val_loss=0.039815
2025-12-22 19:04:52 INFO Epoch 007 | 25% complete (batch 46/181)
2025-12-22 19:04:54 INFO Epoch 007 | 50% complete (batch 91/181)
2025-12-22 19:04:55 INFO Epoch 007 | 75% complete (batch 136/181)
2025-12-22 19:05:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.140861
2025-12-22 19:05:12 INFO Tuning ranking metrics: regret=0.165003 spearman=-0.093120 (groups=37, skipped=311)
2025-12-22 19:05:12 INFO Epoch 007 | train_mse=0.142245 | val_loss=0.140861 | best_val_loss=0.039815
2025-12-22 19:05:22 INFO Epoch 008 | 25% complete (batch 46/181)
2025-12-22 19:05:23 INFO Epoch 008 | 50% complete (batch 91/181)
2025-12-22 19:05:24 INFO Epoch 008 | 75% complete (batch 136/181)
2025-12-22 19:05:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.141724
2025-12-22 19:05:40 INFO Tuning ranking metrics: regret=0.198526 spearman=0.069995 (groups=37, skipped=311)
2025-12-22 19:05:40 INFO Epoch 008 | train_mse=0.135149 | val_loss=0.141724 | best_val_loss=0.039815
Metric tuning_rank_spearman improved by 0.030 >= min_delta = 0.0. New best score: 0.070
2025-12-22 19:05:50 INFO Epoch 009 | 25% complete (batch 46/181)
2025-12-22 19:05:51 INFO Epoch 009 | 50% complete (batch 91/181)
2025-12-22 19:05:52 INFO Epoch 009 | 75% complete (batch 136/181)
2025-12-22 19:06:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.268184
2025-12-22 19:06:08 INFO Tuning ranking metrics: regret=0.183993 spearman=-0.079314 (groups=37, skipped=311)
2025-12-22 19:06:08 INFO Epoch 009 | train_mse=0.151955 | val_loss=0.140991 | best_val_loss=0.069995
2025-12-22 19:06:18 INFO Epoch 010 | 25% complete (batch 46/181)
2025-12-22 19:06:20 INFO Epoch 010 | 50% complete (batch 91/181)
2025-12-22 19:06:21 INFO Epoch 010 | 75% complete (batch 136/181)
2025-12-22 19:06:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.142818
2025-12-22 19:06:37 INFO Tuning ranking metrics: regret=0.184290 spearman=0.045022 (groups=37, skipped=311)
2025-12-22 19:06:37 INFO Epoch 010 | train_mse=0.149919 | val_loss=0.142818 | best_val_loss=0.069995
2025-12-22 19:06:47 INFO Epoch 011 | 25% complete (batch 46/181)
2025-12-22 19:06:49 INFO Epoch 011 | 50% complete (batch 91/181)
2025-12-22 19:06:50 INFO Epoch 011 | 75% complete (batch 136/181)
2025-12-22 19:07:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.348082
2025-12-22 19:07:07 INFO Tuning ranking metrics: regret=0.194287 spearman=0.147426 (groups=37, skipped=311)
2025-12-22 19:07:07 INFO Epoch 011 | train_mse=0.135816 | val_loss=0.139866 | best_val_loss=0.069995
Metric tuning_rank_spearman improved by 0.077 >= min_delta = 0.0. New best score: 0.147
2025-12-22 19:07:17 INFO Epoch 012 | 25% complete (batch 46/181)
2025-12-22 19:07:18 INFO Epoch 012 | 50% complete (batch 91/181)
2025-12-22 19:07:20 INFO Epoch 012 | 75% complete (batch 136/181)
2025-12-22 19:07:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.242204
2025-12-22 19:07:36 INFO Tuning ranking metrics: regret=0.184544 spearman=0.069305 (groups=37, skipped=311)
2025-12-22 19:07:36 INFO Epoch 012 | train_mse=0.151157 | val_loss=0.139187 | best_val_loss=0.147426
2025-12-22 19:07:46 INFO Epoch 013 | 25% complete (batch 46/181)
2025-12-22 19:07:47 INFO Epoch 013 | 50% complete (batch 91/181)
2025-12-22 19:07:48 INFO Epoch 013 | 75% complete (batch 136/181)
2025-12-22 19:07:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.322872
2025-12-22 19:08:04 INFO Tuning ranking metrics: regret=0.201116 spearman=0.009231 (groups=37, skipped=311)
2025-12-22 19:08:04 INFO Epoch 013 | train_mse=0.134355 | val_loss=0.141015 | best_val_loss=0.147426
2025-12-22 19:08:14 INFO Epoch 014 | 25% complete (batch 46/181)
2025-12-22 19:08:16 INFO Epoch 014 | 50% complete (batch 91/181)
2025-12-22 19:08:17 INFO Epoch 014 | 75% complete (batch 136/181)
2025-12-22 19:08:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.438416
2025-12-22 19:08:33 INFO Tuning ranking metrics: regret=0.179458 spearman=-0.008933 (groups=37, skipped=311)
2025-12-22 19:08:33 INFO Epoch 014 | train_mse=0.144973 | val_loss=0.123863 | best_val_loss=0.147426
2025-12-22 19:08:44 INFO Epoch 015 | 25% complete (batch 46/181)
2025-12-22 19:08:45 INFO Epoch 015 | 50% complete (batch 91/181)
2025-12-22 19:08:46 INFO Epoch 015 | 75% complete (batch 136/181)
2025-12-22 19:08:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.486362
2025-12-22 19:09:03 INFO Tuning ranking metrics: regret=0.129597 spearman=-0.079835 (groups=37, skipped=311)
2025-12-22 19:09:03 INFO Epoch 015 | train_mse=0.136288 | val_loss=0.141276 | best_val_loss=0.147426
2025-12-22 19:09:13 INFO Epoch 016 | 25% complete (batch 46/181)
2025-12-22 19:09:15 INFO Epoch 016 | 50% complete (batch 91/181)
2025-12-22 19:09:16 INFO Epoch 016 | 75% complete (batch 136/181)
2025-12-22 19:09:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.141009
2025-12-22 19:09:32 INFO Tuning ranking metrics: regret=0.202967 spearman=-0.005979 (groups=37, skipped=311)
2025-12-22 19:09:32 INFO Epoch 016 | train_mse=0.149538 | val_loss=0.141009 | best_val_loss=0.147426
2025-12-22 19:09:43 INFO Epoch 017 | 25% complete (batch 46/181)
2025-12-22 19:09:44 INFO Epoch 017 | 50% complete (batch 91/181)
2025-12-22 19:09:46 INFO Epoch 017 | 75% complete (batch 136/181)
2025-12-22 19:09:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.398654
2025-12-22 19:10:02 INFO Tuning ranking metrics: regret=0.203494 spearman=0.067679 (groups=37, skipped=311)
2025-12-22 19:10:02 INFO Epoch 017 | train_mse=0.154701 | val_loss=0.118873 | best_val_loss=0.147426
2025-12-22 19:10:13 INFO Epoch 018 | 25% complete (batch 46/181)
2025-12-22 19:10:14 INFO Epoch 018 | 50% complete (batch 91/181)
2025-12-22 19:10:16 INFO Epoch 018 | 75% complete (batch 136/181)
2025-12-22 19:10:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.442979
2025-12-22 19:10:32 INFO Tuning ranking metrics: regret=0.154955 spearman=-0.018404 (groups=37, skipped=311)
2025-12-22 19:10:32 INFO Epoch 018 | train_mse=0.125490 | val_loss=0.089688 | best_val_loss=0.147426
2025-12-22 19:10:42 INFO Epoch 019 | 25% complete (batch 46/181)
2025-12-22 19:10:44 INFO Epoch 019 | 50% complete (batch 91/181)
2025-12-22 19:10:45 INFO Epoch 019 | 75% complete (batch 136/181)
2025-12-22 19:10:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.556589
2025-12-22 19:11:02 INFO Tuning ranking metrics: regret=0.174580 spearman=-0.054680 (groups=37, skipped=311)
2025-12-22 19:11:02 INFO Epoch 019 | train_mse=0.109957 | val_loss=0.086324 | best_val_loss=0.147426
2025-12-22 19:11:12 INFO Epoch 020 | 25% complete (batch 46/181)
2025-12-22 19:11:13 INFO Epoch 020 | 50% complete (batch 91/181)
2025-12-22 19:11:15 INFO Epoch 020 | 75% complete (batch 136/181)
2025-12-22 19:11:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.567987
2025-12-22 19:11:31 INFO Tuning ranking metrics: regret=0.171626 spearman=-0.023950 (groups=37, skipped=311)
2025-12-22 19:11:31 INFO Epoch 020 | train_mse=0.100018 | val_loss=0.097193 | best_val_loss=0.147426
2025-12-22 19:11:41 INFO Epoch 021 | 25% complete (batch 46/181)
2025-12-22 19:11:43 INFO Epoch 021 | 50% complete (batch 91/181)
2025-12-22 19:11:44 INFO Epoch 021 | 75% complete (batch 136/181)
2025-12-22 19:11:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.547895
2025-12-22 19:12:00 INFO Tuning ranking metrics: regret=0.180969 spearman=0.064216 (groups=37, skipped=311)
2025-12-22 19:12:00 INFO Epoch 021 | train_mse=0.076583 | val_loss=0.121309 | best_val_loss=0.147426
2025-12-22 19:12:10 INFO Epoch 022 | 25% complete (batch 46/181)
2025-12-22 19:12:11 INFO Epoch 022 | 50% complete (batch 91/181)
2025-12-22 19:12:13 INFO Epoch 022 | 75% complete (batch 136/181)
2025-12-22 19:12:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.554589
2025-12-22 19:12:29 INFO Tuning ranking metrics: regret=0.195899 spearman=0.017345 (groups=37, skipped=311)
2025-12-22 19:12:29 INFO Epoch 022 | train_mse=0.120513 | val_loss=0.089866 | best_val_loss=0.147426
2025-12-22 19:12:39 INFO Epoch 023 | 25% complete (batch 46/181)
2025-12-22 19:12:41 INFO Epoch 023 | 50% complete (batch 91/181)
2025-12-22 19:12:42 INFO Epoch 023 | 75% complete (batch 136/181)
2025-12-22 19:12:53 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.560930
2025-12-22 19:12:59 INFO Tuning ranking metrics: regret=0.195875 spearman=0.019188 (groups=37, skipped=311)
2025-12-22 19:12:59 INFO Epoch 023 | train_mse=0.100923 | val_loss=0.089730 | best_val_loss=0.147426
2025-12-22 19:13:09 INFO Epoch 024 | 25% complete (batch 46/181)
2025-12-22 19:13:10 INFO Epoch 024 | 50% complete (batch 91/181)
2025-12-22 19:13:11 INFO Epoch 024 | 75% complete (batch 136/181)
2025-12-22 19:13:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.558632
2025-12-22 19:13:28 INFO Tuning ranking metrics: regret=0.188233 spearman=-0.003756 (groups=37, skipped=311)
2025-12-22 19:13:28 INFO Epoch 024 | train_mse=0.096398 | val_loss=0.102205 | best_val_loss=0.147426
2025-12-22 19:13:37 INFO Epoch 025 | 25% complete (batch 46/181)
2025-12-22 19:13:38 INFO Epoch 025 | 50% complete (batch 91/181)
2025-12-22 19:13:40 INFO Epoch 025 | 75% complete (batch 136/181)
2025-12-22 19:13:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.629113
2025-12-22 19:13:54 INFO Tuning ranking metrics: regret=0.170388 spearman=0.069609 (groups=37, skipped=311)
2025-12-22 19:13:54 INFO Epoch 025 | train_mse=0.103422 | val_loss=0.070675 | best_val_loss=0.147426
2025-12-22 19:14:04 INFO Epoch 026 | 25% complete (batch 46/181)
2025-12-22 19:14:05 INFO Epoch 026 | 50% complete (batch 91/181)
2025-12-22 19:14:07 INFO Epoch 026 | 75% complete (batch 136/181)
2025-12-22 19:14:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.642653
2025-12-22 19:14:23 INFO Tuning ranking metrics: regret=0.170276 spearman=0.078103 (groups=37, skipped=311)
2025-12-22 19:14:23 INFO Epoch 026 | train_mse=0.092685 | val_loss=0.079251 | best_val_loss=0.147426
2025-12-22 19:14:33 INFO Epoch 027 | 25% complete (batch 46/181)
2025-12-22 19:14:34 INFO Epoch 027 | 50% complete (batch 91/181)
2025-12-22 19:14:36 INFO Epoch 027 | 75% complete (batch 136/181)
2025-12-22 19:14:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.635368
2025-12-22 19:14:52 INFO Tuning ranking metrics: regret=0.170276 spearman=0.074775 (groups=37, skipped=311)
2025-12-22 19:14:52 INFO Epoch 027 | train_mse=0.113997 | val_loss=0.080165 | best_val_loss=0.147426
2025-12-22 19:15:01 INFO Epoch 028 | 25% complete (batch 46/181)
2025-12-22 19:15:02 INFO Epoch 028 | 50% complete (batch 91/181)
2025-12-22 19:15:04 INFO Epoch 028 | 75% complete (batch 136/181)
2025-12-22 19:15:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.634406
2025-12-22 19:15:19 INFO Tuning ranking metrics: regret=0.170211 spearman=0.066626 (groups=37, skipped=311)
2025-12-22 19:15:19 INFO Epoch 028 | train_mse=0.098656 | val_loss=0.077387 | best_val_loss=0.147426
2025-12-22 19:15:28 INFO Epoch 029 | 25% complete (batch 46/181)
2025-12-22 19:15:30 INFO Epoch 029 | 50% complete (batch 91/181)
2025-12-22 19:15:31 INFO Epoch 029 | 75% complete (batch 136/181)
2025-12-22 19:15:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.643888
2025-12-22 19:15:48 INFO Tuning ranking metrics: regret=0.141756 spearman=0.011273 (groups=37, skipped=311)
2025-12-22 19:15:48 INFO Epoch 029 | train_mse=0.086174 | val_loss=0.072986 | best_val_loss=0.147426
2025-12-22 19:15:59 INFO Epoch 030 | 25% complete (batch 46/181)
2025-12-22 19:16:01 INFO Epoch 030 | 50% complete (batch 91/181)
2025-12-22 19:16:02 INFO Epoch 030 | 75% complete (batch 136/181)
2025-12-22 19:16:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.676097
2025-12-22 19:16:20 INFO Tuning ranking metrics: regret=0.172356 spearman=0.036030 (groups=37, skipped=311)
2025-12-22 19:16:20 INFO Epoch 030 | train_mse=0.096780 | val_loss=0.069232 | best_val_loss=0.147426
2025-12-22 19:16:30 INFO Epoch 031 | 25% complete (batch 46/181)
2025-12-22 19:16:31 INFO Epoch 031 | 50% complete (batch 91/181)
2025-12-22 19:16:33 INFO Epoch 031 | 75% complete (batch 136/181)
2025-12-22 19:16:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.659292
2025-12-22 19:16:47 INFO Tuning ranking metrics: regret=0.171450 spearman=0.064602 (groups=37, skipped=311)
2025-12-22 19:16:47 INFO Epoch 031 | train_mse=0.088140 | val_loss=0.067391 | best_val_loss=0.147426
2025-12-22 19:16:57 INFO Epoch 032 | 25% complete (batch 46/181)
2025-12-22 19:16:58 INFO Epoch 032 | 50% complete (batch 91/181)
2025-12-22 19:16:59 INFO Epoch 032 | 75% complete (batch 136/181)
2025-12-22 19:17:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.688072
2025-12-22 19:17:15 INFO Tuning ranking metrics: regret=0.151770 spearman=0.000281 (groups=37, skipped=311)
2025-12-22 19:17:15 INFO Epoch 032 | train_mse=0.078947 | val_loss=0.067065 | best_val_loss=0.147426
2025-12-22 19:17:27 INFO Epoch 033 | 25% complete (batch 46/181)
2025-12-22 19:17:28 INFO Epoch 033 | 50% complete (batch 91/181)
2025-12-22 19:17:29 INFO Epoch 033 | 75% complete (batch 136/181)
2025-12-22 19:17:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.676935
2025-12-22 19:17:44 INFO Tuning ranking metrics: regret=0.156918 spearman=0.034006 (groups=37, skipped=311)
2025-12-22 19:17:44 INFO Epoch 033 | train_mse=0.088648 | val_loss=0.080868 | best_val_loss=0.147426
2025-12-22 19:17:54 INFO Epoch 034 | 25% complete (batch 46/181)
2025-12-22 19:17:55 INFO Epoch 034 | 50% complete (batch 91/181)
2025-12-22 19:17:56 INFO Epoch 034 | 75% complete (batch 136/181)
2025-12-22 19:18:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.707903
2025-12-22 19:18:11 INFO Tuning ranking metrics: regret=0.140414 spearman=-0.016667 (groups=37, skipped=311)
2025-12-22 19:18:11 INFO Epoch 034 | train_mse=0.084358 | val_loss=0.060916 | best_val_loss=0.147426
2025-12-22 19:18:21 INFO Epoch 035 | 25% complete (batch 46/181)
2025-12-22 19:18:22 INFO Epoch 035 | 50% complete (batch 91/181)
2025-12-22 19:18:23 INFO Epoch 035 | 75% complete (batch 136/181)
2025-12-22 19:18:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.663039
2025-12-22 19:18:38 INFO Tuning ranking metrics: regret=0.158914 spearman=0.012361 (groups=37, skipped=311)
2025-12-22 19:18:38 INFO Epoch 035 | train_mse=0.071892 | val_loss=0.095954 | best_val_loss=0.147426
2025-12-22 19:18:47 INFO Epoch 036 | 25% complete (batch 46/181)
2025-12-22 19:18:48 INFO Epoch 036 | 50% complete (batch 91/181)
2025-12-22 19:18:49 INFO Epoch 036 | 75% complete (batch 136/181)
2025-12-22 19:18:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.705654
2025-12-22 19:19:04 INFO Tuning ranking metrics: regret=0.152608 spearman=0.008354 (groups=37, skipped=311)
2025-12-22 19:19:04 INFO Epoch 036 | train_mse=0.081772 | val_loss=0.064691 | best_val_loss=0.147426
2025-12-22 19:19:14 INFO Epoch 037 | 25% complete (batch 46/181)
2025-12-22 19:19:15 INFO Epoch 037 | 50% complete (batch 91/181)
2025-12-22 19:19:16 INFO Epoch 037 | 75% complete (batch 136/181)
2025-12-22 19:19:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.681734
2025-12-22 19:19:31 INFO Tuning ranking metrics: regret=0.142222 spearman=-0.005657 (groups=37, skipped=311)
2025-12-22 19:19:31 INFO Epoch 037 | train_mse=0.082552 | val_loss=0.062051 | best_val_loss=0.147426
2025-12-22 19:19:41 INFO Epoch 038 | 25% complete (batch 46/181)
2025-12-22 19:19:42 INFO Epoch 038 | 50% complete (batch 91/181)
2025-12-22 19:19:43 INFO Epoch 038 | 75% complete (batch 136/181)
2025-12-22 19:19:53 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.694423
2025-12-22 19:19:58 INFO Tuning ranking metrics: regret=0.137790 spearman=0.022751 (groups=37, skipped=311)
2025-12-22 19:19:58 INFO Epoch 038 | train_mse=0.079685 | val_loss=0.066080 | best_val_loss=0.147426
2025-12-22 19:20:08 INFO Epoch 039 | 25% complete (batch 46/181)
2025-12-22 19:20:09 INFO Epoch 039 | 50% complete (batch 91/181)
2025-12-22 19:20:10 INFO Epoch 039 | 75% complete (batch 136/181)
2025-12-22 19:20:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.667791
2025-12-22 19:20:25 INFO Tuning ranking metrics: regret=0.157058 spearman=-0.032941 (groups=37, skipped=311)
2025-12-22 19:20:25 INFO Epoch 039 | train_mse=0.063557 | val_loss=0.083641 | best_val_loss=0.147426
2025-12-22 19:20:35 INFO Epoch 040 | 25% complete (batch 46/181)
2025-12-22 19:20:36 INFO Epoch 040 | 50% complete (batch 91/181)
2025-12-22 19:20:37 INFO Epoch 040 | 75% complete (batch 136/181)
2025-12-22 19:20:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.694938
2025-12-22 19:20:52 INFO Tuning ranking metrics: regret=0.141899 spearman=-0.016649 (groups=37, skipped=311)
2025-12-22 19:20:52 INFO Epoch 040 | train_mse=0.086424 | val_loss=0.058824 | best_val_loss=0.147426
2025-12-22 19:21:01 INFO Epoch 041 | 25% complete (batch 46/181)
2025-12-22 19:21:02 INFO Epoch 041 | 50% complete (batch 91/181)
2025-12-22 19:21:03 INFO Epoch 041 | 75% complete (batch 136/181)
2025-12-22 19:21:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.657949
2025-12-22 19:21:18 INFO Tuning ranking metrics: regret=0.140080 spearman=0.037124 (groups=37, skipped=311)
2025-12-22 19:21:18 INFO Epoch 041 | train_mse=0.086071 | val_loss=0.111272 | best_val_loss=0.147426
2025-12-22 19:21:28 INFO Epoch 042 | 25% complete (batch 46/181)
2025-12-22 19:21:29 INFO Epoch 042 | 50% complete (batch 91/181)
2025-12-22 19:21:30 INFO Epoch 042 | 75% complete (batch 136/181)
2025-12-22 19:21:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.694946
2025-12-22 19:21:45 INFO Tuning ranking metrics: regret=0.142530 spearman=0.040997 (groups=37, skipped=311)
2025-12-22 19:21:45 INFO Epoch 042 | train_mse=0.069059 | val_loss=0.076087 | best_val_loss=0.147426
2025-12-22 19:21:54 INFO Epoch 043 | 25% complete (batch 46/181)
2025-12-22 19:21:55 INFO Epoch 043 | 50% complete (batch 91/181)
2025-12-22 19:21:56 INFO Epoch 043 | 75% complete (batch 136/181)
2025-12-22 19:22:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.683839
2025-12-22 19:22:11 INFO Tuning ranking metrics: regret=0.156391 spearman=0.048754 (groups=37, skipped=311)
2025-12-22 19:22:11 INFO Epoch 043 | train_mse=0.084445 | val_loss=0.072204 | best_val_loss=0.147426
2025-12-22 19:22:21 INFO Epoch 044 | 25% complete (batch 46/181)
2025-12-22 19:22:22 INFO Epoch 044 | 50% complete (batch 91/181)
2025-12-22 19:22:23 INFO Epoch 044 | 75% complete (batch 136/181)
2025-12-22 19:22:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.696033
2025-12-22 19:22:38 INFO Tuning ranking metrics: regret=0.139464 spearman=0.013414 (groups=37, skipped=311)
2025-12-22 19:22:38 INFO Epoch 044 | train_mse=0.078888 | val_loss=0.064017 | best_val_loss=0.147426
2025-12-22 19:22:48 INFO Epoch 045 | 25% complete (batch 46/181)
2025-12-22 19:22:49 INFO Epoch 045 | 50% complete (batch 91/181)
2025-12-22 19:22:50 INFO Epoch 045 | 75% complete (batch 136/181)
2025-12-22 19:22:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.703529
2025-12-22 19:23:05 INFO Tuning ranking metrics: regret=0.138747 spearman=-0.011718 (groups=37, skipped=311)
2025-12-22 19:23:05 INFO Epoch 045 | train_mse=0.085081 | val_loss=0.064653 | best_val_loss=0.147426
2025-12-22 19:23:15 INFO Epoch 046 | 25% complete (batch 46/181)
2025-12-22 19:23:16 INFO Epoch 046 | 50% complete (batch 91/181)
2025-12-22 19:23:17 INFO Epoch 046 | 75% complete (batch 136/181)
2025-12-22 19:23:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.707563
2025-12-22 19:23:32 INFO Tuning ranking metrics: regret=0.139548 spearman=-0.011016 (groups=37, skipped=311)
2025-12-22 19:23:32 INFO Epoch 046 | train_mse=0.076074 | val_loss=0.060485 | best_val_loss=0.147426
2025-12-22 19:23:42 INFO Epoch 047 | 25% complete (batch 46/181)
2025-12-22 19:23:43 INFO Epoch 047 | 50% complete (batch 91/181)
2025-12-22 19:23:44 INFO Epoch 047 | 75% complete (batch 136/181)
2025-12-22 19:23:53 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.712504
2025-12-22 19:23:59 INFO Tuning ranking metrics: regret=0.139659 spearman=0.007424 (groups=37, skipped=311)
2025-12-22 19:23:59 INFO Epoch 047 | train_mse=0.070265 | val_loss=0.059183 | best_val_loss=0.147426
2025-12-22 19:24:08 INFO Epoch 048 | 25% complete (batch 46/181)
2025-12-22 19:24:09 INFO Epoch 048 | 50% complete (batch 91/181)
2025-12-22 19:24:11 INFO Epoch 048 | 75% complete (batch 136/181)
2025-12-22 19:24:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.700509
2025-12-22 19:24:26 INFO Tuning ranking metrics: regret=0.138942 spearman=-0.023078 (groups=37, skipped=311)
2025-12-22 19:24:26 INFO Epoch 048 | train_mse=0.070737 | val_loss=0.071278 | best_val_loss=0.147426
2025-12-22 19:24:36 INFO Epoch 049 | 25% complete (batch 46/181)
2025-12-22 19:24:37 INFO Epoch 049 | 50% complete (batch 91/181)
2025-12-22 19:24:38 INFO Epoch 049 | 75% complete (batch 136/181)
2025-12-22 19:24:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.717130
2025-12-22 19:24:52 INFO Tuning ranking metrics: regret=0.139638 spearman=0.015760 (groups=37, skipped=311)
2025-12-22 19:24:52 INFO Epoch 049 | train_mse=0.070714 | val_loss=0.057239 | best_val_loss=0.147426
2025-12-22 19:25:02 INFO Epoch 050 | 25% complete (batch 46/181)
2025-12-22 19:25:03 INFO Epoch 050 | 50% complete (batch 91/181)
2025-12-22 19:25:04 INFO Epoch 050 | 75% complete (batch 136/181)
2025-12-22 19:25:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.673653
2025-12-22 19:25:20 INFO Tuning ranking metrics: regret=0.157769 spearman=0.055160 (groups=37, skipped=311)
2025-12-22 19:25:20 INFO Epoch 050 | train_mse=0.077894 | val_loss=0.095770 | best_val_loss=0.147426
2025-12-22 19:25:29 INFO Epoch 051 | 25% complete (batch 46/181)
2025-12-22 19:25:31 INFO Epoch 051 | 50% complete (batch 91/181)
2025-12-22 19:25:32 INFO Epoch 051 | 75% complete (batch 136/181)
2025-12-22 19:25:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.688026
2025-12-22 19:25:47 INFO Tuning ranking metrics: regret=0.157796 spearman=-0.000503 (groups=37, skipped=311)
2025-12-22 19:25:47 INFO Epoch 051 | train_mse=0.070939 | val_loss=0.061024 | best_val_loss=0.147426
Monitored metric tuning_rank_spearman did not improve in the last 40 records. Best score: 0.147. Signaling Trainer to stop.
2025-12-22 19:25:48 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.07477_val-0.08016_epoch027.chkpt, checkpoint.tuning_rank_spearman-0.07810_val-0.07925_epoch026.chkpt, checkpoint.tuning_rank_spearman-0.14743_val-0.13987_epoch011.chkpt
2025-12-22 19:25:48 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49/model_checkpoints/checkpoint.tuning_rank_spearman-0.14743_val-0.13987_epoch011.chkpt
2025-12-22 19:25:48 INFO Best validation loss: tensor(0.1474)
2025-12-22 19:25:48 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49/model_checkpoints/checkpoint.tuning_rank_spearman-0.14743_val-0.13987_epoch011.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49/model_checkpoints/checkpoint.tuning_rank_spearman-0.14743_val-0.13987_epoch011.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-22 19:25:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.139866
2025-12-22 19:26:01 INFO Tuning ranking metrics: regret=0.194287 spearman=0.147426 (groups=37, skipped=311)
2025-12-22 19:26:01 INFO Epoch 052 | val_loss=0.139866 | best_val_loss=0.147426
2025-12-22 19:26:02 INFO Validation metrics: [{'val_loss': 0.13986611366271973, 'tuning_rank_regret': 0.19428704679012299, 'tuning_rank_spearman': 0.14742599427700043, 'val_pearson_corr': 0.4009725749492645, 'val_spearman_corr': 0.3813915252685547, 'val_rank_regret': 0.1036984920501709, 'val_rank_spearman': -0.1111111119389534}]
2025-12-22 19:26:02 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.14743_val-0.13987_epoch011.chkpt
2025-12-22 19:26:02 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.07810_val-0.07925_epoch026.chkpt
2025-12-22 19:26:02 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.07477_val-0.08016_epoch027.chkpt
2025-12-22 19:26:02 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.13671_epoch005.ckpt
2025-12-22 19:26:02 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.19428704679012299
  tuning_rank_spearman      0.14742599427700043
        val_loss            0.13986611366271973
    val_pearson_corr        0.4009725749492645
     val_rank_regret        0.1036984920501709
    val_rank_spearman       -0.1111111119389534
    val_spearman_corr       0.3813915252685547
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run polish_seed101_2025-12-22_18-34-49 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49
[train_cli][batch] job 'polish_seed101' finished.
[train_cli][batch] (2/6) running job 'polish_lr_low_seed101' -> run_name=polish_lr_low_seed101_2025-12-22_19-26-05
[train_cli] run_id=polish_lr_low_seed101_2025-12-22_19-26-05 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-22_19-26-05/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-22_19-26-05 --git-commit 150d1dcbd1 --git-dirty
2025-12-22 19:26:08 INFO git_commit = 150d1dcbd1 (dirty)
2025-12-22 19:26:08 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-22 19:26:08 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-22_19-26-05/config/config.yaml
2025-12-22 19:26:08 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data
2025-12-22 19:26:08 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-22 19:26:08 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-22 19:26:08 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-22_19-26-05
2025-12-22 19:26:08 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-22 19:26:08 INFO   metadata_path = None
2025-12-22 19:26:08 INFO   summary_path = None
2025-12-22 19:26:08 INFO   accelerator = cpu
2025-12-22 19:26:08 INFO   devices = 1
2025-12-22 19:26:08 INFO   attention_head = 8
2025-12-22 19:26:08 INFO   pooling_type = mean
2025-12-22 19:26:08 INFO   model_self_loops = False
2025-12-22 19:26:08 INFO   model_self_loop_fill = mean
2025-12-22 19:26:08 INFO   model_residual = False
2025-12-22 19:26:08 INFO   batch_size = 12
2025-12-22 19:26:08 INFO   learning_rate = 0.002
2025-12-22 19:26:08 INFO   num_epochs = 360
2025-12-22 19:26:08 INFO   accumulate_grad_batches = 48
2025-12-22 19:26:08 INFO   seed = 101
2025-12-22 19:26:08 INFO   num_workers = 2
2025-12-22 19:26:08 INFO   precision = 32
2025-12-22 19:26:08 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-22 19:26:08 INFO   early_stopping_patience = 50
2025-12-22 19:26:08 INFO   lr_scheduler_patience = 25
2025-12-22 19:26:08 INFO   lr_scheduler_factor = 0.3
2025-12-22 19:26:08 INFO   fast_dev_run = False
2025-12-22 19:26:08 INFO   limit_train_batches = None
2025-12-22 19:26:08 INFO   limit_val_batches = None
2025-12-22 19:26:08 INFO   log_lr = False
2025-12-22 19:26:08 INFO   progress_bar_refresh_rate = 0
2025-12-22 19:26:08 INFO   log_every_n_steps = 100
2025-12-22 19:26:08 INFO   use_val_spearman_as_secondary = True
2025-12-22 19:26:08 INFO   spearman_secondary_min_delta = 0.0
2025-12-22 19:26:08 INFO   spearman_secondary_weight = 1.0
2025-12-22 19:26:08 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-22 19:26:08 INFO   tuning_max_samples = 500
2025-12-22 19:26:08 INFO   tuning_fraction = None
2025-12-22 19:26:08 INFO   tuning_eval_every = 1
2025-12-22 19:26:08 INFO   rank_loss_weight = 0.0
2025-12-22 19:26:08 INFO   rank_loss_margin = 0.0
2025-12-22 19:26:08 INFO   rank_loss_mode = hinge
2025-12-22 19:26:08 INFO   rank_loss_grouped = True
2025-12-22 19:26:08 INFO   variance_reduction_enabled = False
2025-12-22 19:26:08 INFO   variance_reduction_method = topk_avg
2025-12-22 19:26:08 INFO   variance_reduction_top_k = 3
2025-12-22 19:26:08 INFO   coverage_minimum = 0.0
2025-12-22 19:26:08 INFO   coverage_fail_on_missing = False
2025-12-22 19:26:08 INFO   graph_load_profiling = False
2025-12-22 19:26:08 INFO   graph_load_top_k = 5
2025-12-22 19:26:08 INFO   enable_graph_cache = True
2025-12-22 19:26:08 INFO   graph_cache_size = 256
2025-12-22 19:26:08 INFO   canonicalize_on_load = False
2025-12-22 19:26:08 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-22 19:26:08 INFO   edge_schema = {}
2025-12-22 19:26:08 INFO   topology_schema = {}
Seed set to 101
2025-12-22 19:26:09 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-22 19:26:09 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 19:26:09 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-22 19:26:09 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 19:26:09 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-22 19:26:09 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 19:26:10 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-22 19:26:10 INFO Tuning group stats: groups=348 groups>=2=37 singletons=311 max_group=11
2025-12-22 19:26:10 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-22_19-26-05/dataset_coverage.json
2025-12-22 19:26:10 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-22_19-26-05/dataset_coverage.json for details.
2025-12-22 19:26:10 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-22_19-26-05/dataset_coverage.json for details.
2025-12-22 19:26:10 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-22_19-26-05/dataset_coverage.json for details.
2025-12-22 19:26:10 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-22_19-26-05/schema_summary.json
2025-12-22 19:26:10 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-22_19-26-05/feature_metadata.json
2025-12-22 19:26:10 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-22 19:26:10 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/feature-config.yaml.topoqa.10A.2, sha256=5c62898155179232a565e24d9fbd7b208f9ce480d1a19d6139de19454e173ff0
2025-12-22 19:26:10 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/work/edge_features)
2025-12-22 19:26:10 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json
2025-12-22 19:26:10 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-22_19-26-05/schema_summary.json
2025-12-22 19:26:10 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-22 19:26:10 INFO Topology: topology/persistence_basic/v1 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 172-dimensional node features.
2025-12-22 19:26:10 INFO Node: node/dssp_topo_merge/v1; metadata lists 172 feature columns matching the .pt tensor.
2025-12-22 19:26:10 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-22 19:26:10 INFO → Total feature dimensionality observed and confirmed: node_dim = 172, edge_dim = 11.
2025-12-22 19:26:10 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-22 19:26:10 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 172,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 172,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-22_19-26-05/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge/v1",
      "alias": "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA",
      "jobs": 16,
      "summary": "DSSP-derived node features merged with topology statistics."
    },
    "topology": {
      "id": "topology/persistence_basic/v1",
      "alias": "Betti 0 and Betti 1 topology summaries on interface coords = 140D PH | TopoQA",
      "jobs": 16,
      "summary": "Persistent homology features with configurable distance thresholds."
    }
  },
  "notes": []
}
2025-12-22 19:26:10 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-22 19:26:10 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=f121c209495243c88c7c1befcce2b958)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-22 19:26:10 INFO Starting training (fast_dev_run=False)
2025-12-22 19:26:10 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-22_19-26-05/model_checkpoints exists and is not empty.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 5.5 K  | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
165 K     Trainable params
0         Non-trainable params
165 K     Total params
0.662     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-22 19:26:29 INFO Epoch 000 | 25% complete (batch 181/724)
2025-12-22 19:26:33 INFO Epoch 000 | 50% complete (batch 362/724)
2025-12-22 19:26:37 INFO Epoch 000 | 75% complete (batch 543/724)
2025-12-22 19:26:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.153328
2025-12-22 19:26:57 INFO Tuning ranking metrics: regret=0.160259 spearman=-0.020808 (groups=37, skipped=311)
2025-12-22 19:26:57 INFO Epoch 000 | val_loss=0.153328
Metric tuning_rank_spearman improved. New best score: -0.021
2025-12-22 19:27:10 INFO Epoch 001 | 25% complete (batch 181/724)
2025-12-22 19:27:14 INFO Epoch 001 | 50% complete (batch 362/724)
2025-12-22 19:27:18 INFO Epoch 001 | 75% complete (batch 543/724)
2025-12-22 19:27:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.130368
2025-12-22 19:27:40 INFO Tuning ranking metrics: regret=0.179181 spearman=-0.073529 (groups=37, skipped=311)
2025-12-22 19:27:40 INFO Epoch 001 | train_mse=0.149419 | val_loss=0.144895 | best_val_loss=-0.020808
2025-12-22 19:27:53 INFO Epoch 002 | 25% complete (batch 181/724)
2025-12-22 19:27:56 INFO Epoch 002 | 50% complete (batch 362/724)
2025-12-22 19:28:00 INFO Epoch 002 | 75% complete (batch 543/724)
2025-12-22 19:28:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.062717
2025-12-22 19:28:27 INFO Tuning ranking metrics: regret=0.163992 spearman=-0.110787 (groups=37, skipped=311)
2025-12-22 19:28:27 INFO Epoch 002 | train_mse=0.146849 | val_loss=0.147035 | best_val_loss=-0.020808
2025-12-22 19:28:41 INFO Epoch 003 | 25% complete (batch 181/724)
2025-12-22 19:28:45 INFO Epoch 003 | 50% complete (batch 362/724)
2025-12-22 19:28:52 INFO Epoch 003 | 75% complete (batch 543/724)
2025-12-22 19:29:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.173283
2025-12-22 19:29:16 INFO Tuning ranking metrics: regret=0.155744 spearman=0.084685 (groups=37, skipped=311)
2025-12-22 19:29:16 INFO Epoch 003 | train_mse=0.143636 | val_loss=0.144898 | best_val_loss=-0.020808
Metric tuning_rank_spearman improved by 0.105 >= min_delta = 0.0. New best score: 0.085
2025-12-22 19:29:27 INFO Epoch 004 | 25% complete (batch 181/724)
2025-12-22 19:29:30 INFO Epoch 004 | 50% complete (batch 362/724)
2025-12-22 19:29:33 INFO Epoch 004 | 75% complete (batch 543/724)
2025-12-22 19:29:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.345635
2025-12-22 19:29:51 INFO Tuning ranking metrics: regret=0.181390 spearman=0.073020 (groups=37, skipped=311)
2025-12-22 19:29:51 INFO Epoch 004 | train_mse=0.142760 | val_loss=0.142306 | best_val_loss=0.084685
2025-12-22 19:30:02 INFO Epoch 005 | 25% complete (batch 181/724)
2025-12-22 19:30:05 INFO Epoch 005 | 50% complete (batch 362/724)
2025-12-22 19:30:08 INFO Epoch 005 | 75% complete (batch 543/724)
2025-12-22 19:30:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.383497
2025-12-22 19:30:26 INFO Tuning ranking metrics: regret=0.162060 spearman=0.036995 (groups=37, skipped=311)
2025-12-22 19:30:26 INFO Epoch 005 | train_mse=0.142901 | val_loss=0.110116 | best_val_loss=0.084685
2025-12-22 19:30:36 INFO Epoch 006 | 25% complete (batch 181/724)
2025-12-22 19:30:40 INFO Epoch 006 | 50% complete (batch 362/724)
2025-12-22 19:30:43 INFO Epoch 006 | 75% complete (batch 543/724)
2025-12-22 19:30:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.441428
2025-12-22 19:31:02 INFO Tuning ranking metrics: regret=0.167832 spearman=0.084246 (groups=37, skipped=311)
2025-12-22 19:31:02 INFO Epoch 006 | train_mse=0.134653 | val_loss=0.090705 | best_val_loss=0.084685
2025-12-22 19:31:12 INFO Epoch 007 | 25% complete (batch 181/724)
2025-12-22 19:31:16 INFO Epoch 007 | 50% complete (batch 362/724)
2025-12-22 19:31:19 INFO Epoch 007 | 75% complete (batch 543/724)
2025-12-22 19:31:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.481023
2025-12-22 19:31:38 INFO Tuning ranking metrics: regret=0.148103 spearman=0.054107 (groups=37, skipped=311)
2025-12-22 19:31:38 INFO Epoch 007 | train_mse=0.100273 | val_loss=0.111036 | best_val_loss=0.084685
2025-12-22 19:31:48 INFO Epoch 008 | 25% complete (batch 181/724)
2025-12-22 19:31:51 INFO Epoch 008 | 50% complete (batch 362/724)
2025-12-22 19:31:54 INFO Epoch 008 | 75% complete (batch 543/724)
2025-12-22 19:32:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.504307
2025-12-22 19:32:13 INFO Tuning ranking metrics: regret=0.146217 spearman=0.071534 (groups=37, skipped=311)
2025-12-22 19:32:13 INFO Epoch 008 | train_mse=0.098684 | val_loss=0.102786 | best_val_loss=0.084685
2025-12-22 19:32:23 INFO Epoch 009 | 25% complete (batch 181/724)
2025-12-22 19:32:27 INFO Epoch 009 | 50% complete (batch 362/724)
2025-12-22 19:32:30 INFO Epoch 009 | 75% complete (batch 543/724)
2025-12-22 19:32:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.524179
2025-12-22 19:32:48 INFO Tuning ranking metrics: regret=0.147456 spearman=0.062589 (groups=37, skipped=311)
2025-12-22 19:32:48 INFO Epoch 009 | train_mse=0.087887 | val_loss=0.091573 | best_val_loss=0.084685
2025-12-22 19:32:59 INFO Epoch 010 | 25% complete (batch 181/724)
2025-12-22 19:33:02 INFO Epoch 010 | 50% complete (batch 362/724)
2025-12-22 19:33:05 INFO Epoch 010 | 75% complete (batch 543/724)
2025-12-22 19:33:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.543326
2025-12-22 19:33:23 INFO Tuning ranking metrics: regret=0.146161 spearman=0.112525 (groups=37, skipped=311)
2025-12-22 19:33:23 INFO Epoch 010 | train_mse=0.084171 | val_loss=0.080539 | best_val_loss=0.084685
Metric tuning_rank_spearman improved by 0.028 >= min_delta = 0.0. New best score: 0.113
2025-12-22 19:33:33 INFO Epoch 011 | 25% complete (batch 181/724)
2025-12-22 19:33:36 INFO Epoch 011 | 50% complete (batch 362/724)
2025-12-22 19:33:40 INFO Epoch 011 | 75% complete (batch 543/724)
2025-12-22 19:33:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.526624
2025-12-22 19:33:59 INFO Tuning ranking metrics: regret=0.144272 spearman=0.117778 (groups=37, skipped=311)
2025-12-22 19:33:59 INFO Epoch 011 | train_mse=0.078789 | val_loss=0.104501 | best_val_loss=0.112525
Metric tuning_rank_spearman improved by 0.005 >= min_delta = 0.0. New best score: 0.118
2025-12-22 19:34:09 INFO Epoch 012 | 25% complete (batch 181/724)
2025-12-22 19:34:13 INFO Epoch 012 | 50% complete (batch 362/724)
2025-12-22 19:34:16 INFO Epoch 012 | 75% complete (batch 543/724)
2025-12-22 19:34:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.544793
2025-12-22 19:34:35 INFO Tuning ranking metrics: regret=0.144275 spearman=0.130613 (groups=37, skipped=311)
2025-12-22 19:34:35 INFO Epoch 012 | train_mse=0.076427 | val_loss=0.085716 | best_val_loss=0.117778
Metric tuning_rank_spearman improved by 0.013 >= min_delta = 0.0. New best score: 0.131
2025-12-22 19:34:46 INFO Epoch 013 | 25% complete (batch 181/724)
2025-12-22 19:34:49 INFO Epoch 013 | 50% complete (batch 362/724)
2025-12-22 19:34:52 INFO Epoch 013 | 75% complete (batch 543/724)
2025-12-22 19:35:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.574031
2025-12-22 19:35:11 INFO Tuning ranking metrics: regret=0.119771 spearman=0.145226 (groups=37, skipped=311)
2025-12-22 19:35:11 INFO Epoch 013 | train_mse=0.087838 | val_loss=0.075465 | best_val_loss=0.130613
Metric tuning_rank_spearman improved by 0.015 >= min_delta = 0.0. New best score: 0.145
2025-12-22 19:35:22 INFO Epoch 014 | 25% complete (batch 181/724)
2025-12-22 19:35:25 INFO Epoch 014 | 50% complete (batch 362/724)
2025-12-22 19:35:28 INFO Epoch 014 | 75% complete (batch 543/724)
2025-12-22 19:35:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.577938
2025-12-22 19:35:46 INFO Tuning ranking metrics: regret=0.116842 spearman=0.127875 (groups=37, skipped=311)
2025-12-22 19:35:46 INFO Epoch 014 | train_mse=0.071645 | val_loss=0.076028 | best_val_loss=0.145226
2025-12-22 19:35:57 INFO Epoch 015 | 25% complete (batch 181/724)
2025-12-22 19:36:00 INFO Epoch 015 | 50% complete (batch 362/724)
2025-12-22 19:36:04 INFO Epoch 015 | 75% complete (batch 543/724)
2025-12-22 19:36:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.581719
2025-12-22 19:36:22 INFO Tuning ranking metrics: regret=0.146970 spearman=0.080906 (groups=37, skipped=311)
2025-12-22 19:36:22 INFO Epoch 015 | train_mse=0.071440 | val_loss=0.085008 | best_val_loss=0.145226
2025-12-22 19:36:33 INFO Epoch 016 | 25% complete (batch 181/724)
2025-12-22 19:36:36 INFO Epoch 016 | 50% complete (batch 362/724)
2025-12-22 19:36:39 INFO Epoch 016 | 75% complete (batch 543/724)
2025-12-22 19:36:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.550710
2025-12-22 19:36:58 INFO Tuning ranking metrics: regret=0.139299 spearman=0.152001 (groups=37, skipped=311)
2025-12-22 19:36:58 INFO Epoch 016 | train_mse=0.083120 | val_loss=0.122822 | best_val_loss=0.145226
Metric tuning_rank_spearman improved by 0.007 >= min_delta = 0.0. New best score: 0.152
2025-12-22 19:37:08 INFO Epoch 017 | 25% complete (batch 181/724)
2025-12-22 19:37:11 INFO Epoch 017 | 50% complete (batch 362/724)
2025-12-22 19:37:15 INFO Epoch 017 | 75% complete (batch 543/724)
2025-12-22 19:37:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.590493
2025-12-22 19:37:33 INFO Tuning ranking metrics: regret=0.151445 spearman=0.102205 (groups=37, skipped=311)
2025-12-22 19:37:33 INFO Epoch 017 | train_mse=0.083600 | val_loss=0.075217 | best_val_loss=0.152001
2025-12-22 19:37:44 INFO Epoch 018 | 25% complete (batch 181/724)
2025-12-22 19:37:47 INFO Epoch 018 | 50% complete (batch 362/724)
2025-12-22 19:37:50 INFO Epoch 018 | 75% complete (batch 543/724)
2025-12-22 19:38:04 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.600594
2025-12-22 19:38:09 INFO Tuning ranking metrics: regret=0.143206 spearman=0.109044 (groups=37, skipped=311)
2025-12-22 19:38:09 INFO Epoch 018 | train_mse=0.089127 | val_loss=0.072763 | best_val_loss=0.152001
2025-12-22 19:38:20 INFO Epoch 019 | 25% complete (batch 181/724)
2025-12-22 19:38:23 INFO Epoch 019 | 50% complete (batch 362/724)
2025-12-22 19:38:26 INFO Epoch 019 | 75% complete (batch 543/724)
2025-12-22 19:38:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.609728
2025-12-22 19:38:45 INFO Tuning ranking metrics: regret=0.148694 spearman=0.094676 (groups=37, skipped=311)
2025-12-22 19:38:45 INFO Epoch 019 | train_mse=0.071572 | val_loss=0.066247 | best_val_loss=0.152001
2025-12-22 19:38:55 INFO Epoch 020 | 25% complete (batch 181/724)
2025-12-22 19:38:58 INFO Epoch 020 | 50% complete (batch 362/724)
2025-12-22 19:39:01 INFO Epoch 020 | 75% complete (batch 543/724)
2025-12-22 19:39:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.624830
2025-12-22 19:39:20 INFO Tuning ranking metrics: regret=0.122635 spearman=0.115421 (groups=37, skipped=311)
2025-12-22 19:39:20 INFO Epoch 020 | train_mse=0.063571 | val_loss=0.067770 | best_val_loss=0.152001
2025-12-22 19:39:30 INFO Epoch 021 | 25% complete (batch 181/724)
2025-12-22 19:39:34 INFO Epoch 021 | 50% complete (batch 362/724)
2025-12-22 19:39:37 INFO Epoch 021 | 75% complete (batch 543/724)
2025-12-22 19:39:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.625478
2025-12-22 19:39:56 INFO Tuning ranking metrics: regret=0.143890 spearman=0.103902 (groups=37, skipped=311)
2025-12-22 19:39:56 INFO Epoch 021 | train_mse=0.068662 | val_loss=0.076196 | best_val_loss=0.152001
2025-12-22 19:40:06 INFO Epoch 022 | 25% complete (batch 181/724)
2025-12-22 19:40:10 INFO Epoch 022 | 50% complete (batch 362/724)
2025-12-22 19:40:13 INFO Epoch 022 | 75% complete (batch 543/724)
2025-12-22 19:40:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.621161
2025-12-22 19:40:31 INFO Tuning ranking metrics: regret=0.120603 spearman=0.159711 (groups=37, skipped=311)
2025-12-22 19:40:31 INFO Epoch 022 | train_mse=0.060659 | val_loss=0.084836 | best_val_loss=0.152001
Metric tuning_rank_spearman improved by 0.008 >= min_delta = 0.0. New best score: 0.160
2025-12-22 19:40:41 INFO Epoch 023 | 25% complete (batch 181/724)
2025-12-22 19:40:44 INFO Epoch 023 | 50% complete (batch 362/724)
2025-12-22 19:40:48 INFO Epoch 023 | 75% complete (batch 543/724)
2025-12-22 19:41:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.630274
2025-12-22 19:41:06 INFO Tuning ranking metrics: regret=0.143029 spearman=0.135732 (groups=37, skipped=311)
2025-12-22 19:41:06 INFO Epoch 023 | train_mse=0.074350 | val_loss=0.069381 | best_val_loss=0.159711
2025-12-22 19:41:17 INFO Epoch 024 | 25% complete (batch 181/724)
2025-12-22 19:41:21 INFO Epoch 024 | 50% complete (batch 362/724)
2025-12-22 19:41:24 INFO Epoch 024 | 75% complete (batch 543/724)
2025-12-22 19:41:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.637910
2025-12-22 19:41:43 INFO Tuning ranking metrics: regret=0.144340 spearman=0.121282 (groups=37, skipped=311)
2025-12-22 19:41:43 INFO Epoch 024 | train_mse=0.072924 | val_loss=0.064312 | best_val_loss=0.159711
2025-12-22 19:41:53 INFO Epoch 025 | 25% complete (batch 181/724)
2025-12-22 19:41:57 INFO Epoch 025 | 50% complete (batch 362/724)
2025-12-22 19:42:00 INFO Epoch 025 | 75% complete (batch 543/724)
2025-12-22 19:42:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.631812
2025-12-22 19:42:19 INFO Tuning ranking metrics: regret=0.141166 spearman=0.127548 (groups=37, skipped=311)
2025-12-22 19:42:19 INFO Epoch 025 | train_mse=0.060549 | val_loss=0.073413 | best_val_loss=0.159711
2025-12-22 19:42:29 INFO Epoch 026 | 25% complete (batch 181/724)
2025-12-22 19:42:32 INFO Epoch 026 | 50% complete (batch 362/724)
2025-12-22 19:42:35 INFO Epoch 026 | 75% complete (batch 543/724)
2025-12-22 19:42:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.606034
2025-12-22 19:42:54 INFO Tuning ranking metrics: regret=0.144340 spearman=0.107412 (groups=37, skipped=311)
2025-12-22 19:42:54 INFO Epoch 026 | train_mse=0.055963 | val_loss=0.096448 | best_val_loss=0.159711
2025-12-22 19:43:05 INFO Epoch 027 | 25% complete (batch 181/724)
2025-12-22 19:43:08 INFO Epoch 027 | 50% complete (batch 362/724)
2025-12-22 19:43:11 INFO Epoch 027 | 75% complete (batch 543/724)
2025-12-22 19:43:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.643986
2025-12-22 19:43:31 INFO Tuning ranking metrics: regret=0.121488 spearman=0.134860 (groups=37, skipped=311)
2025-12-22 19:43:31 INFO Epoch 027 | train_mse=0.063326 | val_loss=0.059803 | best_val_loss=0.159711
2025-12-22 19:43:41 INFO Epoch 028 | 25% complete (batch 181/724)
2025-12-22 19:43:45 INFO Epoch 028 | 50% complete (batch 362/724)
2025-12-22 19:43:47 INFO Epoch 028 | 75% complete (batch 543/724)
2025-12-22 19:44:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.651739
2025-12-22 19:44:06 INFO Tuning ranking metrics: regret=0.155545 spearman=0.055563 (groups=37, skipped=311)
2025-12-22 19:44:06 INFO Epoch 028 | train_mse=0.063617 | val_loss=0.059343 | best_val_loss=0.159711
2025-12-22 19:44:16 INFO Epoch 029 | 25% complete (batch 181/724)
2025-12-22 19:44:19 INFO Epoch 029 | 50% complete (batch 362/724)
2025-12-22 19:44:23 INFO Epoch 029 | 75% complete (batch 543/724)
2025-12-22 19:44:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.623643
2025-12-22 19:44:41 INFO Tuning ranking metrics: regret=0.120966 spearman=0.112864 (groups=37, skipped=311)
2025-12-22 19:44:41 INFO Epoch 029 | train_mse=0.057776 | val_loss=0.086504 | best_val_loss=0.159711
2025-12-22 19:44:52 INFO Epoch 030 | 25% complete (batch 181/724)
2025-12-22 19:44:55 INFO Epoch 030 | 50% complete (batch 362/724)
2025-12-22 19:44:58 INFO Epoch 030 | 75% complete (batch 543/724)
2025-12-22 19:45:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.648398
2025-12-22 19:45:17 INFO Tuning ranking metrics: regret=0.136288 spearman=0.042383 (groups=37, skipped=311)
2025-12-22 19:45:17 INFO Epoch 030 | train_mse=0.057084 | val_loss=0.057923 | best_val_loss=0.159711
2025-12-22 19:45:27 INFO Epoch 031 | 25% complete (batch 181/724)
2025-12-22 19:45:31 INFO Epoch 031 | 50% complete (batch 362/724)
2025-12-22 19:45:34 INFO Epoch 031 | 75% complete (batch 543/724)
2025-12-22 19:45:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.635448
2025-12-22 19:45:52 INFO Tuning ranking metrics: regret=0.138021 spearman=0.096250 (groups=37, skipped=311)
2025-12-22 19:45:52 INFO Epoch 031 | train_mse=0.062033 | val_loss=0.082763 | best_val_loss=0.159711
2025-12-22 19:46:03 INFO Epoch 032 | 25% complete (batch 181/724)
2025-12-22 19:46:07 INFO Epoch 032 | 50% complete (batch 362/724)
2025-12-22 19:46:10 INFO Epoch 032 | 75% complete (batch 543/724)
2025-12-22 19:46:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.644491
2025-12-22 19:46:28 INFO Tuning ranking metrics: regret=0.104513 spearman=0.066626 (groups=37, skipped=311)
2025-12-22 19:46:28 INFO Epoch 032 | train_mse=0.059885 | val_loss=0.063692 | best_val_loss=0.159711
2025-12-22 19:46:39 INFO Epoch 033 | 25% complete (batch 181/724)
2025-12-22 19:46:42 INFO Epoch 033 | 50% complete (batch 362/724)
2025-12-22 19:46:45 INFO Epoch 033 | 75% complete (batch 543/724)
2025-12-22 19:46:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.654296
2025-12-22 19:47:04 INFO Tuning ranking metrics: regret=0.120390 spearman=0.056909 (groups=37, skipped=311)
2025-12-22 19:47:04 INFO Epoch 033 | train_mse=0.056083 | val_loss=0.059810 | best_val_loss=0.159711
2025-12-22 19:47:14 INFO Epoch 034 | 25% complete (batch 181/724)
2025-12-22 19:47:17 INFO Epoch 034 | 50% complete (batch 362/724)
2025-12-22 19:47:20 INFO Epoch 034 | 75% complete (batch 543/724)
2025-12-22 19:47:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.634077
2025-12-22 19:47:38 INFO Tuning ranking metrics: regret=0.127869 spearman=0.079449 (groups=37, skipped=311)
2025-12-22 19:47:38 INFO Epoch 034 | train_mse=0.058661 | val_loss=0.076755 | best_val_loss=0.159711
2025-12-22 19:47:49 INFO Epoch 035 | 25% complete (batch 181/724)
2025-12-22 19:47:52 INFO Epoch 035 | 50% complete (batch 362/724)
2025-12-22 19:47:55 INFO Epoch 035 | 75% complete (batch 543/724)
2025-12-22 19:48:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.662663
2025-12-22 19:48:15 INFO Tuning ranking metrics: regret=0.117047 spearman=0.119469 (groups=37, skipped=311)
2025-12-22 19:48:15 INFO Epoch 035 | train_mse=0.051671 | val_loss=0.059094 | best_val_loss=0.159711
2025-12-22 19:48:26 INFO Epoch 036 | 25% complete (batch 181/724)
2025-12-22 19:48:29 INFO Epoch 036 | 50% complete (batch 362/724)
2025-12-22 19:48:32 INFO Epoch 036 | 75% complete (batch 543/724)
2025-12-22 19:48:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.665517
2025-12-22 19:48:51 INFO Tuning ranking metrics: regret=0.122264 spearman=0.045700 (groups=37, skipped=311)
2025-12-22 19:48:51 INFO Epoch 036 | train_mse=0.066507 | val_loss=0.058336 | best_val_loss=0.159711
2025-12-22 19:49:01 INFO Epoch 037 | 25% complete (batch 181/724)
2025-12-22 19:49:05 INFO Epoch 037 | 50% complete (batch 362/724)
2025-12-22 19:49:08 INFO Epoch 037 | 75% complete (batch 543/724)
2025-12-22 19:49:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.659171
2025-12-22 19:49:27 INFO Tuning ranking metrics: regret=0.106706 spearman=0.068825 (groups=37, skipped=311)
2025-12-22 19:49:27 INFO Epoch 037 | train_mse=0.055213 | val_loss=0.063930 | best_val_loss=0.159711
2025-12-22 19:49:37 INFO Epoch 038 | 25% complete (batch 181/724)
2025-12-22 19:49:41 INFO Epoch 038 | 50% complete (batch 362/724)
2025-12-22 19:49:44 INFO Epoch 038 | 75% complete (batch 543/724)
2025-12-22 19:49:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.651579
2025-12-22 19:50:03 INFO Tuning ranking metrics: regret=0.093219 spearman=0.047795 (groups=37, skipped=311)
2025-12-22 19:50:03 INFO Epoch 038 | train_mse=0.060472 | val_loss=0.071115 | best_val_loss=0.159711
2025-12-22 19:50:14 INFO Epoch 039 | 25% complete (batch 181/724)
2025-12-22 19:50:18 INFO Epoch 039 | 50% complete (batch 362/724)
2025-12-22 19:50:21 INFO Epoch 039 | 75% complete (batch 543/724)
2025-12-22 19:50:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.652958
2025-12-22 19:50:40 INFO Tuning ranking metrics: regret=0.114589 spearman=0.057798 (groups=37, skipped=311)
2025-12-22 19:50:40 INFO Epoch 039 | train_mse=0.053969 | val_loss=0.069828 | best_val_loss=0.159711
2025-12-22 19:50:51 INFO Epoch 040 | 25% complete (batch 181/724)
2025-12-22 19:50:54 INFO Epoch 040 | 50% complete (batch 362/724)
2025-12-22 19:50:58 INFO Epoch 040 | 75% complete (batch 543/724)
2025-12-22 19:51:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.667385
2025-12-22 19:51:17 INFO Tuning ranking metrics: regret=0.075395 spearman=0.089879 (groups=37, skipped=311)
2025-12-22 19:51:17 INFO Epoch 040 | train_mse=0.060882 | val_loss=0.062253 | best_val_loss=0.159711
2025-12-22 19:51:28 INFO Epoch 041 | 25% complete (batch 181/724)
2025-12-22 19:51:31 INFO Epoch 041 | 50% complete (batch 362/724)
2025-12-22 19:51:35 INFO Epoch 041 | 75% complete (batch 543/724)
2025-12-22 19:51:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.662271
2025-12-22 19:51:54 INFO Tuning ranking metrics: regret=0.092071 spearman=0.054382 (groups=37, skipped=311)
2025-12-22 19:51:54 INFO Epoch 041 | train_mse=0.054149 | val_loss=0.055473 | best_val_loss=0.159711
2025-12-22 19:52:04 INFO Epoch 042 | 25% complete (batch 181/724)
2025-12-22 19:52:08 INFO Epoch 042 | 50% complete (batch 362/724)
2025-12-22 19:52:12 INFO Epoch 042 | 75% complete (batch 543/724)
2025-12-22 19:52:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.670531
2025-12-22 19:52:31 INFO Tuning ranking metrics: regret=0.093219 spearman=0.067304 (groups=37, skipped=311)
2025-12-22 19:52:31 INFO Epoch 042 | train_mse=0.053556 | val_loss=0.061276 | best_val_loss=0.159711
2025-12-22 19:52:41 INFO Epoch 043 | 25% complete (batch 181/724)
2025-12-22 19:52:45 INFO Epoch 043 | 50% complete (batch 362/724)
2025-12-22 19:52:49 INFO Epoch 043 | 75% complete (batch 543/724)
2025-12-22 19:53:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.659165
2025-12-22 19:53:08 INFO Tuning ranking metrics: regret=0.107338 spearman=0.074699 (groups=37, skipped=311)
2025-12-22 19:53:08 INFO Epoch 043 | train_mse=0.058049 | val_loss=0.071518 | best_val_loss=0.159711
2025-12-22 19:53:18 INFO Epoch 044 | 25% complete (batch 181/724)
2025-12-22 19:53:22 INFO Epoch 044 | 50% complete (batch 362/724)
2025-12-22 19:53:25 INFO Epoch 044 | 75% complete (batch 543/724)
2025-12-22 19:53:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.658481
2025-12-22 19:53:44 INFO Tuning ranking metrics: regret=0.086873 spearman=0.112221 (groups=37, skipped=311)
2025-12-22 19:53:44 INFO Epoch 044 | train_mse=0.061096 | val_loss=0.066956 | best_val_loss=0.159711
2025-12-22 19:53:55 INFO Epoch 045 | 25% complete (batch 181/724)
2025-12-22 19:53:58 INFO Epoch 045 | 50% complete (batch 362/724)
2025-12-22 19:54:02 INFO Epoch 045 | 75% complete (batch 543/724)
2025-12-22 19:54:15 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.657190
2025-12-22 19:54:21 INFO Tuning ranking metrics: regret=0.085402 spearman=0.108044 (groups=37, skipped=311)
2025-12-22 19:54:21 INFO Epoch 045 | train_mse=0.064694 | val_loss=0.056922 | best_val_loss=0.159711
2025-12-22 19:54:32 INFO Epoch 046 | 25% complete (batch 181/724)
2025-12-22 19:54:35 INFO Epoch 046 | 50% complete (batch 362/724)
2025-12-22 19:54:39 INFO Epoch 046 | 75% complete (batch 543/724)
2025-12-22 19:54:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.670837
2025-12-22 19:54:58 INFO Tuning ranking metrics: regret=0.093487 spearman=0.020691 (groups=37, skipped=311)
2025-12-22 19:54:58 INFO Epoch 046 | train_mse=0.056530 | val_loss=0.055768 | best_val_loss=0.159711
2025-12-22 19:55:09 INFO Epoch 047 | 25% complete (batch 181/724)
2025-12-22 19:55:13 INFO Epoch 047 | 50% complete (batch 362/724)
2025-12-22 19:55:16 INFO Epoch 047 | 75% complete (batch 543/724)
2025-12-22 19:55:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.685471
2025-12-22 19:55:35 INFO Tuning ranking metrics: regret=0.086067 spearman=0.105078 (groups=37, skipped=311)
2025-12-22 19:55:35 INFO Epoch 047 | train_mse=0.048710 | val_loss=0.054143 | best_val_loss=0.159711
2025-12-22 19:55:46 INFO Epoch 048 | 25% complete (batch 181/724)
2025-12-22 19:55:50 INFO Epoch 048 | 50% complete (batch 362/724)
2025-12-22 19:55:53 INFO Epoch 048 | 75% complete (batch 543/724)
2025-12-22 19:56:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.683300
2025-12-22 19:56:13 INFO Tuning ranking metrics: regret=0.085882 spearman=0.008506 (groups=37, skipped=311)
2025-12-22 19:56:13 INFO Epoch 048 | train_mse=0.054316 | val_loss=0.052907 | best_val_loss=0.159711
2025-12-22 19:56:23 INFO Epoch 049 | 25% complete (batch 181/724)
2025-12-22 19:56:27 INFO Epoch 049 | 50% complete (batch 362/724)
2025-12-22 19:56:30 INFO Epoch 049 | 75% complete (batch 543/724)
2025-12-22 19:56:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.679438
2025-12-22 19:56:49 INFO Tuning ranking metrics: regret=0.070841 spearman=0.080262 (groups=37, skipped=311)
2025-12-22 19:56:49 INFO Epoch 049 | train_mse=0.041741 | val_loss=0.069020 | best_val_loss=0.159711
2025-12-22 19:57:00 INFO Epoch 050 | 25% complete (batch 181/724)
2025-12-22 19:57:04 INFO Epoch 050 | 50% complete (batch 362/724)
2025-12-22 19:57:07 INFO Epoch 050 | 75% complete (batch 543/724)
2025-12-22 19:57:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.679555
2025-12-22 19:57:27 INFO Tuning ranking metrics: regret=0.066139 spearman=0.162987 (groups=37, skipped=311)
2025-12-22 19:57:27 INFO Epoch 050 | train_mse=0.053783 | val_loss=0.063842 | best_val_loss=0.159711
Metric tuning_rank_spearman improved by 0.003 >= min_delta = 0.0. New best score: 0.163
2025-12-22 19:57:37 INFO Epoch 051 | 25% complete (batch 181/724)
2025-12-22 19:57:41 INFO Epoch 051 | 50% complete (batch 362/724)
2025-12-22 19:57:44 INFO Epoch 051 | 75% complete (batch 543/724)
2025-12-22 19:57:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.666137
2025-12-22 19:58:03 INFO Tuning ranking metrics: regret=0.071652 spearman=0.043746 (groups=37, skipped=311)
2025-12-22 19:58:03 INFO Epoch 051 | train_mse=0.058003 | val_loss=0.060778 | best_val_loss=0.162987
2025-12-22 19:58:14 INFO Epoch 052 | 25% complete (batch 181/724)
2025-12-22 19:58:18 INFO Epoch 052 | 50% complete (batch 362/724)
2025-12-22 19:58:21 INFO Epoch 052 | 75% complete (batch 543/724)
2025-12-22 19:58:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.667019
2025-12-22 19:58:40 INFO Tuning ranking metrics: regret=0.071355 spearman=0.087066 (groups=37, skipped=311)
2025-12-22 19:58:40 INFO Epoch 052 | train_mse=0.056295 | val_loss=0.076039 | best_val_loss=0.162987
2025-12-22 19:58:51 INFO Epoch 053 | 25% complete (batch 181/724)
2025-12-22 19:58:55 INFO Epoch 053 | 50% complete (batch 362/724)
2025-12-22 19:58:58 INFO Epoch 053 | 75% complete (batch 543/724)
2025-12-22 19:59:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.672702
2025-12-22 19:59:17 INFO Tuning ranking metrics: regret=0.070490 spearman=0.076582 (groups=37, skipped=311)
2025-12-22 19:59:17 INFO Epoch 053 | train_mse=0.054377 | val_loss=0.066779 | best_val_loss=0.162987
2025-12-22 19:59:28 INFO Epoch 054 | 25% complete (batch 181/724)
2025-12-22 19:59:32 INFO Epoch 054 | 50% complete (batch 362/724)
2025-12-22 19:59:35 INFO Epoch 054 | 75% complete (batch 543/724)
2025-12-22 19:59:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.661917
2025-12-22 19:59:54 INFO Tuning ranking metrics: regret=0.100238 spearman=0.108611 (groups=37, skipped=311)
2025-12-22 19:59:54 INFO Epoch 054 | train_mse=0.059650 | val_loss=0.054672 | best_val_loss=0.162987
2025-12-22 20:00:05 INFO Epoch 055 | 25% complete (batch 181/724)
2025-12-22 20:00:09 INFO Epoch 055 | 50% complete (batch 362/724)
2025-12-22 20:00:13 INFO Epoch 055 | 75% complete (batch 543/724)
2025-12-22 20:00:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.659026
2025-12-22 20:00:32 INFO Tuning ranking metrics: regret=0.101293 spearman=0.112063 (groups=37, skipped=311)
2025-12-22 20:00:32 INFO Epoch 055 | train_mse=0.052057 | val_loss=0.083376 | best_val_loss=0.162987
2025-12-22 20:00:43 INFO Epoch 056 | 25% complete (batch 181/724)
2025-12-22 20:00:46 INFO Epoch 056 | 50% complete (batch 362/724)
2025-12-22 20:00:50 INFO Epoch 056 | 75% complete (batch 543/724)
2025-12-22 20:01:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.652714
2025-12-22 20:01:09 INFO Tuning ranking metrics: regret=0.070841 spearman=0.104329 (groups=37, skipped=311)
2025-12-22 20:01:09 INFO Epoch 056 | train_mse=0.055586 | val_loss=0.058278 | best_val_loss=0.162987
2025-12-22 20:01:20 INFO Epoch 057 | 25% complete (batch 181/724)
2025-12-22 20:01:23 INFO Epoch 057 | 50% complete (batch 362/724)
2025-12-22 20:01:27 INFO Epoch 057 | 75% complete (batch 543/724)
2025-12-22 20:01:40 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.691149
2025-12-22 20:01:46 INFO Tuning ranking metrics: regret=0.079313 spearman=0.143682 (groups=37, skipped=311)
2025-12-22 20:01:46 INFO Epoch 057 | train_mse=0.065610 | val_loss=0.055444 | best_val_loss=0.162987
2025-12-22 20:01:56 INFO Epoch 058 | 25% complete (batch 181/724)
2025-12-22 20:02:00 INFO Epoch 058 | 50% complete (batch 362/724)
2025-12-22 20:02:04 INFO Epoch 058 | 75% complete (batch 543/724)
2025-12-22 20:02:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.685480
2025-12-22 20:02:23 INFO Tuning ranking metrics: regret=0.086755 spearman=0.126676 (groups=37, skipped=311)
2025-12-22 20:02:23 INFO Epoch 058 | train_mse=0.054144 | val_loss=0.068043 | best_val_loss=0.162987
2025-12-22 20:02:34 INFO Epoch 059 | 25% complete (batch 181/724)
2025-12-22 20:02:37 INFO Epoch 059 | 50% complete (batch 362/724)
2025-12-22 20:02:40 INFO Epoch 059 | 75% complete (batch 543/724)
2025-12-22 20:02:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.703146
2025-12-22 20:02:59 INFO Tuning ranking metrics: regret=0.069830 spearman=0.127255 (groups=37, skipped=311)
2025-12-22 20:02:59 INFO Epoch 059 | train_mse=0.060573 | val_loss=0.049710 | best_val_loss=0.162987
2025-12-22 20:03:10 INFO Epoch 060 | 25% complete (batch 181/724)
2025-12-22 20:03:14 INFO Epoch 060 | 50% complete (batch 362/724)
2025-12-22 20:03:17 INFO Epoch 060 | 75% complete (batch 543/724)
2025-12-22 20:03:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.705118
2025-12-22 20:03:36 INFO Tuning ranking metrics: regret=0.069316 spearman=0.128671 (groups=37, skipped=311)
2025-12-22 20:03:36 INFO Epoch 060 | train_mse=0.054696 | val_loss=0.054711 | best_val_loss=0.162987
2025-12-22 20:03:47 INFO Epoch 061 | 25% complete (batch 181/724)
2025-12-22 20:03:50 INFO Epoch 061 | 50% complete (batch 362/724)
2025-12-22 20:03:54 INFO Epoch 061 | 75% complete (batch 543/724)
2025-12-22 20:04:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.708350
2025-12-22 20:04:13 INFO Tuning ranking metrics: regret=0.100765 spearman=0.113554 (groups=37, skipped=311)
2025-12-22 20:04:13 INFO Epoch 061 | train_mse=0.047718 | val_loss=0.051760 | best_val_loss=0.162987
2025-12-22 20:04:24 INFO Epoch 062 | 25% complete (batch 181/724)
2025-12-22 20:04:27 INFO Epoch 062 | 50% complete (batch 362/724)
2025-12-22 20:04:31 INFO Epoch 062 | 75% complete (batch 543/724)
2025-12-22 20:04:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.694619
2025-12-22 20:04:50 INFO Tuning ranking metrics: regret=0.065964 spearman=0.152077 (groups=37, skipped=311)
2025-12-22 20:04:50 INFO Epoch 062 | train_mse=0.057056 | val_loss=0.051419 | best_val_loss=0.162987
2025-12-22 20:05:00 INFO Epoch 063 | 25% complete (batch 181/724)
2025-12-22 20:05:04 INFO Epoch 063 | 50% complete (batch 362/724)
2025-12-22 20:05:07 INFO Epoch 063 | 75% complete (batch 543/724)
2025-12-22 20:05:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.710494
2025-12-22 20:05:26 INFO Tuning ranking metrics: regret=0.067489 spearman=0.120680 (groups=37, skipped=311)
2025-12-22 20:05:26 INFO Epoch 063 | train_mse=0.052571 | val_loss=0.055320 | best_val_loss=0.162987
2025-12-22 20:05:37 INFO Epoch 064 | 25% complete (batch 181/724)
2025-12-22 20:05:41 INFO Epoch 064 | 50% complete (batch 362/724)
2025-12-22 20:05:44 INFO Epoch 064 | 75% complete (batch 543/724)
2025-12-22 20:05:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.686287
2025-12-22 20:06:03 INFO Tuning ranking metrics: regret=0.081124 spearman=0.136802 (groups=37, skipped=311)
2025-12-22 20:06:03 INFO Epoch 064 | train_mse=0.048891 | val_loss=0.078953 | best_val_loss=0.162987
2025-12-22 20:06:14 INFO Epoch 065 | 25% complete (batch 181/724)
2025-12-22 20:06:17 INFO Epoch 065 | 50% complete (batch 362/724)
2025-12-22 20:06:21 INFO Epoch 065 | 75% complete (batch 543/724)
2025-12-22 20:06:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.708024
2025-12-22 20:06:40 INFO Tuning ranking metrics: regret=0.079609 spearman=0.121815 (groups=37, skipped=311)
2025-12-22 20:06:40 INFO Epoch 065 | train_mse=0.048448 | val_loss=0.050442 | best_val_loss=0.162987
2025-12-22 20:06:50 INFO Epoch 066 | 25% complete (batch 181/724)
2025-12-22 20:06:54 INFO Epoch 066 | 50% complete (batch 362/724)
2025-12-22 20:06:57 INFO Epoch 066 | 75% complete (batch 543/724)
2025-12-22 20:07:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.690637
2025-12-22 20:07:16 INFO Tuning ranking metrics: regret=0.091357 spearman=0.193132 (groups=37, skipped=311)
2025-12-22 20:07:16 INFO Epoch 066 | train_mse=0.049959 | val_loss=0.071000 | best_val_loss=0.162987
Metric tuning_rank_spearman improved by 0.030 >= min_delta = 0.0. New best score: 0.193
2025-12-22 20:07:27 INFO Epoch 067 | 25% complete (batch 181/724)
2025-12-22 20:07:31 INFO Epoch 067 | 50% complete (batch 362/724)
2025-12-22 20:07:34 INFO Epoch 067 | 75% complete (batch 543/724)
2025-12-22 20:07:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.687926
2025-12-22 20:07:53 INFO Tuning ranking metrics: regret=0.086366 spearman=0.154230 (groups=37, skipped=311)
2025-12-22 20:07:53 INFO Epoch 067 | train_mse=0.049930 | val_loss=0.058204 | best_val_loss=0.193132
2025-12-22 20:08:04 INFO Epoch 068 | 25% complete (batch 181/724)
2025-12-22 20:08:07 INFO Epoch 068 | 50% complete (batch 362/724)
2025-12-22 20:08:10 INFO Epoch 068 | 75% complete (batch 543/724)
2025-12-22 20:08:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.700897
2025-12-22 20:08:29 INFO Tuning ranking metrics: regret=0.086376 spearman=0.132286 (groups=37, skipped=311)
2025-12-22 20:08:29 INFO Epoch 068 | train_mse=0.058923 | val_loss=0.054085 | best_val_loss=0.193132
2025-12-22 20:08:40 INFO Epoch 069 | 25% complete (batch 181/724)
2025-12-22 20:08:44 INFO Epoch 069 | 50% complete (batch 362/724)
2025-12-22 20:08:47 INFO Epoch 069 | 75% complete (batch 543/724)
2025-12-22 20:09:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.701011
2025-12-22 20:09:06 INFO Tuning ranking metrics: regret=0.080123 spearman=0.151123 (groups=37, skipped=311)
2025-12-22 20:09:06 INFO Epoch 069 | train_mse=0.049871 | val_loss=0.052024 | best_val_loss=0.193132
2025-12-22 20:09:17 INFO Epoch 070 | 25% complete (batch 181/724)
2025-12-22 20:09:20 INFO Epoch 070 | 50% complete (batch 362/724)
2025-12-22 20:09:24 INFO Epoch 070 | 75% complete (batch 543/724)
2025-12-22 20:09:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.701033
2025-12-22 20:09:43 INFO Tuning ranking metrics: regret=0.095563 spearman=0.160805 (groups=37, skipped=311)
2025-12-22 20:09:43 INFO Epoch 070 | train_mse=0.043995 | val_loss=0.047872 | best_val_loss=0.193132
2025-12-22 20:09:54 INFO Epoch 071 | 25% complete (batch 181/724)
2025-12-22 20:09:57 INFO Epoch 071 | 50% complete (batch 362/724)
2025-12-22 20:10:01 INFO Epoch 071 | 75% complete (batch 543/724)
2025-12-22 20:10:15 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.705867
2025-12-22 20:10:20 INFO Tuning ranking metrics: regret=0.071334 spearman=0.157049 (groups=37, skipped=311)
2025-12-22 20:10:20 INFO Epoch 071 | train_mse=0.049275 | val_loss=0.054425 | best_val_loss=0.193132
2025-12-22 20:10:31 INFO Epoch 072 | 25% complete (batch 181/724)
2025-12-22 20:10:34 INFO Epoch 072 | 50% complete (batch 362/724)
2025-12-22 20:10:38 INFO Epoch 072 | 75% complete (batch 543/724)
2025-12-22 20:10:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.708787
2025-12-22 20:10:57 INFO Tuning ranking metrics: regret=0.080113 spearman=0.169908 (groups=37, skipped=311)
2025-12-22 20:10:57 INFO Epoch 072 | train_mse=0.042131 | val_loss=0.049597 | best_val_loss=0.193132
2025-12-22 20:11:07 INFO Epoch 073 | 25% complete (batch 181/724)
2025-12-22 20:11:11 INFO Epoch 073 | 50% complete (batch 362/724)
2025-12-22 20:11:14 INFO Epoch 073 | 75% complete (batch 543/724)
2025-12-22 20:11:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.709335
2025-12-22 20:11:33 INFO Tuning ranking metrics: regret=0.085365 spearman=0.146619 (groups=37, skipped=311)
2025-12-22 20:11:33 INFO Epoch 073 | train_mse=0.040626 | val_loss=0.051480 | best_val_loss=0.193132
2025-12-22 20:11:44 INFO Epoch 074 | 25% complete (batch 181/724)
2025-12-22 20:11:47 INFO Epoch 074 | 50% complete (batch 362/724)
2025-12-22 20:11:51 INFO Epoch 074 | 75% complete (batch 543/724)
2025-12-22 20:12:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.704457
2025-12-22 20:12:10 INFO Tuning ranking metrics: regret=0.085072 spearman=0.116591 (groups=37, skipped=311)
2025-12-22 20:12:10 INFO Epoch 074 | train_mse=0.045446 | val_loss=0.048217 | best_val_loss=0.193132
2025-12-22 20:12:21 INFO Epoch 075 | 25% complete (batch 181/724)
2025-12-22 20:12:24 INFO Epoch 075 | 50% complete (batch 362/724)
2025-12-22 20:12:28 INFO Epoch 075 | 75% complete (batch 543/724)
2025-12-22 20:12:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.687913
2025-12-22 20:12:47 INFO Tuning ranking metrics: regret=0.127650 spearman=0.036949 (groups=37, skipped=311)
2025-12-22 20:12:47 INFO Epoch 075 | train_mse=0.041835 | val_loss=0.073100 | best_val_loss=0.193132
2025-12-22 20:12:58 INFO Epoch 076 | 25% complete (batch 181/724)
2025-12-22 20:13:01 INFO Epoch 076 | 50% complete (batch 362/724)
2025-12-22 20:13:04 INFO Epoch 076 | 75% complete (batch 543/724)
2025-12-22 20:13:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.678976
2025-12-22 20:13:23 INFO Tuning ranking metrics: regret=0.083454 spearman=0.176828 (groups=37, skipped=311)
2025-12-22 20:13:23 INFO Epoch 076 | train_mse=0.046125 | val_loss=0.052400 | best_val_loss=0.193132
2025-12-22 20:13:34 INFO Epoch 077 | 25% complete (batch 181/724)
2025-12-22 20:13:38 INFO Epoch 077 | 50% complete (batch 362/724)
2025-12-22 20:13:41 INFO Epoch 077 | 75% complete (batch 543/724)
2025-12-22 20:13:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.712340
2025-12-22 20:14:01 INFO Tuning ranking metrics: regret=0.095563 spearman=0.156997 (groups=37, skipped=311)
2025-12-22 20:14:01 INFO Epoch 077 | train_mse=0.058851 | val_loss=0.054508 | best_val_loss=0.193132
2025-12-22 20:14:11 INFO Epoch 078 | 25% complete (batch 181/724)
2025-12-22 20:14:15 INFO Epoch 078 | 50% complete (batch 362/724)
2025-12-22 20:14:18 INFO Epoch 078 | 75% complete (batch 543/724)
2025-12-22 20:14:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.715373
2025-12-22 20:14:37 INFO Tuning ranking metrics: regret=0.068543 spearman=0.108254 (groups=37, skipped=311)
2025-12-22 20:14:37 INFO Epoch 078 | train_mse=0.043054 | val_loss=0.050833 | best_val_loss=0.193132
2025-12-22 20:14:48 INFO Epoch 079 | 25% complete (batch 181/724)
2025-12-22 20:14:51 INFO Epoch 079 | 50% complete (batch 362/724)
2025-12-22 20:14:55 INFO Epoch 079 | 75% complete (batch 543/724)
2025-12-22 20:15:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.707485
2025-12-22 20:15:14 INFO Tuning ranking metrics: regret=0.082188 spearman=0.071598 (groups=37, skipped=311)
2025-12-22 20:15:14 INFO Epoch 079 | train_mse=0.044243 | val_loss=0.062561 | best_val_loss=0.193132
2025-12-22 20:15:25 INFO Epoch 080 | 25% complete (batch 181/724)
2025-12-22 20:15:28 INFO Epoch 080 | 50% complete (batch 362/724)
2025-12-22 20:15:32 INFO Epoch 080 | 75% complete (batch 543/724)
2025-12-22 20:15:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.688511
2025-12-22 20:15:50 INFO Tuning ranking metrics: regret=0.090749 spearman=0.223903 (groups=37, skipped=311)
2025-12-22 20:15:50 INFO Epoch 080 | train_mse=0.044191 | val_loss=0.075344 | best_val_loss=0.193132
Metric tuning_rank_spearman improved by 0.031 >= min_delta = 0.0. New best score: 0.224
2025-12-22 20:16:01 INFO Epoch 081 | 25% complete (batch 181/724)
2025-12-22 20:16:05 INFO Epoch 081 | 50% complete (batch 362/724)
2025-12-22 20:16:08 INFO Epoch 081 | 75% complete (batch 543/724)
2025-12-22 20:16:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.677727
2025-12-22 20:16:27 INFO Tuning ranking metrics: regret=0.078238 spearman=0.222154 (groups=37, skipped=311)
2025-12-22 20:16:27 INFO Epoch 081 | train_mse=0.048165 | val_loss=0.058213 | best_val_loss=0.223903
2025-12-22 20:16:38 INFO Epoch 082 | 25% complete (batch 181/724)
2025-12-22 20:16:41 INFO Epoch 082 | 50% complete (batch 362/724)
2025-12-22 20:16:45 INFO Epoch 082 | 75% complete (batch 543/724)
2025-12-22 20:16:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.698835
2025-12-22 20:17:04 INFO Tuning ranking metrics: regret=0.072388 spearman=0.125500 (groups=37, skipped=311)
2025-12-22 20:17:04 INFO Epoch 082 | train_mse=0.051527 | val_loss=0.054259 | best_val_loss=0.223903
2025-12-22 20:17:14 INFO Epoch 083 | 25% complete (batch 181/724)
2025-12-22 20:17:18 INFO Epoch 083 | 50% complete (batch 362/724)
2025-12-22 20:17:21 INFO Epoch 083 | 75% complete (batch 543/724)
2025-12-22 20:17:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.722378
2025-12-22 20:17:40 INFO Tuning ranking metrics: regret=0.099916 spearman=0.123201 (groups=37, skipped=311)
2025-12-22 20:17:40 INFO Epoch 083 | train_mse=0.048795 | val_loss=0.049441 | best_val_loss=0.223903
2025-12-22 20:17:51 INFO Epoch 084 | 25% complete (batch 181/724)
2025-12-22 20:17:55 INFO Epoch 084 | 50% complete (batch 362/724)
2025-12-22 20:17:59 INFO Epoch 084 | 75% complete (batch 543/724)
2025-12-22 20:18:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.713606
2025-12-22 20:18:17 INFO Tuning ranking metrics: regret=0.081393 spearman=0.173570 (groups=37, skipped=311)
2025-12-22 20:18:17 INFO Epoch 084 | train_mse=0.042684 | val_loss=0.059783 | best_val_loss=0.223903
2025-12-22 20:18:28 INFO Epoch 085 | 25% complete (batch 181/724)
2025-12-22 20:18:32 INFO Epoch 085 | 50% complete (batch 362/724)
2025-12-22 20:18:35 INFO Epoch 085 | 75% complete (batch 543/724)
2025-12-22 20:18:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.705053
2025-12-22 20:18:54 INFO Tuning ranking metrics: regret=0.071334 spearman=0.152375 (groups=37, skipped=311)
2025-12-22 20:18:54 INFO Epoch 085 | train_mse=0.048010 | val_loss=0.062690 | best_val_loss=0.223903
2025-12-22 20:19:05 INFO Epoch 086 | 25% complete (batch 181/724)
2025-12-22 20:19:09 INFO Epoch 086 | 50% complete (batch 362/724)
2025-12-22 20:19:12 INFO Epoch 086 | 75% complete (batch 543/724)
2025-12-22 20:19:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.687817
2025-12-22 20:19:31 INFO Tuning ranking metrics: regret=0.077284 spearman=0.235697 (groups=37, skipped=311)
2025-12-22 20:19:31 INFO Epoch 086 | train_mse=0.040228 | val_loss=0.075306 | best_val_loss=0.223903
Metric tuning_rank_spearman improved by 0.012 >= min_delta = 0.0. New best score: 0.236
2025-12-22 20:19:42 INFO Epoch 087 | 25% complete (batch 181/724)
2025-12-22 20:19:46 INFO Epoch 087 | 50% complete (batch 362/724)
2025-12-22 20:19:49 INFO Epoch 087 | 75% complete (batch 543/724)
2025-12-22 20:20:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.679519
2025-12-22 20:20:08 INFO Tuning ranking metrics: regret=0.080552 spearman=0.148736 (groups=37, skipped=311)
2025-12-22 20:20:08 INFO Epoch 087 | train_mse=0.045317 | val_loss=0.051788 | best_val_loss=0.235697
2025-12-22 20:20:19 INFO Epoch 088 | 25% complete (batch 181/724)
2025-12-22 20:20:22 INFO Epoch 088 | 50% complete (batch 362/724)
2025-12-22 20:20:26 INFO Epoch 088 | 75% complete (batch 543/724)
2025-12-22 20:20:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.709669
2025-12-22 20:20:45 INFO Tuning ranking metrics: regret=0.070349 spearman=0.093623 (groups=37, skipped=311)
2025-12-22 20:20:45 INFO Epoch 088 | train_mse=0.047596 | val_loss=0.045034 | best_val_loss=0.235697
2025-12-22 20:20:56 INFO Epoch 089 | 25% complete (batch 181/724)
2025-12-22 20:20:59 INFO Epoch 089 | 50% complete (batch 362/724)
2025-12-22 20:21:03 INFO Epoch 089 | 75% complete (batch 543/724)
2025-12-22 20:21:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.728875
2025-12-22 20:21:22 INFO Tuning ranking metrics: regret=0.072731 spearman=0.153984 (groups=37, skipped=311)
2025-12-22 20:21:22 INFO Epoch 089 | train_mse=0.041598 | val_loss=0.052452 | best_val_loss=0.235697
2025-12-22 20:21:33 INFO Epoch 090 | 25% complete (batch 181/724)
2025-12-22 20:21:36 INFO Epoch 090 | 50% complete (batch 362/724)
2025-12-22 20:21:39 INFO Epoch 090 | 75% complete (batch 543/724)
2025-12-22 20:21:53 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.693722
2025-12-22 20:21:58 INFO Tuning ranking metrics: regret=0.077058 spearman=0.209044 (groups=37, skipped=311)
2025-12-22 20:21:58 INFO Epoch 090 | train_mse=0.044049 | val_loss=0.081005 | best_val_loss=0.235697
2025-12-22 20:22:09 INFO Epoch 091 | 25% complete (batch 181/724)
2025-12-22 20:22:12 INFO Epoch 091 | 50% complete (batch 362/724)
2025-12-22 20:22:16 INFO Epoch 091 | 75% complete (batch 543/724)
2025-12-22 20:22:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.677754
2025-12-22 20:22:34 INFO Tuning ranking metrics: regret=0.069295 spearman=0.180824 (groups=37, skipped=311)
2025-12-22 20:22:34 INFO Epoch 091 | train_mse=0.046652 | val_loss=0.053627 | best_val_loss=0.235697
2025-12-22 20:22:45 INFO Epoch 092 | 25% complete (batch 181/724)
2025-12-22 20:22:49 INFO Epoch 092 | 50% complete (batch 362/724)
2025-12-22 20:22:52 INFO Epoch 092 | 75% complete (batch 543/724)
2025-12-22 20:23:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.697775
2025-12-22 20:23:11 INFO Tuning ranking metrics: regret=0.066221 spearman=0.206575 (groups=37, skipped=311)
2025-12-22 20:23:11 INFO Epoch 092 | train_mse=0.059044 | val_loss=0.055757 | best_val_loss=0.235697
2025-12-22 20:23:23 INFO Epoch 093 | 25% complete (batch 181/724)
2025-12-22 20:23:26 INFO Epoch 093 | 50% complete (batch 362/724)
2025-12-22 20:23:30 INFO Epoch 093 | 75% complete (batch 543/724)
2025-12-22 20:23:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.700714
2025-12-22 20:23:49 INFO Tuning ranking metrics: regret=0.082413 spearman=0.149462 (groups=37, skipped=311)
2025-12-22 20:23:49 INFO Epoch 093 | train_mse=0.052987 | val_loss=0.060195 | best_val_loss=0.235697
2025-12-22 20:24:00 INFO Epoch 094 | 25% complete (batch 181/724)
2025-12-22 20:24:03 INFO Epoch 094 | 50% complete (batch 362/724)
2025-12-22 20:24:06 INFO Epoch 094 | 75% complete (batch 543/724)
2025-12-22 20:24:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.721155
2025-12-22 20:24:25 INFO Tuning ranking metrics: regret=0.069143 spearman=0.181871 (groups=37, skipped=311)
2025-12-22 20:24:25 INFO Epoch 094 | train_mse=0.050851 | val_loss=0.049532 | best_val_loss=0.235697
2025-12-22 20:24:36 INFO Epoch 095 | 25% complete (batch 181/724)
2025-12-22 20:24:40 INFO Epoch 095 | 50% complete (batch 362/724)
2025-12-22 20:24:43 INFO Epoch 095 | 75% complete (batch 543/724)
2025-12-22 20:24:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.711884
2025-12-22 20:25:02 INFO Tuning ranking metrics: regret=0.078112 spearman=0.151474 (groups=37, skipped=311)
2025-12-22 20:25:02 INFO Epoch 095 | train_mse=0.047284 | val_loss=0.056153 | best_val_loss=0.235697
2025-12-22 20:25:13 INFO Epoch 096 | 25% complete (batch 181/724)
2025-12-22 20:25:17 INFO Epoch 096 | 50% complete (batch 362/724)
2025-12-22 20:25:21 INFO Epoch 096 | 75% complete (batch 543/724)
2025-12-22 20:25:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.682888
2025-12-22 20:25:40 INFO Tuning ranking metrics: regret=0.070349 spearman=0.073611 (groups=37, skipped=311)
2025-12-22 20:25:40 INFO Epoch 096 | train_mse=0.043537 | val_loss=0.077686 | best_val_loss=0.235697
2025-12-22 20:25:50 INFO Epoch 097 | 25% complete (batch 181/724)
2025-12-22 20:25:54 INFO Epoch 097 | 50% complete (batch 362/724)
2025-12-22 20:25:58 INFO Epoch 097 | 75% complete (batch 543/724)
2025-12-22 20:26:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.716130
2025-12-22 20:26:17 INFO Tuning ranking metrics: regret=0.083792 spearman=0.166333 (groups=37, skipped=311)
2025-12-22 20:26:17 INFO Epoch 097 | train_mse=0.051280 | val_loss=0.049722 | best_val_loss=0.235697
2025-12-22 20:26:28 INFO Epoch 098 | 25% complete (batch 181/724)
2025-12-22 20:26:31 INFO Epoch 098 | 50% complete (batch 362/724)
2025-12-22 20:26:35 INFO Epoch 098 | 75% complete (batch 543/724)
2025-12-22 20:26:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.681638
2025-12-22 20:26:54 INFO Tuning ranking metrics: regret=0.078576 spearman=0.194097 (groups=37, skipped=311)
2025-12-22 20:26:54 INFO Epoch 098 | train_mse=0.051720 | val_loss=0.074773 | best_val_loss=0.235697
2025-12-22 20:27:04 INFO Epoch 099 | 25% complete (batch 181/724)
2025-12-22 20:27:08 INFO Epoch 099 | 50% complete (batch 362/724)
2025-12-22 20:27:12 INFO Epoch 099 | 75% complete (batch 543/724)
2025-12-22 20:27:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.654252
2025-12-22 20:27:31 INFO Tuning ranking metrics: regret=0.070820 spearman=0.112326 (groups=37, skipped=311)
2025-12-22 20:27:31 INFO Epoch 099 | train_mse=0.049433 | val_loss=0.057234 | best_val_loss=0.235697
2025-12-22 20:27:42 INFO Epoch 100 | 25% complete (batch 181/724)
2025-12-22 20:27:45 INFO Epoch 100 | 50% complete (batch 362/724)
2025-12-22 20:27:49 INFO Epoch 100 | 75% complete (batch 543/724)
2025-12-22 20:28:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.708420
2025-12-22 20:28:08 INFO Tuning ranking metrics: regret=0.083994 spearman=0.088856 (groups=37, skipped=311)
2025-12-22 20:28:08 INFO Epoch 100 | train_mse=0.054675 | val_loss=0.053656 | best_val_loss=0.235697
2025-12-22 20:28:19 INFO Epoch 101 | 25% complete (batch 181/724)
2025-12-22 20:28:22 INFO Epoch 101 | 50% complete (batch 362/724)
2025-12-22 20:28:25 INFO Epoch 101 | 75% complete (batch 543/724)
2025-12-22 20:28:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.721457
2025-12-22 20:28:45 INFO Tuning ranking metrics: regret=0.096516 spearman=0.123827 (groups=37, skipped=311)
2025-12-22 20:28:45 INFO Epoch 101 | train_mse=0.048684 | val_loss=0.048728 | best_val_loss=0.235697
2025-12-22 20:28:56 INFO Epoch 102 | 25% complete (batch 181/724)
2025-12-22 20:28:59 INFO Epoch 102 | 50% complete (batch 362/724)
2025-12-22 20:29:03 INFO Epoch 102 | 75% complete (batch 543/724)
2025-12-22 20:29:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.689767
2025-12-22 20:29:21 INFO Tuning ranking metrics: regret=0.071875 spearman=0.070996 (groups=37, skipped=311)
2025-12-22 20:29:21 INFO Epoch 102 | train_mse=0.055006 | val_loss=0.076664 | best_val_loss=0.235697
2025-12-22 20:29:33 INFO Epoch 103 | 25% complete (batch 181/724)
2025-12-22 20:29:36 INFO Epoch 103 | 50% complete (batch 362/724)
2025-12-22 20:29:40 INFO Epoch 103 | 75% complete (batch 543/724)
2025-12-22 20:29:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.717111
2025-12-22 20:29:59 INFO Tuning ranking metrics: regret=0.096396 spearman=0.157687 (groups=37, skipped=311)
2025-12-22 20:29:59 INFO Epoch 103 | train_mse=0.042917 | val_loss=0.051307 | best_val_loss=0.235697
2025-12-22 20:30:10 INFO Epoch 104 | 25% complete (batch 181/724)
2025-12-22 20:30:14 INFO Epoch 104 | 50% complete (batch 362/724)
2025-12-22 20:30:17 INFO Epoch 104 | 75% complete (batch 543/724)
2025-12-22 20:30:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.719907
2025-12-22 20:30:36 INFO Tuning ranking metrics: regret=0.080460 spearman=0.181654 (groups=37, skipped=311)
2025-12-22 20:30:36 INFO Epoch 104 | train_mse=0.052587 | val_loss=0.048630 | best_val_loss=0.235697
2025-12-22 20:30:47 INFO Epoch 105 | 25% complete (batch 181/724)
2025-12-22 20:30:51 INFO Epoch 105 | 50% complete (batch 362/724)
2025-12-22 20:30:54 INFO Epoch 105 | 75% complete (batch 543/724)
2025-12-22 20:31:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.714586
2025-12-22 20:31:13 INFO Tuning ranking metrics: regret=0.077174 spearman=0.134854 (groups=37, skipped=311)
2025-12-22 20:31:13 INFO Epoch 105 | train_mse=0.041013 | val_loss=0.053845 | best_val_loss=0.235697
2025-12-22 20:31:24 INFO Epoch 106 | 25% complete (batch 181/724)
2025-12-22 20:31:27 INFO Epoch 106 | 50% complete (batch 362/724)
2025-12-22 20:31:31 INFO Epoch 106 | 75% complete (batch 543/724)
2025-12-22 20:31:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.711078
2025-12-22 20:31:50 INFO Tuning ranking metrics: regret=0.063901 spearman=0.257623 (groups=37, skipped=311)
2025-12-22 20:31:50 INFO Epoch 106 | train_mse=0.042240 | val_loss=0.049442 | best_val_loss=0.235697
Metric tuning_rank_spearman improved by 0.022 >= min_delta = 0.0. New best score: 0.258
2025-12-22 20:32:00 INFO Epoch 107 | 25% complete (batch 181/724)
2025-12-22 20:32:04 INFO Epoch 107 | 50% complete (batch 362/724)
2025-12-22 20:32:07 INFO Epoch 107 | 75% complete (batch 543/724)
2025-12-22 20:32:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.706713
2025-12-22 20:32:26 INFO Tuning ranking metrics: regret=0.066254 spearman=0.188136 (groups=37, skipped=311)
2025-12-22 20:32:26 INFO Epoch 107 | train_mse=0.046930 | val_loss=0.051570 | best_val_loss=0.257623
2025-12-22 20:32:37 INFO Epoch 108 | 25% complete (batch 181/724)
2025-12-22 20:32:40 INFO Epoch 108 | 50% complete (batch 362/724)
2025-12-22 20:32:44 INFO Epoch 108 | 75% complete (batch 543/724)
2025-12-22 20:32:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.713681
2025-12-22 20:33:04 INFO Tuning ranking metrics: regret=0.070016 spearman=0.080087 (groups=37, skipped=311)
2025-12-22 20:33:04 INFO Epoch 108 | train_mse=0.048741 | val_loss=0.047673 | best_val_loss=0.257623
2025-12-22 20:33:15 INFO Epoch 109 | 25% complete (batch 181/724)
2025-12-22 20:33:18 INFO Epoch 109 | 50% complete (batch 362/724)
2025-12-22 20:33:22 INFO Epoch 109 | 75% complete (batch 543/724)
2025-12-22 20:33:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.714425
2025-12-22 20:33:41 INFO Tuning ranking metrics: regret=0.069351 spearman=0.133661 (groups=37, skipped=311)
2025-12-22 20:33:41 INFO Epoch 109 | train_mse=0.046123 | val_loss=0.052321 | best_val_loss=0.257623
2025-12-22 20:33:51 INFO Epoch 110 | 25% complete (batch 181/724)
2025-12-22 20:33:55 INFO Epoch 110 | 50% complete (batch 362/724)
2025-12-22 20:33:59 INFO Epoch 110 | 75% complete (batch 543/724)
2025-12-22 20:34:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.715992
2025-12-22 20:34:18 INFO Tuning ranking metrics: regret=0.068963 spearman=0.192126 (groups=37, skipped=311)
2025-12-22 20:34:18 INFO Epoch 110 | train_mse=0.044036 | val_loss=0.048357 | best_val_loss=0.257623
2025-12-22 20:34:29 INFO Epoch 111 | 25% complete (batch 181/724)
2025-12-22 20:34:32 INFO Epoch 111 | 50% complete (batch 362/724)
2025-12-22 20:34:35 INFO Epoch 111 | 75% complete (batch 543/724)
2025-12-22 20:34:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.716489
2025-12-22 20:34:54 INFO Tuning ranking metrics: regret=0.067309 spearman=0.154083 (groups=37, skipped=311)
2025-12-22 20:34:54 INFO Epoch 111 | train_mse=0.042787 | val_loss=0.052095 | best_val_loss=0.257623
2025-12-22 20:35:05 INFO Epoch 112 | 25% complete (batch 181/724)
2025-12-22 20:35:08 INFO Epoch 112 | 50% complete (batch 362/724)
2025-12-22 20:35:12 INFO Epoch 112 | 75% complete (batch 543/724)
2025-12-22 20:35:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.726076
2025-12-22 20:35:30 INFO Tuning ranking metrics: regret=0.065092 spearman=0.216117 (groups=37, skipped=311)
2025-12-22 20:35:30 INFO Epoch 112 | train_mse=0.047053 | val_loss=0.049158 | best_val_loss=0.257623
2025-12-22 20:35:41 INFO Epoch 113 | 25% complete (batch 181/724)
2025-12-22 20:35:45 INFO Epoch 113 | 50% complete (batch 362/724)
2025-12-22 20:35:49 INFO Epoch 113 | 75% complete (batch 543/724)
2025-12-22 20:36:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.722762
2025-12-22 20:36:08 INFO Tuning ranking metrics: regret=0.063977 spearman=0.176682 (groups=37, skipped=311)
2025-12-22 20:36:08 INFO Epoch 113 | train_mse=0.041876 | val_loss=0.048800 | best_val_loss=0.257623
2025-12-22 20:36:19 INFO Epoch 114 | 25% complete (batch 181/724)
2025-12-22 20:36:22 INFO Epoch 114 | 50% complete (batch 362/724)
2025-12-22 20:36:26 INFO Epoch 114 | 75% complete (batch 543/724)
2025-12-22 20:36:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.722314
2025-12-22 20:36:45 INFO Tuning ranking metrics: regret=0.082748 spearman=0.179525 (groups=37, skipped=311)
2025-12-22 20:36:45 INFO Epoch 114 | train_mse=0.043134 | val_loss=0.050723 | best_val_loss=0.257623
2025-12-22 20:36:55 INFO Epoch 115 | 25% complete (batch 181/724)
2025-12-22 20:36:59 INFO Epoch 115 | 50% complete (batch 362/724)
2025-12-22 20:37:02 INFO Epoch 115 | 75% complete (batch 543/724)
2025-12-22 20:37:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.721233
2025-12-22 20:37:22 INFO Tuning ranking metrics: regret=0.064464 spearman=0.204288 (groups=37, skipped=311)
2025-12-22 20:37:22 INFO Epoch 115 | train_mse=0.034473 | val_loss=0.050111 | best_val_loss=0.257623
2025-12-22 20:37:32 INFO Epoch 116 | 25% complete (batch 181/724)
2025-12-22 20:37:36 INFO Epoch 116 | 50% complete (batch 362/724)
2025-12-22 20:37:40 INFO Epoch 116 | 75% complete (batch 543/724)
2025-12-22 20:37:53 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.721048
2025-12-22 20:37:59 INFO Tuning ranking metrics: regret=0.066470 spearman=0.157277 (groups=37, skipped=311)
2025-12-22 20:37:59 INFO Epoch 116 | train_mse=0.042175 | val_loss=0.048824 | best_val_loss=0.257623
2025-12-22 20:38:09 INFO Epoch 117 | 25% complete (batch 181/724)
2025-12-22 20:38:13 INFO Epoch 117 | 50% complete (batch 362/724)
2025-12-22 20:38:16 INFO Epoch 117 | 75% complete (batch 543/724)
2025-12-22 20:38:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.716817
2025-12-22 20:38:35 INFO Tuning ranking metrics: regret=0.064248 spearman=0.208208 (groups=37, skipped=311)
2025-12-22 20:38:35 INFO Epoch 117 | train_mse=0.039566 | val_loss=0.050400 | best_val_loss=0.257623
2025-12-22 20:38:46 INFO Epoch 118 | 25% complete (batch 181/724)
2025-12-22 20:38:50 INFO Epoch 118 | 50% complete (batch 362/724)
2025-12-22 20:38:53 INFO Epoch 118 | 75% complete (batch 543/724)
2025-12-22 20:39:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.719690
2025-12-22 20:39:12 INFO Tuning ranking metrics: regret=0.066948 spearman=0.155657 (groups=37, skipped=311)
2025-12-22 20:39:12 INFO Epoch 118 | train_mse=0.037130 | val_loss=0.047872 | best_val_loss=0.257623
2025-12-22 20:39:23 INFO Epoch 119 | 25% complete (batch 181/724)
2025-12-22 20:39:26 INFO Epoch 119 | 50% complete (batch 362/724)
2025-12-22 20:39:30 INFO Epoch 119 | 75% complete (batch 543/724)
2025-12-22 20:39:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.722084
2025-12-22 20:39:49 INFO Tuning ranking metrics: regret=0.064920 spearman=0.151076 (groups=37, skipped=311)
2025-12-22 20:39:49 INFO Epoch 119 | train_mse=0.038238 | val_loss=0.048579 | best_val_loss=0.257623
2025-12-22 20:40:00 INFO Epoch 120 | 25% complete (batch 181/724)
2025-12-22 20:40:03 INFO Epoch 120 | 50% complete (batch 362/724)
2025-12-22 20:40:07 INFO Epoch 120 | 75% complete (batch 543/724)
2025-12-22 20:40:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.721894
2025-12-22 20:40:26 INFO Tuning ranking metrics: regret=0.066948 spearman=0.171663 (groups=37, skipped=311)
2025-12-22 20:40:26 INFO Epoch 120 | train_mse=0.037812 | val_loss=0.047541 | best_val_loss=0.257623
2025-12-22 20:40:37 INFO Epoch 121 | 25% complete (batch 181/724)
2025-12-22 20:40:40 INFO Epoch 121 | 50% complete (batch 362/724)
2025-12-22 20:40:44 INFO Epoch 121 | 75% complete (batch 543/724)
2025-12-22 20:40:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.723983
2025-12-22 20:41:03 INFO Tuning ranking metrics: regret=0.064988 spearman=0.200415 (groups=37, skipped=311)
2025-12-22 20:41:03 INFO Epoch 121 | train_mse=0.039180 | val_loss=0.048275 | best_val_loss=0.257623
2025-12-22 20:41:14 INFO Epoch 122 | 25% complete (batch 181/724)
2025-12-22 20:41:17 INFO Epoch 122 | 50% complete (batch 362/724)
2025-12-22 20:41:21 INFO Epoch 122 | 75% complete (batch 543/724)
2025-12-22 20:41:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.723382
2025-12-22 20:41:40 INFO Tuning ranking metrics: regret=0.064450 spearman=0.184819 (groups=37, skipped=311)
2025-12-22 20:41:40 INFO Epoch 122 | train_mse=0.036561 | val_loss=0.048056 | best_val_loss=0.257623
2025-12-22 20:41:51 INFO Epoch 123 | 25% complete (batch 181/724)
2025-12-22 20:41:54 INFO Epoch 123 | 50% complete (batch 362/724)
2025-12-22 20:41:58 INFO Epoch 123 | 75% complete (batch 543/724)
2025-12-22 20:42:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.720361
2025-12-22 20:42:17 INFO Tuning ranking metrics: regret=0.064673 spearman=0.210782 (groups=37, skipped=311)
2025-12-22 20:42:17 INFO Epoch 123 | train_mse=0.042602 | val_loss=0.049323 | best_val_loss=0.257623
2025-12-22 20:42:28 INFO Epoch 124 | 25% complete (batch 181/724)
2025-12-22 20:42:32 INFO Epoch 124 | 50% complete (batch 362/724)
2025-12-22 20:42:35 INFO Epoch 124 | 75% complete (batch 543/724)
2025-12-22 20:42:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.721775
2025-12-22 20:42:54 INFO Tuning ranking metrics: regret=0.064850 spearman=0.199707 (groups=37, skipped=311)
2025-12-22 20:42:54 INFO Epoch 124 | train_mse=0.045268 | val_loss=0.048434 | best_val_loss=0.257623
2025-12-22 20:43:05 INFO Epoch 125 | 25% complete (batch 181/724)
2025-12-22 20:43:08 INFO Epoch 125 | 50% complete (batch 362/724)
2025-12-22 20:43:12 INFO Epoch 125 | 75% complete (batch 543/724)
2025-12-22 20:43:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.720551
2025-12-22 20:43:32 INFO Tuning ranking metrics: regret=0.064491 spearman=0.207558 (groups=37, skipped=311)
2025-12-22 20:43:32 INFO Epoch 125 | train_mse=0.042201 | val_loss=0.050140 | best_val_loss=0.257623
2025-12-22 20:43:42 INFO Epoch 126 | 25% complete (batch 181/724)
2025-12-22 20:43:46 INFO Epoch 126 | 50% complete (batch 362/724)
2025-12-22 20:43:49 INFO Epoch 126 | 75% complete (batch 543/724)
2025-12-22 20:44:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.711846
2025-12-22 20:44:08 INFO Tuning ranking metrics: regret=0.060646 spearman=0.221809 (groups=37, skipped=311)
2025-12-22 20:44:08 INFO Epoch 126 | train_mse=0.042332 | val_loss=0.049811 | best_val_loss=0.257623
2025-12-22 20:44:19 INFO Epoch 127 | 25% complete (batch 181/724)
2025-12-22 20:44:22 INFO Epoch 127 | 50% complete (batch 362/724)
2025-12-22 20:44:26 INFO Epoch 127 | 75% complete (batch 543/724)
2025-12-22 20:44:40 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.719446
2025-12-22 20:44:45 INFO Tuning ranking metrics: regret=0.064673 spearman=0.202937 (groups=37, skipped=311)
2025-12-22 20:44:45 INFO Epoch 127 | train_mse=0.039682 | val_loss=0.048094 | best_val_loss=0.257623
2025-12-22 20:44:56 INFO Epoch 128 | 25% complete (batch 181/724)
2025-12-22 20:45:00 INFO Epoch 128 | 50% complete (batch 362/724)
2025-12-22 20:45:03 INFO Epoch 128 | 75% complete (batch 543/724)
2025-12-22 20:45:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.720349
2025-12-22 20:45:22 INFO Tuning ranking metrics: regret=0.057694 spearman=0.164157 (groups=37, skipped=311)
2025-12-22 20:45:22 INFO Epoch 128 | train_mse=0.037375 | val_loss=0.049707 | best_val_loss=0.257623
2025-12-22 20:45:33 INFO Epoch 129 | 25% complete (batch 181/724)
2025-12-22 20:45:37 INFO Epoch 129 | 50% complete (batch 362/724)
2025-12-22 20:45:41 INFO Epoch 129 | 75% complete (batch 543/724)
2025-12-22 20:45:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.723213
2025-12-22 20:46:00 INFO Tuning ranking metrics: regret=0.064818 spearman=0.216591 (groups=37, skipped=311)
2025-12-22 20:46:00 INFO Epoch 129 | train_mse=0.039230 | val_loss=0.051925 | best_val_loss=0.257623
2025-12-22 20:46:10 INFO Epoch 130 | 25% complete (batch 181/724)
2025-12-22 20:46:14 INFO Epoch 130 | 50% complete (batch 362/724)
2025-12-22 20:46:17 INFO Epoch 130 | 75% complete (batch 543/724)
2025-12-22 20:46:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.720567
2025-12-22 20:46:36 INFO Tuning ranking metrics: regret=0.064422 spearman=0.174804 (groups=37, skipped=311)
2025-12-22 20:46:36 INFO Epoch 130 | train_mse=0.045774 | val_loss=0.048363 | best_val_loss=0.257623
2025-12-22 20:46:47 INFO Epoch 131 | 25% complete (batch 181/724)
2025-12-22 20:46:51 INFO Epoch 131 | 50% complete (batch 362/724)
2025-12-22 20:46:54 INFO Epoch 131 | 75% complete (batch 543/724)
2025-12-22 20:47:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.725341
2025-12-22 20:47:14 INFO Tuning ranking metrics: regret=0.050244 spearman=0.210027 (groups=37, skipped=311)
2025-12-22 20:47:14 INFO Epoch 131 | train_mse=0.035937 | val_loss=0.047659 | best_val_loss=0.257623
2025-12-22 20:47:24 INFO Epoch 132 | 25% complete (batch 181/724)
2025-12-22 20:47:28 INFO Epoch 132 | 50% complete (batch 362/724)
2025-12-22 20:47:31 INFO Epoch 132 | 75% complete (batch 543/724)
2025-12-22 20:47:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.724704
2025-12-22 20:47:50 INFO Tuning ranking metrics: regret=0.050272 spearman=0.189452 (groups=37, skipped=311)
2025-12-22 20:47:50 INFO Epoch 132 | train_mse=0.037998 | val_loss=0.047252 | best_val_loss=0.257623
2025-12-22 20:48:01 INFO Epoch 133 | 25% complete (batch 181/724)
2025-12-22 20:48:04 INFO Epoch 133 | 50% complete (batch 362/724)
2025-12-22 20:48:08 INFO Epoch 133 | 75% complete (batch 543/724)
2025-12-22 20:48:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.730286
2025-12-22 20:48:27 INFO Tuning ranking metrics: regret=0.054973 spearman=0.194612 (groups=37, skipped=311)
2025-12-22 20:48:27 INFO Epoch 133 | train_mse=0.040041 | val_loss=0.047100 | best_val_loss=0.257623
2025-12-22 20:48:38 INFO Epoch 134 | 25% complete (batch 181/724)
2025-12-22 20:48:41 INFO Epoch 134 | 50% complete (batch 362/724)
2025-12-22 20:48:45 INFO Epoch 134 | 75% complete (batch 543/724)
2025-12-22 20:48:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.728542
2025-12-22 20:49:04 INFO Tuning ranking metrics: regret=0.064628 spearman=0.160308 (groups=37, skipped=311)
2025-12-22 20:49:04 INFO Epoch 134 | train_mse=0.040135 | val_loss=0.045641 | best_val_loss=0.257623
2025-12-22 20:49:14 INFO Epoch 135 | 25% complete (batch 181/724)
2025-12-22 20:49:18 INFO Epoch 135 | 50% complete (batch 362/724)
2025-12-22 20:49:21 INFO Epoch 135 | 75% complete (batch 543/724)
2025-12-22 20:49:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.733026
2025-12-22 20:49:40 INFO Tuning ranking metrics: regret=0.050211 spearman=0.216403 (groups=37, skipped=311)
2025-12-22 20:49:40 INFO Epoch 135 | train_mse=0.038612 | val_loss=0.047354 | best_val_loss=0.257623
2025-12-22 20:49:51 INFO Epoch 136 | 25% complete (batch 181/724)
2025-12-22 20:49:55 INFO Epoch 136 | 50% complete (batch 362/724)
2025-12-22 20:49:58 INFO Epoch 136 | 75% complete (batch 543/724)
2025-12-22 20:50:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.729334
2025-12-22 20:50:17 INFO Tuning ranking metrics: regret=0.050244 spearman=0.204165 (groups=37, skipped=311)
2025-12-22 20:50:17 INFO Epoch 136 | train_mse=0.037885 | val_loss=0.046026 | best_val_loss=0.257623
2025-12-22 20:50:28 INFO Epoch 137 | 25% complete (batch 181/724)
2025-12-22 20:50:31 INFO Epoch 137 | 50% complete (batch 362/724)
2025-12-22 20:50:35 INFO Epoch 137 | 75% complete (batch 543/724)
2025-12-22 20:50:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.728513
2025-12-22 20:50:54 INFO Tuning ranking metrics: regret=0.046245 spearman=0.203820 (groups=37, skipped=311)
2025-12-22 20:50:54 INFO Epoch 137 | train_mse=0.036131 | val_loss=0.046180 | best_val_loss=0.257623
2025-12-22 20:51:05 INFO Epoch 138 | 25% complete (batch 181/724)
2025-12-22 20:51:09 INFO Epoch 138 | 50% complete (batch 362/724)
2025-12-22 20:51:13 INFO Epoch 138 | 75% complete (batch 543/724)
2025-12-22 20:51:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.727420
2025-12-22 20:51:31 INFO Tuning ranking metrics: regret=0.046572 spearman=0.221101 (groups=37, skipped=311)
2025-12-22 20:51:31 INFO Epoch 138 | train_mse=0.036153 | val_loss=0.047896 | best_val_loss=0.257623
2025-12-22 20:51:42 INFO Epoch 139 | 25% complete (batch 181/724)
2025-12-22 20:51:46 INFO Epoch 139 | 50% complete (batch 362/724)
2025-12-22 20:51:49 INFO Epoch 139 | 75% complete (batch 543/724)
2025-12-22 20:52:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.724002
2025-12-22 20:52:08 INFO Tuning ranking metrics: regret=0.050211 spearman=0.208336 (groups=37, skipped=311)
2025-12-22 20:52:08 INFO Epoch 139 | train_mse=0.044827 | val_loss=0.046164 | best_val_loss=0.257623
2025-12-22 20:52:19 INFO Epoch 140 | 25% complete (batch 181/724)
2025-12-22 20:52:23 INFO Epoch 140 | 50% complete (batch 362/724)
2025-12-22 20:52:26 INFO Epoch 140 | 75% complete (batch 543/724)
2025-12-22 20:52:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.727061
2025-12-22 20:52:45 INFO Tuning ranking metrics: regret=0.046217 spearman=0.206470 (groups=37, skipped=311)
2025-12-22 20:52:45 INFO Epoch 140 | train_mse=0.035308 | val_loss=0.046714 | best_val_loss=0.257623
2025-12-22 20:52:55 INFO Epoch 141 | 25% complete (batch 181/724)
2025-12-22 20:52:59 INFO Epoch 141 | 50% complete (batch 362/724)
2025-12-22 20:53:03 INFO Epoch 141 | 75% complete (batch 543/724)
2025-12-22 20:53:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.722810
2025-12-22 20:53:22 INFO Tuning ranking metrics: regret=0.045030 spearman=0.215391 (groups=37, skipped=311)
2025-12-22 20:53:22 INFO Epoch 141 | train_mse=0.041579 | val_loss=0.047460 | best_val_loss=0.257623
2025-12-22 20:53:32 INFO Epoch 142 | 25% complete (batch 181/724)
2025-12-22 20:53:36 INFO Epoch 142 | 50% complete (batch 362/724)
2025-12-22 20:53:39 INFO Epoch 142 | 75% complete (batch 543/724)
2025-12-22 20:53:53 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.728236
2025-12-22 20:53:58 INFO Tuning ranking metrics: regret=0.046185 spearman=0.217521 (groups=37, skipped=311)
2025-12-22 20:53:58 INFO Epoch 142 | train_mse=0.038630 | val_loss=0.046136 | best_val_loss=0.257623
2025-12-22 20:54:09 INFO Epoch 143 | 25% complete (batch 181/724)
2025-12-22 20:54:13 INFO Epoch 143 | 50% complete (batch 362/724)
2025-12-22 20:54:16 INFO Epoch 143 | 75% complete (batch 543/724)
2025-12-22 20:54:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.725736
2025-12-22 20:54:35 INFO Tuning ranking metrics: regret=0.044642 spearman=0.218071 (groups=37, skipped=311)
2025-12-22 20:54:35 INFO Epoch 143 | train_mse=0.035976 | val_loss=0.047149 | best_val_loss=0.257623
2025-12-22 20:54:46 INFO Epoch 144 | 25% complete (batch 181/724)
2025-12-22 20:54:49 INFO Epoch 144 | 50% complete (batch 362/724)
2025-12-22 20:54:52 INFO Epoch 144 | 75% complete (batch 543/724)
2025-12-22 20:55:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.723821
2025-12-22 20:55:11 INFO Tuning ranking metrics: regret=0.046682 spearman=0.212291 (groups=37, skipped=311)
2025-12-22 20:55:11 INFO Epoch 144 | train_mse=0.031698 | val_loss=0.047138 | best_val_loss=0.257623
2025-12-22 20:55:22 INFO Epoch 145 | 25% complete (batch 181/724)
2025-12-22 20:55:26 INFO Epoch 145 | 50% complete (batch 362/724)
2025-12-22 20:55:29 INFO Epoch 145 | 75% complete (batch 543/724)
2025-12-22 20:55:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.734229
2025-12-22 20:55:48 INFO Tuning ranking metrics: regret=0.050244 spearman=0.210559 (groups=37, skipped=311)
2025-12-22 20:55:48 INFO Epoch 145 | train_mse=0.040671 | val_loss=0.046096 | best_val_loss=0.257623
2025-12-22 20:55:59 INFO Epoch 146 | 25% complete (batch 181/724)
2025-12-22 20:56:02 INFO Epoch 146 | 50% complete (batch 362/724)
2025-12-22 20:56:06 INFO Epoch 146 | 75% complete (batch 543/724)
2025-12-22 20:56:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.729900
2025-12-22 20:56:25 INFO Tuning ranking metrics: regret=0.050244 spearman=0.203311 (groups=37, skipped=311)
2025-12-22 20:56:25 INFO Epoch 146 | train_mse=0.033901 | val_loss=0.046369 | best_val_loss=0.257623
2025-12-22 20:56:36 INFO Epoch 147 | 25% complete (batch 181/724)
2025-12-22 20:56:39 INFO Epoch 147 | 50% complete (batch 362/724)
2025-12-22 20:56:43 INFO Epoch 147 | 75% complete (batch 543/724)
2025-12-22 20:56:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.728034
2025-12-22 20:57:02 INFO Tuning ranking metrics: regret=0.046185 spearman=0.223318 (groups=37, skipped=311)
2025-12-22 20:57:02 INFO Epoch 147 | train_mse=0.035694 | val_loss=0.046708 | best_val_loss=0.257623
2025-12-22 20:57:13 INFO Epoch 148 | 25% complete (batch 181/724)
2025-12-22 20:57:16 INFO Epoch 148 | 50% complete (batch 362/724)
2025-12-22 20:57:20 INFO Epoch 148 | 75% complete (batch 543/724)
2025-12-22 20:57:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.730712
2025-12-22 20:57:39 INFO Tuning ranking metrics: regret=0.050203 spearman=0.205236 (groups=37, skipped=311)
2025-12-22 20:57:39 INFO Epoch 148 | train_mse=0.035963 | val_loss=0.045751 | best_val_loss=0.257623
2025-12-22 20:57:50 INFO Epoch 149 | 25% complete (batch 181/724)
2025-12-22 20:57:53 INFO Epoch 149 | 50% complete (batch 362/724)
2025-12-22 20:57:57 INFO Epoch 149 | 75% complete (batch 543/724)
2025-12-22 20:58:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.729212
2025-12-22 20:58:16 INFO Tuning ranking metrics: regret=0.050203 spearman=0.206792 (groups=37, skipped=311)
2025-12-22 20:58:16 INFO Epoch 149 | train_mse=0.036773 | val_loss=0.046323 | best_val_loss=0.257623
2025-12-22 20:58:27 INFO Epoch 150 | 25% complete (batch 181/724)
2025-12-22 20:58:30 INFO Epoch 150 | 50% complete (batch 362/724)
2025-12-22 20:58:34 INFO Epoch 150 | 75% complete (batch 543/724)
2025-12-22 20:58:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.726474
2025-12-22 20:58:52 INFO Tuning ranking metrics: regret=0.050211 spearman=0.207143 (groups=37, skipped=311)
2025-12-22 20:58:52 INFO Epoch 150 | train_mse=0.035895 | val_loss=0.046335 | best_val_loss=0.257623
2025-12-22 20:59:03 INFO Epoch 151 | 25% complete (batch 181/724)
2025-12-22 20:59:06 INFO Epoch 151 | 50% complete (batch 362/724)
2025-12-22 20:59:10 INFO Epoch 151 | 75% complete (batch 543/724)
2025-12-22 20:59:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.727263
2025-12-22 20:59:29 INFO Tuning ranking metrics: regret=0.050211 spearman=0.206008 (groups=37, skipped=311)
2025-12-22 20:59:29 INFO Epoch 151 | train_mse=0.033188 | val_loss=0.046936 | best_val_loss=0.257623
2025-12-22 20:59:40 INFO Epoch 152 | 25% complete (batch 181/724)
2025-12-22 20:59:43 INFO Epoch 152 | 50% complete (batch 362/724)
2025-12-22 20:59:46 INFO Epoch 152 | 75% complete (batch 543/724)
2025-12-22 21:00:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.726126
2025-12-22 21:00:05 INFO Tuning ranking metrics: regret=0.050340 spearman=0.204651 (groups=37, skipped=311)
2025-12-22 21:00:05 INFO Epoch 152 | train_mse=0.033583 | val_loss=0.046325 | best_val_loss=0.257623
2025-12-22 21:00:16 INFO Epoch 153 | 25% complete (batch 181/724)
2025-12-22 21:00:20 INFO Epoch 153 | 50% complete (batch 362/724)
2025-12-22 21:00:23 INFO Epoch 153 | 75% complete (batch 543/724)
2025-12-22 21:00:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.727207
2025-12-22 21:00:43 INFO Tuning ranking metrics: regret=0.050203 spearman=0.208442 (groups=37, skipped=311)
2025-12-22 21:00:43 INFO Epoch 153 | train_mse=0.038492 | val_loss=0.045666 | best_val_loss=0.257623
2025-12-22 21:00:53 INFO Epoch 154 | 25% complete (batch 181/724)
2025-12-22 21:00:56 INFO Epoch 154 | 50% complete (batch 362/724)
2025-12-22 21:01:00 INFO Epoch 154 | 75% complete (batch 543/724)
2025-12-22 21:01:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.728792
2025-12-22 21:01:19 INFO Tuning ranking metrics: regret=0.050244 spearman=0.207985 (groups=37, skipped=311)
2025-12-22 21:01:19 INFO Epoch 154 | train_mse=0.037023 | val_loss=0.045800 | best_val_loss=0.257623
2025-12-22 21:01:29 INFO Epoch 155 | 25% complete (batch 181/724)
2025-12-22 21:01:33 INFO Epoch 155 | 50% complete (batch 362/724)
2025-12-22 21:01:36 INFO Epoch 155 | 75% complete (batch 543/724)
2025-12-22 21:01:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.729650
2025-12-22 21:01:55 INFO Tuning ranking metrics: regret=0.050211 spearman=0.213806 (groups=37, skipped=311)
2025-12-22 21:01:55 INFO Epoch 155 | train_mse=0.037299 | val_loss=0.046772 | best_val_loss=0.257623
2025-12-22 21:02:05 INFO Epoch 156 | 25% complete (batch 181/724)
2025-12-22 21:02:09 INFO Epoch 156 | 50% complete (batch 362/724)
2025-12-22 21:02:12 INFO Epoch 156 | 75% complete (batch 543/724)
2025-12-22 21:02:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.730481
2025-12-22 21:02:31 INFO Tuning ranking metrics: regret=0.050340 spearman=0.218942 (groups=37, skipped=311)
2025-12-22 21:02:31 INFO Epoch 156 | train_mse=0.034753 | val_loss=0.045977 | best_val_loss=0.257623
Monitored metric tuning_rank_spearman did not improve in the last 50 records. Best score: 0.258. Signaling Trainer to stop.
2025-12-22 21:02:32 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.22390_val-0.07534_epoch080.chkpt, checkpoint.tuning_rank_spearman-0.23570_val-0.07531_epoch086.chkpt, checkpoint.tuning_rank_spearman-0.25762_val-0.04944_epoch106.chkpt
2025-12-22 21:02:32 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-22_19-26-05/model_checkpoints/checkpoint.tuning_rank_spearman-0.25762_val-0.04944_epoch106.chkpt
2025-12-22 21:02:32 INFO Best validation loss: tensor(0.2576)
2025-12-22 21:02:32 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-22_19-26-05/model_checkpoints/checkpoint.tuning_rank_spearman-0.25762_val-0.04944_epoch106.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-22_19-26-05/model_checkpoints/checkpoint.tuning_rank_spearman-0.25762_val-0.04944_epoch106.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-22 21:02:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.049442
2025-12-22 21:02:47 INFO Tuning ranking metrics: regret=0.063901 spearman=0.257623 (groups=37, skipped=311)
2025-12-22 21:02:47 INFO Epoch 157 | val_loss=0.049442 | best_val_loss=0.257623
2025-12-22 21:02:47 INFO Validation metrics: [{'val_loss': 0.04944196715950966, 'tuning_rank_regret': 0.06390093266963959, 'tuning_rank_spearman': 0.2576225697994232, 'val_pearson_corr': 0.8124849796295166, 'val_spearman_corr': 0.7582826614379883, 'val_rank_regret': 0.07038482278585434, 'val_rank_spearman': 0.2276575267314911}]
2025-12-22 21:02:47 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.25762_val-0.04944_epoch106.chkpt
2025-12-22 21:02:47 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.22390_val-0.07534_epoch080.chkpt
2025-12-22 21:02:47 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.23570_val-0.07531_epoch086.chkpt
2025-12-22 21:02:47 INFO Renamed checkpoint file: alt_val.val-0.04503_epoch088.ckpt -> alt_val.val-0.04503_epoch088.chkpt
2025-12-22 21:02:47 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.04503_epoch088.chkpt
2025-12-22 21:02:47 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.06390093266963959
  tuning_rank_spearman      0.2576225697994232
        val_loss            0.04944196715950966
    val_pearson_corr        0.8124849796295166
     val_rank_regret        0.07038482278585434
    val_rank_spearman       0.2276575267314911
    val_spearman_corr       0.7582826614379883
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run polish_lr_low_seed101_2025-12-22_19-26-05 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-22_19-26-05
[train_cli][batch] job 'polish_lr_low_seed101' finished.
[train_cli][batch] (3/6) running job 'polish_seed555' -> run_name=polish_seed555_2025-12-22_21-02-50
[train_cli] run_id=polish_seed555_2025-12-22_21-02-50 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-22_21-02-50/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-22_21-02-50 --git-commit 150d1dcbd1 --git-dirty
2025-12-22 21:02:53 INFO git_commit = 150d1dcbd1 (dirty)
2025-12-22 21:02:53 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-22 21:02:53 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-22_21-02-50/config/config.yaml
2025-12-22 21:02:53 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data
2025-12-22 21:02:53 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-22 21:02:53 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-22 21:02:53 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-22_21-02-50
2025-12-22 21:02:53 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-22 21:02:53 INFO   metadata_path = None
2025-12-22 21:02:53 INFO   summary_path = None
2025-12-22 21:02:53 INFO   accelerator = cpu
2025-12-22 21:02:53 INFO   devices = 1
2025-12-22 21:02:53 INFO   attention_head = 8
2025-12-22 21:02:53 INFO   pooling_type = mean
2025-12-22 21:02:53 INFO   model_self_loops = False
2025-12-22 21:02:53 INFO   model_self_loop_fill = mean
2025-12-22 21:02:53 INFO   model_residual = False
2025-12-22 21:02:53 INFO   batch_size = 48
2025-12-22 21:02:53 INFO   learning_rate = 0.003
2025-12-22 21:02:53 INFO   num_epochs = 320
2025-12-22 21:02:53 INFO   accumulate_grad_batches = 8
2025-12-22 21:02:53 INFO   seed = 555
2025-12-22 21:02:53 INFO   num_workers = 2
2025-12-22 21:02:53 INFO   precision = 32
2025-12-22 21:02:53 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-22 21:02:53 INFO   early_stopping_patience = 40
2025-12-22 21:02:53 INFO   lr_scheduler_patience = 20
2025-12-22 21:02:53 INFO   lr_scheduler_factor = 0.3
2025-12-22 21:02:53 INFO   fast_dev_run = False
2025-12-22 21:02:53 INFO   limit_train_batches = None
2025-12-22 21:02:53 INFO   limit_val_batches = None
2025-12-22 21:02:53 INFO   log_lr = False
2025-12-22 21:02:53 INFO   progress_bar_refresh_rate = 0
2025-12-22 21:02:53 INFO   log_every_n_steps = 100
2025-12-22 21:02:53 INFO   use_val_spearman_as_secondary = True
2025-12-22 21:02:53 INFO   spearman_secondary_min_delta = 0.0
2025-12-22 21:02:53 INFO   spearman_secondary_weight = 1.0
2025-12-22 21:02:53 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-22 21:02:53 INFO   tuning_max_samples = 500
2025-12-22 21:02:53 INFO   tuning_fraction = None
2025-12-22 21:02:53 INFO   tuning_eval_every = 1
2025-12-22 21:02:53 INFO   rank_loss_weight = 0.0
2025-12-22 21:02:53 INFO   rank_loss_margin = 0.0
2025-12-22 21:02:53 INFO   rank_loss_mode = hinge
2025-12-22 21:02:53 INFO   rank_loss_grouped = True
2025-12-22 21:02:53 INFO   variance_reduction_enabled = False
2025-12-22 21:02:53 INFO   variance_reduction_method = topk_avg
2025-12-22 21:02:53 INFO   variance_reduction_top_k = 3
2025-12-22 21:02:53 INFO   coverage_minimum = 0.0
2025-12-22 21:02:53 INFO   coverage_fail_on_missing = False
2025-12-22 21:02:53 INFO   graph_load_profiling = False
2025-12-22 21:02:53 INFO   graph_load_top_k = 5
2025-12-22 21:02:53 INFO   enable_graph_cache = True
2025-12-22 21:02:53 INFO   graph_cache_size = 256
2025-12-22 21:02:53 INFO   canonicalize_on_load = False
2025-12-22 21:02:53 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-22 21:02:53 INFO   edge_schema = {}
2025-12-22 21:02:53 INFO   topology_schema = {}
Seed set to 555
2025-12-22 21:02:54 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-22 21:02:54 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 21:02:54 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-22 21:02:54 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 21:02:54 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-22 21:02:54 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 21:02:55 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-22 21:02:55 INFO Tuning group stats: groups=368 groups>=2=39 singletons=329 max_group=9
2025-12-22 21:02:55 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-22_21-02-50/dataset_coverage.json
2025-12-22 21:02:55 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-22_21-02-50/dataset_coverage.json for details.
2025-12-22 21:02:55 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-22_21-02-50/dataset_coverage.json for details.
2025-12-22 21:02:55 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-22_21-02-50/dataset_coverage.json for details.
2025-12-22 21:02:55 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-22_21-02-50/schema_summary.json
2025-12-22 21:02:55 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-22_21-02-50/feature_metadata.json
2025-12-22 21:02:55 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-22 21:02:55 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/feature-config.yaml.topoqa.10A.2, sha256=5c62898155179232a565e24d9fbd7b208f9ce480d1a19d6139de19454e173ff0
2025-12-22 21:02:55 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/work/edge_features)
2025-12-22 21:02:55 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json
2025-12-22 21:02:55 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-22_21-02-50/schema_summary.json
2025-12-22 21:02:55 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-22 21:02:55 INFO Topology: topology/persistence_basic/v1 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 172-dimensional node features.
2025-12-22 21:02:55 INFO Node: node/dssp_topo_merge/v1; metadata lists 172 feature columns matching the .pt tensor.
2025-12-22 21:02:55 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-22 21:02:55 INFO → Total feature dimensionality observed and confirmed: node_dim = 172, edge_dim = 11.
2025-12-22 21:02:55 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-22 21:02:55 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 172,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 172,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-22_21-02-50/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge/v1",
      "alias": "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA",
      "jobs": 16,
      "summary": "DSSP-derived node features merged with topology statistics."
    },
    "topology": {
      "id": "topology/persistence_basic/v1",
      "alias": "Betti 0 and Betti 1 topology summaries on interface coords = 140D PH | TopoQA",
      "jobs": 16,
      "summary": "Persistent homology features with configurable distance thresholds."
    }
  },
  "notes": []
}
2025-12-22 21:02:55 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-22 21:02:55 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=66e574d59fbe4bd784392e2fa496f35c)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-22 21:02:55 INFO Starting training (fast_dev_run=False)
2025-12-22 21:02:55 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-22_21-02-50/model_checkpoints exists and is not empty.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 5.5 K  | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
165 K     Trainable params
0         Non-trainable params
165 K     Total params
0.662     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-22 21:03:09 INFO Epoch 000 | 25% complete (batch 46/181)
2025-12-22 21:03:10 INFO Epoch 000 | 50% complete (batch 91/181)
2025-12-22 21:03:10 INFO Epoch 000 | 75% complete (batch 136/181)
2025-12-22 21:03:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.142981
2025-12-22 21:03:23 INFO Tuning ranking metrics: regret=0.140443 spearman=0.101465 (groups=39, skipped=329)
2025-12-22 21:03:23 INFO Epoch 000 | val_loss=0.142981
Metric tuning_rank_spearman improved. New best score: 0.101
2025-12-22 21:03:32 INFO Epoch 001 | 25% complete (batch 46/181)
2025-12-22 21:03:32 INFO Epoch 001 | 50% complete (batch 91/181)
2025-12-22 21:03:33 INFO Epoch 001 | 75% complete (batch 136/181)
2025-12-22 21:03:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.011167
2025-12-22 21:03:46 INFO Tuning ranking metrics: regret=0.135450 spearman=0.158852 (groups=39, skipped=329)
2025-12-22 21:03:46 INFO Epoch 001 | train_mse=0.150345 | val_loss=0.140461 | best_val_loss=0.101465
Metric tuning_rank_spearman improved by 0.057 >= min_delta = 0.0. New best score: 0.159
2025-12-22 21:03:54 INFO Epoch 002 | 25% complete (batch 46/181)
2025-12-22 21:03:55 INFO Epoch 002 | 50% complete (batch 91/181)
2025-12-22 21:03:56 INFO Epoch 002 | 75% complete (batch 136/181)
2025-12-22 21:04:04 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.219517
2025-12-22 21:04:09 INFO Tuning ranking metrics: regret=0.133208 spearman=0.154212 (groups=39, skipped=329)
2025-12-22 21:04:09 INFO Epoch 002 | train_mse=0.150709 | val_loss=0.140245 | best_val_loss=0.158852
2025-12-22 21:04:17 INFO Epoch 003 | 25% complete (batch 46/181)
2025-12-22 21:04:18 INFO Epoch 003 | 50% complete (batch 91/181)
2025-12-22 21:04:18 INFO Epoch 003 | 75% complete (batch 136/181)
2025-12-22 21:04:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.311316
2025-12-22 21:04:32 INFO Tuning ranking metrics: regret=0.136294 spearman=0.172527 (groups=39, skipped=329)
2025-12-22 21:04:32 INFO Epoch 003 | train_mse=0.146780 | val_loss=0.139945 | best_val_loss=0.158852
Metric tuning_rank_spearman improved by 0.014 >= min_delta = 0.0. New best score: 0.173
2025-12-22 21:04:40 INFO Epoch 004 | 25% complete (batch 46/181)
2025-12-22 21:04:41 INFO Epoch 004 | 50% complete (batch 91/181)
2025-12-22 21:04:41 INFO Epoch 004 | 75% complete (batch 136/181)
2025-12-22 21:04:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.334606
2025-12-22 21:04:55 INFO Tuning ranking metrics: regret=0.137217 spearman=0.207875 (groups=39, skipped=329)
2025-12-22 21:04:55 INFO Epoch 004 | train_mse=0.150442 | val_loss=0.140717 | best_val_loss=0.172527
Metric tuning_rank_spearman improved by 0.035 >= min_delta = 0.0. New best score: 0.208
2025-12-22 21:05:03 INFO Epoch 005 | 25% complete (batch 46/181)
2025-12-22 21:05:04 INFO Epoch 005 | 50% complete (batch 91/181)
2025-12-22 21:05:05 INFO Epoch 005 | 75% complete (batch 136/181)
2025-12-22 21:05:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.369406
2025-12-22 21:05:18 INFO Tuning ranking metrics: regret=0.141795 spearman=0.226007 (groups=39, skipped=329)
2025-12-22 21:05:18 INFO Epoch 005 | train_mse=0.151067 | val_loss=0.120504 | best_val_loss=0.207875
Metric tuning_rank_spearman improved by 0.018 >= min_delta = 0.0. New best score: 0.226
2025-12-22 21:05:26 INFO Epoch 006 | 25% complete (batch 46/181)
2025-12-22 21:05:27 INFO Epoch 006 | 50% complete (batch 91/181)
2025-12-22 21:05:28 INFO Epoch 006 | 75% complete (batch 136/181)
2025-12-22 21:05:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.424972
2025-12-22 21:05:41 INFO Tuning ranking metrics: regret=0.115486 spearman=0.269231 (groups=39, skipped=329)
2025-12-22 21:05:41 INFO Epoch 006 | train_mse=0.141174 | val_loss=0.133869 | best_val_loss=0.226007
Metric tuning_rank_spearman improved by 0.043 >= min_delta = 0.0. New best score: 0.269
2025-12-22 21:05:49 INFO Epoch 007 | 25% complete (batch 46/181)
2025-12-22 21:05:50 INFO Epoch 007 | 50% complete (batch 91/181)
2025-12-22 21:05:51 INFO Epoch 007 | 75% complete (batch 136/181)
2025-12-22 21:05:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.466374
2025-12-22 21:06:04 INFO Tuning ranking metrics: regret=0.126814 spearman=0.285897 (groups=39, skipped=329)
2025-12-22 21:06:04 INFO Epoch 007 | train_mse=0.139199 | val_loss=0.121038 | best_val_loss=0.269231
Metric tuning_rank_spearman improved by 0.017 >= min_delta = 0.0. New best score: 0.286
2025-12-22 21:06:13 INFO Epoch 008 | 25% complete (batch 46/181)
2025-12-22 21:06:14 INFO Epoch 008 | 50% complete (batch 91/181)
2025-12-22 21:06:14 INFO Epoch 008 | 75% complete (batch 136/181)
2025-12-22 21:06:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.456336
2025-12-22 21:06:27 INFO Tuning ranking metrics: regret=0.090803 spearman=0.374542 (groups=39, skipped=329)
2025-12-22 21:06:27 INFO Epoch 008 | train_mse=0.138211 | val_loss=0.111576 | best_val_loss=0.285897
Metric tuning_rank_spearman improved by 0.089 >= min_delta = 0.0. New best score: 0.375
2025-12-22 21:06:36 INFO Epoch 009 | 25% complete (batch 46/181)
2025-12-22 21:06:37 INFO Epoch 009 | 50% complete (batch 91/181)
2025-12-22 21:06:37 INFO Epoch 009 | 75% complete (batch 136/181)
2025-12-22 21:06:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.483897
2025-12-22 21:06:51 INFO Tuning ranking metrics: regret=0.113670 spearman=0.300183 (groups=39, skipped=329)
2025-12-22 21:06:51 INFO Epoch 009 | train_mse=0.139487 | val_loss=0.096323 | best_val_loss=0.374542
2025-12-22 21:06:59 INFO Epoch 010 | 25% complete (batch 46/181)
2025-12-22 21:07:00 INFO Epoch 010 | 50% complete (batch 91/181)
2025-12-22 21:07:01 INFO Epoch 010 | 75% complete (batch 136/181)
2025-12-22 21:07:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.536567
2025-12-22 21:07:14 INFO Tuning ranking metrics: regret=0.108280 spearman=0.316239 (groups=39, skipped=329)
2025-12-22 21:07:14 INFO Epoch 010 | train_mse=0.109156 | val_loss=0.082151 | best_val_loss=0.374542
2025-12-22 21:07:23 INFO Epoch 011 | 25% complete (batch 46/181)
2025-12-22 21:07:24 INFO Epoch 011 | 50% complete (batch 91/181)
2025-12-22 21:07:24 INFO Epoch 011 | 75% complete (batch 136/181)
2025-12-22 21:07:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.514516
2025-12-22 21:07:38 INFO Tuning ranking metrics: regret=0.107848 spearman=0.321245 (groups=39, skipped=329)
2025-12-22 21:07:38 INFO Epoch 011 | train_mse=0.102616 | val_loss=0.099892 | best_val_loss=0.374542
2025-12-22 21:07:46 INFO Epoch 012 | 25% complete (batch 46/181)
2025-12-22 21:07:47 INFO Epoch 012 | 50% complete (batch 91/181)
2025-12-22 21:07:48 INFO Epoch 012 | 75% complete (batch 136/181)
2025-12-22 21:07:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.481656
2025-12-22 21:08:02 INFO Tuning ranking metrics: regret=0.113735 spearman=0.304640 (groups=39, skipped=329)
2025-12-22 21:08:02 INFO Epoch 012 | train_mse=0.090676 | val_loss=0.119472 | best_val_loss=0.374542
2025-12-22 21:08:10 INFO Epoch 013 | 25% complete (batch 46/181)
2025-12-22 21:08:11 INFO Epoch 013 | 50% complete (batch 91/181)
2025-12-22 21:08:12 INFO Epoch 013 | 75% complete (batch 136/181)
2025-12-22 21:08:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.532666
2025-12-22 21:08:25 INFO Tuning ranking metrics: regret=0.114912 spearman=0.258669 (groups=39, skipped=329)
2025-12-22 21:08:25 INFO Epoch 013 | train_mse=0.128727 | val_loss=0.077936 | best_val_loss=0.374542
2025-12-22 21:08:34 INFO Epoch 014 | 25% complete (batch 46/181)
2025-12-22 21:08:35 INFO Epoch 014 | 50% complete (batch 91/181)
2025-12-22 21:08:35 INFO Epoch 014 | 75% complete (batch 136/181)
2025-12-22 21:08:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.541794
2025-12-22 21:08:49 INFO Tuning ranking metrics: regret=0.119308 spearman=0.222833 (groups=39, skipped=329)
2025-12-22 21:08:49 INFO Epoch 014 | train_mse=0.108828 | val_loss=0.131250 | best_val_loss=0.374542
2025-12-22 21:08:57 INFO Epoch 015 | 25% complete (batch 46/181)
2025-12-22 21:08:58 INFO Epoch 015 | 50% complete (batch 91/181)
2025-12-22 21:08:59 INFO Epoch 015 | 75% complete (batch 136/181)
2025-12-22 21:09:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.598685
2025-12-22 21:09:13 INFO Tuning ranking metrics: regret=0.124019 spearman=0.179548 (groups=39, skipped=329)
2025-12-22 21:09:13 INFO Epoch 015 | train_mse=0.095339 | val_loss=0.102814 | best_val_loss=0.374542
2025-12-22 21:09:21 INFO Epoch 016 | 25% complete (batch 46/181)
2025-12-22 21:09:22 INFO Epoch 016 | 50% complete (batch 91/181)
2025-12-22 21:09:23 INFO Epoch 016 | 75% complete (batch 136/181)
2025-12-22 21:09:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.634600
2025-12-22 21:09:36 INFO Tuning ranking metrics: regret=0.098043 spearman=0.225946 (groups=39, skipped=329)
2025-12-22 21:09:36 INFO Epoch 016 | train_mse=0.102771 | val_loss=0.088042 | best_val_loss=0.374542
2025-12-22 21:09:45 INFO Epoch 017 | 25% complete (batch 46/181)
2025-12-22 21:09:46 INFO Epoch 017 | 50% complete (batch 91/181)
2025-12-22 21:09:47 INFO Epoch 017 | 75% complete (batch 136/181)
2025-12-22 21:09:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.607208
2025-12-22 21:10:00 INFO Tuning ranking metrics: regret=0.096148 spearman=0.253541 (groups=39, skipped=329)
2025-12-22 21:10:00 INFO Epoch 017 | train_mse=0.095779 | val_loss=0.079401 | best_val_loss=0.374542
2025-12-22 21:10:09 INFO Epoch 018 | 25% complete (batch 46/181)
2025-12-22 21:10:10 INFO Epoch 018 | 50% complete (batch 91/181)
2025-12-22 21:10:11 INFO Epoch 018 | 75% complete (batch 136/181)
2025-12-22 21:10:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.637172
2025-12-22 21:10:24 INFO Tuning ranking metrics: regret=0.100267 spearman=0.233028 (groups=39, skipped=329)
2025-12-22 21:10:24 INFO Epoch 018 | train_mse=0.080577 | val_loss=0.069876 | best_val_loss=0.374542
2025-12-22 21:10:32 INFO Epoch 019 | 25% complete (batch 46/181)
2025-12-22 21:10:33 INFO Epoch 019 | 50% complete (batch 91/181)
2025-12-22 21:10:34 INFO Epoch 019 | 75% complete (batch 136/181)
2025-12-22 21:10:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.636273
2025-12-22 21:10:48 INFO Tuning ranking metrics: regret=0.110090 spearman=0.267155 (groups=39, skipped=329)
2025-12-22 21:10:48 INFO Epoch 019 | train_mse=0.085644 | val_loss=0.075957 | best_val_loss=0.374542
2025-12-22 21:10:56 INFO Epoch 020 | 25% complete (batch 46/181)
2025-12-22 21:10:57 INFO Epoch 020 | 50% complete (batch 91/181)
2025-12-22 21:10:58 INFO Epoch 020 | 75% complete (batch 136/181)
2025-12-22 21:11:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.625121
2025-12-22 21:11:12 INFO Tuning ranking metrics: regret=0.117008 spearman=0.214530 (groups=39, skipped=329)
2025-12-22 21:11:12 INFO Epoch 020 | train_mse=0.067813 | val_loss=0.069402 | best_val_loss=0.374542
2025-12-22 21:11:20 INFO Epoch 021 | 25% complete (batch 46/181)
2025-12-22 21:11:21 INFO Epoch 021 | 50% complete (batch 91/181)
2025-12-22 21:11:22 INFO Epoch 021 | 75% complete (batch 136/181)
2025-12-22 21:11:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.580669
2025-12-22 21:11:36 INFO Tuning ranking metrics: regret=0.119908 spearman=0.186752 (groups=39, skipped=329)
2025-12-22 21:11:36 INFO Epoch 021 | train_mse=0.067450 | val_loss=0.136339 | best_val_loss=0.374542
2025-12-22 21:11:44 INFO Epoch 022 | 25% complete (batch 46/181)
2025-12-22 21:11:45 INFO Epoch 022 | 50% complete (batch 91/181)
2025-12-22 21:11:46 INFO Epoch 022 | 75% complete (batch 136/181)
2025-12-22 21:11:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.667325
2025-12-22 21:11:59 INFO Tuning ranking metrics: regret=0.116573 spearman=0.236935 (groups=39, skipped=329)
2025-12-22 21:11:59 INFO Epoch 022 | train_mse=0.075045 | val_loss=0.075622 | best_val_loss=0.374542
2025-12-22 21:12:08 INFO Epoch 023 | 25% complete (batch 46/181)
2025-12-22 21:12:09 INFO Epoch 023 | 50% complete (batch 91/181)
2025-12-22 21:12:10 INFO Epoch 023 | 75% complete (batch 136/181)
2025-12-22 21:12:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.612948
2025-12-22 21:12:23 INFO Tuning ranking metrics: regret=0.084477 spearman=0.349878 (groups=39, skipped=329)
2025-12-22 21:12:23 INFO Epoch 023 | train_mse=0.100974 | val_loss=0.098308 | best_val_loss=0.374542
2025-12-22 21:12:32 INFO Epoch 024 | 25% complete (batch 46/181)
2025-12-22 21:12:32 INFO Epoch 024 | 50% complete (batch 91/181)
2025-12-22 21:12:33 INFO Epoch 024 | 75% complete (batch 136/181)
2025-12-22 21:12:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.621756
2025-12-22 21:12:47 INFO Tuning ranking metrics: regret=0.092578 spearman=0.269048 (groups=39, skipped=329)
2025-12-22 21:12:47 INFO Epoch 024 | train_mse=0.076527 | val_loss=0.086634 | best_val_loss=0.374542
2025-12-22 21:12:55 INFO Epoch 025 | 25% complete (batch 46/181)
2025-12-22 21:12:56 INFO Epoch 025 | 50% complete (batch 91/181)
2025-12-22 21:12:57 INFO Epoch 025 | 75% complete (batch 136/181)
2025-12-22 21:13:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.639798
2025-12-22 21:13:11 INFO Tuning ranking metrics: regret=0.091273 spearman=0.285653 (groups=39, skipped=329)
2025-12-22 21:13:11 INFO Epoch 025 | train_mse=0.117929 | val_loss=0.067100 | best_val_loss=0.374542
2025-12-22 21:13:19 INFO Epoch 026 | 25% complete (batch 46/181)
2025-12-22 21:13:20 INFO Epoch 026 | 50% complete (batch 91/181)
2025-12-22 21:13:21 INFO Epoch 026 | 75% complete (batch 136/181)
2025-12-22 21:13:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.662483
2025-12-22 21:13:36 INFO Tuning ranking metrics: regret=0.098293 spearman=0.235226 (groups=39, skipped=329)
2025-12-22 21:13:36 INFO Epoch 026 | train_mse=0.073287 | val_loss=0.073942 | best_val_loss=0.374542
2025-12-22 21:13:44 INFO Epoch 027 | 25% complete (batch 46/181)
2025-12-22 21:13:45 INFO Epoch 027 | 50% complete (batch 91/181)
2025-12-22 21:13:46 INFO Epoch 027 | 75% complete (batch 136/181)
2025-12-22 21:13:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.661717
2025-12-22 21:13:59 INFO Tuning ranking metrics: regret=0.098302 spearman=0.230342 (groups=39, skipped=329)
2025-12-22 21:13:59 INFO Epoch 027 | train_mse=0.089412 | val_loss=0.069158 | best_val_loss=0.374542
2025-12-22 21:14:07 INFO Epoch 028 | 25% complete (batch 46/181)
2025-12-22 21:14:08 INFO Epoch 028 | 50% complete (batch 91/181)
2025-12-22 21:14:09 INFO Epoch 028 | 75% complete (batch 136/181)
2025-12-22 21:14:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.672636
2025-12-22 21:14:23 INFO Tuning ranking metrics: regret=0.090327 spearman=0.316789 (groups=39, skipped=329)
2025-12-22 21:14:23 INFO Epoch 028 | train_mse=0.082801 | val_loss=0.073598 | best_val_loss=0.374542
2025-12-22 21:14:31 INFO Epoch 029 | 25% complete (batch 46/181)
2025-12-22 21:14:32 INFO Epoch 029 | 50% complete (batch 91/181)
2025-12-22 21:14:33 INFO Epoch 029 | 75% complete (batch 136/181)
2025-12-22 21:14:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.671866
2025-12-22 21:14:47 INFO Tuning ranking metrics: regret=0.098302 spearman=0.217094 (groups=39, skipped=329)
2025-12-22 21:14:47 INFO Epoch 029 | train_mse=0.079979 | val_loss=0.066319 | best_val_loss=0.374542
2025-12-22 21:14:57 INFO Epoch 030 | 25% complete (batch 46/181)
2025-12-22 21:14:58 INFO Epoch 030 | 50% complete (batch 91/181)
2025-12-22 21:14:59 INFO Epoch 030 | 75% complete (batch 136/181)
2025-12-22 21:15:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.679223
2025-12-22 21:15:13 INFO Tuning ranking metrics: regret=0.101148 spearman=0.179243 (groups=39, skipped=329)
2025-12-22 21:15:13 INFO Epoch 030 | train_mse=0.071844 | val_loss=0.068184 | best_val_loss=0.374542
2025-12-22 21:15:22 INFO Epoch 031 | 25% complete (batch 46/181)
2025-12-22 21:15:23 INFO Epoch 031 | 50% complete (batch 91/181)
2025-12-22 21:15:24 INFO Epoch 031 | 75% complete (batch 136/181)
2025-12-22 21:15:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.701052
2025-12-22 21:15:38 INFO Tuning ranking metrics: regret=0.099985 spearman=0.216606 (groups=39, skipped=329)
2025-12-22 21:15:38 INFO Epoch 031 | train_mse=0.103930 | val_loss=0.063744 | best_val_loss=0.374542
2025-12-22 21:15:46 INFO Epoch 032 | 25% complete (batch 46/181)
2025-12-22 21:15:47 INFO Epoch 032 | 50% complete (batch 91/181)
2025-12-22 21:15:48 INFO Epoch 032 | 75% complete (batch 136/181)
2025-12-22 21:15:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.687642
2025-12-22 21:16:01 INFO Tuning ranking metrics: regret=0.098302 spearman=0.224908 (groups=39, skipped=329)
2025-12-22 21:16:01 INFO Epoch 032 | train_mse=0.078255 | val_loss=0.073749 | best_val_loss=0.374542
2025-12-22 21:16:10 INFO Epoch 033 | 25% complete (batch 46/181)
2025-12-22 21:16:11 INFO Epoch 033 | 50% complete (batch 91/181)
2025-12-22 21:16:11 INFO Epoch 033 | 75% complete (batch 136/181)
2025-12-22 21:16:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.693082
2025-12-22 21:16:25 INFO Tuning ranking metrics: regret=0.098235 spearman=0.224786 (groups=39, skipped=329)
2025-12-22 21:16:25 INFO Epoch 033 | train_mse=0.065886 | val_loss=0.061334 | best_val_loss=0.374542
2025-12-22 21:16:33 INFO Epoch 034 | 25% complete (batch 46/181)
2025-12-22 21:16:34 INFO Epoch 034 | 50% complete (batch 91/181)
2025-12-22 21:16:35 INFO Epoch 034 | 75% complete (batch 136/181)
2025-12-22 21:16:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.687527
2025-12-22 21:16:48 INFO Tuning ranking metrics: regret=0.098234 spearman=0.239560 (groups=39, skipped=329)
2025-12-22 21:16:48 INFO Epoch 034 | train_mse=0.077124 | val_loss=0.064827 | best_val_loss=0.374542
2025-12-22 21:16:57 INFO Epoch 035 | 25% complete (batch 46/181)
2025-12-22 21:16:58 INFO Epoch 035 | 50% complete (batch 91/181)
2025-12-22 21:16:59 INFO Epoch 035 | 75% complete (batch 136/181)
2025-12-22 21:17:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.664282
2025-12-22 21:17:12 INFO Tuning ranking metrics: regret=0.111921 spearman=0.228510 (groups=39, skipped=329)
2025-12-22 21:17:12 INFO Epoch 035 | train_mse=0.053690 | val_loss=0.079621 | best_val_loss=0.374542
2025-12-22 21:17:20 INFO Epoch 036 | 25% complete (batch 46/181)
2025-12-22 21:17:21 INFO Epoch 036 | 50% complete (batch 91/181)
2025-12-22 21:17:22 INFO Epoch 036 | 75% complete (batch 136/181)
2025-12-22 21:17:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.687651
2025-12-22 21:17:36 INFO Tuning ranking metrics: regret=0.110920 spearman=0.250427 (groups=39, skipped=329)
2025-12-22 21:17:36 INFO Epoch 036 | train_mse=0.067559 | val_loss=0.061685 | best_val_loss=0.374542
2025-12-22 21:17:44 INFO Epoch 037 | 25% complete (batch 46/181)
2025-12-22 21:17:45 INFO Epoch 037 | 50% complete (batch 91/181)
2025-12-22 21:17:46 INFO Epoch 037 | 75% complete (batch 136/181)
2025-12-22 21:17:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.655835
2025-12-22 21:18:00 INFO Tuning ranking metrics: regret=0.084370 spearman=0.300061 (groups=39, skipped=329)
2025-12-22 21:18:00 INFO Epoch 037 | train_mse=0.076530 | val_loss=0.063621 | best_val_loss=0.374542
2025-12-22 21:18:08 INFO Epoch 038 | 25% complete (batch 46/181)
2025-12-22 21:18:09 INFO Epoch 038 | 50% complete (batch 91/181)
2025-12-22 21:18:10 INFO Epoch 038 | 75% complete (batch 136/181)
2025-12-22 21:18:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.644661
2025-12-22 21:18:23 INFO Tuning ranking metrics: regret=0.097298 spearman=0.236569 (groups=39, skipped=329)
2025-12-22 21:18:23 INFO Epoch 038 | train_mse=0.067571 | val_loss=0.062186 | best_val_loss=0.374542
2025-12-22 21:18:31 INFO Epoch 039 | 25% complete (batch 46/181)
2025-12-22 21:18:32 INFO Epoch 039 | 50% complete (batch 91/181)
2025-12-22 21:18:33 INFO Epoch 039 | 75% complete (batch 136/181)
2025-12-22 21:18:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.687769
2025-12-22 21:18:46 INFO Tuning ranking metrics: regret=0.097356 spearman=0.210073 (groups=39, skipped=329)
2025-12-22 21:18:46 INFO Epoch 039 | train_mse=0.076455 | val_loss=0.063512 | best_val_loss=0.374542
2025-12-22 21:18:54 INFO Epoch 040 | 25% complete (batch 46/181)
2025-12-22 21:18:55 INFO Epoch 040 | 50% complete (batch 91/181)
2025-12-22 21:18:56 INFO Epoch 040 | 75% complete (batch 136/181)
2025-12-22 21:19:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.650002
2025-12-22 21:19:10 INFO Tuning ranking metrics: regret=0.097345 spearman=0.220024 (groups=39, skipped=329)
2025-12-22 21:19:10 INFO Epoch 040 | train_mse=0.072255 | val_loss=0.063417 | best_val_loss=0.374542
2025-12-22 21:19:18 INFO Epoch 041 | 25% complete (batch 46/181)
2025-12-22 21:19:19 INFO Epoch 041 | 50% complete (batch 91/181)
2025-12-22 21:19:20 INFO Epoch 041 | 75% complete (batch 136/181)
2025-12-22 21:19:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.687068
2025-12-22 21:19:33 INFO Tuning ranking metrics: regret=0.097356 spearman=0.208608 (groups=39, skipped=329)
2025-12-22 21:19:33 INFO Epoch 041 | train_mse=0.053253 | val_loss=0.067884 | best_val_loss=0.374542
2025-12-22 21:19:42 INFO Epoch 042 | 25% complete (batch 46/181)
2025-12-22 21:19:43 INFO Epoch 042 | 50% complete (batch 91/181)
2025-12-22 21:19:43 INFO Epoch 042 | 75% complete (batch 136/181)
2025-12-22 21:19:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.658236
2025-12-22 21:19:57 INFO Tuning ranking metrics: regret=0.091435 spearman=0.216667 (groups=39, skipped=329)
2025-12-22 21:19:57 INFO Epoch 042 | train_mse=0.060464 | val_loss=0.072521 | best_val_loss=0.374542
2025-12-22 21:20:05 INFO Epoch 043 | 25% complete (batch 46/181)
2025-12-22 21:20:06 INFO Epoch 043 | 50% complete (batch 91/181)
2025-12-22 21:20:07 INFO Epoch 043 | 75% complete (batch 136/181)
2025-12-22 21:20:15 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.645724
2025-12-22 21:20:20 INFO Tuning ranking metrics: regret=0.097930 spearman=0.199817 (groups=39, skipped=329)
2025-12-22 21:20:20 INFO Epoch 043 | train_mse=0.070645 | val_loss=0.066774 | best_val_loss=0.374542
2025-12-22 21:20:29 INFO Epoch 044 | 25% complete (batch 46/181)
2025-12-22 21:20:29 INFO Epoch 044 | 50% complete (batch 91/181)
2025-12-22 21:20:30 INFO Epoch 044 | 75% complete (batch 136/181)
2025-12-22 21:20:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.671235
2025-12-22 21:20:44 INFO Tuning ranking metrics: regret=0.097930 spearman=0.199451 (groups=39, skipped=329)
2025-12-22 21:20:44 INFO Epoch 044 | train_mse=0.073420 | val_loss=0.061467 | best_val_loss=0.374542
2025-12-22 21:20:52 INFO Epoch 045 | 25% complete (batch 46/181)
2025-12-22 21:20:53 INFO Epoch 045 | 50% complete (batch 91/181)
2025-12-22 21:20:54 INFO Epoch 045 | 75% complete (batch 136/181)
2025-12-22 21:21:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.695477
2025-12-22 21:21:07 INFO Tuning ranking metrics: regret=0.097930 spearman=0.187363 (groups=39, skipped=329)
2025-12-22 21:21:07 INFO Epoch 045 | train_mse=0.072269 | val_loss=0.064640 | best_val_loss=0.374542
2025-12-22 21:21:15 INFO Epoch 046 | 25% complete (batch 46/181)
2025-12-22 21:21:16 INFO Epoch 046 | 50% complete (batch 91/181)
2025-12-22 21:21:17 INFO Epoch 046 | 75% complete (batch 136/181)
2025-12-22 21:21:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.673436
2025-12-22 21:21:31 INFO Tuning ranking metrics: regret=0.111490 spearman=0.213736 (groups=39, skipped=329)
2025-12-22 21:21:31 INFO Epoch 046 | train_mse=0.055202 | val_loss=0.061748 | best_val_loss=0.374542
2025-12-22 21:21:39 INFO Epoch 047 | 25% complete (batch 46/181)
2025-12-22 21:21:40 INFO Epoch 047 | 50% complete (batch 91/181)
2025-12-22 21:21:41 INFO Epoch 047 | 75% complete (batch 136/181)
2025-12-22 21:21:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.681162
2025-12-22 21:21:54 INFO Tuning ranking metrics: regret=0.113647 spearman=0.207448 (groups=39, skipped=329)
2025-12-22 21:21:54 INFO Epoch 047 | train_mse=0.060757 | val_loss=0.059052 | best_val_loss=0.374542
2025-12-22 21:22:03 INFO Epoch 048 | 25% complete (batch 46/181)
2025-12-22 21:22:04 INFO Epoch 048 | 50% complete (batch 91/181)
2025-12-22 21:22:05 INFO Epoch 048 | 75% complete (batch 136/181)
2025-12-22 21:22:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.687673
2025-12-22 21:22:18 INFO Tuning ranking metrics: regret=0.113238 spearman=0.210745 (groups=39, skipped=329)
2025-12-22 21:22:18 INFO Epoch 048 | train_mse=0.068857 | val_loss=0.066692 | best_val_loss=0.374542
Monitored metric tuning_rank_spearman did not improve in the last 40 records. Best score: 0.375. Signaling Trainer to stop.
2025-12-22 21:22:19 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.32125_val-0.09989_epoch011.chkpt, checkpoint.tuning_rank_spearman-0.34988_val-0.09831_epoch023.chkpt, checkpoint.tuning_rank_spearman-0.37454_val-0.11158_epoch008.chkpt
2025-12-22 21:22:19 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-22_21-02-50/model_checkpoints/checkpoint.tuning_rank_spearman-0.37454_val-0.11158_epoch008.chkpt
2025-12-22 21:22:19 INFO Best validation loss: tensor(0.3745)
2025-12-22 21:22:19 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-22_21-02-50/model_checkpoints/checkpoint.tuning_rank_spearman-0.37454_val-0.11158_epoch008.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-22_21-02-50/model_checkpoints/checkpoint.tuning_rank_spearman-0.37454_val-0.11158_epoch008.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-22 21:22:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.111576
2025-12-22 21:22:31 INFO Tuning ranking metrics: regret=0.090803 spearman=0.374542 (groups=39, skipped=329)
2025-12-22 21:22:31 INFO Epoch 049 | val_loss=0.111576 | best_val_loss=0.374542
2025-12-22 21:22:32 INFO Validation metrics: [{'val_loss': 0.11157618463039398, 'tuning_rank_regret': 0.09080345183610916, 'tuning_rank_spearman': 0.37454211711883545, 'val_pearson_corr': 0.5519468784332275, 'val_spearman_corr': 0.5802195072174072, 'val_rank_regret': 0.0033600511960685253, 'val_rank_spearman': 0.8888888955116272}]
2025-12-22 21:22:32 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.37454_val-0.11158_epoch008.chkpt
2025-12-22 21:22:32 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.32125_val-0.09989_epoch011.chkpt
2025-12-22 21:22:32 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.34988_val-0.09831_epoch023.chkpt
2025-12-22 21:22:32 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.12050_epoch005.ckpt
2025-12-22 21:22:32 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.09080345183610916
  tuning_rank_spearman      0.37454211711883545
        val_loss            0.11157618463039398
    val_pearson_corr        0.5519468784332275
     val_rank_regret       0.0033600511960685253
    val_rank_spearman       0.8888888955116272
    val_spearman_corr       0.5802195072174072
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run polish_seed555_2025-12-22_21-02-50 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-22_21-02-50
[train_cli][batch] job 'polish_seed555' finished.
[train_cli][batch] (4/6) running job 'polish_lr_low_seed555' -> run_name=polish_lr_low_seed555_2025-12-22_21-22-34
[train_cli] run_id=polish_lr_low_seed555_2025-12-22_21-22-34 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-22_21-22-34/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-22_21-22-34 --git-commit 150d1dcbd1 --git-dirty
2025-12-22 21:22:37 INFO git_commit = 150d1dcbd1 (dirty)
2025-12-22 21:22:37 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-22 21:22:37 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-22_21-22-34/config/config.yaml
2025-12-22 21:22:37 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data
2025-12-22 21:22:37 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-22 21:22:37 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-22 21:22:37 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-22_21-22-34
2025-12-22 21:22:37 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-22 21:22:37 INFO   metadata_path = None
2025-12-22 21:22:37 INFO   summary_path = None
2025-12-22 21:22:37 INFO   accelerator = cpu
2025-12-22 21:22:37 INFO   devices = 1
2025-12-22 21:22:37 INFO   attention_head = 8
2025-12-22 21:22:37 INFO   pooling_type = mean
2025-12-22 21:22:37 INFO   model_self_loops = False
2025-12-22 21:22:37 INFO   model_self_loop_fill = mean
2025-12-22 21:22:37 INFO   model_residual = False
2025-12-22 21:22:37 INFO   batch_size = 12
2025-12-22 21:22:37 INFO   learning_rate = 0.002
2025-12-22 21:22:37 INFO   num_epochs = 360
2025-12-22 21:22:37 INFO   accumulate_grad_batches = 48
2025-12-22 21:22:37 INFO   seed = 555
2025-12-22 21:22:37 INFO   num_workers = 2
2025-12-22 21:22:37 INFO   precision = 32
2025-12-22 21:22:37 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-22 21:22:37 INFO   early_stopping_patience = 50
2025-12-22 21:22:37 INFO   lr_scheduler_patience = 25
2025-12-22 21:22:37 INFO   lr_scheduler_factor = 0.3
2025-12-22 21:22:37 INFO   fast_dev_run = False
2025-12-22 21:22:37 INFO   limit_train_batches = None
2025-12-22 21:22:37 INFO   limit_val_batches = None
2025-12-22 21:22:37 INFO   log_lr = False
2025-12-22 21:22:37 INFO   progress_bar_refresh_rate = 0
2025-12-22 21:22:37 INFO   log_every_n_steps = 100
2025-12-22 21:22:37 INFO   use_val_spearman_as_secondary = True
2025-12-22 21:22:37 INFO   spearman_secondary_min_delta = 0.0
2025-12-22 21:22:37 INFO   spearman_secondary_weight = 1.0
2025-12-22 21:22:37 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-22 21:22:37 INFO   tuning_max_samples = 500
2025-12-22 21:22:37 INFO   tuning_fraction = None
2025-12-22 21:22:37 INFO   tuning_eval_every = 1
2025-12-22 21:22:37 INFO   rank_loss_weight = 0.0
2025-12-22 21:22:37 INFO   rank_loss_margin = 0.0
2025-12-22 21:22:37 INFO   rank_loss_mode = hinge
2025-12-22 21:22:37 INFO   rank_loss_grouped = True
2025-12-22 21:22:37 INFO   variance_reduction_enabled = False
2025-12-22 21:22:37 INFO   variance_reduction_method = topk_avg
2025-12-22 21:22:37 INFO   variance_reduction_top_k = 3
2025-12-22 21:22:37 INFO   coverage_minimum = 0.0
2025-12-22 21:22:37 INFO   coverage_fail_on_missing = False
2025-12-22 21:22:37 INFO   graph_load_profiling = False
2025-12-22 21:22:37 INFO   graph_load_top_k = 5
2025-12-22 21:22:37 INFO   enable_graph_cache = True
2025-12-22 21:22:37 INFO   graph_cache_size = 256
2025-12-22 21:22:37 INFO   canonicalize_on_load = False
2025-12-22 21:22:37 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-22 21:22:37 INFO   edge_schema = {}
2025-12-22 21:22:37 INFO   topology_schema = {}
Seed set to 555
2025-12-22 21:22:38 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-22 21:22:38 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 21:22:38 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-22 21:22:38 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 21:22:38 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-22 21:22:38 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 21:22:38 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-22 21:22:38 INFO Tuning group stats: groups=368 groups>=2=39 singletons=329 max_group=9
2025-12-22 21:22:38 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-22_21-22-34/dataset_coverage.json
2025-12-22 21:22:38 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-22_21-22-34/dataset_coverage.json for details.
2025-12-22 21:22:38 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-22_21-22-34/dataset_coverage.json for details.
2025-12-22 21:22:38 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-22_21-22-34/dataset_coverage.json for details.
2025-12-22 21:22:38 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-22_21-22-34/schema_summary.json
2025-12-22 21:22:38 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-22_21-22-34/feature_metadata.json
2025-12-22 21:22:38 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-22 21:22:38 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/feature-config.yaml.topoqa.10A.2, sha256=5c62898155179232a565e24d9fbd7b208f9ce480d1a19d6139de19454e173ff0
2025-12-22 21:22:38 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/work/edge_features)
2025-12-22 21:22:38 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json
2025-12-22 21:22:38 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-22_21-22-34/schema_summary.json
2025-12-22 21:22:38 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-22 21:22:38 INFO Topology: topology/persistence_basic/v1 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 172-dimensional node features.
2025-12-22 21:22:38 INFO Node: node/dssp_topo_merge/v1; metadata lists 172 feature columns matching the .pt tensor.
2025-12-22 21:22:38 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-22 21:22:38 INFO → Total feature dimensionality observed and confirmed: node_dim = 172, edge_dim = 11.
2025-12-22 21:22:38 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-22 21:22:38 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 172,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 172,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-22_21-22-34/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge/v1",
      "alias": "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA",
      "jobs": 16,
      "summary": "DSSP-derived node features merged with topology statistics."
    },
    "topology": {
      "id": "topology/persistence_basic/v1",
      "alias": "Betti 0 and Betti 1 topology summaries on interface coords = 140D PH | TopoQA",
      "jobs": 16,
      "summary": "Persistent homology features with configurable distance thresholds."
    }
  },
  "notes": []
}
2025-12-22 21:22:38 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-22 21:22:39 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=279002b026a448a5a5f3b9f94b50b069)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-22 21:22:39 INFO Starting training (fast_dev_run=False)
2025-12-22 21:22:39 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-22_21-22-34/model_checkpoints exists and is not empty.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 5.5 K  | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
165 K     Trainable params
0         Non-trainable params
165 K     Total params
0.662     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-22 21:22:55 INFO Epoch 000 | 25% complete (batch 181/724)
2025-12-22 21:22:58 INFO Epoch 000 | 50% complete (batch 362/724)
2025-12-22 21:23:01 INFO Epoch 000 | 75% complete (batch 543/724)
2025-12-22 21:23:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.147090
2025-12-22 21:23:18 INFO Tuning ranking metrics: regret=0.157394 spearman=-0.065812 (groups=39, skipped=329)
2025-12-22 21:23:18 INFO Epoch 000 | val_loss=0.147090
Metric tuning_rank_spearman improved. New best score: -0.066
2025-12-22 21:23:29 INFO Epoch 001 | 25% complete (batch 181/724)
2025-12-22 21:23:32 INFO Epoch 001 | 50% complete (batch 362/724)
2025-12-22 21:23:35 INFO Epoch 001 | 75% complete (batch 543/724)
2025-12-22 21:23:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.005487
2025-12-22 21:23:53 INFO Tuning ranking metrics: regret=0.169296 spearman=-0.052625 (groups=39, skipped=329)
2025-12-22 21:23:53 INFO Epoch 001 | train_mse=0.152119 | val_loss=0.144748 | best_val_loss=-0.065812
Metric tuning_rank_spearman improved by 0.013 >= min_delta = 0.0. New best score: -0.053
2025-12-22 21:24:04 INFO Epoch 002 | 25% complete (batch 181/724)
2025-12-22 21:24:07 INFO Epoch 002 | 50% complete (batch 362/724)
2025-12-22 21:24:10 INFO Epoch 002 | 75% complete (batch 543/724)
2025-12-22 21:24:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.240064
2025-12-22 21:24:28 INFO Tuning ranking metrics: regret=0.139627 spearman=0.047985 (groups=39, skipped=329)
2025-12-22 21:24:28 INFO Epoch 002 | train_mse=0.145717 | val_loss=0.145727 | best_val_loss=-0.052625
Metric tuning_rank_spearman improved by 0.101 >= min_delta = 0.0. New best score: 0.048
2025-12-22 21:24:38 INFO Epoch 003 | 25% complete (batch 181/724)
2025-12-22 21:24:41 INFO Epoch 003 | 50% complete (batch 362/724)
2025-12-22 21:24:45 INFO Epoch 003 | 75% complete (batch 543/724)
2025-12-22 21:24:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.311781
2025-12-22 21:25:03 INFO Tuning ranking metrics: regret=0.159825 spearman=0.146398 (groups=39, skipped=329)
2025-12-22 21:25:03 INFO Epoch 003 | train_mse=0.145042 | val_loss=0.147361 | best_val_loss=0.047985
Metric tuning_rank_spearman improved by 0.098 >= min_delta = 0.0. New best score: 0.146
2025-12-22 21:25:14 INFO Epoch 004 | 25% complete (batch 181/724)
2025-12-22 21:25:17 INFO Epoch 004 | 50% complete (batch 362/724)
2025-12-22 21:25:20 INFO Epoch 004 | 75% complete (batch 543/724)
2025-12-22 21:25:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.395952
2025-12-22 21:25:38 INFO Tuning ranking metrics: regret=0.133767 spearman=0.136142 (groups=39, skipped=329)
2025-12-22 21:25:38 INFO Epoch 004 | train_mse=0.140000 | val_loss=0.130320 | best_val_loss=0.146398
2025-12-22 21:25:48 INFO Epoch 005 | 25% complete (batch 181/724)
2025-12-22 21:25:51 INFO Epoch 005 | 50% complete (batch 362/724)
2025-12-22 21:25:54 INFO Epoch 005 | 75% complete (batch 543/724)
2025-12-22 21:26:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.469153
2025-12-22 21:26:13 INFO Tuning ranking metrics: regret=0.114495 spearman=0.211294 (groups=39, skipped=329)
2025-12-22 21:26:13 INFO Epoch 005 | train_mse=0.135640 | val_loss=0.095228 | best_val_loss=0.146398
Metric tuning_rank_spearman improved by 0.065 >= min_delta = 0.0. New best score: 0.211
2025-12-22 21:26:24 INFO Epoch 006 | 25% complete (batch 181/724)
2025-12-22 21:26:27 INFO Epoch 006 | 50% complete (batch 362/724)
2025-12-22 21:26:30 INFO Epoch 006 | 75% complete (batch 543/724)
2025-12-22 21:26:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.527945
2025-12-22 21:26:49 INFO Tuning ranking metrics: regret=0.114034 spearman=0.278877 (groups=39, skipped=329)
2025-12-22 21:26:49 INFO Epoch 006 | train_mse=0.096062 | val_loss=0.080880 | best_val_loss=0.211294
Metric tuning_rank_spearman improved by 0.068 >= min_delta = 0.0. New best score: 0.279
2025-12-22 21:26:59 INFO Epoch 007 | 25% complete (batch 181/724)
2025-12-22 21:27:02 INFO Epoch 007 | 50% complete (batch 362/724)
2025-12-22 21:27:05 INFO Epoch 007 | 75% complete (batch 543/724)
2025-12-22 21:27:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.541857
2025-12-22 21:27:24 INFO Tuning ranking metrics: regret=0.111527 spearman=0.310562 (groups=39, skipped=329)
2025-12-22 21:27:24 INFO Epoch 007 | train_mse=0.088589 | val_loss=0.081557 | best_val_loss=0.278877
Metric tuning_rank_spearman improved by 0.032 >= min_delta = 0.0. New best score: 0.311
2025-12-22 21:27:35 INFO Epoch 008 | 25% complete (batch 181/724)
2025-12-22 21:27:38 INFO Epoch 008 | 50% complete (batch 362/724)
2025-12-22 21:27:41 INFO Epoch 008 | 75% complete (batch 543/724)
2025-12-22 21:27:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.550412
2025-12-22 21:27:59 INFO Tuning ranking metrics: regret=0.110499 spearman=0.353663 (groups=39, skipped=329)
2025-12-22 21:27:59 INFO Epoch 008 | train_mse=0.088239 | val_loss=0.079698 | best_val_loss=0.310562
Metric tuning_rank_spearman improved by 0.043 >= min_delta = 0.0. New best score: 0.354
2025-12-22 21:28:09 INFO Epoch 009 | 25% complete (batch 181/724)
2025-12-22 21:28:13 INFO Epoch 009 | 50% complete (batch 362/724)
2025-12-22 21:28:16 INFO Epoch 009 | 75% complete (batch 543/724)
2025-12-22 21:28:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.560632
2025-12-22 21:28:34 INFO Tuning ranking metrics: regret=0.122485 spearman=0.350305 (groups=39, skipped=329)
2025-12-22 21:28:34 INFO Epoch 009 | train_mse=0.085794 | val_loss=0.078714 | best_val_loss=0.353663
2025-12-22 21:28:44 INFO Epoch 010 | 25% complete (batch 181/724)
2025-12-22 21:28:47 INFO Epoch 010 | 50% complete (batch 362/724)
2025-12-22 21:28:51 INFO Epoch 010 | 75% complete (batch 543/724)
2025-12-22 21:29:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.566522
2025-12-22 21:29:08 INFO Tuning ranking metrics: regret=0.123459 spearman=0.276862 (groups=39, skipped=329)
2025-12-22 21:29:08 INFO Epoch 010 | train_mse=0.088976 | val_loss=0.085515 | best_val_loss=0.353663
2025-12-22 21:29:19 INFO Epoch 011 | 25% complete (batch 181/724)
2025-12-22 21:29:22 INFO Epoch 011 | 50% complete (batch 362/724)
2025-12-22 21:29:25 INFO Epoch 011 | 75% complete (batch 543/724)
2025-12-22 21:29:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.584862
2025-12-22 21:29:43 INFO Tuning ranking metrics: regret=0.117671 spearman=0.283516 (groups=39, skipped=329)
2025-12-22 21:29:43 INFO Epoch 011 | train_mse=0.079213 | val_loss=0.073000 | best_val_loss=0.353663
2025-12-22 21:29:54 INFO Epoch 012 | 25% complete (batch 181/724)
2025-12-22 21:29:57 INFO Epoch 012 | 50% complete (batch 362/724)
2025-12-22 21:30:00 INFO Epoch 012 | 75% complete (batch 543/724)
2025-12-22 21:30:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.511669
2025-12-22 21:30:18 INFO Tuning ranking metrics: regret=0.097733 spearman=0.374786 (groups=39, skipped=329)
2025-12-22 21:30:18 INFO Epoch 012 | train_mse=0.076194 | val_loss=0.141950 | best_val_loss=0.353663
Metric tuning_rank_spearman improved by 0.021 >= min_delta = 0.0. New best score: 0.375
2025-12-22 21:30:29 INFO Epoch 013 | 25% complete (batch 181/724)
2025-12-22 21:30:32 INFO Epoch 013 | 50% complete (batch 362/724)
2025-12-22 21:30:35 INFO Epoch 013 | 75% complete (batch 543/724)
2025-12-22 21:30:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.567104
2025-12-22 21:30:54 INFO Tuning ranking metrics: regret=0.123488 spearman=0.269841 (groups=39, skipped=329)
2025-12-22 21:30:54 INFO Epoch 013 | train_mse=0.070151 | val_loss=0.082411 | best_val_loss=0.374786
2025-12-22 21:31:04 INFO Epoch 014 | 25% complete (batch 181/724)
2025-12-22 21:31:07 INFO Epoch 014 | 50% complete (batch 362/724)
2025-12-22 21:31:11 INFO Epoch 014 | 75% complete (batch 543/724)
2025-12-22 21:31:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.601841
2025-12-22 21:31:29 INFO Tuning ranking metrics: regret=0.104495 spearman=0.289377 (groups=39, skipped=329)
2025-12-22 21:31:29 INFO Epoch 014 | train_mse=0.086948 | val_loss=0.069721 | best_val_loss=0.374786
2025-12-22 21:31:40 INFO Epoch 015 | 25% complete (batch 181/724)
2025-12-22 21:31:43 INFO Epoch 015 | 50% complete (batch 362/724)
2025-12-22 21:31:46 INFO Epoch 015 | 75% complete (batch 543/724)
2025-12-22 21:31:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.607225
2025-12-22 21:32:05 INFO Tuning ranking metrics: regret=0.106741 spearman=0.266361 (groups=39, skipped=329)
2025-12-22 21:32:05 INFO Epoch 015 | train_mse=0.062558 | val_loss=0.072260 | best_val_loss=0.374786
2025-12-22 21:32:15 INFO Epoch 016 | 25% complete (batch 181/724)
2025-12-22 21:32:18 INFO Epoch 016 | 50% complete (batch 362/724)
2025-12-22 21:32:21 INFO Epoch 016 | 75% complete (batch 543/724)
2025-12-22 21:32:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.598312
2025-12-22 21:32:39 INFO Tuning ranking metrics: regret=0.098707 spearman=0.307143 (groups=39, skipped=329)
2025-12-22 21:32:39 INFO Epoch 016 | train_mse=0.076343 | val_loss=0.089252 | best_val_loss=0.374786
2025-12-22 21:32:50 INFO Epoch 017 | 25% complete (batch 181/724)
2025-12-22 21:32:53 INFO Epoch 017 | 50% complete (batch 362/724)
2025-12-22 21:32:56 INFO Epoch 017 | 75% complete (batch 543/724)
2025-12-22 21:33:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.601230
2025-12-22 21:33:15 INFO Tuning ranking metrics: regret=0.114272 spearman=0.275946 (groups=39, skipped=329)
2025-12-22 21:33:15 INFO Epoch 017 | train_mse=0.067992 | val_loss=0.079796 | best_val_loss=0.374786
2025-12-22 21:33:25 INFO Epoch 018 | 25% complete (batch 181/724)
2025-12-22 21:33:28 INFO Epoch 018 | 50% complete (batch 362/724)
2025-12-22 21:33:32 INFO Epoch 018 | 75% complete (batch 543/724)
2025-12-22 21:33:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.613870
2025-12-22 21:33:50 INFO Tuning ranking metrics: regret=0.117452 spearman=0.256838 (groups=39, skipped=329)
2025-12-22 21:33:50 INFO Epoch 018 | train_mse=0.077022 | val_loss=0.069613 | best_val_loss=0.374786
2025-12-22 21:34:01 INFO Epoch 019 | 25% complete (batch 181/724)
2025-12-22 21:34:04 INFO Epoch 019 | 50% complete (batch 362/724)
2025-12-22 21:34:07 INFO Epoch 019 | 75% complete (batch 543/724)
2025-12-22 21:34:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.616320
2025-12-22 21:34:26 INFO Tuning ranking metrics: regret=0.106721 spearman=0.264408 (groups=39, skipped=329)
2025-12-22 21:34:26 INFO Epoch 019 | train_mse=0.068997 | val_loss=0.070205 | best_val_loss=0.374786
2025-12-22 21:34:36 INFO Epoch 020 | 25% complete (batch 181/724)
2025-12-22 21:34:39 INFO Epoch 020 | 50% complete (batch 362/724)
2025-12-22 21:34:43 INFO Epoch 020 | 75% complete (batch 543/724)
2025-12-22 21:34:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.613271
2025-12-22 21:35:01 INFO Tuning ranking metrics: regret=0.132501 spearman=0.186691 (groups=39, skipped=329)
2025-12-22 21:35:01 INFO Epoch 020 | train_mse=0.070460 | val_loss=0.079004 | best_val_loss=0.374786
2025-12-22 21:35:11 INFO Epoch 021 | 25% complete (batch 181/724)
2025-12-22 21:35:14 INFO Epoch 021 | 50% complete (batch 362/724)
2025-12-22 21:35:18 INFO Epoch 021 | 75% complete (batch 543/724)
2025-12-22 21:35:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.639387
2025-12-22 21:35:36 INFO Tuning ranking metrics: regret=0.107674 spearman=0.244567 (groups=39, skipped=329)
2025-12-22 21:35:36 INFO Epoch 021 | train_mse=0.059507 | val_loss=0.065260 | best_val_loss=0.374786
2025-12-22 21:35:46 INFO Epoch 022 | 25% complete (batch 181/724)
2025-12-22 21:35:49 INFO Epoch 022 | 50% complete (batch 362/724)
2025-12-22 21:35:52 INFO Epoch 022 | 75% complete (batch 543/724)
2025-12-22 21:36:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.627313
2025-12-22 21:36:11 INFO Tuning ranking metrics: regret=0.119736 spearman=0.144689 (groups=39, skipped=329)
2025-12-22 21:36:11 INFO Epoch 022 | train_mse=0.069176 | val_loss=0.074644 | best_val_loss=0.374786
2025-12-22 21:36:21 INFO Epoch 023 | 25% complete (batch 181/724)
2025-12-22 21:36:24 INFO Epoch 023 | 50% complete (batch 362/724)
2025-12-22 21:36:27 INFO Epoch 023 | 75% complete (batch 543/724)
2025-12-22 21:36:40 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.645919
2025-12-22 21:36:46 INFO Tuning ranking metrics: regret=0.112653 spearman=0.214286 (groups=39, skipped=329)
2025-12-22 21:36:46 INFO Epoch 023 | train_mse=0.058318 | val_loss=0.067873 | best_val_loss=0.374786
2025-12-22 21:36:56 INFO Epoch 024 | 25% complete (batch 181/724)
2025-12-22 21:37:00 INFO Epoch 024 | 50% complete (batch 362/724)
2025-12-22 21:37:03 INFO Epoch 024 | 75% complete (batch 543/724)
2025-12-22 21:37:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.632226
2025-12-22 21:37:21 INFO Tuning ranking metrics: regret=0.118681 spearman=0.182967 (groups=39, skipped=329)
2025-12-22 21:37:21 INFO Epoch 024 | train_mse=0.065574 | val_loss=0.068436 | best_val_loss=0.374786
2025-12-22 21:37:32 INFO Epoch 025 | 25% complete (batch 181/724)
2025-12-22 21:37:35 INFO Epoch 025 | 50% complete (batch 362/724)
2025-12-22 21:37:38 INFO Epoch 025 | 75% complete (batch 543/724)
2025-12-22 21:37:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.632979
2025-12-22 21:37:57 INFO Tuning ranking metrics: regret=0.114968 spearman=0.181013 (groups=39, skipped=329)
2025-12-22 21:37:57 INFO Epoch 025 | train_mse=0.054955 | val_loss=0.067307 | best_val_loss=0.374786
2025-12-22 21:38:07 INFO Epoch 026 | 25% complete (batch 181/724)
2025-12-22 21:38:10 INFO Epoch 026 | 50% complete (batch 362/724)
2025-12-22 21:38:14 INFO Epoch 026 | 75% complete (batch 543/724)
2025-12-22 21:38:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.644272
2025-12-22 21:38:32 INFO Tuning ranking metrics: regret=0.103754 spearman=0.221001 (groups=39, skipped=329)
2025-12-22 21:38:32 INFO Epoch 026 | train_mse=0.061824 | val_loss=0.064007 | best_val_loss=0.374786
2025-12-22 21:38:42 INFO Epoch 027 | 25% complete (batch 181/724)
2025-12-22 21:38:46 INFO Epoch 027 | 50% complete (batch 362/724)
2025-12-22 21:38:49 INFO Epoch 027 | 75% complete (batch 543/724)
2025-12-22 21:39:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.655378
2025-12-22 21:39:07 INFO Tuning ranking metrics: regret=0.106934 spearman=0.217033 (groups=39, skipped=329)
2025-12-22 21:39:07 INFO Epoch 027 | train_mse=0.065019 | val_loss=0.071442 | best_val_loss=0.374786
2025-12-22 21:39:18 INFO Epoch 028 | 25% complete (batch 181/724)
2025-12-22 21:39:21 INFO Epoch 028 | 50% complete (batch 362/724)
2025-12-22 21:39:25 INFO Epoch 028 | 75% complete (batch 543/724)
2025-12-22 21:39:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.656329
2025-12-22 21:39:43 INFO Tuning ranking metrics: regret=0.103754 spearman=0.221245 (groups=39, skipped=329)
2025-12-22 21:39:43 INFO Epoch 028 | train_mse=0.063113 | val_loss=0.080373 | best_val_loss=0.374786
2025-12-22 21:39:54 INFO Epoch 029 | 25% complete (batch 181/724)
2025-12-22 21:39:57 INFO Epoch 029 | 50% complete (batch 362/724)
2025-12-22 21:40:00 INFO Epoch 029 | 75% complete (batch 543/724)
2025-12-22 21:40:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.662996
2025-12-22 21:40:18 INFO Tuning ranking metrics: regret=0.114491 spearman=0.152869 (groups=39, skipped=329)
2025-12-22 21:40:18 INFO Epoch 029 | train_mse=0.061479 | val_loss=0.062234 | best_val_loss=0.374786
2025-12-22 21:40:29 INFO Epoch 030 | 25% complete (batch 181/724)
2025-12-22 21:40:32 INFO Epoch 030 | 50% complete (batch 362/724)
2025-12-22 21:40:35 INFO Epoch 030 | 75% complete (batch 543/724)
2025-12-22 21:40:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.671526
2025-12-22 21:40:53 INFO Tuning ranking metrics: regret=0.121600 spearman=0.127595 (groups=39, skipped=329)
2025-12-22 21:40:53 INFO Epoch 030 | train_mse=0.061844 | val_loss=0.066164 | best_val_loss=0.374786
2025-12-22 21:41:03 INFO Epoch 031 | 25% complete (batch 181/724)
2025-12-22 21:41:06 INFO Epoch 031 | 50% complete (batch 362/724)
2025-12-22 21:41:10 INFO Epoch 031 | 75% complete (batch 543/724)
2025-12-22 21:41:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.680931
2025-12-22 21:41:28 INFO Tuning ranking metrics: regret=0.113565 spearman=0.144628 (groups=39, skipped=329)
2025-12-22 21:41:28 INFO Epoch 031 | train_mse=0.063804 | val_loss=0.057719 | best_val_loss=0.374786
2025-12-22 21:41:39 INFO Epoch 032 | 25% complete (batch 181/724)
2025-12-22 21:41:42 INFO Epoch 032 | 50% complete (batch 362/724)
2025-12-22 21:41:46 INFO Epoch 032 | 75% complete (batch 543/724)
2025-12-22 21:41:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.670397
2025-12-22 21:42:04 INFO Tuning ranking metrics: regret=0.114570 spearman=0.147375 (groups=39, skipped=329)
2025-12-22 21:42:04 INFO Epoch 032 | train_mse=0.059549 | val_loss=0.072492 | best_val_loss=0.374786
2025-12-22 21:42:14 INFO Epoch 033 | 25% complete (batch 181/724)
2025-12-22 21:42:18 INFO Epoch 033 | 50% complete (batch 362/724)
2025-12-22 21:42:21 INFO Epoch 033 | 75% complete (batch 543/724)
2025-12-22 21:42:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.659146
2025-12-22 21:42:39 INFO Tuning ranking metrics: regret=0.101014 spearman=0.229731 (groups=39, skipped=329)
2025-12-22 21:42:39 INFO Epoch 033 | train_mse=0.054437 | val_loss=0.065679 | best_val_loss=0.374786
2025-12-22 21:42:50 INFO Epoch 034 | 25% complete (batch 181/724)
2025-12-22 21:42:53 INFO Epoch 034 | 50% complete (batch 362/724)
2025-12-22 21:42:57 INFO Epoch 034 | 75% complete (batch 543/724)
2025-12-22 21:43:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.653954
2025-12-22 21:43:15 INFO Tuning ranking metrics: regret=0.108692 spearman=0.203541 (groups=39, skipped=329)
2025-12-22 21:43:15 INFO Epoch 034 | train_mse=0.070506 | val_loss=0.061658 | best_val_loss=0.374786
2025-12-22 21:43:25 INFO Epoch 035 | 25% complete (batch 181/724)
2025-12-22 21:43:29 INFO Epoch 035 | 50% complete (batch 362/724)
2025-12-22 21:43:32 INFO Epoch 035 | 75% complete (batch 543/724)
2025-12-22 21:43:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.678343
2025-12-22 21:43:50 INFO Tuning ranking metrics: regret=0.100092 spearman=0.232234 (groups=39, skipped=329)
2025-12-22 21:43:50 INFO Epoch 035 | train_mse=0.059516 | val_loss=0.055620 | best_val_loss=0.374786
2025-12-22 21:44:01 INFO Epoch 036 | 25% complete (batch 181/724)
2025-12-22 21:44:04 INFO Epoch 036 | 50% complete (batch 362/724)
2025-12-22 21:44:08 INFO Epoch 036 | 75% complete (batch 543/724)
2025-12-22 21:44:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.680119
2025-12-22 21:44:26 INFO Tuning ranking metrics: regret=0.111842 spearman=0.159341 (groups=39, skipped=329)
2025-12-22 21:44:26 INFO Epoch 036 | train_mse=0.059359 | val_loss=0.054358 | best_val_loss=0.374786
2025-12-22 21:44:37 INFO Epoch 037 | 25% complete (batch 181/724)
2025-12-22 21:44:40 INFO Epoch 037 | 50% complete (batch 362/724)
2025-12-22 21:44:43 INFO Epoch 037 | 75% complete (batch 543/724)
2025-12-22 21:44:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.655897
2025-12-22 21:45:01 INFO Tuning ranking metrics: regret=0.093092 spearman=0.285836 (groups=39, skipped=329)
2025-12-22 21:45:01 INFO Epoch 037 | train_mse=0.054581 | val_loss=0.096096 | best_val_loss=0.374786
2025-12-22 21:45:12 INFO Epoch 038 | 25% complete (batch 181/724)
2025-12-22 21:45:15 INFO Epoch 038 | 50% complete (batch 362/724)
2025-12-22 21:45:18 INFO Epoch 038 | 75% complete (batch 543/724)
2025-12-22 21:45:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.668134
2025-12-22 21:45:37 INFO Tuning ranking metrics: regret=0.105474 spearman=0.151954 (groups=39, skipped=329)
2025-12-22 21:45:37 INFO Epoch 038 | train_mse=0.058820 | val_loss=0.062118 | best_val_loss=0.374786
2025-12-22 21:45:47 INFO Epoch 039 | 25% complete (batch 181/724)
2025-12-22 21:45:50 INFO Epoch 039 | 50% complete (batch 362/724)
2025-12-22 21:45:54 INFO Epoch 039 | 75% complete (batch 543/724)
2025-12-22 21:46:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.694693
2025-12-22 21:46:12 INFO Tuning ranking metrics: regret=0.100092 spearman=0.234249 (groups=39, skipped=329)
2025-12-22 21:46:12 INFO Epoch 039 | train_mse=0.072967 | val_loss=0.058731 | best_val_loss=0.374786
2025-12-22 21:46:23 INFO Epoch 040 | 25% complete (batch 181/724)
2025-12-22 21:46:26 INFO Epoch 040 | 50% complete (batch 362/724)
2025-12-22 21:46:30 INFO Epoch 040 | 75% complete (batch 543/724)
2025-12-22 21:46:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.700422
2025-12-22 21:46:48 INFO Tuning ranking metrics: regret=0.101113 spearman=0.194261 (groups=39, skipped=329)
2025-12-22 21:46:48 INFO Epoch 040 | train_mse=0.056285 | val_loss=0.055236 | best_val_loss=0.374786
2025-12-22 21:46:58 INFO Epoch 041 | 25% complete (batch 181/724)
2025-12-22 21:47:02 INFO Epoch 041 | 50% complete (batch 362/724)
2025-12-22 21:47:05 INFO Epoch 041 | 75% complete (batch 543/724)
2025-12-22 21:47:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.710683
2025-12-22 21:47:24 INFO Tuning ranking metrics: regret=0.101775 spearman=0.231685 (groups=39, skipped=329)
2025-12-22 21:47:24 INFO Epoch 041 | train_mse=0.058514 | val_loss=0.051595 | best_val_loss=0.374786
2025-12-22 21:47:34 INFO Epoch 042 | 25% complete (batch 181/724)
2025-12-22 21:47:38 INFO Epoch 042 | 50% complete (batch 362/724)
2025-12-22 21:47:41 INFO Epoch 042 | 75% complete (batch 543/724)
2025-12-22 21:47:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.700244
2025-12-22 21:47:59 INFO Tuning ranking metrics: regret=0.099729 spearman=0.236264 (groups=39, skipped=329)
2025-12-22 21:47:59 INFO Epoch 042 | train_mse=0.051932 | val_loss=0.053051 | best_val_loss=0.374786
2025-12-22 21:48:10 INFO Epoch 043 | 25% complete (batch 181/724)
2025-12-22 21:48:13 INFO Epoch 043 | 50% complete (batch 362/724)
2025-12-22 21:48:16 INFO Epoch 043 | 75% complete (batch 543/724)
2025-12-22 21:48:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.687331
2025-12-22 21:48:35 INFO Tuning ranking metrics: regret=0.119073 spearman=0.171856 (groups=39, skipped=329)
2025-12-22 21:48:35 INFO Epoch 043 | train_mse=0.061697 | val_loss=0.061896 | best_val_loss=0.374786
2025-12-22 21:48:46 INFO Epoch 044 | 25% complete (batch 181/724)
2025-12-22 21:48:49 INFO Epoch 044 | 50% complete (batch 362/724)
2025-12-22 21:48:52 INFO Epoch 044 | 75% complete (batch 543/724)
2025-12-22 21:49:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.702309
2025-12-22 21:49:11 INFO Tuning ranking metrics: regret=0.115330 spearman=0.203114 (groups=39, skipped=329)
2025-12-22 21:49:11 INFO Epoch 044 | train_mse=0.048464 | val_loss=0.054567 | best_val_loss=0.374786
2025-12-22 21:49:22 INFO Epoch 045 | 25% complete (batch 181/724)
2025-12-22 21:49:25 INFO Epoch 045 | 50% complete (batch 362/724)
2025-12-22 21:49:28 INFO Epoch 045 | 75% complete (batch 543/724)
2025-12-22 21:49:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.696772
2025-12-22 21:49:47 INFO Tuning ranking metrics: regret=0.101931 spearman=0.145421 (groups=39, skipped=329)
2025-12-22 21:49:47 INFO Epoch 045 | train_mse=0.048882 | val_loss=0.055537 | best_val_loss=0.374786
2025-12-22 21:49:57 INFO Epoch 046 | 25% complete (batch 181/724)
2025-12-22 21:50:00 INFO Epoch 046 | 50% complete (batch 362/724)
2025-12-22 21:50:04 INFO Epoch 046 | 75% complete (batch 543/724)
2025-12-22 21:50:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.706334
2025-12-22 21:50:22 INFO Tuning ranking metrics: regret=0.136836 spearman=0.132295 (groups=39, skipped=329)
2025-12-22 21:50:22 INFO Epoch 046 | train_mse=0.054509 | val_loss=0.060355 | best_val_loss=0.374786
2025-12-22 21:50:33 INFO Epoch 047 | 25% complete (batch 181/724)
2025-12-22 21:50:36 INFO Epoch 047 | 50% complete (batch 362/724)
2025-12-22 21:50:39 INFO Epoch 047 | 75% complete (batch 543/724)
2025-12-22 21:50:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.706665
2025-12-22 21:50:58 INFO Tuning ranking metrics: regret=0.112582 spearman=0.153907 (groups=39, skipped=329)
2025-12-22 21:50:58 INFO Epoch 047 | train_mse=0.054560 | val_loss=0.062246 | best_val_loss=0.374786
2025-12-22 21:51:08 INFO Epoch 048 | 25% complete (batch 181/724)
2025-12-22 21:51:11 INFO Epoch 048 | 50% complete (batch 362/724)
2025-12-22 21:51:15 INFO Epoch 048 | 75% complete (batch 543/724)
2025-12-22 21:51:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.706527
2025-12-22 21:51:33 INFO Tuning ranking metrics: regret=0.096549 spearman=0.244994 (groups=39, skipped=329)
2025-12-22 21:51:33 INFO Epoch 048 | train_mse=0.050412 | val_loss=0.055460 | best_val_loss=0.374786
2025-12-22 21:51:44 INFO Epoch 049 | 25% complete (batch 181/724)
2025-12-22 21:51:47 INFO Epoch 049 | 50% complete (batch 362/724)
2025-12-22 21:51:50 INFO Epoch 049 | 75% complete (batch 543/724)
2025-12-22 21:52:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.680257
2025-12-22 21:52:08 INFO Tuning ranking metrics: regret=0.106725 spearman=0.096398 (groups=39, skipped=329)
2025-12-22 21:52:08 INFO Epoch 049 | train_mse=0.044784 | val_loss=0.058348 | best_val_loss=0.374786
2025-12-22 21:52:19 INFO Epoch 050 | 25% complete (batch 181/724)
2025-12-22 21:52:22 INFO Epoch 050 | 50% complete (batch 362/724)
2025-12-22 21:52:26 INFO Epoch 050 | 75% complete (batch 543/724)
2025-12-22 21:52:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.702737
2025-12-22 21:52:44 INFO Tuning ranking metrics: regret=0.100642 spearman=0.219902 (groups=39, skipped=329)
2025-12-22 21:52:44 INFO Epoch 050 | train_mse=0.051151 | val_loss=0.050804 | best_val_loss=0.374786
2025-12-22 21:52:55 INFO Epoch 051 | 25% complete (batch 181/724)
2025-12-22 21:52:58 INFO Epoch 051 | 50% complete (batch 362/724)
2025-12-22 21:53:01 INFO Epoch 051 | 75% complete (batch 543/724)
2025-12-22 21:53:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.674590
2025-12-22 21:53:20 INFO Tuning ranking metrics: regret=0.119524 spearman=0.225641 (groups=39, skipped=329)
2025-12-22 21:53:20 INFO Epoch 051 | train_mse=0.050276 | val_loss=0.079675 | best_val_loss=0.374786
2025-12-22 21:53:30 INFO Epoch 052 | 25% complete (batch 181/724)
2025-12-22 21:53:34 INFO Epoch 052 | 50% complete (batch 362/724)
2025-12-22 21:53:37 INFO Epoch 052 | 75% complete (batch 543/724)
2025-12-22 21:53:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.684701
2025-12-22 21:53:55 INFO Tuning ranking metrics: regret=0.107382 spearman=0.209402 (groups=39, skipped=329)
2025-12-22 21:53:55 INFO Epoch 052 | train_mse=0.054435 | val_loss=0.055382 | best_val_loss=0.374786
2025-12-22 21:54:06 INFO Epoch 053 | 25% complete (batch 181/724)
2025-12-22 21:54:09 INFO Epoch 053 | 50% complete (batch 362/724)
2025-12-22 21:54:13 INFO Epoch 053 | 75% complete (batch 543/724)
2025-12-22 21:54:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.677282
2025-12-22 21:54:31 INFO Tuning ranking metrics: regret=0.087452 spearman=0.213248 (groups=39, skipped=329)
2025-12-22 21:54:31 INFO Epoch 053 | train_mse=0.058924 | val_loss=0.060245 | best_val_loss=0.374786
2025-12-22 21:54:42 INFO Epoch 054 | 25% complete (batch 181/724)
2025-12-22 21:54:45 INFO Epoch 054 | 50% complete (batch 362/724)
2025-12-22 21:54:49 INFO Epoch 054 | 75% complete (batch 543/724)
2025-12-22 21:55:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.690310
2025-12-22 21:55:07 INFO Tuning ranking metrics: regret=0.082083 spearman=0.246581 (groups=39, skipped=329)
2025-12-22 21:55:07 INFO Epoch 054 | train_mse=0.051707 | val_loss=0.054492 | best_val_loss=0.374786
2025-12-22 21:55:18 INFO Epoch 055 | 25% complete (batch 181/724)
2025-12-22 21:55:21 INFO Epoch 055 | 50% complete (batch 362/724)
2025-12-22 21:55:24 INFO Epoch 055 | 75% complete (batch 543/724)
2025-12-22 21:55:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.677416
2025-12-22 21:55:43 INFO Tuning ranking metrics: regret=0.102822 spearman=0.208425 (groups=39, skipped=329)
2025-12-22 21:55:43 INFO Epoch 055 | train_mse=0.046506 | val_loss=0.063505 | best_val_loss=0.374786
2025-12-22 21:55:53 INFO Epoch 056 | 25% complete (batch 181/724)
2025-12-22 21:55:57 INFO Epoch 056 | 50% complete (batch 362/724)
2025-12-22 21:56:00 INFO Epoch 056 | 75% complete (batch 543/724)
2025-12-22 21:56:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.681884
2025-12-22 21:56:19 INFO Tuning ranking metrics: regret=0.087146 spearman=0.315263 (groups=39, skipped=329)
2025-12-22 21:56:19 INFO Epoch 056 | train_mse=0.051678 | val_loss=0.063754 | best_val_loss=0.374786
2025-12-22 21:56:29 INFO Epoch 057 | 25% complete (batch 181/724)
2025-12-22 21:56:32 INFO Epoch 057 | 50% complete (batch 362/724)
2025-12-22 21:56:35 INFO Epoch 057 | 75% complete (batch 543/724)
2025-12-22 21:56:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.667774
2025-12-22 21:56:54 INFO Tuning ranking metrics: regret=0.087115 spearman=0.286569 (groups=39, skipped=329)
2025-12-22 21:56:54 INFO Epoch 057 | train_mse=0.051659 | val_loss=0.060337 | best_val_loss=0.374786
2025-12-22 21:57:05 INFO Epoch 058 | 25% complete (batch 181/724)
2025-12-22 21:57:10 INFO Epoch 058 | 50% complete (batch 362/724)
2025-12-22 21:57:14 INFO Epoch 058 | 75% complete (batch 543/724)
2025-12-22 21:57:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.681629
2025-12-22 21:57:33 INFO Tuning ranking metrics: regret=0.094162 spearman=0.175702 (groups=39, skipped=329)
2025-12-22 21:57:33 INFO Epoch 058 | train_mse=0.046004 | val_loss=0.052060 | best_val_loss=0.374786
2025-12-22 21:57:44 INFO Epoch 059 | 25% complete (batch 181/724)
2025-12-22 21:57:48 INFO Epoch 059 | 50% complete (batch 362/724)
2025-12-22 21:57:53 INFO Epoch 059 | 75% complete (batch 543/724)
2025-12-22 21:58:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.710445
2025-12-22 21:58:12 INFO Tuning ranking metrics: regret=0.105792 spearman=0.216422 (groups=39, skipped=329)
2025-12-22 21:58:12 INFO Epoch 059 | train_mse=0.051510 | val_loss=0.052370 | best_val_loss=0.374786
2025-12-22 21:58:23 INFO Epoch 060 | 25% complete (batch 181/724)
2025-12-22 21:58:27 INFO Epoch 060 | 50% complete (batch 362/724)
2025-12-22 21:58:31 INFO Epoch 060 | 75% complete (batch 543/724)
2025-12-22 21:58:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.709760
2025-12-22 21:58:51 INFO Tuning ranking metrics: regret=0.086947 spearman=0.197619 (groups=39, skipped=329)
2025-12-22 21:58:51 INFO Epoch 060 | train_mse=0.047559 | val_loss=0.048304 | best_val_loss=0.374786
2025-12-22 21:59:02 INFO Epoch 061 | 25% complete (batch 181/724)
2025-12-22 21:59:05 INFO Epoch 061 | 50% complete (batch 362/724)
2025-12-22 21:59:10 INFO Epoch 061 | 75% complete (batch 543/724)
2025-12-22 21:59:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.707088
2025-12-22 21:59:31 INFO Tuning ranking metrics: regret=0.101105 spearman=0.202259 (groups=39, skipped=329)
2025-12-22 21:59:31 INFO Epoch 061 | train_mse=0.053441 | val_loss=0.055505 | best_val_loss=0.374786
2025-12-22 21:59:41 INFO Epoch 062 | 25% complete (batch 181/724)
2025-12-22 21:59:45 INFO Epoch 062 | 50% complete (batch 362/724)
2025-12-22 21:59:50 INFO Epoch 062 | 75% complete (batch 543/724)
2025-12-22 22:00:04 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.706073
2025-12-22 22:00:10 INFO Tuning ranking metrics: regret=0.095455 spearman=0.173260 (groups=39, skipped=329)
2025-12-22 22:00:10 INFO Epoch 062 | train_mse=0.047379 | val_loss=0.051766 | best_val_loss=0.374786
Monitored metric tuning_rank_spearman did not improve in the last 50 records. Best score: 0.375. Signaling Trainer to stop.
2025-12-22 22:00:11 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.35031_val-0.07871_epoch009.chkpt, checkpoint.tuning_rank_spearman-0.35366_val-0.07970_epoch008.chkpt, checkpoint.tuning_rank_spearman-0.37479_val-0.14195_epoch012.chkpt
2025-12-22 22:00:11 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-22_21-22-34/model_checkpoints/checkpoint.tuning_rank_spearman-0.37479_val-0.14195_epoch012.chkpt
2025-12-22 22:00:11 INFO Best validation loss: tensor(0.3748)
2025-12-22 22:00:11 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-22_21-22-34/model_checkpoints/checkpoint.tuning_rank_spearman-0.37479_val-0.14195_epoch012.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-22_21-22-34/model_checkpoints/checkpoint.tuning_rank_spearman-0.37479_val-0.14195_epoch012.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-22 22:00:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.141950
2025-12-22 22:00:26 INFO Tuning ranking metrics: regret=0.097733 spearman=0.374786 (groups=39, skipped=329)
2025-12-22 22:00:26 INFO Epoch 063 | val_loss=0.141950 | best_val_loss=0.374786
2025-12-22 22:00:27 INFO Validation metrics: [{'val_loss': 0.1419496387243271, 'tuning_rank_regret': 0.09773251414299011, 'tuning_rank_spearman': 0.3747863173484802, 'val_pearson_corr': 0.5942272543907166, 'val_spearman_corr': 0.649514377117157, 'val_rank_regret': 0.17578639090061188, 'val_rank_spearman': 0.1672438681125641}]
2025-12-22 22:00:27 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.37479_val-0.14195_epoch012.chkpt
2025-12-22 22:00:27 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.35366_val-0.07970_epoch008.chkpt
2025-12-22 22:00:27 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.35031_val-0.07871_epoch009.chkpt
2025-12-22 22:00:27 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.07300_epoch011.ckpt
2025-12-22 22:00:27 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.09773251414299011
  tuning_rank_spearman      0.3747863173484802
        val_loss            0.1419496387243271
    val_pearson_corr        0.5942272543907166
     val_rank_regret        0.17578639090061188
    val_rank_spearman       0.1672438681125641
    val_spearman_corr        0.649514377117157
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run polish_lr_low_seed555_2025-12-22_21-22-34 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-22_21-22-34
[train_cli][batch] job 'polish_lr_low_seed555' finished.
[train_cli][batch] (5/6) running job 'polish_seed888' -> run_name=polish_seed888_2025-12-22_22-00-30
[train_cli] run_id=polish_seed888_2025-12-22_22-00-30 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-22_22-00-30/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-22_22-00-30 --git-commit 150d1dcbd1 --git-dirty
2025-12-22 22:00:33 INFO git_commit = 150d1dcbd1 (dirty)
2025-12-22 22:00:33 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-22 22:00:33 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-22_22-00-30/config/config.yaml
2025-12-22 22:00:33 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data
2025-12-22 22:00:33 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-22 22:00:33 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-22 22:00:33 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-22_22-00-30
2025-12-22 22:00:33 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-22 22:00:33 INFO   metadata_path = None
2025-12-22 22:00:33 INFO   summary_path = None
2025-12-22 22:00:33 INFO   accelerator = cpu
2025-12-22 22:00:33 INFO   devices = 1
2025-12-22 22:00:33 INFO   attention_head = 8
2025-12-22 22:00:33 INFO   pooling_type = mean
2025-12-22 22:00:33 INFO   model_self_loops = False
2025-12-22 22:00:33 INFO   model_self_loop_fill = mean
2025-12-22 22:00:33 INFO   model_residual = False
2025-12-22 22:00:33 INFO   batch_size = 48
2025-12-22 22:00:33 INFO   learning_rate = 0.003
2025-12-22 22:00:33 INFO   num_epochs = 320
2025-12-22 22:00:33 INFO   accumulate_grad_batches = 8
2025-12-22 22:00:33 INFO   seed = 888
2025-12-22 22:00:33 INFO   num_workers = 2
2025-12-22 22:00:33 INFO   precision = 32
2025-12-22 22:00:33 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-22 22:00:33 INFO   early_stopping_patience = 40
2025-12-22 22:00:33 INFO   lr_scheduler_patience = 20
2025-12-22 22:00:33 INFO   lr_scheduler_factor = 0.3
2025-12-22 22:00:33 INFO   fast_dev_run = False
2025-12-22 22:00:33 INFO   limit_train_batches = None
2025-12-22 22:00:33 INFO   limit_val_batches = None
2025-12-22 22:00:33 INFO   log_lr = False
2025-12-22 22:00:33 INFO   progress_bar_refresh_rate = 0
2025-12-22 22:00:33 INFO   log_every_n_steps = 100
2025-12-22 22:00:33 INFO   use_val_spearman_as_secondary = True
2025-12-22 22:00:33 INFO   spearman_secondary_min_delta = 0.0
2025-12-22 22:00:33 INFO   spearman_secondary_weight = 1.0
2025-12-22 22:00:33 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-22 22:00:33 INFO   tuning_max_samples = 500
2025-12-22 22:00:33 INFO   tuning_fraction = None
2025-12-22 22:00:33 INFO   tuning_eval_every = 1
2025-12-22 22:00:33 INFO   rank_loss_weight = 0.0
2025-12-22 22:00:33 INFO   rank_loss_margin = 0.0
2025-12-22 22:00:33 INFO   rank_loss_mode = hinge
2025-12-22 22:00:33 INFO   rank_loss_grouped = True
2025-12-22 22:00:33 INFO   variance_reduction_enabled = False
2025-12-22 22:00:33 INFO   variance_reduction_method = topk_avg
2025-12-22 22:00:33 INFO   variance_reduction_top_k = 3
2025-12-22 22:00:33 INFO   coverage_minimum = 0.0
2025-12-22 22:00:33 INFO   coverage_fail_on_missing = False
2025-12-22 22:00:33 INFO   graph_load_profiling = False
2025-12-22 22:00:33 INFO   graph_load_top_k = 5
2025-12-22 22:00:33 INFO   enable_graph_cache = True
2025-12-22 22:00:33 INFO   graph_cache_size = 256
2025-12-22 22:00:33 INFO   canonicalize_on_load = False
2025-12-22 22:00:33 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-22 22:00:33 INFO   edge_schema = {}
2025-12-22 22:00:33 INFO   topology_schema = {}
Seed set to 888
2025-12-22 22:00:33 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-22 22:00:33 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 22:00:33 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-22 22:00:33 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 22:00:33 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-22 22:00:33 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 22:00:34 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-22 22:00:34 INFO Tuning group stats: groups=351 groups>=2=40 singletons=311 max_group=10
2025-12-22 22:00:34 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-22_22-00-30/dataset_coverage.json
2025-12-22 22:00:34 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-22_22-00-30/dataset_coverage.json for details.
2025-12-22 22:00:34 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-22_22-00-30/dataset_coverage.json for details.
2025-12-22 22:00:34 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-22_22-00-30/dataset_coverage.json for details.
2025-12-22 22:00:34 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-22_22-00-30/schema_summary.json
2025-12-22 22:00:34 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-22_22-00-30/feature_metadata.json
2025-12-22 22:00:34 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-22 22:00:34 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/feature-config.yaml.topoqa.10A.2, sha256=5c62898155179232a565e24d9fbd7b208f9ce480d1a19d6139de19454e173ff0
2025-12-22 22:00:34 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/work/edge_features)
2025-12-22 22:00:34 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json
2025-12-22 22:00:34 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-22_22-00-30/schema_summary.json
2025-12-22 22:00:34 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-22 22:00:34 INFO Topology: topology/persistence_basic/v1 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 172-dimensional node features.
2025-12-22 22:00:34 INFO Node: node/dssp_topo_merge/v1; metadata lists 172 feature columns matching the .pt tensor.
2025-12-22 22:00:34 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-22 22:00:34 INFO → Total feature dimensionality observed and confirmed: node_dim = 172, edge_dim = 11.
2025-12-22 22:00:34 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-22 22:00:34 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 172,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 172,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-22_22-00-30/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge/v1",
      "alias": "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA",
      "jobs": 16,
      "summary": "DSSP-derived node features merged with topology statistics."
    },
    "topology": {
      "id": "topology/persistence_basic/v1",
      "alias": "Betti 0 and Betti 1 topology summaries on interface coords = 140D PH | TopoQA",
      "jobs": 16,
      "summary": "Persistent homology features with configurable distance thresholds."
    }
  },
  "notes": []
}
2025-12-22 22:00:34 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-22 22:00:35 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=1eb2d8a1bfac48cb85b330264beb7af7)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-22 22:00:35 INFO Starting training (fast_dev_run=False)
2025-12-22 22:00:35 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-22_22-00-30/model_checkpoints exists and is not empty.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 5.5 K  | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
165 K     Trainable params
0         Non-trainable params
165 K     Total params
0.662     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-22 22:00:49 INFO Epoch 000 | 25% complete (batch 46/181)
2025-12-22 22:00:50 INFO Epoch 000 | 50% complete (batch 91/181)
2025-12-22 22:00:51 INFO Epoch 000 | 75% complete (batch 136/181)
2025-12-22 22:00:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.140603
2025-12-22 22:01:04 INFO Tuning ranking metrics: regret=0.159708 spearman=-0.020037 (groups=40, skipped=311)
2025-12-22 22:01:04 INFO Epoch 000 | val_loss=0.140603
Metric tuning_rank_spearman improved. New best score: -0.020
2025-12-22 22:01:12 INFO Epoch 001 | 25% complete (batch 46/181)
2025-12-22 22:01:13 INFO Epoch 001 | 50% complete (batch 91/181)
2025-12-22 22:01:14 INFO Epoch 001 | 75% complete (batch 136/181)
2025-12-22 22:01:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.089215
2025-12-22 22:01:28 INFO Tuning ranking metrics: regret=0.172493 spearman=0.187311 (groups=40, skipped=311)
2025-12-22 22:01:28 INFO Epoch 001 | train_mse=0.152647 | val_loss=0.140486 | best_val_loss=-0.020037
Metric tuning_rank_spearman improved by 0.207 >= min_delta = 0.0. New best score: 0.187
2025-12-22 22:01:36 INFO Epoch 002 | 25% complete (batch 46/181)
2025-12-22 22:01:37 INFO Epoch 002 | 50% complete (batch 91/181)
2025-12-22 22:01:38 INFO Epoch 002 | 75% complete (batch 136/181)
2025-12-22 22:01:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.292227
2025-12-22 22:01:51 INFO Tuning ranking metrics: regret=0.230621 spearman=-0.058225 (groups=40, skipped=311)
2025-12-22 22:01:51 INFO Epoch 002 | train_mse=0.149995 | val_loss=0.140674 | best_val_loss=0.187311
2025-12-22 22:01:59 INFO Epoch 003 | 25% complete (batch 46/181)
2025-12-22 22:02:00 INFO Epoch 003 | 50% complete (batch 91/181)
2025-12-22 22:02:01 INFO Epoch 003 | 75% complete (batch 136/181)
2025-12-22 22:02:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.140247
2025-12-22 22:02:15 INFO Tuning ranking metrics: regret=0.191226 spearman=0.142143 (groups=40, skipped=311)
2025-12-22 22:02:15 INFO Epoch 003 | train_mse=0.146805 | val_loss=0.140247 | best_val_loss=0.187311
2025-12-22 22:02:24 INFO Epoch 004 | 25% complete (batch 46/181)
2025-12-22 22:02:25 INFO Epoch 004 | 50% complete (batch 91/181)
2025-12-22 22:02:26 INFO Epoch 004 | 75% complete (batch 136/181)
2025-12-22 22:02:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.346990
2025-12-22 22:02:39 INFO Tuning ranking metrics: regret=0.207044 spearman=-0.071894 (groups=40, skipped=311)
2025-12-22 22:02:39 INFO Epoch 004 | train_mse=0.142999 | val_loss=0.141730 | best_val_loss=0.187311
2025-12-22 22:02:47 INFO Epoch 005 | 25% complete (batch 46/181)
2025-12-22 22:02:48 INFO Epoch 005 | 50% complete (batch 91/181)
2025-12-22 22:02:49 INFO Epoch 005 | 75% complete (batch 136/181)
2025-12-22 22:02:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.138299
2025-12-22 22:03:02 INFO Tuning ranking metrics: regret=0.144468 spearman=0.092982 (groups=40, skipped=311)
2025-12-22 22:03:02 INFO Epoch 005 | train_mse=0.151522 | val_loss=0.138299 | best_val_loss=0.187311
2025-12-22 22:03:11 INFO Epoch 006 | 25% complete (batch 46/181)
2025-12-22 22:03:12 INFO Epoch 006 | 50% complete (batch 91/181)
2025-12-22 22:03:12 INFO Epoch 006 | 75% complete (batch 136/181)
2025-12-22 22:03:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.378103
2025-12-22 22:03:26 INFO Tuning ranking metrics: regret=0.141411 spearman=0.151829 (groups=40, skipped=311)
2025-12-22 22:03:26 INFO Epoch 006 | train_mse=0.146774 | val_loss=0.125775 | best_val_loss=0.187311
2025-12-22 22:03:34 INFO Epoch 007 | 25% complete (batch 46/181)
2025-12-22 22:03:35 INFO Epoch 007 | 50% complete (batch 91/181)
2025-12-22 22:03:36 INFO Epoch 007 | 75% complete (batch 136/181)
2025-12-22 22:03:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.523047
2025-12-22 22:03:49 INFO Tuning ranking metrics: regret=0.150142 spearman=0.046169 (groups=40, skipped=311)
2025-12-22 22:03:49 INFO Epoch 007 | train_mse=0.136025 | val_loss=0.138629 | best_val_loss=0.187311
2025-12-22 22:03:57 INFO Epoch 008 | 25% complete (batch 46/181)
2025-12-22 22:03:58 INFO Epoch 008 | 50% complete (batch 91/181)
2025-12-22 22:03:59 INFO Epoch 008 | 75% complete (batch 136/181)
2025-12-22 22:04:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.524466
2025-12-22 22:04:12 INFO Tuning ranking metrics: regret=0.148411 spearman=0.023295 (groups=40, skipped=311)
2025-12-22 22:04:12 INFO Epoch 008 | train_mse=0.149836 | val_loss=0.125170 | best_val_loss=0.187311
2025-12-22 22:04:20 INFO Epoch 009 | 25% complete (batch 46/181)
2025-12-22 22:04:21 INFO Epoch 009 | 50% complete (batch 91/181)
2025-12-22 22:04:22 INFO Epoch 009 | 75% complete (batch 136/181)
2025-12-22 22:04:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.507680
2025-12-22 22:04:36 INFO Tuning ranking metrics: regret=0.166310 spearman=0.045676 (groups=40, skipped=311)
2025-12-22 22:04:36 INFO Epoch 009 | train_mse=0.137240 | val_loss=0.127101 | best_val_loss=0.187311
2025-12-22 22:04:44 INFO Epoch 010 | 25% complete (batch 46/181)
2025-12-22 22:04:45 INFO Epoch 010 | 50% complete (batch 91/181)
2025-12-22 22:04:46 INFO Epoch 010 | 75% complete (batch 136/181)
2025-12-22 22:04:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.516306
2025-12-22 22:04:59 INFO Tuning ranking metrics: regret=0.164113 spearman=0.066272 (groups=40, skipped=311)
2025-12-22 22:04:59 INFO Epoch 010 | train_mse=0.133057 | val_loss=0.113394 | best_val_loss=0.187311
2025-12-22 22:05:07 INFO Epoch 011 | 25% complete (batch 46/181)
2025-12-22 22:05:08 INFO Epoch 011 | 50% complete (batch 91/181)
2025-12-22 22:05:09 INFO Epoch 011 | 75% complete (batch 136/181)
2025-12-22 22:05:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.472340
2025-12-22 22:05:23 INFO Tuning ranking metrics: regret=0.149900 spearman=-0.021932 (groups=40, skipped=311)
2025-12-22 22:05:23 INFO Epoch 011 | train_mse=0.137612 | val_loss=0.171813 | best_val_loss=0.187311
2025-12-22 22:05:31 INFO Epoch 012 | 25% complete (batch 46/181)
2025-12-22 22:05:31 INFO Epoch 012 | 50% complete (batch 91/181)
2025-12-22 22:05:32 INFO Epoch 012 | 75% complete (batch 136/181)
2025-12-22 22:05:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.514774
2025-12-22 22:05:46 INFO Tuning ranking metrics: regret=0.119261 spearman=0.049675 (groups=40, skipped=311)
2025-12-22 22:05:46 INFO Epoch 012 | train_mse=0.120638 | val_loss=0.128005 | best_val_loss=0.187311
2025-12-22 22:05:54 INFO Epoch 013 | 25% complete (batch 46/181)
2025-12-22 22:05:55 INFO Epoch 013 | 50% complete (batch 91/181)
2025-12-22 22:05:56 INFO Epoch 013 | 75% complete (batch 136/181)
2025-12-22 22:06:04 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.542714
2025-12-22 22:06:09 INFO Tuning ranking metrics: regret=0.132101 spearman=0.101434 (groups=40, skipped=311)
2025-12-22 22:06:09 INFO Epoch 013 | train_mse=0.152909 | val_loss=0.096661 | best_val_loss=0.187311
2025-12-22 22:06:18 INFO Epoch 014 | 25% complete (batch 46/181)
2025-12-22 22:06:19 INFO Epoch 014 | 50% complete (batch 91/181)
2025-12-22 22:06:20 INFO Epoch 014 | 75% complete (batch 136/181)
2025-12-22 22:06:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.532385
2025-12-22 22:06:33 INFO Tuning ranking metrics: regret=0.121660 spearman=0.081261 (groups=40, skipped=311)
2025-12-22 22:06:33 INFO Epoch 014 | train_mse=0.114359 | val_loss=0.084454 | best_val_loss=0.187311
2025-12-22 22:06:41 INFO Epoch 015 | 25% complete (batch 46/181)
2025-12-22 22:06:42 INFO Epoch 015 | 50% complete (batch 91/181)
2025-12-22 22:06:43 INFO Epoch 015 | 75% complete (batch 136/181)
2025-12-22 22:06:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.548604
2025-12-22 22:06:56 INFO Tuning ranking metrics: regret=0.151908 spearman=-0.052008 (groups=40, skipped=311)
2025-12-22 22:06:56 INFO Epoch 015 | train_mse=0.099549 | val_loss=0.092649 | best_val_loss=0.187311
2025-12-22 22:07:04 INFO Epoch 016 | 25% complete (batch 46/181)
2025-12-22 22:07:05 INFO Epoch 016 | 50% complete (batch 91/181)
2025-12-22 22:07:06 INFO Epoch 016 | 75% complete (batch 136/181)
2025-12-22 22:07:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.581413
2025-12-22 22:07:20 INFO Tuning ranking metrics: regret=0.136052 spearman=0.000070 (groups=40, skipped=311)
2025-12-22 22:07:20 INFO Epoch 016 | train_mse=0.100893 | val_loss=0.087808 | best_val_loss=0.187311
2025-12-22 22:07:28 INFO Epoch 017 | 25% complete (batch 46/181)
2025-12-22 22:07:29 INFO Epoch 017 | 50% complete (batch 91/181)
2025-12-22 22:07:30 INFO Epoch 017 | 75% complete (batch 136/181)
2025-12-22 22:07:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.547476
2025-12-22 22:07:43 INFO Tuning ranking metrics: regret=0.128142 spearman=0.083534 (groups=40, skipped=311)
2025-12-22 22:07:43 INFO Epoch 017 | train_mse=0.111394 | val_loss=0.135880 | best_val_loss=0.187311
2025-12-22 22:07:51 INFO Epoch 018 | 25% complete (batch 46/181)
2025-12-22 22:07:52 INFO Epoch 018 | 50% complete (batch 91/181)
2025-12-22 22:07:53 INFO Epoch 018 | 75% complete (batch 136/181)
2025-12-22 22:08:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.567663
2025-12-22 22:08:06 INFO Tuning ranking metrics: regret=0.147219 spearman=0.062922 (groups=40, skipped=311)
2025-12-22 22:08:06 INFO Epoch 018 | train_mse=0.097040 | val_loss=0.095203 | best_val_loss=0.187311
2025-12-22 22:08:15 INFO Epoch 019 | 25% complete (batch 46/181)
2025-12-22 22:08:16 INFO Epoch 019 | 50% complete (batch 91/181)
2025-12-22 22:08:17 INFO Epoch 019 | 75% complete (batch 136/181)
2025-12-22 22:08:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.604668
2025-12-22 22:08:30 INFO Tuning ranking metrics: regret=0.166526 spearman=-0.015379 (groups=40, skipped=311)
2025-12-22 22:08:30 INFO Epoch 019 | train_mse=0.090447 | val_loss=0.075385 | best_val_loss=0.187311
2025-12-22 22:08:38 INFO Epoch 020 | 25% complete (batch 46/181)
2025-12-22 22:08:39 INFO Epoch 020 | 50% complete (batch 91/181)
2025-12-22 22:08:40 INFO Epoch 020 | 75% complete (batch 136/181)
2025-12-22 22:08:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.615313
2025-12-22 22:08:54 INFO Tuning ranking metrics: regret=0.125785 spearman=0.031001 (groups=40, skipped=311)
2025-12-22 22:08:54 INFO Epoch 020 | train_mse=0.095829 | val_loss=0.079964 | best_val_loss=0.187311
2025-12-22 22:09:02 INFO Epoch 021 | 25% complete (batch 46/181)
2025-12-22 22:09:03 INFO Epoch 021 | 50% complete (batch 91/181)
2025-12-22 22:09:04 INFO Epoch 021 | 75% complete (batch 136/181)
2025-12-22 22:09:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.597220
2025-12-22 22:09:17 INFO Tuning ranking metrics: regret=0.115164 spearman=-0.004502 (groups=40, skipped=311)
2025-12-22 22:09:17 INFO Epoch 021 | train_mse=0.069677 | val_loss=0.077450 | best_val_loss=0.187311
2025-12-22 22:09:25 INFO Epoch 022 | 25% complete (batch 46/181)
2025-12-22 22:09:26 INFO Epoch 022 | 50% complete (batch 91/181)
2025-12-22 22:09:27 INFO Epoch 022 | 75% complete (batch 136/181)
2025-12-22 22:09:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.593600
2025-12-22 22:09:41 INFO Tuning ranking metrics: regret=0.115704 spearman=-0.002716 (groups=40, skipped=311)
2025-12-22 22:09:41 INFO Epoch 022 | train_mse=0.088105 | val_loss=0.077717 | best_val_loss=0.187311
2025-12-22 22:09:49 INFO Epoch 023 | 25% complete (batch 46/181)
2025-12-22 22:09:50 INFO Epoch 023 | 50% complete (batch 91/181)
2025-12-22 22:09:51 INFO Epoch 023 | 75% complete (batch 136/181)
2025-12-22 22:09:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.551990
2025-12-22 22:10:04 INFO Tuning ranking metrics: regret=0.129991 spearman=0.139389 (groups=40, skipped=311)
2025-12-22 22:10:04 INFO Epoch 023 | train_mse=0.096725 | val_loss=0.124105 | best_val_loss=0.187311
2025-12-22 22:10:13 INFO Epoch 024 | 25% complete (batch 46/181)
2025-12-22 22:10:14 INFO Epoch 024 | 50% complete (batch 91/181)
2025-12-22 22:10:14 INFO Epoch 024 | 75% complete (batch 136/181)
2025-12-22 22:10:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.606156
2025-12-22 22:10:27 INFO Tuning ranking metrics: regret=0.135903 spearman=0.125801 (groups=40, skipped=311)
2025-12-22 22:10:27 INFO Epoch 024 | train_mse=0.088180 | val_loss=0.076211 | best_val_loss=0.187311
2025-12-22 22:10:36 INFO Epoch 025 | 25% complete (batch 46/181)
2025-12-22 22:10:37 INFO Epoch 025 | 50% complete (batch 91/181)
2025-12-22 22:10:38 INFO Epoch 025 | 75% complete (batch 136/181)
2025-12-22 22:10:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.603867
2025-12-22 22:10:51 INFO Tuning ranking metrics: regret=0.140311 spearman=0.167879 (groups=40, skipped=311)
2025-12-22 22:10:51 INFO Epoch 025 | train_mse=0.089558 | val_loss=0.092634 | best_val_loss=0.187311
2025-12-22 22:10:59 INFO Epoch 026 | 25% complete (batch 46/181)
2025-12-22 22:11:00 INFO Epoch 026 | 50% complete (batch 91/181)
2025-12-22 22:11:01 INFO Epoch 026 | 75% complete (batch 136/181)
2025-12-22 22:11:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.633021
2025-12-22 22:11:15 INFO Tuning ranking metrics: regret=0.144472 spearman=0.175346 (groups=40, skipped=311)
2025-12-22 22:11:15 INFO Epoch 026 | train_mse=0.077614 | val_loss=0.074144 | best_val_loss=0.187311
2025-12-22 22:11:23 INFO Epoch 027 | 25% complete (batch 46/181)
2025-12-22 22:11:24 INFO Epoch 027 | 50% complete (batch 91/181)
2025-12-22 22:11:25 INFO Epoch 027 | 75% complete (batch 136/181)
2025-12-22 22:11:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.614377
2025-12-22 22:11:38 INFO Tuning ranking metrics: regret=0.140546 spearman=0.183111 (groups=40, skipped=311)
2025-12-22 22:11:38 INFO Epoch 027 | train_mse=0.070822 | val_loss=0.075652 | best_val_loss=0.187311
2025-12-22 22:11:46 INFO Epoch 028 | 25% complete (batch 46/181)
2025-12-22 22:11:47 INFO Epoch 028 | 50% complete (batch 91/181)
2025-12-22 22:11:48 INFO Epoch 028 | 75% complete (batch 136/181)
2025-12-22 22:11:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.618927
2025-12-22 22:12:02 INFO Tuning ranking metrics: regret=0.164184 spearman=0.146477 (groups=40, skipped=311)
2025-12-22 22:12:02 INFO Epoch 028 | train_mse=0.077457 | val_loss=0.072059 | best_val_loss=0.187311
2025-12-22 22:12:10 INFO Epoch 029 | 25% complete (batch 46/181)
2025-12-22 22:12:11 INFO Epoch 029 | 50% complete (batch 91/181)
2025-12-22 22:12:12 INFO Epoch 029 | 75% complete (batch 136/181)
2025-12-22 22:12:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.599986
2025-12-22 22:12:25 INFO Tuning ranking metrics: regret=0.166165 spearman=0.088079 (groups=40, skipped=311)
2025-12-22 22:12:25 INFO Epoch 029 | train_mse=0.089655 | val_loss=0.096348 | best_val_loss=0.187311
2025-12-22 22:12:33 INFO Epoch 030 | 25% complete (batch 46/181)
2025-12-22 22:12:34 INFO Epoch 030 | 50% complete (batch 91/181)
2025-12-22 22:12:35 INFO Epoch 030 | 75% complete (batch 136/181)
2025-12-22 22:12:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.630292
2025-12-22 22:12:49 INFO Tuning ranking metrics: regret=0.171582 spearman=0.056456 (groups=40, skipped=311)
2025-12-22 22:12:49 INFO Epoch 030 | train_mse=0.072975 | val_loss=0.072330 | best_val_loss=0.187311
2025-12-22 22:12:57 INFO Epoch 031 | 25% complete (batch 46/181)
2025-12-22 22:12:57 INFO Epoch 031 | 50% complete (batch 91/181)
2025-12-22 22:12:58 INFO Epoch 031 | 75% complete (batch 136/181)
2025-12-22 22:13:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.612878
2025-12-22 22:13:12 INFO Tuning ranking metrics: regret=0.152134 spearman=0.046347 (groups=40, skipped=311)
2025-12-22 22:13:12 INFO Epoch 031 | train_mse=0.085470 | val_loss=0.078895 | best_val_loss=0.187311
2025-12-22 22:13:20 INFO Epoch 032 | 25% complete (batch 46/181)
2025-12-22 22:13:21 INFO Epoch 032 | 50% complete (batch 91/181)
2025-12-22 22:13:22 INFO Epoch 032 | 75% complete (batch 136/181)
2025-12-22 22:13:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.614312
2025-12-22 22:13:35 INFO Tuning ranking metrics: regret=0.155140 spearman=0.136055 (groups=40, skipped=311)
2025-12-22 22:13:35 INFO Epoch 032 | train_mse=0.089043 | val_loss=0.073035 | best_val_loss=0.187311
2025-12-22 22:13:44 INFO Epoch 033 | 25% complete (batch 46/181)
2025-12-22 22:13:45 INFO Epoch 033 | 50% complete (batch 91/181)
2025-12-22 22:13:46 INFO Epoch 033 | 75% complete (batch 136/181)
2025-12-22 22:13:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.595742
2025-12-22 22:13:59 INFO Tuning ranking metrics: regret=0.168290 spearman=0.055281 (groups=40, skipped=311)
2025-12-22 22:13:59 INFO Epoch 033 | train_mse=0.092895 | val_loss=0.080924 | best_val_loss=0.187311
2025-12-22 22:14:07 INFO Epoch 034 | 25% complete (batch 46/181)
2025-12-22 22:14:08 INFO Epoch 034 | 50% complete (batch 91/181)
2025-12-22 22:14:09 INFO Epoch 034 | 75% complete (batch 136/181)
2025-12-22 22:14:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.586548
2025-12-22 22:14:22 INFO Tuning ranking metrics: regret=0.125138 spearman=0.074686 (groups=40, skipped=311)
2025-12-22 22:14:22 INFO Epoch 034 | train_mse=0.081533 | val_loss=0.084501 | best_val_loss=0.187311
2025-12-22 22:14:31 INFO Epoch 035 | 25% complete (batch 46/181)
2025-12-22 22:14:31 INFO Epoch 035 | 50% complete (batch 91/181)
2025-12-22 22:14:32 INFO Epoch 035 | 75% complete (batch 136/181)
2025-12-22 22:14:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.603077
2025-12-22 22:14:46 INFO Tuning ranking metrics: regret=0.146561 spearman=0.042852 (groups=40, skipped=311)
2025-12-22 22:14:46 INFO Epoch 035 | train_mse=0.085164 | val_loss=0.068508 | best_val_loss=0.187311
2025-12-22 22:14:54 INFO Epoch 036 | 25% complete (batch 46/181)
2025-12-22 22:14:55 INFO Epoch 036 | 50% complete (batch 91/181)
2025-12-22 22:14:56 INFO Epoch 036 | 75% complete (batch 136/181)
2025-12-22 22:15:04 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.635776
2025-12-22 22:15:09 INFO Tuning ranking metrics: regret=0.145131 spearman=0.094318 (groups=40, skipped=311)
2025-12-22 22:15:09 INFO Epoch 036 | train_mse=0.062223 | val_loss=0.074022 | best_val_loss=0.187311
2025-12-22 22:15:18 INFO Epoch 037 | 25% complete (batch 46/181)
2025-12-22 22:15:19 INFO Epoch 037 | 50% complete (batch 91/181)
2025-12-22 22:15:20 INFO Epoch 037 | 75% complete (batch 136/181)
2025-12-22 22:15:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.646631
2025-12-22 22:15:33 INFO Tuning ranking metrics: regret=0.117187 spearman=0.159399 (groups=40, skipped=311)
2025-12-22 22:15:33 INFO Epoch 037 | train_mse=0.084654 | val_loss=0.094656 | best_val_loss=0.187311
2025-12-22 22:15:41 INFO Epoch 038 | 25% complete (batch 46/181)
2025-12-22 22:15:42 INFO Epoch 038 | 50% complete (batch 91/181)
2025-12-22 22:15:43 INFO Epoch 038 | 75% complete (batch 136/181)
2025-12-22 22:15:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.639887
2025-12-22 22:15:57 INFO Tuning ranking metrics: regret=0.129870 spearman=0.148382 (groups=40, skipped=311)
2025-12-22 22:15:57 INFO Epoch 038 | train_mse=0.085205 | val_loss=0.071420 | best_val_loss=0.187311
2025-12-22 22:16:05 INFO Epoch 039 | 25% complete (batch 46/181)
2025-12-22 22:16:06 INFO Epoch 039 | 50% complete (batch 91/181)
2025-12-22 22:16:07 INFO Epoch 039 | 75% complete (batch 136/181)
2025-12-22 22:16:15 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.630056
2025-12-22 22:16:20 INFO Tuning ranking metrics: regret=0.138604 spearman=0.000590 (groups=40, skipped=311)
2025-12-22 22:16:20 INFO Epoch 039 | train_mse=0.071388 | val_loss=0.088227 | best_val_loss=0.187311
2025-12-22 22:16:29 INFO Epoch 040 | 25% complete (batch 46/181)
2025-12-22 22:16:30 INFO Epoch 040 | 50% complete (batch 91/181)
2025-12-22 22:16:30 INFO Epoch 040 | 75% complete (batch 136/181)
2025-12-22 22:16:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.668190
2025-12-22 22:16:44 INFO Tuning ranking metrics: regret=0.116549 spearman=0.098674 (groups=40, skipped=311)
2025-12-22 22:16:44 INFO Epoch 040 | train_mse=0.059704 | val_loss=0.064093 | best_val_loss=0.187311
2025-12-22 22:16:52 INFO Epoch 041 | 25% complete (batch 46/181)
2025-12-22 22:16:53 INFO Epoch 041 | 50% complete (batch 91/181)
2025-12-22 22:16:54 INFO Epoch 041 | 75% complete (batch 136/181)
2025-12-22 22:17:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.655401
2025-12-22 22:17:07 INFO Tuning ranking metrics: regret=0.126711 spearman=0.031001 (groups=40, skipped=311)
2025-12-22 22:17:07 INFO Epoch 041 | train_mse=0.061263 | val_loss=0.061037 | best_val_loss=0.187311
Monitored metric tuning_rank_spearman did not improve in the last 40 records. Best score: 0.187. Signaling Trainer to stop.
2025-12-22 22:17:08 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.17535_val-0.07414_epoch026.chkpt, checkpoint.tuning_rank_spearman-0.18311_val-0.07565_epoch027.chkpt, checkpoint.tuning_rank_spearman-0.18731_val-0.14049_epoch001.chkpt
2025-12-22 22:17:08 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-22_22-00-30/model_checkpoints/checkpoint.tuning_rank_spearman-0.18731_val-0.14049_epoch001.chkpt
2025-12-22 22:17:08 INFO Best validation loss: tensor(0.1873)
2025-12-22 22:17:08 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-22_22-00-30/model_checkpoints/checkpoint.tuning_rank_spearman-0.18731_val-0.14049_epoch001.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-22_22-00-30/model_checkpoints/checkpoint.tuning_rank_spearman-0.18731_val-0.14049_epoch001.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-22 22:17:15 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.140486
2025-12-22 22:17:20 INFO Tuning ranking metrics: regret=0.172493 spearman=0.187311 (groups=40, skipped=311)
2025-12-22 22:17:20 INFO Epoch 042 | val_loss=0.140486 | best_val_loss=0.187311
2025-12-22 22:17:21 INFO Validation metrics: [{'val_loss': 0.14048561453819275, 'tuning_rank_regret': 0.17249302566051483, 'tuning_rank_spearman': 0.1873106062412262, 'val_pearson_corr': 0.3871210217475891, 'val_spearman_corr': 0.4329010248184204, 'val_rank_regret': 0.10051403939723969, 'val_rank_spearman': -0.2777777910232544}]
2025-12-22 22:17:21 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.18731_val-0.14049_epoch001.chkpt
2025-12-22 22:17:21 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.17535_val-0.07414_epoch026.chkpt
2025-12-22 22:17:21 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.18311_val-0.07565_epoch027.chkpt
2025-12-22 22:17:21 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.14060_epoch000.ckpt
2025-12-22 22:17:21 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.17249302566051483
  tuning_rank_spearman      0.1873106062412262
        val_loss            0.14048561453819275
    val_pearson_corr        0.3871210217475891
     val_rank_regret        0.10051403939723969
    val_rank_spearman       -0.2777777910232544
    val_spearman_corr       0.4329010248184204
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run polish_seed888_2025-12-22_22-00-30 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-22_22-00-30
[train_cli][batch] job 'polish_seed888' finished.
[train_cli][batch] (6/6) running job 'polish_lr_low_seed888' -> run_name=polish_lr_low_seed888_2025-12-22_22-17-23
[train_cli] run_id=polish_lr_low_seed888_2025-12-22_22-17-23 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-22_22-17-23/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-22_22-17-23 --git-commit 150d1dcbd1 --git-dirty
2025-12-22 22:17:26 INFO git_commit = 150d1dcbd1 (dirty)
2025-12-22 22:17:26 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-22 22:17:26 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-22_22-17-23/config/config.yaml
2025-12-22 22:17:26 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data
2025-12-22 22:17:26 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-22 22:17:26 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-22 22:17:26 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-22_22-17-23
2025-12-22 22:17:26 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-22 22:17:26 INFO   metadata_path = None
2025-12-22 22:17:26 INFO   summary_path = None
2025-12-22 22:17:26 INFO   accelerator = cpu
2025-12-22 22:17:26 INFO   devices = 1
2025-12-22 22:17:26 INFO   attention_head = 8
2025-12-22 22:17:26 INFO   pooling_type = mean
2025-12-22 22:17:26 INFO   model_self_loops = False
2025-12-22 22:17:26 INFO   model_self_loop_fill = mean
2025-12-22 22:17:26 INFO   model_residual = False
2025-12-22 22:17:26 INFO   batch_size = 12
2025-12-22 22:17:26 INFO   learning_rate = 0.002
2025-12-22 22:17:26 INFO   num_epochs = 360
2025-12-22 22:17:26 INFO   accumulate_grad_batches = 48
2025-12-22 22:17:26 INFO   seed = 888
2025-12-22 22:17:26 INFO   num_workers = 2
2025-12-22 22:17:26 INFO   precision = 32
2025-12-22 22:17:26 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-22 22:17:26 INFO   early_stopping_patience = 50
2025-12-22 22:17:26 INFO   lr_scheduler_patience = 25
2025-12-22 22:17:26 INFO   lr_scheduler_factor = 0.3
2025-12-22 22:17:26 INFO   fast_dev_run = False
2025-12-22 22:17:26 INFO   limit_train_batches = None
2025-12-22 22:17:26 INFO   limit_val_batches = None
2025-12-22 22:17:26 INFO   log_lr = False
2025-12-22 22:17:26 INFO   progress_bar_refresh_rate = 0
2025-12-22 22:17:26 INFO   log_every_n_steps = 100
2025-12-22 22:17:26 INFO   use_val_spearman_as_secondary = True
2025-12-22 22:17:26 INFO   spearman_secondary_min_delta = 0.0
2025-12-22 22:17:26 INFO   spearman_secondary_weight = 1.0
2025-12-22 22:17:26 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-22 22:17:26 INFO   tuning_max_samples = 500
2025-12-22 22:17:26 INFO   tuning_fraction = None
2025-12-22 22:17:26 INFO   tuning_eval_every = 1
2025-12-22 22:17:26 INFO   rank_loss_weight = 0.0
2025-12-22 22:17:26 INFO   rank_loss_margin = 0.0
2025-12-22 22:17:26 INFO   rank_loss_mode = hinge
2025-12-22 22:17:26 INFO   rank_loss_grouped = True
2025-12-22 22:17:26 INFO   variance_reduction_enabled = False
2025-12-22 22:17:26 INFO   variance_reduction_method = topk_avg
2025-12-22 22:17:26 INFO   variance_reduction_top_k = 3
2025-12-22 22:17:26 INFO   coverage_minimum = 0.0
2025-12-22 22:17:26 INFO   coverage_fail_on_missing = False
2025-12-22 22:17:26 INFO   graph_load_profiling = False
2025-12-22 22:17:26 INFO   graph_load_top_k = 5
2025-12-22 22:17:26 INFO   enable_graph_cache = True
2025-12-22 22:17:26 INFO   graph_cache_size = 256
2025-12-22 22:17:26 INFO   canonicalize_on_load = False
2025-12-22 22:17:26 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-22 22:17:26 INFO   edge_schema = {}
2025-12-22 22:17:26 INFO   topology_schema = {}
Seed set to 888
2025-12-22 22:17:27 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-22 22:17:27 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 22:17:27 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-22 22:17:27 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 22:17:27 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-22 22:17:27 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 22:17:28 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-22 22:17:28 INFO Tuning group stats: groups=351 groups>=2=40 singletons=311 max_group=10
2025-12-22 22:17:28 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-22_22-17-23/dataset_coverage.json
2025-12-22 22:17:28 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-22_22-17-23/dataset_coverage.json for details.
2025-12-22 22:17:28 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-22_22-17-23/dataset_coverage.json for details.
2025-12-22 22:17:28 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-22_22-17-23/dataset_coverage.json for details.
2025-12-22 22:17:28 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-22_22-17-23/schema_summary.json
2025-12-22 22:17:28 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-22_22-17-23/feature_metadata.json
2025-12-22 22:17:28 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-22 22:17:28 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/feature-config.yaml.topoqa.10A.2, sha256=5c62898155179232a565e24d9fbd7b208f9ce480d1a19d6139de19454e173ff0
2025-12-22 22:17:28 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/work/edge_features)
2025-12-22 22:17:28 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json
2025-12-22 22:17:28 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-22_22-17-23/schema_summary.json
2025-12-22 22:17:28 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-22 22:17:28 INFO Topology: topology/persistence_basic/v1 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 172-dimensional node features.
2025-12-22 22:17:28 INFO Node: node/dssp_topo_merge/v1; metadata lists 172 feature columns matching the .pt tensor.
2025-12-22 22:17:28 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-22 22:17:28 INFO → Total feature dimensionality observed and confirmed: node_dim = 172, edge_dim = 11.
2025-12-22 22:17:28 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-22 22:17:28 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 172,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 172,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-22_22-17-23/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge/v1",
      "alias": "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA",
      "jobs": 16,
      "summary": "DSSP-derived node features merged with topology statistics."
    },
    "topology": {
      "id": "topology/persistence_basic/v1",
      "alias": "Betti 0 and Betti 1 topology summaries on interface coords = 140D PH | TopoQA",
      "jobs": 16,
      "summary": "Persistent homology features with configurable distance thresholds."
    }
  },
  "notes": []
}
2025-12-22 22:17:28 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-22 22:17:28 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=79ccb24e559e48359ba1af27002d670d)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-22 22:17:28 INFO Starting training (fast_dev_run=False)
2025-12-22 22:17:28 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-22_22-17-23/model_checkpoints exists and is not empty.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 5.5 K  | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
165 K     Trainable params
0         Non-trainable params
165 K     Total params
0.662     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-22 22:17:44 INFO Epoch 000 | 25% complete (batch 181/724)
2025-12-22 22:17:47 INFO Epoch 000 | 50% complete (batch 362/724)
2025-12-22 22:17:50 INFO Epoch 000 | 75% complete (batch 543/724)
2025-12-22 22:18:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.146160
2025-12-22 22:18:08 INFO Tuning ranking metrics: regret=0.183086 spearman=-0.022830 (groups=40, skipped=311)
2025-12-22 22:18:08 INFO Epoch 000 | val_loss=0.146160
Metric tuning_rank_spearman improved. New best score: -0.023
2025-12-22 22:18:18 INFO Epoch 001 | 25% complete (batch 181/724)
2025-12-22 22:18:22 INFO Epoch 001 | 50% complete (batch 362/724)
2025-12-22 22:18:25 INFO Epoch 001 | 75% complete (batch 543/724)
2025-12-22 22:18:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.043976
2025-12-22 22:18:43 INFO Tuning ranking metrics: regret=0.160036 spearman=0.054010 (groups=40, skipped=311)
2025-12-22 22:18:43 INFO Epoch 001 | train_mse=0.143600 | val_loss=0.148337 | best_val_loss=-0.022830
Metric tuning_rank_spearman improved by 0.077 >= min_delta = 0.0. New best score: 0.054
2025-12-22 22:18:53 INFO Epoch 002 | 25% complete (batch 181/724)
2025-12-22 22:18:56 INFO Epoch 002 | 50% complete (batch 362/724)
2025-12-22 22:19:00 INFO Epoch 002 | 75% complete (batch 543/724)
2025-12-22 22:19:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.254915
2025-12-22 22:19:18 INFO Tuning ranking metrics: regret=0.174747 spearman=0.082581 (groups=40, skipped=311)
2025-12-22 22:19:18 INFO Epoch 002 | train_mse=0.142841 | val_loss=0.143234 | best_val_loss=0.054010
Metric tuning_rank_spearman improved by 0.029 >= min_delta = 0.0. New best score: 0.083
2025-12-22 22:19:28 INFO Epoch 003 | 25% complete (batch 181/724)
2025-12-22 22:19:32 INFO Epoch 003 | 50% complete (batch 362/724)
2025-12-22 22:19:35 INFO Epoch 003 | 75% complete (batch 543/724)
2025-12-22 22:19:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.292790
2025-12-22 22:19:54 INFO Tuning ranking metrics: regret=0.170692 spearman=0.123155 (groups=40, skipped=311)
2025-12-22 22:19:54 INFO Epoch 003 | train_mse=0.142515 | val_loss=0.143286 | best_val_loss=0.082581
Metric tuning_rank_spearman improved by 0.041 >= min_delta = 0.0. New best score: 0.123
2025-12-22 22:20:05 INFO Epoch 004 | 25% complete (batch 181/724)
2025-12-22 22:20:08 INFO Epoch 004 | 50% complete (batch 362/724)
2025-12-22 22:20:11 INFO Epoch 004 | 75% complete (batch 543/724)
2025-12-22 22:20:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.300992
2025-12-22 22:20:30 INFO Tuning ranking metrics: regret=0.138320 spearman=0.230173 (groups=40, skipped=311)
2025-12-22 22:20:30 INFO Epoch 004 | train_mse=0.140424 | val_loss=0.222599 | best_val_loss=0.123155
Metric tuning_rank_spearman improved by 0.107 >= min_delta = 0.0. New best score: 0.230
2025-12-22 22:20:40 INFO Epoch 005 | 25% complete (batch 181/724)
2025-12-22 22:20:44 INFO Epoch 005 | 50% complete (batch 362/724)
2025-12-22 22:20:47 INFO Epoch 005 | 75% complete (batch 543/724)
2025-12-22 22:21:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.474983
2025-12-22 22:21:05 INFO Tuning ranking metrics: regret=0.145263 spearman=0.158615 (groups=40, skipped=311)
2025-12-22 22:21:05 INFO Epoch 005 | train_mse=0.127190 | val_loss=0.094002 | best_val_loss=0.230173
2025-12-22 22:21:16 INFO Epoch 006 | 25% complete (batch 181/724)
2025-12-22 22:21:20 INFO Epoch 006 | 50% complete (batch 362/724)
2025-12-22 22:21:23 INFO Epoch 006 | 75% complete (batch 543/724)
2025-12-22 22:21:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.511390
2025-12-22 22:21:41 INFO Tuning ranking metrics: regret=0.129524 spearman=0.240184 (groups=40, skipped=311)
2025-12-22 22:21:41 INFO Epoch 006 | train_mse=0.112668 | val_loss=0.088244 | best_val_loss=0.230173
Metric tuning_rank_spearman improved by 0.010 >= min_delta = 0.0. New best score: 0.240
2025-12-22 22:21:52 INFO Epoch 007 | 25% complete (batch 181/724)
2025-12-22 22:21:55 INFO Epoch 007 | 50% complete (batch 362/724)
2025-12-22 22:21:58 INFO Epoch 007 | 75% complete (batch 543/724)
2025-12-22 22:22:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.537267
2025-12-22 22:22:17 INFO Tuning ranking metrics: regret=0.146451 spearman=0.191883 (groups=40, skipped=311)
2025-12-22 22:22:17 INFO Epoch 007 | train_mse=0.091442 | val_loss=0.080513 | best_val_loss=0.240184
2025-12-22 22:22:28 INFO Epoch 008 | 25% complete (batch 181/724)
2025-12-22 22:22:31 INFO Epoch 008 | 50% complete (batch 362/724)
2025-12-22 22:22:34 INFO Epoch 008 | 75% complete (batch 543/724)
2025-12-22 22:22:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.555786
2025-12-22 22:22:53 INFO Tuning ranking metrics: regret=0.159564 spearman=0.176656 (groups=40, skipped=311)
2025-12-22 22:22:53 INFO Epoch 008 | train_mse=0.086965 | val_loss=0.081813 | best_val_loss=0.240184
2025-12-22 22:23:03 INFO Epoch 009 | 25% complete (batch 181/724)
2025-12-22 22:23:06 INFO Epoch 009 | 50% complete (batch 362/724)
2025-12-22 22:23:10 INFO Epoch 009 | 75% complete (batch 543/724)
2025-12-22 22:23:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.562653
2025-12-22 22:23:29 INFO Tuning ranking metrics: regret=0.149359 spearman=0.160958 (groups=40, skipped=311)
2025-12-22 22:23:29 INFO Epoch 009 | train_mse=0.078535 | val_loss=0.076943 | best_val_loss=0.240184
2025-12-22 22:23:39 INFO Epoch 010 | 25% complete (batch 181/724)
2025-12-22 22:23:42 INFO Epoch 010 | 50% complete (batch 362/724)
2025-12-22 22:23:46 INFO Epoch 010 | 75% complete (batch 543/724)
2025-12-22 22:23:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.537727
2025-12-22 22:24:04 INFO Tuning ranking metrics: regret=0.163396 spearman=0.128539 (groups=40, skipped=311)
2025-12-22 22:24:04 INFO Epoch 010 | train_mse=0.077066 | val_loss=0.110029 | best_val_loss=0.240184
2025-12-22 22:24:15 INFO Epoch 011 | 25% complete (batch 181/724)
2025-12-22 22:24:18 INFO Epoch 011 | 50% complete (batch 362/724)
2025-12-22 22:24:22 INFO Epoch 011 | 75% complete (batch 543/724)
2025-12-22 22:24:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.581516
2025-12-22 22:24:40 INFO Tuning ranking metrics: regret=0.149359 spearman=0.179654 (groups=40, skipped=311)
2025-12-22 22:24:40 INFO Epoch 011 | train_mse=0.074481 | val_loss=0.077984 | best_val_loss=0.240184
2025-12-22 22:24:51 INFO Epoch 012 | 25% complete (batch 181/724)
2025-12-22 22:24:54 INFO Epoch 012 | 50% complete (batch 362/724)
2025-12-22 22:24:58 INFO Epoch 012 | 75% complete (batch 543/724)
2025-12-22 22:25:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.583095
2025-12-22 22:25:16 INFO Tuning ranking metrics: regret=0.134119 spearman=0.182175 (groups=40, skipped=311)
2025-12-22 22:25:16 INFO Epoch 012 | train_mse=0.079220 | val_loss=0.073068 | best_val_loss=0.240184
2025-12-22 22:25:26 INFO Epoch 013 | 25% complete (batch 181/724)
2025-12-22 22:25:30 INFO Epoch 013 | 50% complete (batch 362/724)
2025-12-22 22:25:33 INFO Epoch 013 | 75% complete (batch 543/724)
2025-12-22 22:25:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.588529
2025-12-22 22:25:51 INFO Tuning ranking metrics: regret=0.134271 spearman=0.178739 (groups=40, skipped=311)
2025-12-22 22:25:51 INFO Epoch 013 | train_mse=0.079944 | val_loss=0.080382 | best_val_loss=0.240184
2025-12-22 22:26:02 INFO Epoch 014 | 25% complete (batch 181/724)
2025-12-22 22:26:05 INFO Epoch 014 | 50% complete (batch 362/724)
2025-12-22 22:26:08 INFO Epoch 014 | 75% complete (batch 543/724)
2025-12-22 22:26:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.572324
2025-12-22 22:26:27 INFO Tuning ranking metrics: regret=0.116926 spearman=0.188745 (groups=40, skipped=311)
2025-12-22 22:26:27 INFO Epoch 014 | train_mse=0.084830 | val_loss=0.111154 | best_val_loss=0.240184
2025-12-22 22:26:37 INFO Epoch 015 | 25% complete (batch 181/724)
2025-12-22 22:26:41 INFO Epoch 015 | 50% complete (batch 362/724)
2025-12-22 22:26:44 INFO Epoch 015 | 75% complete (batch 543/724)
2025-12-22 22:26:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.583999
2025-12-22 22:27:03 INFO Tuning ranking metrics: regret=0.134116 spearman=0.186948 (groups=40, skipped=311)
2025-12-22 22:27:03 INFO Epoch 015 | train_mse=0.071099 | val_loss=0.092548 | best_val_loss=0.240184
2025-12-22 22:27:13 INFO Epoch 016 | 25% complete (batch 181/724)
2025-12-22 22:27:16 INFO Epoch 016 | 50% complete (batch 362/724)
2025-12-22 22:27:19 INFO Epoch 016 | 75% complete (batch 543/724)
2025-12-22 22:27:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.603737
2025-12-22 22:27:38 INFO Tuning ranking metrics: regret=0.115178 spearman=0.248030 (groups=40, skipped=311)
2025-12-22 22:27:38 INFO Epoch 016 | train_mse=0.089037 | val_loss=0.091201 | best_val_loss=0.240184
Metric tuning_rank_spearman improved by 0.008 >= min_delta = 0.0. New best score: 0.248
2025-12-22 22:27:48 INFO Epoch 017 | 25% complete (batch 181/724)
2025-12-22 22:27:52 INFO Epoch 017 | 50% complete (batch 362/724)
2025-12-22 22:27:55 INFO Epoch 017 | 75% complete (batch 543/724)
2025-12-22 22:28:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.617735
2025-12-22 22:28:14 INFO Tuning ranking metrics: regret=0.115203 spearman=0.218804 (groups=40, skipped=311)
2025-12-22 22:28:14 INFO Epoch 017 | train_mse=0.073485 | val_loss=0.067527 | best_val_loss=0.248030
2025-12-22 22:28:24 INFO Epoch 018 | 25% complete (batch 181/724)
2025-12-22 22:28:27 INFO Epoch 018 | 50% complete (batch 362/724)
2025-12-22 22:28:30 INFO Epoch 018 | 75% complete (batch 543/724)
2025-12-22 22:28:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.624590
2025-12-22 22:28:49 INFO Tuning ranking metrics: regret=0.115203 spearman=0.205097 (groups=40, skipped=311)
2025-12-22 22:28:49 INFO Epoch 018 | train_mse=0.065221 | val_loss=0.067523 | best_val_loss=0.248030
2025-12-22 22:29:00 INFO Epoch 019 | 25% complete (batch 181/724)
2025-12-22 22:29:03 INFO Epoch 019 | 50% complete (batch 362/724)
2025-12-22 22:29:06 INFO Epoch 019 | 75% complete (batch 543/724)
2025-12-22 22:29:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.632106
2025-12-22 22:29:25 INFO Tuning ranking metrics: regret=0.117373 spearman=0.167835 (groups=40, skipped=311)
2025-12-22 22:29:25 INFO Epoch 019 | train_mse=0.073585 | val_loss=0.068173 | best_val_loss=0.248030
2025-12-22 22:29:36 INFO Epoch 020 | 25% complete (batch 181/724)
2025-12-22 22:29:39 INFO Epoch 020 | 50% complete (batch 362/724)
2025-12-22 22:29:42 INFO Epoch 020 | 75% complete (batch 543/724)
2025-12-22 22:29:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.641103
2025-12-22 22:30:01 INFO Tuning ranking metrics: regret=0.117876 spearman=0.139838 (groups=40, skipped=311)
2025-12-22 22:30:01 INFO Epoch 020 | train_mse=0.065379 | val_loss=0.069789 | best_val_loss=0.248030
2025-12-22 22:30:12 INFO Epoch 021 | 25% complete (batch 181/724)
2025-12-22 22:30:15 INFO Epoch 021 | 50% complete (batch 362/724)
2025-12-22 22:30:19 INFO Epoch 021 | 75% complete (batch 543/724)
2025-12-22 22:30:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.637117
2025-12-22 22:30:37 INFO Tuning ranking metrics: regret=0.118694 spearman=0.167040 (groups=40, skipped=311)
2025-12-22 22:30:37 INFO Epoch 021 | train_mse=0.067158 | val_loss=0.074768 | best_val_loss=0.248030
2025-12-22 22:30:48 INFO Epoch 022 | 25% complete (batch 181/724)
2025-12-22 22:30:51 INFO Epoch 022 | 50% complete (batch 362/724)
2025-12-22 22:30:54 INFO Epoch 022 | 75% complete (batch 543/724)
2025-12-22 22:31:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.624089
2025-12-22 22:31:13 INFO Tuning ranking metrics: regret=0.118694 spearman=0.163755 (groups=40, skipped=311)
2025-12-22 22:31:13 INFO Epoch 022 | train_mse=0.064456 | val_loss=0.064944 | best_val_loss=0.248030
2025-12-22 22:31:24 INFO Epoch 023 | 25% complete (batch 181/724)
2025-12-22 22:31:27 INFO Epoch 023 | 50% complete (batch 362/724)
2025-12-22 22:31:31 INFO Epoch 023 | 75% complete (batch 543/724)
2025-12-22 22:31:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.636352
2025-12-22 22:31:49 INFO Tuning ranking metrics: regret=0.115593 spearman=0.155254 (groups=40, skipped=311)
2025-12-22 22:31:49 INFO Epoch 023 | train_mse=0.063881 | val_loss=0.061463 | best_val_loss=0.248030
2025-12-22 22:32:00 INFO Epoch 024 | 25% complete (batch 181/724)
2025-12-22 22:32:03 INFO Epoch 024 | 50% complete (batch 362/724)
2025-12-22 22:32:07 INFO Epoch 024 | 75% complete (batch 543/724)
2025-12-22 22:32:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.624169
2025-12-22 22:32:25 INFO Tuning ranking metrics: regret=0.117648 spearman=0.253290 (groups=40, skipped=311)
2025-12-22 22:32:25 INFO Epoch 024 | train_mse=0.069593 | val_loss=0.085636 | best_val_loss=0.248030
Metric tuning_rank_spearman improved by 0.005 >= min_delta = 0.0. New best score: 0.253
2025-12-22 22:32:36 INFO Epoch 025 | 25% complete (batch 181/724)
2025-12-22 22:32:40 INFO Epoch 025 | 50% complete (batch 362/724)
2025-12-22 22:32:43 INFO Epoch 025 | 75% complete (batch 543/724)
2025-12-22 22:32:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.615362
2025-12-22 22:33:02 INFO Tuning ranking metrics: regret=0.115179 spearman=0.226434 (groups=40, skipped=311)
2025-12-22 22:33:02 INFO Epoch 025 | train_mse=0.056156 | val_loss=0.088403 | best_val_loss=0.253290
2025-12-22 22:33:13 INFO Epoch 026 | 25% complete (batch 181/724)
2025-12-22 22:33:16 INFO Epoch 026 | 50% complete (batch 362/724)
2025-12-22 22:33:20 INFO Epoch 026 | 75% complete (batch 543/724)
2025-12-22 22:33:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.637080
2025-12-22 22:33:38 INFO Tuning ranking metrics: regret=0.121632 spearman=0.114751 (groups=40, skipped=311)
2025-12-22 22:33:38 INFO Epoch 026 | train_mse=0.063367 | val_loss=0.068012 | best_val_loss=0.253290
2025-12-22 22:33:49 INFO Epoch 027 | 25% complete (batch 181/724)
2025-12-22 22:33:53 INFO Epoch 027 | 50% complete (batch 362/724)
2025-12-22 22:33:56 INFO Epoch 027 | 75% complete (batch 543/724)
2025-12-22 22:34:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.642891
2025-12-22 22:34:15 INFO Tuning ranking metrics: regret=0.118280 spearman=0.211564 (groups=40, skipped=311)
2025-12-22 22:34:15 INFO Epoch 027 | train_mse=0.071429 | val_loss=0.075863 | best_val_loss=0.253290
2025-12-22 22:34:25 INFO Epoch 028 | 25% complete (batch 181/724)
2025-12-22 22:34:29 INFO Epoch 028 | 50% complete (batch 362/724)
2025-12-22 22:34:32 INFO Epoch 028 | 75% complete (batch 543/724)
2025-12-22 22:34:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.638727
2025-12-22 22:34:51 INFO Tuning ranking metrics: regret=0.112429 spearman=0.199811 (groups=40, skipped=311)
2025-12-22 22:34:51 INFO Epoch 028 | train_mse=0.068947 | val_loss=0.058648 | best_val_loss=0.253290
2025-12-22 22:35:02 INFO Epoch 029 | 25% complete (batch 181/724)
2025-12-22 22:35:05 INFO Epoch 029 | 50% complete (batch 362/724)
2025-12-22 22:35:09 INFO Epoch 029 | 75% complete (batch 543/724)
2025-12-22 22:35:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.650712
2025-12-22 22:35:27 INFO Tuning ranking metrics: regret=0.119232 spearman=0.192305 (groups=40, skipped=311)
2025-12-22 22:35:27 INFO Epoch 029 | train_mse=0.058892 | val_loss=0.070276 | best_val_loss=0.253290
2025-12-22 22:35:38 INFO Epoch 030 | 25% complete (batch 181/724)
2025-12-22 22:35:42 INFO Epoch 030 | 50% complete (batch 362/724)
2025-12-22 22:35:46 INFO Epoch 030 | 75% complete (batch 543/724)
2025-12-22 22:35:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.661351
2025-12-22 22:36:04 INFO Tuning ranking metrics: regret=0.123450 spearman=0.139681 (groups=40, skipped=311)
2025-12-22 22:36:04 INFO Epoch 030 | train_mse=0.056817 | val_loss=0.062553 | best_val_loss=0.253290
2025-12-22 22:36:15 INFO Epoch 031 | 25% complete (batch 181/724)
2025-12-22 22:36:18 INFO Epoch 031 | 50% complete (batch 362/724)
2025-12-22 22:36:22 INFO Epoch 031 | 75% complete (batch 543/724)
2025-12-22 22:36:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.682684
2025-12-22 22:36:40 INFO Tuning ranking metrics: regret=0.112583 spearman=0.265547 (groups=40, skipped=311)
2025-12-22 22:36:40 INFO Epoch 031 | train_mse=0.071727 | val_loss=0.059614 | best_val_loss=0.253290
Metric tuning_rank_spearman improved by 0.012 >= min_delta = 0.0. New best score: 0.266
2025-12-22 22:36:51 INFO Epoch 032 | 25% complete (batch 181/724)
2025-12-22 22:36:54 INFO Epoch 032 | 50% complete (batch 362/724)
2025-12-22 22:36:58 INFO Epoch 032 | 75% complete (batch 543/724)
2025-12-22 22:37:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.665624
2025-12-22 22:37:16 INFO Tuning ranking metrics: regret=0.098934 spearman=0.251315 (groups=40, skipped=311)
2025-12-22 22:37:16 INFO Epoch 032 | train_mse=0.059178 | val_loss=0.063377 | best_val_loss=0.265547
2025-12-22 22:37:27 INFO Epoch 033 | 25% complete (batch 181/724)
2025-12-22 22:37:30 INFO Epoch 033 | 50% complete (batch 362/724)
2025-12-22 22:37:34 INFO Epoch 033 | 75% complete (batch 543/724)
2025-12-22 22:37:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.669461
2025-12-22 22:37:53 INFO Tuning ranking metrics: regret=0.133200 spearman=0.179665 (groups=40, skipped=311)
2025-12-22 22:37:53 INFO Epoch 033 | train_mse=0.051601 | val_loss=0.059094 | best_val_loss=0.265547
2025-12-22 22:38:03 INFO Epoch 034 | 25% complete (batch 181/724)
2025-12-22 22:38:06 INFO Epoch 034 | 50% complete (batch 362/724)
2025-12-22 22:38:10 INFO Epoch 034 | 75% complete (batch 543/724)
2025-12-22 22:38:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.663162
2025-12-22 22:38:28 INFO Tuning ranking metrics: regret=0.141363 spearman=0.089275 (groups=40, skipped=311)
2025-12-22 22:38:28 INFO Epoch 034 | train_mse=0.059922 | val_loss=0.073239 | best_val_loss=0.265547
2025-12-22 22:38:39 INFO Epoch 035 | 25% complete (batch 181/724)
2025-12-22 22:38:42 INFO Epoch 035 | 50% complete (batch 362/724)
2025-12-22 22:38:46 INFO Epoch 035 | 75% complete (batch 543/724)
2025-12-22 22:38:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.680779
2025-12-22 22:39:05 INFO Tuning ranking metrics: regret=0.126422 spearman=0.064832 (groups=40, skipped=311)
2025-12-22 22:39:05 INFO Epoch 035 | train_mse=0.045156 | val_loss=0.059604 | best_val_loss=0.265547
2025-12-22 22:39:15 INFO Epoch 036 | 25% complete (batch 181/724)
2025-12-22 22:39:19 INFO Epoch 036 | 50% complete (batch 362/724)
2025-12-22 22:39:22 INFO Epoch 036 | 75% complete (batch 543/724)
2025-12-22 22:39:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.679023
2025-12-22 22:39:41 INFO Tuning ranking metrics: regret=0.078899 spearman=0.252614 (groups=40, skipped=311)
2025-12-22 22:39:41 INFO Epoch 036 | train_mse=0.063652 | val_loss=0.057718 | best_val_loss=0.265547
2025-12-22 22:39:52 INFO Epoch 037 | 25% complete (batch 181/724)
2025-12-22 22:39:55 INFO Epoch 037 | 50% complete (batch 362/724)
2025-12-22 22:39:59 INFO Epoch 037 | 75% complete (batch 543/724)
2025-12-22 22:40:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.675478
2025-12-22 22:40:17 INFO Tuning ranking metrics: regret=0.066816 spearman=0.245011 (groups=40, skipped=311)
2025-12-22 22:40:17 INFO Epoch 037 | train_mse=0.065779 | val_loss=0.058219 | best_val_loss=0.265547
2025-12-22 22:40:28 INFO Epoch 038 | 25% complete (batch 181/724)
2025-12-22 22:40:32 INFO Epoch 038 | 50% complete (batch 362/724)
2025-12-22 22:40:35 INFO Epoch 038 | 75% complete (batch 543/724)
2025-12-22 22:40:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.680265
2025-12-22 22:40:54 INFO Tuning ranking metrics: regret=0.066992 spearman=0.213463 (groups=40, skipped=311)
2025-12-22 22:40:54 INFO Epoch 038 | train_mse=0.054300 | val_loss=0.054846 | best_val_loss=0.265547
2025-12-22 22:41:05 INFO Epoch 039 | 25% complete (batch 181/724)
2025-12-22 22:41:08 INFO Epoch 039 | 50% complete (batch 362/724)
2025-12-22 22:41:11 INFO Epoch 039 | 75% complete (batch 543/724)
2025-12-22 22:41:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.688722
2025-12-22 22:41:30 INFO Tuning ranking metrics: regret=0.083461 spearman=0.175254 (groups=40, skipped=311)
2025-12-22 22:41:30 INFO Epoch 039 | train_mse=0.055125 | val_loss=0.054773 | best_val_loss=0.265547
2025-12-22 22:41:41 INFO Epoch 040 | 25% complete (batch 181/724)
2025-12-22 22:41:44 INFO Epoch 040 | 50% complete (batch 362/724)
2025-12-22 22:41:48 INFO Epoch 040 | 75% complete (batch 543/724)
2025-12-22 22:42:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.684948
2025-12-22 22:42:07 INFO Tuning ranking metrics: regret=0.076383 spearman=0.151607 (groups=40, skipped=311)
2025-12-22 22:42:07 INFO Epoch 040 | train_mse=0.054967 | val_loss=0.052269 | best_val_loss=0.265547
2025-12-22 22:42:17 INFO Epoch 041 | 25% complete (batch 181/724)
2025-12-22 22:42:21 INFO Epoch 041 | 50% complete (batch 362/724)
2025-12-22 22:42:24 INFO Epoch 041 | 75% complete (batch 543/724)
2025-12-22 22:42:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.688679
2025-12-22 22:42:43 INFO Tuning ranking metrics: regret=0.089311 spearman=0.163193 (groups=40, skipped=311)
2025-12-22 22:42:43 INFO Epoch 041 | train_mse=0.049744 | val_loss=0.053351 | best_val_loss=0.265547
2025-12-22 22:42:53 INFO Epoch 042 | 25% complete (batch 181/724)
2025-12-22 22:42:57 INFO Epoch 042 | 50% complete (batch 362/724)
2025-12-22 22:43:00 INFO Epoch 042 | 75% complete (batch 543/724)
2025-12-22 22:43:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.693769
2025-12-22 22:43:19 INFO Tuning ranking metrics: regret=0.091704 spearman=0.123669 (groups=40, skipped=311)
2025-12-22 22:43:19 INFO Epoch 042 | train_mse=0.053424 | val_loss=0.049298 | best_val_loss=0.265547
2025-12-22 22:43:29 INFO Epoch 043 | 25% complete (batch 181/724)
2025-12-22 22:43:33 INFO Epoch 043 | 50% complete (batch 362/724)
2025-12-22 22:43:36 INFO Epoch 043 | 75% complete (batch 543/724)
2025-12-22 22:43:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.694835
2025-12-22 22:43:55 INFO Tuning ranking metrics: regret=0.094259 spearman=0.103739 (groups=40, skipped=311)
2025-12-22 22:43:55 INFO Epoch 043 | train_mse=0.049183 | val_loss=0.055398 | best_val_loss=0.265547
2025-12-22 22:44:06 INFO Epoch 044 | 25% complete (batch 181/724)
2025-12-22 22:44:09 INFO Epoch 044 | 50% complete (batch 362/724)
2025-12-22 22:44:12 INFO Epoch 044 | 75% complete (batch 543/724)
2025-12-22 22:44:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.682542
2025-12-22 22:44:30 INFO Tuning ranking metrics: regret=0.081928 spearman=0.259518 (groups=40, skipped=311)
2025-12-22 22:44:30 INFO Epoch 044 | train_mse=0.052615 | val_loss=0.058556 | best_val_loss=0.265547
2025-12-22 22:44:41 INFO Epoch 045 | 25% complete (batch 181/724)
2025-12-22 22:44:45 INFO Epoch 045 | 50% complete (batch 362/724)
2025-12-22 22:44:48 INFO Epoch 045 | 75% complete (batch 543/724)
2025-12-22 22:45:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.660160
2025-12-22 22:45:06 INFO Tuning ranking metrics: regret=0.087547 spearman=0.134978 (groups=40, skipped=311)
2025-12-22 22:45:06 INFO Epoch 045 | train_mse=0.051016 | val_loss=0.057037 | best_val_loss=0.265547
2025-12-22 22:45:17 INFO Epoch 046 | 25% complete (batch 181/724)
2025-12-22 22:45:21 INFO Epoch 046 | 50% complete (batch 362/724)
2025-12-22 22:45:24 INFO Epoch 046 | 75% complete (batch 543/724)
2025-12-22 22:45:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.689889
2025-12-22 22:45:42 INFO Tuning ranking metrics: regret=0.077596 spearman=0.170471 (groups=40, skipped=311)
2025-12-22 22:45:42 INFO Epoch 046 | train_mse=0.053340 | val_loss=0.049674 | best_val_loss=0.265547
2025-12-22 22:45:53 INFO Epoch 047 | 25% complete (batch 181/724)
2025-12-22 22:45:57 INFO Epoch 047 | 50% complete (batch 362/724)
2025-12-22 22:46:00 INFO Epoch 047 | 75% complete (batch 543/724)
2025-12-22 22:46:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.681491
2025-12-22 22:46:19 INFO Tuning ranking metrics: regret=0.078730 spearman=0.081537 (groups=40, skipped=311)
2025-12-22 22:46:19 INFO Epoch 047 | train_mse=0.052956 | val_loss=0.063914 | best_val_loss=0.265547
2025-12-22 22:46:29 INFO Epoch 048 | 25% complete (batch 181/724)
2025-12-22 22:46:33 INFO Epoch 048 | 50% complete (batch 362/724)
2025-12-22 22:46:36 INFO Epoch 048 | 75% complete (batch 543/724)
2025-12-22 22:46:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.696882
2025-12-22 22:46:55 INFO Tuning ranking metrics: regret=0.067950 spearman=0.203312 (groups=40, skipped=311)
2025-12-22 22:46:55 INFO Epoch 048 | train_mse=0.044630 | val_loss=0.052726 | best_val_loss=0.265547
2025-12-22 22:47:06 INFO Epoch 049 | 25% complete (batch 181/724)
2025-12-22 22:47:09 INFO Epoch 049 | 50% complete (batch 362/724)
2025-12-22 22:47:13 INFO Epoch 049 | 75% complete (batch 543/724)
2025-12-22 22:47:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.676625
2025-12-22 22:47:32 INFO Tuning ranking metrics: regret=0.071316 spearman=0.160233 (groups=40, skipped=311)
2025-12-22 22:47:32 INFO Epoch 049 | train_mse=0.046416 | val_loss=0.056606 | best_val_loss=0.265547
2025-12-22 22:47:42 INFO Epoch 050 | 25% complete (batch 181/724)
2025-12-22 22:47:46 INFO Epoch 050 | 50% complete (batch 362/724)
2025-12-22 22:47:49 INFO Epoch 050 | 75% complete (batch 543/724)
2025-12-22 22:48:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.687847
2025-12-22 22:48:08 INFO Tuning ranking metrics: regret=0.074520 spearman=0.126991 (groups=40, skipped=311)
2025-12-22 22:48:08 INFO Epoch 050 | train_mse=0.045681 | val_loss=0.052123 | best_val_loss=0.265547
2025-12-22 22:48:19 INFO Epoch 051 | 25% complete (batch 181/724)
2025-12-22 22:48:22 INFO Epoch 051 | 50% complete (batch 362/724)
2025-12-22 22:48:26 INFO Epoch 051 | 75% complete (batch 543/724)
2025-12-22 22:48:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.707149
2025-12-22 22:48:44 INFO Tuning ranking metrics: regret=0.094096 spearman=0.108999 (groups=40, skipped=311)
2025-12-22 22:48:44 INFO Epoch 051 | train_mse=0.052186 | val_loss=0.052219 | best_val_loss=0.265547
2025-12-22 22:48:55 INFO Epoch 052 | 25% complete (batch 181/724)
2025-12-22 22:48:59 INFO Epoch 052 | 50% complete (batch 362/724)
2025-12-22 22:49:02 INFO Epoch 052 | 75% complete (batch 543/724)
2025-12-22 22:49:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.693077
2025-12-22 22:49:21 INFO Tuning ranking metrics: regret=0.105581 spearman=0.138095 (groups=40, skipped=311)
2025-12-22 22:49:21 INFO Epoch 052 | train_mse=0.048308 | val_loss=0.062201 | best_val_loss=0.265547
2025-12-22 22:49:32 INFO Epoch 053 | 25% complete (batch 181/724)
2025-12-22 22:49:35 INFO Epoch 053 | 50% complete (batch 362/724)
2025-12-22 22:49:38 INFO Epoch 053 | 75% complete (batch 543/724)
2025-12-22 22:49:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.679319
2025-12-22 22:49:57 INFO Tuning ranking metrics: regret=0.076248 spearman=0.096212 (groups=40, skipped=311)
2025-12-22 22:49:57 INFO Epoch 053 | train_mse=0.055716 | val_loss=0.051553 | best_val_loss=0.265547
2025-12-22 22:50:08 INFO Epoch 054 | 25% complete (batch 181/724)
2025-12-22 22:50:11 INFO Epoch 054 | 50% complete (batch 362/724)
2025-12-22 22:50:15 INFO Epoch 054 | 75% complete (batch 543/724)
2025-12-22 22:50:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.703168
2025-12-22 22:50:34 INFO Tuning ranking metrics: regret=0.063390 spearman=0.100698 (groups=40, skipped=311)
2025-12-22 22:50:34 INFO Epoch 054 | train_mse=0.049459 | val_loss=0.048769 | best_val_loss=0.265547
2025-12-22 22:50:44 INFO Epoch 055 | 25% complete (batch 181/724)
2025-12-22 22:50:48 INFO Epoch 055 | 50% complete (batch 362/724)
2025-12-22 22:50:51 INFO Epoch 055 | 75% complete (batch 543/724)
2025-12-22 22:51:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.703815
2025-12-22 22:51:11 INFO Tuning ranking metrics: regret=0.058565 spearman=0.164859 (groups=40, skipped=311)
2025-12-22 22:51:11 INFO Epoch 055 | train_mse=0.049249 | val_loss=0.050812 | best_val_loss=0.265547
2025-12-22 22:51:21 INFO Epoch 056 | 25% complete (batch 181/724)
2025-12-22 22:51:24 INFO Epoch 056 | 50% complete (batch 362/724)
2025-12-22 22:51:28 INFO Epoch 056 | 75% complete (batch 543/724)
2025-12-22 22:51:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.693037
2025-12-22 22:51:47 INFO Tuning ranking metrics: regret=0.058442 spearman=0.156548 (groups=40, skipped=311)
2025-12-22 22:51:47 INFO Epoch 056 | train_mse=0.046592 | val_loss=0.055060 | best_val_loss=0.265547
2025-12-22 22:51:57 INFO Epoch 057 | 25% complete (batch 181/724)
2025-12-22 22:52:01 INFO Epoch 057 | 50% complete (batch 362/724)
2025-12-22 22:52:04 INFO Epoch 057 | 75% complete (batch 543/724)
2025-12-22 22:52:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.687357
2025-12-22 22:52:23 INFO Tuning ranking metrics: regret=0.076132 spearman=0.118880 (groups=40, skipped=311)
2025-12-22 22:52:23 INFO Epoch 057 | train_mse=0.054948 | val_loss=0.047737 | best_val_loss=0.265547
2025-12-22 22:52:34 INFO Epoch 058 | 25% complete (batch 181/724)
2025-12-22 22:52:37 INFO Epoch 058 | 50% complete (batch 362/724)
2025-12-22 22:52:41 INFO Epoch 058 | 75% complete (batch 543/724)
2025-12-22 22:52:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.705197
2025-12-22 22:52:59 INFO Tuning ranking metrics: regret=0.077368 spearman=0.119654 (groups=40, skipped=311)
2025-12-22 22:52:59 INFO Epoch 058 | train_mse=0.048203 | val_loss=0.051145 | best_val_loss=0.265547
2025-12-22 22:53:10 INFO Epoch 059 | 25% complete (batch 181/724)
2025-12-22 22:53:14 INFO Epoch 059 | 50% complete (batch 362/724)
2025-12-22 22:53:17 INFO Epoch 059 | 75% complete (batch 543/724)
2025-12-22 22:53:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.719911
2025-12-22 22:53:35 INFO Tuning ranking metrics: regret=0.081667 spearman=0.073323 (groups=40, skipped=311)
2025-12-22 22:53:35 INFO Epoch 059 | train_mse=0.050296 | val_loss=0.047408 | best_val_loss=0.265547
2025-12-22 22:53:46 INFO Epoch 060 | 25% complete (batch 181/724)
2025-12-22 22:53:50 INFO Epoch 060 | 50% complete (batch 362/724)
2025-12-22 22:53:53 INFO Epoch 060 | 75% complete (batch 543/724)
2025-12-22 22:54:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.713996
2025-12-22 22:54:12 INFO Tuning ranking metrics: regret=0.074615 spearman=0.146737 (groups=40, skipped=311)
2025-12-22 22:54:12 INFO Epoch 060 | train_mse=0.053757 | val_loss=0.052080 | best_val_loss=0.265547
2025-12-22 22:54:23 INFO Epoch 061 | 25% complete (batch 181/724)
2025-12-22 22:54:26 INFO Epoch 061 | 50% complete (batch 362/724)
2025-12-22 22:54:30 INFO Epoch 061 | 75% complete (batch 543/724)
2025-12-22 22:54:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.674604
2025-12-22 22:54:48 INFO Tuning ranking metrics: regret=0.059899 spearman=0.202413 (groups=40, skipped=311)
2025-12-22 22:54:48 INFO Epoch 061 | train_mse=0.056362 | val_loss=0.079563 | best_val_loss=0.265547
2025-12-22 22:54:59 INFO Epoch 062 | 25% complete (batch 181/724)
2025-12-22 22:55:02 INFO Epoch 062 | 50% complete (batch 362/724)
2025-12-22 22:55:06 INFO Epoch 062 | 75% complete (batch 543/724)
2025-12-22 22:55:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.706719
2025-12-22 22:55:25 INFO Tuning ranking metrics: regret=0.060022 spearman=0.166412 (groups=40, skipped=311)
2025-12-22 22:55:25 INFO Epoch 062 | train_mse=0.050293 | val_loss=0.049163 | best_val_loss=0.265547
2025-12-22 22:55:35 INFO Epoch 063 | 25% complete (batch 181/724)
2025-12-22 22:55:38 INFO Epoch 063 | 50% complete (batch 362/724)
2025-12-22 22:55:42 INFO Epoch 063 | 75% complete (batch 543/724)
2025-12-22 22:55:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.693053
2025-12-22 22:56:01 INFO Tuning ranking metrics: regret=0.106625 spearman=0.133539 (groups=40, skipped=311)
2025-12-22 22:56:01 INFO Epoch 063 | train_mse=0.055021 | val_loss=0.061756 | best_val_loss=0.265547
2025-12-22 22:56:11 INFO Epoch 064 | 25% complete (batch 181/724)
2025-12-22 22:56:15 INFO Epoch 064 | 50% complete (batch 362/724)
2025-12-22 22:56:18 INFO Epoch 064 | 75% complete (batch 543/724)
2025-12-22 22:56:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.695984
2025-12-22 22:56:37 INFO Tuning ranking metrics: regret=0.093389 spearman=0.106997 (groups=40, skipped=311)
2025-12-22 22:56:37 INFO Epoch 064 | train_mse=0.042543 | val_loss=0.056423 | best_val_loss=0.265547
2025-12-22 22:56:48 INFO Epoch 065 | 25% complete (batch 181/724)
2025-12-22 22:56:52 INFO Epoch 065 | 50% complete (batch 362/724)
2025-12-22 22:56:55 INFO Epoch 065 | 75% complete (batch 543/724)
2025-12-22 22:57:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.698132
2025-12-22 22:57:14 INFO Tuning ranking metrics: regret=0.078205 spearman=0.111142 (groups=40, skipped=311)
2025-12-22 22:57:14 INFO Epoch 065 | train_mse=0.054069 | val_loss=0.055707 | best_val_loss=0.265547
2025-12-22 22:57:24 INFO Epoch 066 | 25% complete (batch 181/724)
2025-12-22 22:57:28 INFO Epoch 066 | 50% complete (batch 362/724)
2025-12-22 22:57:31 INFO Epoch 066 | 75% complete (batch 543/724)
2025-12-22 22:57:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.710854
2025-12-22 22:57:50 INFO Tuning ranking metrics: regret=0.077837 spearman=0.129416 (groups=40, skipped=311)
2025-12-22 22:57:50 INFO Epoch 066 | train_mse=0.047136 | val_loss=0.046381 | best_val_loss=0.265547
2025-12-22 22:58:01 INFO Epoch 067 | 25% complete (batch 181/724)
2025-12-22 22:58:04 INFO Epoch 067 | 50% complete (batch 362/724)
2025-12-22 22:58:08 INFO Epoch 067 | 75% complete (batch 543/724)
2025-12-22 22:58:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.717191
2025-12-22 22:58:26 INFO Tuning ranking metrics: regret=0.084300 spearman=0.038420 (groups=40, skipped=311)
2025-12-22 22:58:26 INFO Epoch 067 | train_mse=0.049906 | val_loss=0.043337 | best_val_loss=0.265547
2025-12-22 22:58:37 INFO Epoch 068 | 25% complete (batch 181/724)
2025-12-22 22:58:40 INFO Epoch 068 | 50% complete (batch 362/724)
2025-12-22 22:58:44 INFO Epoch 068 | 75% complete (batch 543/724)
2025-12-22 22:58:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.710220
2025-12-22 22:59:03 INFO Tuning ranking metrics: regret=0.091812 spearman=0.093956 (groups=40, skipped=311)
2025-12-22 22:59:03 INFO Epoch 068 | train_mse=0.045523 | val_loss=0.059257 | best_val_loss=0.265547
2025-12-22 22:59:13 INFO Epoch 069 | 25% complete (batch 181/724)
2025-12-22 22:59:17 INFO Epoch 069 | 50% complete (batch 362/724)
2025-12-22 22:59:20 INFO Epoch 069 | 75% complete (batch 543/724)
2025-12-22 22:59:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.710730
2025-12-22 22:59:39 INFO Tuning ranking metrics: regret=0.064727 spearman=0.139389 (groups=40, skipped=311)
2025-12-22 22:59:39 INFO Epoch 069 | train_mse=0.048302 | val_loss=0.047450 | best_val_loss=0.265547
2025-12-22 22:59:50 INFO Epoch 070 | 25% complete (batch 181/724)
2025-12-22 22:59:53 INFO Epoch 070 | 50% complete (batch 362/724)
2025-12-22 22:59:56 INFO Epoch 070 | 75% complete (batch 543/724)
2025-12-22 23:00:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.704529
2025-12-22 23:00:15 INFO Tuning ranking metrics: regret=0.064734 spearman=0.116098 (groups=40, skipped=311)
2025-12-22 23:00:15 INFO Epoch 070 | train_mse=0.047071 | val_loss=0.059048 | best_val_loss=0.265547
2025-12-22 23:00:26 INFO Epoch 071 | 25% complete (batch 181/724)
2025-12-22 23:00:29 INFO Epoch 071 | 50% complete (batch 362/724)
2025-12-22 23:00:32 INFO Epoch 071 | 75% complete (batch 543/724)
2025-12-22 23:00:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.712509
2025-12-22 23:00:51 INFO Tuning ranking metrics: regret=0.062788 spearman=0.123582 (groups=40, skipped=311)
2025-12-22 23:00:51 INFO Epoch 071 | train_mse=0.047399 | val_loss=0.047605 | best_val_loss=0.265547
2025-12-22 23:01:02 INFO Epoch 072 | 25% complete (batch 181/724)
2025-12-22 23:01:05 INFO Epoch 072 | 50% complete (batch 362/724)
2025-12-22 23:01:08 INFO Epoch 072 | 75% complete (batch 543/724)
2025-12-22 23:01:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.719440
2025-12-22 23:01:27 INFO Tuning ranking metrics: regret=0.061328 spearman=0.123874 (groups=40, skipped=311)
2025-12-22 23:01:27 INFO Epoch 072 | train_mse=0.046025 | val_loss=0.048265 | best_val_loss=0.265547
2025-12-22 23:01:38 INFO Epoch 073 | 25% complete (batch 181/724)
2025-12-22 23:01:41 INFO Epoch 073 | 50% complete (batch 362/724)
2025-12-22 23:01:45 INFO Epoch 073 | 75% complete (batch 543/724)
2025-12-22 23:01:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.714568
2025-12-22 23:02:04 INFO Tuning ranking metrics: regret=0.062785 spearman=0.114610 (groups=40, skipped=311)
2025-12-22 23:02:04 INFO Epoch 073 | train_mse=0.046602 | val_loss=0.054474 | best_val_loss=0.265547
2025-12-22 23:02:14 INFO Epoch 074 | 25% complete (batch 181/724)
2025-12-22 23:02:17 INFO Epoch 074 | 50% complete (batch 362/724)
2025-12-22 23:02:21 INFO Epoch 074 | 75% complete (batch 543/724)
2025-12-22 23:02:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.716918
2025-12-22 23:02:40 INFO Tuning ranking metrics: regret=0.077345 spearman=0.127359 (groups=40, skipped=311)
2025-12-22 23:02:40 INFO Epoch 074 | train_mse=0.051481 | val_loss=0.048060 | best_val_loss=0.265547
2025-12-22 23:02:51 INFO Epoch 075 | 25% complete (batch 181/724)
2025-12-22 23:02:54 INFO Epoch 075 | 50% complete (batch 362/724)
2025-12-22 23:02:58 INFO Epoch 075 | 75% complete (batch 543/724)
2025-12-22 23:03:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.699291
2025-12-22 23:03:17 INFO Tuning ranking metrics: regret=0.065385 spearman=0.113268 (groups=40, skipped=311)
2025-12-22 23:03:17 INFO Epoch 075 | train_mse=0.046492 | val_loss=0.061020 | best_val_loss=0.265547
2025-12-22 23:03:28 INFO Epoch 076 | 25% complete (batch 181/724)
2025-12-22 23:03:31 INFO Epoch 076 | 50% complete (batch 362/724)
2025-12-22 23:03:35 INFO Epoch 076 | 75% complete (batch 543/724)
2025-12-22 23:03:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.722031
2025-12-22 23:03:54 INFO Tuning ranking metrics: regret=0.058086 spearman=0.173312 (groups=40, skipped=311)
2025-12-22 23:03:54 INFO Epoch 076 | train_mse=0.047238 | val_loss=0.046517 | best_val_loss=0.265547
2025-12-22 23:04:04 INFO Epoch 077 | 25% complete (batch 181/724)
2025-12-22 23:04:07 INFO Epoch 077 | 50% complete (batch 362/724)
2025-12-22 23:04:11 INFO Epoch 077 | 75% complete (batch 543/724)
2025-12-22 23:04:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.721221
2025-12-22 23:04:30 INFO Tuning ranking metrics: regret=0.063526 spearman=0.150855 (groups=40, skipped=311)
2025-12-22 23:04:30 INFO Epoch 077 | train_mse=0.046890 | val_loss=0.047998 | best_val_loss=0.265547
2025-12-22 23:04:40 INFO Epoch 078 | 25% complete (batch 181/724)
2025-12-22 23:04:43 INFO Epoch 078 | 50% complete (batch 362/724)
2025-12-22 23:04:47 INFO Epoch 078 | 75% complete (batch 543/724)
2025-12-22 23:05:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.706905
2025-12-22 23:05:06 INFO Tuning ranking metrics: regret=0.077058 spearman=0.112457 (groups=40, skipped=311)
2025-12-22 23:05:06 INFO Epoch 078 | train_mse=0.039586 | val_loss=0.065177 | best_val_loss=0.265547
2025-12-22 23:05:17 INFO Epoch 079 | 25% complete (batch 181/724)
2025-12-22 23:05:20 INFO Epoch 079 | 50% complete (batch 362/724)
2025-12-22 23:05:24 INFO Epoch 079 | 75% complete (batch 543/724)
2025-12-22 23:05:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.722295
2025-12-22 23:05:42 INFO Tuning ranking metrics: regret=0.061808 spearman=0.108274 (groups=40, skipped=311)
2025-12-22 23:05:42 INFO Epoch 079 | train_mse=0.042611 | val_loss=0.047580 | best_val_loss=0.265547
2025-12-22 23:05:53 INFO Epoch 080 | 25% complete (batch 181/724)
2025-12-22 23:05:57 INFO Epoch 080 | 50% complete (batch 362/724)
2025-12-22 23:06:00 INFO Epoch 080 | 75% complete (batch 543/724)
2025-12-22 23:06:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.704094
2025-12-22 23:06:19 INFO Tuning ranking metrics: regret=0.102252 spearman=0.211510 (groups=40, skipped=311)
2025-12-22 23:06:19 INFO Epoch 080 | train_mse=0.055750 | val_loss=0.065049 | best_val_loss=0.265547
2025-12-22 23:06:30 INFO Epoch 081 | 25% complete (batch 181/724)
2025-12-22 23:06:33 INFO Epoch 081 | 50% complete (batch 362/724)
2025-12-22 23:06:37 INFO Epoch 081 | 75% complete (batch 543/724)
2025-12-22 23:06:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.668486
2025-12-22 23:06:55 INFO Tuning ranking metrics: regret=0.057089 spearman=0.204675 (groups=40, skipped=311)
2025-12-22 23:06:55 INFO Epoch 081 | train_mse=0.044548 | val_loss=0.065504 | best_val_loss=0.265547
Monitored metric tuning_rank_spearman did not improve in the last 50 records. Best score: 0.266. Signaling Trainer to stop.
2025-12-22 23:06:56 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.25329_val-0.08564_epoch024.chkpt, checkpoint.tuning_rank_spearman-0.25952_val-0.05856_epoch044.chkpt, checkpoint.tuning_rank_spearman-0.26555_val-0.05961_epoch031.chkpt
2025-12-22 23:06:56 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-22_22-17-23/model_checkpoints/checkpoint.tuning_rank_spearman-0.26555_val-0.05961_epoch031.chkpt
2025-12-22 23:06:56 INFO Best validation loss: tensor(0.2655)
2025-12-22 23:06:56 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-22_22-17-23/model_checkpoints/checkpoint.tuning_rank_spearman-0.26555_val-0.05961_epoch031.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-22_22-17-23/model_checkpoints/checkpoint.tuning_rank_spearman-0.26555_val-0.05961_epoch031.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-22 23:07:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.059614
2025-12-22 23:07:11 INFO Tuning ranking metrics: regret=0.112583 spearman=0.265547 (groups=40, skipped=311)
2025-12-22 23:07:11 INFO Epoch 082 | val_loss=0.059614 | best_val_loss=0.265547
2025-12-22 23:07:11 INFO Validation metrics: [{'val_loss': 0.05961357429623604, 'tuning_rank_regret': 0.1125834584236145, 'tuning_rank_spearman': 0.2655465304851532, 'val_pearson_corr': 0.7764645218849182, 'val_spearman_corr': 0.729000985622406, 'val_rank_regret': 0.06932705640792847, 'val_rank_spearman': 0.21077440679073334}]
2025-12-22 23:07:11 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.26555_val-0.05961_epoch031.chkpt
2025-12-22 23:07:11 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.25329_val-0.08564_epoch024.chkpt
2025-12-22 23:07:11 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.25952_val-0.05856_epoch044.chkpt
2025-12-22 23:07:11 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.05865_epoch028.ckpt
2025-12-22 23:07:11 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.1125834584236145
  tuning_rank_spearman      0.2655465304851532
        val_loss            0.05961357429623604
    val_pearson_corr        0.7764645218849182
     val_rank_regret        0.06932705640792847
    val_rank_spearman       0.21077440679073334
    val_spearman_corr        0.729000985622406
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run polish_lr_low_seed888_2025-12-22_22-17-23 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-22_22-17-23
[train_cli][batch] job 'polish_lr_low_seed888' finished.
[run_full_pipeline] Best run: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49 (tuning_rank_spearman=0.14742599427700043)
[run_full_pipeline] Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49/model_checkpoints/checkpoint.tuning_rank_spearman-0.14743_val-0.13987_epoch011.chkpt
[run_full_pipeline] Phase 1 fine-tuning -> polish_seed101_2025-12-22_18-34-49_phase1
[train_cli] run_id=polish_seed101_2025-12-22_18-34-49_phase1 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase1/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase1 --git-commit 150d1dcbd1 --git-dirty --resume-from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49/model_checkpoints/checkpoint.tuning_rank_spearman-0.14743_val-0.13987_epoch011.chkpt
2025-12-22 23:07:17 INFO git_commit = 150d1dcbd1 (dirty)
2025-12-22 23:07:17 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-22 23:07:17 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase1/config/config.yaml
2025-12-22 23:07:17 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data
2025-12-22 23:07:17 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-22 23:07:17 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-22 23:07:17 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase1
2025-12-22 23:07:17 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-22 23:07:17 INFO   metadata_path = None
2025-12-22 23:07:17 INFO   summary_path = None
2025-12-22 23:07:17 INFO   accelerator = cpu
2025-12-22 23:07:17 INFO   devices = 1
2025-12-22 23:07:17 INFO   attention_head = 8
2025-12-22 23:07:17 INFO   pooling_type = mean
2025-12-22 23:07:17 INFO   model_self_loops = False
2025-12-22 23:07:17 INFO   model_self_loop_fill = mean
2025-12-22 23:07:17 INFO   model_residual = False
2025-12-22 23:07:17 INFO   batch_size = 48
2025-12-22 23:07:17 INFO   learning_rate = 0.001
2025-12-22 23:07:17 INFO   num_epochs = 320
2025-12-22 23:07:17 INFO   accumulate_grad_batches = 8
2025-12-22 23:07:17 INFO   seed = 222
2025-12-22 23:07:17 INFO   num_workers = 2
2025-12-22 23:07:17 INFO   precision = 32
2025-12-22 23:07:17 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-22 23:07:17 INFO   early_stopping_patience = 20
2025-12-22 23:07:17 INFO   lr_scheduler_patience = 4
2025-12-22 23:07:17 INFO   lr_scheduler_factor = 0.2
2025-12-22 23:07:17 INFO   fast_dev_run = False
2025-12-22 23:07:17 INFO   limit_train_batches = None
2025-12-22 23:07:17 INFO   limit_val_batches = None
2025-12-22 23:07:17 INFO   log_lr = False
2025-12-22 23:07:17 INFO   progress_bar_refresh_rate = 0
2025-12-22 23:07:17 INFO   log_every_n_steps = 100
2025-12-22 23:07:17 INFO   use_val_spearman_as_secondary = True
2025-12-22 23:07:17 INFO   spearman_secondary_min_delta = 0.0
2025-12-22 23:07:17 INFO   spearman_secondary_weight = 1.0
2025-12-22 23:07:17 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-22 23:07:17 INFO   tuning_max_samples = 500
2025-12-22 23:07:17 INFO   tuning_fraction = None
2025-12-22 23:07:17 INFO   tuning_eval_every = 1
2025-12-22 23:07:17 INFO   rank_loss_weight = 0.0
2025-12-22 23:07:17 INFO   rank_loss_margin = 0.0
2025-12-22 23:07:17 INFO   rank_loss_mode = hinge
2025-12-22 23:07:17 INFO   rank_loss_grouped = True
2025-12-22 23:07:17 INFO   variance_reduction_enabled = False
2025-12-22 23:07:17 INFO   variance_reduction_method = topk_avg
2025-12-22 23:07:17 INFO   variance_reduction_top_k = 3
2025-12-22 23:07:17 INFO   coverage_minimum = 0.0
2025-12-22 23:07:17 INFO   coverage_fail_on_missing = False
2025-12-22 23:07:17 INFO   graph_load_profiling = False
2025-12-22 23:07:17 INFO   graph_load_top_k = 5
2025-12-22 23:07:17 INFO   enable_graph_cache = True
2025-12-22 23:07:17 INFO   graph_cache_size = 256
2025-12-22 23:07:17 INFO   canonicalize_on_load = False
2025-12-22 23:07:17 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-22 23:07:17 INFO   edge_schema = {}
2025-12-22 23:07:17 INFO   topology_schema = {}
Seed set to 222
2025-12-22 23:07:17 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-22 23:07:17 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 23:07:17 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-22 23:07:17 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 23:07:17 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-22 23:07:17 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 23:07:18 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-22 23:07:18 INFO Tuning group stats: groups=352 groups>=2=34 singletons=318 max_group=11
2025-12-22 23:07:18 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase1/dataset_coverage.json
2025-12-22 23:07:18 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase1/dataset_coverage.json for details.
2025-12-22 23:07:18 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase1/dataset_coverage.json for details.
2025-12-22 23:07:18 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase1/dataset_coverage.json for details.
2025-12-22 23:07:18 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase1/schema_summary.json
2025-12-22 23:07:18 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase1/feature_metadata.json
2025-12-22 23:07:18 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-22 23:07:18 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/feature-config.yaml.topoqa.10A.2, sha256=5c62898155179232a565e24d9fbd7b208f9ce480d1a19d6139de19454e173ff0
2025-12-22 23:07:18 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/work/edge_features)
2025-12-22 23:07:18 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json
2025-12-22 23:07:18 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase1/schema_summary.json
2025-12-22 23:07:18 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-22 23:07:18 INFO Topology: topology/persistence_basic/v1 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 172-dimensional node features.
2025-12-22 23:07:18 INFO Node: node/dssp_topo_merge/v1; metadata lists 172 feature columns matching the .pt tensor.
2025-12-22 23:07:18 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-22 23:07:18 INFO → Total feature dimensionality observed and confirmed: node_dim = 172, edge_dim = 11.
2025-12-22 23:07:18 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-22 23:07:18 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 172,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 172,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase1/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge/v1",
      "alias": "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA",
      "jobs": 16,
      "summary": "DSSP-derived node features merged with topology statistics."
    },
    "topology": {
      "id": "topology/persistence_basic/v1",
      "alias": "Betti 0 and Betti 1 topology summaries on interface coords = 140D PH | TopoQA",
      "jobs": 16,
      "summary": "Persistent homology features with configurable distance thresholds."
    }
  },
  "notes": []
}
2025-12-22 23:07:18 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-22 23:07:18 INFO Resuming from checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49/model_checkpoints/checkpoint.tuning_rank_spearman-0.14743_val-0.13987_epoch011.chkpt (epoch=11)
2025-12-22 23:07:19 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=59b26f8270244b4ea9b60689cae3912e)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-22 23:07:19 INFO Starting training (fast_dev_run=False)
2025-12-22 23:07:19 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase1/model_checkpoints exists and is not empty.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49/model_checkpoints/checkpoint.tuning_rank_spearman-0.14743_val-0.13987_epoch011.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49/model_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase1/model_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49/model_checkpoints/val_loss_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase1/model_checkpoints/val_loss_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 5.5 K  | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
165 K     Trainable params
0         Non-trainable params
165 K     Total params
0.662     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
Restored all states from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49/model_checkpoints/checkpoint.tuning_rank_spearman-0.14743_val-0.13987_epoch011.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-22 23:07:33 INFO Epoch 012 | 25% complete (batch 46/181)
2025-12-22 23:07:34 INFO Epoch 012 | 50% complete (batch 91/181)
2025-12-22 23:07:35 INFO Epoch 012 | 75% complete (batch 136/181)
2025-12-22 23:07:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.140908
2025-12-22 23:07:48 INFO Tuning ranking metrics: regret=0.102786 spearman=0.053896 (groups=34, skipped=318)
2025-12-22 23:07:48 INFO Epoch 012 | val_loss=0.140908
2025-12-22 23:07:56 INFO Epoch 013 | 25% complete (batch 46/181)
2025-12-22 23:07:57 INFO Epoch 013 | 50% complete (batch 91/181)
2025-12-22 23:07:58 INFO Epoch 013 | 75% complete (batch 136/181)
2025-12-22 23:08:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.351974
2025-12-22 23:08:11 INFO Tuning ranking metrics: regret=0.103131 spearman=0.080564 (groups=34, skipped=318)
2025-12-22 23:08:11 INFO Epoch 013 | train_mse=0.140925 | val_loss=0.136678 | best_val_loss=0.053896
2025-12-22 23:08:19 INFO Epoch 014 | 25% complete (batch 46/181)
2025-12-22 23:08:20 INFO Epoch 014 | 50% complete (batch 91/181)
2025-12-22 23:08:21 INFO Epoch 014 | 75% complete (batch 136/181)
2025-12-22 23:08:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.418912
2025-12-22 23:08:35 INFO Tuning ranking metrics: regret=0.093583 spearman=0.012751 (groups=34, skipped=318)
2025-12-22 23:08:35 INFO Epoch 014 | train_mse=0.148800 | val_loss=0.101179 | best_val_loss=0.080564
2025-12-22 23:08:43 INFO Epoch 015 | 25% complete (batch 46/181)
2025-12-22 23:08:44 INFO Epoch 015 | 50% complete (batch 91/181)
2025-12-22 23:08:44 INFO Epoch 015 | 75% complete (batch 136/181)
2025-12-22 23:08:53 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.504236
2025-12-22 23:08:58 INFO Tuning ranking metrics: regret=0.136866 spearman=-0.076120 (groups=34, skipped=318)
2025-12-22 23:08:58 INFO Epoch 015 | train_mse=0.141942 | val_loss=0.095803 | best_val_loss=0.080564
2025-12-22 23:09:06 INFO Epoch 016 | 25% complete (batch 46/181)
2025-12-22 23:09:07 INFO Epoch 016 | 50% complete (batch 91/181)
2025-12-22 23:09:08 INFO Epoch 016 | 75% complete (batch 136/181)
2025-12-22 23:09:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.504988
2025-12-22 23:09:21 INFO Tuning ranking metrics: regret=0.124694 spearman=-0.029940 (groups=34, skipped=318)
2025-12-22 23:09:21 INFO Epoch 016 | train_mse=0.107173 | val_loss=0.108733 | best_val_loss=0.080564
2025-12-22 23:09:29 INFO Epoch 017 | 25% complete (batch 46/181)
2025-12-22 23:09:30 INFO Epoch 017 | 50% complete (batch 91/181)
2025-12-22 23:09:31 INFO Epoch 017 | 75% complete (batch 136/181)
2025-12-22 23:09:40 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.540353
2025-12-22 23:09:45 INFO Tuning ranking metrics: regret=0.138249 spearman=-0.083613 (groups=34, skipped=318)
2025-12-22 23:09:45 INFO Epoch 017 | train_mse=0.105722 | val_loss=0.095283 | best_val_loss=0.080564
2025-12-22 23:09:53 INFO Epoch 018 | 25% complete (batch 46/181)
2025-12-22 23:09:54 INFO Epoch 018 | 50% complete (batch 91/181)
2025-12-22 23:09:55 INFO Epoch 018 | 75% complete (batch 136/181)
2025-12-22 23:10:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.590495
2025-12-22 23:10:08 INFO Tuning ranking metrics: regret=0.112578 spearman=-0.005991 (groups=34, skipped=318)
2025-12-22 23:10:08 INFO Epoch 018 | train_mse=0.105952 | val_loss=0.095326 | best_val_loss=0.080564
2025-12-22 23:10:16 INFO Epoch 019 | 25% complete (batch 46/181)
2025-12-22 23:10:17 INFO Epoch 019 | 50% complete (batch 91/181)
2025-12-22 23:10:18 INFO Epoch 019 | 75% complete (batch 136/181)
2025-12-22 23:10:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.585330
2025-12-22 23:10:31 INFO Tuning ranking metrics: regret=0.094383 spearman=-0.027228 (groups=34, skipped=318)
2025-12-22 23:10:31 INFO Epoch 019 | train_mse=0.120549 | val_loss=0.087546 | best_val_loss=0.080564
2025-12-22 23:10:40 INFO Epoch 020 | 25% complete (batch 46/181)
2025-12-22 23:10:41 INFO Epoch 020 | 50% complete (batch 91/181)
2025-12-22 23:10:42 INFO Epoch 020 | 75% complete (batch 136/181)
2025-12-22 23:10:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.591330
2025-12-22 23:10:55 INFO Tuning ranking metrics: regret=0.093642 spearman=-0.039496 (groups=34, skipped=318)
2025-12-22 23:10:55 INFO Epoch 020 | train_mse=0.093934 | val_loss=0.078964 | best_val_loss=0.080564
2025-12-22 23:11:03 INFO Epoch 021 | 25% complete (batch 46/181)
2025-12-22 23:11:04 INFO Epoch 021 | 50% complete (batch 91/181)
2025-12-22 23:11:05 INFO Epoch 021 | 75% complete (batch 136/181)
2025-12-22 23:11:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.581855
2025-12-22 23:11:18 INFO Tuning ranking metrics: regret=0.093452 spearman=-0.034282 (groups=34, skipped=318)
2025-12-22 23:11:18 INFO Epoch 021 | train_mse=0.069871 | val_loss=0.092966 | best_val_loss=0.080564
2025-12-22 23:11:26 INFO Epoch 022 | 25% complete (batch 46/181)
2025-12-22 23:11:27 INFO Epoch 022 | 50% complete (batch 91/181)
2025-12-22 23:11:28 INFO Epoch 022 | 75% complete (batch 136/181)
2025-12-22 23:11:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.577172
2025-12-22 23:11:41 INFO Tuning ranking metrics: regret=0.114547 spearman=-0.036637 (groups=34, skipped=318)
2025-12-22 23:11:41 INFO Epoch 022 | train_mse=0.109067 | val_loss=0.084470 | best_val_loss=0.080564
2025-12-22 23:11:50 INFO Epoch 023 | 25% complete (batch 46/181)
2025-12-22 23:11:51 INFO Epoch 023 | 50% complete (batch 91/181)
2025-12-22 23:11:52 INFO Epoch 023 | 75% complete (batch 136/181)
2025-12-22 23:12:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.584658
2025-12-22 23:12:05 INFO Tuning ranking metrics: regret=0.114543 spearman=-0.035727 (groups=34, skipped=318)
2025-12-22 23:12:05 INFO Epoch 023 | train_mse=0.083626 | val_loss=0.081176 | best_val_loss=0.080564
2025-12-22 23:12:13 INFO Epoch 024 | 25% complete (batch 46/181)
2025-12-22 23:12:14 INFO Epoch 024 | 50% complete (batch 91/181)
2025-12-22 23:12:15 INFO Epoch 024 | 75% complete (batch 136/181)
2025-12-22 23:12:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.595002
2025-12-22 23:12:28 INFO Tuning ranking metrics: regret=0.114707 spearman=-0.016183 (groups=34, skipped=318)
2025-12-22 23:12:28 INFO Epoch 024 | train_mse=0.105814 | val_loss=0.075375 | best_val_loss=0.080564
2025-12-22 23:12:36 INFO Epoch 025 | 25% complete (batch 46/181)
2025-12-22 23:12:37 INFO Epoch 025 | 50% complete (batch 91/181)
2025-12-22 23:12:38 INFO Epoch 025 | 75% complete (batch 136/181)
2025-12-22 23:12:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.590338
2025-12-22 23:12:52 INFO Tuning ranking metrics: regret=0.093478 spearman=-0.055494 (groups=34, skipped=318)
2025-12-22 23:12:52 INFO Epoch 025 | train_mse=0.093333 | val_loss=0.090855 | best_val_loss=0.080564
2025-12-22 23:13:00 INFO Epoch 026 | 25% complete (batch 46/181)
2025-12-22 23:13:00 INFO Epoch 026 | 50% complete (batch 91/181)
2025-12-22 23:13:01 INFO Epoch 026 | 75% complete (batch 136/181)
2025-12-22 23:13:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.564646
2025-12-22 23:13:14 INFO Tuning ranking metrics: regret=0.091533 spearman=-0.034174 (groups=34, skipped=318)
2025-12-22 23:13:14 INFO Epoch 026 | train_mse=0.082609 | val_loss=0.103988 | best_val_loss=0.080564
2025-12-22 23:13:23 INFO Epoch 027 | 25% complete (batch 46/181)
2025-12-22 23:13:24 INFO Epoch 027 | 50% complete (batch 91/181)
2025-12-22 23:13:25 INFO Epoch 027 | 75% complete (batch 136/181)
2025-12-22 23:13:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.622468
2025-12-22 23:13:38 INFO Tuning ranking metrics: regret=0.091267 spearman=-0.048256 (groups=34, skipped=318)
2025-12-22 23:13:38 INFO Epoch 027 | train_mse=0.098048 | val_loss=0.080958 | best_val_loss=0.080564
2025-12-22 23:13:46 INFO Epoch 028 | 25% complete (batch 46/181)
2025-12-22 23:13:47 INFO Epoch 028 | 50% complete (batch 91/181)
2025-12-22 23:13:48 INFO Epoch 028 | 75% complete (batch 136/181)
2025-12-22 23:13:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.644522
2025-12-22 23:14:02 INFO Tuning ranking metrics: regret=0.091290 spearman=-0.043137 (groups=34, skipped=318)
2025-12-22 23:14:02 INFO Epoch 028 | train_mse=0.098432 | val_loss=0.072972 | best_val_loss=0.080564
2025-12-22 23:14:10 INFO Epoch 029 | 25% complete (batch 46/181)
2025-12-22 23:14:11 INFO Epoch 029 | 50% complete (batch 91/181)
2025-12-22 23:14:12 INFO Epoch 029 | 75% complete (batch 136/181)
2025-12-22 23:14:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.653722
2025-12-22 23:14:26 INFO Tuning ranking metrics: regret=0.091290 spearman=-0.021632 (groups=34, skipped=318)
2025-12-22 23:14:26 INFO Epoch 029 | train_mse=0.099429 | val_loss=0.075107 | best_val_loss=0.080564
2025-12-22 23:14:34 INFO Epoch 030 | 25% complete (batch 46/181)
2025-12-22 23:14:35 INFO Epoch 030 | 50% complete (batch 91/181)
2025-12-22 23:14:36 INFO Epoch 030 | 75% complete (batch 136/181)
2025-12-22 23:14:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.641131
2025-12-22 23:14:49 INFO Tuning ranking metrics: regret=0.093241 spearman=-0.016539 (groups=34, skipped=318)
2025-12-22 23:14:49 INFO Epoch 030 | train_mse=0.081550 | val_loss=0.094858 | best_val_loss=0.080564
2025-12-22 23:14:58 INFO Epoch 031 | 25% complete (batch 46/181)
2025-12-22 23:14:58 INFO Epoch 031 | 50% complete (batch 91/181)
2025-12-22 23:14:59 INFO Epoch 031 | 75% complete (batch 136/181)
2025-12-22 23:15:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.651808
2025-12-22 23:15:13 INFO Tuning ranking metrics: regret=0.094679 spearman=-0.011052 (groups=34, skipped=318)
2025-12-22 23:15:13 INFO Epoch 031 | train_mse=0.082161 | val_loss=0.070532 | best_val_loss=0.080564
2025-12-22 23:15:21 INFO Epoch 032 | 25% complete (batch 46/181)
2025-12-22 23:15:22 INFO Epoch 032 | 50% complete (batch 91/181)
2025-12-22 23:15:23 INFO Epoch 032 | 75% complete (batch 136/181)
2025-12-22 23:15:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.638708
2025-12-22 23:15:37 INFO Tuning ranking metrics: regret=0.075596 spearman=0.035008 (groups=34, skipped=318)
2025-12-22 23:15:37 INFO Epoch 032 | train_mse=0.079923 | val_loss=0.080597 | best_val_loss=0.080564
2025-12-22 23:15:45 INFO Epoch 033 | 25% complete (batch 46/181)
2025-12-22 23:15:46 INFO Epoch 033 | 50% complete (batch 91/181)
2025-12-22 23:15:47 INFO Epoch 033 | 75% complete (batch 136/181)
2025-12-22 23:15:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.610075
2025-12-22 23:16:00 INFO Tuning ranking metrics: regret=0.073161 spearman=0.024402 (groups=34, skipped=318)
2025-12-22 23:16:00 INFO Epoch 033 | train_mse=0.072110 | val_loss=0.093720 | best_val_loss=0.080564
2025-12-22 23:16:08 INFO Epoch 034 | 25% complete (batch 46/181)
2025-12-22 23:16:09 INFO Epoch 034 | 50% complete (batch 91/181)
2025-12-22 23:16:10 INFO Epoch 034 | 75% complete (batch 136/181)
2025-12-22 23:16:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.631228
2025-12-22 23:16:23 INFO Tuning ranking metrics: regret=0.072628 spearman=0.046384 (groups=34, skipped=318)
2025-12-22 23:16:23 INFO Epoch 034 | train_mse=0.096582 | val_loss=0.070472 | best_val_loss=0.080564
2025-12-22 23:16:32 INFO Epoch 035 | 25% complete (batch 46/181)
2025-12-22 23:16:33 INFO Epoch 035 | 50% complete (batch 91/181)
2025-12-22 23:16:34 INFO Epoch 035 | 75% complete (batch 136/181)
2025-12-22 23:16:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.632008
2025-12-22 23:16:47 INFO Tuning ranking metrics: regret=0.089719 spearman=-0.015483 (groups=34, skipped=318)
2025-12-22 23:16:47 INFO Epoch 035 | train_mse=0.099762 | val_loss=0.079064 | best_val_loss=0.080564
2025-12-22 23:16:55 INFO Epoch 036 | 25% complete (batch 46/181)
2025-12-22 23:16:56 INFO Epoch 036 | 50% complete (batch 91/181)
2025-12-22 23:16:57 INFO Epoch 036 | 75% complete (batch 136/181)
2025-12-22 23:17:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.657149
2025-12-22 23:17:11 INFO Tuning ranking metrics: regret=0.090811 spearman=0.039725 (groups=34, skipped=318)
2025-12-22 23:17:11 INFO Epoch 036 | train_mse=0.074913 | val_loss=0.070154 | best_val_loss=0.080564
2025-12-22 23:17:19 INFO Epoch 037 | 25% complete (batch 46/181)
2025-12-22 23:17:20 INFO Epoch 037 | 50% complete (batch 91/181)
2025-12-22 23:17:21 INFO Epoch 037 | 75% complete (batch 136/181)
2025-12-22 23:17:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.641668
2025-12-22 23:17:34 INFO Tuning ranking metrics: regret=0.090811 spearman=0.060453 (groups=34, skipped=318)
2025-12-22 23:17:34 INFO Epoch 037 | train_mse=0.087813 | val_loss=0.071936 | best_val_loss=0.080564
2025-12-22 23:17:42 INFO Epoch 038 | 25% complete (batch 46/181)
2025-12-22 23:17:43 INFO Epoch 038 | 50% complete (batch 91/181)
2025-12-22 23:17:44 INFO Epoch 038 | 75% complete (batch 136/181)
2025-12-22 23:17:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.629097
2025-12-22 23:17:58 INFO Tuning ranking metrics: regret=0.059999 spearman=0.053622 (groups=34, skipped=318)
2025-12-22 23:17:58 INFO Epoch 038 | train_mse=0.090690 | val_loss=0.077147 | best_val_loss=0.080564
2025-12-22 23:18:06 INFO Epoch 039 | 25% complete (batch 46/181)
2025-12-22 23:18:07 INFO Epoch 039 | 50% complete (batch 91/181)
2025-12-22 23:18:08 INFO Epoch 039 | 75% complete (batch 136/181)
2025-12-22 23:18:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.653228
2025-12-22 23:18:21 INFO Tuning ranking metrics: regret=0.069898 spearman=0.073249 (groups=34, skipped=318)
2025-12-22 23:18:21 INFO Epoch 039 | train_mse=0.077653 | val_loss=0.065993 | best_val_loss=0.080564
2025-12-22 23:18:30 INFO Epoch 040 | 25% complete (batch 46/181)
2025-12-22 23:18:31 INFO Epoch 040 | 50% complete (batch 91/181)
2025-12-22 23:18:32 INFO Epoch 040 | 75% complete (batch 136/181)
2025-12-22 23:18:40 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.643344
2025-12-22 23:18:45 INFO Tuning ranking metrics: regret=0.072350 spearman=0.064464 (groups=34, skipped=318)
2025-12-22 23:18:45 INFO Epoch 040 | train_mse=0.067438 | val_loss=0.085183 | best_val_loss=0.080564
2025-12-22 23:18:53 INFO Epoch 041 | 25% complete (batch 46/181)
2025-12-22 23:18:54 INFO Epoch 041 | 50% complete (batch 91/181)
2025-12-22 23:18:55 INFO Epoch 041 | 75% complete (batch 136/181)
2025-12-22 23:19:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.647744
2025-12-22 23:19:08 INFO Tuning ranking metrics: regret=0.072079 spearman=0.054291 (groups=34, skipped=318)
2025-12-22 23:19:08 INFO Epoch 041 | train_mse=0.088879 | val_loss=0.068627 | best_val_loss=0.080564
2025-12-22 23:19:17 INFO Epoch 042 | 25% complete (batch 46/181)
2025-12-22 23:19:18 INFO Epoch 042 | 50% complete (batch 91/181)
2025-12-22 23:19:19 INFO Epoch 042 | 75% complete (batch 136/181)
2025-12-22 23:19:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.637189
2025-12-22 23:19:32 INFO Tuning ranking metrics: regret=0.075391 spearman=0.049663 (groups=34, skipped=318)
2025-12-22 23:19:32 INFO Epoch 042 | train_mse=0.086224 | val_loss=0.078477 | best_val_loss=0.080564
2025-12-22 23:19:40 INFO Epoch 043 | 25% complete (batch 46/181)
2025-12-22 23:19:41 INFO Epoch 043 | 50% complete (batch 91/181)
2025-12-22 23:19:42 INFO Epoch 043 | 75% complete (batch 136/181)
2025-12-22 23:19:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.665506
2025-12-22 23:19:55 INFO Tuning ranking metrics: regret=0.070980 spearman=0.053661 (groups=34, skipped=318)
2025-12-22 23:19:55 INFO Epoch 043 | train_mse=0.077313 | val_loss=0.066375 | best_val_loss=0.080564
2025-12-22 23:20:04 INFO Epoch 044 | 25% complete (batch 46/181)
2025-12-22 23:20:04 INFO Epoch 044 | 50% complete (batch 91/181)
2025-12-22 23:20:05 INFO Epoch 044 | 75% complete (batch 136/181)
2025-12-22 23:20:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.681844
2025-12-22 23:20:19 INFO Tuning ranking metrics: regret=0.089060 spearman=-0.007455 (groups=34, skipped=318)
2025-12-22 23:20:19 INFO Epoch 044 | train_mse=0.077972 | val_loss=0.071264 | best_val_loss=0.080564
2025-12-22 23:20:27 INFO Epoch 045 | 25% complete (batch 46/181)
2025-12-22 23:20:28 INFO Epoch 045 | 50% complete (batch 91/181)
2025-12-22 23:20:29 INFO Epoch 045 | 75% complete (batch 136/181)
2025-12-22 23:20:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.690747
2025-12-22 23:20:42 INFO Tuning ranking metrics: regret=0.069705 spearman=0.043939 (groups=34, skipped=318)
2025-12-22 23:20:42 INFO Epoch 045 | train_mse=0.090384 | val_loss=0.064810 | best_val_loss=0.080564
2025-12-22 23:20:51 INFO Epoch 046 | 25% complete (batch 46/181)
2025-12-22 23:20:51 INFO Epoch 046 | 50% complete (batch 91/181)
2025-12-22 23:20:52 INFO Epoch 046 | 75% complete (batch 136/181)
2025-12-22 23:21:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.675153
2025-12-22 23:21:06 INFO Tuning ranking metrics: regret=0.073435 spearman=0.030570 (groups=34, skipped=318)
2025-12-22 23:21:06 INFO Epoch 046 | train_mse=0.082147 | val_loss=0.070678 | best_val_loss=0.080564
2025-12-22 23:21:14 INFO Epoch 047 | 25% complete (batch 46/181)
2025-12-22 23:21:15 INFO Epoch 047 | 50% complete (batch 91/181)
2025-12-22 23:21:16 INFO Epoch 047 | 75% complete (batch 136/181)
2025-12-22 23:21:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.671146
2025-12-22 23:21:29 INFO Tuning ranking metrics: regret=0.070121 spearman=0.041998 (groups=34, skipped=318)
2025-12-22 23:21:29 INFO Epoch 047 | train_mse=0.059201 | val_loss=0.065362 | best_val_loss=0.080564
2025-12-22 23:21:38 INFO Epoch 048 | 25% complete (batch 46/181)
2025-12-22 23:21:38 INFO Epoch 048 | 50% complete (batch 91/181)
2025-12-22 23:21:39 INFO Epoch 048 | 75% complete (batch 136/181)
2025-12-22 23:21:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.680443
2025-12-22 23:21:53 INFO Tuning ranking metrics: regret=0.070136 spearman=0.058034 (groups=34, skipped=318)
2025-12-22 23:21:53 INFO Epoch 048 | train_mse=0.082277 | val_loss=0.066210 | best_val_loss=0.080564
2025-12-22 23:22:01 INFO Epoch 049 | 25% complete (batch 46/181)
2025-12-22 23:22:02 INFO Epoch 049 | 50% complete (batch 91/181)
2025-12-22 23:22:03 INFO Epoch 049 | 75% complete (batch 136/181)
2025-12-22 23:22:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.683521
2025-12-22 23:22:16 INFO Tuning ranking metrics: regret=0.070315 spearman=0.044818 (groups=34, skipped=318)
2025-12-22 23:22:16 INFO Epoch 049 | train_mse=0.084013 | val_loss=0.063115 | best_val_loss=0.080564
2025-12-22 23:22:25 INFO Epoch 050 | 25% complete (batch 46/181)
2025-12-22 23:22:26 INFO Epoch 050 | 50% complete (batch 91/181)
2025-12-22 23:22:27 INFO Epoch 050 | 75% complete (batch 136/181)
2025-12-22 23:22:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.684294
2025-12-22 23:22:40 INFO Tuning ranking metrics: regret=0.093110 spearman=-0.067221 (groups=34, skipped=318)
2025-12-22 23:22:40 INFO Epoch 050 | train_mse=0.058562 | val_loss=0.060480 | best_val_loss=0.080564
2025-12-22 23:22:48 INFO Epoch 051 | 25% complete (batch 46/181)
2025-12-22 23:22:49 INFO Epoch 051 | 50% complete (batch 91/181)
2025-12-22 23:22:50 INFO Epoch 051 | 75% complete (batch 136/181)
2025-12-22 23:22:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.693324
2025-12-22 23:23:03 INFO Tuning ranking metrics: regret=0.072739 spearman=-0.005672 (groups=34, skipped=318)
2025-12-22 23:23:03 INFO Epoch 051 | train_mse=0.078482 | val_loss=0.067078 | best_val_loss=0.080564
Monitored metric tuning_rank_spearman did not improve in the last 40 records. Best score: 0.147. Signaling Trainer to stop.
2025-12-22 23:23:05 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.06446_val-0.08518_epoch040.chkpt, checkpoint.tuning_rank_spearman-0.07325_val-0.06599_epoch039.chkpt, checkpoint.tuning_rank_spearman-0.08056_val-0.13668_epoch013.chkpt
2025-12-22 23:23:05 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.08056_val-0.13668_epoch013.chkpt
2025-12-22 23:23:05 INFO Best validation loss: tensor(0.0806)
2025-12-22 23:23:05 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.08056_val-0.13668_epoch013.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.08056_val-0.13668_epoch013.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-22 23:23:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.136678
2025-12-22 23:23:16 INFO Tuning ranking metrics: regret=0.103131 spearman=0.080564 (groups=34, skipped=318)
2025-12-22 23:23:16 INFO Epoch 052 | val_loss=0.136678 | best_val_loss=0.080564
2025-12-22 23:23:17 INFO Validation metrics: [{'val_loss': 0.1366783231496811, 'tuning_rank_regret': 0.10313141345977783, 'tuning_rank_spearman': 0.08056404441595078, 'val_pearson_corr': 0.5044226050376892, 'val_spearman_corr': 0.5200915336608887, 'val_rank_regret': 0.012843824923038483, 'val_rank_spearman': 0.2222222238779068}]
2025-12-22 23:23:17 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.08056_val-0.13668_epoch013.chkpt
2025-12-22 23:23:17 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.07325_val-0.06599_epoch039.chkpt
2025-12-22 23:23:17 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.06446_val-0.08518_epoch040.chkpt
2025-12-22 23:23:17 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.14091_epoch012.ckpt
2025-12-22 23:23:17 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.10313141345977783
  tuning_rank_spearman      0.08056404441595078
        val_loss            0.1366783231496811
    val_pearson_corr        0.5044226050376892
     val_rank_regret       0.012843824923038483
    val_rank_spearman       0.2222222238779068
    val_spearman_corr       0.5200915336608887
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run polish_seed101_2025-12-22_18-34-49_phase1 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase1
[run_full_pipeline] Phase 1 best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.08056_val-0.13668_epoch013.chkpt (tuning_rank_spearman=0.08056404441595078)
[run_full_pipeline] Phase 2 fine-tuning (seed 101) -> polish_seed101_2025-12-22_18-34-49_phase2_seed101
[train_cli] run_id=polish_seed101_2025-12-22_18-34-49_phase2_seed101 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed101/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed101 --git-commit 150d1dcbd1 --git-dirty --resume-from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.08056_val-0.13668_epoch013.chkpt
2025-12-22 23:23:22 INFO git_commit = 150d1dcbd1 (dirty)
2025-12-22 23:23:22 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-22 23:23:22 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed101/config/config.yaml
2025-12-22 23:23:22 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data
2025-12-22 23:23:22 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-22 23:23:22 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-22 23:23:22 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed101
2025-12-22 23:23:22 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-22 23:23:22 INFO   metadata_path = None
2025-12-22 23:23:22 INFO   summary_path = None
2025-12-22 23:23:22 INFO   accelerator = cpu
2025-12-22 23:23:22 INFO   devices = 1
2025-12-22 23:23:22 INFO   attention_head = 8
2025-12-22 23:23:22 INFO   pooling_type = mean
2025-12-22 23:23:22 INFO   model_self_loops = False
2025-12-22 23:23:22 INFO   model_self_loop_fill = mean
2025-12-22 23:23:22 INFO   model_residual = False
2025-12-22 23:23:22 INFO   batch_size = 48
2025-12-22 23:23:22 INFO   learning_rate = 0.001
2025-12-22 23:23:22 INFO   num_epochs = 320
2025-12-22 23:23:22 INFO   accumulate_grad_batches = 8
2025-12-22 23:23:22 INFO   seed = 101
2025-12-22 23:23:22 INFO   num_workers = 2
2025-12-22 23:23:22 INFO   precision = 32
2025-12-22 23:23:22 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-22 23:23:22 INFO   early_stopping_patience = 20
2025-12-22 23:23:22 INFO   lr_scheduler_patience = 4
2025-12-22 23:23:22 INFO   lr_scheduler_factor = 0.2
2025-12-22 23:23:22 INFO   fast_dev_run = False
2025-12-22 23:23:22 INFO   limit_train_batches = None
2025-12-22 23:23:22 INFO   limit_val_batches = None
2025-12-22 23:23:22 INFO   log_lr = False
2025-12-22 23:23:22 INFO   progress_bar_refresh_rate = 0
2025-12-22 23:23:22 INFO   log_every_n_steps = 100
2025-12-22 23:23:22 INFO   use_val_spearman_as_secondary = True
2025-12-22 23:23:22 INFO   spearman_secondary_min_delta = 0.0
2025-12-22 23:23:22 INFO   spearman_secondary_weight = 1.0
2025-12-22 23:23:22 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-22 23:23:22 INFO   tuning_max_samples = 500
2025-12-22 23:23:22 INFO   tuning_fraction = None
2025-12-22 23:23:22 INFO   tuning_eval_every = 1
2025-12-22 23:23:22 INFO   rank_loss_weight = 0.0
2025-12-22 23:23:22 INFO   rank_loss_margin = 0.0
2025-12-22 23:23:22 INFO   rank_loss_mode = hinge
2025-12-22 23:23:22 INFO   rank_loss_grouped = True
2025-12-22 23:23:22 INFO   variance_reduction_enabled = False
2025-12-22 23:23:22 INFO   variance_reduction_method = topk_avg
2025-12-22 23:23:22 INFO   variance_reduction_top_k = 3
2025-12-22 23:23:22 INFO   coverage_minimum = 0.0
2025-12-22 23:23:22 INFO   coverage_fail_on_missing = False
2025-12-22 23:23:22 INFO   graph_load_profiling = False
2025-12-22 23:23:22 INFO   graph_load_top_k = 5
2025-12-22 23:23:22 INFO   enable_graph_cache = True
2025-12-22 23:23:22 INFO   graph_cache_size = 256
2025-12-22 23:23:22 INFO   canonicalize_on_load = False
2025-12-22 23:23:22 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-22 23:23:22 INFO   edge_schema = {}
2025-12-22 23:23:22 INFO   topology_schema = {}
Seed set to 101
2025-12-22 23:23:23 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-22 23:23:23 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 23:23:23 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-22 23:23:23 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 23:23:23 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-22 23:23:23 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 23:23:24 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-22 23:23:24 INFO Tuning group stats: groups=348 groups>=2=37 singletons=311 max_group=11
2025-12-22 23:23:24 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed101/dataset_coverage.json
2025-12-22 23:23:24 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed101/dataset_coverage.json for details.
2025-12-22 23:23:24 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed101/dataset_coverage.json for details.
2025-12-22 23:23:24 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed101/dataset_coverage.json for details.
2025-12-22 23:23:24 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed101/schema_summary.json
2025-12-22 23:23:24 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed101/feature_metadata.json
2025-12-22 23:23:24 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-22 23:23:24 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/feature-config.yaml.topoqa.10A.2, sha256=5c62898155179232a565e24d9fbd7b208f9ce480d1a19d6139de19454e173ff0
2025-12-22 23:23:24 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/work/edge_features)
2025-12-22 23:23:24 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json
2025-12-22 23:23:24 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed101/schema_summary.json
2025-12-22 23:23:24 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-22 23:23:24 INFO Topology: topology/persistence_basic/v1 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 172-dimensional node features.
2025-12-22 23:23:24 INFO Node: node/dssp_topo_merge/v1; metadata lists 172 feature columns matching the .pt tensor.
2025-12-22 23:23:24 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-22 23:23:24 INFO → Total feature dimensionality observed and confirmed: node_dim = 172, edge_dim = 11.
2025-12-22 23:23:24 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-22 23:23:24 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 172,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 172,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed101/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge/v1",
      "alias": "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA",
      "jobs": 16,
      "summary": "DSSP-derived node features merged with topology statistics."
    },
    "topology": {
      "id": "topology/persistence_basic/v1",
      "alias": "Betti 0 and Betti 1 topology summaries on interface coords = 140D PH | TopoQA",
      "jobs": 16,
      "summary": "Persistent homology features with configurable distance thresholds."
    }
  },
  "notes": []
}
2025-12-22 23:23:24 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-22 23:23:24 INFO Resuming from checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.08056_val-0.13668_epoch013.chkpt (epoch=13)
2025-12-22 23:23:24 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=3b512d53afd7466797c228cba2b476fc)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-22 23:23:24 INFO Starting training (fast_dev_run=False)
2025-12-22 23:23:24 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed101/model_checkpoints exists and is not empty.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.08056_val-0.13668_epoch013.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase1/model_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed101/model_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase1/model_checkpoints/val_loss_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed101/model_checkpoints/val_loss_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 5.5 K  | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
165 K     Trainable params
0         Non-trainable params
165 K     Total params
0.662     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
Restored all states from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.08056_val-0.13668_epoch013.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-22 23:23:38 INFO Epoch 014 | 25% complete (batch 46/181)
2025-12-22 23:23:39 INFO Epoch 014 | 50% complete (batch 91/181)
2025-12-22 23:23:39 INFO Epoch 014 | 75% complete (batch 136/181)
2025-12-22 23:23:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.128748
2025-12-22 23:23:53 INFO Tuning ranking metrics: regret=0.195006 spearman=0.055680 (groups=37, skipped=311)
2025-12-22 23:23:53 INFO Epoch 014 | val_loss=0.128748
2025-12-22 23:24:01 INFO Epoch 015 | 25% complete (batch 46/181)
2025-12-22 23:24:02 INFO Epoch 015 | 50% complete (batch 91/181)
2025-12-22 23:24:03 INFO Epoch 015 | 75% complete (batch 136/181)
2025-12-22 23:24:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.463311
2025-12-22 23:24:16 INFO Tuning ranking metrics: regret=0.144709 spearman=0.122470 (groups=37, skipped=311)
2025-12-22 23:24:16 INFO Epoch 015 | train_mse=0.128702 | val_loss=0.110704 | best_val_loss=0.055680
2025-12-22 23:24:24 INFO Epoch 016 | 25% complete (batch 46/181)
2025-12-22 23:24:25 INFO Epoch 016 | 50% complete (batch 91/181)
2025-12-22 23:24:26 INFO Epoch 016 | 75% complete (batch 136/181)
2025-12-22 23:24:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.479346
2025-12-22 23:24:39 INFO Tuning ranking metrics: regret=0.194532 spearman=-0.084708 (groups=37, skipped=311)
2025-12-22 23:24:39 INFO Epoch 016 | train_mse=0.132373 | val_loss=0.104127 | best_val_loss=0.122470
2025-12-22 23:24:48 INFO Epoch 017 | 25% complete (batch 46/181)
2025-12-22 23:24:48 INFO Epoch 017 | 50% complete (batch 91/181)
2025-12-22 23:24:49 INFO Epoch 017 | 75% complete (batch 136/181)
2025-12-22 23:24:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.566242
2025-12-22 23:25:03 INFO Tuning ranking metrics: regret=0.193294 spearman=0.009436 (groups=37, skipped=311)
2025-12-22 23:25:03 INFO Epoch 017 | train_mse=0.137070 | val_loss=0.086111 | best_val_loss=0.122470
2025-12-22 23:25:11 INFO Epoch 018 | 25% complete (batch 46/181)
2025-12-22 23:25:12 INFO Epoch 018 | 50% complete (batch 91/181)
2025-12-22 23:25:13 INFO Epoch 018 | 75% complete (batch 136/181)
2025-12-22 23:25:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.568077
2025-12-22 23:25:26 INFO Tuning ranking metrics: regret=0.165629 spearman=0.001018 (groups=37, skipped=311)
2025-12-22 23:25:26 INFO Epoch 018 | train_mse=0.102323 | val_loss=0.080889 | best_val_loss=0.122470
2025-12-22 23:25:35 INFO Epoch 019 | 25% complete (batch 46/181)
2025-12-22 23:25:36 INFO Epoch 019 | 50% complete (batch 91/181)
2025-12-22 23:25:36 INFO Epoch 019 | 75% complete (batch 136/181)
2025-12-22 23:25:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.568215
2025-12-22 23:25:50 INFO Tuning ranking metrics: regret=0.144160 spearman=0.058980 (groups=37, skipped=311)
2025-12-22 23:25:50 INFO Epoch 019 | train_mse=0.102734 | val_loss=0.103554 | best_val_loss=0.122470
2025-12-22 23:25:58 INFO Epoch 020 | 25% complete (batch 46/181)
2025-12-22 23:25:59 INFO Epoch 020 | 50% complete (batch 91/181)
2025-12-22 23:25:59 INFO Epoch 020 | 75% complete (batch 136/181)
2025-12-22 23:26:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.589418
2025-12-22 23:26:13 INFO Tuning ranking metrics: regret=0.160597 spearman=0.066292 (groups=37, skipped=311)
2025-12-22 23:26:13 INFO Epoch 020 | train_mse=0.099838 | val_loss=0.085219 | best_val_loss=0.122470
2025-12-22 23:26:21 INFO Epoch 021 | 25% complete (batch 46/181)
2025-12-22 23:26:22 INFO Epoch 021 | 50% complete (batch 91/181)
2025-12-22 23:26:23 INFO Epoch 021 | 75% complete (batch 136/181)
2025-12-22 23:26:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.609995
2025-12-22 23:26:36 INFO Tuning ranking metrics: regret=0.143591 spearman=0.080040 (groups=37, skipped=311)
2025-12-22 23:26:36 INFO Epoch 021 | train_mse=0.114549 | val_loss=0.077721 | best_val_loss=0.122470
2025-12-22 23:26:44 INFO Epoch 022 | 25% complete (batch 46/181)
2025-12-22 23:26:46 INFO Epoch 022 | 50% complete (batch 91/181)
2025-12-22 23:26:46 INFO Epoch 022 | 75% complete (batch 136/181)
2025-12-22 23:26:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.591269
2025-12-22 23:27:00 INFO Tuning ranking metrics: regret=0.143722 spearman=0.130215 (groups=37, skipped=311)
2025-12-22 23:27:00 INFO Epoch 022 | train_mse=0.097319 | val_loss=0.087978 | best_val_loss=0.122470
2025-12-22 23:27:08 INFO Epoch 023 | 25% complete (batch 46/181)
2025-12-22 23:27:09 INFO Epoch 023 | 50% complete (batch 91/181)
2025-12-22 23:27:10 INFO Epoch 023 | 75% complete (batch 136/181)
2025-12-22 23:27:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.606572
2025-12-22 23:27:23 INFO Tuning ranking metrics: regret=0.141264 spearman=0.095601 (groups=37, skipped=311)
2025-12-22 23:27:23 INFO Epoch 023 | train_mse=0.102265 | val_loss=0.072910 | best_val_loss=0.130215
2025-12-22 23:27:31 INFO Epoch 024 | 25% complete (batch 46/181)
2025-12-22 23:27:32 INFO Epoch 024 | 50% complete (batch 91/181)
2025-12-22 23:27:33 INFO Epoch 024 | 75% complete (batch 136/181)
2025-12-22 23:27:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.609720
2025-12-22 23:27:46 INFO Tuning ranking metrics: regret=0.146463 spearman=0.118077 (groups=37, skipped=311)
2025-12-22 23:27:46 INFO Epoch 024 | train_mse=0.093930 | val_loss=0.072982 | best_val_loss=0.130215
2025-12-22 23:27:54 INFO Epoch 025 | 25% complete (batch 46/181)
2025-12-22 23:27:55 INFO Epoch 025 | 50% complete (batch 91/181)
2025-12-22 23:27:56 INFO Epoch 025 | 75% complete (batch 136/181)
2025-12-22 23:28:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.621660
2025-12-22 23:28:10 INFO Tuning ranking metrics: regret=0.146267 spearman=0.120370 (groups=37, skipped=311)
2025-12-22 23:28:10 INFO Epoch 025 | train_mse=0.083487 | val_loss=0.070448 | best_val_loss=0.130215
2025-12-22 23:28:18 INFO Epoch 026 | 25% complete (batch 46/181)
2025-12-22 23:28:19 INFO Epoch 026 | 50% complete (batch 91/181)
2025-12-22 23:28:20 INFO Epoch 026 | 75% complete (batch 136/181)
2025-12-22 23:28:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.601370
2025-12-22 23:28:33 INFO Tuning ranking metrics: regret=0.146461 spearman=0.130689 (groups=37, skipped=311)
2025-12-22 23:28:33 INFO Epoch 026 | train_mse=0.099148 | val_loss=0.100011 | best_val_loss=0.130215
2025-12-22 23:28:42 INFO Epoch 027 | 25% complete (batch 46/181)
2025-12-22 23:28:42 INFO Epoch 027 | 50% complete (batch 91/181)
2025-12-22 23:28:43 INFO Epoch 027 | 75% complete (batch 136/181)
2025-12-22 23:28:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.610886
2025-12-22 23:28:57 INFO Tuning ranking metrics: regret=0.148625 spearman=0.120721 (groups=37, skipped=311)
2025-12-22 23:28:57 INFO Epoch 027 | train_mse=0.068197 | val_loss=0.085833 | best_val_loss=0.130689
2025-12-22 23:29:05 INFO Epoch 028 | 25% complete (batch 46/181)
2025-12-22 23:29:06 INFO Epoch 028 | 50% complete (batch 91/181)
2025-12-22 23:29:07 INFO Epoch 028 | 75% complete (batch 136/181)
2025-12-22 23:29:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.560308
2025-12-22 23:29:21 INFO Tuning ranking metrics: regret=0.120834 spearman=0.152545 (groups=37, skipped=311)
2025-12-22 23:29:21 INFO Epoch 028 | train_mse=0.087990 | val_loss=0.117062 | best_val_loss=0.130689
Metric tuning_rank_spearman improved by 0.005 >= min_delta = 0.0. New best score: 0.153
2025-12-22 23:29:29 INFO Epoch 029 | 25% complete (batch 46/181)
2025-12-22 23:29:30 INFO Epoch 029 | 50% complete (batch 91/181)
2025-12-22 23:29:31 INFO Epoch 029 | 75% complete (batch 136/181)
2025-12-22 23:29:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.587868
2025-12-22 23:29:44 INFO Tuning ranking metrics: regret=0.115894 spearman=0.172944 (groups=37, skipped=311)
2025-12-22 23:29:44 INFO Epoch 029 | train_mse=0.097296 | val_loss=0.110478 | best_val_loss=0.152545
Metric tuning_rank_spearman improved by 0.020 >= min_delta = 0.0. New best score: 0.173
2025-12-22 23:29:53 INFO Epoch 030 | 25% complete (batch 46/181)
2025-12-22 23:29:54 INFO Epoch 030 | 50% complete (batch 91/181)
2025-12-22 23:29:55 INFO Epoch 030 | 75% complete (batch 136/181)
2025-12-22 23:30:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.620295
2025-12-22 23:30:08 INFO Tuning ranking metrics: regret=0.124346 spearman=0.154107 (groups=37, skipped=311)
2025-12-22 23:30:08 INFO Epoch 030 | train_mse=0.127190 | val_loss=0.088715 | best_val_loss=0.172944
2025-12-22 23:30:16 INFO Epoch 031 | 25% complete (batch 46/181)
2025-12-22 23:30:17 INFO Epoch 031 | 50% complete (batch 91/181)
2025-12-22 23:30:18 INFO Epoch 031 | 75% complete (batch 136/181)
2025-12-22 23:30:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.624823
2025-12-22 23:30:32 INFO Tuning ranking metrics: regret=0.128268 spearman=0.160138 (groups=37, skipped=311)
2025-12-22 23:30:32 INFO Epoch 031 | train_mse=0.089060 | val_loss=0.069231 | best_val_loss=0.172944
2025-12-22 23:30:40 INFO Epoch 032 | 25% complete (batch 46/181)
2025-12-22 23:30:41 INFO Epoch 032 | 50% complete (batch 91/181)
2025-12-22 23:30:42 INFO Epoch 032 | 75% complete (batch 136/181)
2025-12-22 23:30:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.594313
2025-12-22 23:30:56 INFO Tuning ranking metrics: regret=0.104017 spearman=0.184427 (groups=37, skipped=311)
2025-12-22 23:30:56 INFO Epoch 032 | train_mse=0.074691 | val_loss=0.105291 | best_val_loss=0.172944
Metric tuning_rank_spearman improved by 0.011 >= min_delta = 0.0. New best score: 0.184
2025-12-22 23:31:04 INFO Epoch 033 | 25% complete (batch 46/181)
2025-12-22 23:31:05 INFO Epoch 033 | 50% complete (batch 91/181)
2025-12-22 23:31:06 INFO Epoch 033 | 75% complete (batch 136/181)
2025-12-22 23:31:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.634424
2025-12-22 23:31:19 INFO Tuning ranking metrics: regret=0.116781 spearman=0.171306 (groups=37, skipped=311)
2025-12-22 23:31:19 INFO Epoch 033 | train_mse=0.079490 | val_loss=0.075877 | best_val_loss=0.184427
2025-12-22 23:31:28 INFO Epoch 034 | 25% complete (batch 46/181)
2025-12-22 23:31:29 INFO Epoch 034 | 50% complete (batch 91/181)
2025-12-22 23:31:29 INFO Epoch 034 | 75% complete (batch 136/181)
2025-12-22 23:31:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.645694
2025-12-22 23:31:43 INFO Tuning ranking metrics: regret=0.119638 spearman=0.132976 (groups=37, skipped=311)
2025-12-22 23:31:43 INFO Epoch 034 | train_mse=0.088665 | val_loss=0.065026 | best_val_loss=0.184427
2025-12-22 23:31:51 INFO Epoch 035 | 25% complete (batch 46/181)
2025-12-22 23:31:52 INFO Epoch 035 | 50% complete (batch 91/181)
2025-12-22 23:31:53 INFO Epoch 035 | 75% complete (batch 136/181)
2025-12-22 23:32:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.642521
2025-12-22 23:32:07 INFO Tuning ranking metrics: regret=0.140893 spearman=0.121329 (groups=37, skipped=311)
2025-12-22 23:32:07 INFO Epoch 035 | train_mse=0.066998 | val_loss=0.075979 | best_val_loss=0.184427
2025-12-22 23:32:15 INFO Epoch 036 | 25% complete (batch 46/181)
2025-12-22 23:32:16 INFO Epoch 036 | 50% complete (batch 91/181)
2025-12-22 23:32:17 INFO Epoch 036 | 75% complete (batch 136/181)
2025-12-22 23:32:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.635278
2025-12-22 23:32:30 INFO Tuning ranking metrics: regret=0.140014 spearman=0.105675 (groups=37, skipped=311)
2025-12-22 23:32:30 INFO Epoch 036 | train_mse=0.075138 | val_loss=0.082819 | best_val_loss=0.184427
2025-12-22 23:32:38 INFO Epoch 037 | 25% complete (batch 46/181)
2025-12-22 23:32:39 INFO Epoch 037 | 50% complete (batch 91/181)
2025-12-22 23:32:40 INFO Epoch 037 | 75% complete (batch 136/181)
2025-12-22 23:32:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.660942
2025-12-22 23:32:53 INFO Tuning ranking metrics: regret=0.146691 spearman=0.092904 (groups=37, skipped=311)
2025-12-22 23:32:53 INFO Epoch 037 | train_mse=0.071050 | val_loss=0.064768 | best_val_loss=0.184427
2025-12-22 23:33:02 INFO Epoch 038 | 25% complete (batch 46/181)
2025-12-22 23:33:03 INFO Epoch 038 | 50% complete (batch 91/181)
2025-12-22 23:33:04 INFO Epoch 038 | 75% complete (batch 136/181)
2025-12-22 23:33:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.654638
2025-12-22 23:33:17 INFO Tuning ranking metrics: regret=0.143450 spearman=0.115982 (groups=37, skipped=311)
2025-12-22 23:33:17 INFO Epoch 038 | train_mse=0.070993 | val_loss=0.080361 | best_val_loss=0.184427
2025-12-22 23:33:25 INFO Epoch 039 | 25% complete (batch 46/181)
2025-12-22 23:33:26 INFO Epoch 039 | 50% complete (batch 91/181)
2025-12-22 23:33:27 INFO Epoch 039 | 75% complete (batch 136/181)
2025-12-22 23:33:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.671288
2025-12-22 23:33:41 INFO Tuning ranking metrics: regret=0.144728 spearman=0.109688 (groups=37, skipped=311)
2025-12-22 23:33:41 INFO Epoch 039 | train_mse=0.087628 | val_loss=0.064315 | best_val_loss=0.184427
2025-12-22 23:33:49 INFO Epoch 040 | 25% complete (batch 46/181)
2025-12-22 23:33:50 INFO Epoch 040 | 50% complete (batch 91/181)
2025-12-22 23:33:51 INFO Epoch 040 | 75% complete (batch 136/181)
2025-12-22 23:33:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.636180
2025-12-22 23:34:04 INFO Tuning ranking metrics: regret=0.123548 spearman=0.151328 (groups=37, skipped=311)
2025-12-22 23:34:04 INFO Epoch 040 | train_mse=0.077865 | val_loss=0.092918 | best_val_loss=0.184427
2025-12-22 23:34:12 INFO Epoch 041 | 25% complete (batch 46/181)
2025-12-22 23:34:13 INFO Epoch 041 | 50% complete (batch 91/181)
2025-12-22 23:34:14 INFO Epoch 041 | 75% complete (batch 136/181)
2025-12-22 23:34:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.653019
2025-12-22 23:34:27 INFO Tuning ranking metrics: regret=0.149785 spearman=0.131122 (groups=37, skipped=311)
2025-12-22 23:34:27 INFO Epoch 041 | train_mse=0.077593 | val_loss=0.074636 | best_val_loss=0.184427
2025-12-22 23:34:36 INFO Epoch 042 | 25% complete (batch 46/181)
2025-12-22 23:34:37 INFO Epoch 042 | 50% complete (batch 91/181)
2025-12-22 23:34:38 INFO Epoch 042 | 75% complete (batch 136/181)
2025-12-22 23:34:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.661559
2025-12-22 23:34:51 INFO Tuning ranking metrics: regret=0.137110 spearman=0.167334 (groups=37, skipped=311)
2025-12-22 23:34:51 INFO Epoch 042 | train_mse=0.079693 | val_loss=0.067388 | best_val_loss=0.184427
2025-12-22 23:34:59 INFO Epoch 043 | 25% complete (batch 46/181)
2025-12-22 23:35:00 INFO Epoch 043 | 50% complete (batch 91/181)
2025-12-22 23:35:01 INFO Epoch 043 | 75% complete (batch 136/181)
2025-12-22 23:35:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.648819
2025-12-22 23:35:15 INFO Tuning ranking metrics: regret=0.118998 spearman=0.177009 (groups=37, skipped=311)
2025-12-22 23:35:15 INFO Epoch 043 | train_mse=0.075525 | val_loss=0.071794 | best_val_loss=0.184427
2025-12-22 23:35:23 INFO Epoch 044 | 25% complete (batch 46/181)
2025-12-22 23:35:24 INFO Epoch 044 | 50% complete (batch 91/181)
2025-12-22 23:35:25 INFO Epoch 044 | 75% complete (batch 136/181)
2025-12-22 23:35:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.638750
2025-12-22 23:35:38 INFO Tuning ranking metrics: regret=0.138275 spearman=0.157014 (groups=37, skipped=311)
2025-12-22 23:35:38 INFO Epoch 044 | train_mse=0.084889 | val_loss=0.069086 | best_val_loss=0.184427
2025-12-22 23:35:47 INFO Epoch 045 | 25% complete (batch 46/181)
2025-12-22 23:35:48 INFO Epoch 045 | 50% complete (batch 91/181)
2025-12-22 23:35:49 INFO Epoch 045 | 75% complete (batch 136/181)
2025-12-22 23:35:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.647373
2025-12-22 23:36:02 INFO Tuning ranking metrics: regret=0.124663 spearman=0.149532 (groups=37, skipped=311)
2025-12-22 23:36:02 INFO Epoch 045 | train_mse=0.070512 | val_loss=0.066181 | best_val_loss=0.184427
2025-12-22 23:36:10 INFO Epoch 046 | 25% complete (batch 46/181)
2025-12-22 23:36:11 INFO Epoch 046 | 50% complete (batch 91/181)
2025-12-22 23:36:12 INFO Epoch 046 | 75% complete (batch 136/181)
2025-12-22 23:36:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.665916
2025-12-22 23:36:26 INFO Tuning ranking metrics: regret=0.145935 spearman=0.047467 (groups=37, skipped=311)
2025-12-22 23:36:26 INFO Epoch 046 | train_mse=0.070159 | val_loss=0.062595 | best_val_loss=0.184427
2025-12-22 23:36:34 INFO Epoch 047 | 25% complete (batch 46/181)
2025-12-22 23:36:35 INFO Epoch 047 | 50% complete (batch 91/181)
2025-12-22 23:36:36 INFO Epoch 047 | 75% complete (batch 136/181)
2025-12-22 23:36:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.666687
2025-12-22 23:36:49 INFO Tuning ranking metrics: regret=0.119292 spearman=0.077050 (groups=37, skipped=311)
2025-12-22 23:36:49 INFO Epoch 047 | train_mse=0.073951 | val_loss=0.075841 | best_val_loss=0.184427
2025-12-22 23:36:58 INFO Epoch 048 | 25% complete (batch 46/181)
2025-12-22 23:36:59 INFO Epoch 048 | 50% complete (batch 91/181)
2025-12-22 23:37:00 INFO Epoch 048 | 75% complete (batch 136/181)
2025-12-22 23:37:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.683220
2025-12-22 23:37:13 INFO Tuning ranking metrics: regret=0.147667 spearman=0.049824 (groups=37, skipped=311)
2025-12-22 23:37:13 INFO Epoch 048 | train_mse=0.084613 | val_loss=0.060230 | best_val_loss=0.184427
2025-12-22 23:37:21 INFO Epoch 049 | 25% complete (batch 46/181)
2025-12-22 23:37:22 INFO Epoch 049 | 50% complete (batch 91/181)
2025-12-22 23:37:23 INFO Epoch 049 | 75% complete (batch 136/181)
2025-12-22 23:37:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.685265
2025-12-22 23:37:36 INFO Tuning ranking metrics: regret=0.145894 spearman=0.055739 (groups=37, skipped=311)
2025-12-22 23:37:36 INFO Epoch 049 | train_mse=0.068527 | val_loss=0.063450 | best_val_loss=0.184427
2025-12-22 23:37:44 INFO Epoch 050 | 25% complete (batch 46/181)
2025-12-22 23:37:45 INFO Epoch 050 | 50% complete (batch 91/181)
2025-12-22 23:37:46 INFO Epoch 050 | 75% complete (batch 136/181)
2025-12-22 23:37:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.668821
2025-12-22 23:38:00 INFO Tuning ranking metrics: regret=0.124679 spearman=0.089037 (groups=37, skipped=311)
2025-12-22 23:38:00 INFO Epoch 050 | train_mse=0.074586 | val_loss=0.064451 | best_val_loss=0.184427
2025-12-22 23:38:08 INFO Epoch 051 | 25% complete (batch 46/181)
2025-12-22 23:38:09 INFO Epoch 051 | 50% complete (batch 91/181)
2025-12-22 23:38:10 INFO Epoch 051 | 75% complete (batch 136/181)
2025-12-22 23:38:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.656858
2025-12-22 23:38:23 INFO Tuning ranking metrics: regret=0.124898 spearman=0.101141 (groups=37, skipped=311)
2025-12-22 23:38:23 INFO Epoch 051 | train_mse=0.068196 | val_loss=0.067511 | best_val_loss=0.184427
2025-12-22 23:38:32 INFO Epoch 052 | 25% complete (batch 46/181)
2025-12-22 23:38:33 INFO Epoch 052 | 50% complete (batch 91/181)
2025-12-22 23:38:34 INFO Epoch 052 | 75% complete (batch 136/181)
2025-12-22 23:38:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.663265
2025-12-22 23:38:47 INFO Tuning ranking metrics: regret=0.147685 spearman=0.117322 (groups=37, skipped=311)
2025-12-22 23:38:47 INFO Epoch 052 | train_mse=0.079019 | val_loss=0.064441 | best_val_loss=0.184427
2025-12-22 23:38:55 INFO Epoch 053 | 25% complete (batch 46/181)
2025-12-22 23:38:56 INFO Epoch 053 | 50% complete (batch 91/181)
2025-12-22 23:38:57 INFO Epoch 053 | 75% complete (batch 136/181)
2025-12-22 23:39:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.671226
2025-12-22 23:39:10 INFO Tuning ranking metrics: regret=0.142298 spearman=0.087522 (groups=37, skipped=311)
2025-12-22 23:39:10 INFO Epoch 053 | train_mse=0.057189 | val_loss=0.071989 | best_val_loss=0.184427
2025-12-22 23:39:19 INFO Epoch 054 | 25% complete (batch 46/181)
2025-12-22 23:39:20 INFO Epoch 054 | 50% complete (batch 91/181)
2025-12-22 23:39:20 INFO Epoch 054 | 75% complete (batch 136/181)
2025-12-22 23:39:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.696235
2025-12-22 23:39:34 INFO Tuning ranking metrics: regret=0.166886 spearman=0.076073 (groups=37, skipped=311)
2025-12-22 23:39:34 INFO Epoch 054 | train_mse=0.063492 | val_loss=0.062608 | best_val_loss=0.184427
2025-12-22 23:39:42 INFO Epoch 055 | 25% complete (batch 46/181)
2025-12-22 23:39:43 INFO Epoch 055 | 50% complete (batch 91/181)
2025-12-22 23:39:43 INFO Epoch 055 | 75% complete (batch 136/181)
2025-12-22 23:39:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.664481
2025-12-22 23:39:56 INFO Tuning ranking metrics: regret=0.165902 spearman=0.094951 (groups=37, skipped=311)
2025-12-22 23:39:56 INFO Epoch 055 | train_mse=0.070344 | val_loss=0.091193 | best_val_loss=0.184427
2025-12-22 23:40:05 INFO Epoch 056 | 25% complete (batch 46/181)
2025-12-22 23:40:06 INFO Epoch 056 | 50% complete (batch 91/181)
2025-12-22 23:40:06 INFO Epoch 056 | 75% complete (batch 136/181)
2025-12-22 23:40:15 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.698491
2025-12-22 23:40:20 INFO Tuning ranking metrics: regret=0.147619 spearman=0.081982 (groups=37, skipped=311)
2025-12-22 23:40:20 INFO Epoch 056 | train_mse=0.056955 | val_loss=0.056646 | best_val_loss=0.184427
2025-12-22 23:40:28 INFO Epoch 057 | 25% complete (batch 46/181)
2025-12-22 23:40:29 INFO Epoch 057 | 50% complete (batch 91/181)
2025-12-22 23:40:30 INFO Epoch 057 | 75% complete (batch 136/181)
2025-12-22 23:40:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.688851
2025-12-22 23:40:43 INFO Tuning ranking metrics: regret=0.146479 spearman=0.123751 (groups=37, skipped=311)
2025-12-22 23:40:43 INFO Epoch 057 | train_mse=0.069864 | val_loss=0.071350 | best_val_loss=0.184427
2025-12-22 23:40:52 INFO Epoch 058 | 25% complete (batch 46/181)
2025-12-22 23:40:53 INFO Epoch 058 | 50% complete (batch 91/181)
2025-12-22 23:40:54 INFO Epoch 058 | 75% complete (batch 136/181)
2025-12-22 23:41:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.703488
2025-12-22 23:41:07 INFO Tuning ranking metrics: regret=0.147210 spearman=0.112683 (groups=37, skipped=311)
2025-12-22 23:41:07 INFO Epoch 058 | train_mse=0.073385 | val_loss=0.058809 | best_val_loss=0.184427
2025-12-22 23:41:15 INFO Epoch 059 | 25% complete (batch 46/181)
2025-12-22 23:41:16 INFO Epoch 059 | 50% complete (batch 91/181)
2025-12-22 23:41:17 INFO Epoch 059 | 75% complete (batch 136/181)
2025-12-22 23:41:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.713933
2025-12-22 23:41:30 INFO Tuning ranking metrics: regret=0.125371 spearman=0.104744 (groups=37, skipped=311)
2025-12-22 23:41:30 INFO Epoch 059 | train_mse=0.078691 | val_loss=0.057100 | best_val_loss=0.184427
2025-12-22 23:41:39 INFO Epoch 060 | 25% complete (batch 46/181)
2025-12-22 23:41:40 INFO Epoch 060 | 50% complete (batch 91/181)
2025-12-22 23:41:41 INFO Epoch 060 | 75% complete (batch 136/181)
2025-12-22 23:41:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.713856
2025-12-22 23:41:54 INFO Tuning ranking metrics: regret=0.124337 spearman=0.075032 (groups=37, skipped=311)
2025-12-22 23:41:54 INFO Epoch 060 | train_mse=0.065050 | val_loss=0.058703 | best_val_loss=0.184427
2025-12-22 23:42:02 INFO Epoch 061 | 25% complete (batch 46/181)
2025-12-22 23:42:03 INFO Epoch 061 | 50% complete (batch 91/181)
2025-12-22 23:42:04 INFO Epoch 061 | 75% complete (batch 136/181)
2025-12-22 23:42:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.707075
2025-12-22 23:42:18 INFO Tuning ranking metrics: regret=0.124208 spearman=0.064853 (groups=37, skipped=311)
2025-12-22 23:42:18 INFO Epoch 061 | train_mse=0.069309 | val_loss=0.058324 | best_val_loss=0.184427
2025-12-22 23:42:26 INFO Epoch 062 | 25% complete (batch 46/181)
2025-12-22 23:42:27 INFO Epoch 062 | 50% complete (batch 91/181)
2025-12-22 23:42:27 INFO Epoch 062 | 75% complete (batch 136/181)
2025-12-22 23:42:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.697196
2025-12-22 23:42:41 INFO Tuning ranking metrics: regret=0.124157 spearman=0.123213 (groups=37, skipped=311)
2025-12-22 23:42:41 INFO Epoch 062 | train_mse=0.069682 | val_loss=0.059903 | best_val_loss=0.184427
2025-12-22 23:42:49 INFO Epoch 063 | 25% complete (batch 46/181)
2025-12-22 23:42:50 INFO Epoch 063 | 50% complete (batch 91/181)
2025-12-22 23:42:51 INFO Epoch 063 | 75% complete (batch 136/181)
2025-12-22 23:42:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.696340
2025-12-22 23:43:04 INFO Tuning ranking metrics: regret=0.124160 spearman=0.117100 (groups=37, skipped=311)
2025-12-22 23:43:04 INFO Epoch 063 | train_mse=0.066816 | val_loss=0.059870 | best_val_loss=0.184427
2025-12-22 23:43:12 INFO Epoch 064 | 25% complete (batch 46/181)
2025-12-22 23:43:13 INFO Epoch 064 | 50% complete (batch 91/181)
2025-12-22 23:43:14 INFO Epoch 064 | 75% complete (batch 136/181)
2025-12-22 23:43:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.700541
2025-12-22 23:43:28 INFO Tuning ranking metrics: regret=0.124370 spearman=0.098374 (groups=37, skipped=311)
2025-12-22 23:43:28 INFO Epoch 064 | train_mse=0.064741 | val_loss=0.061018 | best_val_loss=0.184427
2025-12-22 23:43:36 INFO Epoch 065 | 25% complete (batch 46/181)
2025-12-22 23:43:37 INFO Epoch 065 | 50% complete (batch 91/181)
2025-12-22 23:43:38 INFO Epoch 065 | 75% complete (batch 136/181)
2025-12-22 23:43:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.695504
2025-12-22 23:43:51 INFO Tuning ranking metrics: regret=0.122297 spearman=0.079390 (groups=37, skipped=311)
2025-12-22 23:43:51 INFO Epoch 065 | train_mse=0.062889 | val_loss=0.069208 | best_val_loss=0.184427
2025-12-22 23:43:59 INFO Epoch 066 | 25% complete (batch 46/181)
2025-12-22 23:44:00 INFO Epoch 066 | 50% complete (batch 91/181)
2025-12-22 23:44:01 INFO Epoch 066 | 75% complete (batch 136/181)
2025-12-22 23:44:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.694135
2025-12-22 23:44:14 INFO Tuning ranking metrics: regret=0.121463 spearman=0.124576 (groups=37, skipped=311)
2025-12-22 23:44:14 INFO Epoch 066 | train_mse=0.064670 | val_loss=0.069185 | best_val_loss=0.184427
2025-12-22 23:44:23 INFO Epoch 067 | 25% complete (batch 46/181)
2025-12-22 23:44:23 INFO Epoch 067 | 50% complete (batch 91/181)
2025-12-22 23:44:24 INFO Epoch 067 | 75% complete (batch 136/181)
2025-12-22 23:44:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.704968
2025-12-22 23:44:37 INFO Tuning ranking metrics: regret=0.122075 spearman=0.141313 (groups=37, skipped=311)
2025-12-22 23:44:37 INFO Epoch 067 | train_mse=0.059266 | val_loss=0.063533 | best_val_loss=0.184427
2025-12-22 23:44:46 INFO Epoch 068 | 25% complete (batch 46/181)
2025-12-22 23:44:47 INFO Epoch 068 | 50% complete (batch 91/181)
2025-12-22 23:44:48 INFO Epoch 068 | 75% complete (batch 136/181)
2025-12-22 23:44:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.696638
2025-12-22 23:45:01 INFO Tuning ranking metrics: regret=0.121430 spearman=0.137978 (groups=37, skipped=311)
2025-12-22 23:45:01 INFO Epoch 068 | train_mse=0.051818 | val_loss=0.057208 | best_val_loss=0.184427
2025-12-22 23:45:09 INFO Epoch 069 | 25% complete (batch 46/181)
2025-12-22 23:45:10 INFO Epoch 069 | 50% complete (batch 91/181)
2025-12-22 23:45:11 INFO Epoch 069 | 75% complete (batch 136/181)
2025-12-22 23:45:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.700336
2025-12-22 23:45:25 INFO Tuning ranking metrics: regret=0.121067 spearman=0.089423 (groups=37, skipped=311)
2025-12-22 23:45:25 INFO Epoch 069 | train_mse=0.055837 | val_loss=0.060938 | best_val_loss=0.184427
2025-12-22 23:45:33 INFO Epoch 070 | 25% complete (batch 46/181)
2025-12-22 23:45:34 INFO Epoch 070 | 50% complete (batch 91/181)
2025-12-22 23:45:35 INFO Epoch 070 | 75% complete (batch 136/181)
2025-12-22 23:45:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.683809
2025-12-22 23:45:48 INFO Tuning ranking metrics: regret=0.120065 spearman=0.072727 (groups=37, skipped=311)
2025-12-22 23:45:48 INFO Epoch 070 | train_mse=0.063531 | val_loss=0.073307 | best_val_loss=0.184427
2025-12-22 23:45:57 INFO Epoch 071 | 25% complete (batch 46/181)
2025-12-22 23:45:58 INFO Epoch 071 | 50% complete (batch 91/181)
2025-12-22 23:45:59 INFO Epoch 071 | 75% complete (batch 136/181)
2025-12-22 23:46:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.701306
2025-12-22 23:46:12 INFO Tuning ranking metrics: regret=0.121349 spearman=0.204668 (groups=37, skipped=311)
2025-12-22 23:46:12 INFO Epoch 071 | train_mse=0.052284 | val_loss=0.066742 | best_val_loss=0.184427
Metric tuning_rank_spearman improved by 0.020 >= min_delta = 0.0. New best score: 0.205
2025-12-22 23:46:20 INFO Epoch 072 | 25% complete (batch 46/181)
2025-12-22 23:46:21 INFO Epoch 072 | 50% complete (batch 91/181)
2025-12-22 23:46:22 INFO Epoch 072 | 75% complete (batch 136/181)
2025-12-22 23:46:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.677925
2025-12-22 23:46:36 INFO Tuning ranking metrics: regret=0.117918 spearman=0.101141 (groups=37, skipped=311)
2025-12-22 23:46:36 INFO Epoch 072 | train_mse=0.062067 | val_loss=0.068560 | best_val_loss=0.204668
2025-12-22 23:46:44 INFO Epoch 073 | 25% complete (batch 46/181)
2025-12-22 23:46:45 INFO Epoch 073 | 50% complete (batch 91/181)
2025-12-22 23:46:46 INFO Epoch 073 | 75% complete (batch 136/181)
2025-12-22 23:46:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.684529
2025-12-22 23:47:00 INFO Tuning ranking metrics: regret=0.121862 spearman=0.128308 (groups=37, skipped=311)
2025-12-22 23:47:00 INFO Epoch 073 | train_mse=0.064874 | val_loss=0.060715 | best_val_loss=0.204668
2025-12-22 23:47:08 INFO Epoch 074 | 25% complete (batch 46/181)
2025-12-22 23:47:09 INFO Epoch 074 | 50% complete (batch 91/181)
2025-12-22 23:47:09 INFO Epoch 074 | 75% complete (batch 136/181)
2025-12-22 23:47:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.620763
2025-12-22 23:47:23 INFO Tuning ranking metrics: regret=0.113779 spearman=0.220551 (groups=37, skipped=311)
2025-12-22 23:47:23 INFO Epoch 074 | train_mse=0.057098 | val_loss=0.127717 | best_val_loss=0.204668
Metric tuning_rank_spearman improved by 0.016 >= min_delta = 0.0. New best score: 0.221
2025-12-22 23:47:31 INFO Epoch 075 | 25% complete (batch 46/181)
2025-12-22 23:47:32 INFO Epoch 075 | 50% complete (batch 91/181)
2025-12-22 23:47:33 INFO Epoch 075 | 75% complete (batch 136/181)
2025-12-22 23:47:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.561161
2025-12-22 23:47:47 INFO Tuning ranking metrics: regret=0.114108 spearman=0.111460 (groups=37, skipped=311)
2025-12-22 23:47:47 INFO Epoch 075 | train_mse=0.063077 | val_loss=0.153517 | best_val_loss=0.220551
2025-12-22 23:47:55 INFO Epoch 076 | 25% complete (batch 46/181)
2025-12-22 23:47:56 INFO Epoch 076 | 50% complete (batch 91/181)
2025-12-22 23:47:57 INFO Epoch 076 | 75% complete (batch 136/181)
2025-12-22 23:48:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.666740
2025-12-22 23:48:11 INFO Tuning ranking metrics: regret=0.121966 spearman=0.148929 (groups=37, skipped=311)
2025-12-22 23:48:11 INFO Epoch 076 | train_mse=0.095600 | val_loss=0.067689 | best_val_loss=0.220551
2025-12-22 23:48:19 INFO Epoch 077 | 25% complete (batch 46/181)
2025-12-22 23:48:20 INFO Epoch 077 | 50% complete (batch 91/181)
2025-12-22 23:48:21 INFO Epoch 077 | 75% complete (batch 136/181)
2025-12-22 23:48:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.675933
2025-12-22 23:48:34 INFO Tuning ranking metrics: regret=0.111376 spearman=0.240886 (groups=37, skipped=311)
2025-12-22 23:48:34 INFO Epoch 077 | train_mse=0.081753 | val_loss=0.065824 | best_val_loss=0.220551
Metric tuning_rank_spearman improved by 0.020 >= min_delta = 0.0. New best score: 0.241
2025-12-22 23:48:42 INFO Epoch 078 | 25% complete (batch 46/181)
2025-12-22 23:48:43 INFO Epoch 078 | 50% complete (batch 91/181)
2025-12-22 23:48:44 INFO Epoch 078 | 75% complete (batch 136/181)
2025-12-22 23:48:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.661609
2025-12-22 23:48:58 INFO Tuning ranking metrics: regret=0.117995 spearman=0.111659 (groups=37, skipped=311)
2025-12-22 23:48:58 INFO Epoch 078 | train_mse=0.059254 | val_loss=0.070758 | best_val_loss=0.240886
2025-12-22 23:49:06 INFO Epoch 079 | 25% complete (batch 46/181)
2025-12-22 23:49:07 INFO Epoch 079 | 50% complete (batch 91/181)
2025-12-22 23:49:08 INFO Epoch 079 | 75% complete (batch 136/181)
2025-12-22 23:49:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.683979
2025-12-22 23:49:21 INFO Tuning ranking metrics: regret=0.118255 spearman=0.126161 (groups=37, skipped=311)
2025-12-22 23:49:21 INFO Epoch 079 | train_mse=0.066446 | val_loss=0.060964 | best_val_loss=0.240886
2025-12-22 23:49:29 INFO Epoch 080 | 25% complete (batch 46/181)
2025-12-22 23:49:30 INFO Epoch 080 | 50% complete (batch 91/181)
2025-12-22 23:49:31 INFO Epoch 080 | 75% complete (batch 136/181)
2025-12-22 23:49:40 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.684910
2025-12-22 23:49:45 INFO Tuning ranking metrics: regret=0.120775 spearman=0.107353 (groups=37, skipped=311)
2025-12-22 23:49:45 INFO Epoch 080 | train_mse=0.061175 | val_loss=0.060636 | best_val_loss=0.240886
2025-12-22 23:49:53 INFO Epoch 081 | 25% complete (batch 46/181)
2025-12-22 23:49:54 INFO Epoch 081 | 50% complete (batch 91/181)
2025-12-22 23:49:55 INFO Epoch 081 | 75% complete (batch 136/181)
2025-12-22 23:50:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.687146
2025-12-22 23:50:08 INFO Tuning ranking metrics: regret=0.120775 spearman=0.123652 (groups=37, skipped=311)
2025-12-22 23:50:08 INFO Epoch 081 | train_mse=0.054930 | val_loss=0.061301 | best_val_loss=0.240886
2025-12-22 23:50:17 INFO Epoch 082 | 25% complete (batch 46/181)
2025-12-22 23:50:18 INFO Epoch 082 | 50% complete (batch 91/181)
2025-12-22 23:50:19 INFO Epoch 082 | 75% complete (batch 136/181)
2025-12-22 23:50:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.685411
2025-12-22 23:50:32 INFO Tuning ranking metrics: regret=0.119982 spearman=0.094267 (groups=37, skipped=311)
2025-12-22 23:50:32 INFO Epoch 082 | train_mse=0.059835 | val_loss=0.067496 | best_val_loss=0.240886
2025-12-22 23:50:40 INFO Epoch 083 | 25% complete (batch 46/181)
2025-12-22 23:50:42 INFO Epoch 083 | 50% complete (batch 91/181)
2025-12-22 23:50:42 INFO Epoch 083 | 75% complete (batch 136/181)
2025-12-22 23:50:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.695210
2025-12-22 23:50:56 INFO Tuning ranking metrics: regret=0.122907 spearman=0.049702 (groups=37, skipped=311)
2025-12-22 23:50:56 INFO Epoch 083 | train_mse=0.071458 | val_loss=0.059290 | best_val_loss=0.240886
2025-12-22 23:51:04 INFO Epoch 084 | 25% complete (batch 46/181)
2025-12-22 23:51:05 INFO Epoch 084 | 50% complete (batch 91/181)
2025-12-22 23:51:06 INFO Epoch 084 | 75% complete (batch 136/181)
2025-12-22 23:51:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.691759
2025-12-22 23:51:19 INFO Tuning ranking metrics: regret=0.123378 spearman=0.046537 (groups=37, skipped=311)
2025-12-22 23:51:19 INFO Epoch 084 | train_mse=0.063381 | val_loss=0.059036 | best_val_loss=0.240886
2025-12-22 23:51:28 INFO Epoch 085 | 25% complete (batch 46/181)
2025-12-22 23:51:29 INFO Epoch 085 | 50% complete (batch 91/181)
2025-12-22 23:51:30 INFO Epoch 085 | 75% complete (batch 136/181)
2025-12-22 23:51:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.689954
2025-12-22 23:51:43 INFO Tuning ranking metrics: regret=0.123130 spearman=0.055353 (groups=37, skipped=311)
2025-12-22 23:51:43 INFO Epoch 085 | train_mse=0.072278 | val_loss=0.062685 | best_val_loss=0.240886
2025-12-22 23:51:51 INFO Epoch 086 | 25% complete (batch 46/181)
2025-12-22 23:51:52 INFO Epoch 086 | 50% complete (batch 91/181)
2025-12-22 23:51:53 INFO Epoch 086 | 75% complete (batch 136/181)
2025-12-22 23:52:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.682568
2025-12-22 23:52:07 INFO Tuning ranking metrics: regret=0.123106 spearman=0.054505 (groups=37, skipped=311)
2025-12-22 23:52:07 INFO Epoch 086 | train_mse=0.072575 | val_loss=0.062945 | best_val_loss=0.240886
2025-12-22 23:52:15 INFO Epoch 087 | 25% complete (batch 46/181)
2025-12-22 23:52:16 INFO Epoch 087 | 50% complete (batch 91/181)
2025-12-22 23:52:16 INFO Epoch 087 | 75% complete (batch 136/181)
2025-12-22 23:52:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.689540
2025-12-22 23:52:30 INFO Tuning ranking metrics: regret=0.121651 spearman=0.091658 (groups=37, skipped=311)
2025-12-22 23:52:30 INFO Epoch 087 | train_mse=0.056496 | val_loss=0.057347 | best_val_loss=0.240886
2025-12-22 23:52:38 INFO Epoch 088 | 25% complete (batch 46/181)
2025-12-22 23:52:39 INFO Epoch 088 | 50% complete (batch 91/181)
2025-12-22 23:52:40 INFO Epoch 088 | 75% complete (batch 136/181)
2025-12-22 23:52:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.702115
2025-12-22 23:52:53 INFO Tuning ranking metrics: regret=0.122269 spearman=0.150567 (groups=37, skipped=311)
2025-12-22 23:52:53 INFO Epoch 088 | train_mse=0.061939 | val_loss=0.057767 | best_val_loss=0.240886
2025-12-22 23:53:01 INFO Epoch 089 | 25% complete (batch 46/181)
2025-12-22 23:53:02 INFO Epoch 089 | 50% complete (batch 91/181)
2025-12-22 23:53:03 INFO Epoch 089 | 75% complete (batch 136/181)
2025-12-22 23:53:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.692641
2025-12-22 23:53:16 INFO Tuning ranking metrics: regret=0.122116 spearman=0.143495 (groups=37, skipped=311)
2025-12-22 23:53:16 INFO Epoch 089 | train_mse=0.057851 | val_loss=0.064391 | best_val_loss=0.240886
2025-12-22 23:53:25 INFO Epoch 090 | 25% complete (batch 46/181)
2025-12-22 23:53:26 INFO Epoch 090 | 50% complete (batch 91/181)
2025-12-22 23:53:27 INFO Epoch 090 | 75% complete (batch 136/181)
2025-12-22 23:53:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.694835
2025-12-22 23:53:40 INFO Tuning ranking metrics: regret=0.122075 spearman=0.140500 (groups=37, skipped=311)
2025-12-22 23:53:40 INFO Epoch 090 | train_mse=0.050770 | val_loss=0.056714 | best_val_loss=0.240886
2025-12-22 23:53:48 INFO Epoch 091 | 25% complete (batch 46/181)
2025-12-22 23:53:49 INFO Epoch 091 | 50% complete (batch 91/181)
2025-12-22 23:53:51 INFO Epoch 091 | 75% complete (batch 136/181)
2025-12-22 23:53:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.696647
2025-12-22 23:54:04 INFO Tuning ranking metrics: regret=0.125012 spearman=0.126618 (groups=37, skipped=311)
2025-12-22 23:54:04 INFO Epoch 091 | train_mse=0.049592 | val_loss=0.058524 | best_val_loss=0.240886
2025-12-22 23:54:12 INFO Epoch 092 | 25% complete (batch 46/181)
2025-12-22 23:54:13 INFO Epoch 092 | 50% complete (batch 91/181)
2025-12-22 23:54:14 INFO Epoch 092 | 75% complete (batch 136/181)
2025-12-22 23:54:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.694387
2025-12-22 23:54:28 INFO Tuning ranking metrics: regret=0.122141 spearman=0.131432 (groups=37, skipped=311)
2025-12-22 23:54:28 INFO Epoch 092 | train_mse=0.060216 | val_loss=0.057615 | best_val_loss=0.240886
2025-12-22 23:54:36 INFO Epoch 093 | 25% complete (batch 46/181)
2025-12-22 23:54:37 INFO Epoch 093 | 50% complete (batch 91/181)
2025-12-22 23:54:38 INFO Epoch 093 | 75% complete (batch 136/181)
2025-12-22 23:54:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.672521
2025-12-22 23:54:51 INFO Tuning ranking metrics: regret=0.122296 spearman=0.072575 (groups=37, skipped=311)
2025-12-22 23:54:51 INFO Epoch 093 | train_mse=0.060156 | val_loss=0.080805 | best_val_loss=0.240886
2025-12-22 23:55:00 INFO Epoch 094 | 25% complete (batch 46/181)
2025-12-22 23:55:00 INFO Epoch 094 | 50% complete (batch 91/181)
2025-12-22 23:55:01 INFO Epoch 094 | 75% complete (batch 136/181)
2025-12-22 23:55:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.707712
2025-12-22 23:55:15 INFO Tuning ranking metrics: regret=0.122116 spearman=0.152042 (groups=37, skipped=311)
2025-12-22 23:55:15 INFO Epoch 094 | train_mse=0.057206 | val_loss=0.059062 | best_val_loss=0.240886
2025-12-22 23:55:23 INFO Epoch 095 | 25% complete (batch 46/181)
2025-12-22 23:55:24 INFO Epoch 095 | 50% complete (batch 91/181)
2025-12-22 23:55:25 INFO Epoch 095 | 75% complete (batch 136/181)
2025-12-22 23:55:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.697126
2025-12-22 23:55:38 INFO Tuning ranking metrics: regret=0.121406 spearman=0.155037 (groups=37, skipped=311)
2025-12-22 23:55:38 INFO Epoch 095 | train_mse=0.080816 | val_loss=0.057776 | best_val_loss=0.240886
2025-12-22 23:55:46 INFO Epoch 096 | 25% complete (batch 46/181)
2025-12-22 23:55:47 INFO Epoch 096 | 50% complete (batch 91/181)
2025-12-22 23:55:48 INFO Epoch 096 | 75% complete (batch 136/181)
2025-12-22 23:55:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.697716
2025-12-22 23:56:01 INFO Tuning ranking metrics: regret=0.119503 spearman=0.194425 (groups=37, skipped=311)
2025-12-22 23:56:01 INFO Epoch 096 | train_mse=0.066394 | val_loss=0.057136 | best_val_loss=0.240886
2025-12-22 23:56:10 INFO Epoch 097 | 25% complete (batch 46/181)
2025-12-22 23:56:11 INFO Epoch 097 | 50% complete (batch 91/181)
2025-12-22 23:56:11 INFO Epoch 097 | 75% complete (batch 136/181)
2025-12-22 23:56:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.691805
2025-12-22 23:56:25 INFO Tuning ranking metrics: regret=0.112468 spearman=0.205663 (groups=37, skipped=311)
2025-12-22 23:56:25 INFO Epoch 097 | train_mse=0.055409 | val_loss=0.059056 | best_val_loss=0.240886
2025-12-22 23:56:33 INFO Epoch 098 | 25% complete (batch 46/181)
2025-12-22 23:56:34 INFO Epoch 098 | 50% complete (batch 91/181)
2025-12-22 23:56:35 INFO Epoch 098 | 75% complete (batch 136/181)
2025-12-22 23:56:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.684114
2025-12-22 23:56:48 INFO Tuning ranking metrics: regret=0.122065 spearman=0.182702 (groups=37, skipped=311)
2025-12-22 23:56:48 INFO Epoch 098 | train_mse=0.051964 | val_loss=0.060174 | best_val_loss=0.240886
2025-12-22 23:56:57 INFO Epoch 099 | 25% complete (batch 46/181)
2025-12-22 23:56:58 INFO Epoch 099 | 50% complete (batch 91/181)
2025-12-22 23:56:59 INFO Epoch 099 | 75% complete (batch 136/181)
2025-12-22 23:57:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.698107
2025-12-22 23:57:12 INFO Tuning ranking metrics: regret=0.119697 spearman=0.180906 (groups=37, skipped=311)
2025-12-22 23:57:12 INFO Epoch 099 | train_mse=0.066658 | val_loss=0.056812 | best_val_loss=0.240886
2025-12-22 23:57:20 INFO Epoch 100 | 25% complete (batch 46/181)
2025-12-22 23:57:21 INFO Epoch 100 | 50% complete (batch 91/181)
2025-12-22 23:57:22 INFO Epoch 100 | 75% complete (batch 136/181)
2025-12-22 23:57:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.691460
2025-12-22 23:57:36 INFO Tuning ranking metrics: regret=0.119697 spearman=0.183608 (groups=37, skipped=311)
2025-12-22 23:57:36 INFO Epoch 100 | train_mse=0.063744 | val_loss=0.056601 | best_val_loss=0.240886
2025-12-22 23:57:44 INFO Epoch 101 | 25% complete (batch 46/181)
2025-12-22 23:57:45 INFO Epoch 101 | 50% complete (batch 91/181)
2025-12-22 23:57:46 INFO Epoch 101 | 75% complete (batch 136/181)
2025-12-22 23:57:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.694447
2025-12-22 23:57:59 INFO Tuning ranking metrics: regret=0.112525 spearman=0.177203 (groups=37, skipped=311)
2025-12-22 23:57:59 INFO Epoch 101 | train_mse=0.053318 | val_loss=0.056783 | best_val_loss=0.240886
2025-12-22 23:58:08 INFO Epoch 102 | 25% complete (batch 46/181)
2025-12-22 23:58:09 INFO Epoch 102 | 50% complete (batch 91/181)
2025-12-22 23:58:09 INFO Epoch 102 | 75% complete (batch 136/181)
2025-12-22 23:58:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.689083
2025-12-22 23:58:23 INFO Tuning ranking metrics: regret=0.122051 spearman=0.161665 (groups=37, skipped=311)
2025-12-22 23:58:23 INFO Epoch 102 | train_mse=0.054537 | val_loss=0.056262 | best_val_loss=0.240886
2025-12-22 23:58:31 INFO Epoch 103 | 25% complete (batch 46/181)
2025-12-22 23:58:32 INFO Epoch 103 | 50% complete (batch 91/181)
2025-12-22 23:58:33 INFO Epoch 103 | 75% complete (batch 136/181)
2025-12-22 23:58:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.693135
2025-12-22 23:58:46 INFO Tuning ranking metrics: regret=0.124613 spearman=0.163578 (groups=37, skipped=311)
2025-12-22 23:58:46 INFO Epoch 103 | train_mse=0.057337 | val_loss=0.054943 | best_val_loss=0.240886
2025-12-22 23:58:54 INFO Epoch 104 | 25% complete (batch 46/181)
2025-12-22 23:58:55 INFO Epoch 104 | 50% complete (batch 91/181)
2025-12-22 23:58:56 INFO Epoch 104 | 75% complete (batch 136/181)
2025-12-22 23:59:04 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.697259
2025-12-22 23:59:10 INFO Tuning ranking metrics: regret=0.122245 spearman=0.165415 (groups=37, skipped=311)
2025-12-22 23:59:10 INFO Epoch 104 | train_mse=0.046224 | val_loss=0.055044 | best_val_loss=0.240886
2025-12-22 23:59:18 INFO Epoch 105 | 25% complete (batch 46/181)
2025-12-22 23:59:19 INFO Epoch 105 | 50% complete (batch 91/181)
2025-12-22 23:59:20 INFO Epoch 105 | 75% complete (batch 136/181)
2025-12-22 23:59:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.689687
2025-12-22 23:59:33 INFO Tuning ranking metrics: regret=0.124592 spearman=0.161238 (groups=37, skipped=311)
2025-12-22 23:59:33 INFO Epoch 105 | train_mse=0.050940 | val_loss=0.059497 | best_val_loss=0.240886
2025-12-22 23:59:41 INFO Epoch 106 | 25% complete (batch 46/181)
2025-12-22 23:59:42 INFO Epoch 106 | 50% complete (batch 91/181)
2025-12-22 23:59:43 INFO Epoch 106 | 75% complete (batch 136/181)
2025-12-22 23:59:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.694431
2025-12-22 23:59:57 INFO Tuning ranking metrics: regret=0.121451 spearman=0.156271 (groups=37, skipped=311)
2025-12-22 23:59:57 INFO Epoch 106 | train_mse=0.065154 | val_loss=0.055274 | best_val_loss=0.240886
2025-12-23 00:00:05 INFO Epoch 107 | 25% complete (batch 46/181)
2025-12-23 00:00:06 INFO Epoch 107 | 50% complete (batch 91/181)
2025-12-23 00:00:07 INFO Epoch 107 | 75% complete (batch 136/181)
2025-12-23 00:00:15 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.694846
2025-12-23 00:00:20 INFO Tuning ranking metrics: regret=0.122224 spearman=0.146244 (groups=37, skipped=311)
2025-12-23 00:00:20 INFO Epoch 107 | train_mse=0.054079 | val_loss=0.054238 | best_val_loss=0.240886
2025-12-23 00:00:29 INFO Epoch 108 | 25% complete (batch 46/181)
2025-12-23 00:00:29 INFO Epoch 108 | 50% complete (batch 91/181)
2025-12-23 00:00:30 INFO Epoch 108 | 75% complete (batch 136/181)
2025-12-23 00:00:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.696940
2025-12-23 00:00:44 INFO Tuning ranking metrics: regret=0.122224 spearman=0.148830 (groups=37, skipped=311)
2025-12-23 00:00:44 INFO Epoch 108 | train_mse=0.064868 | val_loss=0.053720 | best_val_loss=0.240886
2025-12-23 00:00:52 INFO Epoch 109 | 25% complete (batch 46/181)
2025-12-23 00:00:53 INFO Epoch 109 | 50% complete (batch 91/181)
2025-12-23 00:00:54 INFO Epoch 109 | 75% complete (batch 136/181)
2025-12-23 00:01:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.703046
2025-12-23 00:01:07 INFO Tuning ranking metrics: regret=0.122290 spearman=0.179695 (groups=37, skipped=311)
2025-12-23 00:01:07 INFO Epoch 109 | train_mse=0.046605 | val_loss=0.053248 | best_val_loss=0.240886
2025-12-23 00:01:15 INFO Epoch 110 | 25% complete (batch 46/181)
2025-12-23 00:01:16 INFO Epoch 110 | 50% complete (batch 91/181)
2025-12-23 00:01:17 INFO Epoch 110 | 75% complete (batch 136/181)
2025-12-23 00:01:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.703846
2025-12-23 00:01:31 INFO Tuning ranking metrics: regret=0.123992 spearman=0.190049 (groups=37, skipped=311)
2025-12-23 00:01:31 INFO Epoch 110 | train_mse=0.052656 | val_loss=0.052817 | best_val_loss=0.240886
2025-12-23 00:01:39 INFO Epoch 111 | 25% complete (batch 46/181)
2025-12-23 00:01:40 INFO Epoch 111 | 50% complete (batch 91/181)
2025-12-23 00:01:41 INFO Epoch 111 | 75% complete (batch 136/181)
2025-12-23 00:01:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.705226
2025-12-23 00:01:54 INFO Tuning ranking metrics: regret=0.121624 spearman=0.195455 (groups=37, skipped=311)
2025-12-23 00:01:54 INFO Epoch 111 | train_mse=0.052370 | val_loss=0.052308 | best_val_loss=0.240886
2025-12-23 00:02:03 INFO Epoch 112 | 25% complete (batch 46/181)
2025-12-23 00:02:03 INFO Epoch 112 | 50% complete (batch 91/181)
2025-12-23 00:02:04 INFO Epoch 112 | 75% complete (batch 136/181)
2025-12-23 00:02:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.703993
2025-12-23 00:02:18 INFO Tuning ranking metrics: regret=0.121624 spearman=0.174020 (groups=37, skipped=311)
2025-12-23 00:02:18 INFO Epoch 112 | train_mse=0.054582 | val_loss=0.053843 | best_val_loss=0.240886
2025-12-23 00:02:26 INFO Epoch 113 | 25% complete (batch 46/181)
2025-12-23 00:02:27 INFO Epoch 113 | 50% complete (batch 91/181)
2025-12-23 00:02:28 INFO Epoch 113 | 75% complete (batch 136/181)
2025-12-23 00:02:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.706374
2025-12-23 00:02:41 INFO Tuning ranking metrics: regret=0.121624 spearman=0.204826 (groups=37, skipped=311)
2025-12-23 00:02:41 INFO Epoch 113 | train_mse=0.055598 | val_loss=0.052603 | best_val_loss=0.240886
2025-12-23 00:02:50 INFO Epoch 114 | 25% complete (batch 46/181)
2025-12-23 00:02:51 INFO Epoch 114 | 50% complete (batch 91/181)
2025-12-23 00:02:51 INFO Epoch 114 | 75% complete (batch 136/181)
2025-12-23 00:03:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.707031
2025-12-23 00:03:05 INFO Tuning ranking metrics: regret=0.121624 spearman=0.199772 (groups=37, skipped=311)
2025-12-23 00:03:05 INFO Epoch 114 | train_mse=0.061782 | val_loss=0.054528 | best_val_loss=0.240886
2025-12-23 00:03:13 INFO Epoch 115 | 25% complete (batch 46/181)
2025-12-23 00:03:14 INFO Epoch 115 | 50% complete (batch 91/181)
2025-12-23 00:03:15 INFO Epoch 115 | 75% complete (batch 136/181)
2025-12-23 00:03:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.715656
2025-12-23 00:03:29 INFO Tuning ranking metrics: regret=0.121624 spearman=0.168322 (groups=37, skipped=311)
2025-12-23 00:03:29 INFO Epoch 115 | train_mse=0.059613 | val_loss=0.052124 | best_val_loss=0.240886
2025-12-23 00:03:37 INFO Epoch 116 | 25% complete (batch 46/181)
2025-12-23 00:03:38 INFO Epoch 116 | 50% complete (batch 91/181)
2025-12-23 00:03:39 INFO Epoch 116 | 75% complete (batch 136/181)
2025-12-23 00:03:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.703177
2025-12-23 00:03:52 INFO Tuning ranking metrics: regret=0.121451 spearman=0.162554 (groups=37, skipped=311)
2025-12-23 00:03:52 INFO Epoch 116 | train_mse=0.067987 | val_loss=0.052731 | best_val_loss=0.240886
2025-12-23 00:04:01 INFO Epoch 117 | 25% complete (batch 46/181)
2025-12-23 00:04:02 INFO Epoch 117 | 50% complete (batch 91/181)
2025-12-23 00:04:03 INFO Epoch 117 | 75% complete (batch 136/181)
2025-12-23 00:04:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.705115
2025-12-23 00:04:16 INFO Tuning ranking metrics: regret=0.121624 spearman=0.161840 (groups=37, skipped=311)
2025-12-23 00:04:16 INFO Epoch 117 | train_mse=0.051852 | val_loss=0.051414 | best_val_loss=0.240886
Monitored metric tuning_rank_spearman did not improve in the last 40 records. Best score: 0.241. Signaling Trainer to stop.
2025-12-23 00:04:17 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.20566_val-0.05906_epoch097.chkpt, checkpoint.tuning_rank_spearman-0.22055_val-0.12772_epoch074.chkpt, checkpoint.tuning_rank_spearman-0.24089_val-0.06582_epoch077.chkpt
2025-12-23 00:04:17 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed101/model_checkpoints/checkpoint.tuning_rank_spearman-0.24089_val-0.06582_epoch077.chkpt
2025-12-23 00:04:17 INFO Best validation loss: tensor(0.2409)
2025-12-23 00:04:17 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed101/model_checkpoints/checkpoint.tuning_rank_spearman-0.24089_val-0.06582_epoch077.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed101/model_checkpoints/checkpoint.tuning_rank_spearman-0.24089_val-0.06582_epoch077.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-23 00:04:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.065824
2025-12-23 00:04:29 INFO Tuning ranking metrics: regret=0.111376 spearman=0.240886 (groups=37, skipped=311)
2025-12-23 00:04:29 INFO Epoch 118 | val_loss=0.065824 | best_val_loss=0.240886
2025-12-23 00:04:29 INFO Validation metrics: [{'val_loss': 0.0658237412571907, 'tuning_rank_regret': 0.11137597262859344, 'tuning_rank_spearman': 0.2408856898546219, 'val_pearson_corr': 0.7331315279006958, 'val_spearman_corr': 0.7323669791221619, 'val_rank_regret': 0.0033600511960685253, 'val_rank_spearman': 0.8333333134651184}]
2025-12-23 00:04:29 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.24089_val-0.06582_epoch077.chkpt
2025-12-23 00:04:29 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.22055_val-0.12772_epoch074.chkpt
2025-12-23 00:04:29 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.20566_val-0.05906_epoch097.chkpt
2025-12-23 00:04:29 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.05665_epoch056.ckpt
2025-12-23 00:04:29 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.11137597262859344
  tuning_rank_spearman      0.2408856898546219
        val_loss            0.0658237412571907
    val_pearson_corr        0.7331315279006958
     val_rank_regret       0.0033600511960685253
    val_rank_spearman       0.8333333134651184
    val_spearman_corr       0.7323669791221619
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run polish_seed101_2025-12-22_18-34-49_phase2_seed101 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed101
[run_full_pipeline] Phase 2 (seed 101) best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed101/model_checkpoints/checkpoint.tuning_rank_spearman-0.24089_val-0.06582_epoch077.chkpt (tuning_rank_spearman=0.2408856898546219)
[run_full_pipeline] Phase 2 fine-tuning (seed 555) -> polish_seed101_2025-12-22_18-34-49_phase2_seed555
[train_cli] run_id=polish_seed101_2025-12-22_18-34-49_phase2_seed555 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed555/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed555 --git-commit 150d1dcbd1 --git-dirty --resume-from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.08056_val-0.13668_epoch013.chkpt
2025-12-23 00:04:35 INFO git_commit = 150d1dcbd1 (dirty)
2025-12-23 00:04:35 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-23 00:04:35 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed555/config/config.yaml
2025-12-23 00:04:35 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data
2025-12-23 00:04:35 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-23 00:04:35 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-23 00:04:35 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed555
2025-12-23 00:04:35 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-23 00:04:35 INFO   metadata_path = None
2025-12-23 00:04:35 INFO   summary_path = None
2025-12-23 00:04:35 INFO   accelerator = cpu
2025-12-23 00:04:35 INFO   devices = 1
2025-12-23 00:04:35 INFO   attention_head = 8
2025-12-23 00:04:35 INFO   pooling_type = mean
2025-12-23 00:04:35 INFO   model_self_loops = False
2025-12-23 00:04:35 INFO   model_self_loop_fill = mean
2025-12-23 00:04:35 INFO   model_residual = False
2025-12-23 00:04:35 INFO   batch_size = 48
2025-12-23 00:04:35 INFO   learning_rate = 0.001
2025-12-23 00:04:35 INFO   num_epochs = 320
2025-12-23 00:04:35 INFO   accumulate_grad_batches = 8
2025-12-23 00:04:35 INFO   seed = 555
2025-12-23 00:04:35 INFO   num_workers = 2
2025-12-23 00:04:35 INFO   precision = 32
2025-12-23 00:04:35 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-23 00:04:35 INFO   early_stopping_patience = 20
2025-12-23 00:04:35 INFO   lr_scheduler_patience = 4
2025-12-23 00:04:35 INFO   lr_scheduler_factor = 0.2
2025-12-23 00:04:35 INFO   fast_dev_run = False
2025-12-23 00:04:35 INFO   limit_train_batches = None
2025-12-23 00:04:35 INFO   limit_val_batches = None
2025-12-23 00:04:35 INFO   log_lr = False
2025-12-23 00:04:35 INFO   progress_bar_refresh_rate = 0
2025-12-23 00:04:35 INFO   log_every_n_steps = 100
2025-12-23 00:04:35 INFO   use_val_spearman_as_secondary = True
2025-12-23 00:04:35 INFO   spearman_secondary_min_delta = 0.0
2025-12-23 00:04:35 INFO   spearman_secondary_weight = 1.0
2025-12-23 00:04:35 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-23 00:04:35 INFO   tuning_max_samples = 500
2025-12-23 00:04:35 INFO   tuning_fraction = None
2025-12-23 00:04:35 INFO   tuning_eval_every = 1
2025-12-23 00:04:35 INFO   rank_loss_weight = 0.0
2025-12-23 00:04:35 INFO   rank_loss_margin = 0.0
2025-12-23 00:04:35 INFO   rank_loss_mode = hinge
2025-12-23 00:04:35 INFO   rank_loss_grouped = True
2025-12-23 00:04:35 INFO   variance_reduction_enabled = False
2025-12-23 00:04:35 INFO   variance_reduction_method = topk_avg
2025-12-23 00:04:35 INFO   variance_reduction_top_k = 3
2025-12-23 00:04:35 INFO   coverage_minimum = 0.0
2025-12-23 00:04:35 INFO   coverage_fail_on_missing = False
2025-12-23 00:04:35 INFO   graph_load_profiling = False
2025-12-23 00:04:35 INFO   graph_load_top_k = 5
2025-12-23 00:04:35 INFO   enable_graph_cache = True
2025-12-23 00:04:35 INFO   graph_cache_size = 256
2025-12-23 00:04:35 INFO   canonicalize_on_load = False
2025-12-23 00:04:35 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-23 00:04:35 INFO   edge_schema = {}
2025-12-23 00:04:35 INFO   topology_schema = {}
Seed set to 555
2025-12-23 00:04:36 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-23 00:04:36 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-23 00:04:36 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-23 00:04:36 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-23 00:04:36 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-23 00:04:36 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-23 00:04:36 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-23 00:04:36 INFO Tuning group stats: groups=368 groups>=2=39 singletons=329 max_group=9
2025-12-23 00:04:36 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed555/dataset_coverage.json
2025-12-23 00:04:36 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed555/dataset_coverage.json for details.
2025-12-23 00:04:36 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed555/dataset_coverage.json for details.
2025-12-23 00:04:36 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed555/dataset_coverage.json for details.
2025-12-23 00:04:36 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed555/schema_summary.json
2025-12-23 00:04:36 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed555/feature_metadata.json
2025-12-23 00:04:36 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-23 00:04:36 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/feature-config.yaml.topoqa.10A.2, sha256=5c62898155179232a565e24d9fbd7b208f9ce480d1a19d6139de19454e173ff0
2025-12-23 00:04:36 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/work/edge_features)
2025-12-23 00:04:36 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json
2025-12-23 00:04:36 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed555/schema_summary.json
2025-12-23 00:04:36 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-23 00:04:36 INFO Topology: topology/persistence_basic/v1 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 172-dimensional node features.
2025-12-23 00:04:36 INFO Node: node/dssp_topo_merge/v1; metadata lists 172 feature columns matching the .pt tensor.
2025-12-23 00:04:36 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-23 00:04:36 INFO → Total feature dimensionality observed and confirmed: node_dim = 172, edge_dim = 11.
2025-12-23 00:04:36 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-23 00:04:36 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 172,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 172,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed555/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge/v1",
      "alias": "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA",
      "jobs": 16,
      "summary": "DSSP-derived node features merged with topology statistics."
    },
    "topology": {
      "id": "topology/persistence_basic/v1",
      "alias": "Betti 0 and Betti 1 topology summaries on interface coords = 140D PH | TopoQA",
      "jobs": 16,
      "summary": "Persistent homology features with configurable distance thresholds."
    }
  },
  "notes": []
}
2025-12-23 00:04:36 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-23 00:04:37 INFO Resuming from checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.08056_val-0.13668_epoch013.chkpt (epoch=13)
2025-12-23 00:04:37 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=dc576583a361423f8829495bbecd1a94)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-23 00:04:37 INFO Starting training (fast_dev_run=False)
2025-12-23 00:04:37 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed555/model_checkpoints exists and is not empty.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.08056_val-0.13668_epoch013.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase1/model_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed555/model_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase1/model_checkpoints/val_loss_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed555/model_checkpoints/val_loss_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 5.5 K  | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
165 K     Trainable params
0         Non-trainable params
165 K     Total params
0.662     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
Restored all states from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.08056_val-0.13668_epoch013.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-23 00:04:51 INFO Epoch 014 | 25% complete (batch 46/181)
2025-12-23 00:04:51 INFO Epoch 014 | 50% complete (batch 91/181)
2025-12-23 00:04:52 INFO Epoch 014 | 75% complete (batch 136/181)
2025-12-23 00:05:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.125686
2025-12-23 00:05:06 INFO Tuning ranking metrics: regret=0.108749 spearman=0.204029 (groups=39, skipped=329)
2025-12-23 00:05:06 INFO Epoch 014 | val_loss=0.125686
Metric tuning_rank_spearman improved by 0.057 >= min_delta = 0.0. New best score: 0.204
2025-12-23 00:05:14 INFO Epoch 015 | 25% complete (batch 46/181)
2025-12-23 00:05:15 INFO Epoch 015 | 50% complete (batch 91/181)
2025-12-23 00:05:15 INFO Epoch 015 | 75% complete (batch 136/181)
2025-12-23 00:05:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.457679
2025-12-23 00:05:29 INFO Tuning ranking metrics: regret=0.108103 spearman=0.238889 (groups=39, skipped=329)
2025-12-23 00:05:29 INFO Epoch 015 | train_mse=0.145317 | val_loss=0.137027 | best_val_loss=0.204029
Metric tuning_rank_spearman improved by 0.035 >= min_delta = 0.0. New best score: 0.239
2025-12-23 00:05:37 INFO Epoch 016 | 25% complete (batch 46/181)
2025-12-23 00:05:38 INFO Epoch 016 | 50% complete (batch 91/181)
2025-12-23 00:05:39 INFO Epoch 016 | 75% complete (batch 136/181)
2025-12-23 00:05:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.534059
2025-12-23 00:05:52 INFO Tuning ranking metrics: regret=0.132457 spearman=0.212454 (groups=39, skipped=329)
2025-12-23 00:05:52 INFO Epoch 016 | train_mse=0.139213 | val_loss=0.121798 | best_val_loss=0.238889
2025-12-23 00:06:00 INFO Epoch 017 | 25% complete (batch 46/181)
2025-12-23 00:06:01 INFO Epoch 017 | 50% complete (batch 91/181)
2025-12-23 00:06:02 INFO Epoch 017 | 75% complete (batch 136/181)
2025-12-23 00:06:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.594039
2025-12-23 00:06:15 INFO Tuning ranking metrics: regret=0.120042 spearman=0.244628 (groups=39, skipped=329)
2025-12-23 00:06:15 INFO Epoch 017 | train_mse=0.138704 | val_loss=0.091832 | best_val_loss=0.238889
Metric tuning_rank_spearman improved by 0.006 >= min_delta = 0.0. New best score: 0.245
2025-12-23 00:06:23 INFO Epoch 018 | 25% complete (batch 46/181)
2025-12-23 00:06:24 INFO Epoch 018 | 50% complete (batch 91/181)
2025-12-23 00:06:25 INFO Epoch 018 | 75% complete (batch 136/181)
2025-12-23 00:06:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.578749
2025-12-23 00:06:39 INFO Tuning ranking metrics: regret=0.116524 spearman=0.265201 (groups=39, skipped=329)
2025-12-23 00:06:39 INFO Epoch 018 | train_mse=0.125876 | val_loss=0.097229 | best_val_loss=0.244628
Metric tuning_rank_spearman improved by 0.021 >= min_delta = 0.0. New best score: 0.265
2025-12-23 00:06:47 INFO Epoch 019 | 25% complete (batch 46/181)
2025-12-23 00:06:48 INFO Epoch 019 | 50% complete (batch 91/181)
2025-12-23 00:06:49 INFO Epoch 019 | 75% complete (batch 136/181)
2025-12-23 00:06:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.570758
2025-12-23 00:07:02 INFO Tuning ranking metrics: regret=0.101943 spearman=0.355556 (groups=39, skipped=329)
2025-12-23 00:07:02 INFO Epoch 019 | train_mse=0.113190 | val_loss=0.113504 | best_val_loss=0.265201
Metric tuning_rank_spearman improved by 0.090 >= min_delta = 0.0. New best score: 0.356
2025-12-23 00:07:10 INFO Epoch 020 | 25% complete (batch 46/181)
2025-12-23 00:07:11 INFO Epoch 020 | 50% complete (batch 91/181)
2025-12-23 00:07:12 INFO Epoch 020 | 75% complete (batch 136/181)
2025-12-23 00:07:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.525814
2025-12-23 00:07:25 INFO Tuning ranking metrics: regret=0.130012 spearman=0.231380 (groups=39, skipped=329)
2025-12-23 00:07:25 INFO Epoch 020 | train_mse=0.116172 | val_loss=0.104591 | best_val_loss=0.355556
2025-12-23 00:07:33 INFO Epoch 021 | 25% complete (batch 46/181)
2025-12-23 00:07:34 INFO Epoch 021 | 50% complete (batch 91/181)
2025-12-23 00:07:35 INFO Epoch 021 | 75% complete (batch 136/181)
2025-12-23 00:07:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.557911
2025-12-23 00:07:48 INFO Tuning ranking metrics: regret=0.111634 spearman=0.239133 (groups=39, skipped=329)
2025-12-23 00:07:48 INFO Epoch 021 | train_mse=0.115017 | val_loss=0.104469 | best_val_loss=0.355556
2025-12-23 00:07:56 INFO Epoch 022 | 25% complete (batch 46/181)
2025-12-23 00:07:57 INFO Epoch 022 | 50% complete (batch 91/181)
2025-12-23 00:07:58 INFO Epoch 022 | 75% complete (batch 136/181)
2025-12-23 00:08:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.567827
2025-12-23 00:08:12 INFO Tuning ranking metrics: regret=0.111959 spearman=0.224237 (groups=39, skipped=329)
2025-12-23 00:08:12 INFO Epoch 022 | train_mse=0.118586 | val_loss=0.103037 | best_val_loss=0.355556
2025-12-23 00:08:20 INFO Epoch 023 | 25% complete (batch 46/181)
2025-12-23 00:08:21 INFO Epoch 023 | 50% complete (batch 91/181)
2025-12-23 00:08:22 INFO Epoch 023 | 75% complete (batch 136/181)
2025-12-23 00:08:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.597236
2025-12-23 00:08:35 INFO Tuning ranking metrics: regret=0.098442 spearman=0.240232 (groups=39, skipped=329)
2025-12-23 00:08:35 INFO Epoch 023 | train_mse=0.126837 | val_loss=0.077099 | best_val_loss=0.355556
2025-12-23 00:08:43 INFO Epoch 024 | 25% complete (batch 46/181)
2025-12-23 00:08:44 INFO Epoch 024 | 50% complete (batch 91/181)
2025-12-23 00:08:45 INFO Epoch 024 | 75% complete (batch 136/181)
2025-12-23 00:08:53 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.599595
2025-12-23 00:08:58 INFO Tuning ranking metrics: regret=0.115359 spearman=0.244994 (groups=39, skipped=329)
2025-12-23 00:08:58 INFO Epoch 024 | train_mse=0.101696 | val_loss=0.076986 | best_val_loss=0.355556
2025-12-23 00:09:06 INFO Epoch 025 | 25% complete (batch 46/181)
2025-12-23 00:09:07 INFO Epoch 025 | 50% complete (batch 91/181)
2025-12-23 00:09:08 INFO Epoch 025 | 75% complete (batch 136/181)
2025-12-23 00:09:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.614348
2025-12-23 00:09:22 INFO Tuning ranking metrics: regret=0.117054 spearman=0.214896 (groups=39, skipped=329)
2025-12-23 00:09:22 INFO Epoch 025 | train_mse=0.100479 | val_loss=0.077408 | best_val_loss=0.355556
2025-12-23 00:09:30 INFO Epoch 026 | 25% complete (batch 46/181)
2025-12-23 00:09:31 INFO Epoch 026 | 50% complete (batch 91/181)
2025-12-23 00:09:32 INFO Epoch 026 | 75% complete (batch 136/181)
2025-12-23 00:09:40 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.609229
2025-12-23 00:09:45 INFO Tuning ranking metrics: regret=0.117054 spearman=0.212943 (groups=39, skipped=329)
2025-12-23 00:09:45 INFO Epoch 026 | train_mse=0.087971 | val_loss=0.082560 | best_val_loss=0.355556
2025-12-23 00:09:53 INFO Epoch 027 | 25% complete (batch 46/181)
2025-12-23 00:09:54 INFO Epoch 027 | 50% complete (batch 91/181)
2025-12-23 00:09:55 INFO Epoch 027 | 75% complete (batch 136/181)
2025-12-23 00:10:04 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.601332
2025-12-23 00:10:09 INFO Tuning ranking metrics: regret=0.093931 spearman=0.241209 (groups=39, skipped=329)
2025-12-23 00:10:09 INFO Epoch 027 | train_mse=0.101321 | val_loss=0.079525 | best_val_loss=0.355556
2025-12-23 00:10:17 INFO Epoch 028 | 25% complete (batch 46/181)
2025-12-23 00:10:18 INFO Epoch 028 | 50% complete (batch 91/181)
2025-12-23 00:10:19 INFO Epoch 028 | 75% complete (batch 136/181)
2025-12-23 00:10:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.590294
2025-12-23 00:10:32 INFO Tuning ranking metrics: regret=0.124272 spearman=0.201709 (groups=39, skipped=329)
2025-12-23 00:10:32 INFO Epoch 028 | train_mse=0.099592 | val_loss=0.073058 | best_val_loss=0.355556
2025-12-23 00:10:40 INFO Epoch 029 | 25% complete (batch 46/181)
2025-12-23 00:10:41 INFO Epoch 029 | 50% complete (batch 91/181)
2025-12-23 00:10:42 INFO Epoch 029 | 75% complete (batch 136/181)
2025-12-23 00:10:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.596315
2025-12-23 00:10:55 INFO Tuning ranking metrics: regret=0.116987 spearman=0.200427 (groups=39, skipped=329)
2025-12-23 00:10:55 INFO Epoch 029 | train_mse=0.083226 | val_loss=0.074248 | best_val_loss=0.355556
2025-12-23 00:11:03 INFO Epoch 030 | 25% complete (batch 46/181)
2025-12-23 00:11:04 INFO Epoch 030 | 50% complete (batch 91/181)
2025-12-23 00:11:05 INFO Epoch 030 | 75% complete (batch 136/181)
2025-12-23 00:11:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.620154
2025-12-23 00:11:18 INFO Tuning ranking metrics: regret=0.118264 spearman=0.198962 (groups=39, skipped=329)
2025-12-23 00:11:18 INFO Epoch 030 | train_mse=0.103788 | val_loss=0.071501 | best_val_loss=0.355556
2025-12-23 00:11:27 INFO Epoch 031 | 25% complete (batch 46/181)
2025-12-23 00:11:28 INFO Epoch 031 | 50% complete (batch 91/181)
2025-12-23 00:11:29 INFO Epoch 031 | 75% complete (batch 136/181)
2025-12-23 00:11:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.621863
2025-12-23 00:11:42 INFO Tuning ranking metrics: regret=0.096911 spearman=0.213309 (groups=39, skipped=329)
2025-12-23 00:11:42 INFO Epoch 031 | train_mse=0.095917 | val_loss=0.076550 | best_val_loss=0.355556
2025-12-23 00:11:50 INFO Epoch 032 | 25% complete (batch 46/181)
2025-12-23 00:11:51 INFO Epoch 032 | 50% complete (batch 91/181)
2025-12-23 00:11:52 INFO Epoch 032 | 75% complete (batch 136/181)
2025-12-23 00:12:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.643256
2025-12-23 00:12:05 INFO Tuning ranking metrics: regret=0.099272 spearman=0.222100 (groups=39, skipped=329)
2025-12-23 00:12:05 INFO Epoch 032 | train_mse=0.082526 | val_loss=0.068135 | best_val_loss=0.355556
2025-12-23 00:12:14 INFO Epoch 033 | 25% complete (batch 46/181)
2025-12-23 00:12:14 INFO Epoch 033 | 50% complete (batch 91/181)
2025-12-23 00:12:15 INFO Epoch 033 | 75% complete (batch 136/181)
2025-12-23 00:12:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.631114
2025-12-23 00:12:29 INFO Tuning ranking metrics: regret=0.113233 spearman=0.221856 (groups=39, skipped=329)
2025-12-23 00:12:29 INFO Epoch 033 | train_mse=0.088795 | val_loss=0.071659 | best_val_loss=0.355556
2025-12-23 00:12:37 INFO Epoch 034 | 25% complete (batch 46/181)
2025-12-23 00:12:38 INFO Epoch 034 | 50% complete (batch 91/181)
2025-12-23 00:12:39 INFO Epoch 034 | 75% complete (batch 136/181)
2025-12-23 00:12:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.544213
2025-12-23 00:12:52 INFO Tuning ranking metrics: regret=0.110291 spearman=0.203541 (groups=39, skipped=329)
2025-12-23 00:12:52 INFO Epoch 034 | train_mse=0.065328 | val_loss=0.177239 | best_val_loss=0.355556
2025-12-23 00:13:01 INFO Epoch 035 | 25% complete (batch 46/181)
2025-12-23 00:13:01 INFO Epoch 035 | 50% complete (batch 91/181)
2025-12-23 00:13:02 INFO Epoch 035 | 75% complete (batch 136/181)
2025-12-23 00:13:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.600062
2025-12-23 00:13:16 INFO Tuning ranking metrics: regret=0.113075 spearman=0.209646 (groups=39, skipped=329)
2025-12-23 00:13:16 INFO Epoch 035 | train_mse=0.076197 | val_loss=0.102526 | best_val_loss=0.355556
2025-12-23 00:13:24 INFO Epoch 036 | 25% complete (batch 46/181)
2025-12-23 00:13:24 INFO Epoch 036 | 50% complete (batch 91/181)
2025-12-23 00:13:25 INFO Epoch 036 | 75% complete (batch 136/181)
2025-12-23 00:13:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.636953
2025-12-23 00:13:39 INFO Tuning ranking metrics: regret=0.103439 spearman=0.207753 (groups=39, skipped=329)
2025-12-23 00:13:39 INFO Epoch 036 | train_mse=0.119352 | val_loss=0.079351 | best_val_loss=0.355556
2025-12-23 00:13:47 INFO Epoch 037 | 25% complete (batch 46/181)
2025-12-23 00:13:48 INFO Epoch 037 | 50% complete (batch 91/181)
2025-12-23 00:13:49 INFO Epoch 037 | 75% complete (batch 136/181)
2025-12-23 00:13:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.602875
2025-12-23 00:14:03 INFO Tuning ranking metrics: regret=0.107970 spearman=0.211477 (groups=39, skipped=329)
2025-12-23 00:14:03 INFO Epoch 037 | train_mse=0.107181 | val_loss=0.081001 | best_val_loss=0.355556
2025-12-23 00:14:11 INFO Epoch 038 | 25% complete (batch 46/181)
2025-12-23 00:14:12 INFO Epoch 038 | 50% complete (batch 91/181)
2025-12-23 00:14:12 INFO Epoch 038 | 75% complete (batch 136/181)
2025-12-23 00:14:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.624840
2025-12-23 00:14:26 INFO Tuning ranking metrics: regret=0.107950 spearman=0.201893 (groups=39, skipped=329)
2025-12-23 00:14:26 INFO Epoch 038 | train_mse=0.071629 | val_loss=0.071595 | best_val_loss=0.355556
2025-12-23 00:14:34 INFO Epoch 039 | 25% complete (batch 46/181)
2025-12-23 00:14:35 INFO Epoch 039 | 50% complete (batch 91/181)
2025-12-23 00:14:36 INFO Epoch 039 | 75% complete (batch 136/181)
2025-12-23 00:14:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.640353
2025-12-23 00:14:49 INFO Tuning ranking metrics: regret=0.126731 spearman=0.187179 (groups=39, skipped=329)
2025-12-23 00:14:49 INFO Epoch 039 | train_mse=0.096129 | val_loss=0.067249 | best_val_loss=0.355556
2025-12-23 00:14:58 INFO Epoch 040 | 25% complete (batch 46/181)
2025-12-23 00:14:58 INFO Epoch 040 | 50% complete (batch 91/181)
2025-12-23 00:15:00 INFO Epoch 040 | 75% complete (batch 136/181)
2025-12-23 00:15:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.641196
2025-12-23 00:15:13 INFO Tuning ranking metrics: regret=0.129688 spearman=0.188950 (groups=39, skipped=329)
2025-12-23 00:15:13 INFO Epoch 040 | train_mse=0.068658 | val_loss=0.067361 | best_val_loss=0.355556
2025-12-23 00:15:21 INFO Epoch 041 | 25% complete (batch 46/181)
2025-12-23 00:15:22 INFO Epoch 041 | 50% complete (batch 91/181)
2025-12-23 00:15:23 INFO Epoch 041 | 75% complete (batch 136/181)
2025-12-23 00:15:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.646793
2025-12-23 00:15:36 INFO Tuning ranking metrics: regret=0.129688 spearman=0.184188 (groups=39, skipped=329)
2025-12-23 00:15:36 INFO Epoch 041 | train_mse=0.078746 | val_loss=0.067767 | best_val_loss=0.355556
2025-12-23 00:15:45 INFO Epoch 042 | 25% complete (batch 46/181)
2025-12-23 00:15:45 INFO Epoch 042 | 50% complete (batch 91/181)
2025-12-23 00:15:46 INFO Epoch 042 | 75% complete (batch 136/181)
2025-12-23 00:15:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.646170
2025-12-23 00:16:00 INFO Tuning ranking metrics: regret=0.115763 spearman=0.188706 (groups=39, skipped=329)
2025-12-23 00:16:00 INFO Epoch 042 | train_mse=0.075209 | val_loss=0.070369 | best_val_loss=0.355556
2025-12-23 00:16:08 INFO Epoch 043 | 25% complete (batch 46/181)
2025-12-23 00:16:09 INFO Epoch 043 | 50% complete (batch 91/181)
2025-12-23 00:16:10 INFO Epoch 043 | 75% complete (batch 136/181)
2025-12-23 00:16:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.647243
2025-12-23 00:16:23 INFO Tuning ranking metrics: regret=0.126018 spearman=0.214286 (groups=39, skipped=329)
2025-12-23 00:16:23 INFO Epoch 043 | train_mse=0.081109 | val_loss=0.068172 | best_val_loss=0.355556
2025-12-23 00:16:31 INFO Epoch 044 | 25% complete (batch 46/181)
2025-12-23 00:16:32 INFO Epoch 044 | 50% complete (batch 91/181)
2025-12-23 00:16:33 INFO Epoch 044 | 75% complete (batch 136/181)
2025-12-23 00:16:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.650525
2025-12-23 00:16:47 INFO Tuning ranking metrics: regret=0.125243 spearman=0.245849 (groups=39, skipped=329)
2025-12-23 00:16:47 INFO Epoch 044 | train_mse=0.064833 | val_loss=0.071648 | best_val_loss=0.355556
2025-12-23 00:16:55 INFO Epoch 045 | 25% complete (batch 46/181)
2025-12-23 00:16:56 INFO Epoch 045 | 50% complete (batch 91/181)
2025-12-23 00:16:57 INFO Epoch 045 | 75% complete (batch 136/181)
2025-12-23 00:17:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.660515
2025-12-23 00:17:10 INFO Tuning ranking metrics: regret=0.106482 spearman=0.256227 (groups=39, skipped=329)
2025-12-23 00:17:10 INFO Epoch 045 | train_mse=0.108327 | val_loss=0.064055 | best_val_loss=0.355556
2025-12-23 00:17:18 INFO Epoch 046 | 25% complete (batch 46/181)
2025-12-23 00:17:19 INFO Epoch 046 | 50% complete (batch 91/181)
2025-12-23 00:17:20 INFO Epoch 046 | 75% complete (batch 136/181)
2025-12-23 00:17:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.656458
2025-12-23 00:17:34 INFO Tuning ranking metrics: regret=0.126383 spearman=0.179915 (groups=39, skipped=329)
2025-12-23 00:17:34 INFO Epoch 046 | train_mse=0.078962 | val_loss=0.067643 | best_val_loss=0.355556
2025-12-23 00:17:42 INFO Epoch 047 | 25% complete (batch 46/181)
2025-12-23 00:17:42 INFO Epoch 047 | 50% complete (batch 91/181)
2025-12-23 00:17:43 INFO Epoch 047 | 75% complete (batch 136/181)
2025-12-23 00:17:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.665344
2025-12-23 00:17:57 INFO Tuning ranking metrics: regret=0.126383 spearman=0.189744 (groups=39, skipped=329)
2025-12-23 00:17:57 INFO Epoch 047 | train_mse=0.066483 | val_loss=0.065531 | best_val_loss=0.355556
2025-12-23 00:18:05 INFO Epoch 048 | 25% complete (batch 46/181)
2025-12-23 00:18:06 INFO Epoch 048 | 50% complete (batch 91/181)
2025-12-23 00:18:07 INFO Epoch 048 | 75% complete (batch 136/181)
2025-12-23 00:18:15 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.662693
2025-12-23 00:18:20 INFO Tuning ranking metrics: regret=0.125609 spearman=0.204701 (groups=39, skipped=329)
2025-12-23 00:18:20 INFO Epoch 048 | train_mse=0.079319 | val_loss=0.062515 | best_val_loss=0.355556
2025-12-23 00:18:29 INFO Epoch 049 | 25% complete (batch 46/181)
2025-12-23 00:18:29 INFO Epoch 049 | 50% complete (batch 91/181)
2025-12-23 00:18:30 INFO Epoch 049 | 75% complete (batch 136/181)
2025-12-23 00:18:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.609551
2025-12-23 00:18:44 INFO Tuning ranking metrics: regret=0.125609 spearman=0.249084 (groups=39, skipped=329)
2025-12-23 00:18:44 INFO Epoch 049 | train_mse=0.055656 | val_loss=0.104087 | best_val_loss=0.355556
2025-12-23 00:18:52 INFO Epoch 050 | 25% complete (batch 46/181)
2025-12-23 00:18:53 INFO Epoch 050 | 50% complete (batch 91/181)
2025-12-23 00:18:54 INFO Epoch 050 | 75% complete (batch 136/181)
2025-12-23 00:19:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.610230
2025-12-23 00:19:07 INFO Tuning ranking metrics: regret=0.112020 spearman=0.188584 (groups=39, skipped=329)
2025-12-23 00:19:07 INFO Epoch 050 | train_mse=0.084163 | val_loss=0.075238 | best_val_loss=0.355556
2025-12-23 00:19:15 INFO Epoch 051 | 25% complete (batch 46/181)
2025-12-23 00:19:16 INFO Epoch 051 | 50% complete (batch 91/181)
2025-12-23 00:19:17 INFO Epoch 051 | 75% complete (batch 136/181)
2025-12-23 00:19:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.614656
2025-12-23 00:19:31 INFO Tuning ranking metrics: regret=0.107981 spearman=0.186447 (groups=39, skipped=329)
2025-12-23 00:19:31 INFO Epoch 051 | train_mse=0.072360 | val_loss=0.068465 | best_val_loss=0.355556
2025-12-23 00:19:39 INFO Epoch 052 | 25% complete (batch 46/181)
2025-12-23 00:19:40 INFO Epoch 052 | 50% complete (batch 91/181)
2025-12-23 00:19:41 INFO Epoch 052 | 75% complete (batch 136/181)
2025-12-23 00:19:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.586251
2025-12-23 00:19:54 INFO Tuning ranking metrics: regret=0.102842 spearman=0.202320 (groups=39, skipped=329)
2025-12-23 00:19:54 INFO Epoch 052 | train_mse=0.079836 | val_loss=0.109010 | best_val_loss=0.355556
2025-12-23 00:20:02 INFO Epoch 053 | 25% complete (batch 46/181)
2025-12-23 00:20:03 INFO Epoch 053 | 50% complete (batch 91/181)
2025-12-23 00:20:04 INFO Epoch 053 | 75% complete (batch 136/181)
2025-12-23 00:20:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.623459
2025-12-23 00:20:18 INFO Tuning ranking metrics: regret=0.112595 spearman=0.145849 (groups=39, skipped=329)
2025-12-23 00:20:18 INFO Epoch 053 | train_mse=0.088315 | val_loss=0.065732 | best_val_loss=0.355556
2025-12-23 00:20:26 INFO Epoch 054 | 25% complete (batch 46/181)
2025-12-23 00:20:27 INFO Epoch 054 | 50% complete (batch 91/181)
2025-12-23 00:20:28 INFO Epoch 054 | 75% complete (batch 136/181)
2025-12-23 00:20:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.640474
2025-12-23 00:20:41 INFO Tuning ranking metrics: regret=0.093835 spearman=0.186630 (groups=39, skipped=329)
2025-12-23 00:20:41 INFO Epoch 054 | train_mse=0.074086 | val_loss=0.062667 | best_val_loss=0.355556
2025-12-23 00:20:49 INFO Epoch 055 | 25% complete (batch 46/181)
2025-12-23 00:20:50 INFO Epoch 055 | 50% complete (batch 91/181)
2025-12-23 00:20:51 INFO Epoch 055 | 75% complete (batch 136/181)
2025-12-23 00:21:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.661408
2025-12-23 00:21:05 INFO Tuning ranking metrics: regret=0.112629 spearman=0.159402 (groups=39, skipped=329)
2025-12-23 00:21:05 INFO Epoch 055 | train_mse=0.061448 | val_loss=0.065174 | best_val_loss=0.355556
2025-12-23 00:21:13 INFO Epoch 056 | 25% complete (batch 46/181)
2025-12-23 00:21:14 INFO Epoch 056 | 50% complete (batch 91/181)
2025-12-23 00:21:15 INFO Epoch 056 | 75% complete (batch 136/181)
2025-12-23 00:21:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.664171
2025-12-23 00:21:28 INFO Tuning ranking metrics: regret=0.126314 spearman=0.165201 (groups=39, skipped=329)
2025-12-23 00:21:28 INFO Epoch 056 | train_mse=0.066614 | val_loss=0.064005 | best_val_loss=0.355556
2025-12-23 00:21:36 INFO Epoch 057 | 25% complete (batch 46/181)
2025-12-23 00:21:37 INFO Epoch 057 | 50% complete (batch 91/181)
2025-12-23 00:21:38 INFO Epoch 057 | 75% complete (batch 136/181)
2025-12-23 00:21:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.647723
2025-12-23 00:21:52 INFO Tuning ranking metrics: regret=0.112685 spearman=0.157326 (groups=39, skipped=329)
2025-12-23 00:21:52 INFO Epoch 057 | train_mse=0.071151 | val_loss=0.077954 | best_val_loss=0.355556
2025-12-23 00:22:00 INFO Epoch 058 | 25% complete (batch 46/181)
2025-12-23 00:22:00 INFO Epoch 058 | 50% complete (batch 91/181)
2025-12-23 00:22:01 INFO Epoch 058 | 75% complete (batch 136/181)
2025-12-23 00:22:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.653344
2025-12-23 00:22:15 INFO Tuning ranking metrics: regret=0.112685 spearman=0.137118 (groups=39, skipped=329)
2025-12-23 00:22:15 INFO Epoch 058 | train_mse=0.079356 | val_loss=0.065139 | best_val_loss=0.355556
2025-12-23 00:22:23 INFO Epoch 059 | 25% complete (batch 46/181)
2025-12-23 00:22:24 INFO Epoch 059 | 50% complete (batch 91/181)
2025-12-23 00:22:25 INFO Epoch 059 | 75% complete (batch 136/181)
2025-12-23 00:22:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.641202
2025-12-23 00:22:38 INFO Tuning ranking metrics: regret=0.125811 spearman=0.164042 (groups=39, skipped=329)
2025-12-23 00:22:38 INFO Epoch 059 | train_mse=0.069757 | val_loss=0.065628 | best_val_loss=0.355556
Monitored metric tuning_rank_spearman did not improve in the last 40 records. Best score: 0.356. Signaling Trainer to stop.
2025-12-23 00:22:39 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.25623_val-0.06406_epoch045.chkpt, checkpoint.tuning_rank_spearman-0.26520_val-0.09723_epoch018.chkpt, checkpoint.tuning_rank_spearman-0.35556_val-0.11350_epoch019.chkpt
2025-12-23 00:22:39 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed555/model_checkpoints/checkpoint.tuning_rank_spearman-0.35556_val-0.11350_epoch019.chkpt
2025-12-23 00:22:39 INFO Best validation loss: tensor(0.3556)
2025-12-23 00:22:39 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed555/model_checkpoints/checkpoint.tuning_rank_spearman-0.35556_val-0.11350_epoch019.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed555/model_checkpoints/checkpoint.tuning_rank_spearman-0.35556_val-0.11350_epoch019.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-23 00:22:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.113504
2025-12-23 00:22:51 INFO Tuning ranking metrics: regret=0.101943 spearman=0.355556 (groups=39, skipped=329)
2025-12-23 00:22:51 INFO Epoch 060 | val_loss=0.113504 | best_val_loss=0.355556
2025-12-23 00:22:52 INFO Validation metrics: [{'val_loss': 0.11350362002849579, 'tuning_rank_regret': 0.10194284468889236, 'tuning_rank_spearman': 0.35555556416511536, 'val_pearson_corr': 0.5762723684310913, 'val_spearman_corr': 0.6304043531417847, 'val_rank_regret': 0.007533732336014509, 'val_rank_spearman': 0.6666666865348816}]
2025-12-23 00:22:52 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.35556_val-0.11350_epoch019.chkpt
2025-12-23 00:22:52 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.26520_val-0.09723_epoch018.chkpt
2025-12-23 00:22:52 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.25623_val-0.06406_epoch045.chkpt
2025-12-23 00:22:52 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.09183_epoch017.ckpt
2025-12-23 00:22:52 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.10194284468889236
  tuning_rank_spearman      0.35555556416511536
        val_loss            0.11350362002849579
    val_pearson_corr        0.5762723684310913
     val_rank_regret       0.007533732336014509
    val_rank_spearman       0.6666666865348816
    val_spearman_corr       0.6304043531417847
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run polish_seed101_2025-12-22_18-34-49_phase2_seed555 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed555
[run_full_pipeline] Phase 2 (seed 555) best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed555/model_checkpoints/checkpoint.tuning_rank_spearman-0.35556_val-0.11350_epoch019.chkpt (tuning_rank_spearman=0.35555556416511536)
[run_full_pipeline] Phase 2 fine-tuning (seed 888) -> polish_seed101_2025-12-22_18-34-49_phase2_seed888
[train_cli] run_id=polish_seed101_2025-12-22_18-34-49_phase2_seed888 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed888/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed888 --git-commit 150d1dcbd1 --git-dirty --resume-from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.08056_val-0.13668_epoch013.chkpt
2025-12-23 00:22:57 INFO git_commit = 150d1dcbd1 (dirty)
2025-12-23 00:22:57 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-23 00:22:57 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed888/config/config.yaml
2025-12-23 00:22:57 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data
2025-12-23 00:22:57 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-23 00:22:57 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-23 00:22:57 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed888
2025-12-23 00:22:57 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-23 00:22:57 INFO   metadata_path = None
2025-12-23 00:22:57 INFO   summary_path = None
2025-12-23 00:22:57 INFO   accelerator = cpu
2025-12-23 00:22:57 INFO   devices = 1
2025-12-23 00:22:57 INFO   attention_head = 8
2025-12-23 00:22:57 INFO   pooling_type = mean
2025-12-23 00:22:57 INFO   model_self_loops = False
2025-12-23 00:22:57 INFO   model_self_loop_fill = mean
2025-12-23 00:22:57 INFO   model_residual = False
2025-12-23 00:22:57 INFO   batch_size = 48
2025-12-23 00:22:57 INFO   learning_rate = 0.001
2025-12-23 00:22:57 INFO   num_epochs = 320
2025-12-23 00:22:57 INFO   accumulate_grad_batches = 8
2025-12-23 00:22:57 INFO   seed = 888
2025-12-23 00:22:57 INFO   num_workers = 2
2025-12-23 00:22:57 INFO   precision = 32
2025-12-23 00:22:57 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-23 00:22:57 INFO   early_stopping_patience = 20
2025-12-23 00:22:57 INFO   lr_scheduler_patience = 4
2025-12-23 00:22:57 INFO   lr_scheduler_factor = 0.2
2025-12-23 00:22:57 INFO   fast_dev_run = False
2025-12-23 00:22:57 INFO   limit_train_batches = None
2025-12-23 00:22:57 INFO   limit_val_batches = None
2025-12-23 00:22:57 INFO   log_lr = False
2025-12-23 00:22:57 INFO   progress_bar_refresh_rate = 0
2025-12-23 00:22:57 INFO   log_every_n_steps = 100
2025-12-23 00:22:57 INFO   use_val_spearman_as_secondary = True
2025-12-23 00:22:57 INFO   spearman_secondary_min_delta = 0.0
2025-12-23 00:22:57 INFO   spearman_secondary_weight = 1.0
2025-12-23 00:22:57 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-23 00:22:57 INFO   tuning_max_samples = 500
2025-12-23 00:22:57 INFO   tuning_fraction = None
2025-12-23 00:22:57 INFO   tuning_eval_every = 1
2025-12-23 00:22:57 INFO   rank_loss_weight = 0.0
2025-12-23 00:22:57 INFO   rank_loss_margin = 0.0
2025-12-23 00:22:57 INFO   rank_loss_mode = hinge
2025-12-23 00:22:57 INFO   rank_loss_grouped = True
2025-12-23 00:22:57 INFO   variance_reduction_enabled = False
2025-12-23 00:22:57 INFO   variance_reduction_method = topk_avg
2025-12-23 00:22:57 INFO   variance_reduction_top_k = 3
2025-12-23 00:22:57 INFO   coverage_minimum = 0.0
2025-12-23 00:22:57 INFO   coverage_fail_on_missing = False
2025-12-23 00:22:57 INFO   graph_load_profiling = False
2025-12-23 00:22:57 INFO   graph_load_top_k = 5
2025-12-23 00:22:57 INFO   enable_graph_cache = True
2025-12-23 00:22:57 INFO   graph_cache_size = 256
2025-12-23 00:22:57 INFO   canonicalize_on_load = False
2025-12-23 00:22:57 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-23 00:22:57 INFO   edge_schema = {}
2025-12-23 00:22:57 INFO   topology_schema = {}
Seed set to 888
2025-12-23 00:22:58 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-23 00:22:58 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-23 00:22:58 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-23 00:22:58 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-23 00:22:58 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-23 00:22:58 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-23 00:22:59 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-23 00:22:59 INFO Tuning group stats: groups=351 groups>=2=40 singletons=311 max_group=10
2025-12-23 00:22:59 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed888/dataset_coverage.json
2025-12-23 00:22:59 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed888/dataset_coverage.json for details.
2025-12-23 00:22:59 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed888/dataset_coverage.json for details.
2025-12-23 00:22:59 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed888/dataset_coverage.json for details.
2025-12-23 00:22:59 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed888/schema_summary.json
2025-12-23 00:22:59 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed888/feature_metadata.json
2025-12-23 00:22:59 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-23 00:22:59 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/feature-config.yaml.topoqa.10A.2, sha256=5c62898155179232a565e24d9fbd7b208f9ce480d1a19d6139de19454e173ff0
2025-12-23 00:22:59 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/work/edge_features)
2025-12-23 00:22:59 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json
2025-12-23 00:22:59 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed888/schema_summary.json
2025-12-23 00:22:59 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-23 00:22:59 INFO Topology: topology/persistence_basic/v1 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 172-dimensional node features.
2025-12-23 00:22:59 INFO Node: node/dssp_topo_merge/v1; metadata lists 172 feature columns matching the .pt tensor.
2025-12-23 00:22:59 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-23 00:22:59 INFO → Total feature dimensionality observed and confirmed: node_dim = 172, edge_dim = 11.
2025-12-23 00:22:59 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-23 00:22:59 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 172,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 172,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed888/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge/v1",
      "alias": "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA",
      "jobs": 16,
      "summary": "DSSP-derived node features merged with topology statistics."
    },
    "topology": {
      "id": "topology/persistence_basic/v1",
      "alias": "Betti 0 and Betti 1 topology summaries on interface coords = 140D PH | TopoQA",
      "jobs": 16,
      "summary": "Persistent homology features with configurable distance thresholds."
    }
  },
  "notes": []
}
2025-12-23 00:22:59 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-23 00:22:59 INFO Resuming from checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.08056_val-0.13668_epoch013.chkpt (epoch=13)
2025-12-23 00:22:59 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=ca97bcee6bd94e7bb8e8d3c816c8048f)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-23 00:22:59 INFO Starting training (fast_dev_run=False)
2025-12-23 00:22:59 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed888/model_checkpoints exists and is not empty.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.08056_val-0.13668_epoch013.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase1/model_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed888/model_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase1/model_checkpoints/val_loss_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed888/model_checkpoints/val_loss_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 5.5 K  | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
165 K     Trainable params
0         Non-trainable params
165 K     Total params
0.662     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
Restored all states from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.08056_val-0.13668_epoch013.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-23 00:23:13 INFO Epoch 014 | 25% complete (batch 46/181)
2025-12-23 00:23:14 INFO Epoch 014 | 50% complete (batch 91/181)
2025-12-23 00:23:15 INFO Epoch 014 | 75% complete (batch 136/181)
2025-12-23 00:23:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.122594
2025-12-23 00:23:28 INFO Tuning ranking metrics: regret=0.185423 spearman=0.163366 (groups=40, skipped=311)
2025-12-23 00:23:28 INFO Epoch 014 | val_loss=0.122594
Metric tuning_rank_spearman improved by 0.016 >= min_delta = 0.0. New best score: 0.163
2025-12-23 00:23:36 INFO Epoch 015 | 25% complete (batch 46/181)
2025-12-23 00:23:37 INFO Epoch 015 | 50% complete (batch 91/181)
2025-12-23 00:23:38 INFO Epoch 015 | 75% complete (batch 136/181)
2025-12-23 00:23:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.468548
2025-12-23 00:23:51 INFO Tuning ranking metrics: regret=0.163943 spearman=0.064302 (groups=40, skipped=311)
2025-12-23 00:23:51 INFO Epoch 015 | train_mse=0.139945 | val_loss=0.112728 | best_val_loss=0.163366
2025-12-23 00:23:59 INFO Epoch 016 | 25% complete (batch 46/181)
2025-12-23 00:24:00 INFO Epoch 016 | 50% complete (batch 91/181)
2025-12-23 00:24:01 INFO Epoch 016 | 75% complete (batch 136/181)
2025-12-23 00:24:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.557751
2025-12-23 00:24:14 INFO Tuning ranking metrics: regret=0.159508 spearman=0.107240 (groups=40, skipped=311)
2025-12-23 00:24:14 INFO Epoch 016 | train_mse=0.119116 | val_loss=0.100537 | best_val_loss=0.163366
2025-12-23 00:24:23 INFO Epoch 017 | 25% complete (batch 46/181)
2025-12-23 00:24:23 INFO Epoch 017 | 50% complete (batch 91/181)
2025-12-23 00:24:24 INFO Epoch 017 | 75% complete (batch 136/181)
2025-12-23 00:24:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.563448
2025-12-23 00:24:38 INFO Tuning ranking metrics: regret=0.175695 spearman=0.127733 (groups=40, skipped=311)
2025-12-23 00:24:38 INFO Epoch 017 | train_mse=0.121470 | val_loss=0.107114 | best_val_loss=0.163366
2025-12-23 00:24:46 INFO Epoch 018 | 25% complete (batch 46/181)
2025-12-23 00:24:47 INFO Epoch 018 | 50% complete (batch 91/181)
2025-12-23 00:24:48 INFO Epoch 018 | 75% complete (batch 136/181)
2025-12-23 00:24:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.551831
2025-12-23 00:25:01 INFO Tuning ranking metrics: regret=0.144407 spearman=0.119762 (groups=40, skipped=311)
2025-12-23 00:25:01 INFO Epoch 018 | train_mse=0.098683 | val_loss=0.110364 | best_val_loss=0.163366
2025-12-23 00:25:09 INFO Epoch 019 | 25% complete (batch 46/181)
2025-12-23 00:25:10 INFO Epoch 019 | 50% complete (batch 91/181)
2025-12-23 00:25:11 INFO Epoch 019 | 75% complete (batch 136/181)
2025-12-23 00:25:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.584655
2025-12-23 00:25:24 INFO Tuning ranking metrics: regret=0.141835 spearman=0.133236 (groups=40, skipped=311)
2025-12-23 00:25:24 INFO Epoch 019 | train_mse=0.149618 | val_loss=0.078379 | best_val_loss=0.163366
2025-12-23 00:25:32 INFO Epoch 020 | 25% complete (batch 46/181)
2025-12-23 00:25:33 INFO Epoch 020 | 50% complete (batch 91/181)
2025-12-23 00:25:34 INFO Epoch 020 | 75% complete (batch 136/181)
2025-12-23 00:25:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.586254
2025-12-23 00:25:48 INFO Tuning ranking metrics: regret=0.142705 spearman=0.131331 (groups=40, skipped=311)
2025-12-23 00:25:48 INFO Epoch 020 | train_mse=0.096707 | val_loss=0.086421 | best_val_loss=0.163366
2025-12-23 00:25:56 INFO Epoch 021 | 25% complete (batch 46/181)
2025-12-23 00:25:57 INFO Epoch 021 | 50% complete (batch 91/181)
2025-12-23 00:25:57 INFO Epoch 021 | 75% complete (batch 136/181)
2025-12-23 00:26:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.561999
2025-12-23 00:26:11 INFO Tuning ranking metrics: regret=0.135487 spearman=0.193393 (groups=40, skipped=311)
2025-12-23 00:26:11 INFO Epoch 021 | train_mse=0.099903 | val_loss=0.120921 | best_val_loss=0.163366
Metric tuning_rank_spearman improved by 0.030 >= min_delta = 0.0. New best score: 0.193
2025-12-23 00:26:19 INFO Epoch 022 | 25% complete (batch 46/181)
2025-12-23 00:26:20 INFO Epoch 022 | 50% complete (batch 91/181)
2025-12-23 00:26:21 INFO Epoch 022 | 75% complete (batch 136/181)
2025-12-23 00:26:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.565901
2025-12-23 00:26:34 INFO Tuning ranking metrics: regret=0.126908 spearman=0.083929 (groups=40, skipped=311)
2025-12-23 00:26:34 INFO Epoch 022 | train_mse=0.101471 | val_loss=0.098122 | best_val_loss=0.193393
2025-12-23 00:26:42 INFO Epoch 023 | 25% complete (batch 46/181)
2025-12-23 00:26:43 INFO Epoch 023 | 50% complete (batch 91/181)
2025-12-23 00:26:44 INFO Epoch 023 | 75% complete (batch 136/181)
2025-12-23 00:26:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.596062
2025-12-23 00:26:57 INFO Tuning ranking metrics: regret=0.144110 spearman=0.085736 (groups=40, skipped=311)
2025-12-23 00:26:57 INFO Epoch 023 | train_mse=0.109157 | val_loss=0.072354 | best_val_loss=0.193393
2025-12-23 00:27:06 INFO Epoch 024 | 25% complete (batch 46/181)
2025-12-23 00:27:06 INFO Epoch 024 | 50% complete (batch 91/181)
2025-12-23 00:27:07 INFO Epoch 024 | 75% complete (batch 136/181)
2025-12-23 00:27:15 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.600438
2025-12-23 00:27:21 INFO Tuning ranking metrics: regret=0.158851 spearman=0.102224 (groups=40, skipped=311)
2025-12-23 00:27:21 INFO Epoch 024 | train_mse=0.092982 | val_loss=0.087965 | best_val_loss=0.193393
2025-12-23 00:27:29 INFO Epoch 025 | 25% complete (batch 46/181)
2025-12-23 00:27:30 INFO Epoch 025 | 50% complete (batch 91/181)
2025-12-23 00:27:31 INFO Epoch 025 | 75% complete (batch 136/181)
2025-12-23 00:27:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.598594
2025-12-23 00:27:44 INFO Tuning ranking metrics: regret=0.147234 spearman=0.042830 (groups=40, skipped=311)
2025-12-23 00:27:44 INFO Epoch 025 | train_mse=0.091891 | val_loss=0.087444 | best_val_loss=0.193393
2025-12-23 00:27:52 INFO Epoch 026 | 25% complete (batch 46/181)
2025-12-23 00:27:53 INFO Epoch 026 | 50% complete (batch 91/181)
2025-12-23 00:27:54 INFO Epoch 026 | 75% complete (batch 136/181)
2025-12-23 00:28:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.596749
2025-12-23 00:28:07 INFO Tuning ranking metrics: regret=0.132891 spearman=0.025741 (groups=40, skipped=311)
2025-12-23 00:28:07 INFO Epoch 026 | train_mse=0.093324 | val_loss=0.084461 | best_val_loss=0.193393
2025-12-23 00:28:15 INFO Epoch 027 | 25% complete (batch 46/181)
2025-12-23 00:28:16 INFO Epoch 027 | 50% complete (batch 91/181)
2025-12-23 00:28:17 INFO Epoch 027 | 75% complete (batch 136/181)
2025-12-23 00:28:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.622922
2025-12-23 00:28:31 INFO Tuning ranking metrics: regret=0.143873 spearman=0.080249 (groups=40, skipped=311)
2025-12-23 00:28:31 INFO Epoch 027 | train_mse=0.080680 | val_loss=0.078945 | best_val_loss=0.193393
2025-12-23 00:28:39 INFO Epoch 028 | 25% complete (batch 46/181)
2025-12-23 00:28:40 INFO Epoch 028 | 50% complete (batch 91/181)
2025-12-23 00:28:41 INFO Epoch 028 | 75% complete (batch 136/181)
2025-12-23 00:28:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.617375
2025-12-23 00:28:54 INFO Tuning ranking metrics: regret=0.158875 spearman=0.053523 (groups=40, skipped=311)
2025-12-23 00:28:54 INFO Epoch 028 | train_mse=0.095874 | val_loss=0.070760 | best_val_loss=0.193393
2025-12-23 00:29:03 INFO Epoch 029 | 25% complete (batch 46/181)
2025-12-23 00:29:03 INFO Epoch 029 | 50% complete (batch 91/181)
2025-12-23 00:29:05 INFO Epoch 029 | 75% complete (batch 136/181)
2025-12-23 00:29:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.641657
2025-12-23 00:29:18 INFO Tuning ranking metrics: regret=0.158875 spearman=0.055660 (groups=40, skipped=311)
2025-12-23 00:29:18 INFO Epoch 029 | train_mse=0.086222 | val_loss=0.068443 | best_val_loss=0.193393
2025-12-23 00:29:26 INFO Epoch 030 | 25% complete (batch 46/181)
2025-12-23 00:29:27 INFO Epoch 030 | 50% complete (batch 91/181)
2025-12-23 00:29:28 INFO Epoch 030 | 75% complete (batch 136/181)
2025-12-23 00:29:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.650708
2025-12-23 00:29:41 INFO Tuning ranking metrics: regret=0.156210 spearman=0.065011 (groups=40, skipped=311)
2025-12-23 00:29:41 INFO Epoch 030 | train_mse=0.079202 | val_loss=0.070576 | best_val_loss=0.193393
2025-12-23 00:29:49 INFO Epoch 031 | 25% complete (batch 46/181)
2025-12-23 00:29:50 INFO Epoch 031 | 50% complete (batch 91/181)
2025-12-23 00:29:51 INFO Epoch 031 | 75% complete (batch 136/181)
2025-12-23 00:30:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.615290
2025-12-23 00:30:05 INFO Tuning ranking metrics: regret=0.113273 spearman=0.051196 (groups=40, skipped=311)
2025-12-23 00:30:05 INFO Epoch 031 | train_mse=0.091916 | val_loss=0.113774 | best_val_loss=0.193393
2025-12-23 00:30:13 INFO Epoch 032 | 25% complete (batch 46/181)
2025-12-23 00:30:14 INFO Epoch 032 | 50% complete (batch 91/181)
2025-12-23 00:30:15 INFO Epoch 032 | 75% complete (batch 136/181)
2025-12-23 00:30:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.633086
2025-12-23 00:30:28 INFO Tuning ranking metrics: regret=0.112963 spearman=0.041748 (groups=40, skipped=311)
2025-12-23 00:30:28 INFO Epoch 032 | train_mse=0.084479 | val_loss=0.074515 | best_val_loss=0.193393
2025-12-23 00:30:36 INFO Epoch 033 | 25% complete (batch 46/181)
2025-12-23 00:30:37 INFO Epoch 033 | 50% complete (batch 91/181)
2025-12-23 00:30:38 INFO Epoch 033 | 75% complete (batch 136/181)
2025-12-23 00:30:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.628091
2025-12-23 00:30:51 INFO Tuning ranking metrics: regret=0.165577 spearman=0.027208 (groups=40, skipped=311)
2025-12-23 00:30:51 INFO Epoch 033 | train_mse=0.080545 | val_loss=0.073206 | best_val_loss=0.193393
2025-12-23 00:31:00 INFO Epoch 034 | 25% complete (batch 46/181)
2025-12-23 00:31:00 INFO Epoch 034 | 50% complete (batch 91/181)
2025-12-23 00:31:01 INFO Epoch 034 | 75% complete (batch 136/181)
2025-12-23 00:31:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.671368
2025-12-23 00:31:15 INFO Tuning ranking metrics: regret=0.144122 spearman=0.056932 (groups=40, skipped=311)
2025-12-23 00:31:15 INFO Epoch 034 | train_mse=0.082347 | val_loss=0.068913 | best_val_loss=0.193393
2025-12-23 00:31:23 INFO Epoch 035 | 25% complete (batch 46/181)
2025-12-23 00:31:24 INFO Epoch 035 | 50% complete (batch 91/181)
2025-12-23 00:31:25 INFO Epoch 035 | 75% complete (batch 136/181)
2025-12-23 00:31:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.671737
2025-12-23 00:31:39 INFO Tuning ranking metrics: regret=0.159360 spearman=0.075027 (groups=40, skipped=311)
2025-12-23 00:31:39 INFO Epoch 035 | train_mse=0.059372 | val_loss=0.064755 | best_val_loss=0.193393
2025-12-23 00:31:47 INFO Epoch 036 | 25% complete (batch 46/181)
2025-12-23 00:31:48 INFO Epoch 036 | 50% complete (batch 91/181)
2025-12-23 00:31:49 INFO Epoch 036 | 75% complete (batch 136/181)
2025-12-23 00:31:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.678745
2025-12-23 00:32:02 INFO Tuning ranking metrics: regret=0.144154 spearman=0.060330 (groups=40, skipped=311)
2025-12-23 00:32:02 INFO Epoch 036 | train_mse=0.086203 | val_loss=0.064420 | best_val_loss=0.193393
2025-12-23 00:32:10 INFO Epoch 037 | 25% complete (batch 46/181)
2025-12-23 00:32:11 INFO Epoch 037 | 50% complete (batch 91/181)
2025-12-23 00:32:12 INFO Epoch 037 | 75% complete (batch 136/181)
2025-12-23 00:32:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.657885
2025-12-23 00:32:26 INFO Tuning ranking metrics: regret=0.157249 spearman=0.074670 (groups=40, skipped=311)
2025-12-23 00:32:26 INFO Epoch 037 | train_mse=0.088424 | val_loss=0.080937 | best_val_loss=0.193393
2025-12-23 00:32:34 INFO Epoch 038 | 25% complete (batch 46/181)
2025-12-23 00:32:35 INFO Epoch 038 | 50% complete (batch 91/181)
2025-12-23 00:32:35 INFO Epoch 038 | 75% complete (batch 136/181)
2025-12-23 00:32:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.662955
2025-12-23 00:32:49 INFO Tuning ranking metrics: regret=0.107416 spearman=0.102181 (groups=40, skipped=311)
2025-12-23 00:32:49 INFO Epoch 038 | train_mse=0.080612 | val_loss=0.071021 | best_val_loss=0.193393
2025-12-23 00:32:57 INFO Epoch 039 | 25% complete (batch 46/181)
2025-12-23 00:32:58 INFO Epoch 039 | 50% complete (batch 91/181)
2025-12-23 00:32:59 INFO Epoch 039 | 75% complete (batch 136/181)
2025-12-23 00:33:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.621105
2025-12-23 00:33:13 INFO Tuning ranking metrics: regret=0.144371 spearman=0.074513 (groups=40, skipped=311)
2025-12-23 00:33:13 INFO Epoch 039 | train_mse=0.082515 | val_loss=0.086513 | best_val_loss=0.193393
2025-12-23 00:33:21 INFO Epoch 040 | 25% complete (batch 46/181)
2025-12-23 00:33:22 INFO Epoch 040 | 50% complete (batch 91/181)
2025-12-23 00:33:23 INFO Epoch 040 | 75% complete (batch 136/181)
2025-12-23 00:33:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.637844
2025-12-23 00:33:36 INFO Tuning ranking metrics: regret=0.157398 spearman=0.070427 (groups=40, skipped=311)
2025-12-23 00:33:36 INFO Epoch 040 | train_mse=0.075878 | val_loss=0.070143 | best_val_loss=0.193393
2025-12-23 00:33:44 INFO Epoch 041 | 25% complete (batch 46/181)
2025-12-23 00:33:45 INFO Epoch 041 | 50% complete (batch 91/181)
2025-12-23 00:33:46 INFO Epoch 041 | 75% complete (batch 136/181)
2025-12-23 00:33:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.655383
2025-12-23 00:34:00 INFO Tuning ranking metrics: regret=0.153481 spearman=0.107906 (groups=40, skipped=311)
2025-12-23 00:34:00 INFO Epoch 041 | train_mse=0.079380 | val_loss=0.067326 | best_val_loss=0.193393
2025-12-23 00:34:08 INFO Epoch 042 | 25% complete (batch 46/181)
2025-12-23 00:34:09 INFO Epoch 042 | 50% complete (batch 91/181)
2025-12-23 00:34:10 INFO Epoch 042 | 75% complete (batch 136/181)
2025-12-23 00:34:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.658411
2025-12-23 00:34:24 INFO Tuning ranking metrics: regret=0.154440 spearman=0.080352 (groups=40, skipped=311)
2025-12-23 00:34:24 INFO Epoch 042 | train_mse=0.083982 | val_loss=0.065556 | best_val_loss=0.193393
2025-12-23 00:34:32 INFO Epoch 043 | 25% complete (batch 46/181)
2025-12-23 00:34:33 INFO Epoch 043 | 50% complete (batch 91/181)
2025-12-23 00:34:34 INFO Epoch 043 | 75% complete (batch 136/181)
2025-12-23 00:34:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.611431
2025-12-23 00:34:47 INFO Tuning ranking metrics: regret=0.144729 spearman=0.054578 (groups=40, skipped=311)
2025-12-23 00:34:47 INFO Epoch 043 | train_mse=0.093125 | val_loss=0.104403 | best_val_loss=0.193393
2025-12-23 00:34:55 INFO Epoch 044 | 25% complete (batch 46/181)
2025-12-23 00:34:56 INFO Epoch 044 | 50% complete (batch 91/181)
2025-12-23 00:34:57 INFO Epoch 044 | 75% complete (batch 136/181)
2025-12-23 00:35:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.613705
2025-12-23 00:35:10 INFO Tuning ranking metrics: regret=0.160113 spearman=0.033669 (groups=40, skipped=311)
2025-12-23 00:35:10 INFO Epoch 044 | train_mse=0.065466 | val_loss=0.075402 | best_val_loss=0.193393
2025-12-23 00:35:19 INFO Epoch 045 | 25% complete (batch 46/181)
2025-12-23 00:35:20 INFO Epoch 045 | 50% complete (batch 91/181)
2025-12-23 00:35:21 INFO Epoch 045 | 75% complete (batch 136/181)
2025-12-23 00:35:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.658534
2025-12-23 00:35:34 INFO Tuning ranking metrics: regret=0.153375 spearman=0.075509 (groups=40, skipped=311)
2025-12-23 00:35:34 INFO Epoch 045 | train_mse=0.088096 | val_loss=0.063270 | best_val_loss=0.193393
2025-12-23 00:35:42 INFO Epoch 046 | 25% complete (batch 46/181)
2025-12-23 00:35:43 INFO Epoch 046 | 50% complete (batch 91/181)
2025-12-23 00:35:44 INFO Epoch 046 | 75% complete (batch 136/181)
2025-12-23 00:35:53 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.658816
2025-12-23 00:35:58 INFO Tuning ranking metrics: regret=0.156169 spearman=0.078333 (groups=40, skipped=311)
2025-12-23 00:35:58 INFO Epoch 046 | train_mse=0.078223 | val_loss=0.066023 | best_val_loss=0.193393
2025-12-23 00:36:06 INFO Epoch 047 | 25% complete (batch 46/181)
2025-12-23 00:36:07 INFO Epoch 047 | 50% complete (batch 91/181)
2025-12-23 00:36:08 INFO Epoch 047 | 75% complete (batch 136/181)
2025-12-23 00:36:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.639008
2025-12-23 00:36:21 INFO Tuning ranking metrics: regret=0.121730 spearman=0.110465 (groups=40, skipped=311)
2025-12-23 00:36:21 INFO Epoch 047 | train_mse=0.081904 | val_loss=0.068829 | best_val_loss=0.193393
2025-12-23 00:36:29 INFO Epoch 048 | 25% complete (batch 46/181)
2025-12-23 00:36:30 INFO Epoch 048 | 50% complete (batch 91/181)
2025-12-23 00:36:31 INFO Epoch 048 | 75% complete (batch 136/181)
2025-12-23 00:36:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.634201
2025-12-23 00:36:44 INFO Tuning ranking metrics: regret=0.156169 spearman=0.099789 (groups=40, skipped=311)
2025-12-23 00:36:44 INFO Epoch 048 | train_mse=0.072173 | val_loss=0.077609 | best_val_loss=0.193393
2025-12-23 00:36:53 INFO Epoch 049 | 25% complete (batch 46/181)
2025-12-23 00:36:54 INFO Epoch 049 | 50% complete (batch 91/181)
2025-12-23 00:36:54 INFO Epoch 049 | 75% complete (batch 136/181)
2025-12-23 00:37:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.666617
2025-12-23 00:37:08 INFO Tuning ranking metrics: regret=0.156043 spearman=0.193052 (groups=40, skipped=311)
2025-12-23 00:37:08 INFO Epoch 049 | train_mse=0.076864 | val_loss=0.065280 | best_val_loss=0.193393
2025-12-23 00:37:16 INFO Epoch 050 | 25% complete (batch 46/181)
2025-12-23 00:37:17 INFO Epoch 050 | 50% complete (batch 91/181)
2025-12-23 00:37:18 INFO Epoch 050 | 75% complete (batch 136/181)
2025-12-23 00:37:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.624562
2025-12-23 00:37:31 INFO Tuning ranking metrics: regret=0.156974 spearman=0.096640 (groups=40, skipped=311)
2025-12-23 00:37:31 INFO Epoch 050 | train_mse=0.066935 | val_loss=0.108023 | best_val_loss=0.193393
2025-12-23 00:37:39 INFO Epoch 051 | 25% complete (batch 46/181)
2025-12-23 00:37:40 INFO Epoch 051 | 50% complete (batch 91/181)
2025-12-23 00:37:41 INFO Epoch 051 | 75% complete (batch 136/181)
2025-12-23 00:37:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.639044
2025-12-23 00:37:54 INFO Tuning ranking metrics: regret=0.141335 spearman=0.116997 (groups=40, skipped=311)
2025-12-23 00:37:54 INFO Epoch 051 | train_mse=0.075678 | val_loss=0.069413 | best_val_loss=0.193393
2025-12-23 00:38:03 INFO Epoch 052 | 25% complete (batch 46/181)
2025-12-23 00:38:04 INFO Epoch 052 | 50% complete (batch 91/181)
2025-12-23 00:38:05 INFO Epoch 052 | 75% complete (batch 136/181)
2025-12-23 00:38:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.644928
2025-12-23 00:38:18 INFO Tuning ranking metrics: regret=0.150926 spearman=0.154026 (groups=40, skipped=311)
2025-12-23 00:38:18 INFO Epoch 052 | train_mse=0.086186 | val_loss=0.064551 | best_val_loss=0.193393
2025-12-23 00:38:26 INFO Epoch 053 | 25% complete (batch 46/181)
2025-12-23 00:38:27 INFO Epoch 053 | 50% complete (batch 91/181)
2025-12-23 00:38:28 INFO Epoch 053 | 75% complete (batch 136/181)
2025-12-23 00:38:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.652312
2025-12-23 00:38:41 INFO Tuning ranking metrics: regret=0.121347 spearman=0.111797 (groups=40, skipped=311)
2025-12-23 00:38:41 INFO Epoch 053 | train_mse=0.067174 | val_loss=0.076132 | best_val_loss=0.193393
2025-12-23 00:38:50 INFO Epoch 054 | 25% complete (batch 46/181)
2025-12-23 00:38:51 INFO Epoch 054 | 50% complete (batch 91/181)
2025-12-23 00:38:51 INFO Epoch 054 | 75% complete (batch 136/181)
2025-12-23 00:39:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.650344
2025-12-23 00:39:05 INFO Tuning ranking metrics: regret=0.142857 spearman=0.146153 (groups=40, skipped=311)
2025-12-23 00:39:05 INFO Epoch 054 | train_mse=0.053717 | val_loss=0.077697 | best_val_loss=0.193393
2025-12-23 00:39:13 INFO Epoch 055 | 25% complete (batch 46/181)
2025-12-23 00:39:14 INFO Epoch 055 | 50% complete (batch 91/181)
2025-12-23 00:39:15 INFO Epoch 055 | 75% complete (batch 136/181)
2025-12-23 00:39:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.611783
2025-12-23 00:39:28 INFO Tuning ranking metrics: regret=0.129470 spearman=0.122175 (groups=40, skipped=311)
2025-12-23 00:39:28 INFO Epoch 055 | train_mse=0.063125 | val_loss=0.070752 | best_val_loss=0.193393
2025-12-23 00:39:37 INFO Epoch 056 | 25% complete (batch 46/181)
2025-12-23 00:39:38 INFO Epoch 056 | 50% complete (batch 91/181)
2025-12-23 00:39:39 INFO Epoch 056 | 75% complete (batch 136/181)
2025-12-23 00:39:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.648539
2025-12-23 00:39:52 INFO Tuning ranking metrics: regret=0.132680 spearman=0.104946 (groups=40, skipped=311)
2025-12-23 00:39:52 INFO Epoch 056 | train_mse=0.065497 | val_loss=0.056229 | best_val_loss=0.193393
2025-12-23 00:40:00 INFO Epoch 057 | 25% complete (batch 46/181)
2025-12-23 00:40:01 INFO Epoch 057 | 50% complete (batch 91/181)
2025-12-23 00:40:02 INFO Epoch 057 | 75% complete (batch 136/181)
2025-12-23 00:40:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.690636
2025-12-23 00:40:15 INFO Tuning ranking metrics: regret=0.133426 spearman=0.108420 (groups=40, skipped=311)
2025-12-23 00:40:15 INFO Epoch 057 | train_mse=0.069315 | val_loss=0.069314 | best_val_loss=0.193393
2025-12-23 00:40:24 INFO Epoch 058 | 25% complete (batch 46/181)
2025-12-23 00:40:25 INFO Epoch 058 | 50% complete (batch 91/181)
2025-12-23 00:40:26 INFO Epoch 058 | 75% complete (batch 136/181)
2025-12-23 00:40:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.711087
2025-12-23 00:40:39 INFO Tuning ranking metrics: regret=0.117922 spearman=0.191342 (groups=40, skipped=311)
2025-12-23 00:40:39 INFO Epoch 058 | train_mse=0.065309 | val_loss=0.059259 | best_val_loss=0.193393
2025-12-23 00:40:47 INFO Epoch 059 | 25% complete (batch 46/181)
2025-12-23 00:40:48 INFO Epoch 059 | 50% complete (batch 91/181)
2025-12-23 00:40:49 INFO Epoch 059 | 75% complete (batch 136/181)
2025-12-23 00:40:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.706581
2025-12-23 00:41:03 INFO Tuning ranking metrics: regret=0.133413 spearman=0.176461 (groups=40, skipped=311)
2025-12-23 00:41:03 INFO Epoch 059 | train_mse=0.067454 | val_loss=0.060545 | best_val_loss=0.193393
2025-12-23 00:41:11 INFO Epoch 060 | 25% complete (batch 46/181)
2025-12-23 00:41:12 INFO Epoch 060 | 50% complete (batch 91/181)
2025-12-23 00:41:13 INFO Epoch 060 | 75% complete (batch 136/181)
2025-12-23 00:41:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.692328
2025-12-23 00:41:26 INFO Tuning ranking metrics: regret=0.135165 spearman=0.123896 (groups=40, skipped=311)
2025-12-23 00:41:26 INFO Epoch 060 | train_mse=0.064000 | val_loss=0.063782 | best_val_loss=0.193393
2025-12-23 00:41:34 INFO Epoch 061 | 25% complete (batch 46/181)
2025-12-23 00:41:35 INFO Epoch 061 | 50% complete (batch 91/181)
2025-12-23 00:41:36 INFO Epoch 061 | 75% complete (batch 136/181)
2025-12-23 00:41:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.680077
2025-12-23 00:41:50 INFO Tuning ranking metrics: regret=0.134030 spearman=0.131472 (groups=40, skipped=311)
2025-12-23 00:41:50 INFO Epoch 061 | train_mse=0.080680 | val_loss=0.064178 | best_val_loss=0.193393
Monitored metric tuning_rank_spearman did not improve in the last 40 records. Best score: 0.193. Signaling Trainer to stop.
2025-12-23 00:41:51 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.19134_val-0.05926_epoch058.chkpt, checkpoint.tuning_rank_spearman-0.19305_val-0.06528_epoch049.chkpt, checkpoint.tuning_rank_spearman-0.19339_val-0.12092_epoch021.chkpt
2025-12-23 00:41:51 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed888/model_checkpoints/checkpoint.tuning_rank_spearman-0.19339_val-0.12092_epoch021.chkpt
2025-12-23 00:41:51 INFO Best validation loss: tensor(0.1934)
2025-12-23 00:41:51 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed888/model_checkpoints/checkpoint.tuning_rank_spearman-0.19339_val-0.12092_epoch021.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed888/model_checkpoints/checkpoint.tuning_rank_spearman-0.19339_val-0.12092_epoch021.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-23 00:41:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.120921
2025-12-23 00:42:02 INFO Tuning ranking metrics: regret=0.135487 spearman=0.193393 (groups=40, skipped=311)
2025-12-23 00:42:02 INFO Epoch 062 | val_loss=0.120921 | best_val_loss=0.193393
2025-12-23 00:42:03 INFO Validation metrics: [{'val_loss': 0.12092096358537674, 'tuning_rank_regret': 0.13548728823661804, 'tuning_rank_spearman': 0.19339285790920258, 'val_pearson_corr': 0.627684473991394, 'val_spearman_corr': 0.6640229821205139, 'val_rank_regret': 0.02892453968524933, 'val_rank_spearman': 0.5555555820465088}]
2025-12-23 00:42:03 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.19339_val-0.12092_epoch021.chkpt
2025-12-23 00:42:03 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.19305_val-0.06528_epoch049.chkpt
2025-12-23 00:42:03 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.19134_val-0.05926_epoch058.chkpt
2025-12-23 00:42:03 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.07838_epoch019.ckpt
2025-12-23 00:42:03 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.13548728823661804
  tuning_rank_spearman      0.19339285790920258
        val_loss            0.12092096358537674
    val_pearson_corr         0.627684473991394
     val_rank_regret        0.02892453968524933
    val_rank_spearman       0.5555555820465088
    val_spearman_corr       0.6640229821205139
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run polish_seed101_2025-12-22_18-34-49_phase2_seed888 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed888
[run_full_pipeline] Phase 2 (seed 888) best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_18-34-49_phase2_seed888/model_checkpoints/checkpoint.tuning_rank_spearman-0.19339_val-0.12092_epoch021.chkpt (tuning_rank_spearman=0.19339285790920258)
[run_full_pipeline] Pipeline complete at 2025-12-23T00:42:06Z
    29757.18 real     47301.99 user     81982.10 sys
