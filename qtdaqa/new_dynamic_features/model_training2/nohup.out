Generating graph-dir manifest for advanced_lean_10A ...
[validate_graphs] PROGRESS: 11163/14391 (77.6%) elapsed 15.0s eta 4.3s mismatched=0 missing=0
[validate_graphs] PROGRESS: 11163/14391 (77.6%) elapsed 15.0s eta 4.3s mismatched=0 missing=0
[validate_graphs] PROGRESS: 14391/14391 (100.0%) elapsed 18.7s eta 0.0s mismatched=0 missing=0
[validate_graphs] Manifest written: ../graph_builder2/output/advanced_lean_10A/graph_data/graph_manifest.json
[validate_graphs] OK: validated 14391 graph(s) in /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data

real	0m20.427s
user	1m51.123s
sys	0m59.206s
Done with manifest for advanced_lean_10A ...
       20.43 real       111.12 user        59.20 sys
Skipped Validating graphs using standalone tool ...
Starting model training ...
[run_full_pipeline] Validating graphs before training...
[validate_graphs] OK: validated 14391 graph(s) in /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data
[run_full_pipeline] Starting sweep at 2025-12-24T09:03:53.655381+00:00 using manifest /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/manifests/run_lean.yaml
[train_cli][batch] (1/3) running job 'sched_boost_lean_seed222' -> run_name=sched_boost_lean_seed222_2025-12-24_09-03-53
[train_cli] run_id=sched_boost_lean_seed222_2025-12-24_09-03-53 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53 --git-commit 94c0e71caa --git-dirty
2025-12-24 09:03:57 INFO git_commit = 94c0e71caa (dirty)
2025-12-24 09:03:57 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-24 09:03:57 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53/config/config.yaml
2025-12-24 09:03:57 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data
2025-12-24 09:03:57 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-24 09:03:57 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-24 09:03:57 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53
2025-12-24 09:03:57 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-24 09:03:57 INFO   metadata_path = None
2025-12-24 09:03:57 INFO   summary_path = None
2025-12-24 09:03:57 INFO   accelerator = cpu
2025-12-24 09:03:57 INFO   devices = 1
2025-12-24 09:03:57 INFO   attention_head = 8
2025-12-24 09:03:57 INFO   pooling_type = mean
2025-12-24 09:03:57 INFO   model_self_loops = False
2025-12-24 09:03:57 INFO   model_self_loop_fill = mean
2025-12-24 09:03:57 INFO   model_residual = False
2025-12-24 09:03:57 INFO   batch_size = 48
2025-12-24 09:03:57 INFO   learning_rate = 0.005
2025-12-24 09:03:57 INFO   num_epochs = 140
2025-12-24 09:03:57 INFO   accumulate_grad_batches = 8
2025-12-24 09:03:57 INFO   seed = 222
2025-12-24 09:03:57 INFO   num_workers = 2
2025-12-24 09:03:57 INFO   precision = 32
2025-12-24 09:03:57 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-24 09:03:57 INFO   early_stopping_patience = 24
2025-12-24 09:03:57 INFO   lr_scheduler_patience = 6
2025-12-24 09:03:57 INFO   lr_scheduler_factor = 0.2
2025-12-24 09:03:57 INFO   fast_dev_run = False
2025-12-24 09:03:57 INFO   limit_train_batches = None
2025-12-24 09:03:57 INFO   limit_val_batches = None
2025-12-24 09:03:57 INFO   log_lr = False
2025-12-24 09:03:57 INFO   progress_bar_refresh_rate = 0
2025-12-24 09:03:57 INFO   log_every_n_steps = 100
2025-12-24 09:03:57 INFO   use_val_spearman_as_secondary = True
2025-12-24 09:03:57 INFO   spearman_secondary_min_delta = 0.0
2025-12-24 09:03:57 INFO   spearman_secondary_weight = 1.0
2025-12-24 09:03:57 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-24 09:03:57 INFO   tuning_max_samples = 500
2025-12-24 09:03:57 INFO   tuning_fraction = None
2025-12-24 09:03:57 INFO   tuning_eval_every = 1
2025-12-24 09:03:57 INFO   rank_loss_weight = 0.0
2025-12-24 09:03:57 INFO   rank_loss_margin = 0.0
2025-12-24 09:03:57 INFO   rank_loss_mode = hinge
2025-12-24 09:03:57 INFO   rank_loss_grouped = True
2025-12-24 09:03:57 INFO   variance_reduction_enabled = False
2025-12-24 09:03:57 INFO   variance_reduction_method = topk_avg
2025-12-24 09:03:57 INFO   variance_reduction_top_k = 3
2025-12-24 09:03:57 INFO   coverage_minimum = 0.0
2025-12-24 09:03:57 INFO   coverage_fail_on_missing = False
2025-12-24 09:03:57 INFO   graph_load_profiling = False
2025-12-24 09:03:57 INFO   graph_load_top_k = 5
2025-12-24 09:03:57 INFO   enable_graph_cache = True
2025-12-24 09:03:57 INFO   graph_cache_size = 256
2025-12-24 09:03:57 INFO   canonicalize_on_load = False
2025-12-24 09:03:57 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-24 09:03:57 INFO   edge_schema = {}
2025-12-24 09:03:57 INFO   topology_schema = {}
Seed set to 222
2025-12-24 09:03:57 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-24 09:03:57 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 09:03:57 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-24 09:03:57 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 09:03:57 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-24 09:03:57 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 09:03:59 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-24 09:03:59 INFO Tuning group stats: groups=352 groups>=2=34 singletons=318 max_group=11
2025-12-24 09:03:59 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53/dataset_coverage.json
2025-12-24 09:03:59 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53/dataset_coverage.json for details.
2025-12-24 09:03:59 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53/dataset_coverage.json for details.
2025-12-24 09:03:59 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53/dataset_coverage.json for details.
2025-12-24 09:03:59 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53/schema_summary.json
2025-12-24 09:03:59 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53/feature_metadata.json
2025-12-24 09:03:59 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-24 09:03:59 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/advanced_k_partite_v2/feature-config.yaml.advanced_lean.10A.v2, sha256=2022a36e7b21668173af3af66c25cf6b6a0494e642c0934eac38abbcfeebec3d
2025-12-24 09:03:59 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/work/edge_features)
2025-12-24 09:03:59 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json
2025-12-24 09:03:59 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53/schema_summary.json
2025-12-24 09:03:59 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-24 09:03:59 INFO Topology: topology/persistence_k_partite_advanced/v2 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 628-dimensional node features.
2025-12-24 09:03:59 INFO Node: node/dssp_topo_merge_passthrough/v1; metadata lists 628 feature columns matching the .pt tensor.
2025-12-24 09:03:59 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-24 09:03:59 INFO → Total feature dimensionality observed and confirmed: node_dim = 628, edge_dim = 11.
2025-12-24 09:03:59 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-24 09:03:59 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 628,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge_passthrough/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 628,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge_passthrough/v1",
      "alias": "Passthrough (all dims from topology module) = Node Dynamic Dims",
      "jobs": 16,
      "summary": "DSSP/basic features merged with all topology columns (passthrough)."
    },
    "topology": {
      "id": "topology/persistence_k_partite_advanced/v2",
      "alias": "Advanced k-partite PH (v2 lean) topo_dim 596",
      "jobs": 16,
      "summary": "Fixed-width k-partite persistent homology with slot padding + missingness channels."
    }
  },
  "notes": []
}
2025-12-24 09:03:59 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-24 09:04:00 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=20ec1e8606834155804c88bd85739f01)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-24 09:04:00 INFO Starting training (fast_dev_run=False)
2025-12-24 09:04:00 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53/model_checkpoints exists and is not empty.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 20.1 K | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
180 K     Trainable params
0         Non-trainable params
180 K     Total params
0.721     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-24 09:04:15 INFO Epoch 000 | 25% complete (batch 46/181)
2025-12-24 09:04:15 INFO Epoch 000 | 50% complete (batch 91/181)
2025-12-24 09:04:16 INFO Epoch 000 | 75% complete (batch 136/181)
2025-12-24 09:04:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.140560
2025-12-24 09:04:30 INFO Tuning ranking metrics: regret=0.154501 spearman=-0.163312 (groups=34, skipped=318)
2025-12-24 09:04:30 INFO Epoch 000 | val_loss=0.140560
Metric tuning_rank_spearman improved. New best score: -0.163
2025-12-24 09:04:38 INFO Epoch 001 | 25% complete (batch 46/181)
2025-12-24 09:04:39 INFO Epoch 001 | 50% complete (batch 91/181)
2025-12-24 09:04:40 INFO Epoch 001 | 75% complete (batch 136/181)
2025-12-24 09:04:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.007163
2025-12-24 09:04:54 INFO Tuning ranking metrics: regret=0.156585 spearman=-0.126362 (groups=34, skipped=318)
2025-12-24 09:04:54 INFO Epoch 001 | train_mse=0.158072 | val_loss=0.140624 | best_val_loss=-0.163312
Metric tuning_rank_spearman improved by 0.037 >= min_delta = 0.0. New best score: -0.126
2025-12-24 09:05:04 INFO Epoch 002 | 25% complete (batch 46/181)
2025-12-24 09:05:05 INFO Epoch 002 | 50% complete (batch 91/181)
2025-12-24 09:05:06 INFO Epoch 002 | 75% complete (batch 136/181)
2025-12-24 09:05:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.075319
2025-12-24 09:05:20 INFO Tuning ranking metrics: regret=0.179328 spearman=-0.221359 (groups=34, skipped=318)
2025-12-24 09:05:20 INFO Epoch 002 | train_mse=0.155145 | val_loss=0.140561 | best_val_loss=-0.126362
2025-12-24 09:05:29 INFO Epoch 003 | 25% complete (batch 46/181)
2025-12-24 09:05:29 INFO Epoch 003 | 50% complete (batch 91/181)
2025-12-24 09:05:30 INFO Epoch 003 | 75% complete (batch 136/181)
2025-12-24 09:05:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.033347
2025-12-24 09:05:44 INFO Tuning ranking metrics: regret=0.149787 spearman=-0.070735 (groups=34, skipped=318)
2025-12-24 09:05:44 INFO Epoch 003 | train_mse=0.137744 | val_loss=0.140558 | best_val_loss=-0.126362
Metric tuning_rank_spearman improved by 0.056 >= min_delta = 0.0. New best score: -0.071
2025-12-24 09:05:52 INFO Epoch 004 | 25% complete (batch 46/181)
2025-12-24 09:05:53 INFO Epoch 004 | 50% complete (batch 91/181)
2025-12-24 09:05:54 INFO Epoch 004 | 75% complete (batch 136/181)
2025-12-24 09:06:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.371174
2025-12-24 09:06:08 INFO Tuning ranking metrics: regret=0.139820 spearman=-0.048924 (groups=34, skipped=318)
2025-12-24 09:06:08 INFO Epoch 004 | train_mse=0.139381 | val_loss=0.140953 | best_val_loss=-0.070735
Metric tuning_rank_spearman improved by 0.022 >= min_delta = 0.0. New best score: -0.049
2025-12-24 09:06:17 INFO Epoch 005 | 25% complete (batch 46/181)
2025-12-24 09:06:18 INFO Epoch 005 | 50% complete (batch 91/181)
2025-12-24 09:06:19 INFO Epoch 005 | 75% complete (batch 136/181)
2025-12-24 09:06:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.130174
2025-12-24 09:06:32 INFO Tuning ranking metrics: regret=0.140159 spearman=-0.171282 (groups=34, skipped=318)
2025-12-24 09:06:32 INFO Epoch 005 | train_mse=0.153096 | val_loss=0.140572 | best_val_loss=-0.048924
2025-12-24 09:06:40 INFO Epoch 006 | 25% complete (batch 46/181)
2025-12-24 09:06:41 INFO Epoch 006 | 50% complete (batch 91/181)
2025-12-24 09:06:42 INFO Epoch 006 | 75% complete (batch 136/181)
2025-12-24 09:06:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.232044
2025-12-24 09:06:56 INFO Tuning ranking metrics: regret=0.131359 spearman=-0.027833 (groups=34, skipped=318)
2025-12-24 09:06:56 INFO Epoch 006 | train_mse=0.142274 | val_loss=0.138701 | best_val_loss=-0.048924
Metric tuning_rank_spearman improved by 0.021 >= min_delta = 0.0. New best score: -0.028
2025-12-24 09:07:04 INFO Epoch 007 | 25% complete (batch 46/181)
2025-12-24 09:07:05 INFO Epoch 007 | 50% complete (batch 91/181)
2025-12-24 09:07:06 INFO Epoch 007 | 75% complete (batch 136/181)
2025-12-24 09:07:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.180269
2025-12-24 09:07:19 INFO Tuning ranking metrics: regret=0.136157 spearman=-0.079832 (groups=34, skipped=318)
2025-12-24 09:07:19 INFO Epoch 007 | train_mse=0.140653 | val_loss=0.137272 | best_val_loss=-0.027833
2025-12-24 09:07:28 INFO Epoch 008 | 25% complete (batch 46/181)
2025-12-24 09:07:29 INFO Epoch 008 | 50% complete (batch 91/181)
2025-12-24 09:07:29 INFO Epoch 008 | 75% complete (batch 136/181)
2025-12-24 09:07:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.159074
2025-12-24 09:07:43 INFO Tuning ranking metrics: regret=0.133979 spearman=-0.013057 (groups=34, skipped=318)
2025-12-24 09:07:43 INFO Epoch 008 | train_mse=0.157523 | val_loss=0.141481 | best_val_loss=-0.027833
Metric tuning_rank_spearman improved by 0.015 >= min_delta = 0.0. New best score: -0.013
2025-12-24 09:07:51 INFO Epoch 009 | 25% complete (batch 46/181)
2025-12-24 09:07:52 INFO Epoch 009 | 50% complete (batch 91/181)
2025-12-24 09:07:53 INFO Epoch 009 | 75% complete (batch 136/181)
2025-12-24 09:08:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.129131
2025-12-24 09:08:06 INFO Tuning ranking metrics: regret=0.098013 spearman=0.038987 (groups=34, skipped=318)
2025-12-24 09:08:06 INFO Epoch 009 | train_mse=0.155811 | val_loss=0.140153 | best_val_loss=-0.013057
Metric tuning_rank_spearman improved by 0.052 >= min_delta = 0.0. New best score: 0.039
2025-12-24 09:08:14 INFO Epoch 010 | 25% complete (batch 46/181)
2025-12-24 09:08:16 INFO Epoch 010 | 50% complete (batch 91/181)
2025-12-24 09:08:17 INFO Epoch 010 | 75% complete (batch 136/181)
2025-12-24 09:08:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.003093
2025-12-24 09:08:30 INFO Tuning ranking metrics: regret=0.135311 spearman=-0.186644 (groups=34, skipped=318)
2025-12-24 09:08:30 INFO Epoch 010 | train_mse=0.149202 | val_loss=0.140636 | best_val_loss=0.038987
2025-12-24 09:08:38 INFO Epoch 011 | 25% complete (batch 46/181)
2025-12-24 09:08:39 INFO Epoch 011 | 50% complete (batch 91/181)
2025-12-24 09:08:40 INFO Epoch 011 | 75% complete (batch 136/181)
2025-12-24 09:08:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.160516
2025-12-24 09:08:54 INFO Tuning ranking metrics: regret=0.139708 spearman=-0.073160 (groups=34, skipped=318)
2025-12-24 09:08:54 INFO Epoch 011 | train_mse=0.146214 | val_loss=0.134423 | best_val_loss=0.038987
2025-12-24 09:09:02 INFO Epoch 012 | 25% complete (batch 46/181)
2025-12-24 09:09:03 INFO Epoch 012 | 50% complete (batch 91/181)
2025-12-24 09:09:04 INFO Epoch 012 | 75% complete (batch 136/181)
2025-12-24 09:09:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.052298
2025-12-24 09:09:17 INFO Tuning ranking metrics: regret=0.103338 spearman=-0.107194 (groups=34, skipped=318)
2025-12-24 09:09:17 INFO Epoch 012 | train_mse=0.134195 | val_loss=0.134793 | best_val_loss=0.038987
2025-12-24 09:09:25 INFO Epoch 013 | 25% complete (batch 46/181)
2025-12-24 09:09:26 INFO Epoch 013 | 50% complete (batch 91/181)
2025-12-24 09:09:27 INFO Epoch 013 | 75% complete (batch 136/181)
2025-12-24 09:09:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.096276
2025-12-24 09:09:40 INFO Tuning ranking metrics: regret=0.147420 spearman=-0.150968 (groups=34, skipped=318)
2025-12-24 09:09:40 INFO Epoch 013 | train_mse=0.115910 | val_loss=0.134662 | best_val_loss=0.038987
2025-12-24 09:09:49 INFO Epoch 014 | 25% complete (batch 46/181)
2025-12-24 09:09:50 INFO Epoch 014 | 50% complete (batch 91/181)
2025-12-24 09:09:50 INFO Epoch 014 | 75% complete (batch 136/181)
2025-12-24 09:09:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.084246
2025-12-24 09:10:04 INFO Tuning ranking metrics: regret=0.132960 spearman=0.026064 (groups=34, skipped=318)
2025-12-24 09:10:04 INFO Epoch 014 | train_mse=0.135424 | val_loss=0.134887 | best_val_loss=0.038987
2025-12-24 09:10:12 INFO Epoch 015 | 25% complete (batch 46/181)
2025-12-24 09:10:13 INFO Epoch 015 | 50% complete (batch 91/181)
2025-12-24 09:10:14 INFO Epoch 015 | 75% complete (batch 136/181)
2025-12-24 09:10:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.015351
2025-12-24 09:10:27 INFO Tuning ranking metrics: regret=0.132941 spearman=0.006016 (groups=34, skipped=318)
2025-12-24 09:10:27 INFO Epoch 015 | train_mse=0.130245 | val_loss=0.134801 | best_val_loss=0.038987
2025-12-24 09:10:35 INFO Epoch 016 | 25% complete (batch 46/181)
2025-12-24 09:10:36 INFO Epoch 016 | 50% complete (batch 91/181)
2025-12-24 09:10:37 INFO Epoch 016 | 75% complete (batch 136/181)
2025-12-24 09:10:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.006899
2025-12-24 09:10:51 INFO Tuning ranking metrics: regret=0.131661 spearman=0.067048 (groups=34, skipped=318)
2025-12-24 09:10:51 INFO Epoch 016 | train_mse=0.148139 | val_loss=0.135176 | best_val_loss=0.038987
Metric tuning_rank_spearman improved by 0.028 >= min_delta = 0.0. New best score: 0.067
2025-12-24 09:10:59 INFO Epoch 017 | 25% complete (batch 46/181)
2025-12-24 09:11:00 INFO Epoch 017 | 50% complete (batch 91/181)
2025-12-24 09:11:01 INFO Epoch 017 | 75% complete (batch 136/181)
2025-12-24 09:11:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.007737
2025-12-24 09:11:15 INFO Tuning ranking metrics: regret=0.132846 spearman=0.068494 (groups=34, skipped=318)
2025-12-24 09:11:15 INFO Epoch 017 | train_mse=0.140602 | val_loss=0.135339 | best_val_loss=0.067048
Metric tuning_rank_spearman improved by 0.001 >= min_delta = 0.0. New best score: 0.068
2025-12-24 09:11:23 INFO Epoch 018 | 25% complete (batch 46/181)
2025-12-24 09:11:24 INFO Epoch 018 | 50% complete (batch 91/181)
2025-12-24 09:11:25 INFO Epoch 018 | 75% complete (batch 136/181)
2025-12-24 09:11:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.006445
2025-12-24 09:11:38 INFO Tuning ranking metrics: regret=0.136050 spearman=-0.021225 (groups=34, skipped=318)
2025-12-24 09:11:38 INFO Epoch 018 | train_mse=0.135644 | val_loss=0.134703 | best_val_loss=0.068494
2025-12-24 09:11:47 INFO Epoch 019 | 25% complete (batch 46/181)
2025-12-24 09:11:48 INFO Epoch 019 | 50% complete (batch 91/181)
2025-12-24 09:11:49 INFO Epoch 019 | 75% complete (batch 136/181)
2025-12-24 09:11:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.112653
2025-12-24 09:12:02 INFO Tuning ranking metrics: regret=0.131182 spearman=0.027298 (groups=34, skipped=318)
2025-12-24 09:12:02 INFO Epoch 019 | train_mse=0.135617 | val_loss=0.134717 | best_val_loss=0.068494
2025-12-24 09:12:11 INFO Epoch 020 | 25% complete (batch 46/181)
2025-12-24 09:12:11 INFO Epoch 020 | 50% complete (batch 91/181)
2025-12-24 09:12:12 INFO Epoch 020 | 75% complete (batch 136/181)
2025-12-24 09:12:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.087465
2025-12-24 09:12:26 INFO Tuning ranking metrics: regret=0.131081 spearman=0.032850 (groups=34, skipped=318)
2025-12-24 09:12:26 INFO Epoch 020 | train_mse=0.131674 | val_loss=0.134720 | best_val_loss=0.068494
2025-12-24 09:12:34 INFO Epoch 021 | 25% complete (batch 46/181)
2025-12-24 09:12:35 INFO Epoch 021 | 50% complete (batch 91/181)
2025-12-24 09:12:36 INFO Epoch 021 | 75% complete (batch 136/181)
2025-12-24 09:12:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.039018
2025-12-24 09:12:49 INFO Tuning ranking metrics: regret=0.131222 spearman=0.033970 (groups=34, skipped=318)
2025-12-24 09:12:49 INFO Epoch 021 | train_mse=0.126076 | val_loss=0.134676 | best_val_loss=0.068494
2025-12-24 09:12:58 INFO Epoch 022 | 25% complete (batch 46/181)
2025-12-24 09:12:59 INFO Epoch 022 | 50% complete (batch 91/181)
2025-12-24 09:12:59 INFO Epoch 022 | 75% complete (batch 136/181)
2025-12-24 09:13:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.027078
2025-12-24 09:13:13 INFO Tuning ranking metrics: regret=0.131779 spearman=0.032996 (groups=34, skipped=318)
2025-12-24 09:13:13 INFO Epoch 022 | train_mse=0.128771 | val_loss=0.134660 | best_val_loss=0.068494
2025-12-24 09:13:21 INFO Epoch 023 | 25% complete (batch 46/181)
2025-12-24 09:13:22 INFO Epoch 023 | 50% complete (batch 91/181)
2025-12-24 09:13:23 INFO Epoch 023 | 75% complete (batch 136/181)
2025-12-24 09:13:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.017439
2025-12-24 09:13:36 INFO Tuning ranking metrics: regret=0.131779 spearman=0.027954 (groups=34, skipped=318)
2025-12-24 09:13:36 INFO Epoch 023 | train_mse=0.135737 | val_loss=0.134658 | best_val_loss=0.068494
2025-12-24 09:13:45 INFO Epoch 024 | 25% complete (batch 46/181)
2025-12-24 09:13:46 INFO Epoch 024 | 50% complete (batch 91/181)
2025-12-24 09:13:47 INFO Epoch 024 | 75% complete (batch 136/181)
2025-12-24 09:13:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.024502
2025-12-24 09:14:00 INFO Tuning ranking metrics: regret=0.133051 spearman=-0.008040 (groups=34, skipped=318)
2025-12-24 09:14:00 INFO Epoch 024 | train_mse=0.127640 | val_loss=0.134823 | best_val_loss=0.068494
2025-12-24 09:14:08 INFO Epoch 025 | 25% complete (batch 46/181)
2025-12-24 09:14:09 INFO Epoch 025 | 50% complete (batch 91/181)
2025-12-24 09:14:10 INFO Epoch 025 | 75% complete (batch 136/181)
2025-12-24 09:14:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.084707
2025-12-24 09:14:23 INFO Tuning ranking metrics: regret=0.136366 spearman=-0.008569 (groups=34, skipped=318)
2025-12-24 09:14:23 INFO Epoch 025 | train_mse=0.135204 | val_loss=0.134745 | best_val_loss=0.068494
2025-12-24 09:14:31 INFO Epoch 026 | 25% complete (batch 46/181)
2025-12-24 09:14:32 INFO Epoch 026 | 50% complete (batch 91/181)
2025-12-24 09:14:33 INFO Epoch 026 | 75% complete (batch 136/181)
2025-12-24 09:14:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.106217
2025-12-24 09:14:47 INFO Tuning ranking metrics: regret=0.136476 spearman=-0.012802 (groups=34, skipped=318)
2025-12-24 09:14:47 INFO Epoch 026 | train_mse=0.125041 | val_loss=0.134731 | best_val_loss=0.068494
2025-12-24 09:14:55 INFO Epoch 027 | 25% complete (batch 46/181)
2025-12-24 09:14:56 INFO Epoch 027 | 50% complete (batch 91/181)
2025-12-24 09:14:57 INFO Epoch 027 | 75% complete (batch 136/181)
2025-12-24 09:15:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.138263
2025-12-24 09:15:10 INFO Tuning ranking metrics: regret=0.136366 spearman=0.001133 (groups=34, skipped=318)
2025-12-24 09:15:10 INFO Epoch 027 | train_mse=0.118447 | val_loss=0.134728 | best_val_loss=0.068494
2025-12-24 09:15:19 INFO Epoch 028 | 25% complete (batch 46/181)
2025-12-24 09:15:20 INFO Epoch 028 | 50% complete (batch 91/181)
2025-12-24 09:15:20 INFO Epoch 028 | 75% complete (batch 136/181)
2025-12-24 09:15:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.107864
2025-12-24 09:15:34 INFO Tuning ranking metrics: regret=0.139644 spearman=-0.010186 (groups=34, skipped=318)
2025-12-24 09:15:34 INFO Epoch 028 | train_mse=0.116551 | val_loss=0.134690 | best_val_loss=0.068494
2025-12-24 09:15:42 INFO Epoch 029 | 25% complete (batch 46/181)
2025-12-24 09:15:43 INFO Epoch 029 | 50% complete (batch 91/181)
2025-12-24 09:15:44 INFO Epoch 029 | 75% complete (batch 136/181)
2025-12-24 09:15:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.147816
2025-12-24 09:15:57 INFO Tuning ranking metrics: regret=0.139505 spearman=-0.009486 (groups=34, skipped=318)
2025-12-24 09:15:57 INFO Epoch 029 | train_mse=0.121215 | val_loss=0.134664 | best_val_loss=0.068494
2025-12-24 09:16:06 INFO Epoch 030 | 25% complete (batch 46/181)
2025-12-24 09:16:07 INFO Epoch 030 | 50% complete (batch 91/181)
2025-12-24 09:16:07 INFO Epoch 030 | 75% complete (batch 136/181)
2025-12-24 09:16:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.158889
2025-12-24 09:16:21 INFO Tuning ranking metrics: regret=0.139505 spearman=-0.002712 (groups=34, skipped=318)
2025-12-24 09:16:21 INFO Epoch 030 | train_mse=0.117785 | val_loss=0.134625 | best_val_loss=0.068494
2025-12-24 09:16:29 INFO Epoch 031 | 25% complete (batch 46/181)
2025-12-24 09:16:30 INFO Epoch 031 | 50% complete (batch 91/181)
2025-12-24 09:16:31 INFO Epoch 031 | 75% complete (batch 136/181)
2025-12-24 09:16:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.128420
2025-12-24 09:16:44 INFO Tuning ranking metrics: regret=0.165975 spearman=-0.077242 (groups=34, skipped=318)
2025-12-24 09:16:44 INFO Epoch 031 | train_mse=0.129149 | val_loss=0.134678 | best_val_loss=0.068494
2025-12-24 09:16:53 INFO Epoch 032 | 25% complete (batch 46/181)
2025-12-24 09:16:54 INFO Epoch 032 | 50% complete (batch 91/181)
2025-12-24 09:16:55 INFO Epoch 032 | 75% complete (batch 136/181)
2025-12-24 09:17:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.212143
2025-12-24 09:17:08 INFO Tuning ranking metrics: regret=0.160647 spearman=-0.085000 (groups=34, skipped=318)
2025-12-24 09:17:08 INFO Epoch 032 | train_mse=0.123156 | val_loss=0.134602 | best_val_loss=0.068494
2025-12-24 09:17:16 INFO Epoch 033 | 25% complete (batch 46/181)
2025-12-24 09:17:17 INFO Epoch 033 | 50% complete (batch 91/181)
2025-12-24 09:17:18 INFO Epoch 033 | 75% complete (batch 136/181)
2025-12-24 09:17:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.208852
2025-12-24 09:17:31 INFO Tuning ranking metrics: regret=0.159744 spearman=-0.085536 (groups=34, skipped=318)
2025-12-24 09:17:31 INFO Epoch 033 | train_mse=0.133549 | val_loss=0.134564 | best_val_loss=0.068494
2025-12-24 09:17:39 INFO Epoch 034 | 25% complete (batch 46/181)
2025-12-24 09:17:40 INFO Epoch 034 | 50% complete (batch 91/181)
2025-12-24 09:17:41 INFO Epoch 034 | 75% complete (batch 136/181)
2025-12-24 09:17:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.204440
2025-12-24 09:17:54 INFO Tuning ranking metrics: regret=0.139636 spearman=-0.084346 (groups=34, skipped=318)
2025-12-24 09:17:54 INFO Epoch 034 | train_mse=0.133736 | val_loss=0.134552 | best_val_loss=0.068494
2025-12-24 09:18:03 INFO Epoch 035 | 25% complete (batch 46/181)
2025-12-24 09:18:04 INFO Epoch 035 | 50% complete (batch 91/181)
2025-12-24 09:18:05 INFO Epoch 035 | 75% complete (batch 136/181)
2025-12-24 09:18:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.199004
2025-12-24 09:18:18 INFO Tuning ranking metrics: regret=0.139606 spearman=-0.019729 (groups=34, skipped=318)
2025-12-24 09:18:18 INFO Epoch 035 | train_mse=0.132065 | val_loss=0.134539 | best_val_loss=0.068494
2025-12-24 09:18:26 INFO Epoch 036 | 25% complete (batch 46/181)
2025-12-24 09:18:27 INFO Epoch 036 | 50% complete (batch 91/181)
2025-12-24 09:18:28 INFO Epoch 036 | 75% complete (batch 136/181)
2025-12-24 09:18:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.167786
2025-12-24 09:18:42 INFO Tuning ranking metrics: regret=0.139606 spearman=-0.019729 (groups=34, skipped=318)
2025-12-24 09:18:42 INFO Epoch 036 | train_mse=0.119324 | val_loss=0.134535 | best_val_loss=0.068494
2025-12-24 09:18:50 INFO Epoch 037 | 25% complete (batch 46/181)
2025-12-24 09:18:51 INFO Epoch 037 | 50% complete (batch 91/181)
2025-12-24 09:18:52 INFO Epoch 037 | 75% complete (batch 136/181)
2025-12-24 09:19:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.190210
2025-12-24 09:19:06 INFO Tuning ranking metrics: regret=0.139636 spearman=-0.078062 (groups=34, skipped=318)
2025-12-24 09:19:06 INFO Epoch 037 | train_mse=0.124687 | val_loss=0.134538 | best_val_loss=0.068494
2025-12-24 09:19:14 INFO Epoch 038 | 25% complete (batch 46/181)
2025-12-24 09:19:15 INFO Epoch 038 | 50% complete (batch 91/181)
2025-12-24 09:19:16 INFO Epoch 038 | 75% complete (batch 136/181)
2025-12-24 09:19:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.198195
2025-12-24 09:19:29 INFO Tuning ranking metrics: regret=0.139636 spearman=-0.078062 (groups=34, skipped=318)
2025-12-24 09:19:29 INFO Epoch 038 | train_mse=0.136585 | val_loss=0.134529 | best_val_loss=0.068494
2025-12-24 09:19:38 INFO Epoch 039 | 25% complete (batch 46/181)
2025-12-24 09:19:39 INFO Epoch 039 | 50% complete (batch 91/181)
2025-12-24 09:19:40 INFO Epoch 039 | 75% complete (batch 136/181)
2025-12-24 09:19:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.198170
2025-12-24 09:19:53 INFO Tuning ranking metrics: regret=0.139636 spearman=-0.078062 (groups=34, skipped=318)
2025-12-24 09:19:53 INFO Epoch 039 | train_mse=0.149149 | val_loss=0.134520 | best_val_loss=0.068494
2025-12-24 09:20:01 INFO Epoch 040 | 25% complete (batch 46/181)
2025-12-24 09:20:03 INFO Epoch 040 | 50% complete (batch 91/181)
2025-12-24 09:20:04 INFO Epoch 040 | 75% complete (batch 136/181)
2025-12-24 09:20:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.194202
2025-12-24 09:20:17 INFO Tuning ranking metrics: regret=0.139636 spearman=-0.078062 (groups=34, skipped=318)
2025-12-24 09:20:17 INFO Epoch 040 | train_mse=0.128835 | val_loss=0.134519 | best_val_loss=0.068494
2025-12-24 09:20:25 INFO Epoch 041 | 25% complete (batch 46/181)
2025-12-24 09:20:26 INFO Epoch 041 | 50% complete (batch 91/181)
2025-12-24 09:20:27 INFO Epoch 041 | 75% complete (batch 136/181)
2025-12-24 09:20:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.198897
2025-12-24 09:20:40 INFO Tuning ranking metrics: regret=0.139636 spearman=-0.078062 (groups=34, skipped=318)
2025-12-24 09:20:40 INFO Epoch 041 | train_mse=0.127654 | val_loss=0.134515 | best_val_loss=0.068494
Monitored metric tuning_rank_spearman did not improve in the last 24 records. Best score: 0.068. Signaling Trainer to stop.
2025-12-24 09:20:41 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.03899_val-0.14015_epoch009.chkpt, checkpoint.tuning_rank_spearman-0.06705_val-0.13518_epoch016.chkpt, checkpoint.tuning_rank_spearman-0.06849_val-0.13534_epoch017.chkpt
2025-12-24 09:20:41 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53/model_checkpoints/checkpoint.tuning_rank_spearman-0.06849_val-0.13534_epoch017.chkpt
2025-12-24 09:20:41 INFO Best validation loss: tensor(0.0685)
2025-12-24 09:20:41 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53/model_checkpoints/checkpoint.tuning_rank_spearman-0.06849_val-0.13534_epoch017.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53/model_checkpoints/checkpoint.tuning_rank_spearman-0.06849_val-0.13534_epoch017.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-24 09:20:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.135339
2025-12-24 09:20:53 INFO Tuning ranking metrics: regret=0.132846 spearman=0.068494 (groups=34, skipped=318)
2025-12-24 09:20:53 INFO Epoch 042 | val_loss=0.135339 | best_val_loss=0.068494
2025-12-24 09:20:54 INFO Validation metrics: [{'val_loss': 0.13533921539783478, 'tuning_rank_regret': 0.13284562528133392, 'tuning_rank_spearman': 0.06849376112222672, 'val_pearson_corr': 0.228988379240036, 'val_spearman_corr': 0.12825822830200195, 'val_rank_regret': 0.2317657321691513, 'val_rank_spearman': -0.3333333432674408}]
2025-12-24 09:20:54 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.06849_val-0.13534_epoch017.chkpt
2025-12-24 09:20:54 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.03899_val-0.14015_epoch009.chkpt
2025-12-24 09:20:54 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.06705_val-0.13518_epoch016.chkpt
2025-12-24 09:20:54 INFO Renamed checkpoint file: alt_val.val-0.13442_epoch011.ckpt -> alt_val.val-0.13442_epoch011.chkpt
2025-12-24 09:20:54 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.13442_epoch011.chkpt
2025-12-24 09:20:54 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.13284562528133392
  tuning_rank_spearman      0.06849376112222672
        val_loss            0.13533921539783478
    val_pearson_corr         0.228988379240036
     val_rank_regret        0.2317657321691513
    val_rank_spearman       -0.3333333432674408
    val_spearman_corr       0.12825822830200195
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run sched_boost_lean_seed222_2025-12-24_09-03-53 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53
[train_cli][batch] job 'sched_boost_lean_seed222' finished.
[train_cli][batch] (2/3) running job 'sched_boost_lr035_lean_seed222' -> run_name=sched_boost_lr035_lean_seed222_2025-12-24_09-20-56
[train_cli] run_id=sched_boost_lr035_lean_seed222_2025-12-24_09-20-56 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-24_09-20-56/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-24_09-20-56 --git-commit 94c0e71caa --git-dirty
2025-12-24 09:20:59 INFO git_commit = 94c0e71caa (dirty)
2025-12-24 09:20:59 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-24 09:20:59 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-24_09-20-56/config/config.yaml
2025-12-24 09:20:59 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data
2025-12-24 09:20:59 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-24 09:20:59 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-24 09:20:59 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-24_09-20-56
2025-12-24 09:20:59 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-24 09:20:59 INFO   metadata_path = None
2025-12-24 09:20:59 INFO   summary_path = None
2025-12-24 09:20:59 INFO   accelerator = cpu
2025-12-24 09:20:59 INFO   devices = 1
2025-12-24 09:20:59 INFO   attention_head = 8
2025-12-24 09:20:59 INFO   pooling_type = mean
2025-12-24 09:20:59 INFO   model_self_loops = False
2025-12-24 09:20:59 INFO   model_self_loop_fill = mean
2025-12-24 09:20:59 INFO   model_residual = False
2025-12-24 09:20:59 INFO   batch_size = 48
2025-12-24 09:20:59 INFO   learning_rate = 0.0035
2025-12-24 09:20:59 INFO   num_epochs = 140
2025-12-24 09:20:59 INFO   accumulate_grad_batches = 8
2025-12-24 09:20:59 INFO   seed = 222
2025-12-24 09:20:59 INFO   num_workers = 2
2025-12-24 09:20:59 INFO   precision = 32
2025-12-24 09:20:59 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-24 09:20:59 INFO   early_stopping_patience = 24
2025-12-24 09:20:59 INFO   lr_scheduler_patience = 6
2025-12-24 09:20:59 INFO   lr_scheduler_factor = 0.2
2025-12-24 09:20:59 INFO   fast_dev_run = False
2025-12-24 09:20:59 INFO   limit_train_batches = None
2025-12-24 09:20:59 INFO   limit_val_batches = None
2025-12-24 09:20:59 INFO   log_lr = False
2025-12-24 09:20:59 INFO   progress_bar_refresh_rate = 0
2025-12-24 09:20:59 INFO   log_every_n_steps = 100
2025-12-24 09:20:59 INFO   use_val_spearman_as_secondary = True
2025-12-24 09:20:59 INFO   spearman_secondary_min_delta = 0.0
2025-12-24 09:20:59 INFO   spearman_secondary_weight = 1.0
2025-12-24 09:20:59 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-24 09:20:59 INFO   tuning_max_samples = 500
2025-12-24 09:20:59 INFO   tuning_fraction = None
2025-12-24 09:20:59 INFO   tuning_eval_every = 1
2025-12-24 09:20:59 INFO   rank_loss_weight = 0.0
2025-12-24 09:20:59 INFO   rank_loss_margin = 0.0
2025-12-24 09:20:59 INFO   rank_loss_mode = hinge
2025-12-24 09:20:59 INFO   rank_loss_grouped = True
2025-12-24 09:20:59 INFO   variance_reduction_enabled = False
2025-12-24 09:20:59 INFO   variance_reduction_method = topk_avg
2025-12-24 09:20:59 INFO   variance_reduction_top_k = 3
2025-12-24 09:20:59 INFO   coverage_minimum = 0.0
2025-12-24 09:20:59 INFO   coverage_fail_on_missing = False
2025-12-24 09:20:59 INFO   graph_load_profiling = False
2025-12-24 09:20:59 INFO   graph_load_top_k = 5
2025-12-24 09:20:59 INFO   enable_graph_cache = True
2025-12-24 09:20:59 INFO   graph_cache_size = 256
2025-12-24 09:20:59 INFO   canonicalize_on_load = False
2025-12-24 09:20:59 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-24 09:20:59 INFO   edge_schema = {}
2025-12-24 09:20:59 INFO   topology_schema = {}
Seed set to 222
2025-12-24 09:21:00 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-24 09:21:00 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 09:21:00 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-24 09:21:00 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 09:21:00 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-24 09:21:00 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 09:21:02 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-24 09:21:02 INFO Tuning group stats: groups=352 groups>=2=34 singletons=318 max_group=11
2025-12-24 09:21:02 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-24_09-20-56/dataset_coverage.json
2025-12-24 09:21:02 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-24_09-20-56/dataset_coverage.json for details.
2025-12-24 09:21:02 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-24_09-20-56/dataset_coverage.json for details.
2025-12-24 09:21:02 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-24_09-20-56/dataset_coverage.json for details.
2025-12-24 09:21:02 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-24_09-20-56/schema_summary.json
2025-12-24 09:21:02 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-24_09-20-56/feature_metadata.json
2025-12-24 09:21:02 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-24 09:21:02 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/advanced_k_partite_v2/feature-config.yaml.advanced_lean.10A.v2, sha256=2022a36e7b21668173af3af66c25cf6b6a0494e642c0934eac38abbcfeebec3d
2025-12-24 09:21:02 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/work/edge_features)
2025-12-24 09:21:02 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json
2025-12-24 09:21:02 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-24_09-20-56/schema_summary.json
2025-12-24 09:21:02 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-24 09:21:02 INFO Topology: topology/persistence_k_partite_advanced/v2 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 628-dimensional node features.
2025-12-24 09:21:02 INFO Node: node/dssp_topo_merge_passthrough/v1; metadata lists 628 feature columns matching the .pt tensor.
2025-12-24 09:21:02 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-24 09:21:02 INFO → Total feature dimensionality observed and confirmed: node_dim = 628, edge_dim = 11.
2025-12-24 09:21:02 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-24 09:21:02 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 628,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge_passthrough/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 628,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-24_09-20-56/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge_passthrough/v1",
      "alias": "Passthrough (all dims from topology module) = Node Dynamic Dims",
      "jobs": 16,
      "summary": "DSSP/basic features merged with all topology columns (passthrough)."
    },
    "topology": {
      "id": "topology/persistence_k_partite_advanced/v2",
      "alias": "Advanced k-partite PH (v2 lean) topo_dim 596",
      "jobs": 16,
      "summary": "Fixed-width k-partite persistent homology with slot padding + missingness channels."
    }
  },
  "notes": []
}
2025-12-24 09:21:02 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-24 09:21:02 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=6a778bc189574545bc858012d21ab62d)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-24 09:21:02 INFO Starting training (fast_dev_run=False)
2025-12-24 09:21:02 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-24_09-20-56/model_checkpoints exists and is not empty.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 20.1 K | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
180 K     Trainable params
0         Non-trainable params
180 K     Total params
0.721     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-24 09:21:16 INFO Epoch 000 | 25% complete (batch 46/181)
2025-12-24 09:21:17 INFO Epoch 000 | 50% complete (batch 91/181)
2025-12-24 09:21:18 INFO Epoch 000 | 75% complete (batch 136/181)
2025-12-24 09:21:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.140593
2025-12-24 09:21:31 INFO Tuning ranking metrics: regret=0.156244 spearman=-0.166896 (groups=34, skipped=318)
2025-12-24 09:21:31 INFO Epoch 000 | val_loss=0.140593
Metric tuning_rank_spearman improved. New best score: -0.167
2025-12-24 09:21:39 INFO Epoch 001 | 25% complete (batch 46/181)
2025-12-24 09:21:40 INFO Epoch 001 | 50% complete (batch 91/181)
2025-12-24 09:21:41 INFO Epoch 001 | 75% complete (batch 136/181)
2025-12-24 09:21:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.027111
2025-12-24 09:21:54 INFO Tuning ranking metrics: regret=0.152860 spearman=-0.172148 (groups=34, skipped=318)
2025-12-24 09:21:54 INFO Epoch 001 | train_mse=0.154996 | val_loss=0.140560 | best_val_loss=-0.166896
2025-12-24 09:22:02 INFO Epoch 002 | 25% complete (batch 46/181)
2025-12-24 09:22:03 INFO Epoch 002 | 50% complete (batch 91/181)
2025-12-24 09:22:04 INFO Epoch 002 | 75% complete (batch 136/181)
2025-12-24 09:22:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.027638
2025-12-24 09:22:17 INFO Tuning ranking metrics: regret=0.150879 spearman=-0.108314 (groups=34, skipped=318)
2025-12-24 09:22:17 INFO Epoch 002 | train_mse=0.151999 | val_loss=0.140455 | best_val_loss=-0.166896
Metric tuning_rank_spearman improved by 0.059 >= min_delta = 0.0. New best score: -0.108
2025-12-24 09:22:26 INFO Epoch 003 | 25% complete (batch 46/181)
2025-12-24 09:22:27 INFO Epoch 003 | 50% complete (batch 91/181)
2025-12-24 09:22:28 INFO Epoch 003 | 75% complete (batch 136/181)
2025-12-24 09:22:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.362181
2025-12-24 09:22:41 INFO Tuning ranking metrics: regret=0.128646 spearman=0.073370 (groups=34, skipped=318)
2025-12-24 09:22:41 INFO Epoch 003 | train_mse=0.137152 | val_loss=0.140522 | best_val_loss=-0.108314
Metric tuning_rank_spearman improved by 0.182 >= min_delta = 0.0. New best score: 0.073
2025-12-24 09:22:49 INFO Epoch 004 | 25% complete (batch 46/181)
2025-12-24 09:22:50 INFO Epoch 004 | 50% complete (batch 91/181)
2025-12-24 09:22:51 INFO Epoch 004 | 75% complete (batch 136/181)
2025-12-24 09:22:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.306150
2025-12-24 09:23:04 INFO Tuning ranking metrics: regret=0.114937 spearman=-0.013948 (groups=34, skipped=318)
2025-12-24 09:23:04 INFO Epoch 004 | train_mse=0.139595 | val_loss=0.140567 | best_val_loss=0.073370
2025-12-24 09:23:12 INFO Epoch 005 | 25% complete (batch 46/181)
2025-12-24 09:23:13 INFO Epoch 005 | 50% complete (batch 91/181)
2025-12-24 09:23:14 INFO Epoch 005 | 75% complete (batch 136/181)
2025-12-24 09:23:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.230432
2025-12-24 09:23:28 INFO Tuning ranking metrics: regret=0.147527 spearman=-0.154851 (groups=34, skipped=318)
2025-12-24 09:23:28 INFO Epoch 005 | train_mse=0.152600 | val_loss=0.139876 | best_val_loss=0.073370
2025-12-24 09:23:36 INFO Epoch 006 | 25% complete (batch 46/181)
2025-12-24 09:23:37 INFO Epoch 006 | 50% complete (batch 91/181)
2025-12-24 09:23:38 INFO Epoch 006 | 75% complete (batch 136/181)
2025-12-24 09:23:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.348389
2025-12-24 09:23:51 INFO Tuning ranking metrics: regret=0.131105 spearman=0.043360 (groups=34, skipped=318)
2025-12-24 09:23:51 INFO Epoch 006 | train_mse=0.141426 | val_loss=0.141906 | best_val_loss=0.073370
2025-12-24 09:23:59 INFO Epoch 007 | 25% complete (batch 46/181)
2025-12-24 09:24:00 INFO Epoch 007 | 50% complete (batch 91/181)
2025-12-24 09:24:01 INFO Epoch 007 | 75% complete (batch 136/181)
2025-12-24 09:24:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.409683
2025-12-24 09:24:15 INFO Tuning ranking metrics: regret=0.120254 spearman=0.000898 (groups=34, skipped=318)
2025-12-24 09:24:15 INFO Epoch 007 | train_mse=0.133861 | val_loss=0.143390 | best_val_loss=0.073370
2025-12-24 09:24:23 INFO Epoch 008 | 25% complete (batch 46/181)
2025-12-24 09:24:24 INFO Epoch 008 | 50% complete (batch 91/181)
2025-12-24 09:24:24 INFO Epoch 008 | 75% complete (batch 136/181)
2025-12-24 09:24:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.342934
2025-12-24 09:24:38 INFO Tuning ranking metrics: regret=0.135294 spearman=-0.074879 (groups=34, skipped=318)
2025-12-24 09:24:38 INFO Epoch 008 | train_mse=0.160573 | val_loss=0.141174 | best_val_loss=0.073370
2025-12-24 09:24:46 INFO Epoch 009 | 25% complete (batch 46/181)
2025-12-24 09:24:47 INFO Epoch 009 | 50% complete (batch 91/181)
2025-12-24 09:24:48 INFO Epoch 009 | 75% complete (batch 136/181)
2025-12-24 09:24:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.340067
2025-12-24 09:25:01 INFO Tuning ranking metrics: regret=0.135779 spearman=-0.268074 (groups=34, skipped=318)
2025-12-24 09:25:01 INFO Epoch 009 | train_mse=0.149922 | val_loss=0.140206 | best_val_loss=0.073370
2025-12-24 09:25:09 INFO Epoch 010 | 25% complete (batch 46/181)
2025-12-24 09:25:10 INFO Epoch 010 | 50% complete (batch 91/181)
2025-12-24 09:25:11 INFO Epoch 010 | 75% complete (batch 136/181)
2025-12-24 09:25:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.247422
2025-12-24 09:25:24 INFO Tuning ranking metrics: regret=0.147167 spearman=-0.109855 (groups=34, skipped=318)
2025-12-24 09:25:24 INFO Epoch 010 | train_mse=0.159650 | val_loss=0.131840 | best_val_loss=0.073370
2025-12-24 09:25:33 INFO Epoch 011 | 25% complete (batch 46/181)
2025-12-24 09:25:34 INFO Epoch 011 | 50% complete (batch 91/181)
2025-12-24 09:25:35 INFO Epoch 011 | 75% complete (batch 136/181)
2025-12-24 09:25:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.426354
2025-12-24 09:25:48 INFO Tuning ranking metrics: regret=0.134328 spearman=-0.024975 (groups=34, skipped=318)
2025-12-24 09:25:48 INFO Epoch 011 | train_mse=0.147989 | val_loss=0.145767 | best_val_loss=0.073370
2025-12-24 09:25:56 INFO Epoch 012 | 25% complete (batch 46/181)
2025-12-24 09:25:57 INFO Epoch 012 | 50% complete (batch 91/181)
2025-12-24 09:25:58 INFO Epoch 012 | 75% complete (batch 136/181)
2025-12-24 09:26:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.420845
2025-12-24 09:26:11 INFO Tuning ranking metrics: regret=0.105430 spearman=-0.012223 (groups=34, skipped=318)
2025-12-24 09:26:11 INFO Epoch 012 | train_mse=0.138478 | val_loss=0.135632 | best_val_loss=0.073370
2025-12-24 09:26:20 INFO Epoch 013 | 25% complete (batch 46/181)
2025-12-24 09:26:21 INFO Epoch 013 | 50% complete (batch 91/181)
2025-12-24 09:26:22 INFO Epoch 013 | 75% complete (batch 136/181)
2025-12-24 09:26:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.381519
2025-12-24 09:26:35 INFO Tuning ranking metrics: regret=0.120703 spearman=-0.089177 (groups=34, skipped=318)
2025-12-24 09:26:35 INFO Epoch 013 | train_mse=0.146888 | val_loss=0.093435 | best_val_loss=0.073370
2025-12-24 09:26:43 INFO Epoch 014 | 25% complete (batch 46/181)
2025-12-24 09:26:44 INFO Epoch 014 | 50% complete (batch 91/181)
2025-12-24 09:26:45 INFO Epoch 014 | 75% complete (batch 136/181)
2025-12-24 09:26:53 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.488530
2025-12-24 09:26:58 INFO Tuning ranking metrics: regret=0.110421 spearman=-0.104851 (groups=34, skipped=318)
2025-12-24 09:26:58 INFO Epoch 014 | train_mse=0.123160 | val_loss=0.108977 | best_val_loss=0.073370
2025-12-24 09:27:06 INFO Epoch 015 | 25% complete (batch 46/181)
2025-12-24 09:27:07 INFO Epoch 015 | 50% complete (batch 91/181)
2025-12-24 09:27:08 INFO Epoch 015 | 75% complete (batch 136/181)
2025-12-24 09:27:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.511179
2025-12-24 09:27:22 INFO Tuning ranking metrics: regret=0.127775 spearman=-0.081678 (groups=34, skipped=318)
2025-12-24 09:27:22 INFO Epoch 015 | train_mse=0.139138 | val_loss=0.149843 | best_val_loss=0.073370
2025-12-24 09:27:30 INFO Epoch 016 | 25% complete (batch 46/181)
2025-12-24 09:27:31 INFO Epoch 016 | 50% complete (batch 91/181)
2025-12-24 09:27:32 INFO Epoch 016 | 75% complete (batch 136/181)
2025-12-24 09:27:40 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.521675
2025-12-24 09:27:45 INFO Tuning ranking metrics: regret=0.127547 spearman=-0.059460 (groups=34, skipped=318)
2025-12-24 09:27:45 INFO Epoch 016 | train_mse=0.138571 | val_loss=0.140554 | best_val_loss=0.073370
2025-12-24 09:27:54 INFO Epoch 017 | 25% complete (batch 46/181)
2025-12-24 09:27:55 INFO Epoch 017 | 50% complete (batch 91/181)
2025-12-24 09:27:56 INFO Epoch 017 | 75% complete (batch 136/181)
2025-12-24 09:28:04 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.520345
2025-12-24 09:28:09 INFO Tuning ranking metrics: regret=0.122710 spearman=-0.045009 (groups=34, skipped=318)
2025-12-24 09:28:09 INFO Epoch 017 | train_mse=0.145359 | val_loss=0.134406 | best_val_loss=0.073370
2025-12-24 09:28:17 INFO Epoch 018 | 25% complete (batch 46/181)
2025-12-24 09:28:18 INFO Epoch 018 | 50% complete (batch 91/181)
2025-12-24 09:28:19 INFO Epoch 018 | 75% complete (batch 136/181)
2025-12-24 09:28:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.541306
2025-12-24 09:28:32 INFO Tuning ranking metrics: regret=0.122925 spearman=-0.052457 (groups=34, skipped=318)
2025-12-24 09:28:32 INFO Epoch 018 | train_mse=0.145219 | val_loss=0.114333 | best_val_loss=0.073370
2025-12-24 09:28:41 INFO Epoch 019 | 25% complete (batch 46/181)
2025-12-24 09:28:42 INFO Epoch 019 | 50% complete (batch 91/181)
2025-12-24 09:28:43 INFO Epoch 019 | 75% complete (batch 136/181)
2025-12-24 09:28:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.587143
2025-12-24 09:28:57 INFO Tuning ranking metrics: regret=0.123006 spearman=-0.047511 (groups=34, skipped=318)
2025-12-24 09:28:57 INFO Epoch 019 | train_mse=0.125596 | val_loss=0.097655 | best_val_loss=0.073370
2025-12-24 09:29:05 INFO Epoch 020 | 25% complete (batch 46/181)
2025-12-24 09:29:06 INFO Epoch 020 | 50% complete (batch 91/181)
2025-12-24 09:29:07 INFO Epoch 020 | 75% complete (batch 136/181)
2025-12-24 09:29:15 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.596770
2025-12-24 09:29:20 INFO Tuning ranking metrics: regret=0.105402 spearman=0.066660 (groups=34, skipped=318)
2025-12-24 09:29:20 INFO Epoch 020 | train_mse=0.118186 | val_loss=0.101039 | best_val_loss=0.073370
2025-12-24 09:29:28 INFO Epoch 021 | 25% complete (batch 46/181)
2025-12-24 09:29:29 INFO Epoch 021 | 50% complete (batch 91/181)
2025-12-24 09:29:30 INFO Epoch 021 | 75% complete (batch 136/181)
2025-12-24 09:29:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.581654
2025-12-24 09:29:44 INFO Tuning ranking metrics: regret=0.098828 spearman=0.072823 (groups=34, skipped=318)
2025-12-24 09:29:44 INFO Epoch 021 | train_mse=0.111554 | val_loss=0.090317 | best_val_loss=0.073370
2025-12-24 09:29:52 INFO Epoch 022 | 25% complete (batch 46/181)
2025-12-24 09:29:53 INFO Epoch 022 | 50% complete (batch 91/181)
2025-12-24 09:29:54 INFO Epoch 022 | 75% complete (batch 136/181)
2025-12-24 09:30:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.578418
2025-12-24 09:30:07 INFO Tuning ranking metrics: regret=0.097065 spearman=0.084963 (groups=34, skipped=318)
2025-12-24 09:30:07 INFO Epoch 022 | train_mse=0.098392 | val_loss=0.088221 | best_val_loss=0.073370
Metric tuning_rank_spearman improved by 0.012 >= min_delta = 0.0. New best score: 0.085
2025-12-24 09:30:15 INFO Epoch 023 | 25% complete (batch 46/181)
2025-12-24 09:30:16 INFO Epoch 023 | 50% complete (batch 91/181)
2025-12-24 09:30:17 INFO Epoch 023 | 75% complete (batch 136/181)
2025-12-24 09:30:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.602020
2025-12-24 09:30:31 INFO Tuning ranking metrics: regret=0.098828 spearman=0.073046 (groups=34, skipped=318)
2025-12-24 09:30:31 INFO Epoch 023 | train_mse=0.084640 | val_loss=0.072550 | best_val_loss=0.084963
2025-12-24 09:30:39 INFO Epoch 024 | 25% complete (batch 46/181)
2025-12-24 09:30:40 INFO Epoch 024 | 50% complete (batch 91/181)
2025-12-24 09:30:41 INFO Epoch 024 | 75% complete (batch 136/181)
2025-12-24 09:30:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.610432
2025-12-24 09:30:54 INFO Tuning ranking metrics: regret=0.098828 spearman=0.072511 (groups=34, skipped=318)
2025-12-24 09:30:54 INFO Epoch 024 | train_mse=0.095853 | val_loss=0.072806 | best_val_loss=0.084963
2025-12-24 09:31:02 INFO Epoch 025 | 25% complete (batch 46/181)
2025-12-24 09:31:03 INFO Epoch 025 | 50% complete (batch 91/181)
2025-12-24 09:31:04 INFO Epoch 025 | 75% complete (batch 136/181)
2025-12-24 09:31:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.616127
2025-12-24 09:31:18 INFO Tuning ranking metrics: regret=0.098828 spearman=0.078622 (groups=34, skipped=318)
2025-12-24 09:31:18 INFO Epoch 025 | train_mse=0.078135 | val_loss=0.067984 | best_val_loss=0.084963
2025-12-24 09:31:26 INFO Epoch 026 | 25% complete (batch 46/181)
2025-12-24 09:31:27 INFO Epoch 026 | 50% complete (batch 91/181)
2025-12-24 09:31:28 INFO Epoch 026 | 75% complete (batch 136/181)
2025-12-24 09:31:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.628714
2025-12-24 09:31:41 INFO Tuning ranking metrics: regret=0.105402 spearman=0.074758 (groups=34, skipped=318)
2025-12-24 09:31:41 INFO Epoch 026 | train_mse=0.066754 | val_loss=0.067804 | best_val_loss=0.084963
2025-12-24 09:31:49 INFO Epoch 027 | 25% complete (batch 46/181)
2025-12-24 09:31:50 INFO Epoch 027 | 50% complete (batch 91/181)
2025-12-24 09:31:51 INFO Epoch 027 | 75% complete (batch 136/181)
2025-12-24 09:32:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.626160
2025-12-24 09:32:05 INFO Tuning ranking metrics: regret=0.105405 spearman=0.066578 (groups=34, skipped=318)
2025-12-24 09:32:05 INFO Epoch 027 | train_mse=0.088068 | val_loss=0.075104 | best_val_loss=0.084963
2025-12-24 09:32:13 INFO Epoch 028 | 25% complete (batch 46/181)
2025-12-24 09:32:14 INFO Epoch 028 | 50% complete (batch 91/181)
2025-12-24 09:32:15 INFO Epoch 028 | 75% complete (batch 136/181)
2025-12-24 09:32:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.632361
2025-12-24 09:32:28 INFO Tuning ranking metrics: regret=0.102130 spearman=0.073606 (groups=34, skipped=318)
2025-12-24 09:32:28 INFO Epoch 028 | train_mse=0.066880 | val_loss=0.069020 | best_val_loss=0.084963
2025-12-24 09:32:37 INFO Epoch 029 | 25% complete (batch 46/181)
2025-12-24 09:32:37 INFO Epoch 029 | 50% complete (batch 91/181)
2025-12-24 09:32:39 INFO Epoch 029 | 75% complete (batch 136/181)
2025-12-24 09:32:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.628700
2025-12-24 09:32:52 INFO Tuning ranking metrics: regret=0.102130 spearman=0.072543 (groups=34, skipped=318)
2025-12-24 09:32:52 INFO Epoch 029 | train_mse=0.077806 | val_loss=0.080494 | best_val_loss=0.084963
2025-12-24 09:33:00 INFO Epoch 030 | 25% complete (batch 46/181)
2025-12-24 09:33:01 INFO Epoch 030 | 50% complete (batch 91/181)
2025-12-24 09:33:02 INFO Epoch 030 | 75% complete (batch 136/181)
2025-12-24 09:33:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.635920
2025-12-24 09:33:16 INFO Tuning ranking metrics: regret=0.102135 spearman=0.053966 (groups=34, skipped=318)
2025-12-24 09:33:16 INFO Epoch 030 | train_mse=0.062877 | val_loss=0.066383 | best_val_loss=0.084963
2025-12-24 09:33:24 INFO Epoch 031 | 25% complete (batch 46/181)
2025-12-24 09:33:25 INFO Epoch 031 | 50% complete (batch 91/181)
2025-12-24 09:33:26 INFO Epoch 031 | 75% complete (batch 136/181)
2025-12-24 09:33:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.640881
2025-12-24 09:33:39 INFO Tuning ranking metrics: regret=0.105531 spearman=0.062134 (groups=34, skipped=318)
2025-12-24 09:33:39 INFO Epoch 031 | train_mse=0.085192 | val_loss=0.066569 | best_val_loss=0.084963
2025-12-24 09:33:47 INFO Epoch 032 | 25% complete (batch 46/181)
2025-12-24 09:33:48 INFO Epoch 032 | 50% complete (batch 91/181)
2025-12-24 09:33:49 INFO Epoch 032 | 75% complete (batch 136/181)
2025-12-24 09:33:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.643166
2025-12-24 09:34:03 INFO Tuning ranking metrics: regret=0.102943 spearman=0.090852 (groups=34, skipped=318)
2025-12-24 09:34:03 INFO Epoch 032 | train_mse=0.078114 | val_loss=0.069298 | best_val_loss=0.084963
Metric tuning_rank_spearman improved by 0.006 >= min_delta = 0.0. New best score: 0.091
2025-12-24 09:34:11 INFO Epoch 033 | 25% complete (batch 46/181)
2025-12-24 09:34:12 INFO Epoch 033 | 50% complete (batch 91/181)
2025-12-24 09:34:12 INFO Epoch 033 | 75% complete (batch 136/181)
2025-12-24 09:34:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.650009
2025-12-24 09:34:26 INFO Tuning ranking metrics: regret=0.104995 spearman=0.101375 (groups=34, skipped=318)
2025-12-24 09:34:26 INFO Epoch 033 | train_mse=0.079571 | val_loss=0.067569 | best_val_loss=0.090852
Metric tuning_rank_spearman improved by 0.011 >= min_delta = 0.0. New best score: 0.101
2025-12-24 09:34:34 INFO Epoch 034 | 25% complete (batch 46/181)
2025-12-24 09:34:35 INFO Epoch 034 | 50% complete (batch 91/181)
2025-12-24 09:34:36 INFO Epoch 034 | 75% complete (batch 136/181)
2025-12-24 09:34:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.663357
2025-12-24 09:34:49 INFO Tuning ranking metrics: regret=0.099561 spearman=0.135924 (groups=34, skipped=318)
2025-12-24 09:34:49 INFO Epoch 034 | train_mse=0.072385 | val_loss=0.062169 | best_val_loss=0.101375
Metric tuning_rank_spearman improved by 0.035 >= min_delta = 0.0. New best score: 0.136
2025-12-24 09:34:57 INFO Epoch 035 | 25% complete (batch 46/181)
2025-12-24 09:34:58 INFO Epoch 035 | 50% complete (batch 91/181)
2025-12-24 09:34:59 INFO Epoch 035 | 75% complete (batch 136/181)
2025-12-24 09:35:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.650411
2025-12-24 09:35:13 INFO Tuning ranking metrics: regret=0.102957 spearman=0.124643 (groups=34, skipped=318)
2025-12-24 09:35:13 INFO Epoch 035 | train_mse=0.077611 | val_loss=0.071728 | best_val_loss=0.135924
2025-12-24 09:35:21 INFO Epoch 036 | 25% complete (batch 46/181)
2025-12-24 09:35:22 INFO Epoch 036 | 50% complete (batch 91/181)
2025-12-24 09:35:22 INFO Epoch 036 | 75% complete (batch 136/181)
2025-12-24 09:35:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.653031
2025-12-24 09:35:36 INFO Tuning ranking metrics: regret=0.103318 spearman=0.110078 (groups=34, skipped=318)
2025-12-24 09:35:36 INFO Epoch 036 | train_mse=0.059785 | val_loss=0.075177 | best_val_loss=0.135924
2025-12-24 09:35:45 INFO Epoch 037 | 25% complete (batch 46/181)
2025-12-24 09:35:46 INFO Epoch 037 | 50% complete (batch 91/181)
2025-12-24 09:35:47 INFO Epoch 037 | 75% complete (batch 136/181)
2025-12-24 09:35:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.667517
2025-12-24 09:36:00 INFO Tuning ranking metrics: regret=0.103042 spearman=0.109059 (groups=34, skipped=318)
2025-12-24 09:36:00 INFO Epoch 037 | train_mse=0.069657 | val_loss=0.064447 | best_val_loss=0.135924
2025-12-24 09:36:08 INFO Epoch 038 | 25% complete (batch 46/181)
2025-12-24 09:36:09 INFO Epoch 038 | 50% complete (batch 91/181)
2025-12-24 09:36:10 INFO Epoch 038 | 75% complete (batch 136/181)
2025-12-24 09:36:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.663940
2025-12-24 09:36:24 INFO Tuning ranking metrics: regret=0.105515 spearman=0.102642 (groups=34, skipped=318)
2025-12-24 09:36:24 INFO Epoch 038 | train_mse=0.075247 | val_loss=0.061217 | best_val_loss=0.135924
2025-12-24 09:36:32 INFO Epoch 039 | 25% complete (batch 46/181)
2025-12-24 09:36:33 INFO Epoch 039 | 50% complete (batch 91/181)
2025-12-24 09:36:34 INFO Epoch 039 | 75% complete (batch 136/181)
2025-12-24 09:36:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.641518
2025-12-24 09:36:47 INFO Tuning ranking metrics: regret=0.103443 spearman=0.038496 (groups=34, skipped=318)
2025-12-24 09:36:47 INFO Epoch 039 | train_mse=0.094759 | val_loss=0.092191 | best_val_loss=0.135924
2025-12-24 09:36:55 INFO Epoch 040 | 25% complete (batch 46/181)
2025-12-24 09:36:56 INFO Epoch 040 | 50% complete (batch 91/181)
2025-12-24 09:36:57 INFO Epoch 040 | 75% complete (batch 136/181)
2025-12-24 09:37:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.675036
2025-12-24 09:37:11 INFO Tuning ranking metrics: regret=0.103135 spearman=0.124281 (groups=34, skipped=318)
2025-12-24 09:37:11 INFO Epoch 040 | train_mse=0.081505 | val_loss=0.061288 | best_val_loss=0.135924
2025-12-24 09:37:19 INFO Epoch 041 | 25% complete (batch 46/181)
2025-12-24 09:37:20 INFO Epoch 041 | 50% complete (batch 91/181)
2025-12-24 09:37:21 INFO Epoch 041 | 75% complete (batch 136/181)
2025-12-24 09:37:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.683227
2025-12-24 09:37:34 INFO Tuning ranking metrics: regret=0.103164 spearman=0.067711 (groups=34, skipped=318)
2025-12-24 09:37:34 INFO Epoch 041 | train_mse=0.083955 | val_loss=0.059435 | best_val_loss=0.135924
2025-12-24 09:37:43 INFO Epoch 042 | 25% complete (batch 46/181)
2025-12-24 09:37:44 INFO Epoch 042 | 50% complete (batch 91/181)
2025-12-24 09:37:45 INFO Epoch 042 | 75% complete (batch 136/181)
2025-12-24 09:37:53 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.670655
2025-12-24 09:37:58 INFO Tuning ranking metrics: regret=0.103164 spearman=0.051305 (groups=34, skipped=318)
2025-12-24 09:37:58 INFO Epoch 042 | train_mse=0.068784 | val_loss=0.074103 | best_val_loss=0.135924
2025-12-24 09:38:06 INFO Epoch 043 | 25% complete (batch 46/181)
2025-12-24 09:38:07 INFO Epoch 043 | 50% complete (batch 91/181)
2025-12-24 09:38:08 INFO Epoch 043 | 75% complete (batch 136/181)
2025-12-24 09:38:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.685914
2025-12-24 09:38:21 INFO Tuning ranking metrics: regret=0.118176 spearman=0.117997 (groups=34, skipped=318)
2025-12-24 09:38:21 INFO Epoch 043 | train_mse=0.065713 | val_loss=0.059213 | best_val_loss=0.135924
2025-12-24 09:38:30 INFO Epoch 044 | 25% complete (batch 46/181)
2025-12-24 09:38:31 INFO Epoch 044 | 50% complete (batch 91/181)
2025-12-24 09:38:32 INFO Epoch 044 | 75% complete (batch 136/181)
2025-12-24 09:38:40 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.688795
2025-12-24 09:38:45 INFO Tuning ranking metrics: regret=0.119091 spearman=0.111415 (groups=34, skipped=318)
2025-12-24 09:38:45 INFO Epoch 044 | train_mse=0.076590 | val_loss=0.059182 | best_val_loss=0.135924
2025-12-24 09:38:53 INFO Epoch 045 | 25% complete (batch 46/181)
2025-12-24 09:38:54 INFO Epoch 045 | 50% complete (batch 91/181)
2025-12-24 09:38:55 INFO Epoch 045 | 75% complete (batch 136/181)
2025-12-24 09:39:04 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.681551
2025-12-24 09:39:09 INFO Tuning ranking metrics: regret=0.103443 spearman=0.035918 (groups=34, skipped=318)
2025-12-24 09:39:09 INFO Epoch 045 | train_mse=0.059136 | val_loss=0.069075 | best_val_loss=0.135924
2025-12-24 09:39:17 INFO Epoch 046 | 25% complete (batch 46/181)
2025-12-24 09:39:18 INFO Epoch 046 | 50% complete (batch 91/181)
2025-12-24 09:39:19 INFO Epoch 046 | 75% complete (batch 136/181)
2025-12-24 09:39:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.688800
2025-12-24 09:39:32 INFO Tuning ranking metrics: regret=0.103124 spearman=0.127165 (groups=34, skipped=318)
2025-12-24 09:39:32 INFO Epoch 046 | train_mse=0.065875 | val_loss=0.056846 | best_val_loss=0.135924
2025-12-24 09:39:40 INFO Epoch 047 | 25% complete (batch 46/181)
2025-12-24 09:39:41 INFO Epoch 047 | 50% complete (batch 91/181)
2025-12-24 09:39:43 INFO Epoch 047 | 75% complete (batch 136/181)
2025-12-24 09:39:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.689049
2025-12-24 09:39:56 INFO Tuning ranking metrics: regret=0.103154 spearman=0.050064 (groups=34, skipped=318)
2025-12-24 09:39:56 INFO Epoch 047 | train_mse=0.051427 | val_loss=0.060052 | best_val_loss=0.135924
2025-12-24 09:40:04 INFO Epoch 048 | 25% complete (batch 46/181)
2025-12-24 09:40:05 INFO Epoch 048 | 50% complete (batch 91/181)
2025-12-24 09:40:06 INFO Epoch 048 | 75% complete (batch 136/181)
2025-12-24 09:40:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.685713
2025-12-24 09:40:19 INFO Tuning ranking metrics: regret=0.096590 spearman=0.052878 (groups=34, skipped=318)
2025-12-24 09:40:19 INFO Epoch 048 | train_mse=0.065265 | val_loss=0.062231 | best_val_loss=0.135924
2025-12-24 09:40:27 INFO Epoch 049 | 25% complete (batch 46/181)
2025-12-24 09:40:28 INFO Epoch 049 | 50% complete (batch 91/181)
2025-12-24 09:40:29 INFO Epoch 049 | 75% complete (batch 136/181)
2025-12-24 09:40:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.692903
2025-12-24 09:40:43 INFO Tuning ranking metrics: regret=0.103135 spearman=0.110262 (groups=34, skipped=318)
2025-12-24 09:40:43 INFO Epoch 049 | train_mse=0.077648 | val_loss=0.056097 | best_val_loss=0.135924
2025-12-24 09:40:51 INFO Epoch 050 | 25% complete (batch 46/181)
2025-12-24 09:40:52 INFO Epoch 050 | 50% complete (batch 91/181)
2025-12-24 09:40:53 INFO Epoch 050 | 75% complete (batch 136/181)
2025-12-24 09:41:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.700741
2025-12-24 09:41:06 INFO Tuning ranking metrics: regret=0.119333 spearman=0.104889 (groups=34, skipped=318)
2025-12-24 09:41:06 INFO Epoch 050 | train_mse=0.082649 | val_loss=0.058907 | best_val_loss=0.135924
2025-12-24 09:41:14 INFO Epoch 051 | 25% complete (batch 46/181)
2025-12-24 09:41:15 INFO Epoch 051 | 50% complete (batch 91/181)
2025-12-24 09:41:16 INFO Epoch 051 | 75% complete (batch 136/181)
2025-12-24 09:41:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.704062
2025-12-24 09:41:30 INFO Tuning ranking metrics: regret=0.103755 spearman=0.100382 (groups=34, skipped=318)
2025-12-24 09:41:30 INFO Epoch 051 | train_mse=0.060189 | val_loss=0.056089 | best_val_loss=0.135924
2025-12-24 09:41:38 INFO Epoch 052 | 25% complete (batch 46/181)
2025-12-24 09:41:39 INFO Epoch 052 | 50% complete (batch 91/181)
2025-12-24 09:41:40 INFO Epoch 052 | 75% complete (batch 136/181)
2025-12-24 09:41:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.719514
2025-12-24 09:41:54 INFO Tuning ranking metrics: regret=0.119454 spearman=0.105730 (groups=34, skipped=318)
2025-12-24 09:41:54 INFO Epoch 052 | train_mse=0.070029 | val_loss=0.054167 | best_val_loss=0.135924
2025-12-24 09:42:02 INFO Epoch 053 | 25% complete (batch 46/181)
2025-12-24 09:42:03 INFO Epoch 053 | 50% complete (batch 91/181)
2025-12-24 09:42:04 INFO Epoch 053 | 75% complete (batch 136/181)
2025-12-24 09:42:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.722139
2025-12-24 09:42:17 INFO Tuning ranking metrics: regret=0.119454 spearman=0.096416 (groups=34, skipped=318)
2025-12-24 09:42:17 INFO Epoch 053 | train_mse=0.065586 | val_loss=0.055567 | best_val_loss=0.135924
2025-12-24 09:42:25 INFO Epoch 054 | 25% complete (batch 46/181)
2025-12-24 09:42:26 INFO Epoch 054 | 50% complete (batch 91/181)
2025-12-24 09:42:27 INFO Epoch 054 | 75% complete (batch 136/181)
2025-12-24 09:42:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.719910
2025-12-24 09:42:41 INFO Tuning ranking metrics: regret=0.118418 spearman=0.104291 (groups=34, skipped=318)
2025-12-24 09:42:41 INFO Epoch 054 | train_mse=0.059412 | val_loss=0.056522 | best_val_loss=0.135924
2025-12-24 09:42:49 INFO Epoch 055 | 25% complete (batch 46/181)
2025-12-24 09:42:50 INFO Epoch 055 | 50% complete (batch 91/181)
2025-12-24 09:42:51 INFO Epoch 055 | 75% complete (batch 136/181)
2025-12-24 09:42:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.711995
2025-12-24 09:43:04 INFO Tuning ranking metrics: regret=0.102718 spearman=0.119035 (groups=34, skipped=318)
2025-12-24 09:43:04 INFO Epoch 055 | train_mse=0.051803 | val_loss=0.057914 | best_val_loss=0.135924
2025-12-24 09:43:13 INFO Epoch 056 | 25% complete (batch 46/181)
2025-12-24 09:43:14 INFO Epoch 056 | 50% complete (batch 91/181)
2025-12-24 09:43:15 INFO Epoch 056 | 75% complete (batch 136/181)
2025-12-24 09:43:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.717855
2025-12-24 09:43:28 INFO Tuning ranking metrics: regret=0.102748 spearman=0.064617 (groups=34, skipped=318)
2025-12-24 09:43:28 INFO Epoch 056 | train_mse=0.062383 | val_loss=0.055173 | best_val_loss=0.135924
2025-12-24 09:43:36 INFO Epoch 057 | 25% complete (batch 46/181)
2025-12-24 09:43:37 INFO Epoch 057 | 50% complete (batch 91/181)
2025-12-24 09:43:38 INFO Epoch 057 | 75% complete (batch 136/181)
2025-12-24 09:43:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.716889
2025-12-24 09:43:51 INFO Tuning ranking metrics: regret=0.075004 spearman=0.066017 (groups=34, skipped=318)
2025-12-24 09:43:51 INFO Epoch 057 | train_mse=0.059755 | val_loss=0.054898 | best_val_loss=0.135924
2025-12-24 09:43:59 INFO Epoch 058 | 25% complete (batch 46/181)
2025-12-24 09:44:01 INFO Epoch 058 | 50% complete (batch 91/181)
2025-12-24 09:44:02 INFO Epoch 058 | 75% complete (batch 136/181)
2025-12-24 09:44:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.717035
2025-12-24 09:44:15 INFO Tuning ranking metrics: regret=0.075004 spearman=0.079348 (groups=34, skipped=318)
2025-12-24 09:44:15 INFO Epoch 058 | train_mse=0.065488 | val_loss=0.054064 | best_val_loss=0.135924
Monitored metric tuning_rank_spearman did not improve in the last 24 records. Best score: 0.136. Signaling Trainer to stop.
2025-12-24 09:44:16 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.12464_val-0.07173_epoch035.chkpt, checkpoint.tuning_rank_spearman-0.12716_val-0.05685_epoch046.chkpt, checkpoint.tuning_rank_spearman-0.13592_val-0.06217_epoch034.chkpt
2025-12-24 09:44:16 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-24_09-20-56/model_checkpoints/checkpoint.tuning_rank_spearman-0.13592_val-0.06217_epoch034.chkpt
2025-12-24 09:44:16 INFO Best validation loss: tensor(0.1359)
2025-12-24 09:44:16 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-24_09-20-56/model_checkpoints/checkpoint.tuning_rank_spearman-0.13592_val-0.06217_epoch034.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-24_09-20-56/model_checkpoints/checkpoint.tuning_rank_spearman-0.13592_val-0.06217_epoch034.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-24 09:44:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.062169
2025-12-24 09:44:28 INFO Tuning ranking metrics: regret=0.099561 spearman=0.135924 (groups=34, skipped=318)
2025-12-24 09:44:28 INFO Epoch 059 | val_loss=0.062169 | best_val_loss=0.135924
2025-12-24 09:44:29 INFO Validation metrics: [{'val_loss': 0.06216904893517494, 'tuning_rank_regret': 0.09956128895282745, 'tuning_rank_spearman': 0.13592436909675598, 'val_pearson_corr': 0.7473069429397583, 'val_spearman_corr': 0.7221388220787048, 'val_rank_regret': 0.0035356476437300444, 'val_rank_spearman': 0.6666666865348816}]
2025-12-24 09:44:29 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.13592_val-0.06217_epoch034.chkpt
2025-12-24 09:44:29 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.12464_val-0.07173_epoch035.chkpt
2025-12-24 09:44:29 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.12716_val-0.05685_epoch046.chkpt
2025-12-24 09:44:29 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.06638_epoch030.ckpt
2025-12-24 09:44:29 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.09956128895282745
  tuning_rank_spearman      0.13592436909675598
        val_loss            0.06216904893517494
    val_pearson_corr        0.7473069429397583
     val_rank_regret       0.0035356476437300444
    val_rank_spearman       0.6666666865348816
    val_spearman_corr       0.7221388220787048
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run sched_boost_lr035_lean_seed222_2025-12-24_09-20-56 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-24_09-20-56
[train_cli][batch] job 'sched_boost_lr035_lean_seed222' finished.
[train_cli][batch] (3/3) running job 'large_batch_sched_boost_lean_seed222' -> run_name=large_batch_sched_boost_lean_seed222_2025-12-24_09-44-32
[train_cli] run_id=large_batch_sched_boost_lean_seed222_2025-12-24_09-44-32 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-24_09-44-32/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-24_09-44-32 --git-commit 94c0e71caa --git-dirty
2025-12-24 09:44:35 INFO git_commit = 94c0e71caa (dirty)
2025-12-24 09:44:35 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-24 09:44:35 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-24_09-44-32/config/config.yaml
2025-12-24 09:44:35 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data
2025-12-24 09:44:35 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-24 09:44:35 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-24 09:44:35 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-24_09-44-32
2025-12-24 09:44:35 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-24 09:44:35 INFO   metadata_path = None
2025-12-24 09:44:35 INFO   summary_path = None
2025-12-24 09:44:35 INFO   accelerator = cpu
2025-12-24 09:44:35 INFO   devices = 1
2025-12-24 09:44:35 INFO   attention_head = 8
2025-12-24 09:44:35 INFO   pooling_type = mean
2025-12-24 09:44:35 INFO   model_self_loops = False
2025-12-24 09:44:35 INFO   model_self_loop_fill = mean
2025-12-24 09:44:35 INFO   model_residual = False
2025-12-24 09:44:35 INFO   batch_size = 48
2025-12-24 09:44:35 INFO   learning_rate = 0.004
2025-12-24 09:44:35 INFO   num_epochs = 120
2025-12-24 09:44:35 INFO   accumulate_grad_batches = 8
2025-12-24 09:44:35 INFO   seed = 222
2025-12-24 09:44:35 INFO   num_workers = 2
2025-12-24 09:44:35 INFO   precision = 32
2025-12-24 09:44:35 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-24 09:44:35 INFO   early_stopping_patience = 20
2025-12-24 09:44:35 INFO   lr_scheduler_patience = 5
2025-12-24 09:44:35 INFO   lr_scheduler_factor = 0.2
2025-12-24 09:44:35 INFO   fast_dev_run = False
2025-12-24 09:44:35 INFO   limit_train_batches = None
2025-12-24 09:44:35 INFO   limit_val_batches = None
2025-12-24 09:44:35 INFO   log_lr = False
2025-12-24 09:44:35 INFO   progress_bar_refresh_rate = 0
2025-12-24 09:44:35 INFO   log_every_n_steps = 100
2025-12-24 09:44:35 INFO   use_val_spearman_as_secondary = True
2025-12-24 09:44:35 INFO   spearman_secondary_min_delta = 0.0
2025-12-24 09:44:35 INFO   spearman_secondary_weight = 1.0
2025-12-24 09:44:35 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-24 09:44:35 INFO   tuning_max_samples = 500
2025-12-24 09:44:35 INFO   tuning_fraction = None
2025-12-24 09:44:35 INFO   tuning_eval_every = 1
2025-12-24 09:44:35 INFO   rank_loss_weight = 0.0
2025-12-24 09:44:35 INFO   rank_loss_margin = 0.0
2025-12-24 09:44:35 INFO   rank_loss_mode = hinge
2025-12-24 09:44:35 INFO   rank_loss_grouped = True
2025-12-24 09:44:35 INFO   variance_reduction_enabled = False
2025-12-24 09:44:35 INFO   variance_reduction_method = topk_avg
2025-12-24 09:44:35 INFO   variance_reduction_top_k = 3
2025-12-24 09:44:35 INFO   coverage_minimum = 0.0
2025-12-24 09:44:35 INFO   coverage_fail_on_missing = False
2025-12-24 09:44:35 INFO   graph_load_profiling = False
2025-12-24 09:44:35 INFO   graph_load_top_k = 5
2025-12-24 09:44:35 INFO   enable_graph_cache = True
2025-12-24 09:44:35 INFO   graph_cache_size = 256
2025-12-24 09:44:35 INFO   canonicalize_on_load = False
2025-12-24 09:44:35 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-24 09:44:35 INFO   edge_schema = {}
2025-12-24 09:44:35 INFO   topology_schema = {}
Seed set to 222
2025-12-24 09:44:35 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-24 09:44:35 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 09:44:35 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-24 09:44:35 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 09:44:35 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-24 09:44:35 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 09:44:37 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-24 09:44:37 INFO Tuning group stats: groups=352 groups>=2=34 singletons=318 max_group=11
2025-12-24 09:44:37 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-24_09-44-32/dataset_coverage.json
2025-12-24 09:44:37 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-24_09-44-32/dataset_coverage.json for details.
2025-12-24 09:44:37 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-24_09-44-32/dataset_coverage.json for details.
2025-12-24 09:44:37 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-24_09-44-32/dataset_coverage.json for details.
2025-12-24 09:44:37 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-24_09-44-32/schema_summary.json
2025-12-24 09:44:37 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-24_09-44-32/feature_metadata.json
2025-12-24 09:44:37 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-24 09:44:37 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/advanced_k_partite_v2/feature-config.yaml.advanced_lean.10A.v2, sha256=2022a36e7b21668173af3af66c25cf6b6a0494e642c0934eac38abbcfeebec3d
2025-12-24 09:44:37 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/work/edge_features)
2025-12-24 09:44:37 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json
2025-12-24 09:44:37 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-24_09-44-32/schema_summary.json
2025-12-24 09:44:37 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-24 09:44:37 INFO Topology: topology/persistence_k_partite_advanced/v2 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 628-dimensional node features.
2025-12-24 09:44:37 INFO Node: node/dssp_topo_merge_passthrough/v1; metadata lists 628 feature columns matching the .pt tensor.
2025-12-24 09:44:37 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-24 09:44:37 INFO → Total feature dimensionality observed and confirmed: node_dim = 628, edge_dim = 11.
2025-12-24 09:44:37 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-24 09:44:37 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 628,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge_passthrough/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 628,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-24_09-44-32/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge_passthrough/v1",
      "alias": "Passthrough (all dims from topology module) = Node Dynamic Dims",
      "jobs": 16,
      "summary": "DSSP/basic features merged with all topology columns (passthrough)."
    },
    "topology": {
      "id": "topology/persistence_k_partite_advanced/v2",
      "alias": "Advanced k-partite PH (v2 lean) topo_dim 596",
      "jobs": 16,
      "summary": "Fixed-width k-partite persistent homology with slot padding + missingness channels."
    }
  },
  "notes": []
}
2025-12-24 09:44:37 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-24 09:44:37 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=967bc7b5cd45474cb43714695092c701)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-24 09:44:37 INFO Starting training (fast_dev_run=False)
2025-12-24 09:44:37 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-24_09-44-32/model_checkpoints exists and is not empty.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 20.1 K | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
180 K     Trainable params
0         Non-trainable params
180 K     Total params
0.721     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-24 09:44:52 INFO Epoch 000 | 25% complete (batch 46/181)
2025-12-24 09:44:52 INFO Epoch 000 | 50% complete (batch 91/181)
2025-12-24 09:44:53 INFO Epoch 000 | 75% complete (batch 136/181)
2025-12-24 09:45:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.140548
2025-12-24 09:45:06 INFO Tuning ranking metrics: regret=0.154321 spearman=-0.080042 (groups=34, skipped=318)
2025-12-24 09:45:06 INFO Epoch 000 | val_loss=0.140548
Metric tuning_rank_spearman improved. New best score: -0.080
2025-12-24 09:45:15 INFO Epoch 001 | 25% complete (batch 46/181)
2025-12-24 09:45:16 INFO Epoch 001 | 50% complete (batch 91/181)
2025-12-24 09:45:17 INFO Epoch 001 | 75% complete (batch 136/181)
2025-12-24 09:45:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.008335
2025-12-24 09:45:30 INFO Tuning ranking metrics: regret=0.155838 spearman=-0.133321 (groups=34, skipped=318)
2025-12-24 09:45:30 INFO Epoch 001 | train_mse=0.155692 | val_loss=0.140593 | best_val_loss=-0.080042
2025-12-24 09:45:38 INFO Epoch 002 | 25% complete (batch 46/181)
2025-12-24 09:45:39 INFO Epoch 002 | 50% complete (batch 91/181)
2025-12-24 09:45:40 INFO Epoch 002 | 75% complete (batch 136/181)
2025-12-24 09:45:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.082728
2025-12-24 09:45:54 INFO Tuning ranking metrics: regret=0.148687 spearman=-0.065177 (groups=34, skipped=318)
2025-12-24 09:45:54 INFO Epoch 002 | train_mse=0.152486 | val_loss=0.140475 | best_val_loss=-0.080042
Metric tuning_rank_spearman improved by 0.015 >= min_delta = 0.0. New best score: -0.065
2025-12-24 09:46:02 INFO Epoch 003 | 25% complete (batch 46/181)
2025-12-24 09:46:03 INFO Epoch 003 | 50% complete (batch 91/181)
2025-12-24 09:46:04 INFO Epoch 003 | 75% complete (batch 136/181)
2025-12-24 09:46:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.327114
2025-12-24 09:46:17 INFO Tuning ranking metrics: regret=0.153304 spearman=0.128727 (groups=34, skipped=318)
2025-12-24 09:46:17 INFO Epoch 003 | train_mse=0.137339 | val_loss=0.140613 | best_val_loss=-0.065177
Metric tuning_rank_spearman improved by 0.194 >= min_delta = 0.0. New best score: 0.129
2025-12-24 09:46:25 INFO Epoch 004 | 25% complete (batch 46/181)
2025-12-24 09:46:26 INFO Epoch 004 | 50% complete (batch 91/181)
2025-12-24 09:46:27 INFO Epoch 004 | 75% complete (batch 136/181)
2025-12-24 09:46:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.140699
2025-12-24 09:46:40 INFO Tuning ranking metrics: regret=0.148503 spearman=-0.114801 (groups=34, skipped=318)
2025-12-24 09:46:40 INFO Epoch 004 | train_mse=0.139568 | val_loss=0.140699 | best_val_loss=0.128727
2025-12-24 09:46:49 INFO Epoch 005 | 25% complete (batch 46/181)
2025-12-24 09:46:50 INFO Epoch 005 | 50% complete (batch 91/181)
2025-12-24 09:46:51 INFO Epoch 005 | 75% complete (batch 136/181)
2025-12-24 09:46:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.360607
2025-12-24 09:47:04 INFO Tuning ranking metrics: regret=0.129622 spearman=-0.025452 (groups=34, skipped=318)
2025-12-24 09:47:04 INFO Epoch 005 | train_mse=0.152798 | val_loss=0.140319 | best_val_loss=0.128727
2025-12-24 09:47:12 INFO Epoch 006 | 25% complete (batch 46/181)
2025-12-24 09:47:13 INFO Epoch 006 | 50% complete (batch 91/181)
2025-12-24 09:47:14 INFO Epoch 006 | 75% complete (batch 136/181)
2025-12-24 09:47:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.356683
2025-12-24 09:47:28 INFO Tuning ranking metrics: regret=0.131587 spearman=-0.053107 (groups=34, skipped=318)
2025-12-24 09:47:28 INFO Epoch 006 | train_mse=0.142284 | val_loss=0.138794 | best_val_loss=0.128727
2025-12-24 09:47:36 INFO Epoch 007 | 25% complete (batch 46/181)
2025-12-24 09:47:37 INFO Epoch 007 | 50% complete (batch 91/181)
2025-12-24 09:47:38 INFO Epoch 007 | 75% complete (batch 136/181)
2025-12-24 09:47:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.389463
2025-12-24 09:47:51 INFO Tuning ranking metrics: regret=0.127348 spearman=-0.014770 (groups=34, skipped=318)
2025-12-24 09:47:51 INFO Epoch 007 | train_mse=0.141589 | val_loss=0.142550 | best_val_loss=0.128727
2025-12-24 09:48:00 INFO Epoch 008 | 25% complete (batch 46/181)
2025-12-24 09:48:00 INFO Epoch 008 | 50% complete (batch 91/181)
2025-12-24 09:48:01 INFO Epoch 008 | 75% complete (batch 136/181)
2025-12-24 09:48:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.289996
2025-12-24 09:48:14 INFO Tuning ranking metrics: regret=0.147906 spearman=-0.063783 (groups=34, skipped=318)
2025-12-24 09:48:14 INFO Epoch 008 | train_mse=0.158155 | val_loss=0.123589 | best_val_loss=0.128727
2025-12-24 09:48:23 INFO Epoch 009 | 25% complete (batch 46/181)
2025-12-24 09:48:23 INFO Epoch 009 | 50% complete (batch 91/181)
2025-12-24 09:48:24 INFO Epoch 009 | 75% complete (batch 136/181)
2025-12-24 09:48:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.438973
2025-12-24 09:48:38 INFO Tuning ranking metrics: regret=0.136484 spearman=0.004876 (groups=34, skipped=318)
2025-12-24 09:48:38 INFO Epoch 009 | train_mse=0.145883 | val_loss=0.135009 | best_val_loss=0.128727
2025-12-24 09:48:46 INFO Epoch 010 | 25% complete (batch 46/181)
2025-12-24 09:48:47 INFO Epoch 010 | 50% complete (batch 91/181)
2025-12-24 09:48:48 INFO Epoch 010 | 75% complete (batch 136/181)
2025-12-24 09:48:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.336933
2025-12-24 09:49:01 INFO Tuning ranking metrics: regret=0.116340 spearman=-0.050936 (groups=34, skipped=318)
2025-12-24 09:49:01 INFO Epoch 010 | train_mse=0.143830 | val_loss=0.136679 | best_val_loss=0.128727
2025-12-24 09:49:09 INFO Epoch 011 | 25% complete (batch 46/181)
2025-12-24 09:49:10 INFO Epoch 011 | 50% complete (batch 91/181)
2025-12-24 09:49:11 INFO Epoch 011 | 75% complete (batch 136/181)
2025-12-24 09:49:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.142039
2025-12-24 09:49:24 INFO Tuning ranking metrics: regret=0.150713 spearman=-0.107436 (groups=34, skipped=318)
2025-12-24 09:49:24 INFO Epoch 011 | train_mse=0.133740 | val_loss=0.142039 | best_val_loss=0.128727
2025-12-24 09:49:32 INFO Epoch 012 | 25% complete (batch 46/181)
2025-12-24 09:49:33 INFO Epoch 012 | 50% complete (batch 91/181)
2025-12-24 09:49:34 INFO Epoch 012 | 75% complete (batch 136/181)
2025-12-24 09:49:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.136512
2025-12-24 09:49:47 INFO Tuning ranking metrics: regret=0.132328 spearman=-0.062529 (groups=34, skipped=318)
2025-12-24 09:49:47 INFO Epoch 012 | train_mse=0.155245 | val_loss=0.136512 | best_val_loss=0.128727
2025-12-24 09:49:56 INFO Epoch 013 | 25% complete (batch 46/181)
2025-12-24 09:49:57 INFO Epoch 013 | 50% complete (batch 91/181)
2025-12-24 09:49:58 INFO Epoch 013 | 75% complete (batch 136/181)
2025-12-24 09:50:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.428070
2025-12-24 09:50:11 INFO Tuning ranking metrics: regret=0.130573 spearman=0.123685 (groups=34, skipped=318)
2025-12-24 09:50:11 INFO Epoch 013 | train_mse=0.145607 | val_loss=0.134293 | best_val_loss=0.128727
2025-12-24 09:50:19 INFO Epoch 014 | 25% complete (batch 46/181)
2025-12-24 09:50:20 INFO Epoch 014 | 50% complete (batch 91/181)
2025-12-24 09:50:21 INFO Epoch 014 | 75% complete (batch 136/181)
2025-12-24 09:50:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.005542
2025-12-24 09:50:35 INFO Tuning ranking metrics: regret=0.118302 spearman=-0.020741 (groups=34, skipped=318)
2025-12-24 09:50:35 INFO Epoch 014 | train_mse=0.151452 | val_loss=0.134936 | best_val_loss=0.128727
2025-12-24 09:50:43 INFO Epoch 015 | 25% complete (batch 46/181)
2025-12-24 09:50:44 INFO Epoch 015 | 50% complete (batch 91/181)
2025-12-24 09:50:45 INFO Epoch 015 | 75% complete (batch 136/181)
2025-12-24 09:50:53 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.455373
2025-12-24 09:50:58 INFO Tuning ranking metrics: regret=0.118302 spearman=-0.025974 (groups=34, skipped=318)
2025-12-24 09:50:58 INFO Epoch 015 | train_mse=0.131522 | val_loss=0.133867 | best_val_loss=0.128727
2025-12-24 09:51:06 INFO Epoch 016 | 25% complete (batch 46/181)
2025-12-24 09:51:07 INFO Epoch 016 | 50% complete (batch 91/181)
2025-12-24 09:51:08 INFO Epoch 016 | 75% complete (batch 136/181)
2025-12-24 09:51:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.449223
2025-12-24 09:51:22 INFO Tuning ranking metrics: regret=0.110432 spearman=-0.015183 (groups=34, skipped=318)
2025-12-24 09:51:22 INFO Epoch 016 | train_mse=0.146222 | val_loss=0.133008 | best_val_loss=0.128727
2025-12-24 09:51:30 INFO Epoch 017 | 25% complete (batch 46/181)
2025-12-24 09:51:31 INFO Epoch 017 | 50% complete (batch 91/181)
2025-12-24 09:51:32 INFO Epoch 017 | 75% complete (batch 136/181)
2025-12-24 09:51:40 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.436464
2025-12-24 09:51:45 INFO Tuning ranking metrics: regret=0.125814 spearman=-0.020365 (groups=34, skipped=318)
2025-12-24 09:51:45 INFO Epoch 017 | train_mse=0.137407 | val_loss=0.127223 | best_val_loss=0.128727
2025-12-24 09:51:54 INFO Epoch 018 | 25% complete (batch 46/181)
2025-12-24 09:51:55 INFO Epoch 018 | 50% complete (batch 91/181)
2025-12-24 09:51:56 INFO Epoch 018 | 75% complete (batch 136/181)
2025-12-24 09:52:04 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.435011
2025-12-24 09:52:09 INFO Tuning ranking metrics: regret=0.126712 spearman=0.031016 (groups=34, skipped=318)
2025-12-24 09:52:09 INFO Epoch 018 | train_mse=0.130622 | val_loss=0.108739 | best_val_loss=0.128727
2025-12-24 09:52:17 INFO Epoch 019 | 25% complete (batch 46/181)
2025-12-24 09:52:18 INFO Epoch 019 | 50% complete (batch 91/181)
2025-12-24 09:52:19 INFO Epoch 019 | 75% complete (batch 136/181)
2025-12-24 09:52:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.423017
2025-12-24 09:52:33 INFO Tuning ranking metrics: regret=0.126542 spearman=0.024694 (groups=34, skipped=318)
2025-12-24 09:52:33 INFO Epoch 019 | train_mse=0.114579 | val_loss=0.142732 | best_val_loss=0.128727
2025-12-24 09:52:41 INFO Epoch 020 | 25% complete (batch 46/181)
2025-12-24 09:52:42 INFO Epoch 020 | 50% complete (batch 91/181)
2025-12-24 09:52:43 INFO Epoch 020 | 75% complete (batch 136/181)
