Skipped Validating graphs using standalone tool ...
Starting model training ...
[run_full_pipeline] Validating graphs before training...
[validate_graphs] OK: validated 14391 graph(s) in /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data
[run_full_pipeline] Starting sweep at 2025-12-21T23:19:33.995848+00:00 using manifest /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/manifests/run_lean.yaml
[train_cli][batch] (1/3) running job 'sched_boost_lean_seed222' -> run_name=sched_boost_lean_seed222_2025-12-21_23-19-34
[train_cli] run_id=sched_boost_lean_seed222_2025-12-21_23-19-34 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-21_23-19-34/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-21_23-19-34 --git-commit cf515fb092 --git-dirty
2025-12-21 23:19:37 INFO git_commit = cf515fb092 (dirty)
2025-12-21 23:19:37 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-21 23:19:37 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-21_23-19-34/config/config.yaml
2025-12-21 23:19:37 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data
2025-12-21 23:19:37 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-21 23:19:37 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-21 23:19:37 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-21_23-19-34
2025-12-21 23:19:37 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-21 23:19:37 INFO   metadata_path = None
2025-12-21 23:19:37 INFO   summary_path = None
2025-12-21 23:19:37 INFO   accelerator = cpu
2025-12-21 23:19:37 INFO   devices = 1
2025-12-21 23:19:37 INFO   attention_head = 8
2025-12-21 23:19:37 INFO   pooling_type = mean
2025-12-21 23:19:37 INFO   model_self_loops = False
2025-12-21 23:19:37 INFO   model_self_loop_fill = mean
2025-12-21 23:19:37 INFO   model_residual = False
2025-12-21 23:19:37 INFO   batch_size = 16
2025-12-21 23:19:37 INFO   learning_rate = 0.005
2025-12-21 23:19:37 INFO   num_epochs = 140
2025-12-21 23:19:37 INFO   accumulate_grad_batches = 16
2025-12-21 23:19:37 INFO   seed = 222
2025-12-21 23:19:37 INFO   num_workers = 0
2025-12-21 23:19:37 INFO   precision = 32
2025-12-21 23:19:37 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-21 23:19:37 INFO   early_stopping_patience = 24
2025-12-21 23:19:37 INFO   lr_scheduler_patience = 6
2025-12-21 23:19:37 INFO   lr_scheduler_factor = 0.2
2025-12-21 23:19:37 INFO   fast_dev_run = False
2025-12-21 23:19:37 INFO   limit_train_batches = None
2025-12-21 23:19:37 INFO   limit_val_batches = None
2025-12-21 23:19:37 INFO   log_lr = False
2025-12-21 23:19:37 INFO   progress_bar_refresh_rate = 0
2025-12-21 23:19:37 INFO   log_every_n_steps = 100
2025-12-21 23:19:37 INFO   use_val_spearman_as_secondary = True
2025-12-21 23:19:37 INFO   spearman_secondary_min_delta = 0.0
2025-12-21 23:19:37 INFO   spearman_secondary_weight = 1.0
2025-12-21 23:19:37 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-21 23:19:37 INFO   tuning_max_samples = 500
2025-12-21 23:19:37 INFO   tuning_fraction = None
2025-12-21 23:19:37 INFO   tuning_eval_every = 1
2025-12-21 23:19:37 INFO   rank_loss_weight = 0.0
2025-12-21 23:19:37 INFO   rank_loss_margin = 0.0
2025-12-21 23:19:37 INFO   rank_loss_mode = hinge
2025-12-21 23:19:37 INFO   rank_loss_grouped = True
2025-12-21 23:19:37 INFO   variance_reduction_enabled = False
2025-12-21 23:19:37 INFO   variance_reduction_method = topk_avg
2025-12-21 23:19:37 INFO   variance_reduction_top_k = 3
2025-12-21 23:19:37 INFO   coverage_minimum = 0.0
2025-12-21 23:19:37 INFO   coverage_fail_on_missing = False
2025-12-21 23:19:37 INFO   graph_load_profiling = False
2025-12-21 23:19:37 INFO   graph_load_top_k = 5
2025-12-21 23:19:37 INFO   enable_graph_cache = True
2025-12-21 23:19:37 INFO   graph_cache_size = 256
2025-12-21 23:19:37 INFO   canonicalize_on_load = False
2025-12-21 23:19:37 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-21 23:19:37 INFO   edge_schema = {}
2025-12-21 23:19:37 INFO   topology_schema = {}
Seed set to 222
2025-12-21 23:19:37 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-21 23:19:37 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-21 23:19:37 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-21 23:19:37 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-21 23:19:37 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-21 23:19:37 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-21 23:19:38 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-21 23:19:38 INFO Tuning group stats: groups=352 groups>=2=34 singletons=318 max_group=11
2025-12-21 23:19:38 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-21_23-19-34/dataset_coverage.json
2025-12-21 23:19:38 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-21_23-19-34/dataset_coverage.json for details.
2025-12-21 23:19:38 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-21_23-19-34/dataset_coverage.json for details.
2025-12-21 23:19:38 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-21_23-19-34/dataset_coverage.json for details.
2025-12-21 23:19:38 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-21_23-19-34/schema_summary.json
2025-12-21 23:19:38 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-21_23-19-34/feature_metadata.json
2025-12-21 23:19:38 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-21 23:19:38 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/feature-config.yaml.topoqa.10A.2, sha256=5c62898155179232a565e24d9fbd7b208f9ce480d1a19d6139de19454e173ff0
2025-12-21 23:19:38 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/work/edge_features)
2025-12-21 23:19:38 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json
2025-12-21 23:19:38 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-21_23-19-34/schema_summary.json
2025-12-21 23:19:38 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-21 23:19:38 INFO Topology: topology/persistence_basic/v1 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 172-dimensional node features.
2025-12-21 23:19:38 INFO Node: node/dssp_topo_merge/v1; metadata lists 172 feature columns matching the .pt tensor.
2025-12-21 23:19:38 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-21 23:19:38 INFO → Total feature dimensionality observed and confirmed: node_dim = 172, edge_dim = 11.
2025-12-21 23:19:38 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-21 23:19:38 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 172,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 172,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-21_23-19-34/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge/v1",
      "alias": "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA",
      "jobs": 16,
      "summary": "DSSP-derived node features merged with topology statistics."
    },
    "topology": {
      "id": "topology/persistence_basic/v1",
      "alias": "Betti 0 and Betti 1 topology summaries on interface coords = 140D PH | TopoQA",
      "jobs": 16,
      "summary": "Persistent homology features with configurable distance thresholds."
    }
  },
  "notes": []
}
2025-12-21 23:19:38 INFO DataLoader num_workers=0 (recommended for macOS to avoid spawn issues; configurable via config.yaml -> num_workers).
2025-12-21 23:19:38 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=7347e3c184b24cb19c6890e48188b29e)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-21 23:19:38 INFO Starting training (fast_dev_run=False)
2025-12-21 23:19:38 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-21_23-19-34/model_checkpoints exists and is not empty.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 5.5 K  | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
165 K     Trainable params
0         Non-trainable params
165 K     Total params
0.662     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
2025-12-21 23:19:41 INFO Epoch 000 | 25% complete (batch 136/543)
2025-12-21 23:19:43 INFO Epoch 000 | 50% complete (batch 272/543)
2025-12-21 23:19:46 INFO Epoch 000 | 75% complete (batch 408/543)
2025-12-21 23:19:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.139539
2025-12-21 23:19:52 INFO Tuning ranking metrics: regret=0.166140 spearman=-0.195314 (groups=34, skipped=318)
2025-12-21 23:19:52 INFO Epoch 000 | val_loss=0.139539
Metric tuning_rank_spearman improved. New best score: -0.195
2025-12-21 23:19:55 INFO Epoch 001 | 25% complete (batch 136/543)
2025-12-21 23:19:58 INFO Epoch 001 | 50% complete (batch 272/543)
2025-12-21 23:20:00 INFO Epoch 001 | 75% complete (batch 408/543)
2025-12-21 23:20:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.234815
2025-12-21 23:20:07 INFO Tuning ranking metrics: regret=0.174374 spearman=-0.160772 (groups=34, skipped=318)
2025-12-21 23:20:07 INFO Epoch 001 | train_mse=0.152096 | val_loss=0.148148 | best_val_loss=-0.195314
Metric tuning_rank_spearman improved by 0.035 >= min_delta = 0.0. New best score: -0.161
2025-12-21 23:20:10 INFO Epoch 002 | 25% complete (batch 136/543)
2025-12-21 23:20:12 INFO Epoch 002 | 50% complete (batch 272/543)
2025-12-21 23:20:15 INFO Epoch 002 | 75% complete (batch 408/543)
2025-12-21 23:20:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.253736
2025-12-21 23:20:21 INFO Tuning ranking metrics: regret=0.137610 spearman=-0.140152 (groups=34, skipped=318)
2025-12-21 23:20:21 INFO Epoch 002 | train_mse=0.145658 | val_loss=0.140574 | best_val_loss=-0.160772
Metric tuning_rank_spearman improved by 0.021 >= min_delta = 0.0. New best score: -0.140
2025-12-21 23:20:23 INFO Epoch 003 | 25% complete (batch 136/543)
2025-12-21 23:20:26 INFO Epoch 003 | 50% complete (batch 272/543)
2025-12-21 23:20:28 INFO Epoch 003 | 75% complete (batch 408/543)
2025-12-21 23:20:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.295379
2025-12-21 23:20:35 INFO Tuning ranking metrics: regret=0.138591 spearman=-0.039343 (groups=34, skipped=318)
2025-12-21 23:20:35 INFO Epoch 003 | train_mse=0.148312 | val_loss=0.148478 | best_val_loss=-0.140152
Metric tuning_rank_spearman improved by 0.101 >= min_delta = 0.0. New best score: -0.039
2025-12-21 23:20:37 INFO Epoch 004 | 25% complete (batch 136/543)
2025-12-21 23:20:39 INFO Epoch 004 | 50% complete (batch 272/543)
2025-12-21 23:20:42 INFO Epoch 004 | 75% complete (batch 408/543)
2025-12-21 23:20:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.312244
2025-12-21 23:20:48 INFO Tuning ranking metrics: regret=0.148975 spearman=-0.010250 (groups=34, skipped=318)
2025-12-21 23:20:48 INFO Epoch 004 | train_mse=0.139759 | val_loss=0.182349 | best_val_loss=-0.039343
Metric tuning_rank_spearman improved by 0.029 >= min_delta = 0.0. New best score: -0.010
2025-12-21 23:20:51 INFO Epoch 005 | 25% complete (batch 136/543)
2025-12-21 23:20:53 INFO Epoch 005 | 50% complete (batch 272/543)
2025-12-21 23:20:56 INFO Epoch 005 | 75% complete (batch 408/543)
2025-12-21 23:21:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.477428
2025-12-21 23:21:02 INFO Tuning ranking metrics: regret=0.149645 spearman=0.001190 (groups=34, skipped=318)
2025-12-21 23:21:02 INFO Epoch 005 | train_mse=0.133266 | val_loss=0.088803 | best_val_loss=-0.010250
Metric tuning_rank_spearman improved by 0.011 >= min_delta = 0.0. New best score: 0.001
2025-12-21 23:21:05 INFO Epoch 006 | 25% complete (batch 136/543)
2025-12-21 23:21:07 INFO Epoch 006 | 50% complete (batch 272/543)
2025-12-21 23:21:10 INFO Epoch 006 | 75% complete (batch 408/543)
2025-12-21 23:21:15 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.439022
2025-12-21 23:21:17 INFO Tuning ranking metrics: regret=0.135779 spearman=0.030971 (groups=34, skipped=318)
2025-12-21 23:21:17 INFO Epoch 006 | train_mse=0.106410 | val_loss=0.108448 | best_val_loss=0.001190
Metric tuning_rank_spearman improved by 0.030 >= min_delta = 0.0. New best score: 0.031
2025-12-21 23:21:19 INFO Epoch 007 | 25% complete (batch 136/543)
2025-12-21 23:21:22 INFO Epoch 007 | 50% complete (batch 272/543)
2025-12-21 23:21:24 INFO Epoch 007 | 75% complete (batch 408/543)
2025-12-21 23:21:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.475413
2025-12-21 23:21:30 INFO Tuning ranking metrics: regret=0.111660 spearman=0.017984 (groups=34, skipped=318)
2025-12-21 23:21:30 INFO Epoch 007 | train_mse=0.102399 | val_loss=0.114451 | best_val_loss=0.030971
2025-12-21 23:21:33 INFO Epoch 008 | 25% complete (batch 136/543)
2025-12-21 23:21:35 INFO Epoch 008 | 50% complete (batch 272/543)
2025-12-21 23:21:38 INFO Epoch 008 | 75% complete (batch 408/543)
2025-12-21 23:21:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.508164
2025-12-21 23:21:44 INFO Tuning ranking metrics: regret=0.110640 spearman=-0.010358 (groups=34, skipped=318)
2025-12-21 23:21:44 INFO Epoch 008 | train_mse=0.100189 | val_loss=0.093826 | best_val_loss=0.030971
2025-12-21 23:21:47 INFO Epoch 009 | 25% complete (batch 136/543)
2025-12-21 23:21:49 INFO Epoch 009 | 50% complete (batch 272/543)
2025-12-21 23:21:52 INFO Epoch 009 | 75% complete (batch 408/543)
2025-12-21 23:21:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.551082
2025-12-21 23:21:58 INFO Tuning ranking metrics: regret=0.090738 spearman=0.024987 (groups=34, skipped=318)
2025-12-21 23:21:58 INFO Epoch 009 | train_mse=0.101813 | val_loss=0.092369 | best_val_loss=0.030971
2025-12-21 23:22:01 INFO Epoch 010 | 25% complete (batch 136/543)
2025-12-21 23:22:03 INFO Epoch 010 | 50% complete (batch 272/543)
2025-12-21 23:22:06 INFO Epoch 010 | 75% complete (batch 408/543)
2025-12-21 23:22:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.511477
2025-12-21 23:22:12 INFO Tuning ranking metrics: regret=0.078242 spearman=-0.021581 (groups=34, skipped=318)
2025-12-21 23:22:12 INFO Epoch 010 | train_mse=0.099910 | val_loss=0.070745 | best_val_loss=0.030971
2025-12-21 23:22:15 INFO Epoch 011 | 25% complete (batch 136/543)
2025-12-21 23:22:17 INFO Epoch 011 | 50% complete (batch 272/543)
2025-12-21 23:22:20 INFO Epoch 011 | 75% complete (batch 408/543)
2025-12-21 23:22:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.548416
2025-12-21 23:22:27 INFO Tuning ranking metrics: regret=0.074534 spearman=0.040533 (groups=34, skipped=318)
2025-12-21 23:22:27 INFO Epoch 011 | train_mse=0.102979 | val_loss=0.072587 | best_val_loss=0.030971
Metric tuning_rank_spearman improved by 0.010 >= min_delta = 0.0. New best score: 0.041
2025-12-21 23:22:29 INFO Epoch 012 | 25% complete (batch 136/543)
2025-12-21 23:22:32 INFO Epoch 012 | 50% complete (batch 272/543)
2025-12-21 23:22:35 INFO Epoch 012 | 75% complete (batch 408/543)
2025-12-21 23:22:40 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.554604
2025-12-21 23:22:41 INFO Tuning ranking metrics: regret=0.056669 spearman=0.070741 (groups=34, skipped=318)
2025-12-21 23:22:41 INFO Epoch 012 | train_mse=0.081439 | val_loss=0.072256 | best_val_loss=0.040533
Metric tuning_rank_spearman improved by 0.030 >= min_delta = 0.0. New best score: 0.071
2025-12-21 23:22:44 INFO Epoch 013 | 25% complete (batch 136/543)
2025-12-21 23:22:46 INFO Epoch 013 | 50% complete (batch 272/543)
2025-12-21 23:22:49 INFO Epoch 013 | 75% complete (batch 408/543)
2025-12-21 23:22:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.539495
2025-12-21 23:22:55 INFO Tuning ranking metrics: regret=0.105627 spearman=0.002012 (groups=34, skipped=318)
2025-12-21 23:22:55 INFO Epoch 013 | train_mse=0.083136 | val_loss=0.082308 | best_val_loss=0.070741
2025-12-21 23:22:58 INFO Epoch 014 | 25% complete (batch 136/543)
2025-12-21 23:23:00 INFO Epoch 014 | 50% complete (batch 272/543)
2025-12-21 23:23:03 INFO Epoch 014 | 75% complete (batch 408/543)
2025-12-21 23:23:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.561393
2025-12-21 23:23:09 INFO Tuning ranking metrics: regret=0.107211 spearman=0.070576 (groups=34, skipped=318)
2025-12-21 23:23:09 INFO Epoch 014 | train_mse=0.079190 | val_loss=0.071160 | best_val_loss=0.070741
2025-12-21 23:23:12 INFO Epoch 015 | 25% complete (batch 136/543)
2025-12-21 23:23:14 INFO Epoch 015 | 50% complete (batch 272/543)
2025-12-21 23:23:17 INFO Epoch 015 | 75% complete (batch 408/543)
2025-12-21 23:23:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.575961
2025-12-21 23:23:23 INFO Tuning ranking metrics: regret=0.089359 spearman=0.093838 (groups=34, skipped=318)
2025-12-21 23:23:23 INFO Epoch 015 | train_mse=0.092913 | val_loss=0.068616 | best_val_loss=0.070741
Metric tuning_rank_spearman improved by 0.023 >= min_delta = 0.0. New best score: 0.094
2025-12-21 23:23:26 INFO Epoch 016 | 25% complete (batch 136/543)
2025-12-21 23:23:29 INFO Epoch 016 | 50% complete (batch 272/543)
2025-12-21 23:23:31 INFO Epoch 016 | 75% complete (batch 408/543)
2025-12-21 23:23:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.558757
2025-12-21 23:23:38 INFO Tuning ranking metrics: regret=0.056956 spearman=0.066189 (groups=34, skipped=318)
2025-12-21 23:23:38 INFO Epoch 016 | train_mse=0.074248 | val_loss=0.094077 | best_val_loss=0.093838
2025-12-21 23:23:40 INFO Epoch 017 | 25% complete (batch 136/543)
2025-12-21 23:23:42 INFO Epoch 017 | 50% complete (batch 272/543)
2025-12-21 23:23:45 INFO Epoch 017 | 75% complete (batch 408/543)
2025-12-21 23:23:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.544984
2025-12-21 23:23:51 INFO Tuning ranking metrics: regret=0.088159 spearman=0.030233 (groups=34, skipped=318)
2025-12-21 23:23:51 INFO Epoch 017 | train_mse=0.085764 | val_loss=0.077958 | best_val_loss=0.093838
2025-12-21 23:23:54 INFO Epoch 018 | 25% complete (batch 136/543)
2025-12-21 23:23:56 INFO Epoch 018 | 50% complete (batch 272/543)
2025-12-21 23:23:59 INFO Epoch 018 | 75% complete (batch 408/543)
2025-12-21 23:24:04 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.574929
2025-12-21 23:24:05 INFO Tuning ranking metrics: regret=0.085635 spearman=0.048759 (groups=34, skipped=318)
2025-12-21 23:24:05 INFO Epoch 018 | train_mse=0.073416 | val_loss=0.066760 | best_val_loss=0.093838
2025-12-21 23:24:07 INFO Epoch 019 | 25% complete (batch 136/543)
2025-12-21 23:24:10 INFO Epoch 019 | 50% complete (batch 272/543)
2025-12-21 23:24:13 INFO Epoch 019 | 75% complete (batch 408/543)
2025-12-21 23:24:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.594649
2025-12-21 23:24:19 INFO Tuning ranking metrics: regret=0.075304 spearman=0.005539 (groups=34, skipped=318)
2025-12-21 23:24:19 INFO Epoch 019 | train_mse=0.071759 | val_loss=0.071681 | best_val_loss=0.093838
2025-12-21 23:24:22 INFO Epoch 020 | 25% complete (batch 136/543)
2025-12-21 23:24:24 INFO Epoch 020 | 50% complete (batch 272/543)
2025-12-21 23:24:27 INFO Epoch 020 | 75% complete (batch 408/543)
2025-12-21 23:24:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.569791
2025-12-21 23:24:33 INFO Tuning ranking metrics: regret=0.069700 spearman=0.102184 (groups=34, skipped=318)
2025-12-21 23:24:33 INFO Epoch 020 | train_mse=0.074372 | val_loss=0.074454 | best_val_loss=0.093838
Metric tuning_rank_spearman improved by 0.008 >= min_delta = 0.0. New best score: 0.102
2025-12-21 23:24:36 INFO Epoch 021 | 25% complete (batch 136/543)
2025-12-21 23:24:39 INFO Epoch 021 | 50% complete (batch 272/543)
2025-12-21 23:24:41 INFO Epoch 021 | 75% complete (batch 408/543)
2025-12-21 23:24:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.599827
2025-12-21 23:24:48 INFO Tuning ranking metrics: regret=0.073315 spearman=0.046327 (groups=34, skipped=318)
2025-12-21 23:24:48 INFO Epoch 021 | train_mse=0.073718 | val_loss=0.066001 | best_val_loss=0.102184
2025-12-21 23:24:50 INFO Epoch 022 | 25% complete (batch 136/543)
2025-12-21 23:24:53 INFO Epoch 022 | 50% complete (batch 272/543)
2025-12-21 23:24:56 INFO Epoch 022 | 75% complete (batch 408/543)
2025-12-21 23:25:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.594894
2025-12-21 23:25:02 INFO Tuning ranking metrics: regret=0.075211 spearman=-0.000726 (groups=34, skipped=318)
2025-12-21 23:25:02 INFO Epoch 022 | train_mse=0.067651 | val_loss=0.075934 | best_val_loss=0.102184
2025-12-21 23:25:05 INFO Epoch 023 | 25% complete (batch 136/543)
2025-12-21 23:25:07 INFO Epoch 023 | 50% complete (batch 272/543)
2025-12-21 23:25:10 INFO Epoch 023 | 75% complete (batch 408/543)
2025-12-21 23:25:15 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.608525
2025-12-21 23:25:16 INFO Tuning ranking metrics: regret=0.076414 spearman=0.038025 (groups=34, skipped=318)
2025-12-21 23:25:16 INFO Epoch 023 | train_mse=0.059147 | val_loss=0.073930 | best_val_loss=0.102184
2025-12-21 23:25:19 INFO Epoch 024 | 25% complete (batch 136/543)
2025-12-21 23:25:21 INFO Epoch 024 | 50% complete (batch 272/543)
2025-12-21 23:25:24 INFO Epoch 024 | 75% complete (batch 408/543)
2025-12-21 23:25:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.587739
2025-12-21 23:25:30 INFO Tuning ranking metrics: regret=0.076535 spearman=0.038974 (groups=34, skipped=318)
2025-12-21 23:25:30 INFO Epoch 024 | train_mse=0.077893 | val_loss=0.076561 | best_val_loss=0.102184
2025-12-21 23:25:33 INFO Epoch 025 | 25% complete (batch 136/543)
2025-12-21 23:25:35 INFO Epoch 025 | 50% complete (batch 272/543)
2025-12-21 23:25:38 INFO Epoch 025 | 75% complete (batch 408/543)
2025-12-21 23:25:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.623069
2025-12-21 23:25:44 INFO Tuning ranking metrics: regret=0.091626 spearman=0.041609 (groups=34, skipped=318)
2025-12-21 23:25:44 INFO Epoch 025 | train_mse=0.070801 | val_loss=0.063970 | best_val_loss=0.102184
2025-12-21 23:25:47 INFO Epoch 026 | 25% complete (batch 136/543)
2025-12-21 23:25:50 INFO Epoch 026 | 50% complete (batch 272/543)
2025-12-21 23:25:52 INFO Epoch 026 | 75% complete (batch 408/543)
2025-12-21 23:25:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.612643
2025-12-21 23:25:59 INFO Tuning ranking metrics: regret=0.078887 spearman=0.037930 (groups=34, skipped=318)
2025-12-21 23:25:59 INFO Epoch 026 | train_mse=0.069281 | val_loss=0.065481 | best_val_loss=0.102184
2025-12-21 23:26:01 INFO Epoch 027 | 25% complete (batch 136/543)
2025-12-21 23:26:04 INFO Epoch 027 | 50% complete (batch 272/543)
2025-12-21 23:26:07 INFO Epoch 027 | 75% complete (batch 408/543)
2025-12-21 23:26:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.597832
2025-12-21 23:26:13 INFO Tuning ranking metrics: regret=0.076662 spearman=0.053540 (groups=34, skipped=318)
2025-12-21 23:26:13 INFO Epoch 027 | train_mse=0.070705 | val_loss=0.066906 | best_val_loss=0.102184
2025-12-21 23:26:16 INFO Epoch 028 | 25% complete (batch 136/543)
2025-12-21 23:26:18 INFO Epoch 028 | 50% complete (batch 272/543)
2025-12-21 23:26:21 INFO Epoch 028 | 75% complete (batch 408/543)
2025-12-21 23:26:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.617543
2025-12-21 23:26:27 INFO Tuning ranking metrics: regret=0.087429 spearman=0.104444 (groups=34, skipped=318)
2025-12-21 23:26:27 INFO Epoch 028 | train_mse=0.061434 | val_loss=0.062000 | best_val_loss=0.102184
Metric tuning_rank_spearman improved by 0.002 >= min_delta = 0.0. New best score: 0.104
2025-12-21 23:26:29 INFO Epoch 029 | 25% complete (batch 136/543)
2025-12-21 23:26:32 INFO Epoch 029 | 50% complete (batch 272/543)
2025-12-21 23:26:34 INFO Epoch 029 | 75% complete (batch 408/543)
2025-12-21 23:26:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.596638
2025-12-21 23:26:40 INFO Tuning ranking metrics: regret=0.087500 spearman=0.066374 (groups=34, skipped=318)
2025-12-21 23:26:40 INFO Epoch 029 | train_mse=0.062933 | val_loss=0.088610 | best_val_loss=0.104444
2025-12-21 23:26:43 INFO Epoch 030 | 25% complete (batch 136/543)
2025-12-21 23:26:46 INFO Epoch 030 | 50% complete (batch 272/543)
2025-12-21 23:26:48 INFO Epoch 030 | 75% complete (batch 408/543)
2025-12-21 23:26:53 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.593185
2025-12-21 23:26:55 INFO Tuning ranking metrics: regret=0.099160 spearman=-0.050910 (groups=34, skipped=318)
2025-12-21 23:26:55 INFO Epoch 030 | train_mse=0.061437 | val_loss=0.073839 | best_val_loss=0.104444
2025-12-21 23:26:58 INFO Epoch 031 | 25% complete (batch 136/543)
2025-12-21 23:27:00 INFO Epoch 031 | 50% complete (batch 272/543)
2025-12-21 23:27:03 INFO Epoch 031 | 75% complete (batch 408/543)
2025-12-21 23:27:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.642004
2025-12-21 23:27:09 INFO Tuning ranking metrics: regret=0.092151 spearman=0.052260 (groups=34, skipped=318)
2025-12-21 23:27:09 INFO Epoch 031 | train_mse=0.056205 | val_loss=0.063353 | best_val_loss=0.104444
2025-12-21 23:27:12 INFO Epoch 032 | 25% complete (batch 136/543)
2025-12-21 23:27:14 INFO Epoch 032 | 50% complete (batch 272/543)
2025-12-21 23:27:17 INFO Epoch 032 | 75% complete (batch 408/543)
2025-12-21 23:27:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.615062
2025-12-21 23:27:23 INFO Tuning ranking metrics: regret=0.093360 spearman=0.065107 (groups=34, skipped=318)
2025-12-21 23:27:23 INFO Epoch 032 | train_mse=0.067584 | val_loss=0.068663 | best_val_loss=0.104444
2025-12-21 23:27:25 INFO Epoch 033 | 25% complete (batch 136/543)
2025-12-21 23:27:28 INFO Epoch 033 | 50% complete (batch 272/543)
2025-12-21 23:27:31 INFO Epoch 033 | 75% complete (batch 408/543)
2025-12-21 23:27:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.604937
2025-12-21 23:27:37 INFO Tuning ranking metrics: regret=0.111820 spearman=0.043214 (groups=34, skipped=318)
2025-12-21 23:27:37 INFO Epoch 033 | train_mse=0.072662 | val_loss=0.063389 | best_val_loss=0.104444
2025-12-21 23:27:40 INFO Epoch 034 | 25% complete (batch 136/543)
2025-12-21 23:27:42 INFO Epoch 034 | 50% complete (batch 272/543)
2025-12-21 23:27:45 INFO Epoch 034 | 75% complete (batch 408/543)
2025-12-21 23:27:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.577851
2025-12-21 23:27:51 INFO Tuning ranking metrics: regret=0.084700 spearman=0.107499 (groups=34, skipped=318)
2025-12-21 23:27:51 INFO Epoch 034 | train_mse=0.054991 | val_loss=0.094472 | best_val_loss=0.104444
Metric tuning_rank_spearman improved by 0.003 >= min_delta = 0.0. New best score: 0.107
2025-12-21 23:27:55 INFO Epoch 035 | 25% complete (batch 136/543)
2025-12-21 23:27:57 INFO Epoch 035 | 50% complete (batch 272/543)
2025-12-21 23:28:00 INFO Epoch 035 | 75% complete (batch 408/543)
2025-12-21 23:28:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.554475
2025-12-21 23:28:07 INFO Tuning ranking metrics: regret=0.098680 spearman=-0.018933 (groups=34, skipped=318)
2025-12-21 23:28:07 INFO Epoch 035 | train_mse=0.050773 | val_loss=0.123653 | best_val_loss=0.107499
2025-12-21 23:28:09 INFO Epoch 036 | 25% complete (batch 136/543)
2025-12-21 23:28:12 INFO Epoch 036 | 50% complete (batch 272/543)
2025-12-21 23:28:15 INFO Epoch 036 | 75% complete (batch 408/543)
2025-12-21 23:28:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.646271
2025-12-21 23:28:21 INFO Tuning ranking metrics: regret=0.096938 spearman=0.045601 (groups=34, skipped=318)
2025-12-21 23:28:21 INFO Epoch 036 | train_mse=0.073358 | val_loss=0.065611 | best_val_loss=0.107499
2025-12-21 23:28:24 INFO Epoch 037 | 25% complete (batch 136/543)
2025-12-21 23:28:26 INFO Epoch 037 | 50% complete (batch 272/543)
2025-12-21 23:28:29 INFO Epoch 037 | 75% complete (batch 408/543)
2025-12-21 23:28:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.632571
2025-12-21 23:28:35 INFO Tuning ranking metrics: regret=0.091138 spearman=0.099230 (groups=34, skipped=318)
2025-12-21 23:28:35 INFO Epoch 037 | train_mse=0.072834 | val_loss=0.064053 | best_val_loss=0.107499
2025-12-21 23:28:38 INFO Epoch 038 | 25% complete (batch 136/543)
2025-12-21 23:28:40 INFO Epoch 038 | 50% complete (batch 272/543)
2025-12-21 23:28:43 INFO Epoch 038 | 75% complete (batch 408/543)
2025-12-21 23:28:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.626746
2025-12-21 23:28:49 INFO Tuning ranking metrics: regret=0.097049 spearman=0.038776 (groups=34, skipped=318)
2025-12-21 23:28:49 INFO Epoch 038 | train_mse=0.056308 | val_loss=0.059091 | best_val_loss=0.107499
2025-12-21 23:28:52 INFO Epoch 039 | 25% complete (batch 136/543)
2025-12-21 23:28:54 INFO Epoch 039 | 50% complete (batch 272/543)
2025-12-21 23:28:57 INFO Epoch 039 | 75% complete (batch 408/543)
2025-12-21 23:29:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.628656
2025-12-21 23:29:03 INFO Tuning ranking metrics: regret=0.081238 spearman=0.046435 (groups=34, skipped=318)
2025-12-21 23:29:03 INFO Epoch 039 | train_mse=0.052743 | val_loss=0.066434 | best_val_loss=0.107499
2025-12-21 23:29:06 INFO Epoch 040 | 25% complete (batch 136/543)
2025-12-21 23:29:09 INFO Epoch 040 | 50% complete (batch 272/543)
2025-12-21 23:29:11 INFO Epoch 040 | 75% complete (batch 408/543)
2025-12-21 23:29:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.632829
2025-12-21 23:29:18 INFO Tuning ranking metrics: regret=0.096007 spearman=0.036510 (groups=34, skipped=318)
2025-12-21 23:29:18 INFO Epoch 040 | train_mse=0.050189 | val_loss=0.064053 | best_val_loss=0.107499
2025-12-21 23:29:20 INFO Epoch 041 | 25% complete (batch 136/543)
2025-12-21 23:29:23 INFO Epoch 041 | 50% complete (batch 272/543)
2025-12-21 23:29:26 INFO Epoch 041 | 75% complete (batch 408/543)
2025-12-21 23:29:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.643602
2025-12-21 23:29:32 INFO Tuning ranking metrics: regret=0.090331 spearman=0.082105 (groups=34, skipped=318)
2025-12-21 23:29:32 INFO Epoch 041 | train_mse=0.058471 | val_loss=0.060513 | best_val_loss=0.107499
2025-12-21 23:29:35 INFO Epoch 042 | 25% complete (batch 136/543)
2025-12-21 23:29:37 INFO Epoch 042 | 50% complete (batch 272/543)
2025-12-21 23:29:40 INFO Epoch 042 | 75% complete (batch 408/543)
2025-12-21 23:29:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.631798
2025-12-21 23:29:46 INFO Tuning ranking metrics: regret=0.090331 spearman=0.078400 (groups=34, skipped=318)
2025-12-21 23:29:46 INFO Epoch 042 | train_mse=0.049501 | val_loss=0.061230 | best_val_loss=0.107499
2025-12-21 23:29:49 INFO Epoch 043 | 25% complete (batch 136/543)
2025-12-21 23:29:51 INFO Epoch 043 | 50% complete (batch 272/543)
2025-12-21 23:29:54 INFO Epoch 043 | 75% complete (batch 408/543)
2025-12-21 23:29:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.634677
2025-12-21 23:30:00 INFO Tuning ranking metrics: regret=0.096007 spearman=0.036771 (groups=34, skipped=318)
2025-12-21 23:30:00 INFO Epoch 043 | train_mse=0.050530 | val_loss=0.056578 | best_val_loss=0.107499
2025-12-21 23:30:03 INFO Epoch 044 | 25% complete (batch 136/543)
2025-12-21 23:30:06 INFO Epoch 044 | 50% complete (batch 272/543)
2025-12-21 23:30:08 INFO Epoch 044 | 75% complete (batch 408/543)
2025-12-21 23:30:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.649187
2025-12-21 23:30:15 INFO Tuning ranking metrics: regret=0.096885 spearman=0.020576 (groups=34, skipped=318)
2025-12-21 23:30:15 INFO Epoch 044 | train_mse=0.054422 | val_loss=0.058270 | best_val_loss=0.107499
2025-12-21 23:30:18 INFO Epoch 045 | 25% complete (batch 136/543)
2025-12-21 23:30:20 INFO Epoch 045 | 50% complete (batch 272/543)
2025-12-21 23:30:23 INFO Epoch 045 | 75% complete (batch 408/543)
2025-12-21 23:30:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.641213
2025-12-21 23:30:29 INFO Tuning ranking metrics: regret=0.096828 spearman=0.037357 (groups=34, skipped=318)
2025-12-21 23:30:29 INFO Epoch 045 | train_mse=0.054849 | val_loss=0.056526 | best_val_loss=0.107499
2025-12-21 23:30:32 INFO Epoch 046 | 25% complete (batch 136/543)
2025-12-21 23:30:34 INFO Epoch 046 | 50% complete (batch 272/543)
2025-12-21 23:30:37 INFO Epoch 046 | 75% complete (batch 408/543)
2025-12-21 23:30:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.643118
2025-12-21 23:30:43 INFO Tuning ranking metrics: regret=0.081238 spearman=0.019722 (groups=34, skipped=318)
2025-12-21 23:30:43 INFO Epoch 046 | train_mse=0.057684 | val_loss=0.062111 | best_val_loss=0.107499
2025-12-21 23:30:46 INFO Epoch 047 | 25% complete (batch 136/543)
2025-12-21 23:30:48 INFO Epoch 047 | 50% complete (batch 272/543)
2025-12-21 23:30:51 INFO Epoch 047 | 75% complete (batch 408/543)
2025-12-21 23:30:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.641942
2025-12-21 23:30:57 INFO Tuning ranking metrics: regret=0.100514 spearman=0.022855 (groups=34, skipped=318)
2025-12-21 23:30:57 INFO Epoch 047 | train_mse=0.048428 | val_loss=0.059124 | best_val_loss=0.107499
2025-12-21 23:31:00 INFO Epoch 048 | 25% complete (batch 136/543)
2025-12-21 23:31:03 INFO Epoch 048 | 50% complete (batch 272/543)
2025-12-21 23:31:05 INFO Epoch 048 | 75% complete (batch 408/543)
2025-12-21 23:31:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.635614
2025-12-21 23:31:12 INFO Tuning ranking metrics: regret=0.101341 spearman=-0.021078 (groups=34, skipped=318)
2025-12-21 23:31:12 INFO Epoch 048 | train_mse=0.058720 | val_loss=0.061757 | best_val_loss=0.107499
2025-12-21 23:31:14 INFO Epoch 049 | 25% complete (batch 136/543)
2025-12-21 23:31:17 INFO Epoch 049 | 50% complete (batch 272/543)
2025-12-21 23:31:19 INFO Epoch 049 | 75% complete (batch 408/543)
2025-12-21 23:31:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.641972
2025-12-21 23:31:26 INFO Tuning ranking metrics: regret=0.114853 spearman=0.013834 (groups=34, skipped=318)
2025-12-21 23:31:26 INFO Epoch 049 | train_mse=0.061677 | val_loss=0.059389 | best_val_loss=0.107499
2025-12-21 23:31:29 INFO Epoch 050 | 25% complete (batch 136/543)
2025-12-21 23:31:31 INFO Epoch 050 | 50% complete (batch 272/543)
2025-12-21 23:31:34 INFO Epoch 050 | 75% complete (batch 408/543)
2025-12-21 23:31:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.656144
2025-12-21 23:31:41 INFO Tuning ranking metrics: regret=0.097940 spearman=0.030532 (groups=34, skipped=318)
2025-12-21 23:31:41 INFO Epoch 050 | train_mse=0.043864 | val_loss=0.056613 | best_val_loss=0.107499
2025-12-21 23:31:43 INFO Epoch 051 | 25% complete (batch 136/543)
2025-12-21 23:31:46 INFO Epoch 051 | 50% complete (batch 272/543)
2025-12-21 23:31:49 INFO Epoch 051 | 75% complete (batch 408/543)
2025-12-21 23:31:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.643815
2025-12-21 23:31:55 INFO Tuning ranking metrics: regret=0.090985 spearman=0.105227 (groups=34, skipped=318)
2025-12-21 23:31:55 INFO Epoch 051 | train_mse=0.049769 | val_loss=0.062834 | best_val_loss=0.107499
2025-12-21 23:31:58 INFO Epoch 052 | 25% complete (batch 136/543)
2025-12-21 23:32:00 INFO Epoch 052 | 50% complete (batch 272/543)
2025-12-21 23:32:03 INFO Epoch 052 | 75% complete (batch 408/543)
2025-12-21 23:32:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.628113
2025-12-21 23:32:10 INFO Tuning ranking metrics: regret=0.097123 spearman=0.020588 (groups=34, skipped=318)
2025-12-21 23:32:10 INFO Epoch 052 | train_mse=0.044195 | val_loss=0.056483 | best_val_loss=0.107499
2025-12-21 23:32:12 INFO Epoch 053 | 25% complete (batch 136/543)
2025-12-21 23:32:15 INFO Epoch 053 | 50% complete (batch 272/543)
2025-12-21 23:32:17 INFO Epoch 053 | 75% complete (batch 408/543)
2025-12-21 23:32:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.648001
2025-12-21 23:32:24 INFO Tuning ranking metrics: regret=0.098020 spearman=0.034874 (groups=34, skipped=318)
2025-12-21 23:32:24 INFO Epoch 053 | train_mse=0.049734 | val_loss=0.056826 | best_val_loss=0.107499
2025-12-21 23:32:27 INFO Epoch 054 | 25% complete (batch 136/543)
2025-12-21 23:32:29 INFO Epoch 054 | 50% complete (batch 272/543)
2025-12-21 23:32:32 INFO Epoch 054 | 75% complete (batch 408/543)
2025-12-21 23:32:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.642647
2025-12-21 23:32:39 INFO Tuning ranking metrics: regret=0.097996 spearman=0.021199 (groups=34, skipped=318)
2025-12-21 23:32:39 INFO Epoch 054 | train_mse=0.052818 | val_loss=0.057147 | best_val_loss=0.107499
2025-12-21 23:32:42 INFO Epoch 055 | 25% complete (batch 136/543)
2025-12-21 23:32:44 INFO Epoch 055 | 50% complete (batch 272/543)
2025-12-21 23:32:47 INFO Epoch 055 | 75% complete (batch 408/543)
2025-12-21 23:32:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.641355
2025-12-21 23:32:53 INFO Tuning ranking metrics: regret=0.080462 spearman=0.013732 (groups=34, skipped=318)
2025-12-21 23:32:53 INFO Epoch 055 | train_mse=0.045256 | val_loss=0.059719 | best_val_loss=0.107499
2025-12-21 23:32:56 INFO Epoch 056 | 25% complete (batch 136/543)
2025-12-21 23:32:58 INFO Epoch 056 | 50% complete (batch 272/543)
2025-12-21 23:33:01 INFO Epoch 056 | 75% complete (batch 408/543)
2025-12-21 23:33:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.640245
2025-12-21 23:33:07 INFO Tuning ranking metrics: regret=0.097910 spearman=0.053119 (groups=34, skipped=318)
2025-12-21 23:33:07 INFO Epoch 056 | train_mse=0.053381 | val_loss=0.059590 | best_val_loss=0.107499
2025-12-21 23:33:10 INFO Epoch 057 | 25% complete (batch 136/543)
2025-12-21 23:33:13 INFO Epoch 057 | 50% complete (batch 272/543)
2025-12-21 23:33:15 INFO Epoch 057 | 75% complete (batch 408/543)
2025-12-21 23:33:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.633167
2025-12-21 23:33:21 INFO Tuning ranking metrics: regret=0.096767 spearman=0.053336 (groups=34, skipped=318)
2025-12-21 23:33:21 INFO Epoch 057 | train_mse=0.048666 | val_loss=0.059835 | best_val_loss=0.107499
2025-12-21 23:33:24 INFO Epoch 058 | 25% complete (batch 136/543)
2025-12-21 23:33:27 INFO Epoch 058 | 50% complete (batch 272/543)
2025-12-21 23:33:29 INFO Epoch 058 | 75% complete (batch 408/543)
2025-12-21 23:33:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.632957
2025-12-21 23:33:36 INFO Tuning ranking metrics: regret=0.097354 spearman=0.066317 (groups=34, skipped=318)
2025-12-21 23:33:36 INFO Epoch 058 | train_mse=0.041942 | val_loss=0.060062 | best_val_loss=0.107499
Monitored metric tuning_rank_spearman did not improve in the last 24 records. Best score: 0.107. Signaling Trainer to stop.
2025-12-21 23:33:36 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.10444_val-0.06200_epoch028.chkpt, checkpoint.tuning_rank_spearman-0.10523_val-0.06283_epoch051.chkpt, checkpoint.tuning_rank_spearman-0.10750_val-0.09447_epoch034.chkpt
2025-12-21 23:33:36 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-21_23-19-34/model_checkpoints/checkpoint.tuning_rank_spearman-0.10750_val-0.09447_epoch034.chkpt
2025-12-21 23:33:36 INFO Best validation loss: tensor(0.1075)
2025-12-21 23:33:36 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-21_23-19-34/model_checkpoints/checkpoint.tuning_rank_spearman-0.10750_val-0.09447_epoch034.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-21_23-19-34/model_checkpoints/checkpoint.tuning_rank_spearman-0.10750_val-0.09447_epoch034.chkpt
2025-12-21 23:33:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.094472
2025-12-21 23:33:40 INFO Tuning ranking metrics: regret=0.084700 spearman=0.107499 (groups=34, skipped=318)
2025-12-21 23:33:40 INFO Epoch 059 | val_loss=0.094472 | best_val_loss=0.107499
2025-12-21 23:33:40 INFO Validation metrics: [{'val_loss': 0.0944717675447464, 'tuning_rank_regret': 0.08469998091459274, 'tuning_rank_spearman': 0.10749936103820801, 'val_pearson_corr': 0.6966742277145386, 'val_spearman_corr': 0.6781280040740967, 'val_rank_regret': 0.14884158968925476, 'val_rank_spearman': 0.10555555671453476}]
2025-12-21 23:33:40 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.10750_val-0.09447_epoch034.chkpt
2025-12-21 23:33:40 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.10444_val-0.06200_epoch028.chkpt
2025-12-21 23:33:40 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.10523_val-0.06283_epoch051.chkpt
2025-12-21 23:33:40 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.06200_epoch028.ckpt
2025-12-21 23:33:40 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
USING ADAM
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.08469998091459274
  tuning_rank_spearman      0.10749936103820801
        val_loss            0.0944717675447464
    val_pearson_corr        0.6966742277145386
     val_rank_regret        0.14884158968925476
    val_rank_spearman       0.10555555671453476
    val_spearman_corr       0.6781280040740967
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run sched_boost_lean_seed222_2025-12-21_23-19-34 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-21_23-19-34
[train_cli][batch] job 'sched_boost_lean_seed222' finished.
[train_cli][batch] (2/3) running job 'sched_boost_lr035_lean_seed222' -> run_name=sched_boost_lr035_lean_seed222_2025-12-21_23-33-41
[train_cli] run_id=sched_boost_lr035_lean_seed222_2025-12-21_23-33-41 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41 --git-commit cf515fb092 --git-dirty
2025-12-21 23:33:44 INFO git_commit = cf515fb092 (dirty)
2025-12-21 23:33:44 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-21 23:33:44 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41/config/config.yaml
2025-12-21 23:33:44 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data
2025-12-21 23:33:44 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-21 23:33:44 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-21 23:33:44 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41
2025-12-21 23:33:44 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-21 23:33:44 INFO   metadata_path = None
2025-12-21 23:33:44 INFO   summary_path = None
2025-12-21 23:33:44 INFO   accelerator = cpu
2025-12-21 23:33:44 INFO   devices = 1
2025-12-21 23:33:44 INFO   attention_head = 8
2025-12-21 23:33:44 INFO   pooling_type = mean
2025-12-21 23:33:44 INFO   model_self_loops = False
2025-12-21 23:33:44 INFO   model_self_loop_fill = mean
2025-12-21 23:33:44 INFO   model_residual = False
2025-12-21 23:33:44 INFO   batch_size = 16
2025-12-21 23:33:44 INFO   learning_rate = 0.0035
2025-12-21 23:33:44 INFO   num_epochs = 140
2025-12-21 23:33:44 INFO   accumulate_grad_batches = 16
2025-12-21 23:33:44 INFO   seed = 222
2025-12-21 23:33:44 INFO   num_workers = 0
2025-12-21 23:33:44 INFO   precision = 32
2025-12-21 23:33:44 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-21 23:33:44 INFO   early_stopping_patience = 24
2025-12-21 23:33:44 INFO   lr_scheduler_patience = 6
2025-12-21 23:33:44 INFO   lr_scheduler_factor = 0.2
2025-12-21 23:33:44 INFO   fast_dev_run = False
2025-12-21 23:33:44 INFO   limit_train_batches = None
2025-12-21 23:33:44 INFO   limit_val_batches = None
2025-12-21 23:33:44 INFO   log_lr = False
2025-12-21 23:33:44 INFO   progress_bar_refresh_rate = 0
2025-12-21 23:33:44 INFO   log_every_n_steps = 100
2025-12-21 23:33:44 INFO   use_val_spearman_as_secondary = True
2025-12-21 23:33:44 INFO   spearman_secondary_min_delta = 0.0
2025-12-21 23:33:44 INFO   spearman_secondary_weight = 1.0
2025-12-21 23:33:44 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-21 23:33:44 INFO   tuning_max_samples = 500
2025-12-21 23:33:44 INFO   tuning_fraction = None
2025-12-21 23:33:44 INFO   tuning_eval_every = 1
2025-12-21 23:33:44 INFO   rank_loss_weight = 0.0
2025-12-21 23:33:44 INFO   rank_loss_margin = 0.0
2025-12-21 23:33:44 INFO   rank_loss_mode = hinge
2025-12-21 23:33:44 INFO   rank_loss_grouped = True
2025-12-21 23:33:44 INFO   variance_reduction_enabled = False
2025-12-21 23:33:44 INFO   variance_reduction_method = topk_avg
2025-12-21 23:33:44 INFO   variance_reduction_top_k = 3
2025-12-21 23:33:44 INFO   coverage_minimum = 0.0
2025-12-21 23:33:44 INFO   coverage_fail_on_missing = False
2025-12-21 23:33:44 INFO   graph_load_profiling = False
2025-12-21 23:33:44 INFO   graph_load_top_k = 5
2025-12-21 23:33:44 INFO   enable_graph_cache = True
2025-12-21 23:33:44 INFO   graph_cache_size = 256
2025-12-21 23:33:44 INFO   canonicalize_on_load = False
2025-12-21 23:33:44 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-21 23:33:44 INFO   edge_schema = {}
2025-12-21 23:33:44 INFO   topology_schema = {}
Seed set to 222
2025-12-21 23:33:44 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-21 23:33:44 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-21 23:33:44 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-21 23:33:44 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-21 23:33:44 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-21 23:33:44 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-21 23:33:45 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-21 23:33:45 INFO Tuning group stats: groups=352 groups>=2=34 singletons=318 max_group=11
2025-12-21 23:33:45 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41/dataset_coverage.json
2025-12-21 23:33:45 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41/dataset_coverage.json for details.
2025-12-21 23:33:45 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41/dataset_coverage.json for details.
2025-12-21 23:33:45 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41/dataset_coverage.json for details.
2025-12-21 23:33:45 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41/schema_summary.json
2025-12-21 23:33:45 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41/feature_metadata.json
2025-12-21 23:33:45 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-21 23:33:45 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/feature-config.yaml.topoqa.10A.2, sha256=5c62898155179232a565e24d9fbd7b208f9ce480d1a19d6139de19454e173ff0
2025-12-21 23:33:45 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/work/edge_features)
2025-12-21 23:33:45 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json
2025-12-21 23:33:45 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41/schema_summary.json
2025-12-21 23:33:45 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-21 23:33:45 INFO Topology: topology/persistence_basic/v1 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 172-dimensional node features.
2025-12-21 23:33:45 INFO Node: node/dssp_topo_merge/v1; metadata lists 172 feature columns matching the .pt tensor.
2025-12-21 23:33:45 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-21 23:33:45 INFO → Total feature dimensionality observed and confirmed: node_dim = 172, edge_dim = 11.
2025-12-21 23:33:45 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-21 23:33:45 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 172,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 172,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge/v1",
      "alias": "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA",
      "jobs": 16,
      "summary": "DSSP-derived node features merged with topology statistics."
    },
    "topology": {
      "id": "topology/persistence_basic/v1",
      "alias": "Betti 0 and Betti 1 topology summaries on interface coords = 140D PH | TopoQA",
      "jobs": 16,
      "summary": "Persistent homology features with configurable distance thresholds."
    }
  },
  "notes": []
}
2025-12-21 23:33:45 INFO DataLoader num_workers=0 (recommended for macOS to avoid spawn issues; configurable via config.yaml -> num_workers).
2025-12-21 23:33:46 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=d69aa585b00d43a083ac156ac5cc1ac6)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-21 23:33:46 INFO Starting training (fast_dev_run=False)
2025-12-21 23:33:46 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41/model_checkpoints exists and is not empty.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 5.5 K  | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
165 K     Trainable params
0         Non-trainable params
165 K     Total params
0.662     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
2025-12-21 23:33:48 INFO Epoch 000 | 25% complete (batch 136/543)
2025-12-21 23:33:51 INFO Epoch 000 | 50% complete (batch 272/543)
2025-12-21 23:33:53 INFO Epoch 000 | 75% complete (batch 408/543)
2025-12-21 23:33:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.141051
2025-12-21 23:34:00 INFO Tuning ranking metrics: regret=0.153201 spearman=-0.196893 (groups=34, skipped=318)
2025-12-21 23:34:00 INFO Epoch 000 | val_loss=0.141051
Metric tuning_rank_spearman improved. New best score: -0.197
2025-12-21 23:34:02 INFO Epoch 001 | 25% complete (batch 136/543)
2025-12-21 23:34:05 INFO Epoch 001 | 50% complete (batch 272/543)
2025-12-21 23:34:07 INFO Epoch 001 | 75% complete (batch 408/543)
2025-12-21 23:34:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.039885
2025-12-21 23:34:14 INFO Tuning ranking metrics: regret=0.135661 spearman=-0.201808 (groups=34, skipped=318)
2025-12-21 23:34:14 INFO Epoch 001 | train_mse=0.152246 | val_loss=0.146405 | best_val_loss=-0.196893
2025-12-21 23:34:16 INFO Epoch 002 | 25% complete (batch 136/543)
2025-12-21 23:34:18 INFO Epoch 002 | 50% complete (batch 272/543)
2025-12-21 23:34:21 INFO Epoch 002 | 75% complete (batch 408/543)
2025-12-21 23:34:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.054672
2025-12-21 23:34:27 INFO Tuning ranking metrics: regret=0.134768 spearman=-0.121556 (groups=34, skipped=318)
2025-12-21 23:34:27 INFO Epoch 002 | train_mse=0.144005 | val_loss=0.141079 | best_val_loss=-0.196893
Metric tuning_rank_spearman improved by 0.075 >= min_delta = 0.0. New best score: -0.122
2025-12-21 23:34:29 INFO Epoch 003 | 25% complete (batch 136/543)
2025-12-21 23:34:32 INFO Epoch 003 | 50% complete (batch 272/543)
2025-12-21 23:34:34 INFO Epoch 003 | 75% complete (batch 408/543)
2025-12-21 23:34:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.303701
2025-12-21 23:34:40 INFO Tuning ranking metrics: regret=0.132137 spearman=-0.070760 (groups=34, skipped=318)
2025-12-21 23:34:40 INFO Epoch 003 | train_mse=0.148550 | val_loss=0.138805 | best_val_loss=-0.121556
Metric tuning_rank_spearman improved by 0.051 >= min_delta = 0.0. New best score: -0.071
2025-12-21 23:34:43 INFO Epoch 004 | 25% complete (batch 136/543)
2025-12-21 23:34:45 INFO Epoch 004 | 50% complete (batch 272/543)
2025-12-21 23:34:48 INFO Epoch 004 | 75% complete (batch 408/543)
2025-12-21 23:34:53 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.285989
2025-12-21 23:34:55 INFO Tuning ranking metrics: regret=0.174915 spearman=-0.170684 (groups=34, skipped=318)
2025-12-21 23:34:55 INFO Epoch 004 | train_mse=0.145678 | val_loss=0.088386 | best_val_loss=-0.070760
2025-12-21 23:34:57 INFO Epoch 005 | 25% complete (batch 136/543)
2025-12-21 23:35:00 INFO Epoch 005 | 50% complete (batch 272/543)
2025-12-21 23:35:02 INFO Epoch 005 | 75% complete (batch 408/543)
2025-12-21 23:35:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.471723
2025-12-21 23:35:08 INFO Tuning ranking metrics: regret=0.113782 spearman=-0.142927 (groups=34, skipped=318)
2025-12-21 23:35:08 INFO Epoch 005 | train_mse=0.121685 | val_loss=0.082735 | best_val_loss=-0.070760
2025-12-21 23:35:11 INFO Epoch 006 | 25% complete (batch 136/543)
2025-12-21 23:35:13 INFO Epoch 006 | 50% complete (batch 272/543)
2025-12-21 23:35:16 INFO Epoch 006 | 75% complete (batch 408/543)
2025-12-21 23:35:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.502584
2025-12-21 23:35:22 INFO Tuning ranking metrics: regret=0.108677 spearman=-0.077585 (groups=34, skipped=318)
2025-12-21 23:35:22 INFO Epoch 006 | train_mse=0.094944 | val_loss=0.081696 | best_val_loss=-0.070760
2025-12-21 23:35:25 INFO Epoch 007 | 25% complete (batch 136/543)
2025-12-21 23:35:27 INFO Epoch 007 | 50% complete (batch 272/543)
2025-12-21 23:35:29 INFO Epoch 007 | 75% complete (batch 408/543)
2025-12-21 23:35:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.490816
2025-12-21 23:35:36 INFO Tuning ranking metrics: regret=0.105001 spearman=0.008747 (groups=34, skipped=318)
2025-12-21 23:35:36 INFO Epoch 007 | train_mse=0.094332 | val_loss=0.109852 | best_val_loss=-0.070760
Metric tuning_rank_spearman improved by 0.080 >= min_delta = 0.0. New best score: 0.009
2025-12-21 23:35:38 INFO Epoch 008 | 25% complete (batch 136/543)
2025-12-21 23:35:41 INFO Epoch 008 | 50% complete (batch 272/543)
2025-12-21 23:35:43 INFO Epoch 008 | 75% complete (batch 408/543)
2025-12-21 23:35:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.513032
2025-12-21 23:35:50 INFO Tuning ranking metrics: regret=0.077745 spearman=0.000783 (groups=34, skipped=318)
2025-12-21 23:35:50 INFO Epoch 008 | train_mse=0.097331 | val_loss=0.107702 | best_val_loss=0.008747
2025-12-21 23:35:53 INFO Epoch 009 | 25% complete (batch 136/543)
2025-12-21 23:35:56 INFO Epoch 009 | 50% complete (batch 272/543)
2025-12-21 23:35:58 INFO Epoch 009 | 75% complete (batch 408/543)
2025-12-21 23:36:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.532637
2025-12-21 23:36:04 INFO Tuning ranking metrics: regret=0.056585 spearman=-0.010727 (groups=34, skipped=318)
2025-12-21 23:36:04 INFO Epoch 009 | train_mse=0.084409 | val_loss=0.079604 | best_val_loss=0.008747
2025-12-21 23:36:07 INFO Epoch 010 | 25% complete (batch 136/543)
2025-12-21 23:36:10 INFO Epoch 010 | 50% complete (batch 272/543)
2025-12-21 23:36:12 INFO Epoch 010 | 75% complete (batch 408/543)
2025-12-21 23:36:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.536965
2025-12-21 23:36:18 INFO Tuning ranking metrics: regret=0.088446 spearman=-0.072976 (groups=34, skipped=318)
2025-12-21 23:36:18 INFO Epoch 010 | train_mse=0.094971 | val_loss=0.079749 | best_val_loss=0.008747
2025-12-21 23:36:21 INFO Epoch 011 | 25% complete (batch 136/543)
2025-12-21 23:36:24 INFO Epoch 011 | 50% complete (batch 272/543)
2025-12-21 23:36:27 INFO Epoch 011 | 75% complete (batch 408/543)
2025-12-21 23:36:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.558881
2025-12-21 23:36:33 INFO Tuning ranking metrics: regret=0.081895 spearman=-0.030080 (groups=34, skipped=318)
2025-12-21 23:36:33 INFO Epoch 011 | train_mse=0.084865 | val_loss=0.075841 | best_val_loss=0.008747
2025-12-21 23:36:35 INFO Epoch 012 | 25% complete (batch 136/543)
2025-12-21 23:36:38 INFO Epoch 012 | 50% complete (batch 272/543)
2025-12-21 23:36:41 INFO Epoch 012 | 75% complete (batch 408/543)
2025-12-21 23:36:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.552896
2025-12-21 23:36:47 INFO Tuning ranking metrics: regret=0.089388 spearman=-0.110358 (groups=34, skipped=318)
2025-12-21 23:36:47 INFO Epoch 012 | train_mse=0.077027 | val_loss=0.078024 | best_val_loss=0.008747
2025-12-21 23:36:49 INFO Epoch 013 | 25% complete (batch 136/543)
2025-12-21 23:36:52 INFO Epoch 013 | 50% complete (batch 272/543)
2025-12-21 23:36:55 INFO Epoch 013 | 75% complete (batch 408/543)
2025-12-21 23:37:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.582073
2025-12-21 23:37:01 INFO Tuning ranking metrics: regret=0.088067 spearman=-0.037815 (groups=34, skipped=318)
2025-12-21 23:37:01 INFO Epoch 013 | train_mse=0.078935 | val_loss=0.070290 | best_val_loss=0.008747
2025-12-21 23:37:04 INFO Epoch 014 | 25% complete (batch 136/543)
2025-12-21 23:37:06 INFO Epoch 014 | 50% complete (batch 272/543)
2025-12-21 23:37:09 INFO Epoch 014 | 75% complete (batch 408/543)
2025-12-21 23:37:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.574205
2025-12-21 23:37:15 INFO Tuning ranking metrics: regret=0.085627 spearman=-0.012140 (groups=34, skipped=318)
2025-12-21 23:37:15 INFO Epoch 014 | train_mse=0.073826 | val_loss=0.066993 | best_val_loss=0.008747
2025-12-21 23:37:18 INFO Epoch 015 | 25% complete (batch 136/543)
2025-12-21 23:37:20 INFO Epoch 015 | 50% complete (batch 272/543)
2025-12-21 23:37:23 INFO Epoch 015 | 75% complete (batch 408/543)
2025-12-21 23:37:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.586341
2025-12-21 23:37:29 INFO Tuning ranking metrics: regret=0.090794 spearman=-0.044818 (groups=34, skipped=318)
2025-12-21 23:37:29 INFO Epoch 015 | train_mse=0.079029 | val_loss=0.069506 | best_val_loss=0.008747
2025-12-21 23:37:32 INFO Epoch 016 | 25% complete (batch 136/543)
2025-12-21 23:37:34 INFO Epoch 016 | 50% complete (batch 272/543)
2025-12-21 23:37:37 INFO Epoch 016 | 75% complete (batch 408/543)
2025-12-21 23:37:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.566072
2025-12-21 23:37:43 INFO Tuning ranking metrics: regret=0.087873 spearman=-0.005074 (groups=34, skipped=318)
2025-12-21 23:37:43 INFO Epoch 016 | train_mse=0.069692 | val_loss=0.082225 | best_val_loss=0.008747
2025-12-21 23:37:45 INFO Epoch 017 | 25% complete (batch 136/543)
2025-12-21 23:37:48 INFO Epoch 017 | 50% complete (batch 272/543)
2025-12-21 23:37:50 INFO Epoch 017 | 75% complete (batch 408/543)
2025-12-21 23:37:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.574916
2025-12-21 23:37:57 INFO Tuning ranking metrics: regret=0.089620 spearman=-0.051967 (groups=34, skipped=318)
2025-12-21 23:37:57 INFO Epoch 017 | train_mse=0.075556 | val_loss=0.082141 | best_val_loss=0.008747
2025-12-21 23:37:59 INFO Epoch 018 | 25% complete (batch 136/543)
2025-12-21 23:38:02 INFO Epoch 018 | 50% complete (batch 272/543)
2025-12-21 23:38:05 INFO Epoch 018 | 75% complete (batch 408/543)
2025-12-21 23:38:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.576188
2025-12-21 23:38:11 INFO Tuning ranking metrics: regret=0.090527 spearman=-0.112433 (groups=34, skipped=318)
2025-12-21 23:38:11 INFO Epoch 018 | train_mse=0.071318 | val_loss=0.065393 | best_val_loss=0.008747
2025-12-21 23:38:14 INFO Epoch 019 | 25% complete (batch 136/543)
2025-12-21 23:38:16 INFO Epoch 019 | 50% complete (batch 272/543)
2025-12-21 23:38:19 INFO Epoch 019 | 75% complete (batch 408/543)
2025-12-21 23:38:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.597279
2025-12-21 23:38:25 INFO Tuning ranking metrics: regret=0.092002 spearman=-0.068723 (groups=34, skipped=318)
2025-12-21 23:38:25 INFO Epoch 019 | train_mse=0.067414 | val_loss=0.066097 | best_val_loss=0.008747
2025-12-21 23:38:28 INFO Epoch 020 | 25% complete (batch 136/543)
2025-12-21 23:38:30 INFO Epoch 020 | 50% complete (batch 272/543)
2025-12-21 23:38:33 INFO Epoch 020 | 75% complete (batch 408/543)
2025-12-21 23:38:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.582723
2025-12-21 23:38:39 INFO Tuning ranking metrics: regret=0.090348 spearman=-0.044500 (groups=34, skipped=318)
2025-12-21 23:38:39 INFO Epoch 020 | train_mse=0.069168 | val_loss=0.069847 | best_val_loss=0.008747
2025-12-21 23:38:42 INFO Epoch 021 | 25% complete (batch 136/543)
2025-12-21 23:38:44 INFO Epoch 021 | 50% complete (batch 272/543)
2025-12-21 23:38:47 INFO Epoch 021 | 75% complete (batch 408/543)
2025-12-21 23:38:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.590366
2025-12-21 23:38:53 INFO Tuning ranking metrics: regret=0.086944 spearman=-0.031010 (groups=34, skipped=318)
2025-12-21 23:38:53 INFO Epoch 021 | train_mse=0.066660 | val_loss=0.067396 | best_val_loss=0.008747
2025-12-21 23:38:56 INFO Epoch 022 | 25% complete (batch 136/543)
2025-12-21 23:38:58 INFO Epoch 022 | 50% complete (batch 272/543)
2025-12-21 23:39:01 INFO Epoch 022 | 75% complete (batch 408/543)
2025-12-21 23:39:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.565161
2025-12-21 23:39:08 INFO Tuning ranking metrics: regret=0.093811 spearman=-0.047046 (groups=34, skipped=318)
2025-12-21 23:39:08 INFO Epoch 022 | train_mse=0.065921 | val_loss=0.093010 | best_val_loss=0.008747
2025-12-21 23:39:10 INFO Epoch 023 | 25% complete (batch 136/543)
2025-12-21 23:39:13 INFO Epoch 023 | 50% complete (batch 272/543)
2025-12-21 23:39:16 INFO Epoch 023 | 75% complete (batch 408/543)
2025-12-21 23:39:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.611467
2025-12-21 23:39:23 INFO Tuning ranking metrics: regret=0.089357 spearman=0.011905 (groups=34, skipped=318)
2025-12-21 23:39:23 INFO Epoch 023 | train_mse=0.068020 | val_loss=0.073055 | best_val_loss=0.008747
Metric tuning_rank_spearman improved by 0.003 >= min_delta = 0.0. New best score: 0.012
2025-12-21 23:39:25 INFO Epoch 024 | 25% complete (batch 136/543)
2025-12-21 23:39:28 INFO Epoch 024 | 50% complete (batch 272/543)
2025-12-21 23:39:30 INFO Epoch 024 | 75% complete (batch 408/543)
2025-12-21 23:39:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.599035
2025-12-21 23:39:37 INFO Tuning ranking metrics: regret=0.092290 spearman=-0.079068 (groups=34, skipped=318)
2025-12-21 23:39:37 INFO Epoch 024 | train_mse=0.089337 | val_loss=0.062852 | best_val_loss=0.011905
2025-12-21 23:39:39 INFO Epoch 025 | 25% complete (batch 136/543)
2025-12-21 23:39:42 INFO Epoch 025 | 50% complete (batch 272/543)
2025-12-21 23:39:44 INFO Epoch 025 | 75% complete (batch 408/543)
2025-12-21 23:39:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.617329
2025-12-21 23:39:50 INFO Tuning ranking metrics: regret=0.092335 spearman=-0.067380 (groups=34, skipped=318)
2025-12-21 23:39:50 INFO Epoch 025 | train_mse=0.065447 | val_loss=0.064742 | best_val_loss=0.011905
2025-12-21 23:39:53 INFO Epoch 026 | 25% complete (batch 136/543)
2025-12-21 23:39:56 INFO Epoch 026 | 50% complete (batch 272/543)
2025-12-21 23:39:58 INFO Epoch 026 | 75% complete (batch 408/543)
2025-12-21 23:40:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.613736
2025-12-21 23:40:05 INFO Tuning ranking metrics: regret=0.091173 spearman=-0.075433 (groups=34, skipped=318)
2025-12-21 23:40:05 INFO Epoch 026 | train_mse=0.069435 | val_loss=0.064077 | best_val_loss=0.011905
2025-12-21 23:40:07 INFO Epoch 027 | 25% complete (batch 136/543)
2025-12-21 23:40:10 INFO Epoch 027 | 50% complete (batch 272/543)
2025-12-21 23:40:13 INFO Epoch 027 | 75% complete (batch 408/543)
2025-12-21 23:40:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.618553
2025-12-21 23:40:19 INFO Tuning ranking metrics: regret=0.090359 spearman=-0.066584 (groups=34, skipped=318)
2025-12-21 23:40:19 INFO Epoch 027 | train_mse=0.065789 | val_loss=0.061058 | best_val_loss=0.011905
2025-12-21 23:40:23 INFO Epoch 028 | 25% complete (batch 136/543)
2025-12-21 23:40:25 INFO Epoch 028 | 50% complete (batch 272/543)
2025-12-21 23:40:28 INFO Epoch 028 | 75% complete (batch 408/543)
2025-12-21 23:40:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.603801
2025-12-21 23:40:34 INFO Tuning ranking metrics: regret=0.090787 spearman=-0.079055 (groups=34, skipped=318)
2025-12-21 23:40:34 INFO Epoch 028 | train_mse=0.056861 | val_loss=0.078574 | best_val_loss=0.011905
2025-12-21 23:40:36 INFO Epoch 029 | 25% complete (batch 136/543)
2025-12-21 23:40:39 INFO Epoch 029 | 50% complete (batch 272/543)
2025-12-21 23:40:42 INFO Epoch 029 | 75% complete (batch 408/543)
2025-12-21 23:40:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.647399
2025-12-21 23:40:48 INFO Tuning ranking metrics: regret=0.093793 spearman=-0.086071 (groups=34, skipped=318)
2025-12-21 23:40:48 INFO Epoch 029 | train_mse=0.062550 | val_loss=0.062181 | best_val_loss=0.011905
2025-12-21 23:40:51 INFO Epoch 030 | 25% complete (batch 136/543)
2025-12-21 23:40:53 INFO Epoch 030 | 50% complete (batch 272/543)
2025-12-21 23:40:56 INFO Epoch 030 | 75% complete (batch 408/543)
2025-12-21 23:41:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.638706
2025-12-21 23:41:02 INFO Tuning ranking metrics: regret=0.091947 spearman=-0.078062 (groups=34, skipped=318)
2025-12-21 23:41:02 INFO Epoch 030 | train_mse=0.065696 | val_loss=0.058148 | best_val_loss=0.011905
2025-12-21 23:41:05 INFO Epoch 031 | 25% complete (batch 136/543)
2025-12-21 23:41:07 INFO Epoch 031 | 50% complete (batch 272/543)
2025-12-21 23:41:10 INFO Epoch 031 | 75% complete (batch 408/543)
2025-12-21 23:41:15 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.640489
2025-12-21 23:41:17 INFO Tuning ranking metrics: regret=0.091723 spearman=-0.080844 (groups=34, skipped=318)
2025-12-21 23:41:17 INFO Epoch 031 | train_mse=0.050283 | val_loss=0.059986 | best_val_loss=0.011905
2025-12-21 23:41:19 INFO Epoch 032 | 25% complete (batch 136/543)
2025-12-21 23:41:22 INFO Epoch 032 | 50% complete (batch 272/543)
2025-12-21 23:41:25 INFO Epoch 032 | 75% complete (batch 408/543)
2025-12-21 23:41:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.638600
2025-12-21 23:41:31 INFO Tuning ranking metrics: regret=0.076270 spearman=-0.054087 (groups=34, skipped=318)
2025-12-21 23:41:31 INFO Epoch 032 | train_mse=0.057768 | val_loss=0.067574 | best_val_loss=0.011905
2025-12-21 23:41:34 INFO Epoch 033 | 25% complete (batch 136/543)
2025-12-21 23:41:36 INFO Epoch 033 | 50% complete (batch 272/543)
2025-12-21 23:41:39 INFO Epoch 033 | 75% complete (batch 408/543)
2025-12-21 23:41:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.625396
2025-12-21 23:41:46 INFO Tuning ranking metrics: regret=0.073956 spearman=-0.077368 (groups=34, skipped=318)
2025-12-21 23:41:46 INFO Epoch 033 | train_mse=0.066659 | val_loss=0.068181 | best_val_loss=0.011905
2025-12-21 23:41:49 INFO Epoch 034 | 25% complete (batch 136/543)
2025-12-21 23:41:51 INFO Epoch 034 | 50% complete (batch 272/543)
2025-12-21 23:41:55 INFO Epoch 034 | 75% complete (batch 408/543)
2025-12-21 23:42:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.625176
2025-12-21 23:42:01 INFO Tuning ranking metrics: regret=0.092564 spearman=-0.098650 (groups=34, skipped=318)
2025-12-21 23:42:01 INFO Epoch 034 | train_mse=0.053000 | val_loss=0.059895 | best_val_loss=0.011905
2025-12-21 23:42:04 INFO Epoch 035 | 25% complete (batch 136/543)
2025-12-21 23:42:07 INFO Epoch 035 | 50% complete (batch 272/543)
2025-12-21 23:42:10 INFO Epoch 035 | 75% complete (batch 408/543)
2025-12-21 23:42:15 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.603014
2025-12-21 23:42:16 INFO Tuning ranking metrics: regret=0.091460 spearman=-0.102897 (groups=34, skipped=318)
2025-12-21 23:42:16 INFO Epoch 035 | train_mse=0.056818 | val_loss=0.081892 | best_val_loss=0.011905
2025-12-21 23:42:19 INFO Epoch 036 | 25% complete (batch 136/543)
2025-12-21 23:42:22 INFO Epoch 036 | 50% complete (batch 272/543)
2025-12-21 23:42:24 INFO Epoch 036 | 75% complete (batch 408/543)
2025-12-21 23:42:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.628854
2025-12-21 23:42:30 INFO Tuning ranking metrics: regret=0.093106 spearman=-0.079138 (groups=34, skipped=318)
2025-12-21 23:42:30 INFO Epoch 036 | train_mse=0.068733 | val_loss=0.069314 | best_val_loss=0.011905
2025-12-21 23:42:33 INFO Epoch 037 | 25% complete (batch 136/543)
2025-12-21 23:42:36 INFO Epoch 037 | 50% complete (batch 272/543)
2025-12-21 23:42:39 INFO Epoch 037 | 75% complete (batch 408/543)
2025-12-21 23:42:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.641002
2025-12-21 23:42:46 INFO Tuning ranking metrics: regret=0.093402 spearman=-0.101859 (groups=34, skipped=318)
2025-12-21 23:42:46 INFO Epoch 037 | train_mse=0.064267 | val_loss=0.062537 | best_val_loss=0.011905
2025-12-21 23:42:49 INFO Epoch 038 | 25% complete (batch 136/543)
2025-12-21 23:42:51 INFO Epoch 038 | 50% complete (batch 272/543)
2025-12-21 23:42:54 INFO Epoch 038 | 75% complete (batch 408/543)
2025-12-21 23:42:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.645909
2025-12-21 23:43:00 INFO Tuning ranking metrics: regret=0.093402 spearman=-0.091367 (groups=34, skipped=318)
2025-12-21 23:43:00 INFO Epoch 038 | train_mse=0.065990 | val_loss=0.057049 | best_val_loss=0.011905
2025-12-21 23:43:03 INFO Epoch 039 | 25% complete (batch 136/543)
2025-12-21 23:43:05 INFO Epoch 039 | 50% complete (batch 272/543)
2025-12-21 23:43:08 INFO Epoch 039 | 75% complete (batch 408/543)
2025-12-21 23:43:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.644713
2025-12-21 23:43:14 INFO Tuning ranking metrics: regret=0.093402 spearman=-0.064184 (groups=34, skipped=318)
2025-12-21 23:43:14 INFO Epoch 039 | train_mse=0.052937 | val_loss=0.058703 | best_val_loss=0.011905
2025-12-21 23:43:17 INFO Epoch 040 | 25% complete (batch 136/543)
2025-12-21 23:43:19 INFO Epoch 040 | 50% complete (batch 272/543)
2025-12-21 23:43:22 INFO Epoch 040 | 75% complete (batch 408/543)
2025-12-21 23:43:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.637826
2025-12-21 23:43:29 INFO Tuning ranking metrics: regret=0.093402 spearman=-0.065852 (groups=34, skipped=318)
2025-12-21 23:43:29 INFO Epoch 040 | train_mse=0.048070 | val_loss=0.061645 | best_val_loss=0.011905
2025-12-21 23:43:31 INFO Epoch 041 | 25% complete (batch 136/543)
2025-12-21 23:43:34 INFO Epoch 041 | 50% complete (batch 272/543)
2025-12-21 23:43:36 INFO Epoch 041 | 75% complete (batch 408/543)
2025-12-21 23:43:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.638692
2025-12-21 23:43:43 INFO Tuning ranking metrics: regret=0.092901 spearman=-0.071155 (groups=34, skipped=318)
2025-12-21 23:43:43 INFO Epoch 041 | train_mse=0.054895 | val_loss=0.057429 | best_val_loss=0.011905
2025-12-21 23:43:45 INFO Epoch 042 | 25% complete (batch 136/543)
2025-12-21 23:43:48 INFO Epoch 042 | 50% complete (batch 272/543)
2025-12-21 23:43:51 INFO Epoch 042 | 75% complete (batch 408/543)
2025-12-21 23:43:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.635919
2025-12-21 23:43:57 INFO Tuning ranking metrics: regret=0.092743 spearman=-0.090903 (groups=34, skipped=318)
2025-12-21 23:43:57 INFO Epoch 042 | train_mse=0.049915 | val_loss=0.058414 | best_val_loss=0.011905
2025-12-21 23:44:00 INFO Epoch 043 | 25% complete (batch 136/543)
2025-12-21 23:44:03 INFO Epoch 043 | 50% complete (batch 272/543)
2025-12-21 23:44:05 INFO Epoch 043 | 75% complete (batch 408/543)
2025-12-21 23:44:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.639058
2025-12-21 23:44:12 INFO Tuning ranking metrics: regret=0.092901 spearman=-0.097135 (groups=34, skipped=318)
2025-12-21 23:44:12 INFO Epoch 043 | train_mse=0.049169 | val_loss=0.057581 | best_val_loss=0.011905
2025-12-21 23:44:14 INFO Epoch 044 | 25% complete (batch 136/543)
2025-12-21 23:44:17 INFO Epoch 044 | 50% complete (batch 272/543)
2025-12-21 23:44:19 INFO Epoch 044 | 75% complete (batch 408/543)
2025-12-21 23:44:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.641989
2025-12-21 23:44:26 INFO Tuning ranking metrics: regret=0.092901 spearman=-0.082047 (groups=34, skipped=318)
2025-12-21 23:44:26 INFO Epoch 044 | train_mse=0.052917 | val_loss=0.057064 | best_val_loss=0.011905
2025-12-21 23:44:29 INFO Epoch 045 | 25% complete (batch 136/543)
2025-12-21 23:44:31 INFO Epoch 045 | 50% complete (batch 272/543)
2025-12-21 23:44:34 INFO Epoch 045 | 75% complete (batch 408/543)
2025-12-21 23:44:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.640871
2025-12-21 23:44:41 INFO Tuning ranking metrics: regret=0.093447 spearman=-0.079832 (groups=34, skipped=318)
2025-12-21 23:44:41 INFO Epoch 045 | train_mse=0.049545 | val_loss=0.057021 | best_val_loss=0.011905
2025-12-21 23:44:44 INFO Epoch 046 | 25% complete (batch 136/543)
2025-12-21 23:44:47 INFO Epoch 046 | 50% complete (batch 272/543)
2025-12-21 23:44:49 INFO Epoch 046 | 75% complete (batch 408/543)
2025-12-21 23:44:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.643028
2025-12-21 23:44:56 INFO Tuning ranking metrics: regret=0.093560 spearman=-0.065196 (groups=34, skipped=318)
2025-12-21 23:44:56 INFO Epoch 046 | train_mse=0.058088 | val_loss=0.059871 | best_val_loss=0.011905
2025-12-21 23:44:58 INFO Epoch 047 | 25% complete (batch 136/543)
2025-12-21 23:45:01 INFO Epoch 047 | 50% complete (batch 272/543)
2025-12-21 23:45:03 INFO Epoch 047 | 75% complete (batch 408/543)
2025-12-21 23:45:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.649571
2025-12-21 23:45:10 INFO Tuning ranking metrics: regret=0.093560 spearman=-0.072651 (groups=34, skipped=318)
2025-12-21 23:45:10 INFO Epoch 047 | train_mse=0.044730 | val_loss=0.057218 | best_val_loss=0.011905
Monitored metric tuning_rank_spearman did not improve in the last 24 records. Best score: 0.012. Signaling Trainer to stop.
2025-12-21 23:45:10 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.00078_val-0.10770_epoch008.chkpt, checkpoint.tuning_rank_spearman-0.00875_val-0.10985_epoch007.chkpt, checkpoint.tuning_rank_spearman-0.01190_val-0.07305_epoch023.chkpt
2025-12-21 23:45:10 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41/model_checkpoints/checkpoint.tuning_rank_spearman-0.01190_val-0.07305_epoch023.chkpt
2025-12-21 23:45:10 INFO Best validation loss: tensor(0.0119)
2025-12-21 23:45:10 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41/model_checkpoints/checkpoint.tuning_rank_spearman-0.01190_val-0.07305_epoch023.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41/model_checkpoints/checkpoint.tuning_rank_spearman-0.01190_val-0.07305_epoch023.chkpt
2025-12-21 23:45:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.073055
2025-12-21 23:45:13 INFO Tuning ranking metrics: regret=0.089357 spearman=0.011905 (groups=34, skipped=318)
2025-12-21 23:45:13 INFO Epoch 048 | val_loss=0.073055 | best_val_loss=0.011905
2025-12-21 23:45:13 INFO Validation metrics: [{'val_loss': 0.07305458188056946, 'tuning_rank_regret': 0.08935677260160446, 'tuning_rank_spearman': 0.011904762126505375, 'val_pearson_corr': 0.722599983215332, 'val_spearman_corr': 0.6618870496749878, 'val_rank_regret': 0.13690908253192902, 'val_rank_spearman': 0.2706349194049835}]
2025-12-21 23:45:13 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.01190_val-0.07305_epoch023.chkpt
2025-12-21 23:45:13 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.00875_val-0.10985_epoch007.chkpt
2025-12-21 23:45:13 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.00078_val-0.10770_epoch008.chkpt
2025-12-21 23:45:13 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.06539_epoch018.ckpt
2025-12-21 23:45:13 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
USING ADAM
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.08935677260160446
  tuning_rank_spearman     0.011904762126505375
        val_loss            0.07305458188056946
    val_pearson_corr         0.722599983215332
     val_rank_regret        0.13690908253192902
    val_rank_spearman       0.2706349194049835
    val_spearman_corr       0.6618870496749878
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run sched_boost_lr035_lean_seed222_2025-12-21_23-33-41 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41
[train_cli][batch] job 'sched_boost_lr035_lean_seed222' finished.
[train_cli][batch] (3/3) running job 'large_batch_sched_boost_lean_seed222' -> run_name=large_batch_sched_boost_lean_seed222_2025-12-21_23-45-14
[train_cli] run_id=large_batch_sched_boost_lean_seed222_2025-12-21_23-45-14 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-21_23-45-14/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-21_23-45-14 --git-commit cf515fb092 --git-dirty
2025-12-21 23:45:17 INFO git_commit = cf515fb092 (dirty)
2025-12-21 23:45:17 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-21 23:45:17 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-21_23-45-14/config/config.yaml
2025-12-21 23:45:17 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data
2025-12-21 23:45:17 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-21 23:45:17 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-21 23:45:17 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-21_23-45-14
2025-12-21 23:45:17 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-21 23:45:17 INFO   metadata_path = None
2025-12-21 23:45:17 INFO   summary_path = None
2025-12-21 23:45:17 INFO   accelerator = cpu
2025-12-21 23:45:17 INFO   devices = 1
2025-12-21 23:45:17 INFO   attention_head = 8
2025-12-21 23:45:17 INFO   pooling_type = mean
2025-12-21 23:45:17 INFO   model_self_loops = False
2025-12-21 23:45:17 INFO   model_self_loop_fill = mean
2025-12-21 23:45:17 INFO   model_residual = False
2025-12-21 23:45:17 INFO   batch_size = 32
2025-12-21 23:45:17 INFO   learning_rate = 0.004
2025-12-21 23:45:17 INFO   num_epochs = 120
2025-12-21 23:45:17 INFO   accumulate_grad_batches = 8
2025-12-21 23:45:17 INFO   seed = 222
2025-12-21 23:45:17 INFO   num_workers = 0
2025-12-21 23:45:17 INFO   precision = 32
2025-12-21 23:45:17 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-21 23:45:17 INFO   early_stopping_patience = 20
2025-12-21 23:45:17 INFO   lr_scheduler_patience = 5
2025-12-21 23:45:17 INFO   lr_scheduler_factor = 0.2
2025-12-21 23:45:17 INFO   fast_dev_run = False
2025-12-21 23:45:17 INFO   limit_train_batches = None
2025-12-21 23:45:17 INFO   limit_val_batches = None
2025-12-21 23:45:17 INFO   log_lr = False
2025-12-21 23:45:17 INFO   progress_bar_refresh_rate = 0
2025-12-21 23:45:17 INFO   log_every_n_steps = 100
2025-12-21 23:45:17 INFO   use_val_spearman_as_secondary = True
2025-12-21 23:45:17 INFO   spearman_secondary_min_delta = 0.0
2025-12-21 23:45:17 INFO   spearman_secondary_weight = 1.0
2025-12-21 23:45:17 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-21 23:45:17 INFO   tuning_max_samples = 500
2025-12-21 23:45:17 INFO   tuning_fraction = None
2025-12-21 23:45:17 INFO   tuning_eval_every = 1
2025-12-21 23:45:17 INFO   rank_loss_weight = 0.0
2025-12-21 23:45:17 INFO   rank_loss_margin = 0.0
2025-12-21 23:45:17 INFO   rank_loss_mode = hinge
2025-12-21 23:45:17 INFO   rank_loss_grouped = True
2025-12-21 23:45:17 INFO   variance_reduction_enabled = False
2025-12-21 23:45:17 INFO   variance_reduction_method = topk_avg
2025-12-21 23:45:17 INFO   variance_reduction_top_k = 3
2025-12-21 23:45:17 INFO   coverage_minimum = 0.0
2025-12-21 23:45:17 INFO   coverage_fail_on_missing = False
2025-12-21 23:45:17 INFO   graph_load_profiling = False
2025-12-21 23:45:17 INFO   graph_load_top_k = 5
2025-12-21 23:45:17 INFO   enable_graph_cache = True
2025-12-21 23:45:17 INFO   graph_cache_size = 256
2025-12-21 23:45:17 INFO   canonicalize_on_load = False
2025-12-21 23:45:17 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-21 23:45:17 INFO   edge_schema = {}
2025-12-21 23:45:17 INFO   topology_schema = {}
Seed set to 222
2025-12-21 23:45:17 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-21 23:45:17 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-21 23:45:17 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-21 23:45:17 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-21 23:45:17 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-21 23:45:17 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-21 23:45:18 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-21 23:45:18 INFO Tuning group stats: groups=352 groups>=2=34 singletons=318 max_group=11
2025-12-21 23:45:18 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-21_23-45-14/dataset_coverage.json
2025-12-21 23:45:18 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-21_23-45-14/dataset_coverage.json for details.
2025-12-21 23:45:18 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-21_23-45-14/dataset_coverage.json for details.
2025-12-21 23:45:18 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-21_23-45-14/dataset_coverage.json for details.
2025-12-21 23:45:18 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-21_23-45-14/schema_summary.json
2025-12-21 23:45:18 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-21_23-45-14/feature_metadata.json
2025-12-21 23:45:18 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-21 23:45:18 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/feature-config.yaml.topoqa.10A.2, sha256=5c62898155179232a565e24d9fbd7b208f9ce480d1a19d6139de19454e173ff0
2025-12-21 23:45:18 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/work/edge_features)
2025-12-21 23:45:18 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json
2025-12-21 23:45:18 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-21_23-45-14/schema_summary.json
2025-12-21 23:45:18 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-21 23:45:18 INFO Topology: topology/persistence_basic/v1 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 172-dimensional node features.
2025-12-21 23:45:18 INFO Node: node/dssp_topo_merge/v1; metadata lists 172 feature columns matching the .pt tensor.
2025-12-21 23:45:18 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-21 23:45:18 INFO → Total feature dimensionality observed and confirmed: node_dim = 172, edge_dim = 11.
2025-12-21 23:45:18 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-21 23:45:18 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 172,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 172,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-21_23-45-14/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge/v1",
      "alias": "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA",
      "jobs": 16,
      "summary": "DSSP-derived node features merged with topology statistics."
    },
    "topology": {
      "id": "topology/persistence_basic/v1",
      "alias": "Betti 0 and Betti 1 topology summaries on interface coords = 140D PH | TopoQA",
      "jobs": 16,
      "summary": "Persistent homology features with configurable distance thresholds."
    }
  },
  "notes": []
}
2025-12-21 23:45:18 INFO DataLoader num_workers=0 (recommended for macOS to avoid spawn issues; configurable via config.yaml -> num_workers).
2025-12-21 23:45:18 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=094aa5723c5245439f283f76854027b3)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-21 23:45:19 INFO Starting training (fast_dev_run=False)
2025-12-21 23:45:19 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-21_23-45-14/model_checkpoints exists and is not empty.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 5.5 K  | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
165 K     Trainable params
0         Non-trainable params
165 K     Total params
0.662     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
2025-12-21 23:45:20 INFO Epoch 000 | 25% complete (batch 68/272)
2025-12-21 23:45:22 INFO Epoch 000 | 50% complete (batch 136/272)
2025-12-21 23:45:23 INFO Epoch 000 | 75% complete (batch 204/272)
2025-12-21 23:45:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.152843
2025-12-21 23:45:28 INFO Tuning ranking metrics: regret=0.182848 spearman=-0.223358 (groups=34, skipped=318)
2025-12-21 23:45:28 INFO Epoch 000 | val_loss=0.152843
Metric tuning_rank_spearman improved. New best score: -0.223
2025-12-21 23:45:30 INFO Epoch 001 | 25% complete (batch 68/272)
2025-12-21 23:45:31 INFO Epoch 001 | 50% complete (batch 136/272)
2025-12-21 23:45:33 INFO Epoch 001 | 75% complete (batch 204/272)
2025-12-21 23:45:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.075541
2025-12-21 23:45:38 INFO Tuning ranking metrics: regret=0.136929 spearman=-0.094302 (groups=34, skipped=318)
2025-12-21 23:45:38 INFO Epoch 001 | train_mse=0.151786 | val_loss=0.145311 | best_val_loss=-0.223358
Metric tuning_rank_spearman improved by 0.129 >= min_delta = 0.0. New best score: -0.094
2025-12-21 23:45:39 INFO Epoch 002 | 25% complete (batch 68/272)
2025-12-21 23:45:41 INFO Epoch 002 | 50% complete (batch 136/272)
2025-12-21 23:45:43 INFO Epoch 002 | 75% complete (batch 204/272)
2025-12-21 23:45:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.176882
2025-12-21 23:45:48 INFO Tuning ranking metrics: regret=0.157951 spearman=-0.166960 (groups=34, skipped=318)
2025-12-21 23:45:48 INFO Epoch 002 | train_mse=0.143629 | val_loss=0.147015 | best_val_loss=-0.094302
2025-12-21 23:45:50 INFO Epoch 003 | 25% complete (batch 68/272)
2025-12-21 23:45:51 INFO Epoch 003 | 50% complete (batch 136/272)
2025-12-21 23:45:53 INFO Epoch 003 | 75% complete (batch 204/272)
2025-12-21 23:45:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.345337
2025-12-21 23:45:57 INFO Tuning ranking metrics: regret=0.133646 spearman=-0.057308 (groups=34, skipped=318)
2025-12-21 23:45:57 INFO Epoch 003 | train_mse=0.144448 | val_loss=0.151267 | best_val_loss=-0.094302
Metric tuning_rank_spearman improved by 0.037 >= min_delta = 0.0. New best score: -0.057
2025-12-21 23:45:59 INFO Epoch 004 | 25% complete (batch 68/272)
2025-12-21 23:46:00 INFO Epoch 004 | 50% complete (batch 136/272)
2025-12-21 23:46:02 INFO Epoch 004 | 75% complete (batch 204/272)
2025-12-21 23:46:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.149578
2025-12-21 23:46:06 INFO Tuning ranking metrics: regret=0.162852 spearman=0.115463 (groups=34, skipped=318)
2025-12-21 23:46:06 INFO Epoch 004 | train_mse=0.145411 | val_loss=0.149578 | best_val_loss=-0.057308
Metric tuning_rank_spearman improved by 0.173 >= min_delta = 0.0. New best score: 0.115
2025-12-21 23:46:08 INFO Epoch 005 | 25% complete (batch 68/272)
2025-12-21 23:46:09 INFO Epoch 005 | 50% complete (batch 136/272)
2025-12-21 23:46:11 INFO Epoch 005 | 75% complete (batch 204/272)
2025-12-21 23:46:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.164324
2025-12-21 23:46:16 INFO Tuning ranking metrics: regret=0.138249 spearman=-0.046295 (groups=34, skipped=318)
2025-12-21 23:46:16 INFO Epoch 005 | train_mse=0.147925 | val_loss=0.144200 | best_val_loss=0.115463
2025-12-21 23:46:17 INFO Epoch 006 | 25% complete (batch 68/272)
2025-12-21 23:46:19 INFO Epoch 006 | 50% complete (batch 136/272)
2025-12-21 23:46:21 INFO Epoch 006 | 75% complete (batch 204/272)
2025-12-21 23:46:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.291302
2025-12-21 23:46:25 INFO Tuning ranking metrics: regret=0.150626 spearman=-0.147931 (groups=34, skipped=318)
2025-12-21 23:46:25 INFO Epoch 006 | train_mse=0.148525 | val_loss=0.145038 | best_val_loss=0.115463
2025-12-21 23:46:27 INFO Epoch 007 | 25% complete (batch 68/272)
2025-12-21 23:46:28 INFO Epoch 007 | 50% complete (batch 136/272)
2025-12-21 23:46:30 INFO Epoch 007 | 75% complete (batch 204/272)
2025-12-21 23:46:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.013665
2025-12-21 23:46:34 INFO Tuning ranking metrics: regret=0.168427 spearman=-0.257506 (groups=34, skipped=318)
2025-12-21 23:46:34 INFO Epoch 007 | train_mse=0.151374 | val_loss=0.145142 | best_val_loss=0.115463
2025-12-21 23:46:36 INFO Epoch 008 | 25% complete (batch 68/272)
2025-12-21 23:46:38 INFO Epoch 008 | 50% complete (batch 136/272)
2025-12-21 23:46:39 INFO Epoch 008 | 75% complete (batch 204/272)
2025-12-21 23:46:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.145479
2025-12-21 23:46:44 INFO Tuning ranking metrics: regret=0.094248 spearman=0.045531 (groups=34, skipped=318)
2025-12-21 23:46:44 INFO Epoch 008 | train_mse=0.142244 | val_loss=0.145479 | best_val_loss=0.115463
2025-12-21 23:46:45 INFO Epoch 009 | 25% complete (batch 68/272)
2025-12-21 23:46:47 INFO Epoch 009 | 50% complete (batch 136/272)
2025-12-21 23:46:49 INFO Epoch 009 | 75% complete (batch 204/272)
2025-12-21 23:46:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.424016
2025-12-21 23:46:54 INFO Tuning ranking metrics: regret=0.133442 spearman=0.244461 (groups=34, skipped=318)
2025-12-21 23:46:54 INFO Epoch 009 | train_mse=0.146170 | val_loss=0.144786 | best_val_loss=0.115463
Metric tuning_rank_spearman improved by 0.129 >= min_delta = 0.0. New best score: 0.244
2025-12-21 23:46:55 INFO Epoch 010 | 25% complete (batch 68/272)
2025-12-21 23:46:57 INFO Epoch 010 | 50% complete (batch 136/272)
2025-12-21 23:46:59 INFO Epoch 010 | 75% complete (batch 204/272)
2025-12-21 23:47:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.142778
2025-12-21 23:47:03 INFO Tuning ranking metrics: regret=0.120968 spearman=0.252394 (groups=34, skipped=318)
2025-12-21 23:47:03 INFO Epoch 010 | train_mse=0.147600 | val_loss=0.142778 | best_val_loss=0.244461
Metric tuning_rank_spearman improved by 0.008 >= min_delta = 0.0. New best score: 0.252
2025-12-21 23:47:05 INFO Epoch 011 | 25% complete (batch 68/272)
2025-12-21 23:47:07 INFO Epoch 011 | 50% complete (batch 136/272)
2025-12-21 23:47:08 INFO Epoch 011 | 75% complete (batch 204/272)
2025-12-21 23:47:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.180721
2025-12-21 23:47:13 INFO Tuning ranking metrics: regret=0.170070 spearman=-0.289935 (groups=34, skipped=318)
2025-12-21 23:47:13 INFO Epoch 011 | train_mse=0.151648 | val_loss=0.145462 | best_val_loss=0.252394
2025-12-21 23:47:15 INFO Epoch 012 | 25% complete (batch 68/272)
2025-12-21 23:47:17 INFO Epoch 012 | 50% complete (batch 136/272)
2025-12-21 23:47:18 INFO Epoch 012 | 75% complete (batch 204/272)
2025-12-21 23:47:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.146564
2025-12-21 23:47:23 INFO Tuning ranking metrics: regret=0.136171 spearman=-0.005042 (groups=34, skipped=318)
2025-12-21 23:47:23 INFO Epoch 012 | train_mse=0.140046 | val_loss=0.146564 | best_val_loss=0.252394
2025-12-21 23:47:25 INFO Epoch 013 | 25% complete (batch 68/272)
2025-12-21 23:47:27 INFO Epoch 013 | 50% complete (batch 136/272)
2025-12-21 23:47:28 INFO Epoch 013 | 75% complete (batch 204/272)
2025-12-21 23:47:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.228321
2025-12-21 23:47:33 INFO Tuning ranking metrics: regret=0.111946 spearman=0.013732 (groups=34, skipped=318)
2025-12-21 23:47:33 INFO Epoch 013 | train_mse=0.139717 | val_loss=0.169829 | best_val_loss=0.252394
2025-12-21 23:47:34 INFO Epoch 014 | 25% complete (batch 68/272)
2025-12-21 23:47:36 INFO Epoch 014 | 50% complete (batch 136/272)
2025-12-21 23:47:37 INFO Epoch 014 | 75% complete (batch 204/272)
2025-12-21 23:47:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.335631
2025-12-21 23:47:42 INFO Tuning ranking metrics: regret=0.161309 spearman=-0.097237 (groups=34, skipped=318)
2025-12-21 23:47:42 INFO Epoch 014 | train_mse=0.144037 | val_loss=0.142129 | best_val_loss=0.252394
2025-12-21 23:47:44 INFO Epoch 015 | 25% complete (batch 68/272)
2025-12-21 23:47:45 INFO Epoch 015 | 50% complete (batch 136/272)
2025-12-21 23:47:47 INFO Epoch 015 | 75% complete (batch 204/272)
2025-12-21 23:47:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.367073
2025-12-21 23:47:52 INFO Tuning ranking metrics: regret=0.178691 spearman=0.000000 (groups=34, skipped=318)
2025-12-21 23:47:52 INFO Epoch 015 | train_mse=0.140285 | val_loss=0.144343 | best_val_loss=0.252394
2025-12-21 23:47:54 INFO Epoch 016 | 25% complete (batch 68/272)
2025-12-21 23:47:56 INFO Epoch 016 | 50% complete (batch 136/272)
2025-12-21 23:47:58 INFO Epoch 016 | 75% complete (batch 204/272)
2025-12-21 23:48:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.138909
2025-12-21 23:48:02 INFO Tuning ranking metrics: regret=0.133424 spearman=-0.067781 (groups=34, skipped=318)
2025-12-21 23:48:02 INFO Epoch 016 | train_mse=0.135768 | val_loss=0.138909 | best_val_loss=0.252394
2025-12-21 23:48:04 INFO Epoch 017 | 25% complete (batch 68/272)
2025-12-21 23:48:06 INFO Epoch 017 | 50% complete (batch 136/272)
2025-12-21 23:48:07 INFO Epoch 017 | 75% complete (batch 204/272)
2025-12-21 23:48:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.468978
2025-12-21 23:48:12 INFO Tuning ranking metrics: regret=0.154051 spearman=-0.090756 (groups=34, skipped=318)
2025-12-21 23:48:12 INFO Epoch 017 | train_mse=0.143229 | val_loss=0.130542 | best_val_loss=0.252394
2025-12-21 23:48:13 INFO Epoch 018 | 25% complete (batch 68/272)
2025-12-21 23:48:15 INFO Epoch 018 | 50% complete (batch 136/272)
2025-12-21 23:48:17 INFO Epoch 018 | 75% complete (batch 204/272)
2025-12-21 23:48:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.447137
2025-12-21 23:48:21 INFO Tuning ranking metrics: regret=0.120223 spearman=-0.032773 (groups=34, skipped=318)
2025-12-21 23:48:21 INFO Epoch 018 | train_mse=0.122377 | val_loss=0.136038 | best_val_loss=0.252394
2025-12-21 23:48:23 INFO Epoch 019 | 25% complete (batch 68/272)
2025-12-21 23:48:25 INFO Epoch 019 | 50% complete (batch 136/272)
2025-12-21 23:48:26 INFO Epoch 019 | 75% complete (batch 204/272)
2025-12-21 23:48:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.463738
2025-12-21 23:48:31 INFO Tuning ranking metrics: regret=0.116747 spearman=0.007398 (groups=34, skipped=318)
2025-12-21 23:48:31 INFO Epoch 019 | train_mse=0.105497 | val_loss=0.095783 | best_val_loss=0.252394
2025-12-21 23:48:33 INFO Epoch 020 | 25% complete (batch 68/272)
2025-12-21 23:48:35 INFO Epoch 020 | 50% complete (batch 136/272)
2025-12-21 23:48:37 INFO Epoch 020 | 75% complete (batch 204/272)
2025-12-21 23:48:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.451013
2025-12-21 23:48:42 INFO Tuning ranking metrics: regret=0.142680 spearman=0.002521 (groups=34, skipped=318)
2025-12-21 23:48:42 INFO Epoch 020 | train_mse=0.130085 | val_loss=0.113985 | best_val_loss=0.252394
2025-12-21 23:48:44 INFO Epoch 021 | 25% complete (batch 68/272)
2025-12-21 23:48:46 INFO Epoch 021 | 50% complete (batch 136/272)
2025-12-21 23:48:47 INFO Epoch 021 | 75% complete (batch 204/272)
2025-12-21 23:48:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.523409
2025-12-21 23:48:52 INFO Tuning ranking metrics: regret=0.120008 spearman=-0.075980 (groups=34, skipped=318)
2025-12-21 23:48:52 INFO Epoch 021 | train_mse=0.117473 | val_loss=0.094682 | best_val_loss=0.252394
2025-12-21 23:48:54 INFO Epoch 022 | 25% complete (batch 68/272)
2025-12-21 23:48:56 INFO Epoch 022 | 50% complete (batch 136/272)
2025-12-21 23:48:57 INFO Epoch 022 | 75% complete (batch 204/272)
2025-12-21 23:49:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.547369
2025-12-21 23:49:02 INFO Tuning ranking metrics: regret=0.097040 spearman=-0.051961 (groups=34, skipped=318)
2025-12-21 23:49:02 INFO Epoch 022 | train_mse=0.106772 | val_loss=0.071865 | best_val_loss=0.252394
2025-12-21 23:49:04 INFO Epoch 023 | 25% complete (batch 68/272)
2025-12-21 23:49:06 INFO Epoch 023 | 50% complete (batch 136/272)
2025-12-21 23:49:08 INFO Epoch 023 | 75% complete (batch 204/272)
2025-12-21 23:49:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.518557
2025-12-21 23:49:12 INFO Tuning ranking metrics: regret=0.082860 spearman=-0.053209 (groups=34, skipped=318)
2025-12-21 23:49:12 INFO Epoch 023 | train_mse=0.105550 | val_loss=0.091004 | best_val_loss=0.252394
2025-12-21 23:49:14 INFO Epoch 024 | 25% complete (batch 68/272)
2025-12-21 23:49:15 INFO Epoch 024 | 50% complete (batch 136/272)
2025-12-21 23:49:17 INFO Epoch 024 | 75% complete (batch 204/272)
2025-12-21 23:49:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.539502
2025-12-21 23:49:22 INFO Tuning ranking metrics: regret=0.098730 spearman=-0.085326 (groups=34, skipped=318)
2025-12-21 23:49:22 INFO Epoch 024 | train_mse=0.102367 | val_loss=0.087673 | best_val_loss=0.252394
2025-12-21 23:49:23 INFO Epoch 025 | 25% complete (batch 68/272)
2025-12-21 23:49:25 INFO Epoch 025 | 50% complete (batch 136/272)
2025-12-21 23:49:26 INFO Epoch 025 | 75% complete (batch 204/272)
2025-12-21 23:49:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.533030
2025-12-21 23:49:31 INFO Tuning ranking metrics: regret=0.098608 spearman=-0.074389 (groups=34, skipped=318)
2025-12-21 23:49:31 INFO Epoch 025 | train_mse=0.100605 | val_loss=0.075377 | best_val_loss=0.252394
2025-12-21 23:49:33 INFO Epoch 026 | 25% complete (batch 68/272)
2025-12-21 23:49:35 INFO Epoch 026 | 50% complete (batch 136/272)
2025-12-21 23:49:36 INFO Epoch 026 | 75% complete (batch 204/272)
2025-12-21 23:49:40 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.534791
2025-12-21 23:49:41 INFO Tuning ranking metrics: regret=0.097613 spearman=-0.049389 (groups=34, skipped=318)
2025-12-21 23:49:41 INFO Epoch 026 | train_mse=0.102861 | val_loss=0.068855 | best_val_loss=0.252394
2025-12-21 23:49:43 INFO Epoch 027 | 25% complete (batch 68/272)
2025-12-21 23:49:45 INFO Epoch 027 | 50% complete (batch 136/272)
2025-12-21 23:49:46 INFO Epoch 027 | 75% complete (batch 204/272)
2025-12-21 23:49:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.543368
2025-12-21 23:49:51 INFO Tuning ranking metrics: regret=0.095438 spearman=-0.052610 (groups=34, skipped=318)
2025-12-21 23:49:51 INFO Epoch 027 | train_mse=0.076049 | val_loss=0.068908 | best_val_loss=0.252394
2025-12-21 23:49:53 INFO Epoch 028 | 25% complete (batch 68/272)
2025-12-21 23:49:55 INFO Epoch 028 | 50% complete (batch 136/272)
2025-12-21 23:49:57 INFO Epoch 028 | 75% complete (batch 204/272)
2025-12-21 23:50:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.549204
2025-12-21 23:50:03 INFO Tuning ranking metrics: regret=0.106996 spearman=0.050993 (groups=34, skipped=318)
2025-12-21 23:50:03 INFO Epoch 028 | train_mse=0.082604 | val_loss=0.073789 | best_val_loss=0.252394
2025-12-21 23:50:05 INFO Epoch 029 | 25% complete (batch 68/272)
2025-12-21 23:50:07 INFO Epoch 029 | 50% complete (batch 136/272)
2025-12-21 23:50:09 INFO Epoch 029 | 75% complete (batch 204/272)
2025-12-21 23:50:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.580764
2025-12-21 23:50:14 INFO Tuning ranking metrics: regret=0.110691 spearman=0.011096 (groups=34, skipped=318)
2025-12-21 23:50:14 INFO Epoch 029 | train_mse=0.103841 | val_loss=0.070101 | best_val_loss=0.252394
2025-12-21 23:50:16 INFO Epoch 030 | 25% complete (batch 68/272)
2025-12-21 23:50:18 INFO Epoch 030 | 50% complete (batch 136/272)
2025-12-21 23:50:20 INFO Epoch 030 | 75% complete (batch 204/272)
2025-12-21 23:50:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.584339
2025-12-21 23:50:25 INFO Tuning ranking metrics: regret=0.111483 spearman=-0.016769 (groups=34, skipped=318)
2025-12-21 23:50:25 INFO Epoch 030 | train_mse=0.090113 | val_loss=0.063876 | best_val_loss=0.252394
Monitored metric tuning_rank_spearman did not improve in the last 20 records. Best score: 0.252. Signaling Trainer to stop.
2025-12-21 23:50:25 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.11546_val-0.14958_epoch004.chkpt, checkpoint.tuning_rank_spearman-0.24446_val-0.14479_epoch009.chkpt, checkpoint.tuning_rank_spearman-0.25239_val-0.14278_epoch010.chkpt
2025-12-21 23:50:25 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-21_23-45-14/model_checkpoints/checkpoint.tuning_rank_spearman-0.25239_val-0.14278_epoch010.chkpt
2025-12-21 23:50:25 INFO Best validation loss: tensor(0.2524)
2025-12-21 23:50:25 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-21_23-45-14/model_checkpoints/checkpoint.tuning_rank_spearman-0.25239_val-0.14278_epoch010.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-21_23-45-14/model_checkpoints/checkpoint.tuning_rank_spearman-0.25239_val-0.14278_epoch010.chkpt
2025-12-21 23:50:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.142778
2025-12-21 23:50:28 INFO Tuning ranking metrics: regret=0.120968 spearman=0.252394 (groups=34, skipped=318)
2025-12-21 23:50:28 INFO Epoch 031 | val_loss=0.142778 | best_val_loss=0.252394
2025-12-21 23:50:28 INFO Validation metrics: [{'val_loss': 0.14277836680412292, 'tuning_rank_regret': 0.12096774578094482, 'tuning_rank_spearman': 0.2523936927318573, 'val_pearson_corr': 0.41819196939468384, 'val_spearman_corr': 0.32618317008018494, 'val_rank_regret': 0.13503190875053406, 'val_rank_spearman': -0.25555557012557983}]
2025-12-21 23:50:28 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.25239_val-0.14278_epoch010.chkpt
2025-12-21 23:50:28 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.11546_val-0.14958_epoch004.chkpt
2025-12-21 23:50:28 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.24446_val-0.14479_epoch009.chkpt
2025-12-21 23:50:28 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.14420_epoch005.ckpt
2025-12-21 23:50:28 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
USING ADAM
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.12096774578094482
  tuning_rank_spearman      0.2523936927318573
        val_loss            0.14277836680412292
    val_pearson_corr        0.41819196939468384
     val_rank_regret        0.13503190875053406
    val_rank_spearman      -0.25555557012557983
    val_spearman_corr       0.32618317008018494
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run large_batch_sched_boost_lean_seed222_2025-12-21_23-45-14 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-21_23-45-14
[train_cli][batch] job 'large_batch_sched_boost_lean_seed222' finished.
[run_full_pipeline] Best run: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41 (tuning_rank_spearman=0.011904762126505375)
[run_full_pipeline] Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41/model_checkpoints/checkpoint.tuning_rank_spearman-0.01190_val-0.07305_epoch023.chkpt
[run_full_pipeline] Phase 1 fine-tuning -> sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase1
[train_cli] run_id=sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase1 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase1/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase1 --git-commit cf515fb092 --git-dirty --resume-from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41/model_checkpoints/checkpoint.tuning_rank_spearman-0.01190_val-0.07305_epoch023.chkpt
2025-12-21 23:50:32 INFO git_commit = cf515fb092 (dirty)
2025-12-21 23:50:32 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-21 23:50:32 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase1/config/config.yaml
2025-12-21 23:50:32 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data
2025-12-21 23:50:32 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-21 23:50:32 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-21 23:50:32 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase1
2025-12-21 23:50:32 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-21 23:50:32 INFO   metadata_path = None
2025-12-21 23:50:32 INFO   summary_path = None
2025-12-21 23:50:32 INFO   accelerator = cpu
2025-12-21 23:50:32 INFO   devices = 1
2025-12-21 23:50:32 INFO   attention_head = 8
2025-12-21 23:50:32 INFO   pooling_type = mean
2025-12-21 23:50:32 INFO   model_self_loops = False
2025-12-21 23:50:32 INFO   model_self_loop_fill = mean
2025-12-21 23:50:32 INFO   model_residual = False
2025-12-21 23:50:32 INFO   batch_size = 16
2025-12-21 23:50:32 INFO   learning_rate = 0.001
2025-12-21 23:50:32 INFO   num_epochs = 320
2025-12-21 23:50:32 INFO   accumulate_grad_batches = 16
2025-12-21 23:50:32 INFO   seed = 222
2025-12-21 23:50:32 INFO   num_workers = 0
2025-12-21 23:50:32 INFO   precision = 32
2025-12-21 23:50:32 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-21 23:50:32 INFO   early_stopping_patience = 20
2025-12-21 23:50:32 INFO   lr_scheduler_patience = 4
2025-12-21 23:50:32 INFO   lr_scheduler_factor = 0.2
2025-12-21 23:50:32 INFO   fast_dev_run = False
2025-12-21 23:50:32 INFO   limit_train_batches = None
2025-12-21 23:50:32 INFO   limit_val_batches = None
2025-12-21 23:50:32 INFO   log_lr = False
2025-12-21 23:50:32 INFO   progress_bar_refresh_rate = 0
2025-12-21 23:50:32 INFO   log_every_n_steps = 100
2025-12-21 23:50:32 INFO   use_val_spearman_as_secondary = True
2025-12-21 23:50:32 INFO   spearman_secondary_min_delta = 0.0
2025-12-21 23:50:32 INFO   spearman_secondary_weight = 1.0
2025-12-21 23:50:32 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-21 23:50:32 INFO   tuning_max_samples = 500
2025-12-21 23:50:32 INFO   tuning_fraction = None
2025-12-21 23:50:32 INFO   tuning_eval_every = 1
2025-12-21 23:50:32 INFO   rank_loss_weight = 0.0
2025-12-21 23:50:32 INFO   rank_loss_margin = 0.0
2025-12-21 23:50:32 INFO   rank_loss_mode = hinge
2025-12-21 23:50:32 INFO   rank_loss_grouped = True
2025-12-21 23:50:32 INFO   variance_reduction_enabled = False
2025-12-21 23:50:32 INFO   variance_reduction_method = topk_avg
2025-12-21 23:50:32 INFO   variance_reduction_top_k = 3
2025-12-21 23:50:32 INFO   coverage_minimum = 0.0
2025-12-21 23:50:32 INFO   coverage_fail_on_missing = False
2025-12-21 23:50:32 INFO   graph_load_profiling = False
2025-12-21 23:50:32 INFO   graph_load_top_k = 5
2025-12-21 23:50:32 INFO   enable_graph_cache = True
2025-12-21 23:50:32 INFO   graph_cache_size = 256
2025-12-21 23:50:32 INFO   canonicalize_on_load = False
2025-12-21 23:50:32 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-21 23:50:32 INFO   edge_schema = {}
2025-12-21 23:50:32 INFO   topology_schema = {}
Seed set to 222
2025-12-21 23:50:32 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-21 23:50:32 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-21 23:50:32 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-21 23:50:32 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-21 23:50:32 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-21 23:50:32 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-21 23:50:33 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-21 23:50:33 INFO Tuning group stats: groups=352 groups>=2=34 singletons=318 max_group=11
2025-12-21 23:50:33 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase1/dataset_coverage.json
2025-12-21 23:50:33 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase1/dataset_coverage.json for details.
2025-12-21 23:50:33 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase1/dataset_coverage.json for details.
2025-12-21 23:50:33 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase1/dataset_coverage.json for details.
2025-12-21 23:50:33 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase1/schema_summary.json
2025-12-21 23:50:33 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase1/feature_metadata.json
2025-12-21 23:50:33 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-21 23:50:33 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/feature-config.yaml.topoqa.10A.2, sha256=5c62898155179232a565e24d9fbd7b208f9ce480d1a19d6139de19454e173ff0
2025-12-21 23:50:33 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/work/edge_features)
2025-12-21 23:50:33 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json
2025-12-21 23:50:33 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase1/schema_summary.json
2025-12-21 23:50:33 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-21 23:50:33 INFO Topology: topology/persistence_basic/v1 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 172-dimensional node features.
2025-12-21 23:50:33 INFO Node: node/dssp_topo_merge/v1; metadata lists 172 feature columns matching the .pt tensor.
2025-12-21 23:50:33 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-21 23:50:33 INFO → Total feature dimensionality observed and confirmed: node_dim = 172, edge_dim = 11.
2025-12-21 23:50:33 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-21 23:50:33 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 172,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 172,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase1/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge/v1",
      "alias": "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA",
      "jobs": 16,
      "summary": "DSSP-derived node features merged with topology statistics."
    },
    "topology": {
      "id": "topology/persistence_basic/v1",
      "alias": "Betti 0 and Betti 1 topology summaries on interface coords = 140D PH | TopoQA",
      "jobs": 16,
      "summary": "Persistent homology features with configurable distance thresholds."
    }
  },
  "notes": []
}
2025-12-21 23:50:33 INFO DataLoader num_workers=0 (recommended for macOS to avoid spawn issues; configurable via config.yaml -> num_workers).
2025-12-21 23:50:33 INFO Resuming from checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41/model_checkpoints/checkpoint.tuning_rank_spearman-0.01190_val-0.07305_epoch023.chkpt (epoch=23)
2025-12-21 23:50:34 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=79df563254c2496fa4c84ac3ccda2347)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-21 23:50:34 INFO Starting training (fast_dev_run=False)
2025-12-21 23:50:34 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase1/model_checkpoints exists and is not empty.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41/model_checkpoints/checkpoint.tuning_rank_spearman-0.01190_val-0.07305_epoch023.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41/model_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase1/model_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41/model_checkpoints/val_loss_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase1/model_checkpoints/val_loss_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 5.5 K  | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
165 K     Trainable params
0         Non-trainable params
165 K     Total params
0.662     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
Restored all states from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41/model_checkpoints/checkpoint.tuning_rank_spearman-0.01190_val-0.07305_epoch023.chkpt
2025-12-21 23:50:36 INFO Epoch 024 | 25% complete (batch 136/543)
2025-12-21 23:50:39 INFO Epoch 024 | 50% complete (batch 272/543)
2025-12-21 23:50:42 INFO Epoch 024 | 75% complete (batch 408/543)
2025-12-21 23:50:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.063704
2025-12-21 23:50:48 INFO Tuning ranking metrics: regret=0.092199 spearman=-0.065247 (groups=34, skipped=318)
2025-12-21 23:50:48 INFO Epoch 024 | val_loss=0.063704
2025-12-21 23:50:51 INFO Epoch 025 | 25% complete (batch 136/543)
2025-12-21 23:50:54 INFO Epoch 025 | 50% complete (batch 272/543)
2025-12-21 23:50:56 INFO Epoch 025 | 75% complete (batch 408/543)
2025-12-21 23:51:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.616379
2025-12-21 23:51:03 INFO Tuning ranking metrics: regret=0.091260 spearman=-0.076833 (groups=34, skipped=318)
2025-12-21 23:51:03 INFO Epoch 025 | train_mse=0.066801 | val_loss=0.062217 | best_val_loss=-0.065247
2025-12-21 23:51:05 INFO Epoch 026 | 25% complete (batch 136/543)
2025-12-21 23:51:08 INFO Epoch 026 | 50% complete (batch 272/543)
2025-12-21 23:51:11 INFO Epoch 026 | 75% complete (batch 408/543)
2025-12-21 23:51:15 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.621077
2025-12-21 23:51:17 INFO Tuning ranking metrics: regret=0.092694 spearman=-0.097995 (groups=34, skipped=318)
2025-12-21 23:51:17 INFO Epoch 026 | train_mse=0.061198 | val_loss=0.061237 | best_val_loss=-0.065247
2025-12-21 23:51:19 INFO Epoch 027 | 25% complete (batch 136/543)
2025-12-21 23:51:22 INFO Epoch 027 | 50% complete (batch 272/543)
2025-12-21 23:51:24 INFO Epoch 027 | 75% complete (batch 408/543)
2025-12-21 23:51:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.627532
2025-12-21 23:51:31 INFO Tuning ranking metrics: regret=0.091376 spearman=-0.067564 (groups=34, skipped=318)
2025-12-21 23:51:31 INFO Epoch 027 | train_mse=0.067875 | val_loss=0.063086 | best_val_loss=-0.065247
2025-12-21 23:51:33 INFO Epoch 028 | 25% complete (batch 136/543)
2025-12-21 23:51:36 INFO Epoch 028 | 50% complete (batch 272/543)
2025-12-21 23:51:38 INFO Epoch 028 | 75% complete (batch 408/543)
2025-12-21 23:51:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.624496
2025-12-21 23:51:45 INFO Tuning ranking metrics: regret=0.092471 spearman=-0.108671 (groups=34, skipped=318)
2025-12-21 23:51:45 INFO Epoch 028 | train_mse=0.063764 | val_loss=0.059202 | best_val_loss=-0.065247
2025-12-21 23:51:48 INFO Epoch 029 | 25% complete (batch 136/543)
2025-12-21 23:51:50 INFO Epoch 029 | 50% complete (batch 272/543)
2025-12-21 23:51:53 INFO Epoch 029 | 75% complete (batch 408/543)
2025-12-21 23:51:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.622121
2025-12-21 23:52:00 INFO Tuning ranking metrics: regret=0.092237 spearman=-0.090667 (groups=34, skipped=318)
2025-12-21 23:52:00 INFO Epoch 029 | train_mse=0.059339 | val_loss=0.060225 | best_val_loss=-0.065247
2025-12-21 23:52:03 INFO Epoch 030 | 25% complete (batch 136/543)
2025-12-21 23:52:05 INFO Epoch 030 | 50% complete (batch 272/543)
2025-12-21 23:52:08 INFO Epoch 030 | 75% complete (batch 408/543)
2025-12-21 23:52:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.617463
2025-12-21 23:52:14 INFO Tuning ranking metrics: regret=0.077804 spearman=-0.118838 (groups=34, skipped=318)
2025-12-21 23:52:14 INFO Epoch 030 | train_mse=0.049637 | val_loss=0.060780 | best_val_loss=-0.065247
2025-12-21 23:52:17 INFO Epoch 031 | 25% complete (batch 136/543)
2025-12-21 23:52:19 INFO Epoch 031 | 50% complete (batch 272/543)
2025-12-21 23:52:22 INFO Epoch 031 | 75% complete (batch 408/543)
2025-12-21 23:52:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.599293
2025-12-21 23:52:29 INFO Tuning ranking metrics: regret=0.077286 spearman=-0.113611 (groups=34, skipped=318)
2025-12-21 23:52:29 INFO Epoch 031 | train_mse=0.054780 | val_loss=0.088943 | best_val_loss=-0.065247
2025-12-21 23:52:31 INFO Epoch 032 | 25% complete (batch 136/543)
2025-12-21 23:52:34 INFO Epoch 032 | 50% complete (batch 272/543)
2025-12-21 23:52:36 INFO Epoch 032 | 75% complete (batch 408/543)
2025-12-21 23:52:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.611818
2025-12-21 23:52:43 INFO Tuning ranking metrics: regret=0.092036 spearman=-0.068666 (groups=34, skipped=318)
2025-12-21 23:52:43 INFO Epoch 032 | train_mse=0.063231 | val_loss=0.080264 | best_val_loss=-0.065247
2025-12-21 23:52:46 INFO Epoch 033 | 25% complete (batch 136/543)
2025-12-21 23:52:49 INFO Epoch 033 | 50% complete (batch 272/543)
2025-12-21 23:52:52 INFO Epoch 033 | 75% complete (batch 408/543)
2025-12-21 23:52:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.608141
2025-12-21 23:52:58 INFO Tuning ranking metrics: regret=0.076771 spearman=-0.108906 (groups=34, skipped=318)
2025-12-21 23:52:58 INFO Epoch 033 | train_mse=0.062374 | val_loss=0.073788 | best_val_loss=-0.065247
2025-12-21 23:53:01 INFO Epoch 034 | 25% complete (batch 136/543)
2025-12-21 23:53:03 INFO Epoch 034 | 50% complete (batch 272/543)
2025-12-21 23:53:06 INFO Epoch 034 | 75% complete (batch 408/543)
2025-12-21 23:53:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.644374
2025-12-21 23:53:12 INFO Tuning ranking metrics: regret=0.077702 spearman=-0.108403 (groups=34, skipped=318)
2025-12-21 23:53:12 INFO Epoch 034 | train_mse=0.067419 | val_loss=0.055984 | best_val_loss=-0.065247
2025-12-21 23:53:15 INFO Epoch 035 | 25% complete (batch 136/543)
2025-12-21 23:53:18 INFO Epoch 035 | 50% complete (batch 272/543)
2025-12-21 23:53:20 INFO Epoch 035 | 75% complete (batch 408/543)
2025-12-21 23:53:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.635821
2025-12-21 23:53:27 INFO Tuning ranking metrics: regret=0.077201 spearman=-0.099051 (groups=34, skipped=318)
2025-12-21 23:53:27 INFO Epoch 035 | train_mse=0.071204 | val_loss=0.061264 | best_val_loss=-0.065247
2025-12-21 23:53:29 INFO Epoch 036 | 25% complete (batch 136/543)
2025-12-21 23:53:32 INFO Epoch 036 | 50% complete (batch 272/543)
2025-12-21 23:53:35 INFO Epoch 036 | 75% complete (batch 408/543)
2025-12-21 23:53:40 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.631716
2025-12-21 23:53:41 INFO Tuning ranking metrics: regret=0.094533 spearman=-0.123950 (groups=34, skipped=318)
2025-12-21 23:53:41 INFO Epoch 036 | train_mse=0.054789 | val_loss=0.057453 | best_val_loss=-0.065247
2025-12-21 23:53:44 INFO Epoch 037 | 25% complete (batch 136/543)
2025-12-21 23:53:46 INFO Epoch 037 | 50% complete (batch 272/543)
2025-12-21 23:53:49 INFO Epoch 037 | 75% complete (batch 408/543)
2025-12-21 23:53:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.629235
2025-12-21 23:53:56 INFO Tuning ranking metrics: regret=0.082878 spearman=-0.153890 (groups=34, skipped=318)
2025-12-21 23:53:56 INFO Epoch 037 | train_mse=0.059140 | val_loss=0.063578 | best_val_loss=-0.065247
2025-12-21 23:53:59 INFO Epoch 038 | 25% complete (batch 136/543)
2025-12-21 23:54:02 INFO Epoch 038 | 50% complete (batch 272/543)
2025-12-21 23:54:05 INFO Epoch 038 | 75% complete (batch 408/543)
2025-12-21 23:54:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.634862
2025-12-21 23:54:11 INFO Tuning ranking metrics: regret=0.077619 spearman=-0.080838 (groups=34, skipped=318)
2025-12-21 23:54:11 INFO Epoch 038 | train_mse=0.053543 | val_loss=0.060338 | best_val_loss=-0.065247
2025-12-21 23:54:14 INFO Epoch 039 | 25% complete (batch 136/543)
2025-12-21 23:54:16 INFO Epoch 039 | 50% complete (batch 272/543)
2025-12-21 23:54:19 INFO Epoch 039 | 75% complete (batch 408/543)
2025-12-21 23:54:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.631208
2025-12-21 23:54:26 INFO Tuning ranking metrics: regret=0.096205 spearman=-0.120626 (groups=34, skipped=318)
2025-12-21 23:54:26 INFO Epoch 039 | train_mse=0.067395 | val_loss=0.067042 | best_val_loss=-0.065247
2025-12-21 23:54:29 INFO Epoch 040 | 25% complete (batch 136/543)
2025-12-21 23:54:32 INFO Epoch 040 | 50% complete (batch 272/543)
2025-12-21 23:54:35 INFO Epoch 040 | 75% complete (batch 408/543)
2025-12-21 23:54:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.630684
2025-12-21 23:54:41 INFO Tuning ranking metrics: regret=0.078172 spearman=-0.086064 (groups=34, skipped=318)
2025-12-21 23:54:41 INFO Epoch 040 | train_mse=0.056805 | val_loss=0.079100 | best_val_loss=-0.065247
2025-12-21 23:54:43 INFO Epoch 041 | 25% complete (batch 136/543)
2025-12-21 23:54:46 INFO Epoch 041 | 50% complete (batch 272/543)
2025-12-21 23:54:48 INFO Epoch 041 | 75% complete (batch 408/543)
2025-12-21 23:54:53 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.613003
2025-12-21 23:54:55 INFO Tuning ranking metrics: regret=0.073611 spearman=-0.074892 (groups=34, skipped=318)
2025-12-21 23:54:55 INFO Epoch 041 | train_mse=0.065846 | val_loss=0.072656 | best_val_loss=-0.065247
2025-12-21 23:54:58 INFO Epoch 042 | 25% complete (batch 136/543)
2025-12-21 23:55:00 INFO Epoch 042 | 50% complete (batch 272/543)
2025-12-21 23:55:03 INFO Epoch 042 | 75% complete (batch 408/543)
2025-12-21 23:55:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.622787
2025-12-21 23:55:10 INFO Tuning ranking metrics: regret=0.076187 spearman=-0.074809 (groups=34, skipped=318)
2025-12-21 23:55:10 INFO Epoch 042 | train_mse=0.058088 | val_loss=0.054446 | best_val_loss=-0.065247
2025-12-21 23:55:12 INFO Epoch 043 | 25% complete (batch 136/543)
2025-12-21 23:55:15 INFO Epoch 043 | 50% complete (batch 272/543)
2025-12-21 23:55:18 INFO Epoch 043 | 75% complete (batch 408/543)
2025-12-21 23:55:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.649117
2025-12-21 23:55:25 INFO Tuning ranking metrics: regret=0.075909 spearman=-0.065578 (groups=34, skipped=318)
2025-12-21 23:55:25 INFO Epoch 043 | train_mse=0.053827 | val_loss=0.055722 | best_val_loss=-0.065247
2025-12-21 23:55:28 INFO Epoch 044 | 25% complete (batch 136/543)
2025-12-21 23:55:31 INFO Epoch 044 | 50% complete (batch 272/543)
2025-12-21 23:55:33 INFO Epoch 044 | 75% complete (batch 408/543)
2025-12-21 23:55:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.647630
2025-12-21 23:55:40 INFO Tuning ranking metrics: regret=0.075909 spearman=-0.067717 (groups=34, skipped=318)
2025-12-21 23:55:40 INFO Epoch 044 | train_mse=0.050532 | val_loss=0.054455 | best_val_loss=-0.065247
2025-12-21 23:55:43 INFO Epoch 045 | 25% complete (batch 136/543)
2025-12-21 23:55:45 INFO Epoch 045 | 50% complete (batch 272/543)
2025-12-21 23:55:48 INFO Epoch 045 | 75% complete (batch 408/543)
2025-12-21 23:55:53 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.641529
2025-12-21 23:55:55 INFO Tuning ranking metrics: regret=0.075003 spearman=-0.077712 (groups=34, skipped=318)
2025-12-21 23:55:55 INFO Epoch 045 | train_mse=0.056699 | val_loss=0.058590 | best_val_loss=-0.065247
2025-12-21 23:55:57 INFO Epoch 046 | 25% complete (batch 136/543)
2025-12-21 23:56:00 INFO Epoch 046 | 50% complete (batch 272/543)
2025-12-21 23:56:03 INFO Epoch 046 | 75% complete (batch 408/543)
2025-12-21 23:56:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.652712
2025-12-21 23:56:09 INFO Tuning ranking metrics: regret=0.075085 spearman=-0.076522 (groups=34, skipped=318)
2025-12-21 23:56:09 INFO Epoch 046 | train_mse=0.047705 | val_loss=0.054045 | best_val_loss=-0.065247
2025-12-21 23:56:12 INFO Epoch 047 | 25% complete (batch 136/543)
2025-12-21 23:56:15 INFO Epoch 047 | 50% complete (batch 272/543)
2025-12-21 23:56:17 INFO Epoch 047 | 75% complete (batch 408/543)
2025-12-21 23:56:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.658777
2025-12-21 23:56:24 INFO Tuning ranking metrics: regret=0.075085 spearman=-0.074784 (groups=34, skipped=318)
2025-12-21 23:56:24 INFO Epoch 047 | train_mse=0.043687 | val_loss=0.053904 | best_val_loss=-0.065247
Monitored metric tuning_rank_spearman did not improve in the last 24 records. Best score: 0.012. Signaling Trainer to stop.
2025-12-21 23:56:24 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman--0.06525_val-0.06370_epoch024.chkpt, checkpoint.tuning_rank_spearman--0.06558_val-0.05572_epoch043.chkpt, checkpoint.tuning_rank_spearman--0.06756_val-0.06309_epoch027.chkpt
2025-12-21 23:56:24 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase1/model_checkpoints/checkpoint.tuning_rank_spearman--0.06525_val-0.06370_epoch024.chkpt
2025-12-21 23:56:24 INFO Best validation loss: tensor(-0.0652)
2025-12-21 23:56:24 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase1/model_checkpoints/checkpoint.tuning_rank_spearman--0.06525_val-0.06370_epoch024.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase1/model_checkpoints/checkpoint.tuning_rank_spearman--0.06525_val-0.06370_epoch024.chkpt
2025-12-21 23:56:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.063704
2025-12-21 23:56:28 INFO Tuning ranking metrics: regret=0.092199 spearman=-0.065247 (groups=34, skipped=318)
2025-12-21 23:56:28 INFO Epoch 048 | val_loss=0.063704 | best_val_loss=-0.065247
2025-12-21 23:56:28 INFO Validation metrics: [{'val_loss': 0.06370384246110916, 'tuning_rank_regret': 0.09219938516616821, 'tuning_rank_spearman': -0.06524700671434402, 'val_pearson_corr': 0.7381687760353088, 'val_spearman_corr': 0.6785956025123596, 'val_rank_regret': 0.13690908253192902, 'val_rank_spearman': 0.2746031880378723}]
2025-12-21 23:56:28 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman--0.06525_val-0.06370_epoch024.chkpt
2025-12-21 23:56:28 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman--0.06756_val-0.06309_epoch027.chkpt
2025-12-21 23:56:28 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman--0.06558_val-0.05572_epoch043.chkpt
2025-12-21 23:56:28 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.06539_epoch018.ckpt
2025-12-21 23:56:28 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
USING ADAM
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.09219938516616821
  tuning_rank_spearman     -0.06524700671434402
        val_loss            0.06370384246110916
    val_pearson_corr        0.7381687760353088
     val_rank_regret        0.13690908253192902
    val_rank_spearman       0.2746031880378723
    val_spearman_corr       0.6785956025123596
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase1 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase1
[run_full_pipeline] Phase 1 best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase1/model_checkpoints/checkpoint.tuning_rank_spearman--0.06525_val-0.06370_epoch024.chkpt (tuning_rank_spearman=-0.06524700671434402)
[run_full_pipeline] Phase 2 fine-tuning (seed 101) -> sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed101
[train_cli] run_id=sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed101 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed101/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed101 --git-commit cf515fb092 --git-dirty --resume-from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase1/model_checkpoints/checkpoint.tuning_rank_spearman--0.06525_val-0.06370_epoch024.chkpt
2025-12-21 23:56:32 INFO git_commit = cf515fb092 (dirty)
2025-12-21 23:56:32 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-21 23:56:32 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed101/config/config.yaml
2025-12-21 23:56:32 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data
2025-12-21 23:56:32 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-21 23:56:32 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-21 23:56:32 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed101
2025-12-21 23:56:32 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-21 23:56:32 INFO   metadata_path = None
2025-12-21 23:56:32 INFO   summary_path = None
2025-12-21 23:56:32 INFO   accelerator = cpu
2025-12-21 23:56:32 INFO   devices = 1
2025-12-21 23:56:32 INFO   attention_head = 8
2025-12-21 23:56:32 INFO   pooling_type = mean
2025-12-21 23:56:32 INFO   model_self_loops = False
2025-12-21 23:56:32 INFO   model_self_loop_fill = mean
2025-12-21 23:56:32 INFO   model_residual = False
2025-12-21 23:56:32 INFO   batch_size = 16
2025-12-21 23:56:32 INFO   learning_rate = 0.001
2025-12-21 23:56:32 INFO   num_epochs = 320
2025-12-21 23:56:32 INFO   accumulate_grad_batches = 16
2025-12-21 23:56:32 INFO   seed = 101
2025-12-21 23:56:32 INFO   num_workers = 0
2025-12-21 23:56:32 INFO   precision = 32
2025-12-21 23:56:32 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-21 23:56:32 INFO   early_stopping_patience = 20
2025-12-21 23:56:32 INFO   lr_scheduler_patience = 4
2025-12-21 23:56:32 INFO   lr_scheduler_factor = 0.2
2025-12-21 23:56:32 INFO   fast_dev_run = False
2025-12-21 23:56:32 INFO   limit_train_batches = None
2025-12-21 23:56:32 INFO   limit_val_batches = None
2025-12-21 23:56:32 INFO   log_lr = False
2025-12-21 23:56:32 INFO   progress_bar_refresh_rate = 0
2025-12-21 23:56:32 INFO   log_every_n_steps = 100
2025-12-21 23:56:32 INFO   use_val_spearman_as_secondary = True
2025-12-21 23:56:32 INFO   spearman_secondary_min_delta = 0.0
2025-12-21 23:56:32 INFO   spearman_secondary_weight = 1.0
2025-12-21 23:56:32 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-21 23:56:32 INFO   tuning_max_samples = 500
2025-12-21 23:56:32 INFO   tuning_fraction = None
2025-12-21 23:56:32 INFO   tuning_eval_every = 1
2025-12-21 23:56:32 INFO   rank_loss_weight = 0.0
2025-12-21 23:56:32 INFO   rank_loss_margin = 0.0
2025-12-21 23:56:32 INFO   rank_loss_mode = hinge
2025-12-21 23:56:32 INFO   rank_loss_grouped = True
2025-12-21 23:56:32 INFO   variance_reduction_enabled = False
2025-12-21 23:56:32 INFO   variance_reduction_method = topk_avg
2025-12-21 23:56:32 INFO   variance_reduction_top_k = 3
2025-12-21 23:56:32 INFO   coverage_minimum = 0.0
2025-12-21 23:56:32 INFO   coverage_fail_on_missing = False
2025-12-21 23:56:32 INFO   graph_load_profiling = False
2025-12-21 23:56:32 INFO   graph_load_top_k = 5
2025-12-21 23:56:32 INFO   enable_graph_cache = True
2025-12-21 23:56:32 INFO   graph_cache_size = 256
2025-12-21 23:56:32 INFO   canonicalize_on_load = False
2025-12-21 23:56:32 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-21 23:56:32 INFO   edge_schema = {}
2025-12-21 23:56:32 INFO   topology_schema = {}
Seed set to 101
2025-12-21 23:56:32 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-21 23:56:32 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-21 23:56:32 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-21 23:56:32 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-21 23:56:32 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-21 23:56:32 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-21 23:56:33 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-21 23:56:33 INFO Tuning group stats: groups=348 groups>=2=37 singletons=311 max_group=11
2025-12-21 23:56:33 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed101/dataset_coverage.json
2025-12-21 23:56:33 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed101/dataset_coverage.json for details.
2025-12-21 23:56:33 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed101/dataset_coverage.json for details.
2025-12-21 23:56:33 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed101/dataset_coverage.json for details.
2025-12-21 23:56:33 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed101/schema_summary.json
2025-12-21 23:56:33 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed101/feature_metadata.json
2025-12-21 23:56:33 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-21 23:56:33 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/feature-config.yaml.topoqa.10A.2, sha256=5c62898155179232a565e24d9fbd7b208f9ce480d1a19d6139de19454e173ff0
2025-12-21 23:56:33 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/work/edge_features)
2025-12-21 23:56:33 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json
2025-12-21 23:56:33 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed101/schema_summary.json
2025-12-21 23:56:33 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-21 23:56:33 INFO Topology: topology/persistence_basic/v1 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 172-dimensional node features.
2025-12-21 23:56:33 INFO Node: node/dssp_topo_merge/v1; metadata lists 172 feature columns matching the .pt tensor.
2025-12-21 23:56:33 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-21 23:56:33 INFO → Total feature dimensionality observed and confirmed: node_dim = 172, edge_dim = 11.
2025-12-21 23:56:33 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-21 23:56:33 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 172,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 172,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed101/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge/v1",
      "alias": "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA",
      "jobs": 16,
      "summary": "DSSP-derived node features merged with topology statistics."
    },
    "topology": {
      "id": "topology/persistence_basic/v1",
      "alias": "Betti 0 and Betti 1 topology summaries on interface coords = 140D PH | TopoQA",
      "jobs": 16,
      "summary": "Persistent homology features with configurable distance thresholds."
    }
  },
  "notes": []
}
2025-12-21 23:56:33 INFO DataLoader num_workers=0 (recommended for macOS to avoid spawn issues; configurable via config.yaml -> num_workers).
2025-12-21 23:56:33 INFO Resuming from checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase1/model_checkpoints/checkpoint.tuning_rank_spearman--0.06525_val-0.06370_epoch024.chkpt (epoch=24)
2025-12-21 23:56:33 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=d6517ac512554f21967bdef53dac9836)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-21 23:56:33 INFO Starting training (fast_dev_run=False)
2025-12-21 23:56:33 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed101/model_checkpoints exists and is not empty.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase1/model_checkpoints/checkpoint.tuning_rank_spearman--0.06525_val-0.06370_epoch024.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase1/model_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed101/model_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase1/model_checkpoints/val_loss_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed101/model_checkpoints/val_loss_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 5.5 K  | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
165 K     Trainable params
0         Non-trainable params
165 K     Total params
0.662     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
Restored all states from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase1/model_checkpoints/checkpoint.tuning_rank_spearman--0.06525_val-0.06370_epoch024.chkpt
2025-12-21 23:56:36 INFO Epoch 025 | 25% complete (batch 136/543)
2025-12-21 23:56:39 INFO Epoch 025 | 50% complete (batch 272/543)
2025-12-21 23:56:41 INFO Epoch 025 | 75% complete (batch 408/543)
2025-12-21 23:56:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.064643
2025-12-21 23:56:47 INFO Tuning ranking metrics: regret=0.114462 spearman=0.058904 (groups=37, skipped=311)
2025-12-21 23:56:47 INFO Epoch 025 | val_loss=0.064643
Metric tuning_rank_spearman improved by 0.047 >= min_delta = 0.0. New best score: 0.059
2025-12-21 23:56:50 INFO Epoch 026 | 25% complete (batch 136/543)
2025-12-21 23:56:53 INFO Epoch 026 | 50% complete (batch 272/543)
2025-12-21 23:56:55 INFO Epoch 026 | 75% complete (batch 408/543)
2025-12-21 23:57:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.618765
2025-12-21 23:57:02 INFO Tuning ranking metrics: regret=0.089605 spearman=0.070750 (groups=37, skipped=311)
2025-12-21 23:57:02 INFO Epoch 026 | train_mse=0.062622 | val_loss=0.068943 | best_val_loss=0.058904
Metric tuning_rank_spearman improved by 0.012 >= min_delta = 0.0. New best score: 0.071
2025-12-21 23:57:05 INFO Epoch 027 | 25% complete (batch 136/543)
2025-12-21 23:57:07 INFO Epoch 027 | 50% complete (batch 272/543)
2025-12-21 23:57:10 INFO Epoch 027 | 75% complete (batch 408/543)
2025-12-21 23:57:15 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.605591
2025-12-21 23:57:17 INFO Tuning ranking metrics: regret=0.095321 spearman=0.083912 (groups=37, skipped=311)
2025-12-21 23:57:17 INFO Epoch 027 | train_mse=0.071330 | val_loss=0.063425 | best_val_loss=0.070750
Metric tuning_rank_spearman improved by 0.013 >= min_delta = 0.0. New best score: 0.084
2025-12-21 23:57:19 INFO Epoch 028 | 25% complete (batch 136/543)
2025-12-21 23:57:22 INFO Epoch 028 | 50% complete (batch 272/543)
2025-12-21 23:57:25 INFO Epoch 028 | 75% complete (batch 408/543)
2025-12-21 23:57:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.602842
2025-12-21 23:57:32 INFO Tuning ranking metrics: regret=0.104833 spearman=0.060635 (groups=37, skipped=311)
2025-12-21 23:57:32 INFO Epoch 028 | train_mse=0.068327 | val_loss=0.085617 | best_val_loss=0.083912
2025-12-21 23:57:34 INFO Epoch 029 | 25% complete (batch 136/543)
2025-12-21 23:57:37 INFO Epoch 029 | 50% complete (batch 272/543)
2025-12-21 23:57:40 INFO Epoch 029 | 75% complete (batch 408/543)
2025-12-21 23:57:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.610398
2025-12-21 23:57:47 INFO Tuning ranking metrics: regret=0.091741 spearman=0.160863 (groups=37, skipped=311)
2025-12-21 23:57:47 INFO Epoch 029 | train_mse=0.058486 | val_loss=0.067337 | best_val_loss=0.083912
Metric tuning_rank_spearman improved by 0.077 >= min_delta = 0.0. New best score: 0.161
2025-12-21 23:57:49 INFO Epoch 030 | 25% complete (batch 136/543)
2025-12-21 23:57:52 INFO Epoch 030 | 50% complete (batch 272/543)
2025-12-21 23:57:55 INFO Epoch 030 | 75% complete (batch 408/543)
2025-12-21 23:58:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.620309
2025-12-21 23:58:01 INFO Tuning ranking metrics: regret=0.099230 spearman=0.139213 (groups=37, skipped=311)
2025-12-21 23:58:01 INFO Epoch 030 | train_mse=0.065505 | val_loss=0.068943 | best_val_loss=0.160863
2025-12-21 23:58:04 INFO Epoch 031 | 25% complete (batch 136/543)
2025-12-21 23:58:07 INFO Epoch 031 | 50% complete (batch 272/543)
2025-12-21 23:58:09 INFO Epoch 031 | 75% complete (batch 408/543)
2025-12-21 23:58:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.627625
2025-12-21 23:58:16 INFO Tuning ranking metrics: regret=0.124990 spearman=0.100339 (groups=37, skipped=311)
2025-12-21 23:58:16 INFO Epoch 031 | train_mse=0.061559 | val_loss=0.063938 | best_val_loss=0.160863
2025-12-21 23:58:18 INFO Epoch 032 | 25% complete (batch 136/543)
2025-12-21 23:58:21 INFO Epoch 032 | 50% complete (batch 272/543)
2025-12-21 23:58:24 INFO Epoch 032 | 75% complete (batch 408/543)
2025-12-21 23:58:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.619202
2025-12-21 23:58:30 INFO Tuning ranking metrics: regret=0.106031 spearman=0.096929 (groups=37, skipped=311)
2025-12-21 23:58:30 INFO Epoch 032 | train_mse=0.070444 | val_loss=0.066774 | best_val_loss=0.160863
2025-12-21 23:58:33 INFO Epoch 033 | 25% complete (batch 136/543)
2025-12-21 23:58:35 INFO Epoch 033 | 50% complete (batch 272/543)
2025-12-21 23:58:38 INFO Epoch 033 | 75% complete (batch 408/543)
2025-12-21 23:58:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.641393
2025-12-21 23:58:45 INFO Tuning ranking metrics: regret=0.090473 spearman=0.077957 (groups=37, skipped=311)
2025-12-21 23:58:45 INFO Epoch 033 | train_mse=0.065219 | val_loss=0.060902 | best_val_loss=0.160863
2025-12-21 23:58:48 INFO Epoch 034 | 25% complete (batch 136/543)
2025-12-21 23:58:50 INFO Epoch 034 | 50% complete (batch 272/543)
2025-12-21 23:58:53 INFO Epoch 034 | 75% complete (batch 408/543)
2025-12-21 23:58:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.626064
2025-12-21 23:59:00 INFO Tuning ranking metrics: regret=0.082727 spearman=0.131216 (groups=37, skipped=311)
2025-12-21 23:59:00 INFO Epoch 034 | train_mse=0.056086 | val_loss=0.067164 | best_val_loss=0.160863
2025-12-21 23:59:02 INFO Epoch 035 | 25% complete (batch 136/543)
2025-12-21 23:59:05 INFO Epoch 035 | 50% complete (batch 272/543)
2025-12-21 23:59:08 INFO Epoch 035 | 75% complete (batch 408/543)
2025-12-21 23:59:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.649934
2025-12-21 23:59:14 INFO Tuning ranking metrics: regret=0.091176 spearman=0.201574 (groups=37, skipped=311)
2025-12-21 23:59:14 INFO Epoch 035 | train_mse=0.063814 | val_loss=0.064348 | best_val_loss=0.160863
Metric tuning_rank_spearman improved by 0.041 >= min_delta = 0.0. New best score: 0.202
2025-12-21 23:59:17 INFO Epoch 036 | 25% complete (batch 136/543)
2025-12-21 23:59:20 INFO Epoch 036 | 50% complete (batch 272/543)
2025-12-21 23:59:23 INFO Epoch 036 | 75% complete (batch 408/543)
2025-12-21 23:59:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.600828
2025-12-21 23:59:30 INFO Tuning ranking metrics: regret=0.104495 spearman=0.130906 (groups=37, skipped=311)
2025-12-21 23:59:30 INFO Epoch 036 | train_mse=0.060949 | val_loss=0.062645 | best_val_loss=0.201574
2025-12-21 23:59:32 INFO Epoch 037 | 25% complete (batch 136/543)
2025-12-21 23:59:35 INFO Epoch 037 | 50% complete (batch 272/543)
2025-12-21 23:59:38 INFO Epoch 037 | 75% complete (batch 408/543)
2025-12-21 23:59:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.613745
2025-12-21 23:59:44 INFO Tuning ranking metrics: regret=0.130577 spearman=0.087621 (groups=37, skipped=311)
2025-12-21 23:59:44 INFO Epoch 037 | train_mse=0.057816 | val_loss=0.059040 | best_val_loss=0.201574
2025-12-21 23:59:46 INFO Epoch 038 | 25% complete (batch 136/543)
2025-12-21 23:59:49 INFO Epoch 038 | 50% complete (batch 272/543)
2025-12-21 23:59:53 INFO Epoch 038 | 75% complete (batch 408/543)
2025-12-22 00:00:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.653397
2025-12-22 00:00:01 INFO Tuning ranking metrics: regret=0.083279 spearman=0.140564 (groups=37, skipped=311)
2025-12-22 00:00:01 INFO Epoch 038 | train_mse=0.060529 | val_loss=0.060445 | best_val_loss=0.201574
2025-12-22 00:00:04 INFO Epoch 039 | 25% complete (batch 136/543)
2025-12-22 00:00:07 INFO Epoch 039 | 50% complete (batch 272/543)
2025-12-22 00:00:10 INFO Epoch 039 | 75% complete (batch 408/543)
2025-12-22 00:00:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.651407
2025-12-22 00:00:19 INFO Tuning ranking metrics: regret=0.093699 spearman=0.151843 (groups=37, skipped=311)
2025-12-22 00:00:19 INFO Epoch 039 | train_mse=0.052736 | val_loss=0.058045 | best_val_loss=0.201574
2025-12-22 00:00:23 INFO Epoch 040 | 25% complete (batch 136/543)
2025-12-22 00:00:26 INFO Epoch 040 | 50% complete (batch 272/543)
2025-12-22 00:00:29 INFO Epoch 040 | 75% complete (batch 408/543)
2025-12-22 00:00:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.616399
2025-12-22 00:00:38 INFO Tuning ranking metrics: regret=0.089267 spearman=0.168305 (groups=37, skipped=311)
2025-12-22 00:00:38 INFO Epoch 040 | train_mse=0.048624 | val_loss=0.074884 | best_val_loss=0.201574
2025-12-22 00:00:42 INFO Epoch 041 | 25% complete (batch 136/543)
2025-12-22 00:00:45 INFO Epoch 041 | 50% complete (batch 272/543)
2025-12-22 00:00:48 INFO Epoch 041 | 75% complete (batch 408/543)
2025-12-22 00:00:53 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.593683
2025-12-22 00:00:55 INFO Tuning ranking metrics: regret=0.096485 spearman=0.149982 (groups=37, skipped=311)
2025-12-22 00:00:55 INFO Epoch 041 | train_mse=0.055312 | val_loss=0.099478 | best_val_loss=0.201574
2025-12-22 00:00:58 INFO Epoch 042 | 25% complete (batch 136/543)
2025-12-22 00:01:00 INFO Epoch 042 | 50% complete (batch 272/543)
2025-12-22 00:01:03 INFO Epoch 042 | 75% complete (batch 408/543)
2025-12-22 00:01:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.635178
2025-12-22 00:01:10 INFO Tuning ranking metrics: regret=0.094040 spearman=0.176775 (groups=37, skipped=311)
2025-12-22 00:01:10 INFO Epoch 042 | train_mse=0.056342 | val_loss=0.062706 | best_val_loss=0.201574
2025-12-22 00:01:14 INFO Epoch 043 | 25% complete (batch 136/543)
2025-12-22 00:01:18 INFO Epoch 043 | 50% complete (batch 272/543)
2025-12-22 00:01:22 INFO Epoch 043 | 75% complete (batch 408/543)
2025-12-22 00:01:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.632160
2025-12-22 00:01:30 INFO Tuning ranking metrics: regret=0.091480 spearman=0.184925 (groups=37, skipped=311)
2025-12-22 00:01:30 INFO Epoch 043 | train_mse=0.065556 | val_loss=0.056483 | best_val_loss=0.201574
2025-12-22 00:01:34 INFO Epoch 044 | 25% complete (batch 136/543)
2025-12-22 00:01:38 INFO Epoch 044 | 50% complete (batch 272/543)
2025-12-22 00:01:42 INFO Epoch 044 | 75% complete (batch 408/543)
2025-12-22 00:01:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.633031
2025-12-22 00:01:51 INFO Tuning ranking metrics: regret=0.088149 spearman=0.167685 (groups=37, skipped=311)
2025-12-22 00:01:51 INFO Epoch 044 | train_mse=0.055725 | val_loss=0.057844 | best_val_loss=0.201574
2025-12-22 00:01:54 INFO Epoch 045 | 25% complete (batch 136/543)
2025-12-22 00:01:57 INFO Epoch 045 | 50% complete (batch 272/543)
2025-12-22 00:02:00 INFO Epoch 045 | 75% complete (batch 408/543)
2025-12-22 00:02:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.629320
2025-12-22 00:02:07 INFO Tuning ranking metrics: regret=0.111488 spearman=0.095800 (groups=37, skipped=311)
2025-12-22 00:02:07 INFO Epoch 045 | train_mse=0.052345 | val_loss=0.063710 | best_val_loss=0.201574
2025-12-22 00:02:10 INFO Epoch 046 | 25% complete (batch 136/543)
2025-12-22 00:02:13 INFO Epoch 046 | 50% complete (batch 272/543)
2025-12-22 00:02:16 INFO Epoch 046 | 75% complete (batch 408/543)
2025-12-22 00:02:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.628218
2025-12-22 00:02:22 INFO Tuning ranking metrics: regret=0.106046 spearman=0.127425 (groups=37, skipped=311)
2025-12-22 00:02:22 INFO Epoch 046 | train_mse=0.062425 | val_loss=0.062237 | best_val_loss=0.201574
2025-12-22 00:02:25 INFO Epoch 047 | 25% complete (batch 136/543)
2025-12-22 00:02:28 INFO Epoch 047 | 50% complete (batch 272/543)
2025-12-22 00:02:31 INFO Epoch 047 | 75% complete (batch 408/543)
2025-12-22 00:02:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.641117
2025-12-22 00:02:38 INFO Tuning ranking metrics: regret=0.092170 spearman=0.183795 (groups=37, skipped=311)
2025-12-22 00:02:38 INFO Epoch 047 | train_mse=0.050519 | val_loss=0.056179 | best_val_loss=0.201574
2025-12-22 00:02:41 INFO Epoch 048 | 25% complete (batch 136/543)
2025-12-22 00:02:44 INFO Epoch 048 | 50% complete (batch 272/543)
2025-12-22 00:02:46 INFO Epoch 048 | 75% complete (batch 408/543)
2025-12-22 00:02:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.643141
2025-12-22 00:02:53 INFO Tuning ranking metrics: regret=0.084037 spearman=0.143618 (groups=37, skipped=311)
2025-12-22 00:02:53 INFO Epoch 048 | train_mse=0.063528 | val_loss=0.052886 | best_val_loss=0.201574
2025-12-22 00:02:56 INFO Epoch 049 | 25% complete (batch 136/543)
2025-12-22 00:02:59 INFO Epoch 049 | 50% complete (batch 272/543)
2025-12-22 00:03:02 INFO Epoch 049 | 75% complete (batch 408/543)
2025-12-22 00:03:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.649063
2025-12-22 00:03:09 INFO Tuning ranking metrics: regret=0.083802 spearman=0.127577 (groups=37, skipped=311)
2025-12-22 00:03:09 INFO Epoch 049 | train_mse=0.052704 | val_loss=0.066742 | best_val_loss=0.201574
2025-12-22 00:03:12 INFO Epoch 050 | 25% complete (batch 136/543)
2025-12-22 00:03:15 INFO Epoch 050 | 50% complete (batch 272/543)
2025-12-22 00:03:17 INFO Epoch 050 | 75% complete (batch 408/543)
2025-12-22 00:03:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.654210
2025-12-22 00:03:24 INFO Tuning ranking metrics: regret=0.074368 spearman=0.182134 (groups=37, skipped=311)
2025-12-22 00:03:24 INFO Epoch 050 | train_mse=0.050735 | val_loss=0.056695 | best_val_loss=0.201574
2025-12-22 00:03:27 INFO Epoch 051 | 25% complete (batch 136/543)
2025-12-22 00:03:30 INFO Epoch 051 | 50% complete (batch 272/543)
2025-12-22 00:03:33 INFO Epoch 051 | 75% complete (batch 408/543)
2025-12-22 00:03:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.643457
2025-12-22 00:03:41 INFO Tuning ranking metrics: regret=0.095741 spearman=0.117521 (groups=37, skipped=311)
2025-12-22 00:03:41 INFO Epoch 051 | train_mse=0.056542 | val_loss=0.055633 | best_val_loss=0.201574
2025-12-22 00:03:44 INFO Epoch 052 | 25% complete (batch 136/543)
2025-12-22 00:03:46 INFO Epoch 052 | 50% complete (batch 272/543)
2025-12-22 00:03:49 INFO Epoch 052 | 75% complete (batch 408/543)
2025-12-22 00:03:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.650268
2025-12-22 00:03:56 INFO Tuning ranking metrics: regret=0.081254 spearman=0.114356 (groups=37, skipped=311)
2025-12-22 00:03:56 INFO Epoch 052 | train_mse=0.054520 | val_loss=0.055010 | best_val_loss=0.201574
2025-12-22 00:03:59 INFO Epoch 053 | 25% complete (batch 136/543)
2025-12-22 00:04:01 INFO Epoch 053 | 50% complete (batch 272/543)
2025-12-22 00:04:04 INFO Epoch 053 | 75% complete (batch 408/543)
2025-12-22 00:04:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.644941
2025-12-22 00:04:11 INFO Tuning ranking metrics: regret=0.097345 spearman=0.127998 (groups=37, skipped=311)
2025-12-22 00:04:11 INFO Epoch 053 | train_mse=0.050670 | val_loss=0.062688 | best_val_loss=0.201574
2025-12-22 00:04:14 INFO Epoch 054 | 25% complete (batch 136/543)
2025-12-22 00:04:16 INFO Epoch 054 | 50% complete (batch 272/543)
2025-12-22 00:04:19 INFO Epoch 054 | 75% complete (batch 408/543)
2025-12-22 00:04:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.661416
2025-12-22 00:04:26 INFO Tuning ranking metrics: regret=0.095927 spearman=0.080777 (groups=37, skipped=311)
2025-12-22 00:04:26 INFO Epoch 054 | train_mse=0.054325 | val_loss=0.053778 | best_val_loss=0.201574
2025-12-22 00:04:29 INFO Epoch 055 | 25% complete (batch 136/543)
2025-12-22 00:04:32 INFO Epoch 055 | 50% complete (batch 272/543)
2025-12-22 00:04:35 INFO Epoch 055 | 75% complete (batch 408/543)
2025-12-22 00:04:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.651536
2025-12-22 00:04:42 INFO Tuning ranking metrics: regret=0.084548 spearman=0.152194 (groups=37, skipped=311)
2025-12-22 00:04:42 INFO Epoch 055 | train_mse=0.044768 | val_loss=0.057902 | best_val_loss=0.201574
2025-12-22 00:04:45 INFO Epoch 056 | 25% complete (batch 136/543)
2025-12-22 00:04:48 INFO Epoch 056 | 50% complete (batch 272/543)
2025-12-22 00:04:51 INFO Epoch 056 | 75% complete (batch 408/543)
2025-12-22 00:04:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.644626
2025-12-22 00:04:58 INFO Tuning ranking metrics: regret=0.068438 spearman=0.173652 (groups=37, skipped=311)
2025-12-22 00:04:58 INFO Epoch 056 | train_mse=0.044867 | val_loss=0.056219 | best_val_loss=0.201574
2025-12-22 00:05:00 INFO Epoch 057 | 25% complete (batch 136/543)
2025-12-22 00:05:03 INFO Epoch 057 | 50% complete (batch 272/543)
2025-12-22 00:05:06 INFO Epoch 057 | 75% complete (batch 408/543)
2025-12-22 00:05:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.652779
2025-12-22 00:05:14 INFO Tuning ranking metrics: regret=0.085737 spearman=0.108951 (groups=37, skipped=311)
2025-12-22 00:05:14 INFO Epoch 057 | train_mse=0.044976 | val_loss=0.055317 | best_val_loss=0.201574
2025-12-22 00:05:17 INFO Epoch 058 | 25% complete (batch 136/543)
2025-12-22 00:05:19 INFO Epoch 058 | 50% complete (batch 272/543)
2025-12-22 00:05:22 INFO Epoch 058 | 75% complete (batch 408/543)
2025-12-22 00:05:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.656712
2025-12-22 00:05:29 INFO Tuning ranking metrics: regret=0.087094 spearman=0.180660 (groups=37, skipped=311)
2025-12-22 00:05:29 INFO Epoch 058 | train_mse=0.048951 | val_loss=0.054269 | best_val_loss=0.201574
2025-12-22 00:05:32 INFO Epoch 059 | 25% complete (batch 136/543)
2025-12-22 00:05:34 INFO Epoch 059 | 50% complete (batch 272/543)
2025-12-22 00:05:37 INFO Epoch 059 | 75% complete (batch 408/543)
2025-12-22 00:05:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.661491
2025-12-22 00:05:44 INFO Tuning ranking metrics: regret=0.087428 spearman=0.154505 (groups=37, skipped=311)
2025-12-22 00:05:44 INFO Epoch 059 | train_mse=0.049160 | val_loss=0.052890 | best_val_loss=0.201574
Monitored metric tuning_rank_spearman did not improve in the last 24 records. Best score: 0.202. Signaling Trainer to stop.
2025-12-22 00:05:44 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.18380_val-0.05618_epoch047.chkpt, checkpoint.tuning_rank_spearman-0.18492_val-0.05648_epoch043.chkpt, checkpoint.tuning_rank_spearman-0.20157_val-0.06435_epoch035.chkpt
2025-12-22 00:05:44 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed101/model_checkpoints/checkpoint.tuning_rank_spearman-0.20157_val-0.06435_epoch035.chkpt
2025-12-22 00:05:44 INFO Best validation loss: tensor(0.2016)
2025-12-22 00:05:44 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed101/model_checkpoints/checkpoint.tuning_rank_spearman-0.20157_val-0.06435_epoch035.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed101/model_checkpoints/checkpoint.tuning_rank_spearman-0.20157_val-0.06435_epoch035.chkpt
2025-12-22 00:05:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.064348
2025-12-22 00:05:48 INFO Tuning ranking metrics: regret=0.091176 spearman=0.201574 (groups=37, skipped=311)
2025-12-22 00:05:48 INFO Epoch 060 | val_loss=0.064348 | best_val_loss=0.201574
2025-12-22 00:05:48 INFO Validation metrics: [{'val_loss': 0.06434846669435501, 'tuning_rank_regret': 0.09117627888917923, 'tuning_rank_spearman': 0.20157365500926971, 'val_pearson_corr': 0.7395699620246887, 'val_spearman_corr': 0.6634730100631714, 'val_rank_regret': 0.1422751396894455, 'val_rank_spearman': 0.21190476417541504}]
2025-12-22 00:05:48 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.20157_val-0.06435_epoch035.chkpt
2025-12-22 00:05:48 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.18492_val-0.05648_epoch043.chkpt
2025-12-22 00:05:48 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.18380_val-0.05618_epoch047.chkpt
2025-12-22 00:05:48 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.06090_epoch033.ckpt
2025-12-22 00:05:48 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
USING ADAM
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.09117627888917923
  tuning_rank_spearman      0.20157365500926971
        val_loss            0.06434846669435501
    val_pearson_corr        0.7395699620246887
     val_rank_regret        0.1422751396894455
    val_rank_spearman       0.21190476417541504
    val_spearman_corr       0.6634730100631714
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed101 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed101
[run_full_pipeline] Phase 2 (seed 101) best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed101/model_checkpoints/checkpoint.tuning_rank_spearman-0.20157_val-0.06435_epoch035.chkpt (tuning_rank_spearman=0.20157365500926971)
[run_full_pipeline] Phase 2 fine-tuning (seed 555) -> sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed555
[train_cli] run_id=sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed555 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed555/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed555 --git-commit cf515fb092 --git-dirty --resume-from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase1/model_checkpoints/checkpoint.tuning_rank_spearman--0.06525_val-0.06370_epoch024.chkpt
2025-12-22 00:05:52 INFO git_commit = cf515fb092 (dirty)
2025-12-22 00:05:52 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-22 00:05:52 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed555/config/config.yaml
2025-12-22 00:05:52 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data
2025-12-22 00:05:52 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-22 00:05:52 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-22 00:05:52 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed555
2025-12-22 00:05:52 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-22 00:05:52 INFO   metadata_path = None
2025-12-22 00:05:52 INFO   summary_path = None
2025-12-22 00:05:52 INFO   accelerator = cpu
2025-12-22 00:05:52 INFO   devices = 1
2025-12-22 00:05:52 INFO   attention_head = 8
2025-12-22 00:05:52 INFO   pooling_type = mean
2025-12-22 00:05:52 INFO   model_self_loops = False
2025-12-22 00:05:52 INFO   model_self_loop_fill = mean
2025-12-22 00:05:52 INFO   model_residual = False
2025-12-22 00:05:52 INFO   batch_size = 16
2025-12-22 00:05:52 INFO   learning_rate = 0.001
2025-12-22 00:05:52 INFO   num_epochs = 320
2025-12-22 00:05:52 INFO   accumulate_grad_batches = 16
2025-12-22 00:05:52 INFO   seed = 555
2025-12-22 00:05:52 INFO   num_workers = 0
2025-12-22 00:05:52 INFO   precision = 32
2025-12-22 00:05:52 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-22 00:05:52 INFO   early_stopping_patience = 20
2025-12-22 00:05:52 INFO   lr_scheduler_patience = 4
2025-12-22 00:05:52 INFO   lr_scheduler_factor = 0.2
2025-12-22 00:05:52 INFO   fast_dev_run = False
2025-12-22 00:05:52 INFO   limit_train_batches = None
2025-12-22 00:05:52 INFO   limit_val_batches = None
2025-12-22 00:05:52 INFO   log_lr = False
2025-12-22 00:05:52 INFO   progress_bar_refresh_rate = 0
2025-12-22 00:05:52 INFO   log_every_n_steps = 100
2025-12-22 00:05:52 INFO   use_val_spearman_as_secondary = True
2025-12-22 00:05:52 INFO   spearman_secondary_min_delta = 0.0
2025-12-22 00:05:52 INFO   spearman_secondary_weight = 1.0
2025-12-22 00:05:52 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-22 00:05:52 INFO   tuning_max_samples = 500
2025-12-22 00:05:52 INFO   tuning_fraction = None
2025-12-22 00:05:52 INFO   tuning_eval_every = 1
2025-12-22 00:05:52 INFO   rank_loss_weight = 0.0
2025-12-22 00:05:52 INFO   rank_loss_margin = 0.0
2025-12-22 00:05:52 INFO   rank_loss_mode = hinge
2025-12-22 00:05:52 INFO   rank_loss_grouped = True
2025-12-22 00:05:52 INFO   variance_reduction_enabled = False
2025-12-22 00:05:52 INFO   variance_reduction_method = topk_avg
2025-12-22 00:05:52 INFO   variance_reduction_top_k = 3
2025-12-22 00:05:52 INFO   coverage_minimum = 0.0
2025-12-22 00:05:52 INFO   coverage_fail_on_missing = False
2025-12-22 00:05:52 INFO   graph_load_profiling = False
2025-12-22 00:05:52 INFO   graph_load_top_k = 5
2025-12-22 00:05:52 INFO   enable_graph_cache = True
2025-12-22 00:05:52 INFO   graph_cache_size = 256
2025-12-22 00:05:52 INFO   canonicalize_on_load = False
2025-12-22 00:05:52 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-22 00:05:52 INFO   edge_schema = {}
2025-12-22 00:05:52 INFO   topology_schema = {}
Seed set to 555
2025-12-22 00:05:53 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-22 00:05:53 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 00:05:53 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-22 00:05:53 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 00:05:53 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-22 00:05:53 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 00:05:54 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-22 00:05:54 INFO Tuning group stats: groups=368 groups>=2=39 singletons=329 max_group=9
2025-12-22 00:05:54 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed555/dataset_coverage.json
2025-12-22 00:05:54 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed555/dataset_coverage.json for details.
2025-12-22 00:05:54 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed555/dataset_coverage.json for details.
2025-12-22 00:05:54 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed555/dataset_coverage.json for details.
2025-12-22 00:05:54 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed555/schema_summary.json
2025-12-22 00:05:54 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed555/feature_metadata.json
2025-12-22 00:05:54 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-22 00:05:54 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/feature-config.yaml.topoqa.10A.2, sha256=5c62898155179232a565e24d9fbd7b208f9ce480d1a19d6139de19454e173ff0
2025-12-22 00:05:54 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/work/edge_features)
2025-12-22 00:05:54 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json
2025-12-22 00:05:54 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed555/schema_summary.json
2025-12-22 00:05:54 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-22 00:05:54 INFO Topology: topology/persistence_basic/v1 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 172-dimensional node features.
2025-12-22 00:05:54 INFO Node: node/dssp_topo_merge/v1; metadata lists 172 feature columns matching the .pt tensor.
2025-12-22 00:05:54 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-22 00:05:54 INFO → Total feature dimensionality observed and confirmed: node_dim = 172, edge_dim = 11.
2025-12-22 00:05:54 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-22 00:05:54 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 172,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 172,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed555/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge/v1",
      "alias": "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA",
      "jobs": 16,
      "summary": "DSSP-derived node features merged with topology statistics."
    },
    "topology": {
      "id": "topology/persistence_basic/v1",
      "alias": "Betti 0 and Betti 1 topology summaries on interface coords = 140D PH | TopoQA",
      "jobs": 16,
      "summary": "Persistent homology features with configurable distance thresholds."
    }
  },
  "notes": []
}
2025-12-22 00:05:54 INFO DataLoader num_workers=0 (recommended for macOS to avoid spawn issues; configurable via config.yaml -> num_workers).
2025-12-22 00:05:54 INFO Resuming from checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase1/model_checkpoints/checkpoint.tuning_rank_spearman--0.06525_val-0.06370_epoch024.chkpt (epoch=24)
2025-12-22 00:05:54 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=c38ea2957f5b4435a6cf25ff055ba47d)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-22 00:05:54 INFO Starting training (fast_dev_run=False)
2025-12-22 00:05:54 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed555/model_checkpoints exists and is not empty.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase1/model_checkpoints/checkpoint.tuning_rank_spearman--0.06525_val-0.06370_epoch024.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase1/model_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed555/model_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase1/model_checkpoints/val_loss_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed555/model_checkpoints/val_loss_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 5.5 K  | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
165 K     Trainable params
0         Non-trainable params
165 K     Total params
0.662     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
Restored all states from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase1/model_checkpoints/checkpoint.tuning_rank_spearman--0.06525_val-0.06370_epoch024.chkpt
2025-12-22 00:05:57 INFO Epoch 025 | 25% complete (batch 136/543)
2025-12-22 00:05:59 INFO Epoch 025 | 50% complete (batch 272/543)
2025-12-22 00:06:02 INFO Epoch 025 | 75% complete (batch 408/543)
2025-12-22 00:06:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.066306
2025-12-22 00:06:08 INFO Tuning ranking metrics: regret=0.087104 spearman=0.218193 (groups=39, skipped=329)
2025-12-22 00:06:08 INFO Epoch 025 | val_loss=0.066306
Metric tuning_rank_spearman improved by 0.206 >= min_delta = 0.0. New best score: 0.218
2025-12-22 00:06:11 INFO Epoch 026 | 25% complete (batch 136/543)
2025-12-22 00:06:14 INFO Epoch 026 | 50% complete (batch 272/543)
2025-12-22 00:06:16 INFO Epoch 026 | 75% complete (batch 408/543)
2025-12-22 00:06:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.593203
2025-12-22 00:06:23 INFO Tuning ranking metrics: regret=0.104884 spearman=0.283578 (groups=39, skipped=329)
2025-12-22 00:06:23 INFO Epoch 026 | train_mse=0.056211 | val_loss=0.066536 | best_val_loss=0.218193
Metric tuning_rank_spearman improved by 0.065 >= min_delta = 0.0. New best score: 0.284
2025-12-22 00:06:26 INFO Epoch 027 | 25% complete (batch 136/543)
2025-12-22 00:06:28 INFO Epoch 027 | 50% complete (batch 272/543)
2025-12-22 00:06:32 INFO Epoch 027 | 75% complete (batch 408/543)
2025-12-22 00:06:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.606344
2025-12-22 00:06:38 INFO Tuning ranking metrics: regret=0.114216 spearman=0.242125 (groups=39, skipped=329)
2025-12-22 00:06:38 INFO Epoch 027 | train_mse=0.078810 | val_loss=0.063111 | best_val_loss=0.283578
2025-12-22 00:06:41 INFO Epoch 028 | 25% complete (batch 136/543)
2025-12-22 00:06:43 INFO Epoch 028 | 50% complete (batch 272/543)
2025-12-22 00:06:46 INFO Epoch 028 | 75% complete (batch 408/543)
2025-12-22 00:06:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.625766
2025-12-22 00:06:52 INFO Tuning ranking metrics: regret=0.109205 spearman=0.253175 (groups=39, skipped=329)
2025-12-22 00:06:52 INFO Epoch 028 | train_mse=0.071442 | val_loss=0.061937 | best_val_loss=0.283578
2025-12-22 00:06:55 INFO Epoch 029 | 25% complete (batch 136/543)
2025-12-22 00:06:58 INFO Epoch 029 | 50% complete (batch 272/543)
2025-12-22 00:07:00 INFO Epoch 029 | 75% complete (batch 408/543)
2025-12-22 00:07:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.623908
2025-12-22 00:07:07 INFO Tuning ranking metrics: regret=0.109005 spearman=0.261233 (groups=39, skipped=329)
2025-12-22 00:07:07 INFO Epoch 029 | train_mse=0.065787 | val_loss=0.065245 | best_val_loss=0.283578
2025-12-22 00:07:10 INFO Epoch 030 | 25% complete (batch 136/543)
2025-12-22 00:07:13 INFO Epoch 030 | 50% complete (batch 272/543)
2025-12-22 00:07:15 INFO Epoch 030 | 75% complete (batch 408/543)
2025-12-22 00:07:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.614088
2025-12-22 00:07:22 INFO Tuning ranking metrics: regret=0.106219 spearman=0.279853 (groups=39, skipped=329)
2025-12-22 00:07:22 INFO Epoch 030 | train_mse=0.060656 | val_loss=0.069046 | best_val_loss=0.283578
2025-12-22 00:07:24 INFO Epoch 031 | 25% complete (batch 136/543)
2025-12-22 00:07:27 INFO Epoch 031 | 50% complete (batch 272/543)
2025-12-22 00:07:30 INFO Epoch 031 | 75% complete (batch 408/543)
2025-12-22 00:07:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.575515
2025-12-22 00:07:37 INFO Tuning ranking metrics: regret=0.074110 spearman=0.229548 (groups=39, skipped=329)
2025-12-22 00:07:37 INFO Epoch 031 | train_mse=0.053702 | val_loss=0.081165 | best_val_loss=0.283578
2025-12-22 00:07:40 INFO Epoch 032 | 25% complete (batch 136/543)
2025-12-22 00:07:42 INFO Epoch 032 | 50% complete (batch 272/543)
2025-12-22 00:07:45 INFO Epoch 032 | 75% complete (batch 408/543)
2025-12-22 00:07:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.630975
2025-12-22 00:07:51 INFO Tuning ranking metrics: regret=0.073126 spearman=0.306288 (groups=39, skipped=329)
2025-12-22 00:07:51 INFO Epoch 032 | train_mse=0.061822 | val_loss=0.061386 | best_val_loss=0.283578
Metric tuning_rank_spearman improved by 0.023 >= min_delta = 0.0. New best score: 0.306
2025-12-22 00:07:54 INFO Epoch 033 | 25% complete (batch 136/543)
2025-12-22 00:07:57 INFO Epoch 033 | 50% complete (batch 272/543)
2025-12-22 00:07:59 INFO Epoch 033 | 75% complete (batch 408/543)
2025-12-22 00:08:04 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.631779
2025-12-22 00:08:05 INFO Tuning ranking metrics: regret=0.080957 spearman=0.308669 (groups=39, skipped=329)
2025-12-22 00:08:05 INFO Epoch 033 | train_mse=0.069637 | val_loss=0.064259 | best_val_loss=0.306288
Metric tuning_rank_spearman improved by 0.002 >= min_delta = 0.0. New best score: 0.309
2025-12-22 00:08:08 INFO Epoch 034 | 25% complete (batch 136/543)
2025-12-22 00:08:11 INFO Epoch 034 | 50% complete (batch 272/543)
2025-12-22 00:08:13 INFO Epoch 034 | 75% complete (batch 408/543)
2025-12-22 00:08:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.619364
2025-12-22 00:08:19 INFO Tuning ranking metrics: regret=0.097609 spearman=0.251160 (groups=39, skipped=329)
2025-12-22 00:08:19 INFO Epoch 034 | train_mse=0.059843 | val_loss=0.067553 | best_val_loss=0.308669
2025-12-22 00:08:22 INFO Epoch 035 | 25% complete (batch 136/543)
2025-12-22 00:08:24 INFO Epoch 035 | 50% complete (batch 272/543)
2025-12-22 00:08:27 INFO Epoch 035 | 75% complete (batch 408/543)
2025-12-22 00:08:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.642183
2025-12-22 00:08:33 INFO Tuning ranking metrics: regret=0.093670 spearman=0.280159 (groups=39, skipped=329)
2025-12-22 00:08:33 INFO Epoch 035 | train_mse=0.058316 | val_loss=0.062577 | best_val_loss=0.308669
2025-12-22 00:08:36 INFO Epoch 036 | 25% complete (batch 136/543)
2025-12-22 00:08:39 INFO Epoch 036 | 50% complete (batch 272/543)
2025-12-22 00:08:42 INFO Epoch 036 | 75% complete (batch 408/543)
2025-12-22 00:08:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.634368
2025-12-22 00:08:48 INFO Tuning ranking metrics: regret=0.092400 spearman=0.234005 (groups=39, skipped=329)
2025-12-22 00:08:48 INFO Epoch 036 | train_mse=0.049399 | val_loss=0.059673 | best_val_loss=0.308669
2025-12-22 00:08:51 INFO Epoch 037 | 25% complete (batch 136/543)
2025-12-22 00:08:54 INFO Epoch 037 | 50% complete (batch 272/543)
2025-12-22 00:08:57 INFO Epoch 037 | 75% complete (batch 408/543)
2025-12-22 00:09:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.652134
2025-12-22 00:09:03 INFO Tuning ranking metrics: regret=0.089014 spearman=0.286935 (groups=39, skipped=329)
2025-12-22 00:09:03 INFO Epoch 037 | train_mse=0.059040 | val_loss=0.055143 | best_val_loss=0.308669
2025-12-22 00:09:05 INFO Epoch 038 | 25% complete (batch 136/543)
2025-12-22 00:09:08 INFO Epoch 038 | 50% complete (batch 272/543)
2025-12-22 00:09:11 INFO Epoch 038 | 75% complete (batch 408/543)
2025-12-22 00:09:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.658760
2025-12-22 00:09:17 INFO Tuning ranking metrics: regret=0.068711 spearman=0.327411 (groups=39, skipped=329)
2025-12-22 00:09:17 INFO Epoch 038 | train_mse=0.061617 | val_loss=0.058701 | best_val_loss=0.308669
Metric tuning_rank_spearman improved by 0.019 >= min_delta = 0.0. New best score: 0.327
2025-12-22 00:09:20 INFO Epoch 039 | 25% complete (batch 136/543)
2025-12-22 00:09:22 INFO Epoch 039 | 50% complete (batch 272/543)
2025-12-22 00:09:25 INFO Epoch 039 | 75% complete (batch 408/543)
2025-12-22 00:09:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.635284
2025-12-22 00:09:31 INFO Tuning ranking metrics: regret=0.108330 spearman=0.239133 (groups=39, skipped=329)
2025-12-22 00:09:31 INFO Epoch 039 | train_mse=0.054879 | val_loss=0.068370 | best_val_loss=0.327411
2025-12-22 00:09:34 INFO Epoch 040 | 25% complete (batch 136/543)
2025-12-22 00:09:37 INFO Epoch 040 | 50% complete (batch 272/543)
2025-12-22 00:09:39 INFO Epoch 040 | 75% complete (batch 408/543)
2025-12-22 00:09:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.568572
2025-12-22 00:09:46 INFO Tuning ranking metrics: regret=0.091020 spearman=0.271490 (groups=39, skipped=329)
2025-12-22 00:09:46 INFO Epoch 040 | train_mse=0.052563 | val_loss=0.121899 | best_val_loss=0.327411
2025-12-22 00:09:49 INFO Epoch 041 | 25% complete (batch 136/543)
2025-12-22 00:09:51 INFO Epoch 041 | 50% complete (batch 272/543)
2025-12-22 00:09:54 INFO Epoch 041 | 75% complete (batch 408/543)
2025-12-22 00:09:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.628084
2025-12-22 00:10:01 INFO Tuning ranking metrics: regret=0.070047 spearman=0.297619 (groups=39, skipped=329)
2025-12-22 00:10:01 INFO Epoch 041 | train_mse=0.063858 | val_loss=0.064328 | best_val_loss=0.327411
2025-12-22 00:10:04 INFO Epoch 042 | 25% complete (batch 136/543)
2025-12-22 00:10:07 INFO Epoch 042 | 50% complete (batch 272/543)
2025-12-22 00:10:09 INFO Epoch 042 | 75% complete (batch 408/543)
2025-12-22 00:10:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.646367
2025-12-22 00:10:16 INFO Tuning ranking metrics: regret=0.092163 spearman=0.250611 (groups=39, skipped=329)
2025-12-22 00:10:16 INFO Epoch 042 | train_mse=0.071403 | val_loss=0.062032 | best_val_loss=0.327411
2025-12-22 00:10:19 INFO Epoch 043 | 25% complete (batch 136/543)
2025-12-22 00:10:21 INFO Epoch 043 | 50% complete (batch 272/543)
2025-12-22 00:10:24 INFO Epoch 043 | 75% complete (batch 408/543)
2025-12-22 00:10:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.653146
2025-12-22 00:10:31 INFO Tuning ranking metrics: regret=0.080185 spearman=0.372161 (groups=39, skipped=329)
2025-12-22 00:10:31 INFO Epoch 043 | train_mse=0.059151 | val_loss=0.060599 | best_val_loss=0.327411
Metric tuning_rank_spearman improved by 0.045 >= min_delta = 0.0. New best score: 0.372
2025-12-22 00:10:33 INFO Epoch 044 | 25% complete (batch 136/543)
2025-12-22 00:10:36 INFO Epoch 044 | 50% complete (batch 272/543)
2025-12-22 00:10:39 INFO Epoch 044 | 75% complete (batch 408/543)
2025-12-22 00:10:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.618328
2025-12-22 00:10:45 INFO Tuning ranking metrics: regret=0.089871 spearman=0.321368 (groups=39, skipped=329)
2025-12-22 00:10:45 INFO Epoch 044 | train_mse=0.067855 | val_loss=0.059619 | best_val_loss=0.372161
2025-12-22 00:10:48 INFO Epoch 045 | 25% complete (batch 136/543)
2025-12-22 00:10:51 INFO Epoch 045 | 50% complete (batch 272/543)
2025-12-22 00:10:54 INFO Epoch 045 | 75% complete (batch 408/543)
2025-12-22 00:10:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.643572
2025-12-22 00:11:01 INFO Tuning ranking metrics: regret=0.105166 spearman=0.215507 (groups=39, skipped=329)
2025-12-22 00:11:01 INFO Epoch 045 | train_mse=0.054745 | val_loss=0.057274 | best_val_loss=0.372161
2025-12-22 00:11:03 INFO Epoch 046 | 25% complete (batch 136/543)
2025-12-22 00:11:06 INFO Epoch 046 | 50% complete (batch 272/543)
2025-12-22 00:11:09 INFO Epoch 046 | 75% complete (batch 408/543)
2025-12-22 00:11:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.648009
2025-12-22 00:11:16 INFO Tuning ranking metrics: regret=0.089864 spearman=0.285653 (groups=39, skipped=329)
2025-12-22 00:11:16 INFO Epoch 046 | train_mse=0.057088 | val_loss=0.056113 | best_val_loss=0.372161
2025-12-22 00:11:18 INFO Epoch 047 | 25% complete (batch 136/543)
2025-12-22 00:11:21 INFO Epoch 047 | 50% complete (batch 272/543)
2025-12-22 00:11:23 INFO Epoch 047 | 75% complete (batch 408/543)
2025-12-22 00:11:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.642179
2025-12-22 00:11:30 INFO Tuning ranking metrics: regret=0.091506 spearman=0.304945 (groups=39, skipped=329)
2025-12-22 00:11:30 INFO Epoch 047 | train_mse=0.042749 | val_loss=0.057998 | best_val_loss=0.372161
2025-12-22 00:11:32 INFO Epoch 048 | 25% complete (batch 136/543)
2025-12-22 00:11:35 INFO Epoch 048 | 50% complete (batch 272/543)
2025-12-22 00:11:38 INFO Epoch 048 | 75% complete (batch 408/543)
2025-12-22 00:11:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.642053
2025-12-22 00:11:46 INFO Tuning ranking metrics: regret=0.093622 spearman=0.244261 (groups=39, skipped=329)
2025-12-22 00:11:46 INFO Epoch 048 | train_mse=0.045539 | val_loss=0.057267 | best_val_loss=0.372161
2025-12-22 00:11:49 INFO Epoch 049 | 25% complete (batch 136/543)
2025-12-22 00:11:52 INFO Epoch 049 | 50% complete (batch 272/543)
2025-12-22 00:11:54 INFO Epoch 049 | 75% complete (batch 408/543)
2025-12-22 00:12:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.649029
2025-12-22 00:12:01 INFO Tuning ranking metrics: regret=0.093135 spearman=0.261966 (groups=39, skipped=329)
2025-12-22 00:12:01 INFO Epoch 049 | train_mse=0.047939 | val_loss=0.055946 | best_val_loss=0.372161
2025-12-22 00:12:05 INFO Epoch 050 | 25% complete (batch 136/543)
2025-12-22 00:12:08 INFO Epoch 050 | 50% complete (batch 272/543)
2025-12-22 00:12:11 INFO Epoch 050 | 75% complete (batch 408/543)
2025-12-22 00:12:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.650811
2025-12-22 00:12:17 INFO Tuning ranking metrics: regret=0.091939 spearman=0.264957 (groups=39, skipped=329)
2025-12-22 00:12:17 INFO Epoch 050 | train_mse=0.040126 | val_loss=0.055974 | best_val_loss=0.372161
2025-12-22 00:12:20 INFO Epoch 051 | 25% complete (batch 136/543)
2025-12-22 00:12:23 INFO Epoch 051 | 50% complete (batch 272/543)
2025-12-22 00:12:25 INFO Epoch 051 | 75% complete (batch 408/543)
2025-12-22 00:12:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.648015
2025-12-22 00:12:32 INFO Tuning ranking metrics: regret=0.091939 spearman=0.277228 (groups=39, skipped=329)
2025-12-22 00:12:32 INFO Epoch 051 | train_mse=0.047845 | val_loss=0.057746 | best_val_loss=0.372161
2025-12-22 00:12:35 INFO Epoch 052 | 25% complete (batch 136/543)
2025-12-22 00:12:37 INFO Epoch 052 | 50% complete (batch 272/543)
2025-12-22 00:12:40 INFO Epoch 052 | 75% complete (batch 408/543)
2025-12-22 00:12:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.647055
2025-12-22 00:12:47 INFO Tuning ranking metrics: regret=0.091939 spearman=0.283578 (groups=39, skipped=329)
2025-12-22 00:12:47 INFO Epoch 052 | train_mse=0.048847 | val_loss=0.056345 | best_val_loss=0.372161
2025-12-22 00:12:50 INFO Epoch 053 | 25% complete (batch 136/543)
2025-12-22 00:12:53 INFO Epoch 053 | 50% complete (batch 272/543)
2025-12-22 00:12:56 INFO Epoch 053 | 75% complete (batch 408/543)
2025-12-22 00:13:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.649175
2025-12-22 00:13:03 INFO Tuning ranking metrics: regret=0.091939 spearman=0.292918 (groups=39, skipped=329)
2025-12-22 00:13:03 INFO Epoch 053 | train_mse=0.046000 | val_loss=0.056183 | best_val_loss=0.372161
2025-12-22 00:13:06 INFO Epoch 054 | 25% complete (batch 136/543)
2025-12-22 00:13:09 INFO Epoch 054 | 50% complete (batch 272/543)
2025-12-22 00:13:12 INFO Epoch 054 | 75% complete (batch 408/543)
2025-12-22 00:13:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.646797
2025-12-22 00:13:19 INFO Tuning ranking metrics: regret=0.091939 spearman=0.299817 (groups=39, skipped=329)
2025-12-22 00:13:19 INFO Epoch 054 | train_mse=0.048545 | val_loss=0.057134 | best_val_loss=0.372161
2025-12-22 00:13:21 INFO Epoch 055 | 25% complete (batch 136/543)
2025-12-22 00:13:24 INFO Epoch 055 | 50% complete (batch 272/543)
2025-12-22 00:13:27 INFO Epoch 055 | 75% complete (batch 408/543)
2025-12-22 00:13:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.648181
2025-12-22 00:13:34 INFO Tuning ranking metrics: regret=0.091452 spearman=0.306532 (groups=39, skipped=329)
2025-12-22 00:13:34 INFO Epoch 055 | train_mse=0.046097 | val_loss=0.057620 | best_val_loss=0.372161
2025-12-22 00:13:36 INFO Epoch 056 | 25% complete (batch 136/543)
2025-12-22 00:13:39 INFO Epoch 056 | 50% complete (batch 272/543)
2025-12-22 00:13:42 INFO Epoch 056 | 75% complete (batch 408/543)
2025-12-22 00:13:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.650763
2025-12-22 00:13:48 INFO Tuning ranking metrics: regret=0.091939 spearman=0.279853 (groups=39, skipped=329)
2025-12-22 00:13:48 INFO Epoch 056 | train_mse=0.045455 | val_loss=0.055883 | best_val_loss=0.372161
2025-12-22 00:13:51 INFO Epoch 057 | 25% complete (batch 136/543)
2025-12-22 00:13:53 INFO Epoch 057 | 50% complete (batch 272/543)
2025-12-22 00:13:56 INFO Epoch 057 | 75% complete (batch 408/543)
2025-12-22 00:14:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.648906
2025-12-22 00:14:03 INFO Tuning ranking metrics: regret=0.091939 spearman=0.291026 (groups=39, skipped=329)
2025-12-22 00:14:03 INFO Epoch 057 | train_mse=0.047993 | val_loss=0.055653 | best_val_loss=0.372161
2025-12-22 00:14:06 INFO Epoch 058 | 25% complete (batch 136/543)
2025-12-22 00:14:09 INFO Epoch 058 | 50% complete (batch 272/543)
2025-12-22 00:14:11 INFO Epoch 058 | 75% complete (batch 408/543)
2025-12-22 00:14:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.649746
2025-12-22 00:14:17 INFO Tuning ranking metrics: regret=0.089864 spearman=0.300244 (groups=39, skipped=329)
2025-12-22 00:14:17 INFO Epoch 058 | train_mse=0.042282 | val_loss=0.056544 | best_val_loss=0.372161
2025-12-22 00:14:20 INFO Epoch 059 | 25% complete (batch 136/543)
2025-12-22 00:14:23 INFO Epoch 059 | 50% complete (batch 272/543)
2025-12-22 00:14:26 INFO Epoch 059 | 75% complete (batch 408/543)
2025-12-22 00:14:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.645385
2025-12-22 00:14:33 INFO Tuning ranking metrics: regret=0.091452 spearman=0.294567 (groups=39, skipped=329)
2025-12-22 00:14:33 INFO Epoch 059 | train_mse=0.040146 | val_loss=0.055514 | best_val_loss=0.372161
2025-12-22 00:14:36 INFO Epoch 060 | 25% complete (batch 136/543)
2025-12-22 00:14:39 INFO Epoch 060 | 50% complete (batch 272/543)
2025-12-22 00:14:42 INFO Epoch 060 | 75% complete (batch 408/543)
2025-12-22 00:14:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.649112
2025-12-22 00:14:49 INFO Tuning ranking metrics: regret=0.091452 spearman=0.296703 (groups=39, skipped=329)
2025-12-22 00:14:49 INFO Epoch 060 | train_mse=0.051163 | val_loss=0.055353 | best_val_loss=0.372161
2025-12-22 00:14:51 INFO Epoch 061 | 25% complete (batch 136/543)
2025-12-22 00:14:54 INFO Epoch 061 | 50% complete (batch 272/543)
2025-12-22 00:14:57 INFO Epoch 061 | 75% complete (batch 408/543)
2025-12-22 00:15:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.649565
2025-12-22 00:15:03 INFO Tuning ranking metrics: regret=0.091452 spearman=0.292125 (groups=39, skipped=329)
2025-12-22 00:15:03 INFO Epoch 061 | train_mse=0.045354 | val_loss=0.055328 | best_val_loss=0.372161
2025-12-22 00:15:06 INFO Epoch 062 | 25% complete (batch 136/543)
2025-12-22 00:15:09 INFO Epoch 062 | 50% complete (batch 272/543)
2025-12-22 00:15:12 INFO Epoch 062 | 75% complete (batch 408/543)
2025-12-22 00:15:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.648387
2025-12-22 00:15:18 INFO Tuning ranking metrics: regret=0.089377 spearman=0.292552 (groups=39, skipped=329)
2025-12-22 00:15:18 INFO Epoch 062 | train_mse=0.042556 | val_loss=0.055461 | best_val_loss=0.372161
2025-12-22 00:15:21 INFO Epoch 063 | 25% complete (batch 136/543)
2025-12-22 00:15:24 INFO Epoch 063 | 50% complete (batch 272/543)
2025-12-22 00:15:28 INFO Epoch 063 | 75% complete (batch 408/543)
2025-12-22 00:15:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.648494
2025-12-22 00:15:35 INFO Tuning ranking metrics: regret=0.091452 spearman=0.292552 (groups=39, skipped=329)
2025-12-22 00:15:35 INFO Epoch 063 | train_mse=0.051026 | val_loss=0.055319 | best_val_loss=0.372161
2025-12-22 00:15:39 INFO Epoch 064 | 25% complete (batch 136/543)
2025-12-22 00:15:42 INFO Epoch 064 | 50% complete (batch 272/543)
2025-12-22 00:15:46 INFO Epoch 064 | 75% complete (batch 408/543)
2025-12-22 00:15:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.649336
2025-12-22 00:15:53 INFO Tuning ranking metrics: regret=0.091452 spearman=0.295604 (groups=39, skipped=329)
2025-12-22 00:15:53 INFO Epoch 064 | train_mse=0.049395 | val_loss=0.055381 | best_val_loss=0.372161
2025-12-22 00:15:56 INFO Epoch 065 | 25% complete (batch 136/543)
2025-12-22 00:15:58 INFO Epoch 065 | 50% complete (batch 272/543)
2025-12-22 00:16:01 INFO Epoch 065 | 75% complete (batch 408/543)
2025-12-22 00:16:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.651422
2025-12-22 00:16:09 INFO Tuning ranking metrics: regret=0.091452 spearman=0.295604 (groups=39, skipped=329)
2025-12-22 00:16:09 INFO Epoch 065 | train_mse=0.049698 | val_loss=0.055352 | best_val_loss=0.372161
2025-12-22 00:16:11 INFO Epoch 066 | 25% complete (batch 136/543)
2025-12-22 00:16:14 INFO Epoch 066 | 50% complete (batch 272/543)
2025-12-22 00:16:16 INFO Epoch 066 | 75% complete (batch 408/543)
2025-12-22 00:16:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.651473
2025-12-22 00:16:23 INFO Tuning ranking metrics: regret=0.091452 spearman=0.295604 (groups=39, skipped=329)
2025-12-22 00:16:23 INFO Epoch 066 | train_mse=0.041963 | val_loss=0.055353 | best_val_loss=0.372161
2025-12-22 00:16:26 INFO Epoch 067 | 25% complete (batch 136/543)
2025-12-22 00:16:30 INFO Epoch 067 | 50% complete (batch 272/543)
2025-12-22 00:16:32 INFO Epoch 067 | 75% complete (batch 408/543)
2025-12-22 00:16:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.651629
2025-12-22 00:16:39 INFO Tuning ranking metrics: regret=0.091452 spearman=0.295604 (groups=39, skipped=329)
2025-12-22 00:16:39 INFO Epoch 067 | train_mse=0.049844 | val_loss=0.055358 | best_val_loss=0.372161
Monitored metric tuning_rank_spearman did not improve in the last 24 records. Best score: 0.372. Signaling Trainer to stop.
2025-12-22 00:16:39 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.32137_val-0.05962_epoch044.chkpt, checkpoint.tuning_rank_spearman-0.32741_val-0.05870_epoch038.chkpt, checkpoint.tuning_rank_spearman-0.37216_val-0.06060_epoch043.chkpt
2025-12-22 00:16:39 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed555/model_checkpoints/checkpoint.tuning_rank_spearman-0.37216_val-0.06060_epoch043.chkpt
2025-12-22 00:16:39 INFO Best validation loss: tensor(0.3722)
2025-12-22 00:16:39 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed555/model_checkpoints/checkpoint.tuning_rank_spearman-0.37216_val-0.06060_epoch043.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed555/model_checkpoints/checkpoint.tuning_rank_spearman-0.37216_val-0.06060_epoch043.chkpt
2025-12-22 00:16:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.060599
2025-12-22 00:16:43 INFO Tuning ranking metrics: regret=0.080185 spearman=0.372161 (groups=39, skipped=329)
2025-12-22 00:16:43 INFO Epoch 068 | val_loss=0.060599 | best_val_loss=0.372161
2025-12-22 00:16:43 INFO Validation metrics: [{'val_loss': 0.060599181801080704, 'tuning_rank_regret': 0.0801846906542778, 'tuning_rank_spearman': 0.3721611797809601, 'val_pearson_corr': 0.7582223415374756, 'val_spearman_corr': 0.6779472827911377, 'val_rank_regret': 0.14533501863479614, 'val_rank_spearman': 0.22063492238521576}]
2025-12-22 00:16:43 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.37216_val-0.06060_epoch043.chkpt
2025-12-22 00:16:43 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.32741_val-0.05870_epoch038.chkpt
2025-12-22 00:16:43 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.32137_val-0.05962_epoch044.chkpt
2025-12-22 00:16:43 INFO Renamed checkpoint file: alt_val.val-0.05514_epoch037.ckpt -> alt_val.val-0.05514_epoch037.chkpt
2025-12-22 00:16:43 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.05514_epoch037.chkpt
2025-12-22 00:16:43 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
USING ADAM
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.0801846906542778
  tuning_rank_spearman      0.3721611797809601
        val_loss           0.060599181801080704
    val_pearson_corr        0.7582223415374756
     val_rank_regret        0.14533501863479614
    val_rank_spearman       0.22063492238521576
    val_spearman_corr       0.6779472827911377
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed555 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed555
[run_full_pipeline] Phase 2 (seed 555) best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed555/model_checkpoints/checkpoint.tuning_rank_spearman-0.37216_val-0.06060_epoch043.chkpt (tuning_rank_spearman=0.3721611797809601)
[run_full_pipeline] Phase 2 fine-tuning (seed 888) -> sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed888
[train_cli] run_id=sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed888 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed888/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed888 --git-commit cf515fb092 --git-dirty --resume-from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase1/model_checkpoints/checkpoint.tuning_rank_spearman--0.06525_val-0.06370_epoch024.chkpt
2025-12-22 00:16:47 INFO git_commit = cf515fb092 (dirty)
2025-12-22 00:16:47 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-22 00:16:47 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed888/config/config.yaml
2025-12-22 00:16:47 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data
2025-12-22 00:16:47 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-22 00:16:47 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-22 00:16:47 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed888
2025-12-22 00:16:47 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-22 00:16:47 INFO   metadata_path = None
2025-12-22 00:16:47 INFO   summary_path = None
2025-12-22 00:16:47 INFO   accelerator = cpu
2025-12-22 00:16:47 INFO   devices = 1
2025-12-22 00:16:47 INFO   attention_head = 8
2025-12-22 00:16:47 INFO   pooling_type = mean
2025-12-22 00:16:47 INFO   model_self_loops = False
2025-12-22 00:16:47 INFO   model_self_loop_fill = mean
2025-12-22 00:16:47 INFO   model_residual = False
2025-12-22 00:16:47 INFO   batch_size = 16
2025-12-22 00:16:47 INFO   learning_rate = 0.001
2025-12-22 00:16:47 INFO   num_epochs = 320
2025-12-22 00:16:47 INFO   accumulate_grad_batches = 16
2025-12-22 00:16:47 INFO   seed = 888
2025-12-22 00:16:47 INFO   num_workers = 0
2025-12-22 00:16:47 INFO   precision = 32
2025-12-22 00:16:47 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-22 00:16:47 INFO   early_stopping_patience = 20
2025-12-22 00:16:47 INFO   lr_scheduler_patience = 4
2025-12-22 00:16:47 INFO   lr_scheduler_factor = 0.2
2025-12-22 00:16:47 INFO   fast_dev_run = False
2025-12-22 00:16:47 INFO   limit_train_batches = None
2025-12-22 00:16:47 INFO   limit_val_batches = None
2025-12-22 00:16:47 INFO   log_lr = False
2025-12-22 00:16:47 INFO   progress_bar_refresh_rate = 0
2025-12-22 00:16:47 INFO   log_every_n_steps = 100
2025-12-22 00:16:47 INFO   use_val_spearman_as_secondary = True
2025-12-22 00:16:47 INFO   spearman_secondary_min_delta = 0.0
2025-12-22 00:16:47 INFO   spearman_secondary_weight = 1.0
2025-12-22 00:16:47 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-22 00:16:47 INFO   tuning_max_samples = 500
2025-12-22 00:16:47 INFO   tuning_fraction = None
2025-12-22 00:16:47 INFO   tuning_eval_every = 1
2025-12-22 00:16:47 INFO   rank_loss_weight = 0.0
2025-12-22 00:16:47 INFO   rank_loss_margin = 0.0
2025-12-22 00:16:47 INFO   rank_loss_mode = hinge
2025-12-22 00:16:47 INFO   rank_loss_grouped = True
2025-12-22 00:16:47 INFO   variance_reduction_enabled = False
2025-12-22 00:16:47 INFO   variance_reduction_method = topk_avg
2025-12-22 00:16:47 INFO   variance_reduction_top_k = 3
2025-12-22 00:16:47 INFO   coverage_minimum = 0.0
2025-12-22 00:16:47 INFO   coverage_fail_on_missing = False
2025-12-22 00:16:47 INFO   graph_load_profiling = False
2025-12-22 00:16:47 INFO   graph_load_top_k = 5
2025-12-22 00:16:47 INFO   enable_graph_cache = True
2025-12-22 00:16:47 INFO   graph_cache_size = 256
2025-12-22 00:16:47 INFO   canonicalize_on_load = False
2025-12-22 00:16:47 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-22 00:16:47 INFO   edge_schema = {}
2025-12-22 00:16:47 INFO   topology_schema = {}
Seed set to 888
2025-12-22 00:16:47 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-22 00:16:47 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 00:16:47 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-22 00:16:47 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 00:16:47 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-22 00:16:47 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 00:16:48 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-22 00:16:48 INFO Tuning group stats: groups=351 groups>=2=40 singletons=311 max_group=10
2025-12-22 00:16:48 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed888/dataset_coverage.json
2025-12-22 00:16:48 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed888/dataset_coverage.json for details.
2025-12-22 00:16:48 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed888/dataset_coverage.json for details.
2025-12-22 00:16:48 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed888/dataset_coverage.json for details.
2025-12-22 00:16:48 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed888/schema_summary.json
2025-12-22 00:16:48 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed888/feature_metadata.json
2025-12-22 00:16:48 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-22 00:16:48 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/feature-config.yaml.topoqa.10A.2, sha256=5c62898155179232a565e24d9fbd7b208f9ce480d1a19d6139de19454e173ff0
2025-12-22 00:16:48 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/work/edge_features)
2025-12-22 00:16:48 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json
2025-12-22 00:16:48 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed888/schema_summary.json
2025-12-22 00:16:48 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-22 00:16:48 INFO Topology: topology/persistence_basic/v1 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 172-dimensional node features.
2025-12-22 00:16:48 INFO Node: node/dssp_topo_merge/v1; metadata lists 172 feature columns matching the .pt tensor.
2025-12-22 00:16:48 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-22 00:16:48 INFO → Total feature dimensionality observed and confirmed: node_dim = 172, edge_dim = 11.
2025-12-22 00:16:48 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-22 00:16:48 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 172,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 172,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed888/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge/v1",
      "alias": "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA",
      "jobs": 16,
      "summary": "DSSP-derived node features merged with topology statistics."
    },
    "topology": {
      "id": "topology/persistence_basic/v1",
      "alias": "Betti 0 and Betti 1 topology summaries on interface coords = 140D PH | TopoQA",
      "jobs": 16,
      "summary": "Persistent homology features with configurable distance thresholds."
    }
  },
  "notes": []
}
2025-12-22 00:16:48 INFO DataLoader num_workers=0 (recommended for macOS to avoid spawn issues; configurable via config.yaml -> num_workers).
2025-12-22 00:16:48 INFO Resuming from checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase1/model_checkpoints/checkpoint.tuning_rank_spearman--0.06525_val-0.06370_epoch024.chkpt (epoch=24)
2025-12-22 00:16:48 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=1806ccd0c6e840de82c0022d33cc26a9)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-22 00:16:48 INFO Starting training (fast_dev_run=False)
2025-12-22 00:16:48 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed888/model_checkpoints exists and is not empty.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase1/model_checkpoints/checkpoint.tuning_rank_spearman--0.06525_val-0.06370_epoch024.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase1/model_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed888/model_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase1/model_checkpoints/val_loss_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed888/model_checkpoints/val_loss_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 5.5 K  | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
165 K     Trainable params
0         Non-trainable params
165 K     Total params
0.662     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
Restored all states from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase1/model_checkpoints/checkpoint.tuning_rank_spearman--0.06525_val-0.06370_epoch024.chkpt
2025-12-22 00:16:51 INFO Epoch 025 | 25% complete (batch 136/543)
2025-12-22 00:16:54 INFO Epoch 025 | 50% complete (batch 272/543)
2025-12-22 00:16:56 INFO Epoch 025 | 75% complete (batch 408/543)
2025-12-22 00:17:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.061890
2025-12-22 00:17:02 INFO Tuning ranking metrics: regret=0.093993 spearman=0.133761 (groups=40, skipped=311)
2025-12-22 00:17:02 INFO Epoch 025 | val_loss=0.061890
Metric tuning_rank_spearman improved by 0.122 >= min_delta = 0.0. New best score: 0.134
2025-12-22 00:17:05 INFO Epoch 026 | 25% complete (batch 136/543)
2025-12-22 00:17:07 INFO Epoch 026 | 50% complete (batch 272/543)
2025-12-22 00:17:10 INFO Epoch 026 | 75% complete (batch 408/543)
2025-12-22 00:17:15 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.613522
2025-12-22 00:17:16 INFO Tuning ranking metrics: regret=0.061737 spearman=0.146109 (groups=40, skipped=311)
2025-12-22 00:17:16 INFO Epoch 026 | train_mse=0.064714 | val_loss=0.065921 | best_val_loss=0.133761
Metric tuning_rank_spearman improved by 0.012 >= min_delta = 0.0. New best score: 0.146
2025-12-22 00:17:19 INFO Epoch 027 | 25% complete (batch 136/543)
2025-12-22 00:17:21 INFO Epoch 027 | 50% complete (batch 272/543)
2025-12-22 00:17:24 INFO Epoch 027 | 75% complete (batch 408/543)
2025-12-22 00:17:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.597660
2025-12-22 00:17:31 INFO Tuning ranking metrics: regret=0.102385 spearman=0.077484 (groups=40, skipped=311)
2025-12-22 00:17:31 INFO Epoch 027 | train_mse=0.073118 | val_loss=0.066135 | best_val_loss=0.146109
2025-12-22 00:17:34 INFO Epoch 028 | 25% complete (batch 136/543)
2025-12-22 00:17:37 INFO Epoch 028 | 50% complete (batch 272/543)
2025-12-22 00:17:39 INFO Epoch 028 | 75% complete (batch 408/543)
2025-12-22 00:17:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.614514
2025-12-22 00:17:46 INFO Tuning ranking metrics: regret=0.098176 spearman=0.058588 (groups=40, skipped=311)
2025-12-22 00:17:46 INFO Epoch 028 | train_mse=0.067035 | val_loss=0.064860 | best_val_loss=0.146109
2025-12-22 00:17:48 INFO Epoch 029 | 25% complete (batch 136/543)
2025-12-22 00:17:51 INFO Epoch 029 | 50% complete (batch 272/543)
2025-12-22 00:17:54 INFO Epoch 029 | 75% complete (batch 408/543)
2025-12-22 00:17:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.622642
2025-12-22 00:18:01 INFO Tuning ranking metrics: regret=0.073976 spearman=0.099913 (groups=40, skipped=311)
2025-12-22 00:18:01 INFO Epoch 029 | train_mse=0.057915 | val_loss=0.062240 | best_val_loss=0.146109
2025-12-22 00:18:05 INFO Epoch 030 | 25% complete (batch 136/543)
2025-12-22 00:18:08 INFO Epoch 030 | 50% complete (batch 272/543)
2025-12-22 00:18:11 INFO Epoch 030 | 75% complete (batch 408/543)
2025-12-22 00:18:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.606617
2025-12-22 00:18:18 INFO Tuning ranking metrics: regret=0.092779 spearman=0.059502 (groups=40, skipped=311)
2025-12-22 00:18:18 INFO Epoch 030 | train_mse=0.054042 | val_loss=0.083058 | best_val_loss=0.146109
2025-12-22 00:18:20 INFO Epoch 031 | 25% complete (batch 136/543)
2025-12-22 00:18:23 INFO Epoch 031 | 50% complete (batch 272/543)
2025-12-22 00:18:26 INFO Epoch 031 | 75% complete (batch 408/543)
2025-12-22 00:18:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.627864
2025-12-22 00:18:35 INFO Tuning ranking metrics: regret=0.118429 spearman=0.045460 (groups=40, skipped=311)
2025-12-22 00:18:35 INFO Epoch 031 | train_mse=0.061270 | val_loss=0.068779 | best_val_loss=0.146109
2025-12-22 00:18:38 INFO Epoch 032 | 25% complete (batch 136/543)
2025-12-22 00:18:41 INFO Epoch 032 | 50% complete (batch 272/543)
2025-12-22 00:18:43 INFO Epoch 032 | 75% complete (batch 408/543)
2025-12-22 00:18:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.624125
2025-12-22 00:18:50 INFO Tuning ranking metrics: regret=0.073040 spearman=0.156677 (groups=40, skipped=311)
2025-12-22 00:18:50 INFO Epoch 032 | train_mse=0.064541 | val_loss=0.062071 | best_val_loss=0.146109
Metric tuning_rank_spearman improved by 0.011 >= min_delta = 0.0. New best score: 0.157
2025-12-22 00:18:53 INFO Epoch 033 | 25% complete (batch 136/543)
2025-12-22 00:18:57 INFO Epoch 033 | 50% complete (batch 272/543)
2025-12-22 00:18:59 INFO Epoch 033 | 75% complete (batch 408/543)
2025-12-22 00:19:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.636710
2025-12-22 00:19:07 INFO Tuning ranking metrics: regret=0.089502 spearman=0.084021 (groups=40, skipped=311)
2025-12-22 00:19:07 INFO Epoch 033 | train_mse=0.066066 | val_loss=0.056005 | best_val_loss=0.156677
2025-12-22 00:19:09 INFO Epoch 034 | 25% complete (batch 136/543)
2025-12-22 00:19:12 INFO Epoch 034 | 50% complete (batch 272/543)
2025-12-22 00:19:15 INFO Epoch 034 | 75% complete (batch 408/543)
2025-12-22 00:19:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.648938
2025-12-22 00:19:21 INFO Tuning ranking metrics: regret=0.094133 spearman=0.026607 (groups=40, skipped=311)
2025-12-22 00:19:21 INFO Epoch 034 | train_mse=0.061492 | val_loss=0.054838 | best_val_loss=0.156677
2025-12-22 00:19:24 INFO Epoch 035 | 25% complete (batch 136/543)
2025-12-22 00:19:26 INFO Epoch 035 | 50% complete (batch 272/543)
2025-12-22 00:19:29 INFO Epoch 035 | 75% complete (batch 408/543)
2025-12-22 00:19:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.659826
2025-12-22 00:19:36 INFO Tuning ranking metrics: regret=0.089308 spearman=0.078014 (groups=40, skipped=311)
2025-12-22 00:19:36 INFO Epoch 035 | train_mse=0.043477 | val_loss=0.054498 | best_val_loss=0.156677
2025-12-22 00:19:39 INFO Epoch 036 | 25% complete (batch 136/543)
2025-12-22 00:19:42 INFO Epoch 036 | 50% complete (batch 272/543)
2025-12-22 00:19:45 INFO Epoch 036 | 75% complete (batch 408/543)
2025-12-22 00:19:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.658301
2025-12-22 00:19:52 INFO Tuning ranking metrics: regret=0.086207 spearman=0.082738 (groups=40, skipped=311)
2025-12-22 00:19:52 INFO Epoch 036 | train_mse=0.056151 | val_loss=0.054478 | best_val_loss=0.156677
2025-12-22 00:19:54 INFO Epoch 037 | 25% complete (batch 136/543)
2025-12-22 00:19:57 INFO Epoch 037 | 50% complete (batch 272/543)
2025-12-22 00:20:00 INFO Epoch 037 | 75% complete (batch 408/543)
2025-12-22 00:20:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.660857
2025-12-22 00:20:07 INFO Tuning ranking metrics: regret=0.073816 spearman=0.089897 (groups=40, skipped=311)
2025-12-22 00:20:07 INFO Epoch 037 | train_mse=0.056607 | val_loss=0.054426 | best_val_loss=0.156677
2025-12-22 00:20:10 INFO Epoch 038 | 25% complete (batch 136/543)
2025-12-22 00:20:12 INFO Epoch 038 | 50% complete (batch 272/543)
2025-12-22 00:20:15 INFO Epoch 038 | 75% complete (batch 408/543)
2025-12-22 00:20:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.655859
2025-12-22 00:20:21 INFO Tuning ranking metrics: regret=0.073825 spearman=0.072219 (groups=40, skipped=311)
2025-12-22 00:20:21 INFO Epoch 038 | train_mse=0.049804 | val_loss=0.056621 | best_val_loss=0.156677
2025-12-22 00:20:24 INFO Epoch 039 | 25% complete (batch 136/543)
2025-12-22 00:20:27 INFO Epoch 039 | 50% complete (batch 272/543)
2025-12-22 00:20:30 INFO Epoch 039 | 75% complete (batch 408/543)
2025-12-22 00:20:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.662281
2025-12-22 00:20:37 INFO Tuning ranking metrics: regret=0.073825 spearman=0.068469 (groups=40, skipped=311)
2025-12-22 00:20:37 INFO Epoch 039 | train_mse=0.052293 | val_loss=0.055420 | best_val_loss=0.156677
2025-12-22 00:20:40 INFO Epoch 040 | 25% complete (batch 136/543)
2025-12-22 00:20:42 INFO Epoch 040 | 50% complete (batch 272/543)
2025-12-22 00:20:45 INFO Epoch 040 | 75% complete (batch 408/543)
2025-12-22 00:20:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.662626
2025-12-22 00:20:52 INFO Tuning ranking metrics: regret=0.073825 spearman=0.090509 (groups=40, skipped=311)
2025-12-22 00:20:52 INFO Epoch 040 | train_mse=0.050506 | val_loss=0.054961 | best_val_loss=0.156677
2025-12-22 00:20:54 INFO Epoch 041 | 25% complete (batch 136/543)
2025-12-22 00:20:57 INFO Epoch 041 | 50% complete (batch 272/543)
2025-12-22 00:21:00 INFO Epoch 041 | 75% complete (batch 408/543)
2025-12-22 00:21:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.656732
2025-12-22 00:21:06 INFO Tuning ranking metrics: regret=0.073358 spearman=0.067808 (groups=40, skipped=311)
2025-12-22 00:21:06 INFO Epoch 041 | train_mse=0.047335 | val_loss=0.055708 | best_val_loss=0.156677
2025-12-22 00:21:09 INFO Epoch 042 | 25% complete (batch 136/543)
2025-12-22 00:21:11 INFO Epoch 042 | 50% complete (batch 272/543)
2025-12-22 00:21:14 INFO Epoch 042 | 75% complete (batch 408/543)
2025-12-22 00:21:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.655452
2025-12-22 00:21:20 INFO Tuning ranking metrics: regret=0.073508 spearman=0.062960 (groups=40, skipped=311)
2025-12-22 00:21:20 INFO Epoch 042 | train_mse=0.048470 | val_loss=0.055592 | best_val_loss=0.156677
2025-12-22 00:21:23 INFO Epoch 043 | 25% complete (batch 136/543)
2025-12-22 00:21:26 INFO Epoch 043 | 50% complete (batch 272/543)
2025-12-22 00:21:28 INFO Epoch 043 | 75% complete (batch 408/543)
2025-12-22 00:21:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.657292
2025-12-22 00:21:35 INFO Tuning ranking metrics: regret=0.060967 spearman=0.086158 (groups=40, skipped=311)
2025-12-22 00:21:35 INFO Epoch 043 | train_mse=0.055790 | val_loss=0.056563 | best_val_loss=0.156677
2025-12-22 00:21:38 INFO Epoch 044 | 25% complete (batch 136/543)
2025-12-22 00:21:41 INFO Epoch 044 | 50% complete (batch 272/543)
2025-12-22 00:21:43 INFO Epoch 044 | 75% complete (batch 408/543)
2025-12-22 00:21:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.654741
2025-12-22 00:21:50 INFO Tuning ranking metrics: regret=0.061118 spearman=0.089269 (groups=40, skipped=311)
2025-12-22 00:21:50 INFO Epoch 044 | train_mse=0.048863 | val_loss=0.053937 | best_val_loss=0.156677
2025-12-22 00:21:52 INFO Epoch 045 | 25% complete (batch 136/543)
2025-12-22 00:21:55 INFO Epoch 045 | 50% complete (batch 272/543)
2025-12-22 00:21:57 INFO Epoch 045 | 75% complete (batch 408/543)
2025-12-22 00:22:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.662023
2025-12-22 00:22:04 INFO Tuning ranking metrics: regret=0.073976 spearman=0.086829 (groups=40, skipped=311)
2025-12-22 00:22:04 INFO Epoch 045 | train_mse=0.049654 | val_loss=0.054492 | best_val_loss=0.156677
2025-12-22 00:22:07 INFO Epoch 046 | 25% complete (batch 136/543)
2025-12-22 00:22:10 INFO Epoch 046 | 50% complete (batch 272/543)
2025-12-22 00:22:12 INFO Epoch 046 | 75% complete (batch 408/543)
2025-12-22 00:22:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.658986
2025-12-22 00:22:19 INFO Tuning ranking metrics: regret=0.070385 spearman=0.156342 (groups=40, skipped=311)
2025-12-22 00:22:19 INFO Epoch 046 | train_mse=0.051596 | val_loss=0.055924 | best_val_loss=0.156677
2025-12-22 00:22:22 INFO Epoch 047 | 25% complete (batch 136/543)
2025-12-22 00:22:24 INFO Epoch 047 | 50% complete (batch 272/543)
2025-12-22 00:22:27 INFO Epoch 047 | 75% complete (batch 408/543)
2025-12-22 00:22:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.644735
2025-12-22 00:22:33 INFO Tuning ranking metrics: regret=0.070394 spearman=0.140152 (groups=40, skipped=311)
2025-12-22 00:22:33 INFO Epoch 047 | train_mse=0.048280 | val_loss=0.059712 | best_val_loss=0.156677
2025-12-22 00:22:36 INFO Epoch 048 | 25% complete (batch 136/543)
2025-12-22 00:22:39 INFO Epoch 048 | 50% complete (batch 272/543)
2025-12-22 00:22:41 INFO Epoch 048 | 75% complete (batch 408/543)
2025-12-22 00:22:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.646016
2025-12-22 00:22:48 INFO Tuning ranking metrics: regret=0.070375 spearman=0.145866 (groups=40, skipped=311)
2025-12-22 00:22:48 INFO Epoch 048 | train_mse=0.042925 | val_loss=0.054392 | best_val_loss=0.156677
2025-12-22 00:22:50 INFO Epoch 049 | 25% complete (batch 136/543)
2025-12-22 00:22:53 INFO Epoch 049 | 50% complete (batch 272/543)
2025-12-22 00:22:56 INFO Epoch 049 | 75% complete (batch 408/543)
2025-12-22 00:23:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.655470
2025-12-22 00:23:02 INFO Tuning ranking metrics: regret=0.070375 spearman=0.154199 (groups=40, skipped=311)
2025-12-22 00:23:02 INFO Epoch 049 | train_mse=0.044060 | val_loss=0.055817 | best_val_loss=0.156677
2025-12-22 00:23:05 INFO Epoch 050 | 25% complete (batch 136/543)
2025-12-22 00:23:07 INFO Epoch 050 | 50% complete (batch 272/543)
2025-12-22 00:23:10 INFO Epoch 050 | 75% complete (batch 408/543)
2025-12-22 00:23:15 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.651698
2025-12-22 00:23:16 INFO Tuning ranking metrics: regret=0.060598 spearman=0.144497 (groups=40, skipped=311)
2025-12-22 00:23:16 INFO Epoch 050 | train_mse=0.054300 | val_loss=0.060660 | best_val_loss=0.156677
2025-12-22 00:23:19 INFO Epoch 051 | 25% complete (batch 136/543)
2025-12-22 00:23:21 INFO Epoch 051 | 50% complete (batch 272/543)
2025-12-22 00:23:24 INFO Epoch 051 | 75% complete (batch 408/543)
2025-12-22 00:23:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.636694
2025-12-22 00:23:31 INFO Tuning ranking metrics: regret=0.063611 spearman=0.122781 (groups=40, skipped=311)
2025-12-22 00:23:31 INFO Epoch 051 | train_mse=0.054541 | val_loss=0.056434 | best_val_loss=0.156677
2025-12-22 00:23:33 INFO Epoch 052 | 25% complete (batch 136/543)
2025-12-22 00:23:36 INFO Epoch 052 | 50% complete (batch 272/543)
2025-12-22 00:23:39 INFO Epoch 052 | 75% complete (batch 408/543)
2025-12-22 00:23:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.660707
2025-12-22 00:23:46 INFO Tuning ranking metrics: regret=0.063611 spearman=0.119908 (groups=40, skipped=311)
2025-12-22 00:23:46 INFO Epoch 052 | train_mse=0.044833 | val_loss=0.054402 | best_val_loss=0.156677
2025-12-22 00:23:49 INFO Epoch 053 | 25% complete (batch 136/543)
2025-12-22 00:23:52 INFO Epoch 053 | 50% complete (batch 272/543)
2025-12-22 00:23:54 INFO Epoch 053 | 75% complete (batch 408/543)
2025-12-22 00:23:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.662986
2025-12-22 00:24:01 INFO Tuning ranking metrics: regret=0.069052 spearman=0.061694 (groups=40, skipped=311)
2025-12-22 00:24:01 INFO Epoch 053 | train_mse=0.048740 | val_loss=0.055622 | best_val_loss=0.156677
2025-12-22 00:24:03 INFO Epoch 054 | 25% complete (batch 136/543)
2025-12-22 00:24:06 INFO Epoch 054 | 50% complete (batch 272/543)
2025-12-22 00:24:09 INFO Epoch 054 | 75% complete (batch 408/543)
2025-12-22 00:24:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.664602
2025-12-22 00:24:15 INFO Tuning ranking metrics: regret=0.068436 spearman=0.066694 (groups=40, skipped=311)
2025-12-22 00:24:15 INFO Epoch 054 | train_mse=0.042860 | val_loss=0.054498 | best_val_loss=0.156677
2025-12-22 00:24:18 INFO Epoch 055 | 25% complete (batch 136/543)
2025-12-22 00:24:21 INFO Epoch 055 | 50% complete (batch 272/543)
2025-12-22 00:24:23 INFO Epoch 055 | 75% complete (batch 408/543)
2025-12-22 00:24:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.662393
2025-12-22 00:24:30 INFO Tuning ranking metrics: regret=0.063611 spearman=0.118122 (groups=40, skipped=311)
2025-12-22 00:24:30 INFO Epoch 055 | train_mse=0.044838 | val_loss=0.054794 | best_val_loss=0.156677
2025-12-22 00:24:32 INFO Epoch 056 | 25% complete (batch 136/543)
2025-12-22 00:24:35 INFO Epoch 056 | 50% complete (batch 272/543)
2025-12-22 00:24:37 INFO Epoch 056 | 75% complete (batch 408/543)
2025-12-22 00:24:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.661751
2025-12-22 00:24:44 INFO Tuning ranking metrics: regret=0.068436 spearman=0.066694 (groups=40, skipped=311)
2025-12-22 00:24:44 INFO Epoch 056 | train_mse=0.048117 | val_loss=0.054157 | best_val_loss=0.156677
Monitored metric tuning_rank_spearman did not improve in the last 24 records. Best score: 0.157. Signaling Trainer to stop.
2025-12-22 00:24:44 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.15420_val-0.05582_epoch049.chkpt, checkpoint.tuning_rank_spearman-0.15634_val-0.05592_epoch046.chkpt, checkpoint.tuning_rank_spearman-0.15668_val-0.06207_epoch032.chkpt
2025-12-22 00:24:44 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed888/model_checkpoints/checkpoint.tuning_rank_spearman-0.15668_val-0.06207_epoch032.chkpt
2025-12-22 00:24:44 INFO Best validation loss: tensor(0.1567)
2025-12-22 00:24:44 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed888/model_checkpoints/checkpoint.tuning_rank_spearman-0.15668_val-0.06207_epoch032.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed888/model_checkpoints/checkpoint.tuning_rank_spearman-0.15668_val-0.06207_epoch032.chkpt
2025-12-22 00:24:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.062071
2025-12-22 00:24:48 INFO Tuning ranking metrics: regret=0.073040 spearman=0.156677 (groups=40, skipped=311)
2025-12-22 00:24:48 INFO Epoch 057 | val_loss=0.062071 | best_val_loss=0.156677
2025-12-22 00:24:48 INFO Validation metrics: [{'val_loss': 0.0620713047683239, 'tuning_rank_regret': 0.07303954660892487, 'tuning_rank_spearman': 0.1566774845123291, 'val_pearson_corr': 0.7648642659187317, 'val_spearman_corr': 0.6927159428596497, 'val_rank_regret': 0.05560627952218056, 'val_rank_spearman': 0.20317460596561432}]
2025-12-22 00:24:48 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.15668_val-0.06207_epoch032.chkpt
2025-12-22 00:24:48 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.15634_val-0.05592_epoch046.chkpt
2025-12-22 00:24:48 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.15420_val-0.05582_epoch049.chkpt
2025-12-22 00:24:48 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.06189_epoch025.ckpt
2025-12-22 00:24:48 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
USING ADAM
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.07303954660892487
  tuning_rank_spearman      0.1566774845123291
        val_loss            0.0620713047683239
    val_pearson_corr        0.7648642659187317
     val_rank_regret        0.05560627952218056
    val_rank_spearman       0.20317460596561432
    val_spearman_corr       0.6927159428596497
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed888 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed888
[run_full_pipeline] Phase 2 (seed 888) best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed888/model_checkpoints/checkpoint.tuning_rank_spearman-0.15668_val-0.06207_epoch032.chkpt (tuning_rank_spearman=0.1566774845123291)
[run_full_pipeline] Pipeline complete at 2025-12-22T00:24:49Z
Starting post model training polishing ...
[polish_from_best] Manifest written to manifests/run_polish_lean.yaml
[polish_from_best] Best run: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-21_23-33-41_phase2_seed555
[polish_from_best] Base config: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/configs/sched_boost_finetune_seed555.yaml
[polish_from_best] Seeds: 101 555 888
[polish_from_best] Launching run_full_pipeline.sh with manifests/run_polish_lean.yaml
[run_full_pipeline] Validating graphs before training...
[validate_graphs] OK: validated 14391 graph(s) in /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data
[run_full_pipeline] Starting sweep at 2025-12-22T00:25:14.877688+00:00 using manifest /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/manifests/run_polish_lean.yaml
[train_cli][batch] (1/6) running job 'polish_seed101' -> run_name=polish_seed101_2025-12-22_00-25-14
[train_cli] run_id=polish_seed101_2025-12-22_00-25-14 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_00-25-14/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_00-25-14 --git-commit cf515fb092 --git-dirty
2025-12-22 00:25:17 INFO git_commit = cf515fb092 (dirty)
2025-12-22 00:25:17 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-22 00:25:17 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_00-25-14/config/config.yaml
2025-12-22 00:25:17 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data
2025-12-22 00:25:17 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-22 00:25:17 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-22 00:25:17 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_00-25-14
2025-12-22 00:25:17 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-22 00:25:17 INFO   metadata_path = None
2025-12-22 00:25:17 INFO   summary_path = None
2025-12-22 00:25:17 INFO   accelerator = cpu
2025-12-22 00:25:17 INFO   devices = 1
2025-12-22 00:25:17 INFO   attention_head = 8
2025-12-22 00:25:17 INFO   pooling_type = mean
2025-12-22 00:25:17 INFO   model_self_loops = False
2025-12-22 00:25:17 INFO   model_self_loop_fill = mean
2025-12-22 00:25:17 INFO   model_residual = False
2025-12-22 00:25:17 INFO   batch_size = 16
2025-12-22 00:25:17 INFO   learning_rate = 0.003
2025-12-22 00:25:17 INFO   num_epochs = 320
2025-12-22 00:25:17 INFO   accumulate_grad_batches = 16
2025-12-22 00:25:17 INFO   seed = 101
2025-12-22 00:25:17 INFO   num_workers = 0
2025-12-22 00:25:17 INFO   precision = 32
2025-12-22 00:25:17 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-22 00:25:17 INFO   early_stopping_patience = 40
2025-12-22 00:25:17 INFO   lr_scheduler_patience = 20
2025-12-22 00:25:17 INFO   lr_scheduler_factor = 0.3
2025-12-22 00:25:17 INFO   fast_dev_run = False
2025-12-22 00:25:17 INFO   limit_train_batches = None
2025-12-22 00:25:17 INFO   limit_val_batches = None
2025-12-22 00:25:17 INFO   log_lr = False
2025-12-22 00:25:17 INFO   progress_bar_refresh_rate = 0
2025-12-22 00:25:17 INFO   log_every_n_steps = 100
2025-12-22 00:25:17 INFO   use_val_spearman_as_secondary = True
2025-12-22 00:25:17 INFO   spearman_secondary_min_delta = 0.0
2025-12-22 00:25:17 INFO   spearman_secondary_weight = 1.0
2025-12-22 00:25:17 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-22 00:25:17 INFO   tuning_max_samples = 500
2025-12-22 00:25:17 INFO   tuning_fraction = None
2025-12-22 00:25:17 INFO   tuning_eval_every = 1
2025-12-22 00:25:17 INFO   rank_loss_weight = 0.0
2025-12-22 00:25:17 INFO   rank_loss_margin = 0.0
2025-12-22 00:25:17 INFO   rank_loss_mode = hinge
2025-12-22 00:25:17 INFO   rank_loss_grouped = True
2025-12-22 00:25:17 INFO   variance_reduction_enabled = False
2025-12-22 00:25:17 INFO   variance_reduction_method = topk_avg
2025-12-22 00:25:17 INFO   variance_reduction_top_k = 3
2025-12-22 00:25:17 INFO   coverage_minimum = 0.0
2025-12-22 00:25:17 INFO   coverage_fail_on_missing = False
2025-12-22 00:25:17 INFO   graph_load_profiling = False
2025-12-22 00:25:17 INFO   graph_load_top_k = 5
2025-12-22 00:25:17 INFO   enable_graph_cache = True
2025-12-22 00:25:17 INFO   graph_cache_size = 256
2025-12-22 00:25:17 INFO   canonicalize_on_load = False
2025-12-22 00:25:17 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-22 00:25:17 INFO   edge_schema = {}
2025-12-22 00:25:17 INFO   topology_schema = {}
Seed set to 101
2025-12-22 00:25:18 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-22 00:25:18 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 00:25:18 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-22 00:25:18 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 00:25:18 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-22 00:25:18 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-22 00:25:19 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-22 00:25:19 INFO Tuning group stats: groups=348 groups>=2=37 singletons=311 max_group=11
2025-12-22 00:25:19 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_00-25-14/dataset_coverage.json
2025-12-22 00:25:19 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_00-25-14/dataset_coverage.json for details.
2025-12-22 00:25:19 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_00-25-14/dataset_coverage.json for details.
2025-12-22 00:25:19 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_00-25-14/dataset_coverage.json for details.
2025-12-22 00:25:19 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_00-25-14/schema_summary.json
2025-12-22 00:25:19 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_00-25-14/feature_metadata.json
2025-12-22 00:25:19 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-22 00:25:19 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/feature-config.yaml.topoqa.10A.2, sha256=5c62898155179232a565e24d9fbd7b208f9ce480d1a19d6139de19454e173ff0
2025-12-22 00:25:19 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/work/edge_features)
2025-12-22 00:25:19 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json
2025-12-22 00:25:19 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_00-25-14/schema_summary.json
2025-12-22 00:25:19 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-22 00:25:19 INFO Topology: topology/persistence_basic/v1 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 172-dimensional node features.
2025-12-22 00:25:19 INFO Node: node/dssp_topo_merge/v1; metadata lists 172 feature columns matching the .pt tensor.
2025-12-22 00:25:19 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-22 00:25:19 INFO → Total feature dimensionality observed and confirmed: node_dim = 172, edge_dim = 11.
2025-12-22 00:25:19 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-22 00:25:19 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 172,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 172,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/topoqa_10A_no_drift_ARM/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_00-25-14/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge/v1",
      "alias": "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA",
      "jobs": 16,
      "summary": "DSSP-derived node features merged with topology statistics."
    },
    "topology": {
      "id": "topology/persistence_basic/v1",
      "alias": "Betti 0 and Betti 1 topology summaries on interface coords = 140D PH | TopoQA",
      "jobs": 16,
      "summary": "Persistent homology features with configurable distance thresholds."
    }
  },
  "notes": []
}
2025-12-22 00:25:19 INFO DataLoader num_workers=0 (recommended for macOS to avoid spawn issues; configurable via config.yaml -> num_workers).
2025-12-22 00:25:19 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=a1096ed0283d4a6daf103d17625e9834)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-22 00:25:19 INFO Starting training (fast_dev_run=False)
2025-12-22 00:25:19 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-22_00-25-14/model_checkpoints exists and is not empty.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 5.5 K  | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
165 K     Trainable params
0         Non-trainable params
165 K     Total params
0.662     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
2025-12-22 00:25:21 INFO Epoch 000 | 25% complete (batch 136/543)
2025-12-22 00:25:24 INFO Epoch 000 | 50% complete (batch 272/543)
2025-12-22 00:25:26 INFO Epoch 000 | 75% complete (batch 408/543)
2025-12-22 00:25:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.139867
2025-12-22 00:25:33 INFO Tuning ranking metrics: regret=0.181718 spearman=-0.131298 (groups=37, skipped=311)
2025-12-22 00:25:33 INFO Epoch 000 | val_loss=0.139867
Metric tuning_rank_spearman improved. New best score: -0.131
2025-12-22 00:25:35 INFO Epoch 001 | 25% complete (batch 136/543)
2025-12-22 00:25:38 INFO Epoch 001 | 50% complete (batch 272/543)
2025-12-22 00:25:41 INFO Epoch 001 | 75% complete (batch 408/543)
2025-12-22 00:25:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.257409
2025-12-22 00:25:47 INFO Tuning ranking metrics: regret=0.163475 spearman=-0.096051 (groups=37, skipped=311)
2025-12-22 00:25:47 INFO Epoch 001 | train_mse=0.142867 | val_loss=0.139471 | best_val_loss=-0.131298
Metric tuning_rank_spearman improved by 0.035 >= min_delta = 0.0. New best score: -0.096
2025-12-22 00:25:50 INFO Epoch 002 | 25% complete (batch 136/543)
2025-12-22 00:25:52 INFO Epoch 002 | 50% complete (batch 272/543)
2025-12-22 00:25:55 INFO Epoch 002 | 75% complete (batch 408/543)
2025-12-22 00:26:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.367431
2025-12-22 00:26:01 INFO Tuning ranking metrics: regret=0.164273 spearman=-0.130824 (groups=37, skipped=311)
2025-12-22 00:26:01 INFO Epoch 002 | train_mse=0.143836 | val_loss=0.141658 | best_val_loss=-0.096051
2025-12-22 00:26:04 INFO Epoch 003 | 25% complete (batch 136/543)
2025-12-22 00:26:07 INFO Epoch 003 | 50% complete (batch 272/543)
2025-12-22 00:26:09 INFO Epoch 003 | 75% complete (batch 408/543)
2025-12-22 00:26:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.148489
2025-12-22 00:26:16 INFO Tuning ranking metrics: regret=0.158953 spearman=-0.026360 (groups=37, skipped=311)
2025-12-22 00:26:16 INFO Epoch 003 | train_mse=0.145058 | val_loss=0.148489 | best_val_loss=-0.096051
Metric tuning_rank_spearman improved by 0.070 >= min_delta = 0.0. New best score: -0.026
2025-12-22 00:26:18 INFO Epoch 004 | 25% complete (batch 136/543)
2025-12-22 00:26:21 INFO Epoch 004 | 50% complete (batch 272/543)
2025-12-22 00:26:23 INFO Epoch 004 | 75% complete (batch 408/543)
2025-12-22 00:26:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.139944
2025-12-22 00:26:30 INFO Tuning ranking metrics: regret=0.172811 spearman=0.026436 (groups=37, skipped=311)
2025-12-22 00:26:30 INFO Epoch 004 | train_mse=0.145805 | val_loss=0.139944 | best_val_loss=-0.026360
Metric tuning_rank_spearman improved by 0.053 >= min_delta = 0.0. New best score: 0.026
2025-12-22 00:26:32 INFO Epoch 005 | 25% complete (batch 136/543)
2025-12-22 00:26:35 INFO Epoch 005 | 50% complete (batch 272/543)
2025-12-22 00:26:37 INFO Epoch 005 | 75% complete (batch 408/543)
2025-12-22 00:26:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.226994
2025-12-22 00:26:44 INFO Tuning ranking metrics: regret=0.193605 spearman=0.051714 (groups=37, skipped=311)
2025-12-22 00:26:44 INFO Epoch 005 | train_mse=0.144979 | val_loss=0.141161 | best_val_loss=0.026436
Metric tuning_rank_spearman improved by 0.025 >= min_delta = 0.0. New best score: 0.052
2025-12-22 00:26:46 INFO Epoch 006 | 25% complete (batch 136/543)
2025-12-22 00:26:49 INFO Epoch 006 | 50% complete (batch 272/543)
2025-12-22 00:26:51 INFO Epoch 006 | 75% complete (batch 408/543)
2025-12-22 00:26:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.309329
2025-12-22 00:26:57 INFO Tuning ranking metrics: regret=0.205176 spearman=-0.029882 (groups=37, skipped=311)
2025-12-22 00:26:57 INFO Epoch 006 | train_mse=0.142483 | val_loss=0.126977 | best_val_loss=0.051714
2025-12-22 00:27:00 INFO Epoch 007 | 25% complete (batch 136/543)
2025-12-22 00:27:03 INFO Epoch 007 | 50% complete (batch 272/543)
2025-12-22 00:27:06 INFO Epoch 007 | 75% complete (batch 408/543)
2025-12-22 00:27:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.428598
2025-12-22 00:27:12 INFO Tuning ranking metrics: regret=0.182111 spearman=-0.018702 (groups=37, skipped=311)
2025-12-22 00:27:12 INFO Epoch 007 | train_mse=0.141942 | val_loss=0.099463 | best_val_loss=0.051714
2025-12-22 00:27:15 INFO Epoch 008 | 25% complete (batch 136/543)
2025-12-22 00:27:17 INFO Epoch 008 | 50% complete (batch 272/543)
2025-12-22 00:27:20 INFO Epoch 008 | 75% complete (batch 408/543)
2025-12-22 00:27:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.462510
2025-12-22 00:27:26 INFO Tuning ranking metrics: regret=0.194688 spearman=-0.066608 (groups=37, skipped=311)
2025-12-22 00:27:26 INFO Epoch 008 | train_mse=0.122958 | val_loss=0.100245 | best_val_loss=0.051714
2025-12-22 00:27:29 INFO Epoch 009 | 25% complete (batch 136/543)
2025-12-22 00:27:31 INFO Epoch 009 | 50% complete (batch 272/543)
2025-12-22 00:27:34 INFO Epoch 009 | 75% complete (batch 408/543)
2025-12-22 00:27:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.474116
2025-12-22 00:27:41 INFO Tuning ranking metrics: regret=0.154256 spearman=0.108927 (groups=37, skipped=311)
2025-12-22 00:27:41 INFO Epoch 009 | train_mse=0.100712 | val_loss=0.076401 | best_val_loss=0.051714
Metric tuning_rank_spearman improved by 0.057 >= min_delta = 0.0. New best score: 0.109
2025-12-22 00:27:43 INFO Epoch 010 | 25% complete (batch 136/543)
2025-12-22 00:27:46 INFO Epoch 010 | 50% complete (batch 272/543)
2025-12-22 00:27:49 INFO Epoch 010 | 75% complete (batch 408/543)
2025-12-22 00:27:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.526476
2025-12-22 00:27:55 INFO Tuning ranking metrics: regret=0.153962 spearman=0.114151 (groups=37, skipped=311)
2025-12-22 00:27:55 INFO Epoch 010 | train_mse=0.085759 | val_loss=0.077483 | best_val_loss=0.108927
Metric tuning_rank_spearman improved by 0.005 >= min_delta = 0.0. New best score: 0.114
2025-12-22 00:27:58 INFO Epoch 011 | 25% complete (batch 136/543)
2025-12-22 00:28:01 INFO Epoch 011 | 50% complete (batch 272/543)
2025-12-22 00:28:04 INFO Epoch 011 | 75% complete (batch 408/543)
2025-12-22 00:28:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.503607
2025-12-22 00:28:11 INFO Tuning ranking metrics: regret=0.152714 spearman=0.106166 (groups=37, skipped=311)
2025-12-22 00:28:11 INFO Epoch 011 | train_mse=0.093472 | val_loss=0.087544 | best_val_loss=0.114151
2025-12-22 00:28:13 INFO Epoch 012 | 25% complete (batch 136/543)
2025-12-22 00:28:16 INFO Epoch 012 | 50% complete (batch 272/543)
2025-12-22 00:28:19 INFO Epoch 012 | 75% complete (batch 408/543)
2025-12-22 00:28:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.485613
2025-12-22 00:28:26 INFO Tuning ranking metrics: regret=0.159821 spearman=0.190991 (groups=37, skipped=311)
2025-12-22 00:28:26 INFO Epoch 012 | train_mse=0.079840 | val_loss=0.084840 | best_val_loss=0.114151
Metric tuning_rank_spearman improved by 0.077 >= min_delta = 0.0. New best score: 0.191
2025-12-22 00:28:28 INFO Epoch 013 | 25% complete (batch 136/543)
2025-12-22 00:28:31 INFO Epoch 013 | 50% complete (batch 272/543)
2025-12-22 00:28:34 INFO Epoch 013 | 75% complete (batch 408/543)
2025-12-22 00:28:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.495016
2025-12-22 00:28:41 INFO Tuning ranking metrics: regret=0.156352 spearman=0.189534 (groups=37, skipped=311)
2025-12-22 00:28:41 INFO Epoch 013 | train_mse=0.082373 | val_loss=0.081103 | best_val_loss=0.190991
2025-12-22 00:28:44 INFO Epoch 014 | 25% complete (batch 136/543)
2025-12-22 00:28:47 INFO Epoch 014 | 50% complete (batch 272/543)
2025-12-22 00:28:49 INFO Epoch 014 | 75% complete (batch 408/543)
2025-12-22 00:28:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.507988
2025-12-22 00:28:56 INFO Tuning ranking metrics: regret=0.140469 spearman=0.110144 (groups=37, skipped=311)
2025-12-22 00:28:56 INFO Epoch 014 | train_mse=0.081066 | val_loss=0.088683 | best_val_loss=0.190991
2025-12-22 00:28:59 INFO Epoch 015 | 25% complete (batch 136/543)
2025-12-22 00:29:02 INFO Epoch 015 | 50% complete (batch 272/543)
2025-12-22 00:29:05 INFO Epoch 015 | 75% complete (batch 408/543)
2025-12-22 00:29:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.538286
2025-12-22 00:29:11 INFO Tuning ranking metrics: regret=0.132351 spearman=0.247128 (groups=37, skipped=311)
2025-12-22 00:29:11 INFO Epoch 015 | train_mse=0.068006 | val_loss=0.075667 | best_val_loss=0.190991
Metric tuning_rank_spearman improved by 0.056 >= min_delta = 0.0. New best score: 0.247
2025-12-22 00:29:14 INFO Epoch 016 | 25% complete (batch 136/543)
2025-12-22 00:29:17 INFO Epoch 016 | 50% complete (batch 272/543)
2025-12-22 00:29:20 INFO Epoch 016 | 75% complete (batch 408/543)
2025-12-22 00:29:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.479435
2025-12-22 00:29:26 INFO Tuning ranking metrics: regret=0.134630 spearman=0.159518 (groups=37, skipped=311)
2025-12-22 00:29:26 INFO Epoch 016 | train_mse=0.072761 | val_loss=0.113126 | best_val_loss=0.247128
2025-12-22 00:29:29 INFO Epoch 017 | 25% complete (batch 136/543)
2025-12-22 00:29:32 INFO Epoch 017 | 50% complete (batch 272/543)
2025-12-22 00:29:35 INFO Epoch 017 | 75% complete (batch 408/543)
2025-12-22 00:29:40 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.552887
2025-12-22 00:29:41 INFO Tuning ranking metrics: regret=0.132165 spearman=0.129999 (groups=37, skipped=311)
2025-12-22 00:29:41 INFO Epoch 017 | train_mse=0.079134 | val_loss=0.073198 | best_val_loss=0.247128
2025-12-22 00:29:44 INFO Epoch 018 | 25% complete (batch 136/543)
2025-12-22 00:29:47 INFO Epoch 018 | 50% complete (batch 272/543)
2025-12-22 00:29:49 INFO Epoch 018 | 75% complete (batch 408/543)
2025-12-22 00:29:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.538779
2025-12-22 00:29:56 INFO Tuning ranking metrics: regret=0.150159 spearman=0.108395 (groups=37, skipped=311)
2025-12-22 00:29:56 INFO Epoch 018 | train_mse=0.086567 | val_loss=0.074186 | best_val_loss=0.247128
2025-12-22 00:29:59 INFO Epoch 019 | 25% complete (batch 136/543)
2025-12-22 00:30:02 INFO Epoch 019 | 50% complete (batch 272/543)
2025-12-22 00:30:05 INFO Epoch 019 | 75% complete (batch 408/543)
2025-12-22 00:30:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.533002
2025-12-22 00:30:11 INFO Tuning ranking metrics: regret=0.115088 spearman=0.144875 (groups=37, skipped=311)
2025-12-22 00:30:11 INFO Epoch 019 | train_mse=0.070033 | val_loss=0.074607 | best_val_loss=0.247128
2025-12-22 00:30:14 INFO Epoch 020 | 25% complete (batch 136/543)
2025-12-22 00:30:17 INFO Epoch 020 | 50% complete (batch 272/543)
2025-12-22 00:30:20 INFO Epoch 020 | 75% complete (batch 408/543)
2025-12-22 00:30:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.549937
2025-12-22 00:30:26 INFO Tuning ranking metrics: regret=0.097428 spearman=0.161823 (groups=37, skipped=311)
2025-12-22 00:30:26 INFO Epoch 020 | train_mse=0.076898 | val_loss=0.070382 | best_val_loss=0.247128
2025-12-22 00:30:29 INFO Epoch 021 | 25% complete (batch 136/543)
2025-12-22 00:30:32 INFO Epoch 021 | 50% complete (batch 272/543)
2025-12-22 00:30:34 INFO Epoch 021 | 75% complete (batch 408/543)
2025-12-22 00:30:40 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.558726
2025-12-22 00:30:41 INFO Tuning ranking metrics: regret=0.145888 spearman=0.192711 (groups=37, skipped=311)
2025-12-22 00:30:41 INFO Epoch 021 | train_mse=0.075745 | val_loss=0.077337 | best_val_loss=0.247128
2025-12-22 00:30:44 INFO Epoch 022 | 25% complete (batch 136/543)
2025-12-22 00:30:46 INFO Epoch 022 | 50% complete (batch 272/543)
2025-12-22 00:30:49 INFO Epoch 022 | 75% complete (batch 408/543)
2025-12-22 00:30:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.536884
2025-12-22 00:30:56 INFO Tuning ranking metrics: regret=0.102335 spearman=0.185521 (groups=37, skipped=311)
2025-12-22 00:30:56 INFO Epoch 022 | train_mse=0.072610 | val_loss=0.086661 | best_val_loss=0.247128
2025-12-22 00:30:58 INFO Epoch 023 | 25% complete (batch 136/543)
2025-12-22 00:31:01 INFO Epoch 023 | 50% complete (batch 272/543)
2025-12-22 00:31:04 INFO Epoch 023 | 75% complete (batch 408/543)
2025-12-22 00:31:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.563392
2025-12-22 00:31:10 INFO Tuning ranking metrics: regret=0.127117 spearman=0.170142 (groups=37, skipped=311)
2025-12-22 00:31:10 INFO Epoch 023 | train_mse=0.070397 | val_loss=0.071866 | best_val_loss=0.247128
2025-12-22 00:31:13 INFO Epoch 024 | 25% complete (batch 136/543)
2025-12-22 00:31:16 INFO Epoch 024 | 50% complete (batch 272/543)
2025-12-22 00:31:19 INFO Epoch 024 | 75% complete (batch 408/543)
2025-12-22 00:31:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.565992
2025-12-22 00:31:25 INFO Tuning ranking metrics: regret=0.145503 spearman=0.134462 (groups=37, skipped=311)
2025-12-22 00:31:25 INFO Epoch 024 | train_mse=0.065764 | val_loss=0.082042 | best_val_loss=0.247128
2025-12-22 00:31:28 INFO Epoch 025 | 25% complete (batch 136/543)
2025-12-22 00:31:31 INFO Epoch 025 | 50% complete (batch 272/543)
2025-12-22 00:31:34 INFO Epoch 025 | 75% complete (batch 408/543)
2025-12-22 00:31:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.589364
2025-12-22 00:31:40 INFO Tuning ranking metrics: regret=0.126547 spearman=0.229806 (groups=37, skipped=311)
2025-12-22 00:31:40 INFO Epoch 025 | train_mse=0.070649 | val_loss=0.068372 | best_val_loss=0.247128
2025-12-22 00:31:43 INFO Epoch 026 | 25% complete (batch 136/543)
2025-12-22 00:31:46 INFO Epoch 026 | 50% complete (batch 272/543)
2025-12-22 00:31:49 INFO Epoch 026 | 75% complete (batch 408/543)
2025-12-22 00:31:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.573178
2025-12-22 00:31:55 INFO Tuning ranking metrics: regret=0.109361 spearman=0.170563 (groups=37, skipped=311)
2025-12-22 00:31:55 INFO Epoch 026 | train_mse=0.076682 | val_loss=0.092247 | best_val_loss=0.247128
2025-12-22 00:31:58 INFO Epoch 027 | 25% complete (batch 136/543)
2025-12-22 00:32:00 INFO Epoch 027 | 50% complete (batch 272/543)
2025-12-22 00:32:03 INFO Epoch 027 | 75% complete (batch 408/543)
2025-12-22 00:32:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.559054
2025-12-22 00:32:10 INFO Tuning ranking metrics: regret=0.131890 spearman=0.115912 (groups=37, skipped=311)
2025-12-22 00:32:10 INFO Epoch 027 | train_mse=0.063588 | val_loss=0.068021 | best_val_loss=0.247128
2025-12-22 00:32:12 INFO Epoch 028 | 25% complete (batch 136/543)
2025-12-22 00:32:15 INFO Epoch 028 | 50% complete (batch 272/543)
2025-12-22 00:32:18 INFO Epoch 028 | 75% complete (batch 408/543)
2025-12-22 00:32:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.595747
2025-12-22 00:32:24 INFO Tuning ranking metrics: regret=0.104204 spearman=0.139236 (groups=37, skipped=311)
2025-12-22 00:32:24 INFO Epoch 028 | train_mse=0.063011 | val_loss=0.066640 | best_val_loss=0.247128
2025-12-22 00:32:27 INFO Epoch 029 | 25% complete (batch 136/543)
2025-12-22 00:32:29 INFO Epoch 029 | 50% complete (batch 272/543)
2025-12-22 00:32:32 INFO Epoch 029 | 75% complete (batch 408/543)
2025-12-22 00:32:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.624399
2025-12-22 00:32:38 INFO Tuning ranking metrics: regret=0.115763 spearman=0.220346 (groups=37, skipped=311)
2025-12-22 00:32:38 INFO Epoch 029 | train_mse=0.062356 | val_loss=0.069267 | best_val_loss=0.247128
2025-12-22 00:32:41 INFO Epoch 030 | 25% complete (batch 136/543)
2025-12-22 00:32:44 INFO Epoch 030 | 50% complete (batch 272/543)
2025-12-22 00:32:46 INFO Epoch 030 | 75% complete (batch 408/543)
2025-12-22 00:32:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.572064
2025-12-22 00:32:53 INFO Tuning ranking metrics: regret=0.125671 spearman=0.206575 (groups=37, skipped=311)
2025-12-22 00:32:53 INFO Epoch 030 | train_mse=0.061533 | val_loss=0.073304 | best_val_loss=0.247128
2025-12-22 00:32:55 INFO Epoch 031 | 25% complete (batch 136/543)
2025-12-22 00:32:58 INFO Epoch 031 | 50% complete (batch 272/543)
2025-12-22 00:33:01 INFO Epoch 031 | 75% complete (batch 408/543)
2025-12-22 00:33:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.579999
2025-12-22 00:33:07 INFO Tuning ranking metrics: regret=0.114946 spearman=0.216947 (groups=37, skipped=311)
2025-12-22 00:33:07 INFO Epoch 031 | train_mse=0.057297 | val_loss=0.071243 | best_val_loss=0.247128
2025-12-22 00:33:10 INFO Epoch 032 | 25% complete (batch 136/543)
2025-12-22 00:33:13 INFO Epoch 032 | 50% complete (batch 272/543)
2025-12-22 00:33:16 INFO Epoch 032 | 75% complete (batch 408/543)
2025-12-22 00:33:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.584784
2025-12-22 00:33:22 INFO Tuning ranking metrics: regret=0.146780 spearman=0.084398 (groups=37, skipped=311)
2025-12-22 00:33:22 INFO Epoch 032 | train_mse=0.057717 | val_loss=0.066986 | best_val_loss=0.247128
2025-12-22 00:33:25 INFO Epoch 033 | 25% complete (batch 136/543)
2025-12-22 00:33:27 INFO Epoch 033 | 50% complete (batch 272/543)
2025-12-22 00:33:30 INFO Epoch 033 | 75% complete (batch 408/543)
2025-12-22 00:33:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.594529
2025-12-22 00:33:37 INFO Tuning ranking metrics: regret=0.125446 spearman=0.159658 (groups=37, skipped=311)
2025-12-22 00:33:37 INFO Epoch 033 | train_mse=0.064968 | val_loss=0.069194 | best_val_loss=0.247128
2025-12-22 00:33:40 INFO Epoch 034 | 25% complete (batch 136/543)
2025-12-22 00:33:42 INFO Epoch 034 | 50% complete (batch 272/543)
2025-12-22 00:33:45 INFO Epoch 034 | 75% complete (batch 408/543)
2025-12-22 00:33:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.607110
2025-12-22 00:33:51 INFO Tuning ranking metrics: regret=0.119079 spearman=0.143460 (groups=37, skipped=311)
2025-12-22 00:33:51 INFO Epoch 034 | train_mse=0.066966 | val_loss=0.065463 | best_val_loss=0.247128
2025-12-22 00:33:54 INFO Epoch 035 | 25% complete (batch 136/543)
2025-12-22 00:33:56 INFO Epoch 035 | 50% complete (batch 272/543)
2025-12-22 00:33:59 INFO Epoch 035 | 75% complete (batch 408/543)
2025-12-22 00:34:04 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.605923
2025-12-22 00:34:06 INFO Tuning ranking metrics: regret=0.107127 spearman=0.070516 (groups=37, skipped=311)
2025-12-22 00:34:06 INFO Epoch 035 | train_mse=0.061536 | val_loss=0.061346 | best_val_loss=0.247128
2025-12-22 00:34:09 INFO Epoch 036 | 25% complete (batch 136/543)
2025-12-22 00:34:11 INFO Epoch 036 | 50% complete (batch 272/543)
2025-12-22 00:34:14 INFO Epoch 036 | 75% complete (batch 408/543)
2025-12-22 00:34:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.625472
2025-12-22 00:34:21 INFO Tuning ranking metrics: regret=0.126750 spearman=0.079765 (groups=37, skipped=311)
2025-12-22 00:34:21 INFO Epoch 036 | train_mse=0.062028 | val_loss=0.061883 | best_val_loss=0.247128
