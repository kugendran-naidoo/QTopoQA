Generating graph-dir manifest for advanced_lean_10A ...
[validate_graphs] PROGRESS: 11163/14391 (77.6%) elapsed 15.0s eta 4.3s mismatched=0 missing=0
[validate_graphs] PROGRESS: 11163/14391 (77.6%) elapsed 15.0s eta 4.3s mismatched=0 missing=0
[validate_graphs] PROGRESS: 14391/14391 (100.0%) elapsed 18.7s eta 0.0s mismatched=0 missing=0
[validate_graphs] Manifest written: ../graph_builder2/output/advanced_lean_10A/graph_data/graph_manifest.json
[validate_graphs] OK: validated 14391 graph(s) in /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data

real	0m20.427s
user	1m51.123s
sys	0m59.206s
Done with manifest for advanced_lean_10A ...
       20.43 real       111.12 user        59.20 sys
Skipped Validating graphs using standalone tool ...
Starting model training ...
[run_full_pipeline] Validating graphs before training...
[validate_graphs] OK: validated 14391 graph(s) in /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data
[run_full_pipeline] Starting sweep at 2025-12-24T09:03:53.655381+00:00 using manifest /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/manifests/run_lean.yaml
[train_cli][batch] (1/3) running job 'sched_boost_lean_seed222' -> run_name=sched_boost_lean_seed222_2025-12-24_09-03-53
[train_cli] run_id=sched_boost_lean_seed222_2025-12-24_09-03-53 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53 --git-commit 94c0e71caa --git-dirty
2025-12-24 09:03:57 INFO git_commit = 94c0e71caa (dirty)
2025-12-24 09:03:57 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-24 09:03:57 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53/config/config.yaml
2025-12-24 09:03:57 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data
2025-12-24 09:03:57 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-24 09:03:57 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-24 09:03:57 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53
2025-12-24 09:03:57 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-24 09:03:57 INFO   metadata_path = None
2025-12-24 09:03:57 INFO   summary_path = None
2025-12-24 09:03:57 INFO   accelerator = cpu
2025-12-24 09:03:57 INFO   devices = 1
2025-12-24 09:03:57 INFO   attention_head = 8
2025-12-24 09:03:57 INFO   pooling_type = mean
2025-12-24 09:03:57 INFO   model_self_loops = False
2025-12-24 09:03:57 INFO   model_self_loop_fill = mean
2025-12-24 09:03:57 INFO   model_residual = False
2025-12-24 09:03:57 INFO   batch_size = 48
2025-12-24 09:03:57 INFO   learning_rate = 0.005
2025-12-24 09:03:57 INFO   num_epochs = 140
2025-12-24 09:03:57 INFO   accumulate_grad_batches = 8
2025-12-24 09:03:57 INFO   seed = 222
2025-12-24 09:03:57 INFO   num_workers = 2
2025-12-24 09:03:57 INFO   precision = 32
2025-12-24 09:03:57 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-24 09:03:57 INFO   early_stopping_patience = 24
2025-12-24 09:03:57 INFO   lr_scheduler_patience = 6
2025-12-24 09:03:57 INFO   lr_scheduler_factor = 0.2
2025-12-24 09:03:57 INFO   fast_dev_run = False
2025-12-24 09:03:57 INFO   limit_train_batches = None
2025-12-24 09:03:57 INFO   limit_val_batches = None
2025-12-24 09:03:57 INFO   log_lr = False
2025-12-24 09:03:57 INFO   progress_bar_refresh_rate = 0
2025-12-24 09:03:57 INFO   log_every_n_steps = 100
2025-12-24 09:03:57 INFO   use_val_spearman_as_secondary = True
2025-12-24 09:03:57 INFO   spearman_secondary_min_delta = 0.0
2025-12-24 09:03:57 INFO   spearman_secondary_weight = 1.0
2025-12-24 09:03:57 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-24 09:03:57 INFO   tuning_max_samples = 500
2025-12-24 09:03:57 INFO   tuning_fraction = None
2025-12-24 09:03:57 INFO   tuning_eval_every = 1
2025-12-24 09:03:57 INFO   rank_loss_weight = 0.0
2025-12-24 09:03:57 INFO   rank_loss_margin = 0.0
2025-12-24 09:03:57 INFO   rank_loss_mode = hinge
2025-12-24 09:03:57 INFO   rank_loss_grouped = True
2025-12-24 09:03:57 INFO   variance_reduction_enabled = False
2025-12-24 09:03:57 INFO   variance_reduction_method = topk_avg
2025-12-24 09:03:57 INFO   variance_reduction_top_k = 3
2025-12-24 09:03:57 INFO   coverage_minimum = 0.0
2025-12-24 09:03:57 INFO   coverage_fail_on_missing = False
2025-12-24 09:03:57 INFO   graph_load_profiling = False
2025-12-24 09:03:57 INFO   graph_load_top_k = 5
2025-12-24 09:03:57 INFO   enable_graph_cache = True
2025-12-24 09:03:57 INFO   graph_cache_size = 256
2025-12-24 09:03:57 INFO   canonicalize_on_load = False
2025-12-24 09:03:57 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-24 09:03:57 INFO   edge_schema = {}
2025-12-24 09:03:57 INFO   topology_schema = {}
Seed set to 222
2025-12-24 09:03:57 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-24 09:03:57 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 09:03:57 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-24 09:03:57 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 09:03:57 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-24 09:03:57 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 09:03:59 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-24 09:03:59 INFO Tuning group stats: groups=352 groups>=2=34 singletons=318 max_group=11
2025-12-24 09:03:59 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53/dataset_coverage.json
2025-12-24 09:03:59 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53/dataset_coverage.json for details.
2025-12-24 09:03:59 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53/dataset_coverage.json for details.
2025-12-24 09:03:59 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53/dataset_coverage.json for details.
2025-12-24 09:03:59 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53/schema_summary.json
2025-12-24 09:03:59 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53/feature_metadata.json
2025-12-24 09:03:59 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-24 09:03:59 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/advanced_k_partite_v2/feature-config.yaml.advanced_lean.10A.v2, sha256=2022a36e7b21668173af3af66c25cf6b6a0494e642c0934eac38abbcfeebec3d
2025-12-24 09:03:59 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/work/edge_features)
2025-12-24 09:03:59 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json
2025-12-24 09:03:59 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53/schema_summary.json
2025-12-24 09:03:59 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-24 09:03:59 INFO Topology: topology/persistence_k_partite_advanced/v2 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 628-dimensional node features.
2025-12-24 09:03:59 INFO Node: node/dssp_topo_merge_passthrough/v1; metadata lists 628 feature columns matching the .pt tensor.
2025-12-24 09:03:59 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-24 09:03:59 INFO → Total feature dimensionality observed and confirmed: node_dim = 628, edge_dim = 11.
2025-12-24 09:03:59 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-24 09:03:59 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 628,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge_passthrough/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 628,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge_passthrough/v1",
      "alias": "Passthrough (all dims from topology module) = Node Dynamic Dims",
      "jobs": 16,
      "summary": "DSSP/basic features merged with all topology columns (passthrough)."
    },
    "topology": {
      "id": "topology/persistence_k_partite_advanced/v2",
      "alias": "Advanced k-partite PH (v2 lean) topo_dim 596",
      "jobs": 16,
      "summary": "Fixed-width k-partite persistent homology with slot padding + missingness channels."
    }
  },
  "notes": []
}
2025-12-24 09:03:59 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-24 09:04:00 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=20ec1e8606834155804c88bd85739f01)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-24 09:04:00 INFO Starting training (fast_dev_run=False)
2025-12-24 09:04:00 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53/model_checkpoints exists and is not empty.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 20.1 K | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
180 K     Trainable params
0         Non-trainable params
180 K     Total params
0.721     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-24 09:04:15 INFO Epoch 000 | 25% complete (batch 46/181)
2025-12-24 09:04:15 INFO Epoch 000 | 50% complete (batch 91/181)
2025-12-24 09:04:16 INFO Epoch 000 | 75% complete (batch 136/181)
2025-12-24 09:04:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.140560
2025-12-24 09:04:30 INFO Tuning ranking metrics: regret=0.154501 spearman=-0.163312 (groups=34, skipped=318)
2025-12-24 09:04:30 INFO Epoch 000 | val_loss=0.140560
Metric tuning_rank_spearman improved. New best score: -0.163
2025-12-24 09:04:38 INFO Epoch 001 | 25% complete (batch 46/181)
2025-12-24 09:04:39 INFO Epoch 001 | 50% complete (batch 91/181)
2025-12-24 09:04:40 INFO Epoch 001 | 75% complete (batch 136/181)
2025-12-24 09:04:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.007163
2025-12-24 09:04:54 INFO Tuning ranking metrics: regret=0.156585 spearman=-0.126362 (groups=34, skipped=318)
2025-12-24 09:04:54 INFO Epoch 001 | train_mse=0.158072 | val_loss=0.140624 | best_val_loss=-0.163312
Metric tuning_rank_spearman improved by 0.037 >= min_delta = 0.0. New best score: -0.126
2025-12-24 09:05:04 INFO Epoch 002 | 25% complete (batch 46/181)
2025-12-24 09:05:05 INFO Epoch 002 | 50% complete (batch 91/181)
2025-12-24 09:05:06 INFO Epoch 002 | 75% complete (batch 136/181)
2025-12-24 09:05:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.075319
2025-12-24 09:05:20 INFO Tuning ranking metrics: regret=0.179328 spearman=-0.221359 (groups=34, skipped=318)
2025-12-24 09:05:20 INFO Epoch 002 | train_mse=0.155145 | val_loss=0.140561 | best_val_loss=-0.126362
2025-12-24 09:05:29 INFO Epoch 003 | 25% complete (batch 46/181)
2025-12-24 09:05:29 INFO Epoch 003 | 50% complete (batch 91/181)
2025-12-24 09:05:30 INFO Epoch 003 | 75% complete (batch 136/181)
2025-12-24 09:05:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.033347
2025-12-24 09:05:44 INFO Tuning ranking metrics: regret=0.149787 spearman=-0.070735 (groups=34, skipped=318)
2025-12-24 09:05:44 INFO Epoch 003 | train_mse=0.137744 | val_loss=0.140558 | best_val_loss=-0.126362
Metric tuning_rank_spearman improved by 0.056 >= min_delta = 0.0. New best score: -0.071
2025-12-24 09:05:52 INFO Epoch 004 | 25% complete (batch 46/181)
2025-12-24 09:05:53 INFO Epoch 004 | 50% complete (batch 91/181)
2025-12-24 09:05:54 INFO Epoch 004 | 75% complete (batch 136/181)
2025-12-24 09:06:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.371174
2025-12-24 09:06:08 INFO Tuning ranking metrics: regret=0.139820 spearman=-0.048924 (groups=34, skipped=318)
2025-12-24 09:06:08 INFO Epoch 004 | train_mse=0.139381 | val_loss=0.140953 | best_val_loss=-0.070735
Metric tuning_rank_spearman improved by 0.022 >= min_delta = 0.0. New best score: -0.049
2025-12-24 09:06:17 INFO Epoch 005 | 25% complete (batch 46/181)
2025-12-24 09:06:18 INFO Epoch 005 | 50% complete (batch 91/181)
2025-12-24 09:06:19 INFO Epoch 005 | 75% complete (batch 136/181)
2025-12-24 09:06:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.130174
2025-12-24 09:06:32 INFO Tuning ranking metrics: regret=0.140159 spearman=-0.171282 (groups=34, skipped=318)
2025-12-24 09:06:32 INFO Epoch 005 | train_mse=0.153096 | val_loss=0.140572 | best_val_loss=-0.048924
2025-12-24 09:06:40 INFO Epoch 006 | 25% complete (batch 46/181)
2025-12-24 09:06:41 INFO Epoch 006 | 50% complete (batch 91/181)
2025-12-24 09:06:42 INFO Epoch 006 | 75% complete (batch 136/181)
2025-12-24 09:06:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.232044
2025-12-24 09:06:56 INFO Tuning ranking metrics: regret=0.131359 spearman=-0.027833 (groups=34, skipped=318)
2025-12-24 09:06:56 INFO Epoch 006 | train_mse=0.142274 | val_loss=0.138701 | best_val_loss=-0.048924
Metric tuning_rank_spearman improved by 0.021 >= min_delta = 0.0. New best score: -0.028
2025-12-24 09:07:04 INFO Epoch 007 | 25% complete (batch 46/181)
2025-12-24 09:07:05 INFO Epoch 007 | 50% complete (batch 91/181)
2025-12-24 09:07:06 INFO Epoch 007 | 75% complete (batch 136/181)
2025-12-24 09:07:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.180269
2025-12-24 09:07:19 INFO Tuning ranking metrics: regret=0.136157 spearman=-0.079832 (groups=34, skipped=318)
2025-12-24 09:07:19 INFO Epoch 007 | train_mse=0.140653 | val_loss=0.137272 | best_val_loss=-0.027833
2025-12-24 09:07:28 INFO Epoch 008 | 25% complete (batch 46/181)
2025-12-24 09:07:29 INFO Epoch 008 | 50% complete (batch 91/181)
2025-12-24 09:07:29 INFO Epoch 008 | 75% complete (batch 136/181)
2025-12-24 09:07:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.159074
2025-12-24 09:07:43 INFO Tuning ranking metrics: regret=0.133979 spearman=-0.013057 (groups=34, skipped=318)
2025-12-24 09:07:43 INFO Epoch 008 | train_mse=0.157523 | val_loss=0.141481 | best_val_loss=-0.027833
Metric tuning_rank_spearman improved by 0.015 >= min_delta = 0.0. New best score: -0.013
2025-12-24 09:07:51 INFO Epoch 009 | 25% complete (batch 46/181)
2025-12-24 09:07:52 INFO Epoch 009 | 50% complete (batch 91/181)
2025-12-24 09:07:53 INFO Epoch 009 | 75% complete (batch 136/181)
2025-12-24 09:08:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.129131
2025-12-24 09:08:06 INFO Tuning ranking metrics: regret=0.098013 spearman=0.038987 (groups=34, skipped=318)
2025-12-24 09:08:06 INFO Epoch 009 | train_mse=0.155811 | val_loss=0.140153 | best_val_loss=-0.013057
Metric tuning_rank_spearman improved by 0.052 >= min_delta = 0.0. New best score: 0.039
2025-12-24 09:08:14 INFO Epoch 010 | 25% complete (batch 46/181)
2025-12-24 09:08:16 INFO Epoch 010 | 50% complete (batch 91/181)
2025-12-24 09:08:17 INFO Epoch 010 | 75% complete (batch 136/181)
2025-12-24 09:08:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.003093
2025-12-24 09:08:30 INFO Tuning ranking metrics: regret=0.135311 spearman=-0.186644 (groups=34, skipped=318)
2025-12-24 09:08:30 INFO Epoch 010 | train_mse=0.149202 | val_loss=0.140636 | best_val_loss=0.038987
2025-12-24 09:08:38 INFO Epoch 011 | 25% complete (batch 46/181)
2025-12-24 09:08:39 INFO Epoch 011 | 50% complete (batch 91/181)
2025-12-24 09:08:40 INFO Epoch 011 | 75% complete (batch 136/181)
2025-12-24 09:08:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.160516
2025-12-24 09:08:54 INFO Tuning ranking metrics: regret=0.139708 spearman=-0.073160 (groups=34, skipped=318)
2025-12-24 09:08:54 INFO Epoch 011 | train_mse=0.146214 | val_loss=0.134423 | best_val_loss=0.038987
2025-12-24 09:09:02 INFO Epoch 012 | 25% complete (batch 46/181)
2025-12-24 09:09:03 INFO Epoch 012 | 50% complete (batch 91/181)
2025-12-24 09:09:04 INFO Epoch 012 | 75% complete (batch 136/181)
2025-12-24 09:09:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.052298
2025-12-24 09:09:17 INFO Tuning ranking metrics: regret=0.103338 spearman=-0.107194 (groups=34, skipped=318)
2025-12-24 09:09:17 INFO Epoch 012 | train_mse=0.134195 | val_loss=0.134793 | best_val_loss=0.038987
2025-12-24 09:09:25 INFO Epoch 013 | 25% complete (batch 46/181)
2025-12-24 09:09:26 INFO Epoch 013 | 50% complete (batch 91/181)
2025-12-24 09:09:27 INFO Epoch 013 | 75% complete (batch 136/181)
2025-12-24 09:09:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.096276
2025-12-24 09:09:40 INFO Tuning ranking metrics: regret=0.147420 spearman=-0.150968 (groups=34, skipped=318)
2025-12-24 09:09:40 INFO Epoch 013 | train_mse=0.115910 | val_loss=0.134662 | best_val_loss=0.038987
2025-12-24 09:09:49 INFO Epoch 014 | 25% complete (batch 46/181)
2025-12-24 09:09:50 INFO Epoch 014 | 50% complete (batch 91/181)
2025-12-24 09:09:50 INFO Epoch 014 | 75% complete (batch 136/181)
2025-12-24 09:09:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.084246
2025-12-24 09:10:04 INFO Tuning ranking metrics: regret=0.132960 spearman=0.026064 (groups=34, skipped=318)
2025-12-24 09:10:04 INFO Epoch 014 | train_mse=0.135424 | val_loss=0.134887 | best_val_loss=0.038987
2025-12-24 09:10:12 INFO Epoch 015 | 25% complete (batch 46/181)
2025-12-24 09:10:13 INFO Epoch 015 | 50% complete (batch 91/181)
2025-12-24 09:10:14 INFO Epoch 015 | 75% complete (batch 136/181)
2025-12-24 09:10:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.015351
2025-12-24 09:10:27 INFO Tuning ranking metrics: regret=0.132941 spearman=0.006016 (groups=34, skipped=318)
2025-12-24 09:10:27 INFO Epoch 015 | train_mse=0.130245 | val_loss=0.134801 | best_val_loss=0.038987
2025-12-24 09:10:35 INFO Epoch 016 | 25% complete (batch 46/181)
2025-12-24 09:10:36 INFO Epoch 016 | 50% complete (batch 91/181)
2025-12-24 09:10:37 INFO Epoch 016 | 75% complete (batch 136/181)
2025-12-24 09:10:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.006899
2025-12-24 09:10:51 INFO Tuning ranking metrics: regret=0.131661 spearman=0.067048 (groups=34, skipped=318)
2025-12-24 09:10:51 INFO Epoch 016 | train_mse=0.148139 | val_loss=0.135176 | best_val_loss=0.038987
Metric tuning_rank_spearman improved by 0.028 >= min_delta = 0.0. New best score: 0.067
2025-12-24 09:10:59 INFO Epoch 017 | 25% complete (batch 46/181)
2025-12-24 09:11:00 INFO Epoch 017 | 50% complete (batch 91/181)
2025-12-24 09:11:01 INFO Epoch 017 | 75% complete (batch 136/181)
2025-12-24 09:11:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.007737
2025-12-24 09:11:15 INFO Tuning ranking metrics: regret=0.132846 spearman=0.068494 (groups=34, skipped=318)
2025-12-24 09:11:15 INFO Epoch 017 | train_mse=0.140602 | val_loss=0.135339 | best_val_loss=0.067048
Metric tuning_rank_spearman improved by 0.001 >= min_delta = 0.0. New best score: 0.068
2025-12-24 09:11:23 INFO Epoch 018 | 25% complete (batch 46/181)
2025-12-24 09:11:24 INFO Epoch 018 | 50% complete (batch 91/181)
2025-12-24 09:11:25 INFO Epoch 018 | 75% complete (batch 136/181)
2025-12-24 09:11:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.006445
2025-12-24 09:11:38 INFO Tuning ranking metrics: regret=0.136050 spearman=-0.021225 (groups=34, skipped=318)
2025-12-24 09:11:38 INFO Epoch 018 | train_mse=0.135644 | val_loss=0.134703 | best_val_loss=0.068494
2025-12-24 09:11:47 INFO Epoch 019 | 25% complete (batch 46/181)
2025-12-24 09:11:48 INFO Epoch 019 | 50% complete (batch 91/181)
2025-12-24 09:11:49 INFO Epoch 019 | 75% complete (batch 136/181)
2025-12-24 09:11:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.112653
2025-12-24 09:12:02 INFO Tuning ranking metrics: regret=0.131182 spearman=0.027298 (groups=34, skipped=318)
2025-12-24 09:12:02 INFO Epoch 019 | train_mse=0.135617 | val_loss=0.134717 | best_val_loss=0.068494
2025-12-24 09:12:11 INFO Epoch 020 | 25% complete (batch 46/181)
2025-12-24 09:12:11 INFO Epoch 020 | 50% complete (batch 91/181)
2025-12-24 09:12:12 INFO Epoch 020 | 75% complete (batch 136/181)
2025-12-24 09:12:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.087465
2025-12-24 09:12:26 INFO Tuning ranking metrics: regret=0.131081 spearman=0.032850 (groups=34, skipped=318)
2025-12-24 09:12:26 INFO Epoch 020 | train_mse=0.131674 | val_loss=0.134720 | best_val_loss=0.068494
2025-12-24 09:12:34 INFO Epoch 021 | 25% complete (batch 46/181)
2025-12-24 09:12:35 INFO Epoch 021 | 50% complete (batch 91/181)
2025-12-24 09:12:36 INFO Epoch 021 | 75% complete (batch 136/181)
2025-12-24 09:12:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.039018
2025-12-24 09:12:49 INFO Tuning ranking metrics: regret=0.131222 spearman=0.033970 (groups=34, skipped=318)
2025-12-24 09:12:49 INFO Epoch 021 | train_mse=0.126076 | val_loss=0.134676 | best_val_loss=0.068494
2025-12-24 09:12:58 INFO Epoch 022 | 25% complete (batch 46/181)
2025-12-24 09:12:59 INFO Epoch 022 | 50% complete (batch 91/181)
2025-12-24 09:12:59 INFO Epoch 022 | 75% complete (batch 136/181)
2025-12-24 09:13:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.027078
2025-12-24 09:13:13 INFO Tuning ranking metrics: regret=0.131779 spearman=0.032996 (groups=34, skipped=318)
2025-12-24 09:13:13 INFO Epoch 022 | train_mse=0.128771 | val_loss=0.134660 | best_val_loss=0.068494
2025-12-24 09:13:21 INFO Epoch 023 | 25% complete (batch 46/181)
2025-12-24 09:13:22 INFO Epoch 023 | 50% complete (batch 91/181)
2025-12-24 09:13:23 INFO Epoch 023 | 75% complete (batch 136/181)
2025-12-24 09:13:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.017439
2025-12-24 09:13:36 INFO Tuning ranking metrics: regret=0.131779 spearman=0.027954 (groups=34, skipped=318)
2025-12-24 09:13:36 INFO Epoch 023 | train_mse=0.135737 | val_loss=0.134658 | best_val_loss=0.068494
2025-12-24 09:13:45 INFO Epoch 024 | 25% complete (batch 46/181)
2025-12-24 09:13:46 INFO Epoch 024 | 50% complete (batch 91/181)
2025-12-24 09:13:47 INFO Epoch 024 | 75% complete (batch 136/181)
2025-12-24 09:13:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.024502
2025-12-24 09:14:00 INFO Tuning ranking metrics: regret=0.133051 spearman=-0.008040 (groups=34, skipped=318)
2025-12-24 09:14:00 INFO Epoch 024 | train_mse=0.127640 | val_loss=0.134823 | best_val_loss=0.068494
2025-12-24 09:14:08 INFO Epoch 025 | 25% complete (batch 46/181)
2025-12-24 09:14:09 INFO Epoch 025 | 50% complete (batch 91/181)
2025-12-24 09:14:10 INFO Epoch 025 | 75% complete (batch 136/181)
2025-12-24 09:14:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.084707
2025-12-24 09:14:23 INFO Tuning ranking metrics: regret=0.136366 spearman=-0.008569 (groups=34, skipped=318)
2025-12-24 09:14:23 INFO Epoch 025 | train_mse=0.135204 | val_loss=0.134745 | best_val_loss=0.068494
2025-12-24 09:14:31 INFO Epoch 026 | 25% complete (batch 46/181)
2025-12-24 09:14:32 INFO Epoch 026 | 50% complete (batch 91/181)
2025-12-24 09:14:33 INFO Epoch 026 | 75% complete (batch 136/181)
2025-12-24 09:14:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.106217
2025-12-24 09:14:47 INFO Tuning ranking metrics: regret=0.136476 spearman=-0.012802 (groups=34, skipped=318)
2025-12-24 09:14:47 INFO Epoch 026 | train_mse=0.125041 | val_loss=0.134731 | best_val_loss=0.068494
2025-12-24 09:14:55 INFO Epoch 027 | 25% complete (batch 46/181)
2025-12-24 09:14:56 INFO Epoch 027 | 50% complete (batch 91/181)
2025-12-24 09:14:57 INFO Epoch 027 | 75% complete (batch 136/181)
2025-12-24 09:15:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.138263
2025-12-24 09:15:10 INFO Tuning ranking metrics: regret=0.136366 spearman=0.001133 (groups=34, skipped=318)
2025-12-24 09:15:10 INFO Epoch 027 | train_mse=0.118447 | val_loss=0.134728 | best_val_loss=0.068494
2025-12-24 09:15:19 INFO Epoch 028 | 25% complete (batch 46/181)
2025-12-24 09:15:20 INFO Epoch 028 | 50% complete (batch 91/181)
2025-12-24 09:15:20 INFO Epoch 028 | 75% complete (batch 136/181)
2025-12-24 09:15:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.107864
2025-12-24 09:15:34 INFO Tuning ranking metrics: regret=0.139644 spearman=-0.010186 (groups=34, skipped=318)
2025-12-24 09:15:34 INFO Epoch 028 | train_mse=0.116551 | val_loss=0.134690 | best_val_loss=0.068494
2025-12-24 09:15:42 INFO Epoch 029 | 25% complete (batch 46/181)
2025-12-24 09:15:43 INFO Epoch 029 | 50% complete (batch 91/181)
2025-12-24 09:15:44 INFO Epoch 029 | 75% complete (batch 136/181)
2025-12-24 09:15:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.147816
2025-12-24 09:15:57 INFO Tuning ranking metrics: regret=0.139505 spearman=-0.009486 (groups=34, skipped=318)
2025-12-24 09:15:57 INFO Epoch 029 | train_mse=0.121215 | val_loss=0.134664 | best_val_loss=0.068494
2025-12-24 09:16:06 INFO Epoch 030 | 25% complete (batch 46/181)
2025-12-24 09:16:07 INFO Epoch 030 | 50% complete (batch 91/181)
2025-12-24 09:16:07 INFO Epoch 030 | 75% complete (batch 136/181)
2025-12-24 09:16:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.158889
2025-12-24 09:16:21 INFO Tuning ranking metrics: regret=0.139505 spearman=-0.002712 (groups=34, skipped=318)
2025-12-24 09:16:21 INFO Epoch 030 | train_mse=0.117785 | val_loss=0.134625 | best_val_loss=0.068494
2025-12-24 09:16:29 INFO Epoch 031 | 25% complete (batch 46/181)
2025-12-24 09:16:30 INFO Epoch 031 | 50% complete (batch 91/181)
2025-12-24 09:16:31 INFO Epoch 031 | 75% complete (batch 136/181)
2025-12-24 09:16:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.128420
2025-12-24 09:16:44 INFO Tuning ranking metrics: regret=0.165975 spearman=-0.077242 (groups=34, skipped=318)
2025-12-24 09:16:44 INFO Epoch 031 | train_mse=0.129149 | val_loss=0.134678 | best_val_loss=0.068494
2025-12-24 09:16:53 INFO Epoch 032 | 25% complete (batch 46/181)
2025-12-24 09:16:54 INFO Epoch 032 | 50% complete (batch 91/181)
2025-12-24 09:16:55 INFO Epoch 032 | 75% complete (batch 136/181)
2025-12-24 09:17:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.212143
2025-12-24 09:17:08 INFO Tuning ranking metrics: regret=0.160647 spearman=-0.085000 (groups=34, skipped=318)
2025-12-24 09:17:08 INFO Epoch 032 | train_mse=0.123156 | val_loss=0.134602 | best_val_loss=0.068494
2025-12-24 09:17:16 INFO Epoch 033 | 25% complete (batch 46/181)
2025-12-24 09:17:17 INFO Epoch 033 | 50% complete (batch 91/181)
2025-12-24 09:17:18 INFO Epoch 033 | 75% complete (batch 136/181)
2025-12-24 09:17:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.208852
2025-12-24 09:17:31 INFO Tuning ranking metrics: regret=0.159744 spearman=-0.085536 (groups=34, skipped=318)
2025-12-24 09:17:31 INFO Epoch 033 | train_mse=0.133549 | val_loss=0.134564 | best_val_loss=0.068494
2025-12-24 09:17:39 INFO Epoch 034 | 25% complete (batch 46/181)
2025-12-24 09:17:40 INFO Epoch 034 | 50% complete (batch 91/181)
2025-12-24 09:17:41 INFO Epoch 034 | 75% complete (batch 136/181)
2025-12-24 09:17:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.204440
2025-12-24 09:17:54 INFO Tuning ranking metrics: regret=0.139636 spearman=-0.084346 (groups=34, skipped=318)
2025-12-24 09:17:54 INFO Epoch 034 | train_mse=0.133736 | val_loss=0.134552 | best_val_loss=0.068494
2025-12-24 09:18:03 INFO Epoch 035 | 25% complete (batch 46/181)
2025-12-24 09:18:04 INFO Epoch 035 | 50% complete (batch 91/181)
2025-12-24 09:18:05 INFO Epoch 035 | 75% complete (batch 136/181)
2025-12-24 09:18:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.199004
2025-12-24 09:18:18 INFO Tuning ranking metrics: regret=0.139606 spearman=-0.019729 (groups=34, skipped=318)
2025-12-24 09:18:18 INFO Epoch 035 | train_mse=0.132065 | val_loss=0.134539 | best_val_loss=0.068494
2025-12-24 09:18:26 INFO Epoch 036 | 25% complete (batch 46/181)
2025-12-24 09:18:27 INFO Epoch 036 | 50% complete (batch 91/181)
2025-12-24 09:18:28 INFO Epoch 036 | 75% complete (batch 136/181)
2025-12-24 09:18:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.167786
2025-12-24 09:18:42 INFO Tuning ranking metrics: regret=0.139606 spearman=-0.019729 (groups=34, skipped=318)
2025-12-24 09:18:42 INFO Epoch 036 | train_mse=0.119324 | val_loss=0.134535 | best_val_loss=0.068494
2025-12-24 09:18:50 INFO Epoch 037 | 25% complete (batch 46/181)
2025-12-24 09:18:51 INFO Epoch 037 | 50% complete (batch 91/181)
2025-12-24 09:18:52 INFO Epoch 037 | 75% complete (batch 136/181)
2025-12-24 09:19:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.190210
2025-12-24 09:19:06 INFO Tuning ranking metrics: regret=0.139636 spearman=-0.078062 (groups=34, skipped=318)
2025-12-24 09:19:06 INFO Epoch 037 | train_mse=0.124687 | val_loss=0.134538 | best_val_loss=0.068494
2025-12-24 09:19:14 INFO Epoch 038 | 25% complete (batch 46/181)
2025-12-24 09:19:15 INFO Epoch 038 | 50% complete (batch 91/181)
2025-12-24 09:19:16 INFO Epoch 038 | 75% complete (batch 136/181)
2025-12-24 09:19:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.198195
2025-12-24 09:19:29 INFO Tuning ranking metrics: regret=0.139636 spearman=-0.078062 (groups=34, skipped=318)
2025-12-24 09:19:29 INFO Epoch 038 | train_mse=0.136585 | val_loss=0.134529 | best_val_loss=0.068494
2025-12-24 09:19:38 INFO Epoch 039 | 25% complete (batch 46/181)
2025-12-24 09:19:39 INFO Epoch 039 | 50% complete (batch 91/181)
2025-12-24 09:19:40 INFO Epoch 039 | 75% complete (batch 136/181)
2025-12-24 09:19:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.198170
2025-12-24 09:19:53 INFO Tuning ranking metrics: regret=0.139636 spearman=-0.078062 (groups=34, skipped=318)
2025-12-24 09:19:53 INFO Epoch 039 | train_mse=0.149149 | val_loss=0.134520 | best_val_loss=0.068494
2025-12-24 09:20:01 INFO Epoch 040 | 25% complete (batch 46/181)
2025-12-24 09:20:03 INFO Epoch 040 | 50% complete (batch 91/181)
2025-12-24 09:20:04 INFO Epoch 040 | 75% complete (batch 136/181)
2025-12-24 09:20:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.194202
2025-12-24 09:20:17 INFO Tuning ranking metrics: regret=0.139636 spearman=-0.078062 (groups=34, skipped=318)
2025-12-24 09:20:17 INFO Epoch 040 | train_mse=0.128835 | val_loss=0.134519 | best_val_loss=0.068494
2025-12-24 09:20:25 INFO Epoch 041 | 25% complete (batch 46/181)
2025-12-24 09:20:26 INFO Epoch 041 | 50% complete (batch 91/181)
2025-12-24 09:20:27 INFO Epoch 041 | 75% complete (batch 136/181)
2025-12-24 09:20:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.198897
2025-12-24 09:20:40 INFO Tuning ranking metrics: regret=0.139636 spearman=-0.078062 (groups=34, skipped=318)
2025-12-24 09:20:40 INFO Epoch 041 | train_mse=0.127654 | val_loss=0.134515 | best_val_loss=0.068494
Monitored metric tuning_rank_spearman did not improve in the last 24 records. Best score: 0.068. Signaling Trainer to stop.
2025-12-24 09:20:41 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.03899_val-0.14015_epoch009.chkpt, checkpoint.tuning_rank_spearman-0.06705_val-0.13518_epoch016.chkpt, checkpoint.tuning_rank_spearman-0.06849_val-0.13534_epoch017.chkpt
2025-12-24 09:20:41 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53/model_checkpoints/checkpoint.tuning_rank_spearman-0.06849_val-0.13534_epoch017.chkpt
2025-12-24 09:20:41 INFO Best validation loss: tensor(0.0685)
2025-12-24 09:20:41 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53/model_checkpoints/checkpoint.tuning_rank_spearman-0.06849_val-0.13534_epoch017.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53/model_checkpoints/checkpoint.tuning_rank_spearman-0.06849_val-0.13534_epoch017.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-24 09:20:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.135339
2025-12-24 09:20:53 INFO Tuning ranking metrics: regret=0.132846 spearman=0.068494 (groups=34, skipped=318)
2025-12-24 09:20:53 INFO Epoch 042 | val_loss=0.135339 | best_val_loss=0.068494
2025-12-24 09:20:54 INFO Validation metrics: [{'val_loss': 0.13533921539783478, 'tuning_rank_regret': 0.13284562528133392, 'tuning_rank_spearman': 0.06849376112222672, 'val_pearson_corr': 0.228988379240036, 'val_spearman_corr': 0.12825822830200195, 'val_rank_regret': 0.2317657321691513, 'val_rank_spearman': -0.3333333432674408}]
2025-12-24 09:20:54 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.06849_val-0.13534_epoch017.chkpt
2025-12-24 09:20:54 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.03899_val-0.14015_epoch009.chkpt
2025-12-24 09:20:54 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.06705_val-0.13518_epoch016.chkpt
2025-12-24 09:20:54 INFO Renamed checkpoint file: alt_val.val-0.13442_epoch011.ckpt -> alt_val.val-0.13442_epoch011.chkpt
2025-12-24 09:20:54 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.13442_epoch011.chkpt
2025-12-24 09:20:54 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.13284562528133392
  tuning_rank_spearman      0.06849376112222672
        val_loss            0.13533921539783478
    val_pearson_corr         0.228988379240036
     val_rank_regret        0.2317657321691513
    val_rank_spearman       -0.3333333432674408
    val_spearman_corr       0.12825822830200195
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run sched_boost_lean_seed222_2025-12-24_09-03-53 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53
[train_cli][batch] job 'sched_boost_lean_seed222' finished.
[train_cli][batch] (2/3) running job 'sched_boost_lr035_lean_seed222' -> run_name=sched_boost_lr035_lean_seed222_2025-12-24_09-20-56
[train_cli] run_id=sched_boost_lr035_lean_seed222_2025-12-24_09-20-56 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-24_09-20-56/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-24_09-20-56 --git-commit 94c0e71caa --git-dirty
2025-12-24 09:20:59 INFO git_commit = 94c0e71caa (dirty)
2025-12-24 09:20:59 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-24 09:20:59 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-24_09-20-56/config/config.yaml
2025-12-24 09:20:59 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data
2025-12-24 09:20:59 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-24 09:20:59 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-24 09:20:59 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-24_09-20-56
2025-12-24 09:20:59 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-24 09:20:59 INFO   metadata_path = None
2025-12-24 09:20:59 INFO   summary_path = None
2025-12-24 09:20:59 INFO   accelerator = cpu
2025-12-24 09:20:59 INFO   devices = 1
2025-12-24 09:20:59 INFO   attention_head = 8
2025-12-24 09:20:59 INFO   pooling_type = mean
2025-12-24 09:20:59 INFO   model_self_loops = False
2025-12-24 09:20:59 INFO   model_self_loop_fill = mean
2025-12-24 09:20:59 INFO   model_residual = False
2025-12-24 09:20:59 INFO   batch_size = 48
2025-12-24 09:20:59 INFO   learning_rate = 0.0035
2025-12-24 09:20:59 INFO   num_epochs = 140
2025-12-24 09:20:59 INFO   accumulate_grad_batches = 8
2025-12-24 09:20:59 INFO   seed = 222
2025-12-24 09:20:59 INFO   num_workers = 2
2025-12-24 09:20:59 INFO   precision = 32
2025-12-24 09:20:59 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-24 09:20:59 INFO   early_stopping_patience = 24
2025-12-24 09:20:59 INFO   lr_scheduler_patience = 6
2025-12-24 09:20:59 INFO   lr_scheduler_factor = 0.2
2025-12-24 09:20:59 INFO   fast_dev_run = False
2025-12-24 09:20:59 INFO   limit_train_batches = None
2025-12-24 09:20:59 INFO   limit_val_batches = None
2025-12-24 09:20:59 INFO   log_lr = False
2025-12-24 09:20:59 INFO   progress_bar_refresh_rate = 0
2025-12-24 09:20:59 INFO   log_every_n_steps = 100
2025-12-24 09:20:59 INFO   use_val_spearman_as_secondary = True
2025-12-24 09:20:59 INFO   spearman_secondary_min_delta = 0.0
2025-12-24 09:20:59 INFO   spearman_secondary_weight = 1.0
2025-12-24 09:20:59 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-24 09:20:59 INFO   tuning_max_samples = 500
2025-12-24 09:20:59 INFO   tuning_fraction = None
2025-12-24 09:20:59 INFO   tuning_eval_every = 1
2025-12-24 09:20:59 INFO   rank_loss_weight = 0.0
2025-12-24 09:20:59 INFO   rank_loss_margin = 0.0
2025-12-24 09:20:59 INFO   rank_loss_mode = hinge
2025-12-24 09:20:59 INFO   rank_loss_grouped = True
2025-12-24 09:20:59 INFO   variance_reduction_enabled = False
2025-12-24 09:20:59 INFO   variance_reduction_method = topk_avg
2025-12-24 09:20:59 INFO   variance_reduction_top_k = 3
2025-12-24 09:20:59 INFO   coverage_minimum = 0.0
2025-12-24 09:20:59 INFO   coverage_fail_on_missing = False
2025-12-24 09:20:59 INFO   graph_load_profiling = False
2025-12-24 09:20:59 INFO   graph_load_top_k = 5
2025-12-24 09:20:59 INFO   enable_graph_cache = True
2025-12-24 09:20:59 INFO   graph_cache_size = 256
2025-12-24 09:20:59 INFO   canonicalize_on_load = False
2025-12-24 09:20:59 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-24 09:20:59 INFO   edge_schema = {}
2025-12-24 09:20:59 INFO   topology_schema = {}
Seed set to 222
2025-12-24 09:21:00 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-24 09:21:00 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 09:21:00 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-24 09:21:00 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 09:21:00 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-24 09:21:00 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 09:21:02 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-24 09:21:02 INFO Tuning group stats: groups=352 groups>=2=34 singletons=318 max_group=11
2025-12-24 09:21:02 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-24_09-20-56/dataset_coverage.json
2025-12-24 09:21:02 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-24_09-20-56/dataset_coverage.json for details.
2025-12-24 09:21:02 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-24_09-20-56/dataset_coverage.json for details.
2025-12-24 09:21:02 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-24_09-20-56/dataset_coverage.json for details.
2025-12-24 09:21:02 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-24_09-20-56/schema_summary.json
2025-12-24 09:21:02 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-24_09-20-56/feature_metadata.json
2025-12-24 09:21:02 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-24 09:21:02 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/advanced_k_partite_v2/feature-config.yaml.advanced_lean.10A.v2, sha256=2022a36e7b21668173af3af66c25cf6b6a0494e642c0934eac38abbcfeebec3d
2025-12-24 09:21:02 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/work/edge_features)
2025-12-24 09:21:02 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json
2025-12-24 09:21:02 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-24_09-20-56/schema_summary.json
2025-12-24 09:21:02 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-24 09:21:02 INFO Topology: topology/persistence_k_partite_advanced/v2 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 628-dimensional node features.
2025-12-24 09:21:02 INFO Node: node/dssp_topo_merge_passthrough/v1; metadata lists 628 feature columns matching the .pt tensor.
2025-12-24 09:21:02 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-24 09:21:02 INFO → Total feature dimensionality observed and confirmed: node_dim = 628, edge_dim = 11.
2025-12-24 09:21:02 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-24 09:21:02 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 628,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge_passthrough/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 628,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-24_09-20-56/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge_passthrough/v1",
      "alias": "Passthrough (all dims from topology module) = Node Dynamic Dims",
      "jobs": 16,
      "summary": "DSSP/basic features merged with all topology columns (passthrough)."
    },
    "topology": {
      "id": "topology/persistence_k_partite_advanced/v2",
      "alias": "Advanced k-partite PH (v2 lean) topo_dim 596",
      "jobs": 16,
      "summary": "Fixed-width k-partite persistent homology with slot padding + missingness channels."
    }
  },
  "notes": []
}
2025-12-24 09:21:02 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-24 09:21:02 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=6a778bc189574545bc858012d21ab62d)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-24 09:21:02 INFO Starting training (fast_dev_run=False)
2025-12-24 09:21:02 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-24_09-20-56/model_checkpoints exists and is not empty.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 20.1 K | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
180 K     Trainable params
0         Non-trainable params
180 K     Total params
0.721     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-24 09:21:16 INFO Epoch 000 | 25% complete (batch 46/181)
2025-12-24 09:21:17 INFO Epoch 000 | 50% complete (batch 91/181)
2025-12-24 09:21:18 INFO Epoch 000 | 75% complete (batch 136/181)
2025-12-24 09:21:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.140593
2025-12-24 09:21:31 INFO Tuning ranking metrics: regret=0.156244 spearman=-0.166896 (groups=34, skipped=318)
2025-12-24 09:21:31 INFO Epoch 000 | val_loss=0.140593
Metric tuning_rank_spearman improved. New best score: -0.167
2025-12-24 09:21:39 INFO Epoch 001 | 25% complete (batch 46/181)
2025-12-24 09:21:40 INFO Epoch 001 | 50% complete (batch 91/181)
2025-12-24 09:21:41 INFO Epoch 001 | 75% complete (batch 136/181)
2025-12-24 09:21:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.027111
2025-12-24 09:21:54 INFO Tuning ranking metrics: regret=0.152860 spearman=-0.172148 (groups=34, skipped=318)
2025-12-24 09:21:54 INFO Epoch 001 | train_mse=0.154996 | val_loss=0.140560 | best_val_loss=-0.166896
2025-12-24 09:22:02 INFO Epoch 002 | 25% complete (batch 46/181)
2025-12-24 09:22:03 INFO Epoch 002 | 50% complete (batch 91/181)
2025-12-24 09:22:04 INFO Epoch 002 | 75% complete (batch 136/181)
2025-12-24 09:22:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.027638
2025-12-24 09:22:17 INFO Tuning ranking metrics: regret=0.150879 spearman=-0.108314 (groups=34, skipped=318)
2025-12-24 09:22:17 INFO Epoch 002 | train_mse=0.151999 | val_loss=0.140455 | best_val_loss=-0.166896
Metric tuning_rank_spearman improved by 0.059 >= min_delta = 0.0. New best score: -0.108
2025-12-24 09:22:26 INFO Epoch 003 | 25% complete (batch 46/181)
2025-12-24 09:22:27 INFO Epoch 003 | 50% complete (batch 91/181)
2025-12-24 09:22:28 INFO Epoch 003 | 75% complete (batch 136/181)
2025-12-24 09:22:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.362181
2025-12-24 09:22:41 INFO Tuning ranking metrics: regret=0.128646 spearman=0.073370 (groups=34, skipped=318)
2025-12-24 09:22:41 INFO Epoch 003 | train_mse=0.137152 | val_loss=0.140522 | best_val_loss=-0.108314
Metric tuning_rank_spearman improved by 0.182 >= min_delta = 0.0. New best score: 0.073
2025-12-24 09:22:49 INFO Epoch 004 | 25% complete (batch 46/181)
2025-12-24 09:22:50 INFO Epoch 004 | 50% complete (batch 91/181)
2025-12-24 09:22:51 INFO Epoch 004 | 75% complete (batch 136/181)
2025-12-24 09:22:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.306150
2025-12-24 09:23:04 INFO Tuning ranking metrics: regret=0.114937 spearman=-0.013948 (groups=34, skipped=318)
2025-12-24 09:23:04 INFO Epoch 004 | train_mse=0.139595 | val_loss=0.140567 | best_val_loss=0.073370
2025-12-24 09:23:12 INFO Epoch 005 | 25% complete (batch 46/181)
2025-12-24 09:23:13 INFO Epoch 005 | 50% complete (batch 91/181)
2025-12-24 09:23:14 INFO Epoch 005 | 75% complete (batch 136/181)
2025-12-24 09:23:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.230432
2025-12-24 09:23:28 INFO Tuning ranking metrics: regret=0.147527 spearman=-0.154851 (groups=34, skipped=318)
2025-12-24 09:23:28 INFO Epoch 005 | train_mse=0.152600 | val_loss=0.139876 | best_val_loss=0.073370
2025-12-24 09:23:36 INFO Epoch 006 | 25% complete (batch 46/181)
2025-12-24 09:23:37 INFO Epoch 006 | 50% complete (batch 91/181)
2025-12-24 09:23:38 INFO Epoch 006 | 75% complete (batch 136/181)
2025-12-24 09:23:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.348389
2025-12-24 09:23:51 INFO Tuning ranking metrics: regret=0.131105 spearman=0.043360 (groups=34, skipped=318)
2025-12-24 09:23:51 INFO Epoch 006 | train_mse=0.141426 | val_loss=0.141906 | best_val_loss=0.073370
2025-12-24 09:23:59 INFO Epoch 007 | 25% complete (batch 46/181)
2025-12-24 09:24:00 INFO Epoch 007 | 50% complete (batch 91/181)
2025-12-24 09:24:01 INFO Epoch 007 | 75% complete (batch 136/181)
2025-12-24 09:24:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.409683
2025-12-24 09:24:15 INFO Tuning ranking metrics: regret=0.120254 spearman=0.000898 (groups=34, skipped=318)
2025-12-24 09:24:15 INFO Epoch 007 | train_mse=0.133861 | val_loss=0.143390 | best_val_loss=0.073370
2025-12-24 09:24:23 INFO Epoch 008 | 25% complete (batch 46/181)
2025-12-24 09:24:24 INFO Epoch 008 | 50% complete (batch 91/181)
2025-12-24 09:24:24 INFO Epoch 008 | 75% complete (batch 136/181)
2025-12-24 09:24:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.342934
2025-12-24 09:24:38 INFO Tuning ranking metrics: regret=0.135294 spearman=-0.074879 (groups=34, skipped=318)
2025-12-24 09:24:38 INFO Epoch 008 | train_mse=0.160573 | val_loss=0.141174 | best_val_loss=0.073370
2025-12-24 09:24:46 INFO Epoch 009 | 25% complete (batch 46/181)
2025-12-24 09:24:47 INFO Epoch 009 | 50% complete (batch 91/181)
2025-12-24 09:24:48 INFO Epoch 009 | 75% complete (batch 136/181)
2025-12-24 09:24:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.340067
2025-12-24 09:25:01 INFO Tuning ranking metrics: regret=0.135779 spearman=-0.268074 (groups=34, skipped=318)
2025-12-24 09:25:01 INFO Epoch 009 | train_mse=0.149922 | val_loss=0.140206 | best_val_loss=0.073370
2025-12-24 09:25:09 INFO Epoch 010 | 25% complete (batch 46/181)
2025-12-24 09:25:10 INFO Epoch 010 | 50% complete (batch 91/181)
2025-12-24 09:25:11 INFO Epoch 010 | 75% complete (batch 136/181)
2025-12-24 09:25:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.247422
2025-12-24 09:25:24 INFO Tuning ranking metrics: regret=0.147167 spearman=-0.109855 (groups=34, skipped=318)
2025-12-24 09:25:24 INFO Epoch 010 | train_mse=0.159650 | val_loss=0.131840 | best_val_loss=0.073370
2025-12-24 09:25:33 INFO Epoch 011 | 25% complete (batch 46/181)
2025-12-24 09:25:34 INFO Epoch 011 | 50% complete (batch 91/181)
2025-12-24 09:25:35 INFO Epoch 011 | 75% complete (batch 136/181)
2025-12-24 09:25:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.426354
2025-12-24 09:25:48 INFO Tuning ranking metrics: regret=0.134328 spearman=-0.024975 (groups=34, skipped=318)
2025-12-24 09:25:48 INFO Epoch 011 | train_mse=0.147989 | val_loss=0.145767 | best_val_loss=0.073370
2025-12-24 09:25:56 INFO Epoch 012 | 25% complete (batch 46/181)
2025-12-24 09:25:57 INFO Epoch 012 | 50% complete (batch 91/181)
2025-12-24 09:25:58 INFO Epoch 012 | 75% complete (batch 136/181)
2025-12-24 09:26:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.420845
2025-12-24 09:26:11 INFO Tuning ranking metrics: regret=0.105430 spearman=-0.012223 (groups=34, skipped=318)
2025-12-24 09:26:11 INFO Epoch 012 | train_mse=0.138478 | val_loss=0.135632 | best_val_loss=0.073370
2025-12-24 09:26:20 INFO Epoch 013 | 25% complete (batch 46/181)
2025-12-24 09:26:21 INFO Epoch 013 | 50% complete (batch 91/181)
2025-12-24 09:26:22 INFO Epoch 013 | 75% complete (batch 136/181)
2025-12-24 09:26:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.381519
2025-12-24 09:26:35 INFO Tuning ranking metrics: regret=0.120703 spearman=-0.089177 (groups=34, skipped=318)
2025-12-24 09:26:35 INFO Epoch 013 | train_mse=0.146888 | val_loss=0.093435 | best_val_loss=0.073370
2025-12-24 09:26:43 INFO Epoch 014 | 25% complete (batch 46/181)
2025-12-24 09:26:44 INFO Epoch 014 | 50% complete (batch 91/181)
2025-12-24 09:26:45 INFO Epoch 014 | 75% complete (batch 136/181)
2025-12-24 09:26:53 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.488530
2025-12-24 09:26:58 INFO Tuning ranking metrics: regret=0.110421 spearman=-0.104851 (groups=34, skipped=318)
2025-12-24 09:26:58 INFO Epoch 014 | train_mse=0.123160 | val_loss=0.108977 | best_val_loss=0.073370
2025-12-24 09:27:06 INFO Epoch 015 | 25% complete (batch 46/181)
2025-12-24 09:27:07 INFO Epoch 015 | 50% complete (batch 91/181)
2025-12-24 09:27:08 INFO Epoch 015 | 75% complete (batch 136/181)
2025-12-24 09:27:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.511179
2025-12-24 09:27:22 INFO Tuning ranking metrics: regret=0.127775 spearman=-0.081678 (groups=34, skipped=318)
2025-12-24 09:27:22 INFO Epoch 015 | train_mse=0.139138 | val_loss=0.149843 | best_val_loss=0.073370
2025-12-24 09:27:30 INFO Epoch 016 | 25% complete (batch 46/181)
2025-12-24 09:27:31 INFO Epoch 016 | 50% complete (batch 91/181)
2025-12-24 09:27:32 INFO Epoch 016 | 75% complete (batch 136/181)
2025-12-24 09:27:40 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.521675
2025-12-24 09:27:45 INFO Tuning ranking metrics: regret=0.127547 spearman=-0.059460 (groups=34, skipped=318)
2025-12-24 09:27:45 INFO Epoch 016 | train_mse=0.138571 | val_loss=0.140554 | best_val_loss=0.073370
2025-12-24 09:27:54 INFO Epoch 017 | 25% complete (batch 46/181)
2025-12-24 09:27:55 INFO Epoch 017 | 50% complete (batch 91/181)
2025-12-24 09:27:56 INFO Epoch 017 | 75% complete (batch 136/181)
2025-12-24 09:28:04 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.520345
2025-12-24 09:28:09 INFO Tuning ranking metrics: regret=0.122710 spearman=-0.045009 (groups=34, skipped=318)
2025-12-24 09:28:09 INFO Epoch 017 | train_mse=0.145359 | val_loss=0.134406 | best_val_loss=0.073370
2025-12-24 09:28:17 INFO Epoch 018 | 25% complete (batch 46/181)
2025-12-24 09:28:18 INFO Epoch 018 | 50% complete (batch 91/181)
2025-12-24 09:28:19 INFO Epoch 018 | 75% complete (batch 136/181)
2025-12-24 09:28:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.541306
2025-12-24 09:28:32 INFO Tuning ranking metrics: regret=0.122925 spearman=-0.052457 (groups=34, skipped=318)
2025-12-24 09:28:32 INFO Epoch 018 | train_mse=0.145219 | val_loss=0.114333 | best_val_loss=0.073370
2025-12-24 09:28:41 INFO Epoch 019 | 25% complete (batch 46/181)
2025-12-24 09:28:42 INFO Epoch 019 | 50% complete (batch 91/181)
2025-12-24 09:28:43 INFO Epoch 019 | 75% complete (batch 136/181)
2025-12-24 09:28:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.587143
2025-12-24 09:28:57 INFO Tuning ranking metrics: regret=0.123006 spearman=-0.047511 (groups=34, skipped=318)
2025-12-24 09:28:57 INFO Epoch 019 | train_mse=0.125596 | val_loss=0.097655 | best_val_loss=0.073370
2025-12-24 09:29:05 INFO Epoch 020 | 25% complete (batch 46/181)
2025-12-24 09:29:06 INFO Epoch 020 | 50% complete (batch 91/181)
2025-12-24 09:29:07 INFO Epoch 020 | 75% complete (batch 136/181)
2025-12-24 09:29:15 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.596770
2025-12-24 09:29:20 INFO Tuning ranking metrics: regret=0.105402 spearman=0.066660 (groups=34, skipped=318)
2025-12-24 09:29:20 INFO Epoch 020 | train_mse=0.118186 | val_loss=0.101039 | best_val_loss=0.073370
2025-12-24 09:29:28 INFO Epoch 021 | 25% complete (batch 46/181)
2025-12-24 09:29:29 INFO Epoch 021 | 50% complete (batch 91/181)
2025-12-24 09:29:30 INFO Epoch 021 | 75% complete (batch 136/181)
2025-12-24 09:29:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.581654
2025-12-24 09:29:44 INFO Tuning ranking metrics: regret=0.098828 spearman=0.072823 (groups=34, skipped=318)
2025-12-24 09:29:44 INFO Epoch 021 | train_mse=0.111554 | val_loss=0.090317 | best_val_loss=0.073370
2025-12-24 09:29:52 INFO Epoch 022 | 25% complete (batch 46/181)
2025-12-24 09:29:53 INFO Epoch 022 | 50% complete (batch 91/181)
2025-12-24 09:29:54 INFO Epoch 022 | 75% complete (batch 136/181)
2025-12-24 09:30:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.578418
2025-12-24 09:30:07 INFO Tuning ranking metrics: regret=0.097065 spearman=0.084963 (groups=34, skipped=318)
2025-12-24 09:30:07 INFO Epoch 022 | train_mse=0.098392 | val_loss=0.088221 | best_val_loss=0.073370
Metric tuning_rank_spearman improved by 0.012 >= min_delta = 0.0. New best score: 0.085
2025-12-24 09:30:15 INFO Epoch 023 | 25% complete (batch 46/181)
2025-12-24 09:30:16 INFO Epoch 023 | 50% complete (batch 91/181)
2025-12-24 09:30:17 INFO Epoch 023 | 75% complete (batch 136/181)
2025-12-24 09:30:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.602020
2025-12-24 09:30:31 INFO Tuning ranking metrics: regret=0.098828 spearman=0.073046 (groups=34, skipped=318)
2025-12-24 09:30:31 INFO Epoch 023 | train_mse=0.084640 | val_loss=0.072550 | best_val_loss=0.084963
2025-12-24 09:30:39 INFO Epoch 024 | 25% complete (batch 46/181)
2025-12-24 09:30:40 INFO Epoch 024 | 50% complete (batch 91/181)
2025-12-24 09:30:41 INFO Epoch 024 | 75% complete (batch 136/181)
2025-12-24 09:30:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.610432
2025-12-24 09:30:54 INFO Tuning ranking metrics: regret=0.098828 spearman=0.072511 (groups=34, skipped=318)
2025-12-24 09:30:54 INFO Epoch 024 | train_mse=0.095853 | val_loss=0.072806 | best_val_loss=0.084963
2025-12-24 09:31:02 INFO Epoch 025 | 25% complete (batch 46/181)
2025-12-24 09:31:03 INFO Epoch 025 | 50% complete (batch 91/181)
2025-12-24 09:31:04 INFO Epoch 025 | 75% complete (batch 136/181)
2025-12-24 09:31:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.616127
2025-12-24 09:31:18 INFO Tuning ranking metrics: regret=0.098828 spearman=0.078622 (groups=34, skipped=318)
2025-12-24 09:31:18 INFO Epoch 025 | train_mse=0.078135 | val_loss=0.067984 | best_val_loss=0.084963
2025-12-24 09:31:26 INFO Epoch 026 | 25% complete (batch 46/181)
2025-12-24 09:31:27 INFO Epoch 026 | 50% complete (batch 91/181)
2025-12-24 09:31:28 INFO Epoch 026 | 75% complete (batch 136/181)
2025-12-24 09:31:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.628714
2025-12-24 09:31:41 INFO Tuning ranking metrics: regret=0.105402 spearman=0.074758 (groups=34, skipped=318)
2025-12-24 09:31:41 INFO Epoch 026 | train_mse=0.066754 | val_loss=0.067804 | best_val_loss=0.084963
2025-12-24 09:31:49 INFO Epoch 027 | 25% complete (batch 46/181)
2025-12-24 09:31:50 INFO Epoch 027 | 50% complete (batch 91/181)
2025-12-24 09:31:51 INFO Epoch 027 | 75% complete (batch 136/181)
2025-12-24 09:32:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.626160
2025-12-24 09:32:05 INFO Tuning ranking metrics: regret=0.105405 spearman=0.066578 (groups=34, skipped=318)
2025-12-24 09:32:05 INFO Epoch 027 | train_mse=0.088068 | val_loss=0.075104 | best_val_loss=0.084963
2025-12-24 09:32:13 INFO Epoch 028 | 25% complete (batch 46/181)
2025-12-24 09:32:14 INFO Epoch 028 | 50% complete (batch 91/181)
2025-12-24 09:32:15 INFO Epoch 028 | 75% complete (batch 136/181)
2025-12-24 09:32:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.632361
2025-12-24 09:32:28 INFO Tuning ranking metrics: regret=0.102130 spearman=0.073606 (groups=34, skipped=318)
2025-12-24 09:32:28 INFO Epoch 028 | train_mse=0.066880 | val_loss=0.069020 | best_val_loss=0.084963
2025-12-24 09:32:37 INFO Epoch 029 | 25% complete (batch 46/181)
2025-12-24 09:32:37 INFO Epoch 029 | 50% complete (batch 91/181)
2025-12-24 09:32:39 INFO Epoch 029 | 75% complete (batch 136/181)
2025-12-24 09:32:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.628700
2025-12-24 09:32:52 INFO Tuning ranking metrics: regret=0.102130 spearman=0.072543 (groups=34, skipped=318)
2025-12-24 09:32:52 INFO Epoch 029 | train_mse=0.077806 | val_loss=0.080494 | best_val_loss=0.084963
2025-12-24 09:33:00 INFO Epoch 030 | 25% complete (batch 46/181)
2025-12-24 09:33:01 INFO Epoch 030 | 50% complete (batch 91/181)
2025-12-24 09:33:02 INFO Epoch 030 | 75% complete (batch 136/181)
2025-12-24 09:33:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.635920
2025-12-24 09:33:16 INFO Tuning ranking metrics: regret=0.102135 spearman=0.053966 (groups=34, skipped=318)
2025-12-24 09:33:16 INFO Epoch 030 | train_mse=0.062877 | val_loss=0.066383 | best_val_loss=0.084963
2025-12-24 09:33:24 INFO Epoch 031 | 25% complete (batch 46/181)
2025-12-24 09:33:25 INFO Epoch 031 | 50% complete (batch 91/181)
2025-12-24 09:33:26 INFO Epoch 031 | 75% complete (batch 136/181)
2025-12-24 09:33:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.640881
2025-12-24 09:33:39 INFO Tuning ranking metrics: regret=0.105531 spearman=0.062134 (groups=34, skipped=318)
2025-12-24 09:33:39 INFO Epoch 031 | train_mse=0.085192 | val_loss=0.066569 | best_val_loss=0.084963
2025-12-24 09:33:47 INFO Epoch 032 | 25% complete (batch 46/181)
2025-12-24 09:33:48 INFO Epoch 032 | 50% complete (batch 91/181)
2025-12-24 09:33:49 INFO Epoch 032 | 75% complete (batch 136/181)
2025-12-24 09:33:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.643166
2025-12-24 09:34:03 INFO Tuning ranking metrics: regret=0.102943 spearman=0.090852 (groups=34, skipped=318)
2025-12-24 09:34:03 INFO Epoch 032 | train_mse=0.078114 | val_loss=0.069298 | best_val_loss=0.084963
Metric tuning_rank_spearman improved by 0.006 >= min_delta = 0.0. New best score: 0.091
2025-12-24 09:34:11 INFO Epoch 033 | 25% complete (batch 46/181)
2025-12-24 09:34:12 INFO Epoch 033 | 50% complete (batch 91/181)
2025-12-24 09:34:12 INFO Epoch 033 | 75% complete (batch 136/181)
2025-12-24 09:34:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.650009
2025-12-24 09:34:26 INFO Tuning ranking metrics: regret=0.104995 spearman=0.101375 (groups=34, skipped=318)
2025-12-24 09:34:26 INFO Epoch 033 | train_mse=0.079571 | val_loss=0.067569 | best_val_loss=0.090852
Metric tuning_rank_spearman improved by 0.011 >= min_delta = 0.0. New best score: 0.101
2025-12-24 09:34:34 INFO Epoch 034 | 25% complete (batch 46/181)
2025-12-24 09:34:35 INFO Epoch 034 | 50% complete (batch 91/181)
2025-12-24 09:34:36 INFO Epoch 034 | 75% complete (batch 136/181)
2025-12-24 09:34:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.663357
2025-12-24 09:34:49 INFO Tuning ranking metrics: regret=0.099561 spearman=0.135924 (groups=34, skipped=318)
2025-12-24 09:34:49 INFO Epoch 034 | train_mse=0.072385 | val_loss=0.062169 | best_val_loss=0.101375
Metric tuning_rank_spearman improved by 0.035 >= min_delta = 0.0. New best score: 0.136
2025-12-24 09:34:57 INFO Epoch 035 | 25% complete (batch 46/181)
2025-12-24 09:34:58 INFO Epoch 035 | 50% complete (batch 91/181)
2025-12-24 09:34:59 INFO Epoch 035 | 75% complete (batch 136/181)
2025-12-24 09:35:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.650411
2025-12-24 09:35:13 INFO Tuning ranking metrics: regret=0.102957 spearman=0.124643 (groups=34, skipped=318)
2025-12-24 09:35:13 INFO Epoch 035 | train_mse=0.077611 | val_loss=0.071728 | best_val_loss=0.135924
2025-12-24 09:35:21 INFO Epoch 036 | 25% complete (batch 46/181)
2025-12-24 09:35:22 INFO Epoch 036 | 50% complete (batch 91/181)
2025-12-24 09:35:22 INFO Epoch 036 | 75% complete (batch 136/181)
2025-12-24 09:35:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.653031
2025-12-24 09:35:36 INFO Tuning ranking metrics: regret=0.103318 spearman=0.110078 (groups=34, skipped=318)
2025-12-24 09:35:36 INFO Epoch 036 | train_mse=0.059785 | val_loss=0.075177 | best_val_loss=0.135924
2025-12-24 09:35:45 INFO Epoch 037 | 25% complete (batch 46/181)
2025-12-24 09:35:46 INFO Epoch 037 | 50% complete (batch 91/181)
2025-12-24 09:35:47 INFO Epoch 037 | 75% complete (batch 136/181)
2025-12-24 09:35:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.667517
2025-12-24 09:36:00 INFO Tuning ranking metrics: regret=0.103042 spearman=0.109059 (groups=34, skipped=318)
2025-12-24 09:36:00 INFO Epoch 037 | train_mse=0.069657 | val_loss=0.064447 | best_val_loss=0.135924
2025-12-24 09:36:08 INFO Epoch 038 | 25% complete (batch 46/181)
2025-12-24 09:36:09 INFO Epoch 038 | 50% complete (batch 91/181)
2025-12-24 09:36:10 INFO Epoch 038 | 75% complete (batch 136/181)
2025-12-24 09:36:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.663940
2025-12-24 09:36:24 INFO Tuning ranking metrics: regret=0.105515 spearman=0.102642 (groups=34, skipped=318)
2025-12-24 09:36:24 INFO Epoch 038 | train_mse=0.075247 | val_loss=0.061217 | best_val_loss=0.135924
2025-12-24 09:36:32 INFO Epoch 039 | 25% complete (batch 46/181)
2025-12-24 09:36:33 INFO Epoch 039 | 50% complete (batch 91/181)
2025-12-24 09:36:34 INFO Epoch 039 | 75% complete (batch 136/181)
2025-12-24 09:36:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.641518
2025-12-24 09:36:47 INFO Tuning ranking metrics: regret=0.103443 spearman=0.038496 (groups=34, skipped=318)
2025-12-24 09:36:47 INFO Epoch 039 | train_mse=0.094759 | val_loss=0.092191 | best_val_loss=0.135924
2025-12-24 09:36:55 INFO Epoch 040 | 25% complete (batch 46/181)
2025-12-24 09:36:56 INFO Epoch 040 | 50% complete (batch 91/181)
2025-12-24 09:36:57 INFO Epoch 040 | 75% complete (batch 136/181)
2025-12-24 09:37:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.675036
2025-12-24 09:37:11 INFO Tuning ranking metrics: regret=0.103135 spearman=0.124281 (groups=34, skipped=318)
2025-12-24 09:37:11 INFO Epoch 040 | train_mse=0.081505 | val_loss=0.061288 | best_val_loss=0.135924
2025-12-24 09:37:19 INFO Epoch 041 | 25% complete (batch 46/181)
2025-12-24 09:37:20 INFO Epoch 041 | 50% complete (batch 91/181)
2025-12-24 09:37:21 INFO Epoch 041 | 75% complete (batch 136/181)
2025-12-24 09:37:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.683227
2025-12-24 09:37:34 INFO Tuning ranking metrics: regret=0.103164 spearman=0.067711 (groups=34, skipped=318)
2025-12-24 09:37:34 INFO Epoch 041 | train_mse=0.083955 | val_loss=0.059435 | best_val_loss=0.135924
2025-12-24 09:37:43 INFO Epoch 042 | 25% complete (batch 46/181)
2025-12-24 09:37:44 INFO Epoch 042 | 50% complete (batch 91/181)
2025-12-24 09:37:45 INFO Epoch 042 | 75% complete (batch 136/181)
2025-12-24 09:37:53 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.670655
2025-12-24 09:37:58 INFO Tuning ranking metrics: regret=0.103164 spearman=0.051305 (groups=34, skipped=318)
2025-12-24 09:37:58 INFO Epoch 042 | train_mse=0.068784 | val_loss=0.074103 | best_val_loss=0.135924
2025-12-24 09:38:06 INFO Epoch 043 | 25% complete (batch 46/181)
2025-12-24 09:38:07 INFO Epoch 043 | 50% complete (batch 91/181)
2025-12-24 09:38:08 INFO Epoch 043 | 75% complete (batch 136/181)
2025-12-24 09:38:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.685914
2025-12-24 09:38:21 INFO Tuning ranking metrics: regret=0.118176 spearman=0.117997 (groups=34, skipped=318)
2025-12-24 09:38:21 INFO Epoch 043 | train_mse=0.065713 | val_loss=0.059213 | best_val_loss=0.135924
2025-12-24 09:38:30 INFO Epoch 044 | 25% complete (batch 46/181)
2025-12-24 09:38:31 INFO Epoch 044 | 50% complete (batch 91/181)
2025-12-24 09:38:32 INFO Epoch 044 | 75% complete (batch 136/181)
2025-12-24 09:38:40 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.688795
2025-12-24 09:38:45 INFO Tuning ranking metrics: regret=0.119091 spearman=0.111415 (groups=34, skipped=318)
2025-12-24 09:38:45 INFO Epoch 044 | train_mse=0.076590 | val_loss=0.059182 | best_val_loss=0.135924
2025-12-24 09:38:53 INFO Epoch 045 | 25% complete (batch 46/181)
2025-12-24 09:38:54 INFO Epoch 045 | 50% complete (batch 91/181)
2025-12-24 09:38:55 INFO Epoch 045 | 75% complete (batch 136/181)
2025-12-24 09:39:04 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.681551
2025-12-24 09:39:09 INFO Tuning ranking metrics: regret=0.103443 spearman=0.035918 (groups=34, skipped=318)
2025-12-24 09:39:09 INFO Epoch 045 | train_mse=0.059136 | val_loss=0.069075 | best_val_loss=0.135924
2025-12-24 09:39:17 INFO Epoch 046 | 25% complete (batch 46/181)
2025-12-24 09:39:18 INFO Epoch 046 | 50% complete (batch 91/181)
2025-12-24 09:39:19 INFO Epoch 046 | 75% complete (batch 136/181)
2025-12-24 09:39:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.688800
2025-12-24 09:39:32 INFO Tuning ranking metrics: regret=0.103124 spearman=0.127165 (groups=34, skipped=318)
2025-12-24 09:39:32 INFO Epoch 046 | train_mse=0.065875 | val_loss=0.056846 | best_val_loss=0.135924
2025-12-24 09:39:40 INFO Epoch 047 | 25% complete (batch 46/181)
2025-12-24 09:39:41 INFO Epoch 047 | 50% complete (batch 91/181)
2025-12-24 09:39:43 INFO Epoch 047 | 75% complete (batch 136/181)
2025-12-24 09:39:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.689049
2025-12-24 09:39:56 INFO Tuning ranking metrics: regret=0.103154 spearman=0.050064 (groups=34, skipped=318)
2025-12-24 09:39:56 INFO Epoch 047 | train_mse=0.051427 | val_loss=0.060052 | best_val_loss=0.135924
2025-12-24 09:40:04 INFO Epoch 048 | 25% complete (batch 46/181)
2025-12-24 09:40:05 INFO Epoch 048 | 50% complete (batch 91/181)
2025-12-24 09:40:06 INFO Epoch 048 | 75% complete (batch 136/181)
2025-12-24 09:40:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.685713
2025-12-24 09:40:19 INFO Tuning ranking metrics: regret=0.096590 spearman=0.052878 (groups=34, skipped=318)
2025-12-24 09:40:19 INFO Epoch 048 | train_mse=0.065265 | val_loss=0.062231 | best_val_loss=0.135924
2025-12-24 09:40:27 INFO Epoch 049 | 25% complete (batch 46/181)
2025-12-24 09:40:28 INFO Epoch 049 | 50% complete (batch 91/181)
2025-12-24 09:40:29 INFO Epoch 049 | 75% complete (batch 136/181)
2025-12-24 09:40:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.692903
2025-12-24 09:40:43 INFO Tuning ranking metrics: regret=0.103135 spearman=0.110262 (groups=34, skipped=318)
2025-12-24 09:40:43 INFO Epoch 049 | train_mse=0.077648 | val_loss=0.056097 | best_val_loss=0.135924
2025-12-24 09:40:51 INFO Epoch 050 | 25% complete (batch 46/181)
2025-12-24 09:40:52 INFO Epoch 050 | 50% complete (batch 91/181)
2025-12-24 09:40:53 INFO Epoch 050 | 75% complete (batch 136/181)
2025-12-24 09:41:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.700741
2025-12-24 09:41:06 INFO Tuning ranking metrics: regret=0.119333 spearman=0.104889 (groups=34, skipped=318)
2025-12-24 09:41:06 INFO Epoch 050 | train_mse=0.082649 | val_loss=0.058907 | best_val_loss=0.135924
2025-12-24 09:41:14 INFO Epoch 051 | 25% complete (batch 46/181)
2025-12-24 09:41:15 INFO Epoch 051 | 50% complete (batch 91/181)
2025-12-24 09:41:16 INFO Epoch 051 | 75% complete (batch 136/181)
2025-12-24 09:41:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.704062
2025-12-24 09:41:30 INFO Tuning ranking metrics: regret=0.103755 spearman=0.100382 (groups=34, skipped=318)
2025-12-24 09:41:30 INFO Epoch 051 | train_mse=0.060189 | val_loss=0.056089 | best_val_loss=0.135924
2025-12-24 09:41:38 INFO Epoch 052 | 25% complete (batch 46/181)
2025-12-24 09:41:39 INFO Epoch 052 | 50% complete (batch 91/181)
2025-12-24 09:41:40 INFO Epoch 052 | 75% complete (batch 136/181)
2025-12-24 09:41:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.719514
2025-12-24 09:41:54 INFO Tuning ranking metrics: regret=0.119454 spearman=0.105730 (groups=34, skipped=318)
2025-12-24 09:41:54 INFO Epoch 052 | train_mse=0.070029 | val_loss=0.054167 | best_val_loss=0.135924
2025-12-24 09:42:02 INFO Epoch 053 | 25% complete (batch 46/181)
2025-12-24 09:42:03 INFO Epoch 053 | 50% complete (batch 91/181)
2025-12-24 09:42:04 INFO Epoch 053 | 75% complete (batch 136/181)
2025-12-24 09:42:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.722139
2025-12-24 09:42:17 INFO Tuning ranking metrics: regret=0.119454 spearman=0.096416 (groups=34, skipped=318)
2025-12-24 09:42:17 INFO Epoch 053 | train_mse=0.065586 | val_loss=0.055567 | best_val_loss=0.135924
2025-12-24 09:42:25 INFO Epoch 054 | 25% complete (batch 46/181)
2025-12-24 09:42:26 INFO Epoch 054 | 50% complete (batch 91/181)
2025-12-24 09:42:27 INFO Epoch 054 | 75% complete (batch 136/181)
2025-12-24 09:42:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.719910
2025-12-24 09:42:41 INFO Tuning ranking metrics: regret=0.118418 spearman=0.104291 (groups=34, skipped=318)
2025-12-24 09:42:41 INFO Epoch 054 | train_mse=0.059412 | val_loss=0.056522 | best_val_loss=0.135924
2025-12-24 09:42:49 INFO Epoch 055 | 25% complete (batch 46/181)
2025-12-24 09:42:50 INFO Epoch 055 | 50% complete (batch 91/181)
2025-12-24 09:42:51 INFO Epoch 055 | 75% complete (batch 136/181)
2025-12-24 09:42:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.711995
2025-12-24 09:43:04 INFO Tuning ranking metrics: regret=0.102718 spearman=0.119035 (groups=34, skipped=318)
2025-12-24 09:43:04 INFO Epoch 055 | train_mse=0.051803 | val_loss=0.057914 | best_val_loss=0.135924
2025-12-24 09:43:13 INFO Epoch 056 | 25% complete (batch 46/181)
2025-12-24 09:43:14 INFO Epoch 056 | 50% complete (batch 91/181)
2025-12-24 09:43:15 INFO Epoch 056 | 75% complete (batch 136/181)
2025-12-24 09:43:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.717855
2025-12-24 09:43:28 INFO Tuning ranking metrics: regret=0.102748 spearman=0.064617 (groups=34, skipped=318)
2025-12-24 09:43:28 INFO Epoch 056 | train_mse=0.062383 | val_loss=0.055173 | best_val_loss=0.135924
2025-12-24 09:43:36 INFO Epoch 057 | 25% complete (batch 46/181)
2025-12-24 09:43:37 INFO Epoch 057 | 50% complete (batch 91/181)
2025-12-24 09:43:38 INFO Epoch 057 | 75% complete (batch 136/181)
2025-12-24 09:43:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.716889
2025-12-24 09:43:51 INFO Tuning ranking metrics: regret=0.075004 spearman=0.066017 (groups=34, skipped=318)
2025-12-24 09:43:51 INFO Epoch 057 | train_mse=0.059755 | val_loss=0.054898 | best_val_loss=0.135924
2025-12-24 09:43:59 INFO Epoch 058 | 25% complete (batch 46/181)
2025-12-24 09:44:01 INFO Epoch 058 | 50% complete (batch 91/181)
2025-12-24 09:44:02 INFO Epoch 058 | 75% complete (batch 136/181)
2025-12-24 09:44:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.717035
2025-12-24 09:44:15 INFO Tuning ranking metrics: regret=0.075004 spearman=0.079348 (groups=34, skipped=318)
2025-12-24 09:44:15 INFO Epoch 058 | train_mse=0.065488 | val_loss=0.054064 | best_val_loss=0.135924
Monitored metric tuning_rank_spearman did not improve in the last 24 records. Best score: 0.136. Signaling Trainer to stop.
2025-12-24 09:44:16 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.12464_val-0.07173_epoch035.chkpt, checkpoint.tuning_rank_spearman-0.12716_val-0.05685_epoch046.chkpt, checkpoint.tuning_rank_spearman-0.13592_val-0.06217_epoch034.chkpt
2025-12-24 09:44:16 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-24_09-20-56/model_checkpoints/checkpoint.tuning_rank_spearman-0.13592_val-0.06217_epoch034.chkpt
2025-12-24 09:44:16 INFO Best validation loss: tensor(0.1359)
2025-12-24 09:44:16 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-24_09-20-56/model_checkpoints/checkpoint.tuning_rank_spearman-0.13592_val-0.06217_epoch034.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-24_09-20-56/model_checkpoints/checkpoint.tuning_rank_spearman-0.13592_val-0.06217_epoch034.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-24 09:44:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.062169
2025-12-24 09:44:28 INFO Tuning ranking metrics: regret=0.099561 spearman=0.135924 (groups=34, skipped=318)
2025-12-24 09:44:28 INFO Epoch 059 | val_loss=0.062169 | best_val_loss=0.135924
2025-12-24 09:44:29 INFO Validation metrics: [{'val_loss': 0.06216904893517494, 'tuning_rank_regret': 0.09956128895282745, 'tuning_rank_spearman': 0.13592436909675598, 'val_pearson_corr': 0.7473069429397583, 'val_spearman_corr': 0.7221388220787048, 'val_rank_regret': 0.0035356476437300444, 'val_rank_spearman': 0.6666666865348816}]
2025-12-24 09:44:29 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.13592_val-0.06217_epoch034.chkpt
2025-12-24 09:44:29 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.12464_val-0.07173_epoch035.chkpt
2025-12-24 09:44:29 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.12716_val-0.05685_epoch046.chkpt
2025-12-24 09:44:29 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.06638_epoch030.ckpt
2025-12-24 09:44:29 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.09956128895282745
  tuning_rank_spearman      0.13592436909675598
        val_loss            0.06216904893517494
    val_pearson_corr        0.7473069429397583
     val_rank_regret       0.0035356476437300444
    val_rank_spearman       0.6666666865348816
    val_spearman_corr       0.7221388220787048
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run sched_boost_lr035_lean_seed222_2025-12-24_09-20-56 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-24_09-20-56
[train_cli][batch] job 'sched_boost_lr035_lean_seed222' finished.
[train_cli][batch] (3/3) running job 'large_batch_sched_boost_lean_seed222' -> run_name=large_batch_sched_boost_lean_seed222_2025-12-24_09-44-32
[train_cli] run_id=large_batch_sched_boost_lean_seed222_2025-12-24_09-44-32 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-24_09-44-32/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-24_09-44-32 --git-commit 94c0e71caa --git-dirty
2025-12-24 09:44:35 INFO git_commit = 94c0e71caa (dirty)
2025-12-24 09:44:35 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-24 09:44:35 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-24_09-44-32/config/config.yaml
2025-12-24 09:44:35 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data
2025-12-24 09:44:35 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-24 09:44:35 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-24 09:44:35 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-24_09-44-32
2025-12-24 09:44:35 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-24 09:44:35 INFO   metadata_path = None
2025-12-24 09:44:35 INFO   summary_path = None
2025-12-24 09:44:35 INFO   accelerator = cpu
2025-12-24 09:44:35 INFO   devices = 1
2025-12-24 09:44:35 INFO   attention_head = 8
2025-12-24 09:44:35 INFO   pooling_type = mean
2025-12-24 09:44:35 INFO   model_self_loops = False
2025-12-24 09:44:35 INFO   model_self_loop_fill = mean
2025-12-24 09:44:35 INFO   model_residual = False
2025-12-24 09:44:35 INFO   batch_size = 48
2025-12-24 09:44:35 INFO   learning_rate = 0.004
2025-12-24 09:44:35 INFO   num_epochs = 120
2025-12-24 09:44:35 INFO   accumulate_grad_batches = 8
2025-12-24 09:44:35 INFO   seed = 222
2025-12-24 09:44:35 INFO   num_workers = 2
2025-12-24 09:44:35 INFO   precision = 32
2025-12-24 09:44:35 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-24 09:44:35 INFO   early_stopping_patience = 20
2025-12-24 09:44:35 INFO   lr_scheduler_patience = 5
2025-12-24 09:44:35 INFO   lr_scheduler_factor = 0.2
2025-12-24 09:44:35 INFO   fast_dev_run = False
2025-12-24 09:44:35 INFO   limit_train_batches = None
2025-12-24 09:44:35 INFO   limit_val_batches = None
2025-12-24 09:44:35 INFO   log_lr = False
2025-12-24 09:44:35 INFO   progress_bar_refresh_rate = 0
2025-12-24 09:44:35 INFO   log_every_n_steps = 100
2025-12-24 09:44:35 INFO   use_val_spearman_as_secondary = True
2025-12-24 09:44:35 INFO   spearman_secondary_min_delta = 0.0
2025-12-24 09:44:35 INFO   spearman_secondary_weight = 1.0
2025-12-24 09:44:35 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-24 09:44:35 INFO   tuning_max_samples = 500
2025-12-24 09:44:35 INFO   tuning_fraction = None
2025-12-24 09:44:35 INFO   tuning_eval_every = 1
2025-12-24 09:44:35 INFO   rank_loss_weight = 0.0
2025-12-24 09:44:35 INFO   rank_loss_margin = 0.0
2025-12-24 09:44:35 INFO   rank_loss_mode = hinge
2025-12-24 09:44:35 INFO   rank_loss_grouped = True
2025-12-24 09:44:35 INFO   variance_reduction_enabled = False
2025-12-24 09:44:35 INFO   variance_reduction_method = topk_avg
2025-12-24 09:44:35 INFO   variance_reduction_top_k = 3
2025-12-24 09:44:35 INFO   coverage_minimum = 0.0
2025-12-24 09:44:35 INFO   coverage_fail_on_missing = False
2025-12-24 09:44:35 INFO   graph_load_profiling = False
2025-12-24 09:44:35 INFO   graph_load_top_k = 5
2025-12-24 09:44:35 INFO   enable_graph_cache = True
2025-12-24 09:44:35 INFO   graph_cache_size = 256
2025-12-24 09:44:35 INFO   canonicalize_on_load = False
2025-12-24 09:44:35 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-24 09:44:35 INFO   edge_schema = {}
2025-12-24 09:44:35 INFO   topology_schema = {}
Seed set to 222
2025-12-24 09:44:35 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-24 09:44:35 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 09:44:35 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-24 09:44:35 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 09:44:35 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-24 09:44:35 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 09:44:37 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-24 09:44:37 INFO Tuning group stats: groups=352 groups>=2=34 singletons=318 max_group=11
2025-12-24 09:44:37 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-24_09-44-32/dataset_coverage.json
2025-12-24 09:44:37 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-24_09-44-32/dataset_coverage.json for details.
2025-12-24 09:44:37 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-24_09-44-32/dataset_coverage.json for details.
2025-12-24 09:44:37 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-24_09-44-32/dataset_coverage.json for details.
2025-12-24 09:44:37 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-24_09-44-32/schema_summary.json
2025-12-24 09:44:37 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-24_09-44-32/feature_metadata.json
2025-12-24 09:44:37 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-24 09:44:37 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/advanced_k_partite_v2/feature-config.yaml.advanced_lean.10A.v2, sha256=2022a36e7b21668173af3af66c25cf6b6a0494e642c0934eac38abbcfeebec3d
2025-12-24 09:44:37 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/work/edge_features)
2025-12-24 09:44:37 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json
2025-12-24 09:44:37 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-24_09-44-32/schema_summary.json
2025-12-24 09:44:37 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-24 09:44:37 INFO Topology: topology/persistence_k_partite_advanced/v2 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 628-dimensional node features.
2025-12-24 09:44:37 INFO Node: node/dssp_topo_merge_passthrough/v1; metadata lists 628 feature columns matching the .pt tensor.
2025-12-24 09:44:37 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-24 09:44:37 INFO → Total feature dimensionality observed and confirmed: node_dim = 628, edge_dim = 11.
2025-12-24 09:44:37 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-24 09:44:37 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 628,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge_passthrough/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 628,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-24_09-44-32/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge_passthrough/v1",
      "alias": "Passthrough (all dims from topology module) = Node Dynamic Dims",
      "jobs": 16,
      "summary": "DSSP/basic features merged with all topology columns (passthrough)."
    },
    "topology": {
      "id": "topology/persistence_k_partite_advanced/v2",
      "alias": "Advanced k-partite PH (v2 lean) topo_dim 596",
      "jobs": 16,
      "summary": "Fixed-width k-partite persistent homology with slot padding + missingness channels."
    }
  },
  "notes": []
}
2025-12-24 09:44:37 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-24 09:44:37 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=967bc7b5cd45474cb43714695092c701)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-24 09:44:37 INFO Starting training (fast_dev_run=False)
2025-12-24 09:44:37 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-24_09-44-32/model_checkpoints exists and is not empty.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 20.1 K | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
180 K     Trainable params
0         Non-trainable params
180 K     Total params
0.721     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-24 09:44:52 INFO Epoch 000 | 25% complete (batch 46/181)
2025-12-24 09:44:52 INFO Epoch 000 | 50% complete (batch 91/181)
2025-12-24 09:44:53 INFO Epoch 000 | 75% complete (batch 136/181)
2025-12-24 09:45:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.140548
2025-12-24 09:45:06 INFO Tuning ranking metrics: regret=0.154321 spearman=-0.080042 (groups=34, skipped=318)
2025-12-24 09:45:06 INFO Epoch 000 | val_loss=0.140548
Metric tuning_rank_spearman improved. New best score: -0.080
2025-12-24 09:45:15 INFO Epoch 001 | 25% complete (batch 46/181)
2025-12-24 09:45:16 INFO Epoch 001 | 50% complete (batch 91/181)
2025-12-24 09:45:17 INFO Epoch 001 | 75% complete (batch 136/181)
2025-12-24 09:45:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.008335
2025-12-24 09:45:30 INFO Tuning ranking metrics: regret=0.155838 spearman=-0.133321 (groups=34, skipped=318)
2025-12-24 09:45:30 INFO Epoch 001 | train_mse=0.155692 | val_loss=0.140593 | best_val_loss=-0.080042
2025-12-24 09:45:38 INFO Epoch 002 | 25% complete (batch 46/181)
2025-12-24 09:45:39 INFO Epoch 002 | 50% complete (batch 91/181)
2025-12-24 09:45:40 INFO Epoch 002 | 75% complete (batch 136/181)
2025-12-24 09:45:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.082728
2025-12-24 09:45:54 INFO Tuning ranking metrics: regret=0.148687 spearman=-0.065177 (groups=34, skipped=318)
2025-12-24 09:45:54 INFO Epoch 002 | train_mse=0.152486 | val_loss=0.140475 | best_val_loss=-0.080042
Metric tuning_rank_spearman improved by 0.015 >= min_delta = 0.0. New best score: -0.065
2025-12-24 09:46:02 INFO Epoch 003 | 25% complete (batch 46/181)
2025-12-24 09:46:03 INFO Epoch 003 | 50% complete (batch 91/181)
2025-12-24 09:46:04 INFO Epoch 003 | 75% complete (batch 136/181)
2025-12-24 09:46:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.327114
2025-12-24 09:46:17 INFO Tuning ranking metrics: regret=0.153304 spearman=0.128727 (groups=34, skipped=318)
2025-12-24 09:46:17 INFO Epoch 003 | train_mse=0.137339 | val_loss=0.140613 | best_val_loss=-0.065177
Metric tuning_rank_spearman improved by 0.194 >= min_delta = 0.0. New best score: 0.129
2025-12-24 09:46:25 INFO Epoch 004 | 25% complete (batch 46/181)
2025-12-24 09:46:26 INFO Epoch 004 | 50% complete (batch 91/181)
2025-12-24 09:46:27 INFO Epoch 004 | 75% complete (batch 136/181)
2025-12-24 09:46:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.140699
2025-12-24 09:46:40 INFO Tuning ranking metrics: regret=0.148503 spearman=-0.114801 (groups=34, skipped=318)
2025-12-24 09:46:40 INFO Epoch 004 | train_mse=0.139568 | val_loss=0.140699 | best_val_loss=0.128727
2025-12-24 09:46:49 INFO Epoch 005 | 25% complete (batch 46/181)
2025-12-24 09:46:50 INFO Epoch 005 | 50% complete (batch 91/181)
2025-12-24 09:46:51 INFO Epoch 005 | 75% complete (batch 136/181)
2025-12-24 09:46:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.360607
2025-12-24 09:47:04 INFO Tuning ranking metrics: regret=0.129622 spearman=-0.025452 (groups=34, skipped=318)
2025-12-24 09:47:04 INFO Epoch 005 | train_mse=0.152798 | val_loss=0.140319 | best_val_loss=0.128727
2025-12-24 09:47:12 INFO Epoch 006 | 25% complete (batch 46/181)
2025-12-24 09:47:13 INFO Epoch 006 | 50% complete (batch 91/181)
2025-12-24 09:47:14 INFO Epoch 006 | 75% complete (batch 136/181)
2025-12-24 09:47:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.356683
2025-12-24 09:47:28 INFO Tuning ranking metrics: regret=0.131587 spearman=-0.053107 (groups=34, skipped=318)
2025-12-24 09:47:28 INFO Epoch 006 | train_mse=0.142284 | val_loss=0.138794 | best_val_loss=0.128727
2025-12-24 09:47:36 INFO Epoch 007 | 25% complete (batch 46/181)
2025-12-24 09:47:37 INFO Epoch 007 | 50% complete (batch 91/181)
2025-12-24 09:47:38 INFO Epoch 007 | 75% complete (batch 136/181)
2025-12-24 09:47:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.389463
2025-12-24 09:47:51 INFO Tuning ranking metrics: regret=0.127348 spearman=-0.014770 (groups=34, skipped=318)
2025-12-24 09:47:51 INFO Epoch 007 | train_mse=0.141589 | val_loss=0.142550 | best_val_loss=0.128727
2025-12-24 09:48:00 INFO Epoch 008 | 25% complete (batch 46/181)
2025-12-24 09:48:00 INFO Epoch 008 | 50% complete (batch 91/181)
2025-12-24 09:48:01 INFO Epoch 008 | 75% complete (batch 136/181)
2025-12-24 09:48:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.289996
2025-12-24 09:48:14 INFO Tuning ranking metrics: regret=0.147906 spearman=-0.063783 (groups=34, skipped=318)
2025-12-24 09:48:14 INFO Epoch 008 | train_mse=0.158155 | val_loss=0.123589 | best_val_loss=0.128727
2025-12-24 09:48:23 INFO Epoch 009 | 25% complete (batch 46/181)
2025-12-24 09:48:23 INFO Epoch 009 | 50% complete (batch 91/181)
2025-12-24 09:48:24 INFO Epoch 009 | 75% complete (batch 136/181)
2025-12-24 09:48:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.438973
2025-12-24 09:48:38 INFO Tuning ranking metrics: regret=0.136484 spearman=0.004876 (groups=34, skipped=318)
2025-12-24 09:48:38 INFO Epoch 009 | train_mse=0.145883 | val_loss=0.135009 | best_val_loss=0.128727
2025-12-24 09:48:46 INFO Epoch 010 | 25% complete (batch 46/181)
2025-12-24 09:48:47 INFO Epoch 010 | 50% complete (batch 91/181)
2025-12-24 09:48:48 INFO Epoch 010 | 75% complete (batch 136/181)
2025-12-24 09:48:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.336933
2025-12-24 09:49:01 INFO Tuning ranking metrics: regret=0.116340 spearman=-0.050936 (groups=34, skipped=318)
2025-12-24 09:49:01 INFO Epoch 010 | train_mse=0.143830 | val_loss=0.136679 | best_val_loss=0.128727
2025-12-24 09:49:09 INFO Epoch 011 | 25% complete (batch 46/181)
2025-12-24 09:49:10 INFO Epoch 011 | 50% complete (batch 91/181)
2025-12-24 09:49:11 INFO Epoch 011 | 75% complete (batch 136/181)
2025-12-24 09:49:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.142039
2025-12-24 09:49:24 INFO Tuning ranking metrics: regret=0.150713 spearman=-0.107436 (groups=34, skipped=318)
2025-12-24 09:49:24 INFO Epoch 011 | train_mse=0.133740 | val_loss=0.142039 | best_val_loss=0.128727
2025-12-24 09:49:32 INFO Epoch 012 | 25% complete (batch 46/181)
2025-12-24 09:49:33 INFO Epoch 012 | 50% complete (batch 91/181)
2025-12-24 09:49:34 INFO Epoch 012 | 75% complete (batch 136/181)
2025-12-24 09:49:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.136512
2025-12-24 09:49:47 INFO Tuning ranking metrics: regret=0.132328 spearman=-0.062529 (groups=34, skipped=318)
2025-12-24 09:49:47 INFO Epoch 012 | train_mse=0.155245 | val_loss=0.136512 | best_val_loss=0.128727
2025-12-24 09:49:56 INFO Epoch 013 | 25% complete (batch 46/181)
2025-12-24 09:49:57 INFO Epoch 013 | 50% complete (batch 91/181)
2025-12-24 09:49:58 INFO Epoch 013 | 75% complete (batch 136/181)
2025-12-24 09:50:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.428070
2025-12-24 09:50:11 INFO Tuning ranking metrics: regret=0.130573 spearman=0.123685 (groups=34, skipped=318)
2025-12-24 09:50:11 INFO Epoch 013 | train_mse=0.145607 | val_loss=0.134293 | best_val_loss=0.128727
2025-12-24 09:50:19 INFO Epoch 014 | 25% complete (batch 46/181)
2025-12-24 09:50:20 INFO Epoch 014 | 50% complete (batch 91/181)
2025-12-24 09:50:21 INFO Epoch 014 | 75% complete (batch 136/181)
2025-12-24 09:50:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.005542
2025-12-24 09:50:35 INFO Tuning ranking metrics: regret=0.118302 spearman=-0.020741 (groups=34, skipped=318)
2025-12-24 09:50:35 INFO Epoch 014 | train_mse=0.151452 | val_loss=0.134936 | best_val_loss=0.128727
2025-12-24 09:50:43 INFO Epoch 015 | 25% complete (batch 46/181)
2025-12-24 09:50:44 INFO Epoch 015 | 50% complete (batch 91/181)
2025-12-24 09:50:45 INFO Epoch 015 | 75% complete (batch 136/181)
2025-12-24 09:50:53 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.455373
2025-12-24 09:50:58 INFO Tuning ranking metrics: regret=0.118302 spearman=-0.025974 (groups=34, skipped=318)
2025-12-24 09:50:58 INFO Epoch 015 | train_mse=0.131522 | val_loss=0.133867 | best_val_loss=0.128727
2025-12-24 09:51:06 INFO Epoch 016 | 25% complete (batch 46/181)
2025-12-24 09:51:07 INFO Epoch 016 | 50% complete (batch 91/181)
2025-12-24 09:51:08 INFO Epoch 016 | 75% complete (batch 136/181)
2025-12-24 09:51:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.449223
2025-12-24 09:51:22 INFO Tuning ranking metrics: regret=0.110432 spearman=-0.015183 (groups=34, skipped=318)
2025-12-24 09:51:22 INFO Epoch 016 | train_mse=0.146222 | val_loss=0.133008 | best_val_loss=0.128727
2025-12-24 09:51:30 INFO Epoch 017 | 25% complete (batch 46/181)
2025-12-24 09:51:31 INFO Epoch 017 | 50% complete (batch 91/181)
2025-12-24 09:51:32 INFO Epoch 017 | 75% complete (batch 136/181)
2025-12-24 09:51:40 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.436464
2025-12-24 09:51:45 INFO Tuning ranking metrics: regret=0.125814 spearman=-0.020365 (groups=34, skipped=318)
2025-12-24 09:51:45 INFO Epoch 017 | train_mse=0.137407 | val_loss=0.127223 | best_val_loss=0.128727
2025-12-24 09:51:54 INFO Epoch 018 | 25% complete (batch 46/181)
2025-12-24 09:51:55 INFO Epoch 018 | 50% complete (batch 91/181)
2025-12-24 09:51:56 INFO Epoch 018 | 75% complete (batch 136/181)
2025-12-24 09:52:04 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.435011
2025-12-24 09:52:09 INFO Tuning ranking metrics: regret=0.126712 spearman=0.031016 (groups=34, skipped=318)
2025-12-24 09:52:09 INFO Epoch 018 | train_mse=0.130622 | val_loss=0.108739 | best_val_loss=0.128727
2025-12-24 09:52:17 INFO Epoch 019 | 25% complete (batch 46/181)
2025-12-24 09:52:18 INFO Epoch 019 | 50% complete (batch 91/181)
2025-12-24 09:52:19 INFO Epoch 019 | 75% complete (batch 136/181)
2025-12-24 09:52:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.423017
2025-12-24 09:52:33 INFO Tuning ranking metrics: regret=0.126542 spearman=0.024694 (groups=34, skipped=318)
2025-12-24 09:52:33 INFO Epoch 019 | train_mse=0.114579 | val_loss=0.142732 | best_val_loss=0.128727
2025-12-24 09:52:41 INFO Epoch 020 | 25% complete (batch 46/181)
2025-12-24 09:52:42 INFO Epoch 020 | 50% complete (batch 91/181)
2025-12-24 09:52:43 INFO Epoch 020 | 75% complete (batch 136/181)
2025-12-24 09:52:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.522445
2025-12-24 09:53:00 INFO Tuning ranking metrics: regret=0.126593 spearman=0.064757 (groups=34, skipped=318)
2025-12-24 09:53:00 INFO Epoch 020 | train_mse=0.114775 | val_loss=0.113661 | best_val_loss=0.128727
2025-12-24 09:53:08 INFO Epoch 021 | 25% complete (batch 46/181)
2025-12-24 09:53:09 INFO Epoch 021 | 50% complete (batch 91/181)
2025-12-24 09:53:10 INFO Epoch 021 | 75% complete (batch 136/181)
2025-12-24 09:53:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.526913
2025-12-24 09:53:25 INFO Tuning ranking metrics: regret=0.126593 spearman=0.064018 (groups=34, skipped=318)
2025-12-24 09:53:25 INFO Epoch 021 | train_mse=0.127499 | val_loss=0.105570 | best_val_loss=0.128727
2025-12-24 09:53:33 INFO Epoch 022 | 25% complete (batch 46/181)
2025-12-24 09:53:34 INFO Epoch 022 | 50% complete (batch 91/181)
2025-12-24 09:53:34 INFO Epoch 022 | 75% complete (batch 136/181)
2025-12-24 09:53:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.530652
2025-12-24 09:53:48 INFO Tuning ranking metrics: regret=0.130604 spearman=0.020716 (groups=34, skipped=318)
2025-12-24 09:53:48 INFO Epoch 022 | train_mse=0.100787 | val_loss=0.099786 | best_val_loss=0.128727
2025-12-24 09:53:56 INFO Epoch 023 | 25% complete (batch 46/181)
2025-12-24 09:53:57 INFO Epoch 023 | 50% complete (batch 91/181)
2025-12-24 09:53:58 INFO Epoch 023 | 75% complete (batch 136/181)
2025-12-24 09:54:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.508857
2025-12-24 09:54:12 INFO Tuning ranking metrics: regret=0.121174 spearman=0.022078 (groups=34, skipped=318)
2025-12-24 09:54:12 INFO Epoch 023 | train_mse=0.103452 | val_loss=0.130418 | best_val_loss=0.128727
Monitored metric tuning_rank_spearman did not improve in the last 20 records. Best score: 0.129. Signaling Trainer to stop.
2025-12-24 09:54:13 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.06476_val-0.11366_epoch020.chkpt, checkpoint.tuning_rank_spearman-0.12368_val-0.13429_epoch013.chkpt, checkpoint.tuning_rank_spearman-0.12873_val-0.14061_epoch003.chkpt
2025-12-24 09:54:13 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-24_09-44-32/model_checkpoints/checkpoint.tuning_rank_spearman-0.12873_val-0.14061_epoch003.chkpt
2025-12-24 09:54:13 INFO Best validation loss: tensor(0.1287)
2025-12-24 09:54:13 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-24_09-44-32/model_checkpoints/checkpoint.tuning_rank_spearman-0.12873_val-0.14061_epoch003.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-24_09-44-32/model_checkpoints/checkpoint.tuning_rank_spearman-0.12873_val-0.14061_epoch003.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-24 09:54:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.140613
2025-12-24 09:54:25 INFO Tuning ranking metrics: regret=0.153304 spearman=0.128727 (groups=34, skipped=318)
2025-12-24 09:54:25 INFO Epoch 024 | val_loss=0.140613 | best_val_loss=0.128727
2025-12-24 09:54:25 INFO Validation metrics: [{'val_loss': 0.14061294496059418, 'tuning_rank_regret': 0.15330372750759125, 'tuning_rank_spearman': 0.12872722744941711, 'val_pearson_corr': -0.15931078791618347, 'val_spearman_corr': -0.21861350536346436, 'val_rank_regret': 0.16777445375919342, 'val_rank_spearman': -0.6111111044883728}]
2025-12-24 09:54:25 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.12873_val-0.14061_epoch003.chkpt
2025-12-24 09:54:25 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.12368_val-0.13429_epoch013.chkpt
2025-12-24 09:54:25 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.06476_val-0.11366_epoch020.chkpt
2025-12-24 09:54:25 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.14048_epoch002.ckpt
2025-12-24 09:54:25 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.15330372750759125
  tuning_rank_spearman      0.12872722744941711
        val_loss            0.14061294496059418
    val_pearson_corr       -0.15931078791618347
     val_rank_regret        0.16777445375919342
    val_rank_spearman       -0.6111111044883728
    val_spearman_corr      -0.21861350536346436
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run large_batch_sched_boost_lean_seed222_2025-12-24_09-44-32 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-24_09-44-32
[train_cli][batch] job 'large_batch_sched_boost_lean_seed222' finished.
[run_full_pipeline] Best run: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53 (tuning_rank_spearman=0.06849376112222672)
[run_full_pipeline] Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53/model_checkpoints/checkpoint.tuning_rank_spearman-0.06849_val-0.13534_epoch017.chkpt
[run_full_pipeline] Phase 1 fine-tuning -> sched_boost_lean_seed222_2025-12-24_09-03-53_phase1
[train_cli] run_id=sched_boost_lean_seed222_2025-12-24_09-03-53_phase1 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase1/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase1 --git-commit 9b1bb2b320 --git-dirty --resume-from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53/model_checkpoints/checkpoint.tuning_rank_spearman-0.06849_val-0.13534_epoch017.chkpt
2025-12-24 09:54:32 INFO git_commit = 9b1bb2b320 (dirty)
2025-12-24 09:54:32 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-24 09:54:32 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase1/config/config.yaml
2025-12-24 09:54:32 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data
2025-12-24 09:54:32 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-24 09:54:32 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-24 09:54:32 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase1
2025-12-24 09:54:32 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-24 09:54:32 INFO   metadata_path = None
2025-12-24 09:54:32 INFO   summary_path = None
2025-12-24 09:54:32 INFO   accelerator = cpu
2025-12-24 09:54:32 INFO   devices = 1
2025-12-24 09:54:32 INFO   attention_head = 8
2025-12-24 09:54:32 INFO   pooling_type = mean
2025-12-24 09:54:32 INFO   model_self_loops = False
2025-12-24 09:54:32 INFO   model_self_loop_fill = mean
2025-12-24 09:54:32 INFO   model_residual = False
2025-12-24 09:54:32 INFO   batch_size = 48
2025-12-24 09:54:32 INFO   learning_rate = 0.001
2025-12-24 09:54:32 INFO   num_epochs = 320
2025-12-24 09:54:32 INFO   accumulate_grad_batches = 8
2025-12-24 09:54:32 INFO   seed = 222
2025-12-24 09:54:32 INFO   num_workers = 2
2025-12-24 09:54:32 INFO   precision = 32
2025-12-24 09:54:32 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-24 09:54:32 INFO   early_stopping_patience = 20
2025-12-24 09:54:32 INFO   lr_scheduler_patience = 4
2025-12-24 09:54:32 INFO   lr_scheduler_factor = 0.2
2025-12-24 09:54:32 INFO   fast_dev_run = False
2025-12-24 09:54:32 INFO   limit_train_batches = None
2025-12-24 09:54:32 INFO   limit_val_batches = None
2025-12-24 09:54:32 INFO   log_lr = False
2025-12-24 09:54:32 INFO   progress_bar_refresh_rate = 0
2025-12-24 09:54:32 INFO   log_every_n_steps = 100
2025-12-24 09:54:32 INFO   use_val_spearman_as_secondary = True
2025-12-24 09:54:32 INFO   spearman_secondary_min_delta = 0.0
2025-12-24 09:54:32 INFO   spearman_secondary_weight = 1.0
2025-12-24 09:54:32 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-24 09:54:32 INFO   tuning_max_samples = 500
2025-12-24 09:54:32 INFO   tuning_fraction = None
2025-12-24 09:54:32 INFO   tuning_eval_every = 1
2025-12-24 09:54:32 INFO   rank_loss_weight = 0.0
2025-12-24 09:54:32 INFO   rank_loss_margin = 0.0
2025-12-24 09:54:32 INFO   rank_loss_mode = hinge
2025-12-24 09:54:32 INFO   rank_loss_grouped = True
2025-12-24 09:54:32 INFO   variance_reduction_enabled = False
2025-12-24 09:54:32 INFO   variance_reduction_method = topk_avg
2025-12-24 09:54:32 INFO   variance_reduction_top_k = 3
2025-12-24 09:54:32 INFO   coverage_minimum = 0.0
2025-12-24 09:54:32 INFO   coverage_fail_on_missing = False
2025-12-24 09:54:32 INFO   graph_load_profiling = False
2025-12-24 09:54:32 INFO   graph_load_top_k = 5
2025-12-24 09:54:32 INFO   enable_graph_cache = True
2025-12-24 09:54:32 INFO   graph_cache_size = 256
2025-12-24 09:54:32 INFO   canonicalize_on_load = False
2025-12-24 09:54:32 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-24 09:54:32 INFO   edge_schema = {}
2025-12-24 09:54:32 INFO   topology_schema = {}
Seed set to 222
2025-12-24 09:54:32 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-24 09:54:32 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 09:54:32 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-24 09:54:32 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 09:54:32 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-24 09:54:32 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 09:54:34 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-24 09:54:34 INFO Tuning group stats: groups=352 groups>=2=34 singletons=318 max_group=11
2025-12-24 09:54:34 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase1/dataset_coverage.json
2025-12-24 09:54:34 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase1/dataset_coverage.json for details.
2025-12-24 09:54:34 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase1/dataset_coverage.json for details.
2025-12-24 09:54:34 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase1/dataset_coverage.json for details.
2025-12-24 09:54:34 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase1/schema_summary.json
2025-12-24 09:54:34 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase1/feature_metadata.json
2025-12-24 09:54:34 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-24 09:54:34 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/advanced_k_partite_v2/feature-config.yaml.advanced_lean.10A.v2, sha256=2022a36e7b21668173af3af66c25cf6b6a0494e642c0934eac38abbcfeebec3d
2025-12-24 09:54:34 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/work/edge_features)
2025-12-24 09:54:34 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json
2025-12-24 09:54:34 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase1/schema_summary.json
2025-12-24 09:54:34 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-24 09:54:34 INFO Topology: topology/persistence_k_partite_advanced/v2 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 628-dimensional node features.
2025-12-24 09:54:34 INFO Node: node/dssp_topo_merge_passthrough/v1; metadata lists 628 feature columns matching the .pt tensor.
2025-12-24 09:54:34 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-24 09:54:34 INFO → Total feature dimensionality observed and confirmed: node_dim = 628, edge_dim = 11.
2025-12-24 09:54:34 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-24 09:54:34 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 628,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge_passthrough/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 628,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase1/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge_passthrough/v1",
      "alias": "Passthrough (all dims from topology module) = Node Dynamic Dims",
      "jobs": 16,
      "summary": "DSSP/basic features merged with all topology columns (passthrough)."
    },
    "topology": {
      "id": "topology/persistence_k_partite_advanced/v2",
      "alias": "Advanced k-partite PH (v2 lean) topo_dim 596",
      "jobs": 16,
      "summary": "Fixed-width k-partite persistent homology with slot padding + missingness channels."
    }
  },
  "notes": []
}
2025-12-24 09:54:34 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-24 09:54:34 INFO Resuming from checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53/model_checkpoints/checkpoint.tuning_rank_spearman-0.06849_val-0.13534_epoch017.chkpt (epoch=17)
2025-12-24 09:54:34 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=98a9073a71b84cd6aeb49c31b0e4256e)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-24 09:54:34 INFO Starting training (fast_dev_run=False)
2025-12-24 09:54:34 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase1/model_checkpoints exists and is not empty.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53/model_checkpoints/checkpoint.tuning_rank_spearman-0.06849_val-0.13534_epoch017.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53/model_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase1/model_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53/model_checkpoints/val_loss_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase1/model_checkpoints/val_loss_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 20.1 K | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
180 K     Trainable params
0         Non-trainable params
180 K     Total params
0.721     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
Restored all states from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53/model_checkpoints/checkpoint.tuning_rank_spearman-0.06849_val-0.13534_epoch017.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-24 09:54:48 INFO Epoch 018 | 25% complete (batch 46/181)
2025-12-24 09:54:49 INFO Epoch 018 | 50% complete (batch 91/181)
2025-12-24 09:54:50 INFO Epoch 018 | 75% complete (batch 136/181)
2025-12-24 09:54:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.134718
2025-12-24 09:55:03 INFO Tuning ranking metrics: regret=0.131492 spearman=0.086294 (groups=34, skipped=318)
2025-12-24 09:55:03 INFO Epoch 018 | val_loss=0.134718
Metric tuning_rank_spearman improved by 0.018 >= min_delta = 0.0. New best score: 0.086
2025-12-24 09:55:11 INFO Epoch 019 | 25% complete (batch 46/181)
2025-12-24 09:55:12 INFO Epoch 019 | 50% complete (batch 91/181)
2025-12-24 09:55:13 INFO Epoch 019 | 75% complete (batch 136/181)
2025-12-24 09:55:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.007241
2025-12-24 09:55:27 INFO Tuning ranking metrics: regret=0.131219 spearman=0.041769 (groups=34, skipped=318)
2025-12-24 09:55:27 INFO Epoch 019 | train_mse=0.133573 | val_loss=0.134410 | best_val_loss=0.086294
2025-12-24 09:55:35 INFO Epoch 020 | 25% complete (batch 46/181)
2025-12-24 09:55:36 INFO Epoch 020 | 50% complete (batch 91/181)
2025-12-24 09:55:37 INFO Epoch 020 | 75% complete (batch 136/181)
2025-12-24 09:55:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.004277
2025-12-24 09:55:50 INFO Tuning ranking metrics: regret=0.131222 spearman=0.040088 (groups=34, skipped=318)
2025-12-24 09:55:50 INFO Epoch 020 | train_mse=0.139028 | val_loss=0.134473 | best_val_loss=0.086294
2025-12-24 09:55:59 INFO Epoch 021 | 25% complete (batch 46/181)
2025-12-24 09:55:59 INFO Epoch 021 | 50% complete (batch 91/181)
2025-12-24 09:56:00 INFO Epoch 021 | 75% complete (batch 136/181)
2025-12-24 09:56:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.011179
2025-12-24 09:56:14 INFO Tuning ranking metrics: regret=0.131222 spearman=0.040088 (groups=34, skipped=318)
2025-12-24 09:56:14 INFO Epoch 021 | train_mse=0.124227 | val_loss=0.134312 | best_val_loss=0.086294
2025-12-24 09:56:22 INFO Epoch 022 | 25% complete (batch 46/181)
2025-12-24 09:56:23 INFO Epoch 022 | 50% complete (batch 91/181)
2025-12-24 09:56:24 INFO Epoch 022 | 75% complete (batch 136/181)
2025-12-24 09:56:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.007881
2025-12-24 09:56:37 INFO Tuning ranking metrics: regret=0.131779 spearman=0.033193 (groups=34, skipped=318)
2025-12-24 09:56:37 INFO Epoch 022 | train_mse=0.121297 | val_loss=0.134424 | best_val_loss=0.086294
2025-12-24 09:56:46 INFO Epoch 023 | 25% complete (batch 46/181)
2025-12-24 09:56:47 INFO Epoch 023 | 50% complete (batch 91/181)
2025-12-24 09:56:47 INFO Epoch 023 | 75% complete (batch 136/181)
2025-12-24 09:56:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.009627
2025-12-24 09:57:01 INFO Tuning ranking metrics: regret=0.131779 spearman=0.038235 (groups=34, skipped=318)
2025-12-24 09:57:01 INFO Epoch 023 | train_mse=0.131413 | val_loss=0.134087 | best_val_loss=0.086294
2025-12-24 09:57:10 INFO Epoch 024 | 25% complete (batch 46/181)
2025-12-24 09:57:11 INFO Epoch 024 | 50% complete (batch 91/181)
2025-12-24 09:57:12 INFO Epoch 024 | 75% complete (batch 136/181)
2025-12-24 09:57:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.019461
2025-12-24 09:57:26 INFO Tuning ranking metrics: regret=0.131779 spearman=0.034734 (groups=34, skipped=318)
2025-12-24 09:57:26 INFO Epoch 024 | train_mse=0.115879 | val_loss=0.133861 | best_val_loss=0.086294
2025-12-24 09:57:35 INFO Epoch 025 | 25% complete (batch 46/181)
2025-12-24 09:57:36 INFO Epoch 025 | 50% complete (batch 91/181)
2025-12-24 09:57:37 INFO Epoch 025 | 75% complete (batch 136/181)
2025-12-24 09:57:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.017605
2025-12-24 09:57:51 INFO Tuning ranking metrics: regret=0.136879 spearman=-0.008824 (groups=34, skipped=318)
2025-12-24 09:57:51 INFO Epoch 025 | train_mse=0.125665 | val_loss=0.134274 | best_val_loss=0.086294
2025-12-24 09:58:00 INFO Epoch 026 | 25% complete (batch 46/181)
2025-12-24 09:58:01 INFO Epoch 026 | 50% complete (batch 91/181)
2025-12-24 09:58:01 INFO Epoch 026 | 75% complete (batch 136/181)
2025-12-24 09:58:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.089722
2025-12-24 09:58:15 INFO Tuning ranking metrics: regret=0.132938 spearman=-0.002979 (groups=34, skipped=318)
2025-12-24 09:58:15 INFO Epoch 026 | train_mse=0.133005 | val_loss=0.133216 | best_val_loss=0.086294
2025-12-24 09:58:24 INFO Epoch 027 | 25% complete (batch 46/181)
2025-12-24 09:58:25 INFO Epoch 027 | 50% complete (batch 91/181)
2025-12-24 09:58:26 INFO Epoch 027 | 75% complete (batch 136/181)
2025-12-24 09:58:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.012976
2025-12-24 09:58:40 INFO Tuning ranking metrics: regret=0.132923 spearman=0.006583 (groups=34, skipped=318)
2025-12-24 09:58:40 INFO Epoch 027 | train_mse=0.137127 | val_loss=0.133303 | best_val_loss=0.086294
2025-12-24 09:58:48 INFO Epoch 028 | 25% complete (batch 46/181)
2025-12-24 09:58:49 INFO Epoch 028 | 50% complete (batch 91/181)
2025-12-24 09:58:50 INFO Epoch 028 | 75% complete (batch 136/181)
2025-12-24 09:58:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.088669
2025-12-24 09:59:05 INFO Tuning ranking metrics: regret=0.136858 spearman=-0.014846 (groups=34, skipped=318)
2025-12-24 09:59:05 INFO Epoch 028 | train_mse=0.132728 | val_loss=0.135394 | best_val_loss=0.086294
2025-12-24 09:59:13 INFO Epoch 029 | 25% complete (batch 46/181)
2025-12-24 09:59:14 INFO Epoch 029 | 50% complete (batch 91/181)
2025-12-24 09:59:15 INFO Epoch 029 | 75% complete (batch 136/181)
2025-12-24 09:59:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.096063
2025-12-24 09:59:29 INFO Tuning ranking metrics: regret=0.138676 spearman=-0.060574 (groups=34, skipped=318)
2025-12-24 09:59:29 INFO Epoch 029 | train_mse=0.133209 | val_loss=0.132477 | best_val_loss=0.086294
2025-12-24 09:59:38 INFO Epoch 030 | 25% complete (batch 46/181)
2025-12-24 09:59:39 INFO Epoch 030 | 50% complete (batch 91/181)
2025-12-24 09:59:40 INFO Epoch 030 | 75% complete (batch 136/181)
2025-12-24 09:59:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.167597
2025-12-24 09:59:54 INFO Tuning ranking metrics: regret=0.139523 spearman=-0.055182 (groups=34, skipped=318)
2025-12-24 09:59:54 INFO Epoch 030 | train_mse=0.133001 | val_loss=0.131550 | best_val_loss=0.086294
2025-12-24 10:00:02 INFO Epoch 031 | 25% complete (batch 46/181)
2025-12-24 10:00:03 INFO Epoch 031 | 50% complete (batch 91/181)
2025-12-24 10:00:04 INFO Epoch 031 | 75% complete (batch 136/181)
2025-12-24 10:00:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.145662
2025-12-24 10:00:18 INFO Tuning ranking metrics: regret=0.132900 spearman=0.028807 (groups=34, skipped=318)
2025-12-24 10:00:18 INFO Epoch 031 | train_mse=0.112494 | val_loss=0.128770 | best_val_loss=0.086294
2025-12-24 10:00:27 INFO Epoch 032 | 25% complete (batch 46/181)
2025-12-24 10:00:28 INFO Epoch 032 | 50% complete (batch 91/181)
2025-12-24 10:00:29 INFO Epoch 032 | 75% complete (batch 136/181)
2025-12-24 10:00:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.189558
2025-12-24 10:00:43 INFO Tuning ranking metrics: regret=0.121306 spearman=-0.011064 (groups=34, skipped=318)
2025-12-24 10:00:43 INFO Epoch 032 | train_mse=0.129340 | val_loss=0.124194 | best_val_loss=0.086294
2025-12-24 10:00:51 INFO Epoch 033 | 25% complete (batch 46/181)
2025-12-24 10:00:52 INFO Epoch 033 | 50% complete (batch 91/181)
2025-12-24 10:00:53 INFO Epoch 033 | 75% complete (batch 136/181)
2025-12-24 10:01:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.353377
2025-12-24 10:01:07 INFO Tuning ranking metrics: regret=0.113642 spearman=-0.042485 (groups=34, skipped=318)
2025-12-24 10:01:07 INFO Epoch 033 | train_mse=0.124177 | val_loss=0.123835 | best_val_loss=0.086294
2025-12-24 10:01:16 INFO Epoch 034 | 25% complete (batch 46/181)
2025-12-24 10:01:17 INFO Epoch 034 | 50% complete (batch 91/181)
2025-12-24 10:01:18 INFO Epoch 034 | 75% complete (batch 136/181)
2025-12-24 10:01:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.436230
2025-12-24 10:01:32 INFO Tuning ranking metrics: regret=0.115282 spearman=0.018303 (groups=34, skipped=318)
2025-12-24 10:01:32 INFO Epoch 034 | train_mse=0.142852 | val_loss=0.116027 | best_val_loss=0.086294
2025-12-24 10:01:40 INFO Epoch 035 | 25% complete (batch 46/181)
2025-12-24 10:01:41 INFO Epoch 035 | 50% complete (batch 91/181)
2025-12-24 10:01:42 INFO Epoch 035 | 75% complete (batch 136/181)
2025-12-24 10:01:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.370559
2025-12-24 10:01:56 INFO Tuning ranking metrics: regret=0.108815 spearman=0.022004 (groups=34, skipped=318)
2025-12-24 10:01:56 INFO Epoch 035 | train_mse=0.124585 | val_loss=0.125176 | best_val_loss=0.086294
2025-12-24 10:02:05 INFO Epoch 036 | 25% complete (batch 46/181)
2025-12-24 10:02:06 INFO Epoch 036 | 50% complete (batch 91/181)
2025-12-24 10:02:07 INFO Epoch 036 | 75% complete (batch 136/181)
2025-12-24 10:02:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.485831
2025-12-24 10:02:21 INFO Tuning ranking metrics: regret=0.113718 spearman=0.059645 (groups=34, skipped=318)
2025-12-24 10:02:21 INFO Epoch 036 | train_mse=0.128034 | val_loss=0.106883 | best_val_loss=0.086294
2025-12-24 10:02:30 INFO Epoch 037 | 25% complete (batch 46/181)
2025-12-24 10:02:31 INFO Epoch 037 | 50% complete (batch 91/181)
2025-12-24 10:02:32 INFO Epoch 037 | 75% complete (batch 136/181)
2025-12-24 10:02:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.476600
2025-12-24 10:02:46 INFO Tuning ranking metrics: regret=0.105092 spearman=0.035211 (groups=34, skipped=318)
2025-12-24 10:02:46 INFO Epoch 037 | train_mse=0.122986 | val_loss=0.091380 | best_val_loss=0.086294
2025-12-24 10:02:54 INFO Epoch 038 | 25% complete (batch 46/181)
2025-12-24 10:02:56 INFO Epoch 038 | 50% complete (batch 91/181)
2025-12-24 10:02:57 INFO Epoch 038 | 75% complete (batch 136/181)
2025-12-24 10:03:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.476442
2025-12-24 10:03:10 INFO Tuning ranking metrics: regret=0.106464 spearman=0.098962 (groups=34, skipped=318)
2025-12-24 10:03:10 INFO Epoch 038 | train_mse=0.100320 | val_loss=0.121568 | best_val_loss=0.086294
Metric tuning_rank_spearman improved by 0.013 >= min_delta = 0.0. New best score: 0.099
2025-12-24 10:03:19 INFO Epoch 039 | 25% complete (batch 46/181)
2025-12-24 10:03:20 INFO Epoch 039 | 50% complete (batch 91/181)
2025-12-24 10:03:21 INFO Epoch 039 | 75% complete (batch 136/181)
2025-12-24 10:03:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.508458
2025-12-24 10:03:35 INFO Tuning ranking metrics: regret=0.091082 spearman=0.124752 (groups=34, skipped=318)
2025-12-24 10:03:35 INFO Epoch 039 | train_mse=0.094220 | val_loss=0.128083 | best_val_loss=0.098962
Metric tuning_rank_spearman improved by 0.026 >= min_delta = 0.0. New best score: 0.125
2025-12-24 10:03:44 INFO Epoch 040 | 25% complete (batch 46/181)
2025-12-24 10:03:45 INFO Epoch 040 | 50% complete (batch 91/181)
2025-12-24 10:03:46 INFO Epoch 040 | 75% complete (batch 136/181)
2025-12-24 10:03:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.544999
2025-12-24 10:04:00 INFO Tuning ranking metrics: regret=0.109050 spearman=0.109785 (groups=34, skipped=318)
2025-12-24 10:04:00 INFO Epoch 040 | train_mse=0.090708 | val_loss=0.093806 | best_val_loss=0.124752
2025-12-24 10:04:09 INFO Epoch 041 | 25% complete (batch 46/181)
2025-12-24 10:04:10 INFO Epoch 041 | 50% complete (batch 91/181)
2025-12-24 10:04:11 INFO Epoch 041 | 75% complete (batch 136/181)
2025-12-24 10:04:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.521948
2025-12-24 10:04:25 INFO Tuning ranking metrics: regret=0.091085 spearman=0.119302 (groups=34, skipped=318)
2025-12-24 10:04:25 INFO Epoch 041 | train_mse=0.103854 | val_loss=0.084999 | best_val_loss=0.124752
2025-12-24 10:04:34 INFO Epoch 042 | 25% complete (batch 46/181)
2025-12-24 10:04:35 INFO Epoch 042 | 50% complete (batch 91/181)
2025-12-24 10:04:36 INFO Epoch 042 | 75% complete (batch 136/181)
2025-12-24 10:04:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.558415
2025-12-24 10:04:50 INFO Tuning ranking metrics: regret=0.082459 spearman=0.128654 (groups=34, skipped=318)
2025-12-24 10:04:50 INFO Epoch 042 | train_mse=0.093785 | val_loss=0.085907 | best_val_loss=0.124752
Metric tuning_rank_spearman improved by 0.004 >= min_delta = 0.0. New best score: 0.129
2025-12-24 10:04:59 INFO Epoch 043 | 25% complete (batch 46/181)
2025-12-24 10:05:00 INFO Epoch 043 | 50% complete (batch 91/181)
2025-12-24 10:05:01 INFO Epoch 043 | 75% complete (batch 136/181)
2025-12-24 10:05:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.589674
2025-12-24 10:05:15 INFO Tuning ranking metrics: regret=0.100075 spearman=0.125891 (groups=34, skipped=318)
2025-12-24 10:05:15 INFO Epoch 043 | train_mse=0.077737 | val_loss=0.077803 | best_val_loss=0.128654
2025-12-24 10:05:24 INFO Epoch 044 | 25% complete (batch 46/181)
2025-12-24 10:05:25 INFO Epoch 044 | 50% complete (batch 91/181)
2025-12-24 10:05:26 INFO Epoch 044 | 75% complete (batch 136/181)
2025-12-24 10:05:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.541201
2025-12-24 10:05:40 INFO Tuning ranking metrics: regret=0.121512 spearman=0.086147 (groups=34, skipped=318)
2025-12-24 10:05:40 INFO Epoch 044 | train_mse=0.057978 | val_loss=0.109391 | best_val_loss=0.128654
2025-12-24 10:05:50 INFO Epoch 045 | 25% complete (batch 46/181)
2025-12-24 10:05:51 INFO Epoch 045 | 50% complete (batch 91/181)
2025-12-24 10:05:52 INFO Epoch 045 | 75% complete (batch 136/181)
2025-12-24 10:06:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.571448
2025-12-24 10:06:07 INFO Tuning ranking metrics: regret=0.100778 spearman=0.137236 (groups=34, skipped=318)
2025-12-24 10:06:07 INFO Epoch 045 | train_mse=0.088398 | val_loss=0.075808 | best_val_loss=0.128654
Metric tuning_rank_spearman improved by 0.009 >= min_delta = 0.0. New best score: 0.137
2025-12-24 10:06:17 INFO Epoch 046 | 25% complete (batch 46/181)
2025-12-24 10:06:18 INFO Epoch 046 | 50% complete (batch 91/181)
2025-12-24 10:06:19 INFO Epoch 046 | 75% complete (batch 136/181)
2025-12-24 10:06:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.584390
2025-12-24 10:06:34 INFO Tuning ranking metrics: regret=0.100778 spearman=0.135600 (groups=34, skipped=318)
2025-12-24 10:06:34 INFO Epoch 046 | train_mse=0.079000 | val_loss=0.074402 | best_val_loss=0.137236
2025-12-24 10:06:44 INFO Epoch 047 | 25% complete (batch 46/181)
2025-12-24 10:06:45 INFO Epoch 047 | 50% complete (batch 91/181)
2025-12-24 10:06:46 INFO Epoch 047 | 75% complete (batch 136/181)
2025-12-24 10:06:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.590416
2025-12-24 10:07:01 INFO Tuning ranking metrics: regret=0.103781 spearman=0.115890 (groups=34, skipped=318)
2025-12-24 10:07:01 INFO Epoch 047 | train_mse=0.076979 | val_loss=0.081924 | best_val_loss=0.137236
2025-12-24 10:07:11 INFO Epoch 048 | 25% complete (batch 46/181)
2025-12-24 10:07:12 INFO Epoch 048 | 50% complete (batch 91/181)
2025-12-24 10:07:13 INFO Epoch 048 | 75% complete (batch 136/181)
2025-12-24 10:07:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.618181
2025-12-24 10:07:27 INFO Tuning ranking metrics: regret=0.085658 spearman=0.145938 (groups=34, skipped=318)
2025-12-24 10:07:27 INFO Epoch 048 | train_mse=0.068297 | val_loss=0.073860 | best_val_loss=0.137236
Metric tuning_rank_spearman improved by 0.009 >= min_delta = 0.0. New best score: 0.146
2025-12-24 10:07:36 INFO Epoch 049 | 25% complete (batch 46/181)
2025-12-24 10:07:37 INFO Epoch 049 | 50% complete (batch 91/181)
2025-12-24 10:07:38 INFO Epoch 049 | 75% complete (batch 136/181)
2025-12-24 10:07:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.621627
2025-12-24 10:07:52 INFO Tuning ranking metrics: regret=0.098785 spearman=0.117469 (groups=34, skipped=318)
2025-12-24 10:07:52 INFO Epoch 049 | train_mse=0.077316 | val_loss=0.070935 | best_val_loss=0.145938
2025-12-24 10:08:01 INFO Epoch 050 | 25% complete (batch 46/181)
2025-12-24 10:08:02 INFO Epoch 050 | 50% complete (batch 91/181)
2025-12-24 10:08:03 INFO Epoch 050 | 75% complete (batch 136/181)
2025-12-24 10:08:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.606273
2025-12-24 10:08:17 INFO Tuning ranking metrics: regret=0.101525 spearman=0.101369 (groups=34, skipped=318)
2025-12-24 10:08:17 INFO Epoch 050 | train_mse=0.063016 | val_loss=0.082466 | best_val_loss=0.145938
2025-12-24 10:08:26 INFO Epoch 051 | 25% complete (batch 46/181)
2025-12-24 10:08:27 INFO Epoch 051 | 50% complete (batch 91/181)
2025-12-24 10:08:28 INFO Epoch 051 | 75% complete (batch 136/181)
2025-12-24 10:08:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.627868
2025-12-24 10:08:42 INFO Tuning ranking metrics: regret=0.098253 spearman=0.136275 (groups=34, skipped=318)
2025-12-24 10:08:42 INFO Epoch 051 | train_mse=0.089593 | val_loss=0.068097 | best_val_loss=0.145938
2025-12-24 10:08:51 INFO Epoch 052 | 25% complete (batch 46/181)
2025-12-24 10:08:52 INFO Epoch 052 | 50% complete (batch 91/181)
2025-12-24 10:08:53 INFO Epoch 052 | 75% complete (batch 136/181)
2025-12-24 10:09:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.625699
2025-12-24 10:09:07 INFO Tuning ranking metrics: regret=0.098651 spearman=0.142755 (groups=34, skipped=318)
2025-12-24 10:09:07 INFO Epoch 052 | train_mse=0.066961 | val_loss=0.068841 | best_val_loss=0.145938
2025-12-24 10:09:16 INFO Epoch 053 | 25% complete (batch 46/181)
2025-12-24 10:09:17 INFO Epoch 053 | 50% complete (batch 91/181)
2025-12-24 10:09:18 INFO Epoch 053 | 75% complete (batch 136/181)
2025-12-24 10:09:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.575737
2025-12-24 10:09:32 INFO Tuning ranking metrics: regret=0.101000 spearman=0.118169 (groups=34, skipped=318)
2025-12-24 10:09:32 INFO Epoch 053 | train_mse=0.069151 | val_loss=0.115348 | best_val_loss=0.145938
2025-12-24 10:09:41 INFO Epoch 054 | 25% complete (batch 46/181)
2025-12-24 10:09:42 INFO Epoch 054 | 50% complete (batch 91/181)
2025-12-24 10:09:43 INFO Epoch 054 | 75% complete (batch 136/181)
2025-12-24 10:09:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.588382
2025-12-24 10:09:58 INFO Tuning ranking metrics: regret=0.101000 spearman=0.121823 (groups=34, skipped=318)
2025-12-24 10:09:58 INFO Epoch 054 | train_mse=0.063963 | val_loss=0.118516 | best_val_loss=0.145938
2025-12-24 10:10:07 INFO Epoch 055 | 25% complete (batch 46/181)
2025-12-24 10:10:08 INFO Epoch 055 | 50% complete (batch 91/181)
2025-12-24 10:10:09 INFO Epoch 055 | 75% complete (batch 136/181)
2025-12-24 10:10:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.617607
2025-12-24 10:10:23 INFO Tuning ranking metrics: regret=0.107002 spearman=0.141431 (groups=34, skipped=318)
2025-12-24 10:10:23 INFO Epoch 055 | train_mse=0.071056 | val_loss=0.090615 | best_val_loss=0.145938
2025-12-24 10:10:32 INFO Epoch 056 | 25% complete (batch 46/181)
2025-12-24 10:10:33 INFO Epoch 056 | 50% complete (batch 91/181)
2025-12-24 10:10:34 INFO Epoch 056 | 75% complete (batch 136/181)
2025-12-24 10:10:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.599304
2025-12-24 10:10:48 INFO Tuning ranking metrics: regret=0.111061 spearman=0.087554 (groups=34, skipped=318)
2025-12-24 10:10:48 INFO Epoch 056 | train_mse=0.074860 | val_loss=0.085310 | best_val_loss=0.145938
2025-12-24 10:10:57 INFO Epoch 057 | 25% complete (batch 46/181)
2025-12-24 10:10:58 INFO Epoch 057 | 50% complete (batch 91/181)
2025-12-24 10:10:59 INFO Epoch 057 | 75% complete (batch 136/181)
2025-12-24 10:11:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.628283
2025-12-24 10:11:14 INFO Tuning ranking metrics: regret=0.097751 spearman=0.117520 (groups=34, skipped=318)
2025-12-24 10:11:14 INFO Epoch 057 | train_mse=0.090295 | val_loss=0.067849 | best_val_loss=0.145938
2025-12-24 10:11:23 INFO Epoch 058 | 25% complete (batch 46/181)
2025-12-24 10:11:24 INFO Epoch 058 | 50% complete (batch 91/181)
2025-12-24 10:11:25 INFO Epoch 058 | 75% complete (batch 136/181)
2025-12-24 10:11:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.634932
2025-12-24 10:11:39 INFO Tuning ranking metrics: regret=0.096020 spearman=0.103425 (groups=34, skipped=318)
2025-12-24 10:11:39 INFO Epoch 058 | train_mse=0.079334 | val_loss=0.065879 | best_val_loss=0.145938
2025-12-24 10:11:48 INFO Epoch 059 | 25% complete (batch 46/181)
2025-12-24 10:11:49 INFO Epoch 059 | 50% complete (batch 91/181)
2025-12-24 10:11:50 INFO Epoch 059 | 75% complete (batch 136/181)
2025-12-24 10:11:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.638154
2025-12-24 10:12:04 INFO Tuning ranking metrics: regret=0.100855 spearman=0.072689 (groups=34, skipped=318)
2025-12-24 10:12:04 INFO Epoch 059 | train_mse=0.082495 | val_loss=0.066882 | best_val_loss=0.145938
2025-12-24 10:12:13 INFO Epoch 060 | 25% complete (batch 46/181)
2025-12-24 10:12:14 INFO Epoch 060 | 50% complete (batch 91/181)
2025-12-24 10:12:15 INFO Epoch 060 | 75% complete (batch 136/181)
2025-12-24 10:12:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.636240
2025-12-24 10:12:30 INFO Tuning ranking metrics: regret=0.116554 spearman=0.041418 (groups=34, skipped=318)
2025-12-24 10:12:30 INFO Epoch 060 | train_mse=0.062429 | val_loss=0.072334 | best_val_loss=0.145938
2025-12-24 10:12:39 INFO Epoch 061 | 25% complete (batch 46/181)
2025-12-24 10:12:40 INFO Epoch 061 | 50% complete (batch 91/181)
2025-12-24 10:12:41 INFO Epoch 061 | 75% complete (batch 136/181)
2025-12-24 10:12:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.622889
2025-12-24 10:12:55 INFO Tuning ranking metrics: regret=0.111852 spearman=0.090514 (groups=34, skipped=318)
2025-12-24 10:12:55 INFO Epoch 061 | train_mse=0.066533 | val_loss=0.084410 | best_val_loss=0.145938
2025-12-24 10:13:04 INFO Epoch 062 | 25% complete (batch 46/181)
2025-12-24 10:13:05 INFO Epoch 062 | 50% complete (batch 91/181)
2025-12-24 10:13:06 INFO Epoch 062 | 75% complete (batch 136/181)
2025-12-24 10:13:15 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.621572
2025-12-24 10:13:21 INFO Tuning ranking metrics: regret=0.113037 spearman=0.085676 (groups=34, skipped=318)
2025-12-24 10:13:21 INFO Epoch 062 | train_mse=0.068126 | val_loss=0.069916 | best_val_loss=0.145938
2025-12-24 10:13:30 INFO Epoch 063 | 25% complete (batch 46/181)
2025-12-24 10:13:31 INFO Epoch 063 | 50% complete (batch 91/181)
2025-12-24 10:13:32 INFO Epoch 063 | 75% complete (batch 136/181)
2025-12-24 10:13:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.642799
2025-12-24 10:13:47 INFO Tuning ranking metrics: regret=0.091660 spearman=0.165069 (groups=34, skipped=318)
2025-12-24 10:13:47 INFO Epoch 063 | train_mse=0.058119 | val_loss=0.063378 | best_val_loss=0.145938
Metric tuning_rank_spearman improved by 0.019 >= min_delta = 0.0. New best score: 0.165
2025-12-24 10:13:56 INFO Epoch 064 | 25% complete (batch 46/181)
2025-12-24 10:13:57 INFO Epoch 064 | 50% complete (batch 91/181)
2025-12-24 10:13:58 INFO Epoch 064 | 75% complete (batch 136/181)
2025-12-24 10:14:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.643268
2025-12-24 10:14:12 INFO Tuning ranking metrics: regret=0.091545 spearman=0.178209 (groups=34, skipped=318)
2025-12-24 10:14:12 INFO Epoch 064 | train_mse=0.066034 | val_loss=0.062925 | best_val_loss=0.165069
Metric tuning_rank_spearman improved by 0.013 >= min_delta = 0.0. New best score: 0.178
2025-12-24 10:14:21 INFO Epoch 065 | 25% complete (batch 46/181)
2025-12-24 10:14:22 INFO Epoch 065 | 50% complete (batch 91/181)
2025-12-24 10:14:23 INFO Epoch 065 | 75% complete (batch 136/181)
2025-12-24 10:14:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.642769
2025-12-24 10:14:38 INFO Tuning ranking metrics: regret=0.091545 spearman=0.180112 (groups=34, skipped=318)
2025-12-24 10:14:38 INFO Epoch 065 | train_mse=0.050991 | val_loss=0.063206 | best_val_loss=0.178209
Metric tuning_rank_spearman improved by 0.002 >= min_delta = 0.0. New best score: 0.180
2025-12-24 10:14:47 INFO Epoch 066 | 25% complete (batch 46/181)
2025-12-24 10:14:48 INFO Epoch 066 | 50% complete (batch 91/181)
2025-12-24 10:14:49 INFO Epoch 066 | 75% complete (batch 136/181)
2025-12-24 10:14:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.651437
2025-12-24 10:15:04 INFO Tuning ranking metrics: regret=0.098119 spearman=0.174300 (groups=34, skipped=318)
2025-12-24 10:15:04 INFO Epoch 066 | train_mse=0.053840 | val_loss=0.063290 | best_val_loss=0.180112
2025-12-24 10:15:13 INFO Epoch 067 | 25% complete (batch 46/181)
2025-12-24 10:15:14 INFO Epoch 067 | 50% complete (batch 91/181)
2025-12-24 10:15:15 INFO Epoch 067 | 75% complete (batch 136/181)
2025-12-24 10:15:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.651437
2025-12-24 10:15:30 INFO Tuning ranking metrics: regret=0.098119 spearman=0.152158 (groups=34, skipped=318)
2025-12-24 10:15:30 INFO Epoch 067 | train_mse=0.074549 | val_loss=0.062117 | best_val_loss=0.180112
2025-12-24 10:15:39 INFO Epoch 068 | 25% complete (batch 46/181)
2025-12-24 10:15:40 INFO Epoch 068 | 50% complete (batch 91/181)
2025-12-24 10:15:41 INFO Epoch 068 | 75% complete (batch 136/181)
2025-12-24 10:15:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.646679
2025-12-24 10:15:56 INFO Tuning ranking metrics: regret=0.118460 spearman=0.074064 (groups=34, skipped=318)
2025-12-24 10:15:56 INFO Epoch 068 | train_mse=0.078006 | val_loss=0.066875 | best_val_loss=0.180112
2025-12-24 10:16:05 INFO Epoch 069 | 25% complete (batch 46/181)
2025-12-24 10:16:06 INFO Epoch 069 | 50% complete (batch 91/181)
2025-12-24 10:16:07 INFO Epoch 069 | 75% complete (batch 136/181)
2025-12-24 10:16:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.646544
2025-12-24 10:16:22 INFO Tuning ranking metrics: regret=0.106484 spearman=0.089814 (groups=34, skipped=318)
2025-12-24 10:16:22 INFO Epoch 069 | train_mse=0.058129 | val_loss=0.063136 | best_val_loss=0.180112
2025-12-24 10:16:31 INFO Epoch 070 | 25% complete (batch 46/181)
2025-12-24 10:16:32 INFO Epoch 070 | 50% complete (batch 91/181)
2025-12-24 10:16:33 INFO Epoch 070 | 75% complete (batch 136/181)
2025-12-24 10:16:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.662766
2025-12-24 10:16:48 INFO Tuning ranking metrics: regret=0.104312 spearman=0.080176 (groups=34, skipped=318)
2025-12-24 10:16:48 INFO Epoch 070 | train_mse=0.068222 | val_loss=0.062424 | best_val_loss=0.180112
2025-12-24 10:16:57 INFO Epoch 071 | 25% complete (batch 46/181)
2025-12-24 10:16:58 INFO Epoch 071 | 50% complete (batch 91/181)
2025-12-24 10:16:59 INFO Epoch 071 | 75% complete (batch 136/181)
2025-12-24 10:17:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.676369
2025-12-24 10:17:15 INFO Tuning ranking metrics: regret=0.117599 spearman=0.113464 (groups=34, skipped=318)
2025-12-24 10:17:15 INFO Epoch 071 | train_mse=0.067773 | val_loss=0.061296 | best_val_loss=0.180112
2025-12-24 10:17:23 INFO Epoch 072 | 25% complete (batch 46/181)
2025-12-24 10:17:24 INFO Epoch 072 | 50% complete (batch 91/181)
2025-12-24 10:17:25 INFO Epoch 072 | 75% complete (batch 136/181)
2025-12-24 10:17:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.664769
2025-12-24 10:17:40 INFO Tuning ranking metrics: regret=0.115795 spearman=0.023147 (groups=34, skipped=318)
2025-12-24 10:17:40 INFO Epoch 072 | train_mse=0.050008 | val_loss=0.064127 | best_val_loss=0.180112
2025-12-24 10:17:49 INFO Epoch 073 | 25% complete (batch 46/181)
2025-12-24 10:17:50 INFO Epoch 073 | 50% complete (batch 91/181)
2025-12-24 10:17:51 INFO Epoch 073 | 75% complete (batch 136/181)
2025-12-24 10:18:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.654021
2025-12-24 10:18:06 INFO Tuning ranking metrics: regret=0.111737 spearman=0.083531 (groups=34, skipped=318)
2025-12-24 10:18:06 INFO Epoch 073 | train_mse=0.057285 | val_loss=0.062199 | best_val_loss=0.180112
2025-12-24 10:18:15 INFO Epoch 074 | 25% complete (batch 46/181)
2025-12-24 10:18:16 INFO Epoch 074 | 50% complete (batch 91/181)
2025-12-24 10:18:17 INFO Epoch 074 | 75% complete (batch 136/181)
2025-12-24 10:18:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.659469
2025-12-24 10:18:32 INFO Tuning ranking metrics: regret=0.111737 spearman=0.102769 (groups=34, skipped=318)
2025-12-24 10:18:32 INFO Epoch 074 | train_mse=0.062454 | val_loss=0.062402 | best_val_loss=0.180112
2025-12-24 10:18:41 INFO Epoch 075 | 25% complete (batch 46/181)
2025-12-24 10:18:42 INFO Epoch 075 | 50% complete (batch 91/181)
2025-12-24 10:18:43 INFO Epoch 075 | 75% complete (batch 136/181)
2025-12-24 10:18:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.662550
2025-12-24 10:18:58 INFO Tuning ranking metrics: regret=0.112921 spearman=0.113713 (groups=34, skipped=318)
2025-12-24 10:18:58 INFO Epoch 075 | train_mse=0.059314 | val_loss=0.063043 | best_val_loss=0.180112
2025-12-24 10:19:07 INFO Epoch 076 | 25% complete (batch 46/181)
2025-12-24 10:19:08 INFO Epoch 076 | 50% complete (batch 91/181)
2025-12-24 10:19:09 INFO Epoch 076 | 75% complete (batch 136/181)
2025-12-24 10:19:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.670275
2025-12-24 10:19:24 INFO Tuning ranking metrics: regret=0.097221 spearman=0.124866 (groups=34, skipped=318)
2025-12-24 10:19:24 INFO Epoch 076 | train_mse=0.062036 | val_loss=0.060767 | best_val_loss=0.180112
2025-12-24 10:19:33 INFO Epoch 077 | 25% complete (batch 46/181)
2025-12-24 10:19:33 INFO Epoch 077 | 50% complete (batch 91/181)
2025-12-24 10:19:34 INFO Epoch 077 | 75% complete (batch 136/181)
2025-12-24 10:19:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.664940
2025-12-24 10:19:49 INFO Tuning ranking metrics: regret=0.111737 spearman=0.118564 (groups=34, skipped=318)
2025-12-24 10:19:49 INFO Epoch 077 | train_mse=0.049036 | val_loss=0.064962 | best_val_loss=0.180112
2025-12-24 10:19:59 INFO Epoch 078 | 25% complete (batch 46/181)
2025-12-24 10:20:00 INFO Epoch 078 | 50% complete (batch 91/181)
2025-12-24 10:20:02 INFO Epoch 078 | 75% complete (batch 136/181)
2025-12-24 10:20:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.649685
2025-12-24 10:20:17 INFO Tuning ranking metrics: regret=0.091545 spearman=0.168481 (groups=34, skipped=318)
2025-12-24 10:20:17 INFO Epoch 078 | train_mse=0.061293 | val_loss=0.078708 | best_val_loss=0.180112
2025-12-24 10:20:26 INFO Epoch 079 | 25% complete (batch 46/181)
2025-12-24 10:20:28 INFO Epoch 079 | 50% complete (batch 91/181)
2025-12-24 10:20:29 INFO Epoch 079 | 75% complete (batch 136/181)
2025-12-24 10:20:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.662308
2025-12-24 10:20:44 INFO Tuning ranking metrics: regret=0.096306 spearman=0.123173 (groups=34, skipped=318)
2025-12-24 10:20:44 INFO Epoch 079 | train_mse=0.064965 | val_loss=0.068718 | best_val_loss=0.180112
2025-12-24 10:20:53 INFO Epoch 080 | 25% complete (batch 46/181)
2025-12-24 10:20:54 INFO Epoch 080 | 50% complete (batch 91/181)
2025-12-24 10:20:55 INFO Epoch 080 | 75% complete (batch 136/181)
2025-12-24 10:21:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.662611
2025-12-24 10:21:11 INFO Tuning ranking metrics: regret=0.097221 spearman=0.116679 (groups=34, skipped=318)
2025-12-24 10:21:11 INFO Epoch 080 | train_mse=0.058747 | val_loss=0.062965 | best_val_loss=0.180112
2025-12-24 10:21:20 INFO Epoch 081 | 25% complete (batch 46/181)
2025-12-24 10:21:22 INFO Epoch 081 | 50% complete (batch 91/181)
2025-12-24 10:21:23 INFO Epoch 081 | 75% complete (batch 136/181)
2025-12-24 10:21:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.662861
2025-12-24 10:21:38 INFO Tuning ranking metrics: regret=0.106660 spearman=0.077394 (groups=34, skipped=318)
2025-12-24 10:21:38 INFO Epoch 081 | train_mse=0.080675 | val_loss=0.063034 | best_val_loss=0.180112
2025-12-24 10:21:47 INFO Epoch 082 | 25% complete (batch 46/181)
2025-12-24 10:21:48 INFO Epoch 082 | 50% complete (batch 91/181)
2025-12-24 10:21:49 INFO Epoch 082 | 75% complete (batch 136/181)
2025-12-24 10:21:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.656921
2025-12-24 10:22:03 INFO Tuning ranking metrics: regret=0.096027 spearman=0.140330 (groups=34, skipped=318)
2025-12-24 10:22:03 INFO Epoch 082 | train_mse=0.062037 | val_loss=0.064078 | best_val_loss=0.180112
2025-12-24 10:22:13 INFO Epoch 083 | 25% complete (batch 46/181)
2025-12-24 10:22:14 INFO Epoch 083 | 50% complete (batch 91/181)
2025-12-24 10:22:15 INFO Epoch 083 | 75% complete (batch 136/181)
2025-12-24 10:22:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.651840
2025-12-24 10:22:31 INFO Tuning ranking metrics: regret=0.111494 spearman=0.078062 (groups=34, skipped=318)
2025-12-24 10:22:31 INFO Epoch 083 | train_mse=0.064000 | val_loss=0.071522 | best_val_loss=0.180112
2025-12-24 10:22:40 INFO Epoch 084 | 25% complete (batch 46/181)
2025-12-24 10:22:41 INFO Epoch 084 | 50% complete (batch 91/181)
2025-12-24 10:22:42 INFO Epoch 084 | 75% complete (batch 136/181)
2025-12-24 10:22:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.643412
2025-12-24 10:22:57 INFO Tuning ranking metrics: regret=0.097221 spearman=0.117412 (groups=34, skipped=318)
2025-12-24 10:22:57 INFO Epoch 084 | train_mse=0.053119 | val_loss=0.066654 | best_val_loss=0.180112
2025-12-24 10:23:06 INFO Epoch 085 | 25% complete (batch 46/181)
2025-12-24 10:23:07 INFO Epoch 085 | 50% complete (batch 91/181)
2025-12-24 10:23:07 INFO Epoch 085 | 75% complete (batch 136/181)
2025-12-24 10:23:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.659130
2025-12-24 10:23:22 INFO Tuning ranking metrics: regret=0.112921 spearman=0.107423 (groups=34, skipped=318)
2025-12-24 10:23:22 INFO Epoch 085 | train_mse=0.062611 | val_loss=0.062304 | best_val_loss=0.180112
2025-12-24 10:23:32 INFO Epoch 086 | 25% complete (batch 46/181)
2025-12-24 10:23:33 INFO Epoch 086 | 50% complete (batch 91/181)
2025-12-24 10:23:34 INFO Epoch 086 | 75% complete (batch 136/181)
2025-12-24 10:23:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.657664
2025-12-24 10:23:50 INFO Tuning ranking metrics: regret=0.112921 spearman=0.114381 (groups=34, skipped=318)
2025-12-24 10:23:50 INFO Epoch 086 | train_mse=0.062208 | val_loss=0.061842 | best_val_loss=0.180112
2025-12-24 10:23:59 INFO Epoch 087 | 25% complete (batch 46/181)
2025-12-24 10:24:00 INFO Epoch 087 | 50% complete (batch 91/181)
2025-12-24 10:24:01 INFO Epoch 087 | 75% complete (batch 136/181)
2025-12-24 10:24:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.658403
2025-12-24 10:24:16 INFO Tuning ranking metrics: regret=0.112921 spearman=0.114114 (groups=34, skipped=318)
2025-12-24 10:24:16 INFO Epoch 087 | train_mse=0.058138 | val_loss=0.061707 | best_val_loss=0.180112
2025-12-24 10:24:25 INFO Epoch 088 | 25% complete (batch 46/181)
2025-12-24 10:24:26 INFO Epoch 088 | 50% complete (batch 91/181)
2025-12-24 10:24:27 INFO Epoch 088 | 75% complete (batch 136/181)
2025-12-24 10:24:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.657087
2025-12-24 10:24:41 INFO Tuning ranking metrics: regret=0.096306 spearman=0.134989 (groups=34, skipped=318)
2025-12-24 10:24:41 INFO Epoch 088 | train_mse=0.055761 | val_loss=0.062788 | best_val_loss=0.180112
2025-12-24 10:24:50 INFO Epoch 089 | 25% complete (batch 46/181)
2025-12-24 10:24:51 INFO Epoch 089 | 50% complete (batch 91/181)
2025-12-24 10:24:53 INFO Epoch 089 | 75% complete (batch 136/181)
2025-12-24 10:25:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.657483
2025-12-24 10:25:07 INFO Tuning ranking metrics: regret=0.096306 spearman=0.132881 (groups=34, skipped=318)
2025-12-24 10:25:07 INFO Epoch 089 | train_mse=0.069151 | val_loss=0.061571 | best_val_loss=0.180112
Monitored metric tuning_rank_spearman did not improve in the last 24 records. Best score: 0.180. Signaling Trainer to stop.
2025-12-24 10:25:08 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.17430_val-0.06329_epoch066.chkpt, checkpoint.tuning_rank_spearman-0.17821_val-0.06292_epoch064.chkpt, checkpoint.tuning_rank_spearman-0.18011_val-0.06321_epoch065.chkpt
2025-12-24 10:25:08 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.18011_val-0.06321_epoch065.chkpt
2025-12-24 10:25:08 INFO Best validation loss: tensor(0.1801)
2025-12-24 10:25:08 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.18011_val-0.06321_epoch065.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.18011_val-0.06321_epoch065.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-24 10:25:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.063206
2025-12-24 10:25:22 INFO Tuning ranking metrics: regret=0.091545 spearman=0.180112 (groups=34, skipped=318)
2025-12-24 10:25:22 INFO Epoch 090 | val_loss=0.063206 | best_val_loss=0.180112
2025-12-24 10:25:22 INFO Validation metrics: [{'val_loss': 0.06320584565401077, 'tuning_rank_regret': 0.09154483675956726, 'tuning_rank_spearman': 0.1801120489835739, 'val_pearson_corr': 0.7510725259780884, 'val_spearman_corr': 0.7147276401519775, 'val_rank_regret': 0.0035356476437300444, 'val_rank_spearman': 0.6666666865348816}]
2025-12-24 10:25:22 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.18011_val-0.06321_epoch065.chkpt
2025-12-24 10:25:22 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.17821_val-0.06292_epoch064.chkpt
2025-12-24 10:25:22 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.17430_val-0.06329_epoch066.chkpt
2025-12-24 10:25:22 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.06292_epoch064.ckpt
2025-12-24 10:25:22 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.09154483675956726
  tuning_rank_spearman      0.1801120489835739
        val_loss            0.06320584565401077
    val_pearson_corr        0.7510725259780884
     val_rank_regret       0.0035356476437300444
    val_rank_spearman       0.6666666865348816
    val_spearman_corr       0.7147276401519775
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run sched_boost_lean_seed222_2025-12-24_09-03-53_phase1 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase1
[run_full_pipeline] Phase 1 best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.18011_val-0.06321_epoch065.chkpt (tuning_rank_spearman=0.1801120489835739)
[run_full_pipeline] Phase 2 fine-tuning (seed 101) -> sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed101
[train_cli] run_id=sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed101 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed101/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed101 --git-commit 9b1bb2b320 --git-dirty --resume-from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.18011_val-0.06321_epoch065.chkpt
2025-12-24 10:25:29 INFO git_commit = 9b1bb2b320 (dirty)
2025-12-24 10:25:29 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-24 10:25:29 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed101/config/config.yaml
2025-12-24 10:25:29 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data
2025-12-24 10:25:29 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-24 10:25:29 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-24 10:25:29 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed101
2025-12-24 10:25:29 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-24 10:25:29 INFO   metadata_path = None
2025-12-24 10:25:29 INFO   summary_path = None
2025-12-24 10:25:29 INFO   accelerator = cpu
2025-12-24 10:25:29 INFO   devices = 1
2025-12-24 10:25:29 INFO   attention_head = 8
2025-12-24 10:25:29 INFO   pooling_type = mean
2025-12-24 10:25:29 INFO   model_self_loops = False
2025-12-24 10:25:29 INFO   model_self_loop_fill = mean
2025-12-24 10:25:29 INFO   model_residual = False
2025-12-24 10:25:29 INFO   batch_size = 48
2025-12-24 10:25:29 INFO   learning_rate = 0.001
2025-12-24 10:25:29 INFO   num_epochs = 320
2025-12-24 10:25:29 INFO   accumulate_grad_batches = 8
2025-12-24 10:25:29 INFO   seed = 101
2025-12-24 10:25:29 INFO   num_workers = 2
2025-12-24 10:25:29 INFO   precision = 32
2025-12-24 10:25:29 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-24 10:25:29 INFO   early_stopping_patience = 20
2025-12-24 10:25:29 INFO   lr_scheduler_patience = 4
2025-12-24 10:25:29 INFO   lr_scheduler_factor = 0.2
2025-12-24 10:25:29 INFO   fast_dev_run = False
2025-12-24 10:25:29 INFO   limit_train_batches = None
2025-12-24 10:25:29 INFO   limit_val_batches = None
2025-12-24 10:25:29 INFO   log_lr = False
2025-12-24 10:25:29 INFO   progress_bar_refresh_rate = 0
2025-12-24 10:25:29 INFO   log_every_n_steps = 100
2025-12-24 10:25:29 INFO   use_val_spearman_as_secondary = True
2025-12-24 10:25:29 INFO   spearman_secondary_min_delta = 0.0
2025-12-24 10:25:29 INFO   spearman_secondary_weight = 1.0
2025-12-24 10:25:29 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-24 10:25:29 INFO   tuning_max_samples = 500
2025-12-24 10:25:29 INFO   tuning_fraction = None
2025-12-24 10:25:29 INFO   tuning_eval_every = 1
2025-12-24 10:25:29 INFO   rank_loss_weight = 0.0
2025-12-24 10:25:29 INFO   rank_loss_margin = 0.0
2025-12-24 10:25:29 INFO   rank_loss_mode = hinge
2025-12-24 10:25:29 INFO   rank_loss_grouped = True
2025-12-24 10:25:29 INFO   variance_reduction_enabled = False
2025-12-24 10:25:29 INFO   variance_reduction_method = topk_avg
2025-12-24 10:25:29 INFO   variance_reduction_top_k = 3
2025-12-24 10:25:29 INFO   coverage_minimum = 0.0
2025-12-24 10:25:29 INFO   coverage_fail_on_missing = False
2025-12-24 10:25:29 INFO   graph_load_profiling = False
2025-12-24 10:25:29 INFO   graph_load_top_k = 5
2025-12-24 10:25:29 INFO   enable_graph_cache = True
2025-12-24 10:25:29 INFO   graph_cache_size = 256
2025-12-24 10:25:29 INFO   canonicalize_on_load = False
2025-12-24 10:25:29 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-24 10:25:29 INFO   edge_schema = {}
2025-12-24 10:25:29 INFO   topology_schema = {}
Seed set to 101
2025-12-24 10:25:30 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-24 10:25:30 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 10:25:30 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-24 10:25:30 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 10:25:30 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-24 10:25:30 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 10:25:32 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-24 10:25:32 INFO Tuning group stats: groups=348 groups>=2=37 singletons=311 max_group=11
2025-12-24 10:25:32 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed101/dataset_coverage.json
2025-12-24 10:25:32 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed101/dataset_coverage.json for details.
2025-12-24 10:25:32 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed101/dataset_coverage.json for details.
2025-12-24 10:25:32 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed101/dataset_coverage.json for details.
2025-12-24 10:25:32 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed101/schema_summary.json
2025-12-24 10:25:32 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed101/feature_metadata.json
2025-12-24 10:25:32 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-24 10:25:32 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/advanced_k_partite_v2/feature-config.yaml.advanced_lean.10A.v2, sha256=2022a36e7b21668173af3af66c25cf6b6a0494e642c0934eac38abbcfeebec3d
2025-12-24 10:25:32 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/work/edge_features)
2025-12-24 10:25:32 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json
2025-12-24 10:25:32 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed101/schema_summary.json
2025-12-24 10:25:32 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-24 10:25:32 INFO Topology: topology/persistence_k_partite_advanced/v2 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 628-dimensional node features.
2025-12-24 10:25:32 INFO Node: node/dssp_topo_merge_passthrough/v1; metadata lists 628 feature columns matching the .pt tensor.
2025-12-24 10:25:32 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-24 10:25:32 INFO → Total feature dimensionality observed and confirmed: node_dim = 628, edge_dim = 11.
2025-12-24 10:25:32 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-24 10:25:32 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 628,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge_passthrough/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 628,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed101/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge_passthrough/v1",
      "alias": "Passthrough (all dims from topology module) = Node Dynamic Dims",
      "jobs": 16,
      "summary": "DSSP/basic features merged with all topology columns (passthrough)."
    },
    "topology": {
      "id": "topology/persistence_k_partite_advanced/v2",
      "alias": "Advanced k-partite PH (v2 lean) topo_dim 596",
      "jobs": 16,
      "summary": "Fixed-width k-partite persistent homology with slot padding + missingness channels."
    }
  },
  "notes": []
}
2025-12-24 10:25:32 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-24 10:25:32 INFO Resuming from checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.18011_val-0.06321_epoch065.chkpt (epoch=65)
2025-12-24 10:25:33 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=975350025d1f4ac6966643a7bd68649f)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-24 10:25:33 INFO Starting training (fast_dev_run=False)
2025-12-24 10:25:33 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed101/model_checkpoints exists and is not empty.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.18011_val-0.06321_epoch065.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase1/model_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed101/model_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase1/model_checkpoints/val_loss_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed101/model_checkpoints/val_loss_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 20.1 K | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
180 K     Trainable params
0         Non-trainable params
180 K     Total params
0.721     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
Restored all states from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.18011_val-0.06321_epoch065.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-24 10:25:48 INFO Epoch 066 | 25% complete (batch 46/181)
2025-12-24 10:25:49 INFO Epoch 066 | 50% complete (batch 91/181)
2025-12-24 10:25:50 INFO Epoch 066 | 75% complete (batch 136/181)
2025-12-24 10:25:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.062822
2025-12-24 10:26:04 INFO Tuning ranking metrics: regret=0.148199 spearman=0.182310 (groups=37, skipped=311)
2025-12-24 10:26:04 INFO Epoch 066 | val_loss=0.062822
Metric tuning_rank_spearman improved by 0.002 >= min_delta = 0.0. New best score: 0.182
2025-12-24 10:26:12 INFO Epoch 067 | 25% complete (batch 46/181)
2025-12-24 10:26:13 INFO Epoch 067 | 50% complete (batch 91/181)
2025-12-24 10:26:14 INFO Epoch 067 | 75% complete (batch 136/181)
2025-12-24 10:26:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.640012
2025-12-24 10:26:28 INFO Tuning ranking metrics: regret=0.130723 spearman=0.193857 (groups=37, skipped=311)
2025-12-24 10:26:28 INFO Epoch 067 | train_mse=0.075448 | val_loss=0.067238 | best_val_loss=0.182310
Metric tuning_rank_spearman improved by 0.012 >= min_delta = 0.0. New best score: 0.194
2025-12-24 10:26:37 INFO Epoch 068 | 25% complete (batch 46/181)
2025-12-24 10:26:38 INFO Epoch 068 | 50% complete (batch 91/181)
2025-12-24 10:26:38 INFO Epoch 068 | 75% complete (batch 136/181)
2025-12-24 10:26:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.624128
2025-12-24 10:26:52 INFO Tuning ranking metrics: regret=0.133166 spearman=0.183129 (groups=37, skipped=311)
2025-12-24 10:26:52 INFO Epoch 068 | train_mse=0.061621 | val_loss=0.096384 | best_val_loss=0.193857
2025-12-24 10:27:01 INFO Epoch 069 | 25% complete (batch 46/181)
2025-12-24 10:27:02 INFO Epoch 069 | 50% complete (batch 91/181)
2025-12-24 10:27:03 INFO Epoch 069 | 75% complete (batch 136/181)
2025-12-24 10:27:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.638238
2025-12-24 10:27:17 INFO Tuning ranking metrics: regret=0.148199 spearman=0.194653 (groups=37, skipped=311)
2025-12-24 10:27:17 INFO Epoch 069 | train_mse=0.053744 | val_loss=0.067502 | best_val_loss=0.193857
Metric tuning_rank_spearman improved by 0.001 >= min_delta = 0.0. New best score: 0.195
2025-12-24 10:27:25 INFO Epoch 070 | 25% complete (batch 46/181)
2025-12-24 10:27:26 INFO Epoch 070 | 50% complete (batch 91/181)
2025-12-24 10:27:27 INFO Epoch 070 | 75% complete (batch 136/181)
2025-12-24 10:27:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.653626
2025-12-24 10:27:41 INFO Tuning ranking metrics: regret=0.130723 spearman=0.187130 (groups=37, skipped=311)
2025-12-24 10:27:41 INFO Epoch 070 | train_mse=0.079782 | val_loss=0.063399 | best_val_loss=0.194653
2025-12-24 10:27:50 INFO Epoch 071 | 25% complete (batch 46/181)
2025-12-24 10:27:51 INFO Epoch 071 | 50% complete (batch 91/181)
2025-12-24 10:27:52 INFO Epoch 071 | 75% complete (batch 136/181)
2025-12-24 10:28:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.644790
2025-12-24 10:28:05 INFO Tuning ranking metrics: regret=0.130639 spearman=0.221165 (groups=37, skipped=311)
2025-12-24 10:28:05 INFO Epoch 071 | train_mse=0.046515 | val_loss=0.069787 | best_val_loss=0.194653
Metric tuning_rank_spearman improved by 0.027 >= min_delta = 0.0. New best score: 0.221
2025-12-24 10:28:14 INFO Epoch 072 | 25% complete (batch 46/181)
2025-12-24 10:28:15 INFO Epoch 072 | 50% complete (batch 91/181)
2025-12-24 10:28:16 INFO Epoch 072 | 75% complete (batch 136/181)
2025-12-24 10:28:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.658380
2025-12-24 10:28:30 INFO Tuning ranking metrics: regret=0.148199 spearman=0.184544 (groups=37, skipped=311)
2025-12-24 10:28:30 INFO Epoch 072 | train_mse=0.062922 | val_loss=0.062938 | best_val_loss=0.221165
2025-12-24 10:28:38 INFO Epoch 073 | 25% complete (batch 46/181)
2025-12-24 10:28:39 INFO Epoch 073 | 50% complete (batch 91/181)
2025-12-24 10:28:40 INFO Epoch 073 | 75% complete (batch 136/181)
2025-12-24 10:28:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.659211
2025-12-24 10:28:54 INFO Tuning ranking metrics: regret=0.115968 spearman=0.229197 (groups=37, skipped=311)
2025-12-24 10:28:54 INFO Epoch 073 | train_mse=0.054139 | val_loss=0.063482 | best_val_loss=0.221165
Metric tuning_rank_spearman improved by 0.008 >= min_delta = 0.0. New best score: 0.229
2025-12-24 10:29:03 INFO Epoch 074 | 25% complete (batch 46/181)
2025-12-24 10:29:04 INFO Epoch 074 | 50% complete (batch 91/181)
2025-12-24 10:29:05 INFO Epoch 074 | 75% complete (batch 136/181)
2025-12-24 10:29:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.660023
2025-12-24 10:29:20 INFO Tuning ranking metrics: regret=0.131248 spearman=0.246882 (groups=37, skipped=311)
2025-12-24 10:29:20 INFO Epoch 074 | train_mse=0.069489 | val_loss=0.062266 | best_val_loss=0.229197
Metric tuning_rank_spearman improved by 0.018 >= min_delta = 0.0. New best score: 0.247
2025-12-24 10:29:29 INFO Epoch 075 | 25% complete (batch 46/181)
2025-12-24 10:29:30 INFO Epoch 075 | 50% complete (batch 91/181)
2025-12-24 10:29:31 INFO Epoch 075 | 75% complete (batch 136/181)
2025-12-24 10:29:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.650000
2025-12-24 10:29:45 INFO Tuning ranking metrics: regret=0.131408 spearman=0.257172 (groups=37, skipped=311)
2025-12-24 10:29:45 INFO Epoch 075 | train_mse=0.049645 | val_loss=0.074503 | best_val_loss=0.246882
Metric tuning_rank_spearman improved by 0.010 >= min_delta = 0.0. New best score: 0.257
2025-12-24 10:29:53 INFO Epoch 076 | 25% complete (batch 46/181)
2025-12-24 10:29:54 INFO Epoch 076 | 50% complete (batch 91/181)
2025-12-24 10:29:55 INFO Epoch 076 | 75% complete (batch 136/181)
2025-12-24 10:30:04 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.662758
2025-12-24 10:30:09 INFO Tuning ranking metrics: regret=0.115968 spearman=0.254721 (groups=37, skipped=311)
2025-12-24 10:30:09 INFO Epoch 076 | train_mse=0.060116 | val_loss=0.062718 | best_val_loss=0.257172
2025-12-24 10:30:18 INFO Epoch 077 | 25% complete (batch 46/181)
2025-12-24 10:30:19 INFO Epoch 077 | 50% complete (batch 91/181)
2025-12-24 10:30:20 INFO Epoch 077 | 75% complete (batch 136/181)
2025-12-24 10:30:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.663807
2025-12-24 10:30:34 INFO Tuning ranking metrics: regret=0.131248 spearman=0.250105 (groups=37, skipped=311)
2025-12-24 10:30:34 INFO Epoch 077 | train_mse=0.066506 | val_loss=0.061383 | best_val_loss=0.257172
2025-12-24 10:30:43 INFO Epoch 078 | 25% complete (batch 46/181)
2025-12-24 10:30:44 INFO Epoch 078 | 50% complete (batch 91/181)
2025-12-24 10:30:45 INFO Epoch 078 | 75% complete (batch 136/181)
2025-12-24 10:30:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.662234
2025-12-24 10:30:59 INFO Tuning ranking metrics: regret=0.131408 spearman=0.242114 (groups=37, skipped=311)
2025-12-24 10:30:59 INFO Epoch 078 | train_mse=0.056536 | val_loss=0.062940 | best_val_loss=0.257172
2025-12-24 10:31:08 INFO Epoch 079 | 25% complete (batch 46/181)
2025-12-24 10:31:09 INFO Epoch 079 | 50% complete (batch 91/181)
2025-12-24 10:31:10 INFO Epoch 079 | 75% complete (batch 136/181)
2025-12-24 10:31:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.662856
2025-12-24 10:31:25 INFO Tuning ranking metrics: regret=0.128089 spearman=0.243834 (groups=37, skipped=311)
2025-12-24 10:31:25 INFO Epoch 079 | train_mse=0.049693 | val_loss=0.061915 | best_val_loss=0.257172
2025-12-24 10:31:34 INFO Epoch 080 | 25% complete (batch 46/181)
2025-12-24 10:31:35 INFO Epoch 080 | 50% complete (batch 91/181)
2025-12-24 10:31:36 INFO Epoch 080 | 75% complete (batch 136/181)
2025-12-24 10:31:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.662755
2025-12-24 10:31:49 INFO Tuning ranking metrics: regret=0.128089 spearman=0.244080 (groups=37, skipped=311)
2025-12-24 10:31:49 INFO Epoch 080 | train_mse=0.053795 | val_loss=0.062453 | best_val_loss=0.257172
2025-12-24 10:31:58 INFO Epoch 081 | 25% complete (batch 46/181)
2025-12-24 10:32:00 INFO Epoch 081 | 50% complete (batch 91/181)
2025-12-24 10:32:01 INFO Epoch 081 | 75% complete (batch 136/181)
2025-12-24 10:32:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.660898
2025-12-24 10:32:15 INFO Tuning ranking metrics: regret=0.117865 spearman=0.180221 (groups=37, skipped=311)
2025-12-24 10:32:15 INFO Epoch 081 | train_mse=0.052048 | val_loss=0.064124 | best_val_loss=0.257172
2025-12-24 10:32:24 INFO Epoch 082 | 25% complete (batch 46/181)
2025-12-24 10:32:25 INFO Epoch 082 | 50% complete (batch 91/181)
2025-12-24 10:32:26 INFO Epoch 082 | 75% complete (batch 136/181)
2025-12-24 10:32:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.657048
2025-12-24 10:32:40 INFO Tuning ranking metrics: regret=0.128089 spearman=0.244735 (groups=37, skipped=311)
2025-12-24 10:32:40 INFO Epoch 082 | train_mse=0.057651 | val_loss=0.063062 | best_val_loss=0.257172
2025-12-24 10:32:48 INFO Epoch 083 | 25% complete (batch 46/181)
2025-12-24 10:32:49 INFO Epoch 083 | 50% complete (batch 91/181)
2025-12-24 10:32:50 INFO Epoch 083 | 75% complete (batch 136/181)
2025-12-24 10:32:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.662047
2025-12-24 10:33:05 INFO Tuning ranking metrics: regret=0.128089 spearman=0.238136 (groups=37, skipped=311)
2025-12-24 10:33:05 INFO Epoch 083 | train_mse=0.055268 | val_loss=0.062037 | best_val_loss=0.257172
2025-12-24 10:33:13 INFO Epoch 084 | 25% complete (batch 46/181)
2025-12-24 10:33:14 INFO Epoch 084 | 50% complete (batch 91/181)
2025-12-24 10:33:15 INFO Epoch 084 | 75% complete (batch 136/181)
2025-12-24 10:33:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.660744
2025-12-24 10:33:29 INFO Tuning ranking metrics: regret=0.128089 spearman=0.236334 (groups=37, skipped=311)
2025-12-24 10:33:29 INFO Epoch 084 | train_mse=0.044337 | val_loss=0.062719 | best_val_loss=0.257172
2025-12-24 10:33:38 INFO Epoch 085 | 25% complete (batch 46/181)
2025-12-24 10:33:39 INFO Epoch 085 | 50% complete (batch 91/181)
2025-12-24 10:33:40 INFO Epoch 085 | 75% complete (batch 136/181)
2025-12-24 10:33:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.660069
2025-12-24 10:33:54 INFO Tuning ranking metrics: regret=0.128089 spearman=0.236334 (groups=37, skipped=311)
2025-12-24 10:33:54 INFO Epoch 085 | train_mse=0.044988 | val_loss=0.062388 | best_val_loss=0.257172
2025-12-24 10:34:03 INFO Epoch 086 | 25% complete (batch 46/181)
2025-12-24 10:34:04 INFO Epoch 086 | 50% complete (batch 91/181)
2025-12-24 10:34:05 INFO Epoch 086 | 75% complete (batch 136/181)
2025-12-24 10:34:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.660467
2025-12-24 10:34:19 INFO Tuning ranking metrics: regret=0.128089 spearman=0.235369 (groups=37, skipped=311)
2025-12-24 10:34:19 INFO Epoch 086 | train_mse=0.044096 | val_loss=0.062293 | best_val_loss=0.257172
2025-12-24 10:34:27 INFO Epoch 087 | 25% complete (batch 46/181)
2025-12-24 10:34:28 INFO Epoch 087 | 50% complete (batch 91/181)
2025-12-24 10:34:29 INFO Epoch 087 | 75% complete (batch 136/181)
2025-12-24 10:34:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.662885
2025-12-24 10:34:44 INFO Tuning ranking metrics: regret=0.128089 spearman=0.221856 (groups=37, skipped=311)
2025-12-24 10:34:44 INFO Epoch 087 | train_mse=0.070171 | val_loss=0.061618 | best_val_loss=0.257172
2025-12-24 10:34:52 INFO Epoch 088 | 25% complete (batch 46/181)
2025-12-24 10:34:53 INFO Epoch 088 | 50% complete (batch 91/181)
2025-12-24 10:34:54 INFO Epoch 088 | 75% complete (batch 136/181)
2025-12-24 10:35:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.661172
2025-12-24 10:35:08 INFO Tuning ranking metrics: regret=0.133305 spearman=0.167181 (groups=37, skipped=311)
2025-12-24 10:35:08 INFO Epoch 088 | train_mse=0.053606 | val_loss=0.061520 | best_val_loss=0.257172
2025-12-24 10:35:17 INFO Epoch 089 | 25% complete (batch 46/181)
2025-12-24 10:35:18 INFO Epoch 089 | 50% complete (batch 91/181)
2025-12-24 10:35:19 INFO Epoch 089 | 75% complete (batch 136/181)
2025-12-24 10:35:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.661955
2025-12-24 10:35:33 INFO Tuning ranking metrics: regret=0.128089 spearman=0.225097 (groups=37, skipped=311)
2025-12-24 10:35:33 INFO Epoch 089 | train_mse=0.046918 | val_loss=0.061978 | best_val_loss=0.257172
2025-12-24 10:35:42 INFO Epoch 090 | 25% complete (batch 46/181)
2025-12-24 10:35:42 INFO Epoch 090 | 50% complete (batch 91/181)
2025-12-24 10:35:43 INFO Epoch 090 | 75% complete (batch 136/181)
2025-12-24 10:35:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.660353
2025-12-24 10:35:58 INFO Tuning ranking metrics: regret=0.128089 spearman=0.236334 (groups=37, skipped=311)
2025-12-24 10:35:58 INFO Epoch 090 | train_mse=0.061703 | val_loss=0.063077 | best_val_loss=0.257172
2025-12-24 10:36:06 INFO Epoch 091 | 25% complete (batch 46/181)
2025-12-24 10:36:07 INFO Epoch 091 | 50% complete (batch 91/181)
2025-12-24 10:36:08 INFO Epoch 091 | 75% complete (batch 136/181)
2025-12-24 10:36:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.659961
2025-12-24 10:36:22 INFO Tuning ranking metrics: regret=0.128089 spearman=0.235047 (groups=37, skipped=311)
2025-12-24 10:36:22 INFO Epoch 091 | train_mse=0.060141 | val_loss=0.063067 | best_val_loss=0.257172
2025-12-24 10:36:31 INFO Epoch 092 | 25% complete (batch 46/181)
2025-12-24 10:36:32 INFO Epoch 092 | 50% complete (batch 91/181)
2025-12-24 10:36:33 INFO Epoch 092 | 75% complete (batch 136/181)
2025-12-24 10:36:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.661693
2025-12-24 10:36:47 INFO Tuning ranking metrics: regret=0.128089 spearman=0.235047 (groups=37, skipped=311)
2025-12-24 10:36:47 INFO Epoch 092 | train_mse=0.055280 | val_loss=0.062675 | best_val_loss=0.257172
2025-12-24 10:36:56 INFO Epoch 093 | 25% complete (batch 46/181)
2025-12-24 10:36:57 INFO Epoch 093 | 50% complete (batch 91/181)
2025-12-24 10:36:59 INFO Epoch 093 | 75% complete (batch 136/181)
2025-12-24 10:37:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.662199
2025-12-24 10:37:13 INFO Tuning ranking metrics: regret=0.128089 spearman=0.222821 (groups=37, skipped=311)
2025-12-24 10:37:13 INFO Epoch 093 | train_mse=0.061093 | val_loss=0.062304 | best_val_loss=0.257172
2025-12-24 10:37:22 INFO Epoch 094 | 25% complete (batch 46/181)
2025-12-24 10:37:22 INFO Epoch 094 | 50% complete (batch 91/181)
2025-12-24 10:37:23 INFO Epoch 094 | 75% complete (batch 136/181)
2025-12-24 10:37:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.661178
2025-12-24 10:37:37 INFO Tuning ranking metrics: regret=0.128089 spearman=0.222821 (groups=37, skipped=311)
2025-12-24 10:37:37 INFO Epoch 094 | train_mse=0.052164 | val_loss=0.062285 | best_val_loss=0.257172
2025-12-24 10:37:46 INFO Epoch 095 | 25% complete (batch 46/181)
2025-12-24 10:37:47 INFO Epoch 095 | 50% complete (batch 91/181)
2025-12-24 10:37:49 INFO Epoch 095 | 75% complete (batch 136/181)
2025-12-24 10:37:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.661262
2025-12-24 10:38:03 INFO Tuning ranking metrics: regret=0.128089 spearman=0.222821 (groups=37, skipped=311)
2025-12-24 10:38:03 INFO Epoch 095 | train_mse=0.065263 | val_loss=0.062201 | best_val_loss=0.257172
2025-12-24 10:38:12 INFO Epoch 096 | 25% complete (batch 46/181)
2025-12-24 10:38:13 INFO Epoch 096 | 50% complete (batch 91/181)
2025-12-24 10:38:14 INFO Epoch 096 | 75% complete (batch 136/181)
2025-12-24 10:38:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.661284
2025-12-24 10:38:28 INFO Tuning ranking metrics: regret=0.128089 spearman=0.224751 (groups=37, skipped=311)
2025-12-24 10:38:28 INFO Epoch 096 | train_mse=0.057308 | val_loss=0.062179 | best_val_loss=0.257172
2025-12-24 10:38:36 INFO Epoch 097 | 25% complete (batch 46/181)
2025-12-24 10:38:37 INFO Epoch 097 | 50% complete (batch 91/181)
2025-12-24 10:38:38 INFO Epoch 097 | 75% complete (batch 136/181)
2025-12-24 10:38:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.661962
2025-12-24 10:38:52 INFO Tuning ranking metrics: regret=0.128089 spearman=0.224751 (groups=37, skipped=311)
2025-12-24 10:38:52 INFO Epoch 097 | train_mse=0.073185 | val_loss=0.062138 | best_val_loss=0.257172
2025-12-24 10:39:00 INFO Epoch 098 | 25% complete (batch 46/181)
2025-12-24 10:39:01 INFO Epoch 098 | 50% complete (batch 91/181)
2025-12-24 10:39:02 INFO Epoch 098 | 75% complete (batch 136/181)
2025-12-24 10:39:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.661090
2025-12-24 10:39:16 INFO Tuning ranking metrics: regret=0.128089 spearman=0.224751 (groups=37, skipped=311)
2025-12-24 10:39:16 INFO Epoch 098 | train_mse=0.061940 | val_loss=0.062138 | best_val_loss=0.257172
2025-12-24 10:39:25 INFO Epoch 099 | 25% complete (batch 46/181)
2025-12-24 10:39:26 INFO Epoch 099 | 50% complete (batch 91/181)
2025-12-24 10:39:27 INFO Epoch 099 | 75% complete (batch 136/181)
2025-12-24 10:39:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.661947
2025-12-24 10:39:41 INFO Tuning ranking metrics: regret=0.128089 spearman=0.224751 (groups=37, skipped=311)
2025-12-24 10:39:41 INFO Epoch 099 | train_mse=0.058725 | val_loss=0.062154 | best_val_loss=0.257172
Monitored metric tuning_rank_spearman did not improve in the last 24 records. Best score: 0.257. Signaling Trainer to stop.
2025-12-24 10:39:42 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.25011_val-0.06138_epoch077.chkpt, checkpoint.tuning_rank_spearman-0.25472_val-0.06272_epoch076.chkpt, checkpoint.tuning_rank_spearman-0.25717_val-0.07450_epoch075.chkpt
2025-12-24 10:39:42 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed101/model_checkpoints/checkpoint.tuning_rank_spearman-0.25717_val-0.07450_epoch075.chkpt
2025-12-24 10:39:42 INFO Best validation loss: tensor(0.2572)
2025-12-24 10:39:42 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed101/model_checkpoints/checkpoint.tuning_rank_spearman-0.25717_val-0.07450_epoch075.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed101/model_checkpoints/checkpoint.tuning_rank_spearman-0.25717_val-0.07450_epoch075.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-24 10:39:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.074503
2025-12-24 10:39:54 INFO Tuning ranking metrics: regret=0.131408 spearman=0.257172 (groups=37, skipped=311)
2025-12-24 10:39:54 INFO Epoch 100 | val_loss=0.074503 | best_val_loss=0.257172
2025-12-24 10:39:55 INFO Validation metrics: [{'val_loss': 0.07450293004512787, 'tuning_rank_regret': 0.13140788674354553, 'tuning_rank_spearman': 0.2571721076965332, 'val_pearson_corr': 0.7368134260177612, 'val_spearman_corr': 0.725475549697876, 'val_rank_regret': 0.006380179896950722, 'val_rank_spearman': 0.6111111044883728}]
2025-12-24 10:39:55 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.25717_val-0.07450_epoch075.chkpt
2025-12-24 10:39:55 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.25472_val-0.06272_epoch076.chkpt
2025-12-24 10:39:55 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.25011_val-0.06138_epoch077.chkpt
2025-12-24 10:39:55 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.06227_epoch074.ckpt
2025-12-24 10:39:55 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.13140788674354553
  tuning_rank_spearman      0.2571721076965332
        val_loss            0.07450293004512787
    val_pearson_corr        0.7368134260177612
     val_rank_regret       0.006380179896950722
    val_rank_spearman       0.6111111044883728
    val_spearman_corr        0.725475549697876
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed101 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed101
[run_full_pipeline] Phase 2 (seed 101) best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed101/model_checkpoints/checkpoint.tuning_rank_spearman-0.25717_val-0.07450_epoch075.chkpt (tuning_rank_spearman=0.2571721076965332)
[run_full_pipeline] Phase 2 fine-tuning (seed 555) -> sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed555
[train_cli] run_id=sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed555 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed555/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed555 --git-commit 9b1bb2b320 --git-dirty --resume-from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.18011_val-0.06321_epoch065.chkpt
2025-12-24 10:40:01 INFO git_commit = 9b1bb2b320 (dirty)
2025-12-24 10:40:01 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-24 10:40:01 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed555/config/config.yaml
2025-12-24 10:40:01 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data
2025-12-24 10:40:01 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-24 10:40:01 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-24 10:40:01 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed555
2025-12-24 10:40:01 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-24 10:40:01 INFO   metadata_path = None
2025-12-24 10:40:01 INFO   summary_path = None
2025-12-24 10:40:01 INFO   accelerator = cpu
2025-12-24 10:40:01 INFO   devices = 1
2025-12-24 10:40:01 INFO   attention_head = 8
2025-12-24 10:40:01 INFO   pooling_type = mean
2025-12-24 10:40:01 INFO   model_self_loops = False
2025-12-24 10:40:01 INFO   model_self_loop_fill = mean
2025-12-24 10:40:01 INFO   model_residual = False
2025-12-24 10:40:01 INFO   batch_size = 48
2025-12-24 10:40:01 INFO   learning_rate = 0.001
2025-12-24 10:40:01 INFO   num_epochs = 320
2025-12-24 10:40:01 INFO   accumulate_grad_batches = 8
2025-12-24 10:40:01 INFO   seed = 555
2025-12-24 10:40:01 INFO   num_workers = 2
2025-12-24 10:40:01 INFO   precision = 32
2025-12-24 10:40:01 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-24 10:40:01 INFO   early_stopping_patience = 20
2025-12-24 10:40:01 INFO   lr_scheduler_patience = 4
2025-12-24 10:40:01 INFO   lr_scheduler_factor = 0.2
2025-12-24 10:40:01 INFO   fast_dev_run = False
2025-12-24 10:40:01 INFO   limit_train_batches = None
2025-12-24 10:40:01 INFO   limit_val_batches = None
2025-12-24 10:40:01 INFO   log_lr = False
2025-12-24 10:40:01 INFO   progress_bar_refresh_rate = 0
2025-12-24 10:40:01 INFO   log_every_n_steps = 100
2025-12-24 10:40:01 INFO   use_val_spearman_as_secondary = True
2025-12-24 10:40:01 INFO   spearman_secondary_min_delta = 0.0
2025-12-24 10:40:01 INFO   spearman_secondary_weight = 1.0
2025-12-24 10:40:01 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-24 10:40:01 INFO   tuning_max_samples = 500
2025-12-24 10:40:01 INFO   tuning_fraction = None
2025-12-24 10:40:01 INFO   tuning_eval_every = 1
2025-12-24 10:40:01 INFO   rank_loss_weight = 0.0
2025-12-24 10:40:01 INFO   rank_loss_margin = 0.0
2025-12-24 10:40:01 INFO   rank_loss_mode = hinge
2025-12-24 10:40:01 INFO   rank_loss_grouped = True
2025-12-24 10:40:01 INFO   variance_reduction_enabled = False
2025-12-24 10:40:01 INFO   variance_reduction_method = topk_avg
2025-12-24 10:40:01 INFO   variance_reduction_top_k = 3
2025-12-24 10:40:01 INFO   coverage_minimum = 0.0
2025-12-24 10:40:01 INFO   coverage_fail_on_missing = False
2025-12-24 10:40:01 INFO   graph_load_profiling = False
2025-12-24 10:40:01 INFO   graph_load_top_k = 5
2025-12-24 10:40:01 INFO   enable_graph_cache = True
2025-12-24 10:40:01 INFO   graph_cache_size = 256
2025-12-24 10:40:01 INFO   canonicalize_on_load = False
2025-12-24 10:40:01 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-24 10:40:01 INFO   edge_schema = {}
2025-12-24 10:40:01 INFO   topology_schema = {}
Seed set to 555
2025-12-24 10:40:02 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-24 10:40:02 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 10:40:02 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-24 10:40:02 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 10:40:02 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-24 10:40:02 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 10:40:04 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-24 10:40:04 INFO Tuning group stats: groups=368 groups>=2=39 singletons=329 max_group=9
2025-12-24 10:40:04 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed555/dataset_coverage.json
2025-12-24 10:40:04 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed555/dataset_coverage.json for details.
2025-12-24 10:40:04 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed555/dataset_coverage.json for details.
2025-12-24 10:40:04 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed555/dataset_coverage.json for details.
2025-12-24 10:40:04 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed555/schema_summary.json
2025-12-24 10:40:04 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed555/feature_metadata.json
2025-12-24 10:40:04 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-24 10:40:04 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/advanced_k_partite_v2/feature-config.yaml.advanced_lean.10A.v2, sha256=2022a36e7b21668173af3af66c25cf6b6a0494e642c0934eac38abbcfeebec3d
2025-12-24 10:40:04 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/work/edge_features)
2025-12-24 10:40:04 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json
2025-12-24 10:40:04 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed555/schema_summary.json
2025-12-24 10:40:04 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-24 10:40:04 INFO Topology: topology/persistence_k_partite_advanced/v2 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 628-dimensional node features.
2025-12-24 10:40:04 INFO Node: node/dssp_topo_merge_passthrough/v1; metadata lists 628 feature columns matching the .pt tensor.
2025-12-24 10:40:04 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-24 10:40:04 INFO → Total feature dimensionality observed and confirmed: node_dim = 628, edge_dim = 11.
2025-12-24 10:40:04 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-24 10:40:04 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 628,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge_passthrough/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 628,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed555/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge_passthrough/v1",
      "alias": "Passthrough (all dims from topology module) = Node Dynamic Dims",
      "jobs": 16,
      "summary": "DSSP/basic features merged with all topology columns (passthrough)."
    },
    "topology": {
      "id": "topology/persistence_k_partite_advanced/v2",
      "alias": "Advanced k-partite PH (v2 lean) topo_dim 596",
      "jobs": 16,
      "summary": "Fixed-width k-partite persistent homology with slot padding + missingness channels."
    }
  },
  "notes": []
}
2025-12-24 10:40:04 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-24 10:40:04 INFO Resuming from checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.18011_val-0.06321_epoch065.chkpt (epoch=65)
2025-12-24 10:40:04 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=f883591410ee4d09bcb7aef35c0e2b9d)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-24 10:40:04 INFO Starting training (fast_dev_run=False)
2025-12-24 10:40:04 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed555/model_checkpoints exists and is not empty.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.18011_val-0.06321_epoch065.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase1/model_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed555/model_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase1/model_checkpoints/val_loss_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed555/model_checkpoints/val_loss_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 20.1 K | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
180 K     Trainable params
0         Non-trainable params
180 K     Total params
0.721     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
Restored all states from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.18011_val-0.06321_epoch065.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-24 10:40:19 INFO Epoch 066 | 25% complete (batch 46/181)
2025-12-24 10:40:19 INFO Epoch 066 | 50% complete (batch 91/181)
2025-12-24 10:40:20 INFO Epoch 066 | 75% complete (batch 136/181)
2025-12-24 10:40:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.062108
2025-12-24 10:40:34 INFO Tuning ranking metrics: regret=0.079530 spearman=0.397131 (groups=39, skipped=329)
2025-12-24 10:40:34 INFO Epoch 066 | val_loss=0.062108
Metric tuning_rank_spearman improved by 0.217 >= min_delta = 0.0. New best score: 0.397
2025-12-24 10:49:34 INFO Epoch 067 | 25% complete (batch 46/181)
2025-12-24 10:49:35 INFO Epoch 067 | 50% complete (batch 91/181)
2025-12-24 10:49:36 INFO Epoch 067 | 75% complete (batch 136/181)
2025-12-24 10:49:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.635275
2025-12-24 10:49:52 INFO Tuning ranking metrics: regret=0.079530 spearman=0.365873 (groups=39, skipped=329)
2025-12-24 10:49:52 INFO Epoch 067 | train_mse=0.068067 | val_loss=0.076267 | best_val_loss=0.397131
2025-12-24 10:50:02 INFO Epoch 068 | 25% complete (batch 46/181)
2025-12-24 10:50:03 INFO Epoch 068 | 50% complete (batch 91/181)
2025-12-24 10:50:04 INFO Epoch 068 | 75% complete (batch 136/181)
2025-12-24 10:50:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.648878
2025-12-24 10:50:18 INFO Tuning ranking metrics: regret=0.086530 spearman=0.318071 (groups=39, skipped=329)
2025-12-24 10:50:18 INFO Epoch 068 | train_mse=0.069957 | val_loss=0.066319 | best_val_loss=0.397131
2025-12-24 10:50:27 INFO Epoch 069 | 25% complete (batch 46/181)
2025-12-24 10:50:28 INFO Epoch 069 | 50% complete (batch 91/181)
2025-12-24 10:50:29 INFO Epoch 069 | 75% complete (batch 136/181)
2025-12-24 10:50:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.646834
2025-12-24 10:50:45 INFO Tuning ranking metrics: regret=0.100217 spearman=0.315446 (groups=39, skipped=329)
2025-12-24 10:50:45 INFO Epoch 069 | train_mse=0.068739 | val_loss=0.066838 | best_val_loss=0.397131
2025-12-24 10:50:53 INFO Epoch 070 | 25% complete (batch 46/181)
2025-12-24 10:50:54 INFO Epoch 070 | 50% complete (batch 91/181)
2025-12-24 10:50:55 INFO Epoch 070 | 75% complete (batch 136/181)
2025-12-24 10:51:04 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.636077
2025-12-24 10:51:09 INFO Tuning ranking metrics: regret=0.103366 spearman=0.325763 (groups=39, skipped=329)
2025-12-24 10:51:09 INFO Epoch 070 | train_mse=0.075829 | val_loss=0.067752 | best_val_loss=0.397131
2025-12-24 10:51:18 INFO Epoch 071 | 25% complete (batch 46/181)
2025-12-24 10:51:19 INFO Epoch 071 | 50% complete (batch 91/181)
2025-12-24 10:51:20 INFO Epoch 071 | 75% complete (batch 136/181)
2025-12-24 10:51:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.638349
2025-12-24 10:51:34 INFO Tuning ranking metrics: regret=0.103366 spearman=0.327350 (groups=39, skipped=329)
2025-12-24 10:51:34 INFO Epoch 071 | train_mse=0.058244 | val_loss=0.069235 | best_val_loss=0.397131
2025-12-24 10:51:43 INFO Epoch 072 | 25% complete (batch 46/181)
2025-12-24 10:51:44 INFO Epoch 072 | 50% complete (batch 91/181)
2025-12-24 10:51:45 INFO Epoch 072 | 75% complete (batch 136/181)
2025-12-24 10:51:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.638751
2025-12-24 10:51:59 INFO Tuning ranking metrics: regret=0.105497 spearman=0.353846 (groups=39, skipped=329)
2025-12-24 10:51:59 INFO Epoch 072 | train_mse=0.052901 | val_loss=0.070745 | best_val_loss=0.397131
2025-12-24 10:52:07 INFO Epoch 073 | 25% complete (batch 46/181)
2025-12-24 10:52:08 INFO Epoch 073 | 50% complete (batch 91/181)
2025-12-24 10:52:09 INFO Epoch 073 | 75% complete (batch 136/181)
2025-12-24 10:52:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.661311
2025-12-24 10:52:23 INFO Tuning ranking metrics: regret=0.100387 spearman=0.333272 (groups=39, skipped=329)
2025-12-24 10:52:23 INFO Epoch 073 | train_mse=0.056985 | val_loss=0.067636 | best_val_loss=0.397131
2025-12-24 10:52:32 INFO Epoch 074 | 25% complete (batch 46/181)
2025-12-24 10:52:33 INFO Epoch 074 | 50% complete (batch 91/181)
2025-12-24 10:52:34 INFO Epoch 074 | 75% complete (batch 136/181)
2025-12-24 10:52:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.647790
2025-12-24 10:52:49 INFO Tuning ranking metrics: regret=0.100387 spearman=0.333333 (groups=39, skipped=329)
2025-12-24 10:52:49 INFO Epoch 074 | train_mse=0.081466 | val_loss=0.066921 | best_val_loss=0.397131
2025-12-24 10:52:57 INFO Epoch 075 | 25% complete (batch 46/181)
2025-12-24 10:52:58 INFO Epoch 075 | 50% complete (batch 91/181)
2025-12-24 10:52:59 INFO Epoch 075 | 75% complete (batch 136/181)
2025-12-24 10:53:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.642737
2025-12-24 10:53:13 INFO Tuning ranking metrics: regret=0.105393 spearman=0.237790 (groups=39, skipped=329)
2025-12-24 10:53:13 INFO Epoch 075 | train_mse=0.059881 | val_loss=0.071672 | best_val_loss=0.397131
2025-12-24 10:53:22 INFO Epoch 076 | 25% complete (batch 46/181)
2025-12-24 10:53:23 INFO Epoch 076 | 50% complete (batch 91/181)
2025-12-24 10:53:24 INFO Epoch 076 | 75% complete (batch 136/181)
2025-12-24 10:53:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.646536
2025-12-24 10:53:39 INFO Tuning ranking metrics: regret=0.100387 spearman=0.330586 (groups=39, skipped=329)
2025-12-24 10:53:39 INFO Epoch 076 | train_mse=0.068341 | val_loss=0.066431 | best_val_loss=0.397131
2025-12-24 10:53:48 INFO Epoch 077 | 25% complete (batch 46/181)
2025-12-24 10:53:49 INFO Epoch 077 | 50% complete (batch 91/181)
2025-12-24 10:53:50 INFO Epoch 077 | 75% complete (batch 136/181)
2025-12-24 10:54:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.654407
2025-12-24 10:54:05 INFO Tuning ranking metrics: regret=0.100387 spearman=0.333333 (groups=39, skipped=329)
2025-12-24 10:54:05 INFO Epoch 077 | train_mse=0.066688 | val_loss=0.064546 | best_val_loss=0.397131
2025-12-24 10:54:14 INFO Epoch 078 | 25% complete (batch 46/181)
2025-12-24 10:54:15 INFO Epoch 078 | 50% complete (batch 91/181)
2025-12-24 10:54:16 INFO Epoch 078 | 75% complete (batch 136/181)
2025-12-24 10:54:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.655015
2025-12-24 10:54:31 INFO Tuning ranking metrics: regret=0.100387 spearman=0.326435 (groups=39, skipped=329)
2025-12-24 10:54:31 INFO Epoch 078 | train_mse=0.049318 | val_loss=0.065564 | best_val_loss=0.397131
2025-12-24 10:54:40 INFO Epoch 079 | 25% complete (batch 46/181)
2025-12-24 10:54:41 INFO Epoch 079 | 50% complete (batch 91/181)
2025-12-24 10:54:42 INFO Epoch 079 | 75% complete (batch 136/181)
2025-12-24 10:54:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.651859
2025-12-24 10:54:57 INFO Tuning ranking metrics: regret=0.100387 spearman=0.325824 (groups=39, skipped=329)
2025-12-24 10:54:57 INFO Epoch 079 | train_mse=0.066573 | val_loss=0.064864 | best_val_loss=0.397131
2025-12-24 10:55:06 INFO Epoch 080 | 25% complete (batch 46/181)
2025-12-24 10:55:07 INFO Epoch 080 | 50% complete (batch 91/181)
2025-12-24 10:55:08 INFO Epoch 080 | 75% complete (batch 136/181)
2025-12-24 10:55:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.652592
2025-12-24 10:55:24 INFO Tuning ranking metrics: regret=0.100387 spearman=0.309707 (groups=39, skipped=329)
2025-12-24 10:55:24 INFO Epoch 080 | train_mse=0.068599 | val_loss=0.065707 | best_val_loss=0.397131
2025-12-24 10:55:33 INFO Epoch 081 | 25% complete (batch 46/181)
2025-12-24 10:55:34 INFO Epoch 081 | 50% complete (batch 91/181)
2025-12-24 10:55:35 INFO Epoch 081 | 75% complete (batch 136/181)
2025-12-24 10:55:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.651137
2025-12-24 10:55:50 INFO Tuning ranking metrics: regret=0.100387 spearman=0.309524 (groups=39, skipped=329)
2025-12-24 10:55:50 INFO Epoch 081 | train_mse=0.073975 | val_loss=0.064647 | best_val_loss=0.397131
2025-12-24 10:55:58 INFO Epoch 082 | 25% complete (batch 46/181)
2025-12-24 10:56:00 INFO Epoch 082 | 50% complete (batch 91/181)
2025-12-24 10:56:01 INFO Epoch 082 | 75% complete (batch 136/181)
2025-12-24 10:56:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.653247
2025-12-24 10:56:15 INFO Tuning ranking metrics: regret=0.100387 spearman=0.309524 (groups=39, skipped=329)
2025-12-24 10:56:15 INFO Epoch 082 | train_mse=0.060941 | val_loss=0.064717 | best_val_loss=0.397131
2025-12-24 10:56:24 INFO Epoch 083 | 25% complete (batch 46/181)
2025-12-24 10:56:25 INFO Epoch 083 | 50% complete (batch 91/181)
2025-12-24 10:56:26 INFO Epoch 083 | 75% complete (batch 136/181)
2025-12-24 10:56:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.653612
2025-12-24 10:56:40 INFO Tuning ranking metrics: regret=0.100387 spearman=0.309524 (groups=39, skipped=329)
2025-12-24 10:56:40 INFO Epoch 083 | train_mse=0.053820 | val_loss=0.064654 | best_val_loss=0.397131
2025-12-24 10:56:48 INFO Epoch 084 | 25% complete (batch 46/181)
2025-12-24 10:56:49 INFO Epoch 084 | 50% complete (batch 91/181)
2025-12-24 10:56:50 INFO Epoch 084 | 75% complete (batch 136/181)
2025-12-24 10:56:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.651613
2025-12-24 10:57:04 INFO Tuning ranking metrics: regret=0.100387 spearman=0.314103 (groups=39, skipped=329)
2025-12-24 10:57:04 INFO Epoch 084 | train_mse=0.050802 | val_loss=0.064674 | best_val_loss=0.397131
2025-12-24 10:57:13 INFO Epoch 085 | 25% complete (batch 46/181)
2025-12-24 10:57:14 INFO Epoch 085 | 50% complete (batch 91/181)
2025-12-24 10:57:15 INFO Epoch 085 | 75% complete (batch 136/181)
2025-12-24 10:57:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.651199
2025-12-24 10:57:29 INFO Tuning ranking metrics: regret=0.100387 spearman=0.328938 (groups=39, skipped=329)
2025-12-24 10:57:29 INFO Epoch 085 | train_mse=0.060527 | val_loss=0.065088 | best_val_loss=0.397131
2025-12-24 10:57:37 INFO Epoch 086 | 25% complete (batch 46/181)
2025-12-24 10:57:38 INFO Epoch 086 | 50% complete (batch 91/181)
2025-12-24 10:57:39 INFO Epoch 086 | 75% complete (batch 136/181)
2025-12-24 10:57:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.654974
2025-12-24 10:57:53 INFO Tuning ranking metrics: regret=0.100387 spearman=0.330403 (groups=39, skipped=329)
2025-12-24 10:57:53 INFO Epoch 086 | train_mse=0.075446 | val_loss=0.065103 | best_val_loss=0.397131
2025-12-24 10:58:02 INFO Epoch 087 | 25% complete (batch 46/181)
2025-12-24 10:58:03 INFO Epoch 087 | 50% complete (batch 91/181)
2025-12-24 10:58:04 INFO Epoch 087 | 75% complete (batch 136/181)
2025-12-24 10:58:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.655386
2025-12-24 10:58:18 INFO Tuning ranking metrics: regret=0.100387 spearman=0.325824 (groups=39, skipped=329)
2025-12-24 10:58:18 INFO Epoch 087 | train_mse=0.057323 | val_loss=0.064657 | best_val_loss=0.397131
2025-12-24 10:58:27 INFO Epoch 088 | 25% complete (batch 46/181)
2025-12-24 10:58:28 INFO Epoch 088 | 50% complete (batch 91/181)
2025-12-24 10:58:29 INFO Epoch 088 | 75% complete (batch 136/181)
2025-12-24 10:58:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.654615
2025-12-24 10:58:43 INFO Tuning ranking metrics: regret=0.100387 spearman=0.325824 (groups=39, skipped=329)
2025-12-24 10:58:43 INFO Epoch 088 | train_mse=0.062162 | val_loss=0.064657 | best_val_loss=0.397131
2025-12-24 10:58:52 INFO Epoch 089 | 25% complete (batch 46/181)
2025-12-24 10:58:53 INFO Epoch 089 | 50% complete (batch 91/181)
2025-12-24 10:58:54 INFO Epoch 089 | 75% complete (batch 136/181)
2025-12-24 10:59:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.654146
2025-12-24 10:59:07 INFO Tuning ranking metrics: regret=0.100387 spearman=0.325824 (groups=39, skipped=329)
2025-12-24 10:59:07 INFO Epoch 089 | train_mse=0.045509 | val_loss=0.064657 | best_val_loss=0.397131
2025-12-24 10:59:16 INFO Epoch 090 | 25% complete (batch 46/181)
2025-12-24 10:59:17 INFO Epoch 090 | 50% complete (batch 91/181)
2025-12-24 10:59:18 INFO Epoch 090 | 75% complete (batch 136/181)
2025-12-24 10:59:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.654152
2025-12-24 10:59:32 INFO Tuning ranking metrics: regret=0.100387 spearman=0.325824 (groups=39, skipped=329)
2025-12-24 10:59:32 INFO Epoch 090 | train_mse=0.059433 | val_loss=0.064650 | best_val_loss=0.397131
Monitored metric tuning_rank_spearman did not improve in the last 24 records. Best score: 0.397. Signaling Trainer to stop.
2025-12-24 10:59:33 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.35385_val-0.07075_epoch072.chkpt, checkpoint.tuning_rank_spearman-0.36587_val-0.07627_epoch067.chkpt, checkpoint.tuning_rank_spearman-0.39713_val-0.06211_epoch066.chkpt
2025-12-24 10:59:33 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed555/model_checkpoints/checkpoint.tuning_rank_spearman-0.39713_val-0.06211_epoch066.chkpt
2025-12-24 10:59:33 INFO Best validation loss: tensor(0.3971)
2025-12-24 10:59:33 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed555/model_checkpoints/checkpoint.tuning_rank_spearman-0.39713_val-0.06211_epoch066.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed555/model_checkpoints/checkpoint.tuning_rank_spearman-0.39713_val-0.06211_epoch066.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-24 10:59:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.062108
2025-12-24 10:59:46 INFO Tuning ranking metrics: regret=0.079530 spearman=0.397131 (groups=39, skipped=329)
2025-12-24 10:59:46 INFO Epoch 091 | val_loss=0.062108 | best_val_loss=0.397131
2025-12-24 10:59:46 INFO Validation metrics: [{'val_loss': 0.06210808828473091, 'tuning_rank_regret': 0.07953028380870819, 'tuning_rank_spearman': 0.3971306383609772, 'val_pearson_corr': 0.7491583228111267, 'val_spearman_corr': 0.7115418314933777, 'val_rank_regret': 0.0035356476437300444, 'val_rank_spearman': 0.6666666865348816}]
2025-12-24 10:59:46 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.39713_val-0.06211_epoch066.chkpt
2025-12-24 10:59:46 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.36587_val-0.07627_epoch067.chkpt
2025-12-24 10:59:46 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.35385_val-0.07075_epoch072.chkpt
2025-12-24 10:59:46 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.06292_epoch064.ckpt
2025-12-24 10:59:46 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.07953028380870819
  tuning_rank_spearman      0.3971306383609772
        val_loss            0.06210808828473091
    val_pearson_corr        0.7491583228111267
     val_rank_regret       0.0035356476437300444
    val_rank_spearman       0.6666666865348816
    val_spearman_corr       0.7115418314933777
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed555 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed555
[run_full_pipeline] Phase 2 (seed 555) best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed555/model_checkpoints/checkpoint.tuning_rank_spearman-0.39713_val-0.06211_epoch066.chkpt (tuning_rank_spearman=0.3971306383609772)
[run_full_pipeline] Phase 2 fine-tuning (seed 888) -> sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed888
[train_cli] run_id=sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed888 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed888/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed888 --git-commit 9b1bb2b320 --git-dirty --resume-from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.18011_val-0.06321_epoch065.chkpt
2025-12-24 10:59:54 INFO git_commit = 9b1bb2b320 (dirty)
2025-12-24 10:59:54 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-24 10:59:54 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed888/config/config.yaml
2025-12-24 10:59:54 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data
2025-12-24 10:59:54 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-24 10:59:54 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-24 10:59:54 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed888
2025-12-24 10:59:54 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-24 10:59:54 INFO   metadata_path = None
2025-12-24 10:59:54 INFO   summary_path = None
2025-12-24 10:59:54 INFO   accelerator = cpu
2025-12-24 10:59:54 INFO   devices = 1
2025-12-24 10:59:54 INFO   attention_head = 8
2025-12-24 10:59:54 INFO   pooling_type = mean
2025-12-24 10:59:54 INFO   model_self_loops = False
2025-12-24 10:59:54 INFO   model_self_loop_fill = mean
2025-12-24 10:59:54 INFO   model_residual = False
2025-12-24 10:59:54 INFO   batch_size = 48
2025-12-24 10:59:54 INFO   learning_rate = 0.001
2025-12-24 10:59:54 INFO   num_epochs = 320
2025-12-24 10:59:54 INFO   accumulate_grad_batches = 8
2025-12-24 10:59:54 INFO   seed = 888
2025-12-24 10:59:54 INFO   num_workers = 2
2025-12-24 10:59:54 INFO   precision = 32
2025-12-24 10:59:54 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-24 10:59:54 INFO   early_stopping_patience = 20
2025-12-24 10:59:54 INFO   lr_scheduler_patience = 4
2025-12-24 10:59:54 INFO   lr_scheduler_factor = 0.2
2025-12-24 10:59:54 INFO   fast_dev_run = False
2025-12-24 10:59:54 INFO   limit_train_batches = None
2025-12-24 10:59:54 INFO   limit_val_batches = None
2025-12-24 10:59:54 INFO   log_lr = False
2025-12-24 10:59:54 INFO   progress_bar_refresh_rate = 0
2025-12-24 10:59:54 INFO   log_every_n_steps = 100
2025-12-24 10:59:54 INFO   use_val_spearman_as_secondary = True
2025-12-24 10:59:54 INFO   spearman_secondary_min_delta = 0.0
2025-12-24 10:59:54 INFO   spearman_secondary_weight = 1.0
2025-12-24 10:59:54 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-24 10:59:54 INFO   tuning_max_samples = 500
2025-12-24 10:59:54 INFO   tuning_fraction = None
2025-12-24 10:59:54 INFO   tuning_eval_every = 1
2025-12-24 10:59:54 INFO   rank_loss_weight = 0.0
2025-12-24 10:59:54 INFO   rank_loss_margin = 0.0
2025-12-24 10:59:54 INFO   rank_loss_mode = hinge
2025-12-24 10:59:54 INFO   rank_loss_grouped = True
2025-12-24 10:59:54 INFO   variance_reduction_enabled = False
2025-12-24 10:59:54 INFO   variance_reduction_method = topk_avg
2025-12-24 10:59:54 INFO   variance_reduction_top_k = 3
2025-12-24 10:59:54 INFO   coverage_minimum = 0.0
2025-12-24 10:59:54 INFO   coverage_fail_on_missing = False
2025-12-24 10:59:54 INFO   graph_load_profiling = False
2025-12-24 10:59:54 INFO   graph_load_top_k = 5
2025-12-24 10:59:54 INFO   enable_graph_cache = True
2025-12-24 10:59:54 INFO   graph_cache_size = 256
2025-12-24 10:59:54 INFO   canonicalize_on_load = False
2025-12-24 10:59:54 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-24 10:59:54 INFO   edge_schema = {}
2025-12-24 10:59:54 INFO   topology_schema = {}
Seed set to 888
2025-12-24 10:59:55 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-24 10:59:55 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 10:59:55 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-24 10:59:55 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 10:59:55 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-24 10:59:55 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 10:59:57 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-24 10:59:57 INFO Tuning group stats: groups=351 groups>=2=40 singletons=311 max_group=10
2025-12-24 10:59:57 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed888/dataset_coverage.json
2025-12-24 10:59:57 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed888/dataset_coverage.json for details.
2025-12-24 10:59:57 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed888/dataset_coverage.json for details.
2025-12-24 10:59:57 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed888/dataset_coverage.json for details.
2025-12-24 10:59:57 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed888/schema_summary.json
2025-12-24 10:59:57 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed888/feature_metadata.json
2025-12-24 10:59:57 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-24 10:59:57 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/advanced_k_partite_v2/feature-config.yaml.advanced_lean.10A.v2, sha256=2022a36e7b21668173af3af66c25cf6b6a0494e642c0934eac38abbcfeebec3d
2025-12-24 10:59:57 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/work/edge_features)
2025-12-24 10:59:57 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json
2025-12-24 10:59:57 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed888/schema_summary.json
2025-12-24 10:59:57 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-24 10:59:57 INFO Topology: topology/persistence_k_partite_advanced/v2 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 628-dimensional node features.
2025-12-24 10:59:57 INFO Node: node/dssp_topo_merge_passthrough/v1; metadata lists 628 feature columns matching the .pt tensor.
2025-12-24 10:59:57 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-24 10:59:57 INFO → Total feature dimensionality observed and confirmed: node_dim = 628, edge_dim = 11.
2025-12-24 10:59:57 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-24 10:59:57 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 628,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge_passthrough/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 628,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed888/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge_passthrough/v1",
      "alias": "Passthrough (all dims from topology module) = Node Dynamic Dims",
      "jobs": 16,
      "summary": "DSSP/basic features merged with all topology columns (passthrough)."
    },
    "topology": {
      "id": "topology/persistence_k_partite_advanced/v2",
      "alias": "Advanced k-partite PH (v2 lean) topo_dim 596",
      "jobs": 16,
      "summary": "Fixed-width k-partite persistent homology with slot padding + missingness channels."
    }
  },
  "notes": []
}
2025-12-24 10:59:57 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-24 10:59:57 INFO Resuming from checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.18011_val-0.06321_epoch065.chkpt (epoch=65)
2025-12-24 10:59:57 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=d5423026fce34c19bfa11bb0251cfd5b)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-24 10:59:57 INFO Starting training (fast_dev_run=False)
2025-12-24 10:59:57 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed888/model_checkpoints exists and is not empty.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.18011_val-0.06321_epoch065.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase1/model_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed888/model_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase1/model_checkpoints/val_loss_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed888/model_checkpoints/val_loss_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 20.1 K | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
180 K     Trainable params
0         Non-trainable params
180 K     Total params
0.721     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
Restored all states from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.18011_val-0.06321_epoch065.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-24 11:00:12 INFO Epoch 066 | 25% complete (batch 46/181)
2025-12-24 11:00:13 INFO Epoch 066 | 50% complete (batch 91/181)
2025-12-24 11:00:14 INFO Epoch 066 | 75% complete (batch 136/181)
2025-12-24 11:00:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.062966
2025-12-24 11:00:28 INFO Tuning ranking metrics: regret=0.119430 spearman=0.311326 (groups=40, skipped=311)
2025-12-24 11:00:28 INFO Epoch 066 | val_loss=0.062966
Metric tuning_rank_spearman improved by 0.131 >= min_delta = 0.0. New best score: 0.311
2025-12-24 11:00:36 INFO Epoch 067 | 25% complete (batch 46/181)
2025-12-24 11:00:37 INFO Epoch 067 | 50% complete (batch 91/181)
2025-12-24 11:00:38 INFO Epoch 067 | 75% complete (batch 136/181)
2025-12-24 11:00:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.631326
2025-12-24 11:00:52 INFO Tuning ranking metrics: regret=0.121856 spearman=0.334897 (groups=40, skipped=311)
2025-12-24 11:00:52 INFO Epoch 067 | train_mse=0.068865 | val_loss=0.072218 | best_val_loss=0.311326
Metric tuning_rank_spearman improved by 0.024 >= min_delta = 0.0. New best score: 0.335
2025-12-24 11:01:01 INFO Epoch 068 | 25% complete (batch 46/181)
2025-12-24 11:01:02 INFO Epoch 068 | 50% complete (batch 91/181)
2025-12-24 11:01:03 INFO Epoch 068 | 75% complete (batch 136/181)
2025-12-24 11:01:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.634212
2025-12-24 11:01:17 INFO Tuning ranking metrics: regret=0.121856 spearman=0.360487 (groups=40, skipped=311)
2025-12-24 11:01:17 INFO Epoch 068 | train_mse=0.083616 | val_loss=0.064972 | best_val_loss=0.334897
Metric tuning_rank_spearman improved by 0.026 >= min_delta = 0.0. New best score: 0.360
2025-12-24 11:01:26 INFO Epoch 069 | 25% complete (batch 46/181)
2025-12-24 11:01:26 INFO Epoch 069 | 50% complete (batch 91/181)
2025-12-24 11:01:27 INFO Epoch 069 | 75% complete (batch 136/181)
2025-12-24 11:01:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.647116
2025-12-24 11:01:42 INFO Tuning ranking metrics: regret=0.109105 spearman=0.292949 (groups=40, skipped=311)
2025-12-24 11:01:42 INFO Epoch 069 | train_mse=0.063905 | val_loss=0.062481 | best_val_loss=0.360487
2025-12-24 11:01:51 INFO Epoch 070 | 25% complete (batch 46/181)
2025-12-24 11:01:51 INFO Epoch 070 | 50% complete (batch 91/181)
2025-12-24 11:01:52 INFO Epoch 070 | 75% complete (batch 136/181)
2025-12-24 11:02:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.645181
2025-12-24 11:02:06 INFO Tuning ranking metrics: regret=0.153586 spearman=0.196883 (groups=40, skipped=311)
2025-12-24 11:02:06 INFO Epoch 070 | train_mse=0.060672 | val_loss=0.064919 | best_val_loss=0.360487
2025-12-24 11:02:15 INFO Epoch 071 | 25% complete (batch 46/181)
2025-12-24 11:02:16 INFO Epoch 071 | 50% complete (batch 91/181)
2025-12-24 11:02:17 INFO Epoch 071 | 75% complete (batch 136/181)
2025-12-24 11:02:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.652147
2025-12-24 11:02:31 INFO Tuning ranking metrics: regret=0.132340 spearman=0.265038 (groups=40, skipped=311)
2025-12-24 11:02:31 INFO Epoch 071 | train_mse=0.064487 | val_loss=0.081293 | best_val_loss=0.360487
2025-12-24 11:02:39 INFO Epoch 072 | 25% complete (batch 46/181)
2025-12-24 11:02:40 INFO Epoch 072 | 50% complete (batch 91/181)
2025-12-24 11:02:41 INFO Epoch 072 | 75% complete (batch 136/181)
2025-12-24 11:02:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.661633
2025-12-24 11:02:55 INFO Tuning ranking metrics: regret=0.132340 spearman=0.259069 (groups=40, skipped=311)
2025-12-24 11:02:55 INFO Epoch 072 | train_mse=0.046763 | val_loss=0.067733 | best_val_loss=0.360487
2025-12-24 11:03:04 INFO Epoch 073 | 25% complete (batch 46/181)
2025-12-24 11:03:05 INFO Epoch 073 | 50% complete (batch 91/181)
2025-12-24 11:03:06 INFO Epoch 073 | 75% complete (batch 136/181)
2025-12-24 11:03:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.658780
2025-12-24 11:03:20 INFO Tuning ranking metrics: regret=0.112783 spearman=0.246580 (groups=40, skipped=311)
2025-12-24 11:03:20 INFO Epoch 073 | train_mse=0.066493 | val_loss=0.064147 | best_val_loss=0.360487
2025-12-24 11:03:28 INFO Epoch 074 | 25% complete (batch 46/181)
2025-12-24 11:03:29 INFO Epoch 074 | 50% complete (batch 91/181)
2025-12-24 11:03:30 INFO Epoch 074 | 75% complete (batch 136/181)
2025-12-24 11:03:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.652512
2025-12-24 11:03:44 INFO Tuning ranking metrics: regret=0.112783 spearman=0.240936 (groups=40, skipped=311)
2025-12-24 11:03:44 INFO Epoch 074 | train_mse=0.065681 | val_loss=0.069811 | best_val_loss=0.360487
2025-12-24 11:03:53 INFO Epoch 075 | 25% complete (batch 46/181)
2025-12-24 11:03:53 INFO Epoch 075 | 50% complete (batch 91/181)
2025-12-24 11:03:54 INFO Epoch 075 | 75% complete (batch 136/181)
2025-12-24 11:04:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.650039
2025-12-24 11:04:09 INFO Tuning ranking metrics: regret=0.112764 spearman=0.255189 (groups=40, skipped=311)
2025-12-24 11:04:09 INFO Epoch 075 | train_mse=0.080289 | val_loss=0.073458 | best_val_loss=0.360487
2025-12-24 11:04:17 INFO Epoch 076 | 25% complete (batch 46/181)
2025-12-24 11:04:18 INFO Epoch 076 | 50% complete (batch 91/181)
2025-12-24 11:04:19 INFO Epoch 076 | 75% complete (batch 136/181)
2025-12-24 11:04:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.664566
2025-12-24 11:04:33 INFO Tuning ranking metrics: regret=0.105939 spearman=0.284037 (groups=40, skipped=311)
2025-12-24 11:04:33 INFO Epoch 076 | train_mse=0.054111 | val_loss=0.066443 | best_val_loss=0.360487
2025-12-24 11:04:42 INFO Epoch 077 | 25% complete (batch 46/181)
2025-12-24 11:04:43 INFO Epoch 077 | 50% complete (batch 91/181)
2025-12-24 11:04:44 INFO Epoch 077 | 75% complete (batch 136/181)
2025-12-24 11:04:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.670970
2025-12-24 11:04:58 INFO Tuning ranking metrics: regret=0.105939 spearman=0.286618 (groups=40, skipped=311)
2025-12-24 11:04:58 INFO Epoch 077 | train_mse=0.051571 | val_loss=0.060106 | best_val_loss=0.360487
2025-12-24 11:05:07 INFO Epoch 078 | 25% complete (batch 46/181)
2025-12-24 11:05:08 INFO Epoch 078 | 50% complete (batch 91/181)
2025-12-24 11:05:09 INFO Epoch 078 | 75% complete (batch 136/181)
2025-12-24 11:05:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.662909
2025-12-24 11:05:23 INFO Tuning ranking metrics: regret=0.112764 spearman=0.241975 (groups=40, skipped=311)
2025-12-24 11:05:23 INFO Epoch 078 | train_mse=0.060361 | val_loss=0.060655 | best_val_loss=0.360487
2025-12-24 11:05:31 INFO Epoch 079 | 25% complete (batch 46/181)
2025-12-24 11:05:32 INFO Epoch 079 | 50% complete (batch 91/181)
2025-12-24 11:05:33 INFO Epoch 079 | 75% complete (batch 136/181)
2025-12-24 11:05:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.658877
2025-12-24 11:05:47 INFO Tuning ranking metrics: regret=0.112764 spearman=0.236596 (groups=40, skipped=311)
2025-12-24 11:05:47 INFO Epoch 079 | train_mse=0.062553 | val_loss=0.066565 | best_val_loss=0.360487
2025-12-24 11:05:56 INFO Epoch 080 | 25% complete (batch 46/181)
2025-12-24 11:05:57 INFO Epoch 080 | 50% complete (batch 91/181)
2025-12-24 11:05:58 INFO Epoch 080 | 75% complete (batch 136/181)
2025-12-24 11:06:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.670504
2025-12-24 11:06:12 INFO Tuning ranking metrics: regret=0.105939 spearman=0.300130 (groups=40, skipped=311)
2025-12-24 11:06:12 INFO Epoch 080 | train_mse=0.069037 | val_loss=0.061008 | best_val_loss=0.360487
2025-12-24 11:06:21 INFO Epoch 081 | 25% complete (batch 46/181)
2025-12-24 11:06:22 INFO Epoch 081 | 50% complete (batch 91/181)
2025-12-24 11:06:23 INFO Epoch 081 | 75% complete (batch 136/181)
2025-12-24 11:06:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.658306
2025-12-24 11:06:37 INFO Tuning ranking metrics: regret=0.112315 spearman=0.278842 (groups=40, skipped=311)
2025-12-24 11:06:37 INFO Epoch 081 | train_mse=0.055640 | val_loss=0.061686 | best_val_loss=0.360487
2025-12-24 11:06:46 INFO Epoch 082 | 25% complete (batch 46/181)
2025-12-24 11:06:47 INFO Epoch 082 | 50% complete (batch 91/181)
2025-12-24 11:06:48 INFO Epoch 082 | 75% complete (batch 136/181)
2025-12-24 11:06:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.659030
2025-12-24 11:07:02 INFO Tuning ranking metrics: regret=0.105939 spearman=0.288166 (groups=40, skipped=311)
2025-12-24 11:07:02 INFO Epoch 082 | train_mse=0.056689 | val_loss=0.060292 | best_val_loss=0.360487
2025-12-24 11:07:10 INFO Epoch 083 | 25% complete (batch 46/181)
2025-12-24 11:07:11 INFO Epoch 083 | 50% complete (batch 91/181)
2025-12-24 11:07:12 INFO Epoch 083 | 75% complete (batch 136/181)
2025-12-24 11:07:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.659646
2025-12-24 11:07:26 INFO Tuning ranking metrics: regret=0.112764 spearman=0.228782 (groups=40, skipped=311)
2025-12-24 11:07:26 INFO Epoch 083 | train_mse=0.060975 | val_loss=0.063147 | best_val_loss=0.360487
2025-12-24 11:07:35 INFO Epoch 084 | 25% complete (batch 46/181)
2025-12-24 11:07:36 INFO Epoch 084 | 50% complete (batch 91/181)
2025-12-24 11:07:37 INFO Epoch 084 | 75% complete (batch 136/181)
2025-12-24 11:07:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.652525
2025-12-24 11:07:51 INFO Tuning ranking metrics: regret=0.105939 spearman=0.292808 (groups=40, skipped=311)
2025-12-24 11:07:51 INFO Epoch 084 | train_mse=0.044608 | val_loss=0.063745 | best_val_loss=0.360487
2025-12-24 11:07:59 INFO Epoch 085 | 25% complete (batch 46/181)
2025-12-24 11:08:00 INFO Epoch 085 | 50% complete (batch 91/181)
2025-12-24 11:08:01 INFO Epoch 085 | 75% complete (batch 136/181)
2025-12-24 11:08:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.663825
2025-12-24 11:08:15 INFO Tuning ranking metrics: regret=0.105939 spearman=0.290308 (groups=40, skipped=311)
2025-12-24 11:08:15 INFO Epoch 085 | train_mse=0.053620 | val_loss=0.064836 | best_val_loss=0.360487
2025-12-24 11:08:24 INFO Epoch 086 | 25% complete (batch 46/181)
2025-12-24 11:08:25 INFO Epoch 086 | 50% complete (batch 91/181)
2025-12-24 11:08:26 INFO Epoch 086 | 75% complete (batch 136/181)
2025-12-24 11:08:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.668263
2025-12-24 11:08:41 INFO Tuning ranking metrics: regret=0.112764 spearman=0.240070 (groups=40, skipped=311)
2025-12-24 11:08:41 INFO Epoch 086 | train_mse=0.064817 | val_loss=0.062059 | best_val_loss=0.360487
2025-12-24 11:08:49 INFO Epoch 087 | 25% complete (batch 46/181)
2025-12-24 11:08:50 INFO Epoch 087 | 50% complete (batch 91/181)
2025-12-24 11:08:51 INFO Epoch 087 | 75% complete (batch 136/181)
2025-12-24 11:09:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.668950
2025-12-24 11:09:05 INFO Tuning ranking metrics: regret=0.112764 spearman=0.239378 (groups=40, skipped=311)
2025-12-24 11:09:05 INFO Epoch 087 | train_mse=0.054560 | val_loss=0.060181 | best_val_loss=0.360487
2025-12-24 11:09:14 INFO Epoch 088 | 25% complete (batch 46/181)
2025-12-24 11:09:15 INFO Epoch 088 | 50% complete (batch 91/181)
2025-12-24 11:09:16 INFO Epoch 088 | 75% complete (batch 136/181)
2025-12-24 11:09:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.664472
2025-12-24 11:09:30 INFO Tuning ranking metrics: regret=0.112764 spearman=0.239378 (groups=40, skipped=311)
2025-12-24 11:09:30 INFO Epoch 088 | train_mse=0.053602 | val_loss=0.060300 | best_val_loss=0.360487
2025-12-24 11:09:38 INFO Epoch 089 | 25% complete (batch 46/181)
2025-12-24 11:09:39 INFO Epoch 089 | 50% complete (batch 91/181)
2025-12-24 11:09:40 INFO Epoch 089 | 75% complete (batch 136/181)
2025-12-24 11:09:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.662468
2025-12-24 11:09:54 INFO Tuning ranking metrics: regret=0.112764 spearman=0.236953 (groups=40, skipped=311)
2025-12-24 11:09:54 INFO Epoch 089 | train_mse=0.057491 | val_loss=0.060861 | best_val_loss=0.360487
2025-12-24 11:10:03 INFO Epoch 090 | 25% complete (batch 46/181)
2025-12-24 11:10:04 INFO Epoch 090 | 50% complete (batch 91/181)
2025-12-24 11:10:05 INFO Epoch 090 | 75% complete (batch 136/181)
2025-12-24 11:10:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.665025
2025-12-24 11:10:19 INFO Tuning ranking metrics: regret=0.112764 spearman=0.239378 (groups=40, skipped=311)
2025-12-24 11:10:19 INFO Epoch 090 | train_mse=0.043444 | val_loss=0.060148 | best_val_loss=0.360487
2025-12-24 11:10:28 INFO Epoch 091 | 25% complete (batch 46/181)
2025-12-24 11:10:29 INFO Epoch 091 | 50% complete (batch 91/181)
2025-12-24 11:10:30 INFO Epoch 091 | 75% complete (batch 136/181)
2025-12-24 11:10:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.663146
2025-12-24 11:10:44 INFO Tuning ranking metrics: regret=0.112555 spearman=0.241163 (groups=40, skipped=311)
2025-12-24 11:10:44 INFO Epoch 091 | train_mse=0.065432 | val_loss=0.060318 | best_val_loss=0.360487
2025-12-24 11:10:53 INFO Epoch 092 | 25% complete (batch 46/181)
2025-12-24 11:10:54 INFO Epoch 092 | 50% complete (batch 91/181)
2025-12-24 11:10:55 INFO Epoch 092 | 75% complete (batch 136/181)
2025-12-24 11:11:04 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.661663
2025-12-24 11:11:09 INFO Tuning ranking metrics: regret=0.112555 spearman=0.239951 (groups=40, skipped=311)
2025-12-24 11:11:09 INFO Epoch 092 | train_mse=0.047948 | val_loss=0.060492 | best_val_loss=0.360487
Monitored metric tuning_rank_spearman did not improve in the last 24 records. Best score: 0.360. Signaling Trainer to stop.
2025-12-24 11:11:10 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.31133_val-0.06297_epoch066.chkpt, checkpoint.tuning_rank_spearman-0.33490_val-0.07222_epoch067.chkpt, checkpoint.tuning_rank_spearman-0.36049_val-0.06497_epoch068.chkpt
2025-12-24 11:11:10 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed888/model_checkpoints/checkpoint.tuning_rank_spearman-0.36049_val-0.06497_epoch068.chkpt
2025-12-24 11:11:10 INFO Best validation loss: tensor(0.3605)
2025-12-24 11:11:10 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed888/model_checkpoints/checkpoint.tuning_rank_spearman-0.36049_val-0.06497_epoch068.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed888/model_checkpoints/checkpoint.tuning_rank_spearman-0.36049_val-0.06497_epoch068.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-24 11:11:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.064972
2025-12-24 11:11:22 INFO Tuning ranking metrics: regret=0.121856 spearman=0.360487 (groups=40, skipped=311)
2025-12-24 11:11:22 INFO Epoch 093 | val_loss=0.064972 | best_val_loss=0.360487
2025-12-24 11:11:23 INFO Validation metrics: [{'val_loss': 0.06497198343276978, 'tuning_rank_regret': 0.12185613065958023, 'tuning_rank_spearman': 0.3604870140552521, 'val_pearson_corr': 0.7351990938186646, 'val_spearman_corr': 0.7095968127250671, 'val_rank_regret': 0.0035356476437300444, 'val_rank_spearman': 0.6666666865348816}]
2025-12-24 11:11:23 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.36049_val-0.06497_epoch068.chkpt
2025-12-24 11:11:23 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.31133_val-0.06297_epoch066.chkpt
2025-12-24 11:11:23 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.33490_val-0.07222_epoch067.chkpt
2025-12-24 11:11:23 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.06297_epoch066.ckpt
2025-12-24 11:11:23 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.12185613065958023
  tuning_rank_spearman      0.3604870140552521
        val_loss            0.06497198343276978
    val_pearson_corr        0.7351990938186646
     val_rank_regret       0.0035356476437300444
    val_rank_spearman       0.6666666865348816
    val_spearman_corr       0.7095968127250671
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed888 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed888
[run_full_pipeline] Phase 2 (seed 888) best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed888/model_checkpoints/checkpoint.tuning_rank_spearman-0.36049_val-0.06497_epoch068.chkpt (tuning_rank_spearman=0.3604870140552521)
[run_full_pipeline] Pipeline complete at 2025-12-24T11:11:26Z
Starting post model training polishing ...
[polish_from_best] Manifest written to manifests/run_polish_lean.yaml
[polish_from_best] Best run: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-24_09-03-53_phase2_seed555
[polish_from_best] Base config: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/configs/sched_boost_finetune_seed555.yaml
[polish_from_best] Seeds: 101 555 888
[polish_from_best] Launching run_full_pipeline.sh with manifests/run_polish_lean.yaml
[run_full_pipeline] Validating graphs before training...
[validate_graphs] OK: validated 14391 graph(s) in /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data
[run_full_pipeline] Starting sweep at 2025-12-24T11:12:07.647784+00:00 using manifest /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/manifests/run_polish_lean.yaml
[train_cli][batch] (1/6) running job 'polish_seed101' -> run_name=polish_seed101_2025-12-24_11-12-07
[train_cli] run_id=polish_seed101_2025-12-24_11-12-07 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07 --git-commit 9b1bb2b320 --git-dirty
2025-12-24 11:12:11 INFO git_commit = 9b1bb2b320 (dirty)
2025-12-24 11:12:11 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-24 11:12:11 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07/config/config.yaml
2025-12-24 11:12:11 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data
2025-12-24 11:12:11 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-24 11:12:11 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-24 11:12:11 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07
2025-12-24 11:12:11 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-24 11:12:11 INFO   metadata_path = None
2025-12-24 11:12:11 INFO   summary_path = None
2025-12-24 11:12:11 INFO   accelerator = cpu
2025-12-24 11:12:11 INFO   devices = 1
2025-12-24 11:12:11 INFO   attention_head = 8
2025-12-24 11:12:11 INFO   pooling_type = mean
2025-12-24 11:12:11 INFO   model_self_loops = False
2025-12-24 11:12:11 INFO   model_self_loop_fill = mean
2025-12-24 11:12:11 INFO   model_residual = False
2025-12-24 11:12:11 INFO   batch_size = 48
2025-12-24 11:12:11 INFO   learning_rate = 0.003
2025-12-24 11:12:11 INFO   num_epochs = 320
2025-12-24 11:12:11 INFO   accumulate_grad_batches = 8
2025-12-24 11:12:11 INFO   seed = 101
2025-12-24 11:12:11 INFO   num_workers = 2
2025-12-24 11:12:11 INFO   precision = 32
2025-12-24 11:12:11 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-24 11:12:11 INFO   early_stopping_patience = 40
2025-12-24 11:12:11 INFO   lr_scheduler_patience = 20
2025-12-24 11:12:11 INFO   lr_scheduler_factor = 0.3
2025-12-24 11:12:11 INFO   fast_dev_run = False
2025-12-24 11:12:11 INFO   limit_train_batches = None
2025-12-24 11:12:11 INFO   limit_val_batches = None
2025-12-24 11:12:11 INFO   log_lr = False
2025-12-24 11:12:11 INFO   progress_bar_refresh_rate = 0
2025-12-24 11:12:11 INFO   log_every_n_steps = 100
2025-12-24 11:12:11 INFO   use_val_spearman_as_secondary = True
2025-12-24 11:12:11 INFO   spearman_secondary_min_delta = 0.0
2025-12-24 11:12:11 INFO   spearman_secondary_weight = 1.0
2025-12-24 11:12:11 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-24 11:12:11 INFO   tuning_max_samples = 500
2025-12-24 11:12:11 INFO   tuning_fraction = None
2025-12-24 11:12:11 INFO   tuning_eval_every = 1
2025-12-24 11:12:11 INFO   rank_loss_weight = 0.0
2025-12-24 11:12:11 INFO   rank_loss_margin = 0.0
2025-12-24 11:12:11 INFO   rank_loss_mode = hinge
2025-12-24 11:12:11 INFO   rank_loss_grouped = True
2025-12-24 11:12:11 INFO   variance_reduction_enabled = False
2025-12-24 11:12:11 INFO   variance_reduction_method = topk_avg
2025-12-24 11:12:11 INFO   variance_reduction_top_k = 3
2025-12-24 11:12:11 INFO   coverage_minimum = 0.0
2025-12-24 11:12:11 INFO   coverage_fail_on_missing = False
2025-12-24 11:12:11 INFO   graph_load_profiling = False
2025-12-24 11:12:11 INFO   graph_load_top_k = 5
2025-12-24 11:12:11 INFO   enable_graph_cache = True
2025-12-24 11:12:11 INFO   graph_cache_size = 256
2025-12-24 11:12:11 INFO   canonicalize_on_load = False
2025-12-24 11:12:11 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-24 11:12:11 INFO   edge_schema = {}
2025-12-24 11:12:11 INFO   topology_schema = {}
Seed set to 101
2025-12-24 11:12:11 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-24 11:12:11 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 11:12:11 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-24 11:12:11 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 11:12:11 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-24 11:12:11 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 11:12:13 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-24 11:12:13 INFO Tuning group stats: groups=348 groups>=2=37 singletons=311 max_group=11
2025-12-24 11:12:14 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07/dataset_coverage.json
2025-12-24 11:12:14 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07/dataset_coverage.json for details.
2025-12-24 11:12:14 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07/dataset_coverage.json for details.
2025-12-24 11:12:14 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07/dataset_coverage.json for details.
2025-12-24 11:12:14 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07/schema_summary.json
2025-12-24 11:12:14 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07/feature_metadata.json
2025-12-24 11:12:14 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-24 11:12:14 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/advanced_k_partite_v2/feature-config.yaml.advanced_lean.10A.v2, sha256=2022a36e7b21668173af3af66c25cf6b6a0494e642c0934eac38abbcfeebec3d
2025-12-24 11:12:14 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/work/edge_features)
2025-12-24 11:12:14 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json
2025-12-24 11:12:14 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07/schema_summary.json
2025-12-24 11:12:14 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-24 11:12:14 INFO Topology: topology/persistence_k_partite_advanced/v2 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 628-dimensional node features.
2025-12-24 11:12:14 INFO Node: node/dssp_topo_merge_passthrough/v1; metadata lists 628 feature columns matching the .pt tensor.
2025-12-24 11:12:14 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-24 11:12:14 INFO → Total feature dimensionality observed and confirmed: node_dim = 628, edge_dim = 11.
2025-12-24 11:12:14 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-24 11:12:14 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 628,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge_passthrough/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 628,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge_passthrough/v1",
      "alias": "Passthrough (all dims from topology module) = Node Dynamic Dims",
      "jobs": 16,
      "summary": "DSSP/basic features merged with all topology columns (passthrough)."
    },
    "topology": {
      "id": "topology/persistence_k_partite_advanced/v2",
      "alias": "Advanced k-partite PH (v2 lean) topo_dim 596",
      "jobs": 16,
      "summary": "Fixed-width k-partite persistent homology with slot padding + missingness channels."
    }
  },
  "notes": []
}
2025-12-24 11:12:14 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-24 11:12:14 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=ce3e7f0b8105416bae04944dae7ae82e)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-24 11:12:14 INFO Starting training (fast_dev_run=False)
2025-12-24 11:12:14 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07/model_checkpoints exists and is not empty.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 20.1 K | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
180 K     Trainable params
0         Non-trainable params
180 K     Total params
0.721     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-24 11:12:29 INFO Epoch 000 | 25% complete (batch 46/181)
2025-12-24 11:12:29 INFO Epoch 000 | 50% complete (batch 91/181)
2025-12-24 11:12:30 INFO Epoch 000 | 75% complete (batch 136/181)
2025-12-24 11:12:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.140798
2025-12-24 11:12:44 INFO Tuning ranking metrics: regret=0.189071 spearman=-0.045449 (groups=37, skipped=311)
2025-12-24 11:12:44 INFO Epoch 000 | val_loss=0.140798
Metric tuning_rank_spearman improved. New best score: -0.045
2025-12-24 11:12:53 INFO Epoch 001 | 25% complete (batch 46/181)
2025-12-24 11:12:54 INFO Epoch 001 | 50% complete (batch 91/181)
2025-12-24 11:12:55 INFO Epoch 001 | 75% complete (batch 136/181)
2025-12-24 11:13:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.043451
2025-12-24 11:13:09 INFO Tuning ranking metrics: regret=0.175462 spearman=0.037382 (groups=37, skipped=311)
2025-12-24 11:13:09 INFO Epoch 001 | train_mse=0.145997 | val_loss=0.140836 | best_val_loss=-0.045449
Metric tuning_rank_spearman improved by 0.083 >= min_delta = 0.0. New best score: 0.037
2025-12-24 11:13:17 INFO Epoch 002 | 25% complete (batch 46/181)
2025-12-24 11:13:18 INFO Epoch 002 | 50% complete (batch 91/181)
2025-12-24 11:13:19 INFO Epoch 002 | 75% complete (batch 136/181)
2025-12-24 11:13:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.083492
2025-12-24 11:13:33 INFO Tuning ranking metrics: regret=0.175441 spearman=-0.016462 (groups=37, skipped=311)
2025-12-24 11:13:33 INFO Epoch 002 | train_mse=0.147013 | val_loss=0.140668 | best_val_loss=0.037382
2025-12-24 11:13:43 INFO Epoch 003 | 25% complete (batch 46/181)
2025-12-24 11:13:43 INFO Epoch 003 | 50% complete (batch 91/181)
2025-12-24 11:13:44 INFO Epoch 003 | 75% complete (batch 136/181)
2025-12-24 11:13:53 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.041442
2025-12-24 11:13:59 INFO Tuning ranking metrics: regret=0.177312 spearman=-0.046935 (groups=37, skipped=311)
2025-12-24 11:13:59 INFO Epoch 003 | train_mse=0.149839 | val_loss=0.140588 | best_val_loss=0.037382
2025-12-24 11:14:07 INFO Epoch 004 | 25% complete (batch 46/181)
2025-12-24 11:14:09 INFO Epoch 004 | 50% complete (batch 91/181)
2025-12-24 11:14:10 INFO Epoch 004 | 75% complete (batch 136/181)
2025-12-24 11:14:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.023596
2025-12-24 11:14:24 INFO Tuning ranking metrics: regret=0.183013 spearman=-0.200761 (groups=37, skipped=311)
2025-12-24 11:14:24 INFO Epoch 004 | train_mse=0.145168 | val_loss=0.140640 | best_val_loss=0.037382
2025-12-24 11:14:32 INFO Epoch 005 | 25% complete (batch 46/181)
2025-12-24 11:14:33 INFO Epoch 005 | 50% complete (batch 91/181)
2025-12-24 11:14:34 INFO Epoch 005 | 75% complete (batch 136/181)
2025-12-24 11:14:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.313863
2025-12-24 11:14:48 INFO Tuning ranking metrics: regret=0.145247 spearman=-0.071832 (groups=37, skipped=311)
2025-12-24 11:14:48 INFO Epoch 005 | train_mse=0.134661 | val_loss=0.140081 | best_val_loss=0.037382
2025-12-24 11:14:56 INFO Epoch 006 | 25% complete (batch 46/181)
2025-12-24 11:14:57 INFO Epoch 006 | 50% complete (batch 91/181)
2025-12-24 11:14:58 INFO Epoch 006 | 75% complete (batch 136/181)
2025-12-24 11:15:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.350435
2025-12-24 11:15:12 INFO Tuning ranking metrics: regret=0.192945 spearman=-0.261466 (groups=37, skipped=311)
2025-12-24 11:15:12 INFO Epoch 006 | train_mse=0.142279 | val_loss=0.144187 | best_val_loss=0.037382
2025-12-24 11:15:21 INFO Epoch 007 | 25% complete (batch 46/181)
2025-12-24 11:15:22 INFO Epoch 007 | 50% complete (batch 91/181)
2025-12-24 11:15:22 INFO Epoch 007 | 75% complete (batch 136/181)
2025-12-24 11:15:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.038614
2025-12-24 11:15:36 INFO Tuning ranking metrics: regret=0.191267 spearman=-0.253843 (groups=37, skipped=311)
2025-12-24 11:15:36 INFO Epoch 007 | train_mse=0.139823 | val_loss=0.140529 | best_val_loss=0.037382
2025-12-24 11:15:45 INFO Epoch 008 | 25% complete (batch 46/181)
2025-12-24 11:15:46 INFO Epoch 008 | 50% complete (batch 91/181)
2025-12-24 11:15:47 INFO Epoch 008 | 75% complete (batch 136/181)
2025-12-24 11:15:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.063040
2025-12-24 11:16:01 INFO Tuning ranking metrics: regret=0.153343 spearman=-0.233556 (groups=37, skipped=311)
2025-12-24 11:16:01 INFO Epoch 008 | train_mse=0.152644 | val_loss=0.140583 | best_val_loss=0.037382
2025-12-24 11:16:09 INFO Epoch 009 | 25% complete (batch 46/181)
2025-12-24 11:16:10 INFO Epoch 009 | 50% complete (batch 91/181)
2025-12-24 11:16:11 INFO Epoch 009 | 75% complete (batch 136/181)
2025-12-24 11:16:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.164907
2025-12-24 11:16:25 INFO Tuning ranking metrics: regret=0.173742 spearman=-0.084591 (groups=37, skipped=311)
2025-12-24 11:16:25 INFO Epoch 009 | train_mse=0.145266 | val_loss=0.147743 | best_val_loss=0.037382
2025-12-24 11:16:34 INFO Epoch 010 | 25% complete (batch 46/181)
2025-12-24 11:16:35 INFO Epoch 010 | 50% complete (batch 91/181)
2025-12-24 11:16:35 INFO Epoch 010 | 75% complete (batch 136/181)
2025-12-24 11:16:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.009160
2025-12-24 11:16:49 INFO Tuning ranking metrics: regret=0.167298 spearman=0.087493 (groups=37, skipped=311)
2025-12-24 11:16:49 INFO Epoch 010 | train_mse=0.156751 | val_loss=0.142518 | best_val_loss=0.037382
Metric tuning_rank_spearman improved by 0.050 >= min_delta = 0.0. New best score: 0.087
2025-12-24 11:16:58 INFO Epoch 011 | 25% complete (batch 46/181)
2025-12-24 11:16:59 INFO Epoch 011 | 50% complete (batch 91/181)
2025-12-24 11:17:00 INFO Epoch 011 | 75% complete (batch 136/181)
2025-12-24 11:17:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.140288
2025-12-24 11:17:14 INFO Tuning ranking metrics: regret=0.170198 spearman=-0.090763 (groups=37, skipped=311)
2025-12-24 11:17:14 INFO Epoch 011 | train_mse=0.151729 | val_loss=0.140288 | best_val_loss=0.087493
2025-12-24 11:17:23 INFO Epoch 012 | 25% complete (batch 46/181)
2025-12-24 11:17:23 INFO Epoch 012 | 50% complete (batch 91/181)
2025-12-24 11:17:24 INFO Epoch 012 | 75% complete (batch 136/181)
2025-12-24 11:17:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.079752
2025-12-24 11:17:39 INFO Tuning ranking metrics: regret=0.195005 spearman=0.110694 (groups=37, skipped=311)
2025-12-24 11:17:39 INFO Epoch 012 | train_mse=0.150894 | val_loss=0.141779 | best_val_loss=0.087493
Metric tuning_rank_spearman improved by 0.023 >= min_delta = 0.0. New best score: 0.111
2025-12-24 11:17:48 INFO Epoch 013 | 25% complete (batch 46/181)
2025-12-24 11:17:49 INFO Epoch 013 | 50% complete (batch 91/181)
2025-12-24 11:17:50 INFO Epoch 013 | 75% complete (batch 136/181)
2025-12-24 11:17:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.140817
2025-12-24 11:18:04 INFO Tuning ranking metrics: regret=0.150790 spearman=-0.148391 (groups=37, skipped=311)
2025-12-24 11:18:04 INFO Epoch 013 | train_mse=0.140795 | val_loss=0.140817 | best_val_loss=0.110694
2025-12-24 11:18:12 INFO Epoch 014 | 25% complete (batch 46/181)
2025-12-24 11:18:13 INFO Epoch 014 | 50% complete (batch 91/181)
2025-12-24 11:18:14 INFO Epoch 014 | 75% complete (batch 136/181)
2025-12-24 11:18:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.100870
2025-12-24 11:18:28 INFO Tuning ranking metrics: regret=0.182111 spearman=0.101966 (groups=37, skipped=311)
2025-12-24 11:18:28 INFO Epoch 014 | train_mse=0.145782 | val_loss=0.140849 | best_val_loss=0.110694
2025-12-24 11:18:37 INFO Epoch 015 | 25% complete (batch 46/181)
2025-12-24 11:18:38 INFO Epoch 015 | 50% complete (batch 91/181)
2025-12-24 11:18:39 INFO Epoch 015 | 75% complete (batch 136/181)
2025-12-24 11:18:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.141251
2025-12-24 11:18:53 INFO Tuning ranking metrics: regret=0.163445 spearman=0.094972 (groups=37, skipped=311)
2025-12-24 11:18:53 INFO Epoch 015 | train_mse=0.149802 | val_loss=0.141251 | best_val_loss=0.110694
2025-12-24 11:19:01 INFO Epoch 016 | 25% complete (batch 46/181)
2025-12-24 11:19:02 INFO Epoch 016 | 50% complete (batch 91/181)
2025-12-24 11:19:03 INFO Epoch 016 | 75% complete (batch 136/181)
2025-12-24 11:19:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.179933
2025-12-24 11:19:17 INFO Tuning ranking metrics: regret=0.197431 spearman=-0.101808 (groups=37, skipped=311)
2025-12-24 11:19:17 INFO Epoch 016 | train_mse=0.158996 | val_loss=0.140543 | best_val_loss=0.110694
2025-12-24 11:19:26 INFO Epoch 017 | 25% complete (batch 46/181)
2025-12-24 11:19:27 INFO Epoch 017 | 50% complete (batch 91/181)
2025-12-24 11:19:28 INFO Epoch 017 | 75% complete (batch 136/181)
2025-12-24 11:19:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.010777
2025-12-24 11:19:42 INFO Tuning ranking metrics: regret=0.142081 spearman=-0.142799 (groups=37, skipped=311)
2025-12-24 11:19:42 INFO Epoch 017 | train_mse=0.145989 | val_loss=0.141077 | best_val_loss=0.110694
2025-12-24 11:19:52 INFO Epoch 018 | 25% complete (batch 46/181)
2025-12-24 11:19:53 INFO Epoch 018 | 50% complete (batch 91/181)
2025-12-24 11:19:54 INFO Epoch 018 | 75% complete (batch 136/181)
2025-12-24 11:20:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.373971
2025-12-24 11:20:08 INFO Tuning ranking metrics: regret=0.165357 spearman=-0.194454 (groups=37, skipped=311)
2025-12-24 11:20:08 INFO Epoch 018 | train_mse=0.147401 | val_loss=0.136698 | best_val_loss=0.110694
2025-12-24 11:20:16 INFO Epoch 019 | 25% complete (batch 46/181)
2025-12-24 11:20:17 INFO Epoch 019 | 50% complete (batch 91/181)
2025-12-24 11:20:18 INFO Epoch 019 | 75% complete (batch 136/181)
2025-12-24 11:20:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.358289
2025-12-24 11:20:32 INFO Tuning ranking metrics: regret=0.168511 spearman=-0.141722 (groups=37, skipped=311)
2025-12-24 11:20:32 INFO Epoch 019 | train_mse=0.140671 | val_loss=0.126222 | best_val_loss=0.110694
2025-12-24 11:20:41 INFO Epoch 020 | 25% complete (batch 46/181)
2025-12-24 11:20:42 INFO Epoch 020 | 50% complete (batch 91/181)
2025-12-24 11:20:43 INFO Epoch 020 | 75% complete (batch 136/181)
2025-12-24 11:20:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.454061
2025-12-24 11:20:57 INFO Tuning ranking metrics: regret=0.172208 spearman=-0.030163 (groups=37, skipped=311)
2025-12-24 11:20:57 INFO Epoch 020 | train_mse=0.155103 | val_loss=0.140712 | best_val_loss=0.110694
2025-12-24 11:21:06 INFO Epoch 021 | 25% complete (batch 46/181)
2025-12-24 11:21:07 INFO Epoch 021 | 50% complete (batch 91/181)
2025-12-24 11:21:08 INFO Epoch 021 | 75% complete (batch 136/181)
2025-12-24 11:21:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.457345
2025-12-24 11:21:22 INFO Tuning ranking metrics: regret=0.190184 spearman=-0.079578 (groups=37, skipped=311)
2025-12-24 11:21:22 INFO Epoch 021 | train_mse=0.148995 | val_loss=0.143750 | best_val_loss=0.110694
2025-12-24 11:21:31 INFO Epoch 022 | 25% complete (batch 46/181)
2025-12-24 11:21:32 INFO Epoch 022 | 50% complete (batch 91/181)
2025-12-24 11:21:33 INFO Epoch 022 | 75% complete (batch 136/181)
2025-12-24 11:21:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.530571
2025-12-24 11:21:47 INFO Tuning ranking metrics: regret=0.152695 spearman=0.001053 (groups=37, skipped=311)
2025-12-24 11:21:47 INFO Epoch 022 | train_mse=0.128470 | val_loss=0.137644 | best_val_loss=0.110694
2025-12-24 11:21:56 INFO Epoch 023 | 25% complete (batch 46/181)
2025-12-24 11:21:57 INFO Epoch 023 | 50% complete (batch 91/181)
2025-12-24 11:21:58 INFO Epoch 023 | 75% complete (batch 136/181)
2025-12-24 11:22:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.534420
2025-12-24 11:22:13 INFO Tuning ranking metrics: regret=0.151411 spearman=0.000819 (groups=37, skipped=311)
2025-12-24 11:22:13 INFO Epoch 023 | train_mse=0.130411 | val_loss=0.103681 | best_val_loss=0.110694
2025-12-24 11:22:22 INFO Epoch 024 | 25% complete (batch 46/181)
2025-12-24 11:22:23 INFO Epoch 024 | 50% complete (batch 91/181)
2025-12-24 11:22:24 INFO Epoch 024 | 75% complete (batch 136/181)
2025-12-24 11:22:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.573941
2025-12-24 11:22:38 INFO Tuning ranking metrics: regret=0.150449 spearman=0.029192 (groups=37, skipped=311)
2025-12-24 11:22:38 INFO Epoch 024 | train_mse=0.135096 | val_loss=0.101165 | best_val_loss=0.110694
2025-12-24 11:22:46 INFO Epoch 025 | 25% complete (batch 46/181)
2025-12-24 11:22:47 INFO Epoch 025 | 50% complete (batch 91/181)
2025-12-24 11:22:48 INFO Epoch 025 | 75% complete (batch 136/181)
2025-12-24 11:22:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.561071
2025-12-24 11:23:02 INFO Tuning ranking metrics: regret=0.152874 spearman=0.028753 (groups=37, skipped=311)
2025-12-24 11:23:02 INFO Epoch 025 | train_mse=0.128019 | val_loss=0.129360 | best_val_loss=0.110694
2025-12-24 11:23:11 INFO Epoch 026 | 25% complete (batch 46/181)
2025-12-24 11:23:12 INFO Epoch 026 | 50% complete (batch 91/181)
2025-12-24 11:23:13 INFO Epoch 026 | 75% complete (batch 136/181)
2025-12-24 11:23:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.612190
2025-12-24 11:23:27 INFO Tuning ranking metrics: regret=0.134579 spearman=0.099023 (groups=37, skipped=311)
2025-12-24 11:23:27 INFO Epoch 026 | train_mse=0.100602 | val_loss=0.084379 | best_val_loss=0.110694
2025-12-24 11:23:36 INFO Epoch 027 | 25% complete (batch 46/181)
2025-12-24 11:23:37 INFO Epoch 027 | 50% complete (batch 91/181)
2025-12-24 11:23:38 INFO Epoch 027 | 75% complete (batch 136/181)
2025-12-24 11:23:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.603442
2025-12-24 11:23:52 INFO Tuning ranking metrics: regret=0.132506 spearman=0.111331 (groups=37, skipped=311)
2025-12-24 11:23:52 INFO Epoch 027 | train_mse=0.108704 | val_loss=0.105132 | best_val_loss=0.110694
Metric tuning_rank_spearman improved by 0.001 >= min_delta = 0.0. New best score: 0.111
2025-12-24 11:24:01 INFO Epoch 028 | 25% complete (batch 46/181)
2025-12-24 11:24:02 INFO Epoch 028 | 50% complete (batch 91/181)
2025-12-24 11:24:03 INFO Epoch 028 | 75% complete (batch 136/181)
2025-12-24 11:24:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.633718
2025-12-24 11:24:17 INFO Tuning ranking metrics: regret=0.132371 spearman=0.096578 (groups=37, skipped=311)
2025-12-24 11:24:17 INFO Epoch 028 | train_mse=0.101319 | val_loss=0.073347 | best_val_loss=0.111331
2025-12-24 11:24:26 INFO Epoch 029 | 25% complete (batch 46/181)
2025-12-24 11:24:27 INFO Epoch 029 | 50% complete (batch 91/181)
2025-12-24 11:24:28 INFO Epoch 029 | 75% complete (batch 136/181)
2025-12-24 11:24:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.650548
2025-12-24 11:24:42 INFO Tuning ranking metrics: regret=0.132714 spearman=0.141278 (groups=37, skipped=311)
2025-12-24 11:24:42 INFO Epoch 029 | train_mse=0.101929 | val_loss=0.077057 | best_val_loss=0.111331
Metric tuning_rank_spearman improved by 0.030 >= min_delta = 0.0. New best score: 0.141
2025-12-24 11:24:50 INFO Epoch 030 | 25% complete (batch 46/181)
2025-12-24 11:24:51 INFO Epoch 030 | 50% complete (batch 91/181)
2025-12-24 11:24:52 INFO Epoch 030 | 75% complete (batch 136/181)
2025-12-24 11:25:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.652309
2025-12-24 11:25:06 INFO Tuning ranking metrics: regret=0.150766 spearman=0.121107 (groups=37, skipped=311)
2025-12-24 11:25:06 INFO Epoch 030 | train_mse=0.109933 | val_loss=0.085893 | best_val_loss=0.141278
2025-12-24 11:25:14 INFO Epoch 031 | 25% complete (batch 46/181)
2025-12-24 11:25:15 INFO Epoch 031 | 50% complete (batch 91/181)
2025-12-24 11:25:16 INFO Epoch 031 | 75% complete (batch 136/181)
2025-12-24 11:25:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.646943
2025-12-24 11:25:31 INFO Tuning ranking metrics: regret=0.133925 spearman=0.089710 (groups=37, skipped=311)
2025-12-24 11:25:31 INFO Epoch 031 | train_mse=0.101040 | val_loss=0.085860 | best_val_loss=0.141278
2025-12-24 11:25:39 INFO Epoch 032 | 25% complete (batch 46/181)
2025-12-24 11:25:40 INFO Epoch 032 | 50% complete (batch 91/181)
2025-12-24 11:25:41 INFO Epoch 032 | 75% complete (batch 136/181)
2025-12-24 11:25:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.684483
2025-12-24 11:25:55 INFO Tuning ranking metrics: regret=0.124953 spearman=0.202334 (groups=37, skipped=311)
2025-12-24 11:25:55 INFO Epoch 032 | train_mse=0.087415 | val_loss=0.072347 | best_val_loss=0.141278
Metric tuning_rank_spearman improved by 0.061 >= min_delta = 0.0. New best score: 0.202
2025-12-24 11:26:04 INFO Epoch 033 | 25% complete (batch 46/181)
2025-12-24 11:26:05 INFO Epoch 033 | 50% complete (batch 91/181)
2025-12-24 11:26:06 INFO Epoch 033 | 75% complete (batch 136/181)
2025-12-24 11:26:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.696434
2025-12-24 11:26:20 INFO Tuning ranking metrics: regret=0.122930 spearman=0.115315 (groups=37, skipped=311)
2025-12-24 11:26:20 INFO Epoch 033 | train_mse=0.084963 | val_loss=0.057664 | best_val_loss=0.202334
2025-12-24 11:26:28 INFO Epoch 034 | 25% complete (batch 46/181)
2025-12-24 11:26:29 INFO Epoch 034 | 50% complete (batch 91/181)
2025-12-24 11:26:30 INFO Epoch 034 | 75% complete (batch 136/181)
2025-12-24 11:26:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.695546
2025-12-24 11:26:45 INFO Tuning ranking metrics: regret=0.117646 spearman=0.139207 (groups=37, skipped=311)
2025-12-24 11:26:45 INFO Epoch 034 | train_mse=0.066290 | val_loss=0.062995 | best_val_loss=0.202334
2025-12-24 11:26:53 INFO Epoch 035 | 25% complete (batch 46/181)
2025-12-24 11:26:54 INFO Epoch 035 | 50% complete (batch 91/181)
2025-12-24 11:26:55 INFO Epoch 035 | 75% complete (batch 136/181)
2025-12-24 11:27:04 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.673525
2025-12-24 11:27:09 INFO Tuning ranking metrics: regret=0.130146 spearman=0.132228 (groups=37, skipped=311)
2025-12-24 11:27:09 INFO Epoch 035 | train_mse=0.070818 | val_loss=0.076582 | best_val_loss=0.202334
2025-12-24 11:27:18 INFO Epoch 036 | 25% complete (batch 46/181)
2025-12-24 11:27:18 INFO Epoch 036 | 50% complete (batch 91/181)
2025-12-24 11:27:19 INFO Epoch 036 | 75% complete (batch 136/181)
2025-12-24 11:27:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.711986
2025-12-24 11:27:33 INFO Tuning ranking metrics: regret=0.130592 spearman=0.064046 (groups=37, skipped=311)
2025-12-24 11:27:33 INFO Epoch 036 | train_mse=0.072153 | val_loss=0.059600 | best_val_loss=0.202334
2025-12-24 11:27:42 INFO Epoch 037 | 25% complete (batch 46/181)
2025-12-24 11:27:43 INFO Epoch 037 | 50% complete (batch 91/181)
2025-12-24 11:27:45 INFO Epoch 037 | 75% complete (batch 136/181)
2025-12-24 11:27:53 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.693748
2025-12-24 11:27:58 INFO Tuning ranking metrics: regret=0.139385 spearman=0.058313 (groups=37, skipped=311)
2025-12-24 11:27:58 INFO Epoch 037 | train_mse=0.088965 | val_loss=0.068364 | best_val_loss=0.202334
2025-12-24 11:28:07 INFO Epoch 038 | 25% complete (batch 46/181)
2025-12-24 11:28:08 INFO Epoch 038 | 50% complete (batch 91/181)
2025-12-24 11:28:09 INFO Epoch 038 | 75% complete (batch 136/181)
2025-12-24 11:28:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.712027
2025-12-24 11:28:23 INFO Tuning ranking metrics: regret=0.130616 spearman=0.056956 (groups=37, skipped=311)
2025-12-24 11:28:23 INFO Epoch 038 | train_mse=0.080478 | val_loss=0.063281 | best_val_loss=0.202334
2025-12-24 11:28:32 INFO Epoch 039 | 25% complete (batch 46/181)
2025-12-24 11:28:33 INFO Epoch 039 | 50% complete (batch 91/181)
2025-12-24 11:28:34 INFO Epoch 039 | 75% complete (batch 136/181)
2025-12-24 11:28:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.703728
2025-12-24 11:28:48 INFO Tuning ranking metrics: regret=0.122096 spearman=0.083579 (groups=37, skipped=311)
2025-12-24 11:28:48 INFO Epoch 039 | train_mse=0.064876 | val_loss=0.068445 | best_val_loss=0.202334
2025-12-24 11:28:56 INFO Epoch 040 | 25% complete (batch 46/181)
2025-12-24 11:28:57 INFO Epoch 040 | 50% complete (batch 91/181)
2025-12-24 11:28:58 INFO Epoch 040 | 75% complete (batch 136/181)
2025-12-24 11:29:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.735393
2025-12-24 11:29:12 INFO Tuning ranking metrics: regret=0.122177 spearman=0.086580 (groups=37, skipped=311)
2025-12-24 11:29:12 INFO Epoch 040 | train_mse=0.071690 | val_loss=0.057621 | best_val_loss=0.202334
2025-12-24 11:29:21 INFO Epoch 041 | 25% complete (batch 46/181)
2025-12-24 11:29:22 INFO Epoch 041 | 50% complete (batch 91/181)
2025-12-24 11:29:23 INFO Epoch 041 | 75% complete (batch 136/181)
2025-12-24 11:29:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.704332
2025-12-24 11:29:37 INFO Tuning ranking metrics: regret=0.123547 spearman=0.149403 (groups=37, skipped=311)
2025-12-24 11:29:37 INFO Epoch 041 | train_mse=0.076317 | val_loss=0.069065 | best_val_loss=0.202334
2025-12-24 11:29:46 INFO Epoch 042 | 25% complete (batch 46/181)
2025-12-24 11:29:47 INFO Epoch 042 | 50% complete (batch 91/181)
2025-12-24 11:29:48 INFO Epoch 042 | 75% complete (batch 136/181)
2025-12-24 11:29:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.712575
2025-12-24 11:30:02 INFO Tuning ranking metrics: regret=0.127222 spearman=0.130262 (groups=37, skipped=311)
2025-12-24 11:30:02 INFO Epoch 042 | train_mse=0.080756 | val_loss=0.066791 | best_val_loss=0.202334
2025-12-24 11:30:11 INFO Epoch 043 | 25% complete (batch 46/181)
2025-12-24 11:30:12 INFO Epoch 043 | 50% complete (batch 91/181)
2025-12-24 11:30:13 INFO Epoch 043 | 75% complete (batch 136/181)
2025-12-24 11:30:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.709373
2025-12-24 11:30:27 INFO Tuning ranking metrics: regret=0.121769 spearman=0.111226 (groups=37, skipped=311)
2025-12-24 11:30:27 INFO Epoch 043 | train_mse=0.078143 | val_loss=0.055003 | best_val_loss=0.202334
2025-12-24 11:30:36 INFO Epoch 044 | 25% complete (batch 46/181)
2025-12-24 11:30:36 INFO Epoch 044 | 50% complete (batch 91/181)
2025-12-24 11:30:37 INFO Epoch 044 | 75% complete (batch 136/181)
2025-12-24 11:30:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.712242
2025-12-24 11:30:52 INFO Tuning ranking metrics: regret=0.122590 spearman=0.096367 (groups=37, skipped=311)
2025-12-24 11:30:52 INFO Epoch 044 | train_mse=0.059776 | val_loss=0.061943 | best_val_loss=0.202334
2025-12-24 11:31:00 INFO Epoch 045 | 25% complete (batch 46/181)
2025-12-24 11:31:01 INFO Epoch 045 | 50% complete (batch 91/181)
2025-12-24 11:31:02 INFO Epoch 045 | 75% complete (batch 136/181)
2025-12-24 11:31:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.695451
2025-12-24 11:31:16 INFO Tuning ranking metrics: regret=0.132676 spearman=0.037036 (groups=37, skipped=311)
2025-12-24 11:31:16 INFO Epoch 045 | train_mse=0.081598 | val_loss=0.069445 | best_val_loss=0.202334
2025-12-24 11:31:25 INFO Epoch 046 | 25% complete (batch 46/181)
2025-12-24 11:31:26 INFO Epoch 046 | 50% complete (batch 91/181)
2025-12-24 11:31:27 INFO Epoch 046 | 75% complete (batch 136/181)
2025-12-24 11:31:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.694280
2025-12-24 11:31:41 INFO Tuning ranking metrics: regret=0.127623 spearman=0.085118 (groups=37, skipped=311)
2025-12-24 11:31:41 INFO Epoch 046 | train_mse=0.056291 | val_loss=0.062701 | best_val_loss=0.202334
2025-12-24 11:31:49 INFO Epoch 047 | 25% complete (batch 46/181)
2025-12-24 11:31:50 INFO Epoch 047 | 50% complete (batch 91/181)
2025-12-24 11:31:51 INFO Epoch 047 | 75% complete (batch 136/181)
2025-12-24 11:32:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.694559
2025-12-24 11:32:05 INFO Tuning ranking metrics: regret=0.122911 spearman=0.094460 (groups=37, skipped=311)
2025-12-24 11:32:05 INFO Epoch 047 | train_mse=0.073747 | val_loss=0.063882 | best_val_loss=0.202334
2025-12-24 11:32:14 INFO Epoch 048 | 25% complete (batch 46/181)
2025-12-24 11:32:15 INFO Epoch 048 | 50% complete (batch 91/181)
2025-12-24 11:32:16 INFO Epoch 048 | 75% complete (batch 136/181)
2025-12-24 11:32:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.708673
2025-12-24 11:32:29 INFO Tuning ranking metrics: regret=0.099067 spearman=0.160413 (groups=37, skipped=311)
2025-12-24 11:32:29 INFO Epoch 048 | train_mse=0.074194 | val_loss=0.055518 | best_val_loss=0.202334
2025-12-24 11:32:38 INFO Epoch 049 | 25% complete (batch 46/181)
2025-12-24 11:32:40 INFO Epoch 049 | 50% complete (batch 91/181)
2025-12-24 11:32:41 INFO Epoch 049 | 75% complete (batch 136/181)
2025-12-24 11:32:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.686002
2025-12-24 11:32:54 INFO Tuning ranking metrics: regret=0.113069 spearman=0.138435 (groups=37, skipped=311)
2025-12-24 11:32:54 INFO Epoch 049 | train_mse=0.067944 | val_loss=0.087278 | best_val_loss=0.202334
2025-12-24 11:33:03 INFO Epoch 050 | 25% complete (batch 46/181)
2025-12-24 11:33:04 INFO Epoch 050 | 50% complete (batch 91/181)
2025-12-24 11:33:05 INFO Epoch 050 | 75% complete (batch 136/181)
2025-12-24 11:33:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.716191
2025-12-24 11:33:19 INFO Tuning ranking metrics: regret=0.110150 spearman=0.139201 (groups=37, skipped=311)
2025-12-24 11:33:19 INFO Epoch 050 | train_mse=0.072165 | val_loss=0.075365 | best_val_loss=0.202334
2025-12-24 11:33:27 INFO Epoch 051 | 25% complete (batch 46/181)
2025-12-24 11:33:28 INFO Epoch 051 | 50% complete (batch 91/181)
2025-12-24 11:33:29 INFO Epoch 051 | 75% complete (batch 136/181)
2025-12-24 11:33:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.741856
2025-12-24 11:33:43 INFO Tuning ranking metrics: regret=0.127999 spearman=0.124588 (groups=37, skipped=311)
2025-12-24 11:33:43 INFO Epoch 051 | train_mse=0.072075 | val_loss=0.054898 | best_val_loss=0.202334
2025-12-24 11:33:52 INFO Epoch 052 | 25% complete (batch 46/181)
2025-12-24 11:33:53 INFO Epoch 052 | 50% complete (batch 91/181)
2025-12-24 11:33:54 INFO Epoch 052 | 75% complete (batch 136/181)
2025-12-24 11:34:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.703056
2025-12-24 11:34:08 INFO Tuning ranking metrics: regret=0.128921 spearman=0.124465 (groups=37, skipped=311)
2025-12-24 11:34:08 INFO Epoch 052 | train_mse=0.051190 | val_loss=0.087343 | best_val_loss=0.202334
2025-12-24 11:34:16 INFO Epoch 053 | 25% complete (batch 46/181)
2025-12-24 11:34:17 INFO Epoch 053 | 50% complete (batch 91/181)
2025-12-24 11:34:18 INFO Epoch 053 | 75% complete (batch 136/181)
2025-12-24 11:34:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.723852
2025-12-24 11:34:32 INFO Tuning ranking metrics: regret=0.117612 spearman=0.107096 (groups=37, skipped=311)
2025-12-24 11:34:32 INFO Epoch 053 | train_mse=0.057064 | val_loss=0.058734 | best_val_loss=0.202334
2025-12-24 11:34:41 INFO Epoch 054 | 25% complete (batch 46/181)
2025-12-24 11:34:42 INFO Epoch 054 | 50% complete (batch 91/181)
2025-12-24 11:34:43 INFO Epoch 054 | 75% complete (batch 136/181)
2025-12-24 11:34:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.732597
2025-12-24 11:34:56 INFO Tuning ranking metrics: regret=0.118040 spearman=0.088903 (groups=37, skipped=311)
2025-12-24 11:34:56 INFO Epoch 054 | train_mse=0.080057 | val_loss=0.051229 | best_val_loss=0.202334
2025-12-24 11:35:06 INFO Epoch 055 | 25% complete (batch 46/181)
2025-12-24 11:35:07 INFO Epoch 055 | 50% complete (batch 91/181)
2025-12-24 11:35:08 INFO Epoch 055 | 75% complete (batch 136/181)
2025-12-24 11:35:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.729641
2025-12-24 11:35:22 INFO Tuning ranking metrics: regret=0.112619 spearman=0.155090 (groups=37, skipped=311)
2025-12-24 11:35:22 INFO Epoch 055 | train_mse=0.062455 | val_loss=0.060138 | best_val_loss=0.202334
2025-12-24 11:35:30 INFO Epoch 056 | 25% complete (batch 46/181)
2025-12-24 11:35:31 INFO Epoch 056 | 50% complete (batch 91/181)
2025-12-24 11:35:32 INFO Epoch 056 | 75% complete (batch 136/181)
2025-12-24 11:35:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.707052
2025-12-24 11:35:46 INFO Tuning ranking metrics: regret=0.111160 spearman=0.131801 (groups=37, skipped=311)
2025-12-24 11:35:46 INFO Epoch 056 | train_mse=0.069802 | val_loss=0.093827 | best_val_loss=0.202334
2025-12-24 11:35:55 INFO Epoch 057 | 25% complete (batch 46/181)
2025-12-24 11:35:56 INFO Epoch 057 | 50% complete (batch 91/181)
2025-12-24 11:35:57 INFO Epoch 057 | 75% complete (batch 136/181)
2025-12-24 11:36:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.741934
2025-12-24 11:36:11 INFO Tuning ranking metrics: regret=0.110129 spearman=0.126694 (groups=37, skipped=311)
2025-12-24 11:36:11 INFO Epoch 057 | train_mse=0.068993 | val_loss=0.052556 | best_val_loss=0.202334
2025-12-24 11:36:20 INFO Epoch 058 | 25% complete (batch 46/181)
2025-12-24 11:36:21 INFO Epoch 058 | 50% complete (batch 91/181)
2025-12-24 11:36:22 INFO Epoch 058 | 75% complete (batch 136/181)
2025-12-24 11:36:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.748873
2025-12-24 11:36:36 INFO Tuning ranking metrics: regret=0.110129 spearman=0.134117 (groups=37, skipped=311)
2025-12-24 11:36:36 INFO Epoch 058 | train_mse=0.076024 | val_loss=0.052811 | best_val_loss=0.202334
2025-12-24 11:36:45 INFO Epoch 059 | 25% complete (batch 46/181)
2025-12-24 11:36:45 INFO Epoch 059 | 50% complete (batch 91/181)
2025-12-24 11:36:47 INFO Epoch 059 | 75% complete (batch 136/181)
2025-12-24 11:36:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.683961
2025-12-24 11:37:01 INFO Tuning ranking metrics: regret=0.103872 spearman=0.155166 (groups=37, skipped=311)
2025-12-24 11:37:01 INFO Epoch 059 | train_mse=0.056059 | val_loss=0.107813 | best_val_loss=0.202334
2025-12-24 11:37:09 INFO Epoch 060 | 25% complete (batch 46/181)
2025-12-24 11:37:11 INFO Epoch 060 | 50% complete (batch 91/181)
2025-12-24 11:37:12 INFO Epoch 060 | 75% complete (batch 136/181)
2025-12-24 11:37:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.721405
2025-12-24 11:37:25 INFO Tuning ranking metrics: regret=0.110129 spearman=0.102872 (groups=37, skipped=311)
2025-12-24 11:37:25 INFO Epoch 060 | train_mse=0.084283 | val_loss=0.055798 | best_val_loss=0.202334
2025-12-24 11:37:34 INFO Epoch 061 | 25% complete (batch 46/181)
2025-12-24 11:37:35 INFO Epoch 061 | 50% complete (batch 91/181)
2025-12-24 11:37:36 INFO Epoch 061 | 75% complete (batch 136/181)
2025-12-24 11:37:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.723162
2025-12-24 11:37:50 INFO Tuning ranking metrics: regret=0.109811 spearman=0.131432 (groups=37, skipped=311)
2025-12-24 11:37:50 INFO Epoch 061 | train_mse=0.062050 | val_loss=0.062593 | best_val_loss=0.202334
2025-12-24 11:37:59 INFO Epoch 062 | 25% complete (batch 46/181)
2025-12-24 11:38:00 INFO Epoch 062 | 50% complete (batch 91/181)
2025-12-24 11:38:01 INFO Epoch 062 | 75% complete (batch 136/181)
2025-12-24 11:38:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.724685
2025-12-24 11:38:15 INFO Tuning ranking metrics: regret=0.116173 spearman=0.095174 (groups=37, skipped=311)
2025-12-24 11:38:15 INFO Epoch 062 | train_mse=0.079053 | val_loss=0.058873 | best_val_loss=0.202334
2025-12-24 11:38:23 INFO Epoch 063 | 25% complete (batch 46/181)
2025-12-24 11:38:24 INFO Epoch 063 | 50% complete (batch 91/181)
2025-12-24 11:38:25 INFO Epoch 063 | 75% complete (batch 136/181)
2025-12-24 11:38:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.671575
2025-12-24 11:38:39 INFO Tuning ranking metrics: regret=0.109811 spearman=0.131356 (groups=37, skipped=311)
2025-12-24 11:38:39 INFO Epoch 063 | train_mse=0.061021 | val_loss=0.098770 | best_val_loss=0.202334
2025-12-24 11:38:48 INFO Epoch 064 | 25% complete (batch 46/181)
2025-12-24 11:38:49 INFO Epoch 064 | 50% complete (batch 91/181)
2025-12-24 11:38:50 INFO Epoch 064 | 75% complete (batch 136/181)
2025-12-24 11:38:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.726353
2025-12-24 11:39:03 INFO Tuning ranking metrics: regret=0.116248 spearman=0.132462 (groups=37, skipped=311)
2025-12-24 11:39:03 INFO Epoch 064 | train_mse=0.060716 | val_loss=0.057876 | best_val_loss=0.202334
2025-12-24 11:39:12 INFO Epoch 065 | 25% complete (batch 46/181)
2025-12-24 11:39:13 INFO Epoch 065 | 50% complete (batch 91/181)
2025-12-24 11:39:14 INFO Epoch 065 | 75% complete (batch 136/181)
2025-12-24 11:39:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.723975
2025-12-24 11:39:28 INFO Tuning ranking metrics: regret=0.114148 spearman=0.116813 (groups=37, skipped=311)
2025-12-24 11:39:28 INFO Epoch 065 | train_mse=0.068829 | val_loss=0.059365 | best_val_loss=0.202334
2025-12-24 11:39:36 INFO Epoch 066 | 25% complete (batch 46/181)
2025-12-24 11:39:37 INFO Epoch 066 | 50% complete (batch 91/181)
2025-12-24 11:39:38 INFO Epoch 066 | 75% complete (batch 136/181)
2025-12-24 11:39:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.726393
2025-12-24 11:39:52 INFO Tuning ranking metrics: regret=0.116407 spearman=0.071897 (groups=37, skipped=311)
2025-12-24 11:39:52 INFO Epoch 066 | train_mse=0.073536 | val_loss=0.058439 | best_val_loss=0.202334
2025-12-24 11:40:01 INFO Epoch 067 | 25% complete (batch 46/181)
2025-12-24 11:40:02 INFO Epoch 067 | 50% complete (batch 91/181)
2025-12-24 11:40:03 INFO Epoch 067 | 75% complete (batch 136/181)
2025-12-24 11:40:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.719778
2025-12-24 11:40:17 INFO Tuning ranking metrics: regret=0.115142 spearman=0.092260 (groups=37, skipped=311)
2025-12-24 11:40:17 INFO Epoch 067 | train_mse=0.060392 | val_loss=0.060141 | best_val_loss=0.202334
2025-12-24 11:40:25 INFO Epoch 068 | 25% complete (batch 46/181)
2025-12-24 11:40:26 INFO Epoch 068 | 50% complete (batch 91/181)
2025-12-24 11:40:27 INFO Epoch 068 | 75% complete (batch 136/181)
2025-12-24 11:40:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.722743
2025-12-24 11:40:41 INFO Tuning ranking metrics: regret=0.106207 spearman=0.122985 (groups=37, skipped=311)
2025-12-24 11:40:41 INFO Epoch 068 | train_mse=0.065588 | val_loss=0.056438 | best_val_loss=0.202334
2025-12-24 11:40:50 INFO Epoch 069 | 25% complete (batch 46/181)
2025-12-24 11:40:51 INFO Epoch 069 | 50% complete (batch 91/181)
2025-12-24 11:40:52 INFO Epoch 069 | 75% complete (batch 136/181)
2025-12-24 11:41:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.730227
2025-12-24 11:41:07 INFO Tuning ranking metrics: regret=0.103773 spearman=0.079537 (groups=37, skipped=311)
2025-12-24 11:41:07 INFO Epoch 069 | train_mse=0.059350 | val_loss=0.053633 | best_val_loss=0.202334
2025-12-24 11:41:15 INFO Epoch 070 | 25% complete (batch 46/181)
2025-12-24 11:41:16 INFO Epoch 070 | 50% complete (batch 91/181)
2025-12-24 11:41:17 INFO Epoch 070 | 75% complete (batch 136/181)
2025-12-24 11:41:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.725260
2025-12-24 11:41:31 INFO Tuning ranking metrics: regret=0.107218 spearman=0.082754 (groups=37, skipped=311)
2025-12-24 11:41:31 INFO Epoch 070 | train_mse=0.055319 | val_loss=0.065357 | best_val_loss=0.202334
2025-12-24 11:41:40 INFO Epoch 071 | 25% complete (batch 46/181)
2025-12-24 11:41:40 INFO Epoch 071 | 50% complete (batch 91/181)
2025-12-24 11:41:41 INFO Epoch 071 | 75% complete (batch 136/181)
2025-12-24 11:41:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.715371
2025-12-24 11:41:55 INFO Tuning ranking metrics: regret=0.115637 spearman=0.054604 (groups=37, skipped=311)
2025-12-24 11:41:55 INFO Epoch 071 | train_mse=0.056054 | val_loss=0.072463 | best_val_loss=0.202334
2025-12-24 11:42:04 INFO Epoch 072 | 25% complete (batch 46/181)
2025-12-24 11:42:05 INFO Epoch 072 | 50% complete (batch 91/181)
2025-12-24 11:42:06 INFO Epoch 072 | 75% complete (batch 136/181)
2025-12-24 11:42:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.713137
2025-12-24 11:42:20 INFO Tuning ranking metrics: regret=0.115476 spearman=0.047484 (groups=37, skipped=311)
2025-12-24 11:42:20 INFO Epoch 072 | train_mse=0.078436 | val_loss=0.079375 | best_val_loss=0.202334
Monitored metric tuning_rank_spearman did not improve in the last 40 records. Best score: 0.202. Signaling Trainer to stop.
2025-12-24 11:42:21 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.15517_val-0.10781_epoch059.chkpt, checkpoint.tuning_rank_spearman-0.16041_val-0.05552_epoch048.chkpt, checkpoint.tuning_rank_spearman-0.20233_val-0.07235_epoch032.chkpt
2025-12-24 11:42:21 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07/model_checkpoints/checkpoint.tuning_rank_spearman-0.20233_val-0.07235_epoch032.chkpt
2025-12-24 11:42:21 INFO Best validation loss: tensor(0.2023)
2025-12-24 11:42:21 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07/model_checkpoints/checkpoint.tuning_rank_spearman-0.20233_val-0.07235_epoch032.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07/model_checkpoints/checkpoint.tuning_rank_spearman-0.20233_val-0.07235_epoch032.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-24 11:42:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.072347
2025-12-24 11:42:33 INFO Tuning ranking metrics: regret=0.124953 spearman=0.202334 (groups=37, skipped=311)
2025-12-24 11:42:33 INFO Epoch 073 | val_loss=0.072347 | best_val_loss=0.202334
2025-12-24 11:42:34 INFO Validation metrics: [{'val_loss': 0.07234720885753632, 'tuning_rank_regret': 0.12495344877243042, 'tuning_rank_spearman': 0.20233415067195892, 'val_pearson_corr': 0.7296357750892639, 'val_spearman_corr': 0.7540975213050842, 'val_rank_regret': 0.0, 'val_rank_spearman': 0.9444444179534912}]
2025-12-24 11:42:34 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.20233_val-0.07235_epoch032.chkpt
2025-12-24 11:42:34 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.16041_val-0.05552_epoch048.chkpt
2025-12-24 11:42:34 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.15517_val-0.10781_epoch059.chkpt
2025-12-24 11:42:34 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.07335_epoch028.ckpt
2025-12-24 11:42:34 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.12495344877243042
  tuning_rank_spearman      0.20233415067195892
        val_loss            0.07234720885753632
    val_pearson_corr        0.7296357750892639
     val_rank_regret                0.0
    val_rank_spearman       0.9444444179534912
    val_spearman_corr       0.7540975213050842
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run polish_seed101_2025-12-24_11-12-07 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07
[train_cli][batch] job 'polish_seed101' finished.
[train_cli][batch] (2/6) running job 'polish_lr_low_seed101' -> run_name=polish_lr_low_seed101_2025-12-24_11-42-36
[train_cli] run_id=polish_lr_low_seed101_2025-12-24_11-42-36 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-24_11-42-36/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-24_11-42-36 --git-commit 9b1bb2b320 --git-dirty
2025-12-24 11:42:41 INFO git_commit = 9b1bb2b320 (dirty)
2025-12-24 11:42:41 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-24 11:42:41 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-24_11-42-36/config/config.yaml
2025-12-24 11:42:41 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data
2025-12-24 11:42:41 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-24 11:42:41 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-24 11:42:41 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-24_11-42-36
2025-12-24 11:42:41 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-24 11:42:41 INFO   metadata_path = None
2025-12-24 11:42:41 INFO   summary_path = None
2025-12-24 11:42:41 INFO   accelerator = cpu
2025-12-24 11:42:41 INFO   devices = 1
2025-12-24 11:42:41 INFO   attention_head = 8
2025-12-24 11:42:41 INFO   pooling_type = mean
2025-12-24 11:42:41 INFO   model_self_loops = False
2025-12-24 11:42:41 INFO   model_self_loop_fill = mean
2025-12-24 11:42:41 INFO   model_residual = False
2025-12-24 11:42:41 INFO   batch_size = 12
2025-12-24 11:42:41 INFO   learning_rate = 0.002
2025-12-24 11:42:41 INFO   num_epochs = 360
2025-12-24 11:42:41 INFO   accumulate_grad_batches = 48
2025-12-24 11:42:41 INFO   seed = 101
2025-12-24 11:42:41 INFO   num_workers = 2
2025-12-24 11:42:41 INFO   precision = 32
2025-12-24 11:42:41 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-24 11:42:41 INFO   early_stopping_patience = 50
2025-12-24 11:42:41 INFO   lr_scheduler_patience = 25
2025-12-24 11:42:41 INFO   lr_scheduler_factor = 0.3
2025-12-24 11:42:41 INFO   fast_dev_run = False
2025-12-24 11:42:41 INFO   limit_train_batches = None
2025-12-24 11:42:41 INFO   limit_val_batches = None
2025-12-24 11:42:41 INFO   log_lr = False
2025-12-24 11:42:41 INFO   progress_bar_refresh_rate = 0
2025-12-24 11:42:41 INFO   log_every_n_steps = 100
2025-12-24 11:42:41 INFO   use_val_spearman_as_secondary = True
2025-12-24 11:42:41 INFO   spearman_secondary_min_delta = 0.0
2025-12-24 11:42:41 INFO   spearman_secondary_weight = 1.0
2025-12-24 11:42:41 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-24 11:42:41 INFO   tuning_max_samples = 500
2025-12-24 11:42:41 INFO   tuning_fraction = None
2025-12-24 11:42:41 INFO   tuning_eval_every = 1
2025-12-24 11:42:41 INFO   rank_loss_weight = 0.0
2025-12-24 11:42:41 INFO   rank_loss_margin = 0.0
2025-12-24 11:42:41 INFO   rank_loss_mode = hinge
2025-12-24 11:42:41 INFO   rank_loss_grouped = True
2025-12-24 11:42:41 INFO   variance_reduction_enabled = False
2025-12-24 11:42:41 INFO   variance_reduction_method = topk_avg
2025-12-24 11:42:41 INFO   variance_reduction_top_k = 3
2025-12-24 11:42:41 INFO   coverage_minimum = 0.0
2025-12-24 11:42:41 INFO   coverage_fail_on_missing = False
2025-12-24 11:42:41 INFO   graph_load_profiling = False
2025-12-24 11:42:41 INFO   graph_load_top_k = 5
2025-12-24 11:42:41 INFO   enable_graph_cache = True
2025-12-24 11:42:41 INFO   graph_cache_size = 256
2025-12-24 11:42:41 INFO   canonicalize_on_load = False
2025-12-24 11:42:41 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-24 11:42:41 INFO   edge_schema = {}
2025-12-24 11:42:41 INFO   topology_schema = {}
Seed set to 101
2025-12-24 11:42:41 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-24 11:42:41 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 11:42:41 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-24 11:42:41 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 11:42:41 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-24 11:42:41 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 11:42:44 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-24 11:42:44 INFO Tuning group stats: groups=348 groups>=2=37 singletons=311 max_group=11
2025-12-24 11:42:44 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-24_11-42-36/dataset_coverage.json
2025-12-24 11:42:44 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-24_11-42-36/dataset_coverage.json for details.
2025-12-24 11:42:44 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-24_11-42-36/dataset_coverage.json for details.
2025-12-24 11:42:44 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-24_11-42-36/dataset_coverage.json for details.
2025-12-24 11:42:44 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-24_11-42-36/schema_summary.json
2025-12-24 11:42:44 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-24_11-42-36/feature_metadata.json
2025-12-24 11:42:44 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-24 11:42:44 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/advanced_k_partite_v2/feature-config.yaml.advanced_lean.10A.v2, sha256=2022a36e7b21668173af3af66c25cf6b6a0494e642c0934eac38abbcfeebec3d
2025-12-24 11:42:44 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/work/edge_features)
2025-12-24 11:42:44 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json
2025-12-24 11:42:44 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-24_11-42-36/schema_summary.json
2025-12-24 11:42:44 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-24 11:42:44 INFO Topology: topology/persistence_k_partite_advanced/v2 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 628-dimensional node features.
2025-12-24 11:42:44 INFO Node: node/dssp_topo_merge_passthrough/v1; metadata lists 628 feature columns matching the .pt tensor.
2025-12-24 11:42:44 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-24 11:42:44 INFO → Total feature dimensionality observed and confirmed: node_dim = 628, edge_dim = 11.
2025-12-24 11:42:44 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-24 11:42:44 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 628,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge_passthrough/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 628,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-24_11-42-36/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge_passthrough/v1",
      "alias": "Passthrough (all dims from topology module) = Node Dynamic Dims",
      "jobs": 16,
      "summary": "DSSP/basic features merged with all topology columns (passthrough)."
    },
    "topology": {
      "id": "topology/persistence_k_partite_advanced/v2",
      "alias": "Advanced k-partite PH (v2 lean) topo_dim 596",
      "jobs": 16,
      "summary": "Fixed-width k-partite persistent homology with slot padding + missingness channels."
    }
  },
  "notes": []
}
2025-12-24 11:42:44 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-24 11:42:44 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=f3198da832ed44c494709ea54cdae2b2)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-24 11:42:44 INFO Starting training (fast_dev_run=False)
2025-12-24 11:42:44 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-24_11-42-36/model_checkpoints exists and is not empty.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 20.1 K | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
180 K     Trainable params
0         Non-trainable params
180 K     Total params
0.721     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-24 11:43:01 INFO Epoch 000 | 25% complete (batch 181/724)
2025-12-24 11:43:04 INFO Epoch 000 | 50% complete (batch 362/724)
2025-12-24 11:43:07 INFO Epoch 000 | 75% complete (batch 543/724)
2025-12-24 11:43:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.145889
2025-12-24 11:43:25 INFO Tuning ranking metrics: regret=0.171382 spearman=-0.095640 (groups=37, skipped=311)
2025-12-24 11:43:25 INFO Epoch 000 | val_loss=0.145889
Metric tuning_rank_spearman improved. New best score: -0.096
2025-12-24 11:43:36 INFO Epoch 001 | 25% complete (batch 181/724)
2025-12-24 11:43:40 INFO Epoch 001 | 50% complete (batch 362/724)
2025-12-24 11:43:43 INFO Epoch 001 | 75% complete (batch 543/724)
2025-12-24 11:43:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.041171
2025-12-24 11:44:02 INFO Tuning ranking metrics: regret=0.185012 spearman=-0.276167 (groups=37, skipped=311)
2025-12-24 11:44:02 INFO Epoch 001 | train_mse=0.145773 | val_loss=0.145046 | best_val_loss=-0.095640
2025-12-24 11:44:12 INFO Epoch 002 | 25% complete (batch 181/724)
2025-12-24 11:44:15 INFO Epoch 002 | 50% complete (batch 362/724)
2025-12-24 11:44:19 INFO Epoch 002 | 75% complete (batch 543/724)
2025-12-24 11:44:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.218991
2025-12-24 11:44:37 INFO Tuning ranking metrics: regret=0.184946 spearman=-0.263274 (groups=37, skipped=311)
2025-12-24 11:44:37 INFO Epoch 002 | train_mse=0.145887 | val_loss=0.147926 | best_val_loss=-0.095640
2025-12-24 11:44:48 INFO Epoch 003 | 25% complete (batch 181/724)
2025-12-24 11:44:51 INFO Epoch 003 | 50% complete (batch 362/724)
2025-12-24 11:44:54 INFO Epoch 003 | 75% complete (batch 543/724)
2025-12-24 11:45:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.224573
2025-12-24 11:45:13 INFO Tuning ranking metrics: regret=0.143653 spearman=-0.084860 (groups=37, skipped=311)
2025-12-24 11:45:13 INFO Epoch 003 | train_mse=0.140032 | val_loss=0.143283 | best_val_loss=-0.095640
Metric tuning_rank_spearman improved by 0.011 >= min_delta = 0.0. New best score: -0.085
2025-12-24 11:45:24 INFO Epoch 004 | 25% complete (batch 181/724)
2025-12-24 11:45:27 INFO Epoch 004 | 50% complete (batch 362/724)
2025-12-24 11:45:30 INFO Epoch 004 | 75% complete (batch 543/724)
2025-12-24 11:45:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.375511
2025-12-24 11:45:49 INFO Tuning ranking metrics: regret=0.139404 spearman=-0.049930 (groups=37, skipped=311)
2025-12-24 11:45:49 INFO Epoch 004 | train_mse=0.149341 | val_loss=0.136430 | best_val_loss=-0.084860
Metric tuning_rank_spearman improved by 0.035 >= min_delta = 0.0. New best score: -0.050
2025-12-24 11:46:00 INFO Epoch 005 | 25% complete (batch 181/724)
2025-12-24 11:46:03 INFO Epoch 005 | 50% complete (batch 362/724)
2025-12-24 11:46:07 INFO Epoch 005 | 75% complete (batch 543/724)
2025-12-24 11:46:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.413794
2025-12-24 11:46:26 INFO Tuning ranking metrics: regret=0.156973 spearman=-0.090371 (groups=37, skipped=311)
2025-12-24 11:46:26 INFO Epoch 005 | train_mse=0.141498 | val_loss=0.125547 | best_val_loss=-0.049930
2025-12-24 11:46:37 INFO Epoch 006 | 25% complete (batch 181/724)
2025-12-24 11:46:40 INFO Epoch 006 | 50% complete (batch 362/724)
2025-12-24 11:46:43 INFO Epoch 006 | 75% complete (batch 543/724)
2025-12-24 11:46:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.465542
2025-12-24 11:47:02 INFO Tuning ranking metrics: regret=0.162943 spearman=-0.035474 (groups=37, skipped=311)
2025-12-24 11:47:02 INFO Epoch 006 | train_mse=0.125950 | val_loss=0.098465 | best_val_loss=-0.049930
Metric tuning_rank_spearman improved by 0.014 >= min_delta = 0.0. New best score: -0.035
2025-12-24 11:47:13 INFO Epoch 007 | 25% complete (batch 181/724)
2025-12-24 11:47:16 INFO Epoch 007 | 50% complete (batch 362/724)
2025-12-24 11:47:19 INFO Epoch 007 | 75% complete (batch 543/724)
2025-12-24 11:47:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.526517
2025-12-24 11:47:38 INFO Tuning ranking metrics: regret=0.146812 spearman=0.040154 (groups=37, skipped=311)
2025-12-24 11:47:38 INFO Epoch 007 | train_mse=0.111698 | val_loss=0.077787 | best_val_loss=-0.035474
Metric tuning_rank_spearman improved by 0.076 >= min_delta = 0.0. New best score: 0.040
2025-12-24 11:47:49 INFO Epoch 008 | 25% complete (batch 181/724)
2025-12-24 11:47:52 INFO Epoch 008 | 50% complete (batch 362/724)
2025-12-24 11:47:55 INFO Epoch 008 | 75% complete (batch 543/724)
2025-12-24 11:48:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.580961
2025-12-24 11:48:15 INFO Tuning ranking metrics: regret=0.154307 spearman=0.080672 (groups=37, skipped=311)
2025-12-24 11:48:15 INFO Epoch 008 | train_mse=0.082809 | val_loss=0.069780 | best_val_loss=0.040154
Metric tuning_rank_spearman improved by 0.041 >= min_delta = 0.0. New best score: 0.081
2025-12-24 11:48:25 INFO Epoch 009 | 25% complete (batch 181/724)
2025-12-24 11:48:29 INFO Epoch 009 | 50% complete (batch 362/724)
2025-12-24 11:48:32 INFO Epoch 009 | 75% complete (batch 543/724)
2025-12-24 11:48:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.592627
2025-12-24 11:48:51 INFO Tuning ranking metrics: regret=0.150401 spearman=0.121651 (groups=37, skipped=311)
2025-12-24 11:48:51 INFO Epoch 009 | train_mse=0.074081 | val_loss=0.088300 | best_val_loss=0.080672
Metric tuning_rank_spearman improved by 0.041 >= min_delta = 0.0. New best score: 0.122
2025-12-24 11:49:02 INFO Epoch 010 | 25% complete (batch 181/724)
2025-12-24 11:49:05 INFO Epoch 010 | 50% complete (batch 362/724)
2025-12-24 11:49:08 INFO Epoch 010 | 75% complete (batch 543/724)
2025-12-24 11:49:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.625821
2025-12-24 11:49:27 INFO Tuning ranking metrics: regret=0.136195 spearman=0.184187 (groups=37, skipped=311)
2025-12-24 11:49:27 INFO Epoch 010 | train_mse=0.069440 | val_loss=0.064034 | best_val_loss=0.121651
Metric tuning_rank_spearman improved by 0.063 >= min_delta = 0.0. New best score: 0.184
2025-12-24 11:49:38 INFO Epoch 011 | 25% complete (batch 181/724)
2025-12-24 11:49:42 INFO Epoch 011 | 50% complete (batch 362/724)
2025-12-24 11:49:45 INFO Epoch 011 | 75% complete (batch 543/724)
2025-12-24 11:49:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.630734
2025-12-24 11:50:04 INFO Tuning ranking metrics: regret=0.116614 spearman=0.237703 (groups=37, skipped=311)
2025-12-24 11:50:04 INFO Epoch 011 | train_mse=0.062570 | val_loss=0.065877 | best_val_loss=0.184187
Metric tuning_rank_spearman improved by 0.054 >= min_delta = 0.0. New best score: 0.238
2025-12-24 11:50:15 INFO Epoch 012 | 25% complete (batch 181/724)
2025-12-24 11:50:19 INFO Epoch 012 | 50% complete (batch 362/724)
2025-12-24 11:50:22 INFO Epoch 012 | 75% complete (batch 543/724)
2025-12-24 11:50:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.643522
2025-12-24 11:50:41 INFO Tuning ranking metrics: regret=0.112723 spearman=0.201720 (groups=37, skipped=311)
2025-12-24 11:50:41 INFO Epoch 012 | train_mse=0.059963 | val_loss=0.061989 | best_val_loss=0.237703
2025-12-24 11:50:52 INFO Epoch 013 | 25% complete (batch 181/724)
2025-12-24 11:50:55 INFO Epoch 013 | 50% complete (batch 362/724)
2025-12-24 11:50:58 INFO Epoch 013 | 75% complete (batch 543/724)
2025-12-24 11:51:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.594401
2025-12-24 11:51:17 INFO Tuning ranking metrics: regret=0.113660 spearman=0.222002 (groups=37, skipped=311)
2025-12-24 11:51:17 INFO Epoch 013 | train_mse=0.059968 | val_loss=0.118388 | best_val_loss=0.237703
2025-12-24 11:51:28 INFO Epoch 014 | 25% complete (batch 181/724)
2025-12-24 11:51:32 INFO Epoch 014 | 50% complete (batch 362/724)
2025-12-24 11:51:35 INFO Epoch 014 | 75% complete (batch 543/724)
2025-12-24 11:51:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.653307
2025-12-24 11:51:54 INFO Tuning ranking metrics: regret=0.099389 spearman=0.184609 (groups=37, skipped=311)
2025-12-24 11:51:54 INFO Epoch 014 | train_mse=0.071970 | val_loss=0.060531 | best_val_loss=0.237703
2025-12-24 11:52:05 INFO Epoch 015 | 25% complete (batch 181/724)
2025-12-24 11:52:08 INFO Epoch 015 | 50% complete (batch 362/724)
2025-12-24 11:52:12 INFO Epoch 015 | 75% complete (batch 543/724)
2025-12-24 11:52:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.649454
2025-12-24 11:52:31 INFO Tuning ranking metrics: regret=0.096661 spearman=0.187405 (groups=37, skipped=311)
2025-12-24 11:52:31 INFO Epoch 015 | train_mse=0.064943 | val_loss=0.065179 | best_val_loss=0.237703
2025-12-24 11:52:42 INFO Epoch 016 | 25% complete (batch 181/724)
2025-12-24 11:52:45 INFO Epoch 016 | 50% complete (batch 362/724)
2025-12-24 11:52:48 INFO Epoch 016 | 75% complete (batch 543/724)
2025-12-24 11:53:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.651977
2025-12-24 11:53:07 INFO Tuning ranking metrics: regret=0.115091 spearman=0.182684 (groups=37, skipped=311)
2025-12-24 11:53:07 INFO Epoch 016 | train_mse=0.052894 | val_loss=0.062130 | best_val_loss=0.237703
2025-12-24 11:53:18 INFO Epoch 017 | 25% complete (batch 181/724)
2025-12-24 11:53:22 INFO Epoch 017 | 50% complete (batch 362/724)
2025-12-24 11:53:25 INFO Epoch 017 | 75% complete (batch 543/724)
2025-12-24 11:53:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.654451
2025-12-24 11:53:44 INFO Tuning ranking metrics: regret=0.102240 spearman=0.192383 (groups=37, skipped=311)
2025-12-24 11:53:44 INFO Epoch 017 | train_mse=0.075782 | val_loss=0.062347 | best_val_loss=0.237703
2025-12-24 11:53:55 INFO Epoch 018 | 25% complete (batch 181/724)
2025-12-24 11:53:58 INFO Epoch 018 | 50% complete (batch 362/724)
2025-12-24 11:54:02 INFO Epoch 018 | 75% complete (batch 543/724)
2025-12-24 11:54:15 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.655670
2025-12-24 11:54:21 INFO Tuning ranking metrics: regret=0.097733 spearman=0.212882 (groups=37, skipped=311)
2025-12-24 11:54:21 INFO Epoch 018 | train_mse=0.055605 | val_loss=0.063961 | best_val_loss=0.237703
2025-12-24 11:54:31 INFO Epoch 019 | 25% complete (batch 181/724)
2025-12-24 11:54:35 INFO Epoch 019 | 50% complete (batch 362/724)
2025-12-24 11:54:38 INFO Epoch 019 | 75% complete (batch 543/724)
2025-12-24 11:54:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.661429
2025-12-24 11:54:57 INFO Tuning ranking metrics: regret=0.099521 spearman=0.197408 (groups=37, skipped=311)
2025-12-24 11:54:57 INFO Epoch 019 | train_mse=0.058940 | val_loss=0.061162 | best_val_loss=0.237703
2025-12-24 11:55:08 INFO Epoch 020 | 25% complete (batch 181/724)
2025-12-24 11:55:12 INFO Epoch 020 | 50% complete (batch 362/724)
2025-12-24 11:55:16 INFO Epoch 020 | 75% complete (batch 543/724)
2025-12-24 11:55:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.573076
2025-12-24 11:55:35 INFO Tuning ranking metrics: regret=0.093475 spearman=0.215111 (groups=37, skipped=311)
2025-12-24 11:55:35 INFO Epoch 020 | train_mse=0.053787 | val_loss=0.149491 | best_val_loss=0.237703
2025-12-24 11:55:45 INFO Epoch 021 | 25% complete (batch 181/724)
2025-12-24 11:55:48 INFO Epoch 021 | 50% complete (batch 362/724)
2025-12-24 11:55:51 INFO Epoch 021 | 75% complete (batch 543/724)
2025-12-24 11:56:04 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.658260
2025-12-24 11:56:10 INFO Tuning ranking metrics: regret=0.094670 spearman=0.210512 (groups=37, skipped=311)
2025-12-24 11:56:10 INFO Epoch 021 | train_mse=0.058599 | val_loss=0.056160 | best_val_loss=0.237703
2025-12-24 11:56:21 INFO Epoch 022 | 25% complete (batch 181/724)
2025-12-24 11:56:24 INFO Epoch 022 | 50% complete (batch 362/724)
2025-12-24 11:56:28 INFO Epoch 022 | 75% complete (batch 543/724)
2025-12-24 11:56:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.642420
2025-12-24 11:56:47 INFO Tuning ranking metrics: regret=0.102975 spearman=0.103446 (groups=37, skipped=311)
2025-12-24 11:56:47 INFO Epoch 022 | train_mse=0.071834 | val_loss=0.084946 | best_val_loss=0.237703
2025-12-24 11:56:58 INFO Epoch 023 | 25% complete (batch 181/724)
2025-12-24 11:57:01 INFO Epoch 023 | 50% complete (batch 362/724)
2025-12-24 11:57:04 INFO Epoch 023 | 75% complete (batch 543/724)
2025-12-24 11:57:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.650247
2025-12-24 11:57:23 INFO Tuning ranking metrics: regret=0.118178 spearman=0.189113 (groups=37, skipped=311)
2025-12-24 11:57:23 INFO Epoch 023 | train_mse=0.054882 | val_loss=0.076443 | best_val_loss=0.237703
2025-12-24 11:57:34 INFO Epoch 024 | 25% complete (batch 181/724)
2025-12-24 11:57:37 INFO Epoch 024 | 50% complete (batch 362/724)
2025-12-24 11:57:40 INFO Epoch 024 | 75% complete (batch 543/724)
2025-12-24 11:57:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.656894
2025-12-24 11:57:59 INFO Tuning ranking metrics: regret=0.099940 spearman=0.186358 (groups=37, skipped=311)
2025-12-24 11:57:59 INFO Epoch 024 | train_mse=0.069950 | val_loss=0.064498 | best_val_loss=0.237703
2025-12-24 11:58:10 INFO Epoch 025 | 25% complete (batch 181/724)
2025-12-24 11:58:13 INFO Epoch 025 | 50% complete (batch 362/724)
2025-12-24 11:58:17 INFO Epoch 025 | 75% complete (batch 543/724)
2025-12-24 11:58:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.665902
2025-12-24 11:58:36 INFO Tuning ranking metrics: regret=0.099853 spearman=0.237440 (groups=37, skipped=311)
2025-12-24 11:58:36 INFO Epoch 025 | train_mse=0.069051 | val_loss=0.060676 | best_val_loss=0.237703
2025-12-24 11:58:47 INFO Epoch 026 | 25% complete (batch 181/724)
2025-12-24 11:58:50 INFO Epoch 026 | 50% complete (batch 362/724)
2025-12-24 11:58:54 INFO Epoch 026 | 75% complete (batch 543/724)
2025-12-24 11:59:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.669923
2025-12-24 11:59:13 INFO Tuning ranking metrics: regret=0.114186 spearman=0.158301 (groups=37, skipped=311)
2025-12-24 11:59:13 INFO Epoch 026 | train_mse=0.052937 | val_loss=0.065067 | best_val_loss=0.237703
2025-12-24 11:59:24 INFO Epoch 027 | 25% complete (batch 181/724)
2025-12-24 11:59:27 INFO Epoch 027 | 50% complete (batch 362/724)
2025-12-24 11:59:31 INFO Epoch 027 | 75% complete (batch 543/724)
2025-12-24 11:59:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.653279
2025-12-24 11:59:50 INFO Tuning ranking metrics: regret=0.101720 spearman=0.171113 (groups=37, skipped=311)
2025-12-24 11:59:50 INFO Epoch 027 | train_mse=0.067701 | val_loss=0.078412 | best_val_loss=0.237703
2025-12-24 12:00:01 INFO Epoch 028 | 25% complete (batch 181/724)
2025-12-24 12:00:04 INFO Epoch 028 | 50% complete (batch 362/724)
2025-12-24 12:00:07 INFO Epoch 028 | 75% complete (batch 543/724)
2025-12-24 12:00:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.680786
2025-12-24 12:00:26 INFO Tuning ranking metrics: regret=0.101720 spearman=0.147133 (groups=37, skipped=311)
2025-12-24 12:00:26 INFO Epoch 028 | train_mse=0.060064 | val_loss=0.054344 | best_val_loss=0.237703
2025-12-24 12:00:37 INFO Epoch 029 | 25% complete (batch 181/724)
2025-12-24 12:00:40 INFO Epoch 029 | 50% complete (batch 362/724)
2025-12-24 12:00:43 INFO Epoch 029 | 75% complete (batch 543/724)
2025-12-24 12:00:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.685407
2025-12-24 12:01:02 INFO Tuning ranking metrics: regret=0.106936 spearman=0.121154 (groups=37, skipped=311)
2025-12-24 12:01:02 INFO Epoch 029 | train_mse=0.049985 | val_loss=0.056107 | best_val_loss=0.237703
2025-12-24 12:01:13 INFO Epoch 030 | 25% complete (batch 181/724)
2025-12-24 12:01:16 INFO Epoch 030 | 50% complete (batch 362/724)
2025-12-24 12:01:20 INFO Epoch 030 | 75% complete (batch 543/724)
2025-12-24 12:01:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.689969
2025-12-24 12:01:39 INFO Tuning ranking metrics: regret=0.106936 spearman=0.106096 (groups=37, skipped=311)
2025-12-24 12:01:39 INFO Epoch 030 | train_mse=0.052930 | val_loss=0.055130 | best_val_loss=0.237703
2025-12-24 12:01:50 INFO Epoch 031 | 25% complete (batch 181/724)
2025-12-24 12:01:53 INFO Epoch 031 | 50% complete (batch 362/724)
2025-12-24 12:01:56 INFO Epoch 031 | 75% complete (batch 543/724)
2025-12-24 12:02:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.676727
2025-12-24 12:02:15 INFO Tuning ranking metrics: regret=0.104173 spearman=0.193454 (groups=37, skipped=311)
2025-12-24 12:02:15 INFO Epoch 031 | train_mse=0.055008 | val_loss=0.067321 | best_val_loss=0.237703
2025-12-24 12:02:26 INFO Epoch 032 | 25% complete (batch 181/724)
2025-12-24 12:02:29 INFO Epoch 032 | 50% complete (batch 362/724)
2025-12-24 12:02:33 INFO Epoch 032 | 75% complete (batch 543/724)
2025-12-24 12:02:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.691679
2025-12-24 12:02:52 INFO Tuning ranking metrics: regret=0.100891 spearman=0.058874 (groups=37, skipped=311)
2025-12-24 12:02:52 INFO Epoch 032 | train_mse=0.051402 | val_loss=0.052171 | best_val_loss=0.237703
2025-12-24 12:03:03 INFO Epoch 033 | 25% complete (batch 181/724)
2025-12-24 12:03:07 INFO Epoch 033 | 50% complete (batch 362/724)
2025-12-24 12:03:10 INFO Epoch 033 | 75% complete (batch 543/724)
2025-12-24 12:03:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.672390
2025-12-24 12:03:29 INFO Tuning ranking metrics: regret=0.096428 spearman=0.157909 (groups=37, skipped=311)
2025-12-24 12:03:29 INFO Epoch 033 | train_mse=0.053291 | val_loss=0.073244 | best_val_loss=0.237703
2025-12-24 12:03:40 INFO Epoch 034 | 25% complete (batch 181/724)
2025-12-24 12:03:43 INFO Epoch 034 | 50% complete (batch 362/724)
2025-12-24 12:03:47 INFO Epoch 034 | 75% complete (batch 543/724)
2025-12-24 12:04:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.690692
2025-12-24 12:04:06 INFO Tuning ranking metrics: regret=0.101583 spearman=0.096028 (groups=37, skipped=311)
2025-12-24 12:04:06 INFO Epoch 034 | train_mse=0.053194 | val_loss=0.052101 | best_val_loss=0.237703
2025-12-24 12:04:17 INFO Epoch 035 | 25% complete (batch 181/724)
2025-12-24 12:04:20 INFO Epoch 035 | 50% complete (batch 362/724)
2025-12-24 12:04:24 INFO Epoch 035 | 75% complete (batch 543/724)
2025-12-24 12:04:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.701364
2025-12-24 12:04:43 INFO Tuning ranking metrics: regret=0.101604 spearman=0.090722 (groups=37, skipped=311)
2025-12-24 12:04:43 INFO Epoch 035 | train_mse=0.058815 | val_loss=0.051335 | best_val_loss=0.237703
2025-12-24 12:04:54 INFO Epoch 036 | 25% complete (batch 181/724)
2025-12-24 12:04:58 INFO Epoch 036 | 50% complete (batch 362/724)
2025-12-24 12:05:01 INFO Epoch 036 | 75% complete (batch 543/724)
2025-12-24 12:05:15 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.695341
2025-12-24 12:05:20 INFO Tuning ranking metrics: regret=0.106836 spearman=0.093875 (groups=37, skipped=311)
2025-12-24 12:05:20 INFO Epoch 036 | train_mse=0.056921 | val_loss=0.056569 | best_val_loss=0.237703
2025-12-24 12:05:31 INFO Epoch 037 | 25% complete (batch 181/724)
2025-12-24 12:05:34 INFO Epoch 037 | 50% complete (batch 362/724)
2025-12-24 12:05:38 INFO Epoch 037 | 75% complete (batch 543/724)
2025-12-24 12:05:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.699176
2025-12-24 12:05:57 INFO Tuning ranking metrics: regret=0.105625 spearman=0.104042 (groups=37, skipped=311)
2025-12-24 12:05:57 INFO Epoch 037 | train_mse=0.045656 | val_loss=0.051172 | best_val_loss=0.237703
2025-12-24 12:06:08 INFO Epoch 038 | 25% complete (batch 181/724)
2025-12-24 12:06:11 INFO Epoch 038 | 50% complete (batch 362/724)
2025-12-24 12:06:15 INFO Epoch 038 | 75% complete (batch 543/724)
2025-12-24 12:06:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.698422
2025-12-24 12:06:34 INFO Tuning ranking metrics: regret=0.107616 spearman=0.057470 (groups=37, skipped=311)
2025-12-24 12:06:34 INFO Epoch 038 | train_mse=0.057501 | val_loss=0.053393 | best_val_loss=0.237703
2025-12-24 12:06:45 INFO Epoch 039 | 25% complete (batch 181/724)
2025-12-24 12:06:48 INFO Epoch 039 | 50% complete (batch 362/724)
2025-12-24 12:06:52 INFO Epoch 039 | 75% complete (batch 543/724)
2025-12-24 12:07:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.699030
2025-12-24 12:07:11 INFO Tuning ranking metrics: regret=0.110512 spearman=0.051012 (groups=37, skipped=311)
2025-12-24 12:07:11 INFO Epoch 039 | train_mse=0.047878 | val_loss=0.051415 | best_val_loss=0.237703
2025-12-24 12:07:21 INFO Epoch 040 | 25% complete (batch 181/724)
2025-12-24 12:07:25 INFO Epoch 040 | 50% complete (batch 362/724)
2025-12-24 12:07:28 INFO Epoch 040 | 75% complete (batch 543/724)
2025-12-24 12:07:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.701029
2025-12-24 12:07:47 INFO Tuning ranking metrics: regret=0.110512 spearman=0.053258 (groups=37, skipped=311)
2025-12-24 12:07:47 INFO Epoch 040 | train_mse=0.052023 | val_loss=0.053407 | best_val_loss=0.237703
2025-12-24 12:07:58 INFO Epoch 041 | 25% complete (batch 181/724)
2025-12-24 12:08:02 INFO Epoch 041 | 50% complete (batch 362/724)
2025-12-24 12:08:05 INFO Epoch 041 | 75% complete (batch 543/724)
2025-12-24 12:08:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.689652
2025-12-24 12:08:25 INFO Tuning ranking metrics: regret=0.096934 spearman=0.031672 (groups=37, skipped=311)
2025-12-24 12:08:25 INFO Epoch 041 | train_mse=0.043070 | val_loss=0.068600 | best_val_loss=0.237703
2025-12-24 12:08:36 INFO Epoch 042 | 25% complete (batch 181/724)
2025-12-24 12:08:39 INFO Epoch 042 | 50% complete (batch 362/724)
2025-12-24 12:08:43 INFO Epoch 042 | 75% complete (batch 543/724)
2025-12-24 12:08:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.701903
2025-12-24 12:09:02 INFO Tuning ranking metrics: regret=0.102098 spearman=0.102381 (groups=37, skipped=311)
2025-12-24 12:09:02 INFO Epoch 042 | train_mse=0.044916 | val_loss=0.051230 | best_val_loss=0.237703
2025-12-24 12:09:14 INFO Epoch 043 | 25% complete (batch 181/724)
2025-12-24 12:09:17 INFO Epoch 043 | 50% complete (batch 362/724)
2025-12-24 12:09:21 INFO Epoch 043 | 75% complete (batch 543/724)
2025-12-24 12:09:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.712911
2025-12-24 12:09:40 INFO Tuning ranking metrics: regret=0.100970 spearman=0.058529 (groups=37, skipped=311)
2025-12-24 12:09:40 INFO Epoch 043 | train_mse=0.067044 | val_loss=0.050730 | best_val_loss=0.237703
2025-12-24 12:09:51 INFO Epoch 044 | 25% complete (batch 181/724)
2025-12-24 12:09:55 INFO Epoch 044 | 50% complete (batch 362/724)
2025-12-24 12:09:58 INFO Epoch 044 | 75% complete (batch 543/724)
2025-12-24 12:10:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.705097
2025-12-24 12:10:18 INFO Tuning ranking metrics: regret=0.100423 spearman=0.120832 (groups=37, skipped=311)
2025-12-24 12:10:18 INFO Epoch 044 | train_mse=0.050263 | val_loss=0.058012 | best_val_loss=0.237703
2025-12-24 12:10:29 INFO Epoch 045 | 25% complete (batch 181/724)
2025-12-24 12:10:33 INFO Epoch 045 | 50% complete (batch 362/724)
2025-12-24 12:10:36 INFO Epoch 045 | 75% complete (batch 543/724)
2025-12-24 12:10:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.696057
2025-12-24 12:10:56 INFO Tuning ranking metrics: regret=0.099999 spearman=0.181397 (groups=37, skipped=311)
2025-12-24 12:10:56 INFO Epoch 045 | train_mse=0.048033 | val_loss=0.072940 | best_val_loss=0.237703
2025-12-24 12:11:07 INFO Epoch 046 | 25% complete (batch 181/724)
2025-12-24 12:11:10 INFO Epoch 046 | 50% complete (batch 362/724)
2025-12-24 12:11:13 INFO Epoch 046 | 75% complete (batch 543/724)
2025-12-24 12:11:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.719872
2025-12-24 12:11:32 INFO Tuning ranking metrics: regret=0.117741 spearman=0.157342 (groups=37, skipped=311)
2025-12-24 12:11:32 INFO Epoch 046 | train_mse=0.044185 | val_loss=0.048230 | best_val_loss=0.237703
2025-12-24 12:11:43 INFO Epoch 047 | 25% complete (batch 181/724)
2025-12-24 12:11:46 INFO Epoch 047 | 50% complete (batch 362/724)
2025-12-24 12:11:50 INFO Epoch 047 | 75% complete (batch 543/724)
2025-12-24 12:12:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.723763
2025-12-24 12:12:09 INFO Tuning ranking metrics: regret=0.095032 spearman=0.126044 (groups=37, skipped=311)
2025-12-24 12:12:09 INFO Epoch 047 | train_mse=0.046403 | val_loss=0.047362 | best_val_loss=0.237703
2025-12-24 12:12:20 INFO Epoch 048 | 25% complete (batch 181/724)
2025-12-24 12:12:23 INFO Epoch 048 | 50% complete (batch 362/724)
2025-12-24 12:12:27 INFO Epoch 048 | 75% complete (batch 543/724)
2025-12-24 12:12:40 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.708794
2025-12-24 12:12:45 INFO Tuning ranking metrics: regret=0.081109 spearman=0.070329 (groups=37, skipped=311)
2025-12-24 12:12:45 INFO Epoch 048 | train_mse=0.042526 | val_loss=0.054943 | best_val_loss=0.237703
2025-12-24 12:12:56 INFO Epoch 049 | 25% complete (batch 181/724)
2025-12-24 12:12:59 INFO Epoch 049 | 50% complete (batch 362/724)
2025-12-24 12:13:03 INFO Epoch 049 | 75% complete (batch 543/724)
2025-12-24 12:13:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.716087
2025-12-24 12:13:22 INFO Tuning ranking metrics: regret=0.103675 spearman=0.112958 (groups=37, skipped=311)
2025-12-24 12:13:22 INFO Epoch 049 | train_mse=0.045725 | val_loss=0.048579 | best_val_loss=0.237703
2025-12-24 12:13:33 INFO Epoch 050 | 25% complete (batch 181/724)
2025-12-24 12:13:36 INFO Epoch 050 | 50% complete (batch 362/724)
2025-12-24 12:13:39 INFO Epoch 050 | 75% complete (batch 543/724)
2025-12-24 12:13:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.714841
2025-12-24 12:13:58 INFO Tuning ranking metrics: regret=0.095920 spearman=0.083257 (groups=37, skipped=311)
2025-12-24 12:13:58 INFO Epoch 050 | train_mse=0.046813 | val_loss=0.050486 | best_val_loss=0.237703
2025-12-24 12:14:09 INFO Epoch 051 | 25% complete (batch 181/724)
2025-12-24 12:14:12 INFO Epoch 051 | 50% complete (batch 362/724)
2025-12-24 12:14:15 INFO Epoch 051 | 75% complete (batch 543/724)
2025-12-24 12:14:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.709108
2025-12-24 12:14:34 INFO Tuning ranking metrics: regret=0.082482 spearman=0.099380 (groups=37, skipped=311)
2025-12-24 12:14:34 INFO Epoch 051 | train_mse=0.047723 | val_loss=0.056177 | best_val_loss=0.237703
2025-12-24 12:14:45 INFO Epoch 052 | 25% complete (batch 181/724)
2025-12-24 12:14:48 INFO Epoch 052 | 50% complete (batch 362/724)
2025-12-24 12:14:52 INFO Epoch 052 | 75% complete (batch 543/724)
2025-12-24 12:15:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.710810
2025-12-24 12:15:11 INFO Tuning ranking metrics: regret=0.095032 spearman=0.095566 (groups=37, skipped=311)
2025-12-24 12:15:11 INFO Epoch 052 | train_mse=0.045942 | val_loss=0.057003 | best_val_loss=0.237703
2025-12-24 12:15:21 INFO Epoch 053 | 25% complete (batch 181/724)
2025-12-24 12:15:25 INFO Epoch 053 | 50% complete (batch 362/724)
2025-12-24 12:15:28 INFO Epoch 053 | 75% complete (batch 543/724)
2025-12-24 12:15:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.720949
2025-12-24 12:15:47 INFO Tuning ranking metrics: regret=0.096341 spearman=0.108395 (groups=37, skipped=311)
2025-12-24 12:15:47 INFO Epoch 053 | train_mse=0.044864 | val_loss=0.049495 | best_val_loss=0.237703
2025-12-24 12:15:57 INFO Epoch 054 | 25% complete (batch 181/724)
2025-12-24 12:16:01 INFO Epoch 054 | 50% complete (batch 362/724)
2025-12-24 12:16:04 INFO Epoch 054 | 75% complete (batch 543/724)
2025-12-24 12:16:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.717866
2025-12-24 12:16:23 INFO Tuning ranking metrics: regret=0.093361 spearman=0.123476 (groups=37, skipped=311)
2025-12-24 12:16:23 INFO Epoch 054 | train_mse=0.052823 | val_loss=0.049389 | best_val_loss=0.237703
2025-12-24 12:16:34 INFO Epoch 055 | 25% complete (batch 181/724)
2025-12-24 12:16:37 INFO Epoch 055 | 50% complete (batch 362/724)
2025-12-24 12:16:40 INFO Epoch 055 | 75% complete (batch 543/724)
2025-12-24 12:16:53 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.719304
2025-12-24 12:16:59 INFO Tuning ranking metrics: regret=0.099210 spearman=0.083000 (groups=37, skipped=311)
2025-12-24 12:16:59 INFO Epoch 055 | train_mse=0.045279 | val_loss=0.046694 | best_val_loss=0.237703
2025-12-24 12:17:10 INFO Epoch 056 | 25% complete (batch 181/724)
2025-12-24 12:17:13 INFO Epoch 056 | 50% complete (batch 362/724)
2025-12-24 12:17:16 INFO Epoch 056 | 75% complete (batch 543/724)
2025-12-24 12:17:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.721662
2025-12-24 12:17:35 INFO Tuning ranking metrics: regret=0.094716 spearman=0.079080 (groups=37, skipped=311)
2025-12-24 12:17:35 INFO Epoch 056 | train_mse=0.038569 | val_loss=0.050154 | best_val_loss=0.237703
2025-12-24 12:17:46 INFO Epoch 057 | 25% complete (batch 181/724)
2025-12-24 12:17:49 INFO Epoch 057 | 50% complete (batch 362/724)
2025-12-24 12:17:53 INFO Epoch 057 | 75% complete (batch 543/724)
2025-12-24 12:18:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.728933
2025-12-24 12:18:12 INFO Tuning ranking metrics: regret=0.099210 spearman=0.075641 (groups=37, skipped=311)
2025-12-24 12:18:12 INFO Epoch 057 | train_mse=0.045563 | val_loss=0.046224 | best_val_loss=0.237703
2025-12-24 12:18:23 INFO Epoch 058 | 25% complete (batch 181/724)
2025-12-24 12:18:26 INFO Epoch 058 | 50% complete (batch 362/724)
2025-12-24 12:18:30 INFO Epoch 058 | 75% complete (batch 543/724)
2025-12-24 12:18:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.726666
2025-12-24 12:18:49 INFO Tuning ranking metrics: regret=0.099210 spearman=0.105341 (groups=37, skipped=311)
2025-12-24 12:18:49 INFO Epoch 058 | train_mse=0.044746 | val_loss=0.048015 | best_val_loss=0.237703
2025-12-24 12:19:00 INFO Epoch 059 | 25% complete (batch 181/724)
2025-12-24 12:19:03 INFO Epoch 059 | 50% complete (batch 362/724)
2025-12-24 12:19:06 INFO Epoch 059 | 75% complete (batch 543/724)
2025-12-24 12:19:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.694461
2025-12-24 12:19:26 INFO Tuning ranking metrics: regret=0.095518 spearman=0.117532 (groups=37, skipped=311)
2025-12-24 12:19:26 INFO Epoch 059 | train_mse=0.051300 | val_loss=0.075148 | best_val_loss=0.237703
2025-12-24 12:19:36 INFO Epoch 060 | 25% complete (batch 181/724)
2025-12-24 12:19:40 INFO Epoch 060 | 50% complete (batch 362/724)
2025-12-24 12:19:44 INFO Epoch 060 | 75% complete (batch 543/724)
2025-12-24 12:19:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.671088
2025-12-24 12:20:03 INFO Tuning ranking metrics: regret=0.065866 spearman=0.116164 (groups=37, skipped=311)
2025-12-24 12:20:03 INFO Epoch 060 | train_mse=0.042574 | val_loss=0.099468 | best_val_loss=0.237703
2025-12-24 12:20:14 INFO Epoch 061 | 25% complete (batch 181/724)
2025-12-24 12:20:17 INFO Epoch 061 | 50% complete (batch 362/724)
2025-12-24 12:20:21 INFO Epoch 061 | 75% complete (batch 543/724)
2025-12-24 12:20:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.712841
2025-12-24 12:20:39 INFO Tuning ranking metrics: regret=0.096700 spearman=0.094905 (groups=37, skipped=311)
2025-12-24 12:20:39 INFO Epoch 061 | train_mse=0.055218 | val_loss=0.052343 | best_val_loss=0.237703
Monitored metric tuning_rank_spearman did not improve in the last 50 records. Best score: 0.238. Signaling Trainer to stop.
2025-12-24 12:20:40 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.22200_val-0.11839_epoch013.chkpt, checkpoint.tuning_rank_spearman-0.23744_val-0.06068_epoch025.chkpt, checkpoint.tuning_rank_spearman-0.23770_val-0.06588_epoch011.chkpt
2025-12-24 12:20:40 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-24_11-42-36/model_checkpoints/checkpoint.tuning_rank_spearman-0.23770_val-0.06588_epoch011.chkpt
2025-12-24 12:20:40 INFO Best validation loss: tensor(0.2377)
2025-12-24 12:20:40 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-24_11-42-36/model_checkpoints/checkpoint.tuning_rank_spearman-0.23770_val-0.06588_epoch011.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-24_11-42-36/model_checkpoints/checkpoint.tuning_rank_spearman-0.23770_val-0.06588_epoch011.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-24 12:20:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.065877
2025-12-24 12:20:55 INFO Tuning ranking metrics: regret=0.116614 spearman=0.237703 (groups=37, skipped=311)
2025-12-24 12:20:55 INFO Epoch 062 | val_loss=0.065877 | best_val_loss=0.237703
2025-12-24 12:20:56 INFO Validation metrics: [{'val_loss': 0.06587693840265274, 'tuning_rank_regret': 0.11661355197429657, 'tuning_rank_spearman': 0.23770329356193542, 'val_pearson_corr': 0.7530499696731567, 'val_spearman_corr': 0.7055113315582275, 'val_rank_regret': 0.24435976147651672, 'val_rank_spearman': 0.17027416825294495}]
2025-12-24 12:20:56 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.23770_val-0.06588_epoch011.chkpt
2025-12-24 12:20:56 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.22200_val-0.11839_epoch013.chkpt
2025-12-24 12:20:56 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.23744_val-0.06068_epoch025.chkpt
2025-12-24 12:20:56 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.06403_epoch010.ckpt
2025-12-24 12:20:56 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.11661355197429657
  tuning_rank_spearman      0.23770329356193542
        val_loss            0.06587693840265274
    val_pearson_corr        0.7530499696731567
     val_rank_regret        0.24435976147651672
    val_rank_spearman       0.17027416825294495
    val_spearman_corr       0.7055113315582275
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run polish_lr_low_seed101_2025-12-24_11-42-36 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-24_11-42-36
[train_cli][batch] job 'polish_lr_low_seed101' finished.
[train_cli][batch] (3/6) running job 'polish_seed555' -> run_name=polish_seed555_2025-12-24_12-20-58
[train_cli] run_id=polish_seed555_2025-12-24_12-20-58 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-24_12-20-58/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-24_12-20-58 --git-commit 9b1bb2b320 --git-dirty
2025-12-24 12:21:02 INFO git_commit = 9b1bb2b320 (dirty)
2025-12-24 12:21:02 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-24 12:21:02 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-24_12-20-58/config/config.yaml
2025-12-24 12:21:02 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data
2025-12-24 12:21:02 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-24 12:21:02 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-24 12:21:02 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-24_12-20-58
2025-12-24 12:21:02 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-24 12:21:02 INFO   metadata_path = None
2025-12-24 12:21:02 INFO   summary_path = None
2025-12-24 12:21:02 INFO   accelerator = cpu
2025-12-24 12:21:02 INFO   devices = 1
2025-12-24 12:21:02 INFO   attention_head = 8
2025-12-24 12:21:02 INFO   pooling_type = mean
2025-12-24 12:21:02 INFO   model_self_loops = False
2025-12-24 12:21:02 INFO   model_self_loop_fill = mean
2025-12-24 12:21:02 INFO   model_residual = False
2025-12-24 12:21:02 INFO   batch_size = 48
2025-12-24 12:21:02 INFO   learning_rate = 0.003
2025-12-24 12:21:02 INFO   num_epochs = 320
2025-12-24 12:21:02 INFO   accumulate_grad_batches = 8
2025-12-24 12:21:02 INFO   seed = 555
2025-12-24 12:21:02 INFO   num_workers = 2
2025-12-24 12:21:02 INFO   precision = 32
2025-12-24 12:21:02 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-24 12:21:02 INFO   early_stopping_patience = 40
2025-12-24 12:21:02 INFO   lr_scheduler_patience = 20
2025-12-24 12:21:02 INFO   lr_scheduler_factor = 0.3
2025-12-24 12:21:02 INFO   fast_dev_run = False
2025-12-24 12:21:02 INFO   limit_train_batches = None
2025-12-24 12:21:02 INFO   limit_val_batches = None
2025-12-24 12:21:02 INFO   log_lr = False
2025-12-24 12:21:02 INFO   progress_bar_refresh_rate = 0
2025-12-24 12:21:02 INFO   log_every_n_steps = 100
2025-12-24 12:21:02 INFO   use_val_spearman_as_secondary = True
2025-12-24 12:21:02 INFO   spearman_secondary_min_delta = 0.0
2025-12-24 12:21:02 INFO   spearman_secondary_weight = 1.0
2025-12-24 12:21:02 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-24 12:21:02 INFO   tuning_max_samples = 500
2025-12-24 12:21:02 INFO   tuning_fraction = None
2025-12-24 12:21:02 INFO   tuning_eval_every = 1
2025-12-24 12:21:02 INFO   rank_loss_weight = 0.0
2025-12-24 12:21:02 INFO   rank_loss_margin = 0.0
2025-12-24 12:21:02 INFO   rank_loss_mode = hinge
2025-12-24 12:21:02 INFO   rank_loss_grouped = True
2025-12-24 12:21:02 INFO   variance_reduction_enabled = False
2025-12-24 12:21:02 INFO   variance_reduction_method = topk_avg
2025-12-24 12:21:02 INFO   variance_reduction_top_k = 3
2025-12-24 12:21:02 INFO   coverage_minimum = 0.0
2025-12-24 12:21:02 INFO   coverage_fail_on_missing = False
2025-12-24 12:21:02 INFO   graph_load_profiling = False
2025-12-24 12:21:02 INFO   graph_load_top_k = 5
2025-12-24 12:21:02 INFO   enable_graph_cache = True
2025-12-24 12:21:02 INFO   graph_cache_size = 256
2025-12-24 12:21:02 INFO   canonicalize_on_load = False
2025-12-24 12:21:02 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-24 12:21:02 INFO   edge_schema = {}
2025-12-24 12:21:02 INFO   topology_schema = {}
Seed set to 555
2025-12-24 12:21:03 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-24 12:21:03 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 12:21:03 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-24 12:21:03 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 12:21:03 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-24 12:21:03 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 12:21:05 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-24 12:21:05 INFO Tuning group stats: groups=368 groups>=2=39 singletons=329 max_group=9
2025-12-24 12:21:05 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-24_12-20-58/dataset_coverage.json
2025-12-24 12:21:05 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-24_12-20-58/dataset_coverage.json for details.
2025-12-24 12:21:05 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-24_12-20-58/dataset_coverage.json for details.
2025-12-24 12:21:05 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-24_12-20-58/dataset_coverage.json for details.
2025-12-24 12:21:05 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-24_12-20-58/schema_summary.json
2025-12-24 12:21:05 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-24_12-20-58/feature_metadata.json
2025-12-24 12:21:05 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-24 12:21:05 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/advanced_k_partite_v2/feature-config.yaml.advanced_lean.10A.v2, sha256=2022a36e7b21668173af3af66c25cf6b6a0494e642c0934eac38abbcfeebec3d
2025-12-24 12:21:05 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/work/edge_features)
2025-12-24 12:21:05 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json
2025-12-24 12:21:05 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-24_12-20-58/schema_summary.json
2025-12-24 12:21:05 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-24 12:21:05 INFO Topology: topology/persistence_k_partite_advanced/v2 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 628-dimensional node features.
2025-12-24 12:21:05 INFO Node: node/dssp_topo_merge_passthrough/v1; metadata lists 628 feature columns matching the .pt tensor.
2025-12-24 12:21:05 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-24 12:21:05 INFO → Total feature dimensionality observed and confirmed: node_dim = 628, edge_dim = 11.
2025-12-24 12:21:05 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-24 12:21:05 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 628,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge_passthrough/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 628,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-24_12-20-58/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge_passthrough/v1",
      "alias": "Passthrough (all dims from topology module) = Node Dynamic Dims",
      "jobs": 16,
      "summary": "DSSP/basic features merged with all topology columns (passthrough)."
    },
    "topology": {
      "id": "topology/persistence_k_partite_advanced/v2",
      "alias": "Advanced k-partite PH (v2 lean) topo_dim 596",
      "jobs": 16,
      "summary": "Fixed-width k-partite persistent homology with slot padding + missingness channels."
    }
  },
  "notes": []
}
2025-12-24 12:21:05 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-24 12:21:05 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=24347589c54f47b185742f6f179e6628)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-24 12:21:05 INFO Starting training (fast_dev_run=False)
2025-12-24 12:21:05 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-24_12-20-58/model_checkpoints exists and is not empty.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 20.1 K | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
180 K     Trainable params
0         Non-trainable params
180 K     Total params
0.721     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-24 12:21:20 INFO Epoch 000 | 25% complete (batch 46/181)
2025-12-24 12:21:20 INFO Epoch 000 | 50% complete (batch 91/181)
2025-12-24 12:21:21 INFO Epoch 000 | 75% complete (batch 136/181)
2025-12-24 12:21:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.144794
2025-12-24 12:21:35 INFO Tuning ranking metrics: regret=0.159007 spearman=0.006566 (groups=39, skipped=329)
2025-12-24 12:21:35 INFO Epoch 000 | val_loss=0.144794
Metric tuning_rank_spearman improved. New best score: 0.007
2025-12-24 12:21:43 INFO Epoch 001 | 25% complete (batch 46/181)
2025-12-24 12:21:44 INFO Epoch 001 | 50% complete (batch 91/181)
2025-12-24 12:21:45 INFO Epoch 001 | 75% complete (batch 136/181)
2025-12-24 12:21:53 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.011774
2025-12-24 12:21:58 INFO Tuning ranking metrics: regret=0.138041 spearman=0.048718 (groups=39, skipped=329)
2025-12-24 12:21:58 INFO Epoch 001 | train_mse=0.147458 | val_loss=0.143041 | best_val_loss=0.006566
Metric tuning_rank_spearman improved by 0.042 >= min_delta = 0.0. New best score: 0.049
2025-12-24 12:22:07 INFO Epoch 002 | 25% complete (batch 46/181)
2025-12-24 12:22:08 INFO Epoch 002 | 50% complete (batch 91/181)
2025-12-24 12:22:09 INFO Epoch 002 | 75% complete (batch 136/181)
2025-12-24 12:22:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.307177
2025-12-24 12:22:23 INFO Tuning ranking metrics: regret=0.169898 spearman=0.045177 (groups=39, skipped=329)
2025-12-24 12:22:23 INFO Epoch 002 | train_mse=0.142358 | val_loss=0.142022 | best_val_loss=0.048718
2025-12-24 12:22:31 INFO Epoch 003 | 25% complete (batch 46/181)
2025-12-24 12:22:32 INFO Epoch 003 | 50% complete (batch 91/181)
2025-12-24 12:22:33 INFO Epoch 003 | 75% complete (batch 136/181)
2025-12-24 12:22:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.131107
2025-12-24 12:22:46 INFO Tuning ranking metrics: regret=0.134255 spearman=0.088889 (groups=39, skipped=329)
2025-12-24 12:22:46 INFO Epoch 003 | train_mse=0.148783 | val_loss=0.140578 | best_val_loss=0.048718
Metric tuning_rank_spearman improved by 0.040 >= min_delta = 0.0. New best score: 0.089
2025-12-24 12:22:55 INFO Epoch 004 | 25% complete (batch 46/181)
2025-12-24 12:22:56 INFO Epoch 004 | 50% complete (batch 91/181)
2025-12-24 12:22:57 INFO Epoch 004 | 75% complete (batch 136/181)
2025-12-24 12:23:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.339506
2025-12-24 12:23:10 INFO Tuning ranking metrics: regret=0.139314 spearman=0.003236 (groups=39, skipped=329)
2025-12-24 12:23:10 INFO Epoch 004 | train_mse=0.148549 | val_loss=0.140528 | best_val_loss=0.088889
2025-12-24 12:23:19 INFO Epoch 005 | 25% complete (batch 46/181)
2025-12-24 12:23:20 INFO Epoch 005 | 50% complete (batch 91/181)
2025-12-24 12:23:21 INFO Epoch 005 | 75% complete (batch 136/181)
2025-12-24 12:23:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.051751
2025-12-24 12:23:34 INFO Tuning ranking metrics: regret=0.137739 spearman=0.022039 (groups=39, skipped=329)
2025-12-24 12:23:34 INFO Epoch 005 | train_mse=0.145363 | val_loss=0.139582 | best_val_loss=0.088889
2025-12-24 12:23:43 INFO Epoch 006 | 25% complete (batch 46/181)
2025-12-24 12:23:44 INFO Epoch 006 | 50% complete (batch 91/181)
2025-12-24 12:23:45 INFO Epoch 006 | 75% complete (batch 136/181)
2025-12-24 12:23:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.194537
2025-12-24 12:23:59 INFO Tuning ranking metrics: regret=0.138412 spearman=0.187973 (groups=39, skipped=329)
2025-12-24 12:23:59 INFO Epoch 006 | train_mse=0.141260 | val_loss=0.174162 | best_val_loss=0.088889
Metric tuning_rank_spearman improved by 0.099 >= min_delta = 0.0. New best score: 0.188
2025-12-24 12:24:07 INFO Epoch 007 | 25% complete (batch 46/181)
2025-12-24 12:24:08 INFO Epoch 007 | 50% complete (batch 91/181)
2025-12-24 12:24:09 INFO Epoch 007 | 75% complete (batch 136/181)
2025-12-24 12:24:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.141255
2025-12-24 12:24:22 INFO Tuning ranking metrics: regret=0.179131 spearman=-0.072283 (groups=39, skipped=329)
2025-12-24 12:24:22 INFO Epoch 007 | train_mse=0.141111 | val_loss=0.141255 | best_val_loss=0.187973
2025-12-24 12:24:31 INFO Epoch 008 | 25% complete (batch 46/181)
2025-12-24 12:24:32 INFO Epoch 008 | 50% complete (batch 91/181)
2025-12-24 12:24:33 INFO Epoch 008 | 75% complete (batch 136/181)
2025-12-24 12:24:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.059771
2025-12-24 12:24:46 INFO Tuning ranking metrics: regret=0.187452 spearman=-0.030098 (groups=39, skipped=329)
2025-12-24 12:24:46 INFO Epoch 008 | train_mse=0.148502 | val_loss=0.140439 | best_val_loss=0.187973
2025-12-24 12:24:55 INFO Epoch 009 | 25% complete (batch 46/181)
2025-12-24 12:24:56 INFO Epoch 009 | 50% complete (batch 91/181)
2025-12-24 12:24:57 INFO Epoch 009 | 75% complete (batch 136/181)
2025-12-24 12:25:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.099515
2025-12-24 12:25:10 INFO Tuning ranking metrics: regret=0.160123 spearman=0.037607 (groups=39, skipped=329)
2025-12-24 12:25:10 INFO Epoch 009 | train_mse=0.144270 | val_loss=0.142170 | best_val_loss=0.187973
2025-12-24 12:25:19 INFO Epoch 010 | 25% complete (batch 46/181)
2025-12-24 12:25:20 INFO Epoch 010 | 50% complete (batch 91/181)
2025-12-24 12:25:21 INFO Epoch 010 | 75% complete (batch 136/181)
2025-12-24 12:25:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.183277
2025-12-24 12:25:35 INFO Tuning ranking metrics: regret=0.129362 spearman=0.094994 (groups=39, skipped=329)
2025-12-24 12:25:35 INFO Epoch 010 | train_mse=0.151651 | val_loss=0.139915 | best_val_loss=0.187973
2025-12-24 12:25:43 INFO Epoch 011 | 25% complete (batch 46/181)
2025-12-24 12:25:44 INFO Epoch 011 | 50% complete (batch 91/181)
2025-12-24 12:25:45 INFO Epoch 011 | 75% complete (batch 136/181)
2025-12-24 12:25:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.278562
2025-12-24 12:25:59 INFO Tuning ranking metrics: regret=0.133100 spearman=-0.010623 (groups=39, skipped=329)
2025-12-24 12:25:59 INFO Epoch 011 | train_mse=0.147537 | val_loss=0.146995 | best_val_loss=0.187973
2025-12-24 12:26:07 INFO Epoch 012 | 25% complete (batch 46/181)
2025-12-24 12:26:08 INFO Epoch 012 | 50% complete (batch 91/181)
2025-12-24 12:26:09 INFO Epoch 012 | 75% complete (batch 136/181)
2025-12-24 12:26:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.313989
2025-12-24 12:26:22 INFO Tuning ranking metrics: regret=0.157619 spearman=-0.121795 (groups=39, skipped=329)
2025-12-24 12:26:22 INFO Epoch 012 | train_mse=0.137732 | val_loss=0.142369 | best_val_loss=0.187973
2025-12-24 12:26:31 INFO Epoch 013 | 25% complete (batch 46/181)
2025-12-24 12:26:32 INFO Epoch 013 | 50% complete (batch 91/181)
2025-12-24 12:26:33 INFO Epoch 013 | 75% complete (batch 136/181)
2025-12-24 12:26:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.285315
2025-12-24 12:26:46 INFO Tuning ranking metrics: regret=0.162458 spearman=-0.061416 (groups=39, skipped=329)
2025-12-24 12:26:46 INFO Epoch 013 | train_mse=0.143693 | val_loss=0.136553 | best_val_loss=0.187973
2025-12-24 12:26:55 INFO Epoch 014 | 25% complete (batch 46/181)
2025-12-24 12:26:56 INFO Epoch 014 | 50% complete (batch 91/181)
2025-12-24 12:26:57 INFO Epoch 014 | 75% complete (batch 136/181)
2025-12-24 12:27:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.210028
2025-12-24 12:27:11 INFO Tuning ranking metrics: regret=0.121303 spearman=0.078022 (groups=39, skipped=329)
2025-12-24 12:27:11 INFO Epoch 014 | train_mse=0.134701 | val_loss=0.136102 | best_val_loss=0.187973
2025-12-24 12:27:19 INFO Epoch 015 | 25% complete (batch 46/181)
2025-12-24 12:27:20 INFO Epoch 015 | 50% complete (batch 91/181)
2025-12-24 12:27:21 INFO Epoch 015 | 75% complete (batch 136/181)
2025-12-24 12:27:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.303108
2025-12-24 12:27:35 INFO Tuning ranking metrics: regret=0.134122 spearman=-0.014042 (groups=39, skipped=329)
2025-12-24 12:27:35 INFO Epoch 015 | train_mse=0.137708 | val_loss=0.150836 | best_val_loss=0.187973
2025-12-24 12:27:44 INFO Epoch 016 | 25% complete (batch 46/181)
2025-12-24 12:27:44 INFO Epoch 016 | 50% complete (batch 91/181)
2025-12-24 12:27:45 INFO Epoch 016 | 75% complete (batch 136/181)
2025-12-24 12:27:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.370940
2025-12-24 12:27:59 INFO Tuning ranking metrics: regret=0.135738 spearman=-0.005861 (groups=39, skipped=329)
2025-12-24 12:27:59 INFO Epoch 016 | train_mse=0.131278 | val_loss=0.133307 | best_val_loss=0.187973
2025-12-24 12:28:07 INFO Epoch 017 | 25% complete (batch 46/181)
2025-12-24 12:28:08 INFO Epoch 017 | 50% complete (batch 91/181)
2025-12-24 12:28:09 INFO Epoch 017 | 75% complete (batch 136/181)
2025-12-24 12:28:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.292458
2025-12-24 12:28:23 INFO Tuning ranking metrics: regret=0.150942 spearman=0.123810 (groups=39, skipped=329)
2025-12-24 12:28:23 INFO Epoch 017 | train_mse=0.122194 | val_loss=0.138196 | best_val_loss=0.187973
2025-12-24 12:28:31 INFO Epoch 018 | 25% complete (batch 46/181)
2025-12-24 12:28:32 INFO Epoch 018 | 50% complete (batch 91/181)
2025-12-24 12:28:33 INFO Epoch 018 | 75% complete (batch 136/181)
2025-12-24 12:28:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.139030
2025-12-24 12:28:47 INFO Tuning ranking metrics: regret=0.141085 spearman=0.007082 (groups=39, skipped=329)
2025-12-24 12:28:47 INFO Epoch 018 | train_mse=0.144861 | val_loss=0.139030 | best_val_loss=0.187973
2025-12-24 12:28:56 INFO Epoch 019 | 25% complete (batch 46/181)
2025-12-24 12:28:56 INFO Epoch 019 | 50% complete (batch 91/181)
2025-12-24 12:28:57 INFO Epoch 019 | 75% complete (batch 136/181)
2025-12-24 12:29:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.187924
2025-12-24 12:29:11 INFO Tuning ranking metrics: regret=0.151236 spearman=-0.013797 (groups=39, skipped=329)
2025-12-24 12:29:11 INFO Epoch 019 | train_mse=0.143932 | val_loss=0.187924 | best_val_loss=0.187973
2025-12-24 12:29:19 INFO Epoch 020 | 25% complete (batch 46/181)
2025-12-24 12:29:20 INFO Epoch 020 | 50% complete (batch 91/181)
2025-12-24 12:29:21 INFO Epoch 020 | 75% complete (batch 136/181)
2025-12-24 12:29:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.114464
2025-12-24 12:29:35 INFO Tuning ranking metrics: regret=0.153698 spearman=-0.044357 (groups=39, skipped=329)
2025-12-24 12:29:35 INFO Epoch 020 | train_mse=0.147174 | val_loss=0.137905 | best_val_loss=0.187973
2025-12-24 12:29:43 INFO Epoch 021 | 25% complete (batch 46/181)
2025-12-24 12:29:44 INFO Epoch 021 | 50% complete (batch 91/181)
2025-12-24 12:29:45 INFO Epoch 021 | 75% complete (batch 136/181)
2025-12-24 12:29:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.060439
2025-12-24 12:29:59 INFO Tuning ranking metrics: regret=0.157208 spearman=-0.049851 (groups=39, skipped=329)
2025-12-24 12:29:59 INFO Epoch 021 | train_mse=0.141803 | val_loss=0.138584 | best_val_loss=0.187973
2025-12-24 12:30:07 INFO Epoch 022 | 25% complete (batch 46/181)
2025-12-24 12:30:08 INFO Epoch 022 | 50% complete (batch 91/181)
2025-12-24 12:30:09 INFO Epoch 022 | 75% complete (batch 136/181)
2025-12-24 12:30:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.097568
2025-12-24 12:30:23 INFO Tuning ranking metrics: regret=0.169386 spearman=0.046764 (groups=39, skipped=329)
2025-12-24 12:30:23 INFO Epoch 022 | train_mse=0.145417 | val_loss=0.135385 | best_val_loss=0.187973
2025-12-24 12:30:31 INFO Epoch 023 | 25% complete (batch 46/181)
2025-12-24 12:30:33 INFO Epoch 023 | 50% complete (batch 91/181)
2025-12-24 12:30:34 INFO Epoch 023 | 75% complete (batch 136/181)
2025-12-24 12:30:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.079737
2025-12-24 12:30:47 INFO Tuning ranking metrics: regret=0.175245 spearman=-0.104701 (groups=39, skipped=329)
2025-12-24 12:30:47 INFO Epoch 023 | train_mse=0.141109 | val_loss=0.134500 | best_val_loss=0.187973
2025-12-24 12:30:56 INFO Epoch 024 | 25% complete (batch 46/181)
2025-12-24 12:30:57 INFO Epoch 024 | 50% complete (batch 91/181)
2025-12-24 12:30:58 INFO Epoch 024 | 75% complete (batch 136/181)
2025-12-24 12:31:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.110212
2025-12-24 12:31:11 INFO Tuning ranking metrics: regret=0.152713 spearman=-0.031929 (groups=39, skipped=329)
2025-12-24 12:31:11 INFO Epoch 024 | train_mse=0.134947 | val_loss=0.135112 | best_val_loss=0.187973
2025-12-24 12:31:20 INFO Epoch 025 | 25% complete (batch 46/181)
2025-12-24 12:31:21 INFO Epoch 025 | 50% complete (batch 91/181)
2025-12-24 12:31:22 INFO Epoch 025 | 75% complete (batch 136/181)
2025-12-24 12:31:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.235166
2025-12-24 12:31:35 INFO Tuning ranking metrics: regret=0.124356 spearman=0.081807 (groups=39, skipped=329)
2025-12-24 12:31:35 INFO Epoch 025 | train_mse=0.129018 | val_loss=0.136736 | best_val_loss=0.187973
2025-12-24 12:31:44 INFO Epoch 026 | 25% complete (batch 46/181)
2025-12-24 12:31:45 INFO Epoch 026 | 50% complete (batch 91/181)
2025-12-24 12:31:46 INFO Epoch 026 | 75% complete (batch 136/181)
2025-12-24 12:31:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.398158
2025-12-24 12:31:59 INFO Tuning ranking metrics: regret=0.124535 spearman=0.048168 (groups=39, skipped=329)
2025-12-24 12:31:59 INFO Epoch 026 | train_mse=0.126074 | val_loss=0.118899 | best_val_loss=0.187973
2025-12-24 12:32:08 INFO Epoch 027 | 25% complete (batch 46/181)
2025-12-24 12:32:08 INFO Epoch 027 | 50% complete (batch 91/181)
2025-12-24 12:32:09 INFO Epoch 027 | 75% complete (batch 136/181)
2025-12-24 12:32:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.433013
2025-12-24 12:32:23 INFO Tuning ranking metrics: regret=0.119006 spearman=0.215446 (groups=39, skipped=329)
2025-12-24 12:32:23 INFO Epoch 027 | train_mse=0.128722 | val_loss=0.112314 | best_val_loss=0.187973
Metric tuning_rank_spearman improved by 0.027 >= min_delta = 0.0. New best score: 0.215
2025-12-24 12:32:32 INFO Epoch 028 | 25% complete (batch 46/181)
2025-12-24 12:32:33 INFO Epoch 028 | 50% complete (batch 91/181)
2025-12-24 12:32:33 INFO Epoch 028 | 75% complete (batch 136/181)
2025-12-24 12:32:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.524235
2025-12-24 12:32:47 INFO Tuning ranking metrics: regret=0.134937 spearman=-0.045482 (groups=39, skipped=329)
2025-12-24 12:32:47 INFO Epoch 028 | train_mse=0.125767 | val_loss=0.133853 | best_val_loss=0.215446
2025-12-24 12:32:55 INFO Epoch 029 | 25% complete (batch 46/181)
2025-12-24 12:32:56 INFO Epoch 029 | 50% complete (batch 91/181)
2025-12-24 12:32:57 INFO Epoch 029 | 75% complete (batch 136/181)
2025-12-24 12:33:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.433914
2025-12-24 12:33:11 INFO Tuning ranking metrics: regret=0.126225 spearman=0.142430 (groups=39, skipped=329)
2025-12-24 12:33:11 INFO Epoch 029 | train_mse=0.127914 | val_loss=0.130746 | best_val_loss=0.215446
2025-12-24 12:33:20 INFO Epoch 030 | 25% complete (batch 46/181)
2025-12-24 12:33:21 INFO Epoch 030 | 50% complete (batch 91/181)
2025-12-24 12:33:22 INFO Epoch 030 | 75% complete (batch 136/181)
2025-12-24 12:33:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.396410
2025-12-24 12:33:35 INFO Tuning ranking metrics: regret=0.132721 spearman=0.101832 (groups=39, skipped=329)
2025-12-24 12:33:35 INFO Epoch 030 | train_mse=0.131923 | val_loss=0.258609 | best_val_loss=0.215446
2025-12-24 12:33:44 INFO Epoch 031 | 25% complete (batch 46/181)
2025-12-24 12:33:44 INFO Epoch 031 | 50% complete (batch 91/181)
2025-12-24 12:33:45 INFO Epoch 031 | 75% complete (batch 136/181)
2025-12-24 12:33:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.473774
2025-12-24 12:33:59 INFO Tuning ranking metrics: regret=0.169655 spearman=0.041453 (groups=39, skipped=329)
2025-12-24 12:33:59 INFO Epoch 031 | train_mse=0.114838 | val_loss=0.141372 | best_val_loss=0.215446
2025-12-24 12:34:08 INFO Epoch 032 | 25% complete (batch 46/181)
2025-12-24 12:34:09 INFO Epoch 032 | 50% complete (batch 91/181)
2025-12-24 12:34:09 INFO Epoch 032 | 75% complete (batch 136/181)
2025-12-24 12:34:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.118188
2025-12-24 12:34:23 INFO Tuning ranking metrics: regret=0.112615 spearman=0.251160 (groups=39, skipped=329)
2025-12-24 12:34:23 INFO Epoch 032 | train_mse=0.139382 | val_loss=0.118188 | best_val_loss=0.215446
Metric tuning_rank_spearman improved by 0.036 >= min_delta = 0.0. New best score: 0.251
2025-12-24 12:34:32 INFO Epoch 033 | 25% complete (batch 46/181)
2025-12-24 12:34:32 INFO Epoch 033 | 50% complete (batch 91/181)
2025-12-24 12:34:33 INFO Epoch 033 | 75% complete (batch 136/181)
2025-12-24 12:34:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.360516
2025-12-24 12:34:47 INFO Tuning ranking metrics: regret=0.106655 spearman=0.116911 (groups=39, skipped=329)
2025-12-24 12:34:47 INFO Epoch 033 | train_mse=0.115123 | val_loss=0.299868 | best_val_loss=0.251160
2025-12-24 12:34:56 INFO Epoch 034 | 25% complete (batch 46/181)
2025-12-24 12:34:57 INFO Epoch 034 | 50% complete (batch 91/181)
2025-12-24 12:34:58 INFO Epoch 034 | 75% complete (batch 136/181)
2025-12-24 12:35:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.386747
2025-12-24 12:35:12 INFO Tuning ranking metrics: regret=0.092632 spearman=0.288645 (groups=39, skipped=329)
2025-12-24 12:35:12 INFO Epoch 034 | train_mse=0.130355 | val_loss=0.097059 | best_val_loss=0.251160
Metric tuning_rank_spearman improved by 0.037 >= min_delta = 0.0. New best score: 0.289
2025-12-24 12:35:20 INFO Epoch 035 | 25% complete (batch 46/181)
2025-12-24 12:35:22 INFO Epoch 035 | 50% complete (batch 91/181)
2025-12-24 12:35:23 INFO Epoch 035 | 75% complete (batch 136/181)
2025-12-24 12:35:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.363744
2025-12-24 12:35:37 INFO Tuning ranking metrics: regret=0.113590 spearman=0.229426 (groups=39, skipped=329)
2025-12-24 12:35:37 INFO Epoch 035 | train_mse=0.144779 | val_loss=0.317767 | best_val_loss=0.288645
2025-12-24 12:35:45 INFO Epoch 036 | 25% complete (batch 46/181)
2025-12-24 12:35:46 INFO Epoch 036 | 50% complete (batch 91/181)
2025-12-24 12:35:47 INFO Epoch 036 | 75% complete (batch 136/181)
2025-12-24 12:35:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.360162
2025-12-24 12:36:01 INFO Tuning ranking metrics: regret=0.133814 spearman=0.130952 (groups=39, skipped=329)
2025-12-24 12:36:01 INFO Epoch 036 | train_mse=0.091757 | val_loss=0.318298 | best_val_loss=0.288645
2025-12-24 12:36:09 INFO Epoch 037 | 25% complete (batch 46/181)
2025-12-24 12:36:10 INFO Epoch 037 | 50% complete (batch 91/181)
2025-12-24 12:36:11 INFO Epoch 037 | 75% complete (batch 136/181)
2025-12-24 12:36:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.288800
2025-12-24 12:36:25 INFO Tuning ranking metrics: regret=0.133814 spearman=0.140598 (groups=39, skipped=329)
2025-12-24 12:36:25 INFO Epoch 037 | train_mse=0.333567 | val_loss=0.318298 | best_val_loss=0.288645
2025-12-24 12:36:33 INFO Epoch 038 | 25% complete (batch 46/181)
2025-12-24 12:36:34 INFO Epoch 038 | 50% complete (batch 91/181)
2025-12-24 12:36:35 INFO Epoch 038 | 75% complete (batch 136/181)
2025-12-24 12:36:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.278119
2025-12-24 12:36:49 INFO Tuning ranking metrics: regret=0.133814 spearman=0.140598 (groups=39, skipped=329)
2025-12-24 12:36:49 INFO Epoch 038 | train_mse=0.276011 | val_loss=0.318298 | best_val_loss=0.288645
2025-12-24 12:36:57 INFO Epoch 039 | 25% complete (batch 46/181)
2025-12-24 12:36:58 INFO Epoch 039 | 50% complete (batch 91/181)
2025-12-24 12:36:59 INFO Epoch 039 | 75% complete (batch 136/181)
2025-12-24 12:37:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.278890
2025-12-24 12:37:13 INFO Tuning ranking metrics: regret=0.133814 spearman=0.140598 (groups=39, skipped=329)
2025-12-24 12:37:13 INFO Epoch 039 | train_mse=0.296200 | val_loss=0.318298 | best_val_loss=0.288645
2025-12-24 12:37:21 INFO Epoch 040 | 25% complete (batch 46/181)
2025-12-24 12:37:22 INFO Epoch 040 | 50% complete (batch 91/181)
2025-12-24 12:37:23 INFO Epoch 040 | 75% complete (batch 136/181)
2025-12-24 12:37:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.278991
2025-12-24 12:37:37 INFO Tuning ranking metrics: regret=0.133814 spearman=0.140598 (groups=39, skipped=329)
2025-12-24 12:37:37 INFO Epoch 040 | train_mse=0.335773 | val_loss=0.318298 | best_val_loss=0.288645
2025-12-24 12:37:46 INFO Epoch 041 | 25% complete (batch 46/181)
2025-12-24 12:37:47 INFO Epoch 041 | 50% complete (batch 91/181)
2025-12-24 12:37:48 INFO Epoch 041 | 75% complete (batch 136/181)
2025-12-24 12:37:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.278991
2025-12-24 12:38:02 INFO Tuning ranking metrics: regret=0.133814 spearman=0.140598 (groups=39, skipped=329)
2025-12-24 12:38:02 INFO Epoch 041 | train_mse=0.327175 | val_loss=0.318298 | best_val_loss=0.288645
2025-12-24 12:38:10 INFO Epoch 042 | 25% complete (batch 46/181)
2025-12-24 12:38:11 INFO Epoch 042 | 50% complete (batch 91/181)
2025-12-24 12:38:12 INFO Epoch 042 | 75% complete (batch 136/181)
2025-12-24 12:38:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.278991
2025-12-24 12:38:26 INFO Tuning ranking metrics: regret=0.133814 spearman=0.140598 (groups=39, skipped=329)
2025-12-24 12:38:26 INFO Epoch 042 | train_mse=0.320298 | val_loss=0.318298 | best_val_loss=0.288645
2025-12-24 12:38:34 INFO Epoch 043 | 25% complete (batch 46/181)
2025-12-24 12:38:35 INFO Epoch 043 | 50% complete (batch 91/181)
2025-12-24 12:38:36 INFO Epoch 043 | 75% complete (batch 136/181)
2025-12-24 12:38:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.278991
2025-12-24 12:38:50 INFO Tuning ranking metrics: regret=0.133814 spearman=0.140598 (groups=39, skipped=329)
2025-12-24 12:38:50 INFO Epoch 043 | train_mse=0.293725 | val_loss=0.318298 | best_val_loss=0.288645
2025-12-24 12:38:58 INFO Epoch 044 | 25% complete (batch 46/181)
2025-12-24 12:38:59 INFO Epoch 044 | 50% complete (batch 91/181)
2025-12-24 12:39:00 INFO Epoch 044 | 75% complete (batch 136/181)
2025-12-24 12:39:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.278991
2025-12-24 12:39:14 INFO Tuning ranking metrics: regret=0.133814 spearman=0.140598 (groups=39, skipped=329)
2025-12-24 12:39:14 INFO Epoch 044 | train_mse=0.336222 | val_loss=0.318298 | best_val_loss=0.288645
2025-12-24 12:39:22 INFO Epoch 045 | 25% complete (batch 46/181)
2025-12-24 12:39:23 INFO Epoch 045 | 50% complete (batch 91/181)
2025-12-24 12:39:24 INFO Epoch 045 | 75% complete (batch 136/181)
2025-12-24 12:39:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.279796
2025-12-24 12:39:38 INFO Tuning ranking metrics: regret=0.133814 spearman=0.140598 (groups=39, skipped=329)
2025-12-24 12:39:38 INFO Epoch 045 | train_mse=0.360359 | val_loss=0.318298 | best_val_loss=0.288645
2025-12-24 12:39:46 INFO Epoch 046 | 25% complete (batch 46/181)
2025-12-24 12:39:47 INFO Epoch 046 | 50% complete (batch 91/181)
2025-12-24 12:39:48 INFO Epoch 046 | 75% complete (batch 136/181)
2025-12-24 12:39:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.279796
2025-12-24 12:40:02 INFO Tuning ranking metrics: regret=0.133814 spearman=0.140598 (groups=39, skipped=329)
2025-12-24 12:40:02 INFO Epoch 046 | train_mse=0.334954 | val_loss=0.318298 | best_val_loss=0.288645
2025-12-24 12:40:11 INFO Epoch 047 | 25% complete (batch 46/181)
2025-12-24 12:40:12 INFO Epoch 047 | 50% complete (batch 91/181)
2025-12-24 12:40:13 INFO Epoch 047 | 75% complete (batch 136/181)
2025-12-24 12:40:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.279259
2025-12-24 12:40:26 INFO Tuning ranking metrics: regret=0.133814 spearman=0.140598 (groups=39, skipped=329)
2025-12-24 12:40:26 INFO Epoch 047 | train_mse=0.327417 | val_loss=0.318298 | best_val_loss=0.288645
2025-12-24 12:40:35 INFO Epoch 048 | 25% complete (batch 46/181)
2025-12-24 12:40:36 INFO Epoch 048 | 50% complete (batch 91/181)
2025-12-24 12:40:37 INFO Epoch 048 | 75% complete (batch 136/181)
2025-12-24 12:40:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.278790
2025-12-24 12:40:50 INFO Tuning ranking metrics: regret=0.133814 spearman=0.140598 (groups=39, skipped=329)
2025-12-24 12:40:50 INFO Epoch 048 | train_mse=0.323360 | val_loss=0.318298 | best_val_loss=0.288645
2025-12-24 12:40:59 INFO Epoch 049 | 25% complete (batch 46/181)
2025-12-24 12:41:00 INFO Epoch 049 | 50% complete (batch 91/181)
2025-12-24 12:41:01 INFO Epoch 049 | 75% complete (batch 136/181)
2025-12-24 12:41:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.278790
2025-12-24 12:41:14 INFO Tuning ranking metrics: regret=0.133814 spearman=0.140598 (groups=39, skipped=329)
2025-12-24 12:41:14 INFO Epoch 049 | train_mse=0.328832 | val_loss=0.318298 | best_val_loss=0.288645
2025-12-24 12:41:23 INFO Epoch 050 | 25% complete (batch 46/181)
2025-12-24 12:41:24 INFO Epoch 050 | 50% complete (batch 91/181)
2025-12-24 12:41:25 INFO Epoch 050 | 75% complete (batch 136/181)
2025-12-24 12:41:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.278790
2025-12-24 12:41:38 INFO Tuning ranking metrics: regret=0.133814 spearman=0.140598 (groups=39, skipped=329)
2025-12-24 12:41:38 INFO Epoch 050 | train_mse=0.321933 | val_loss=0.318298 | best_val_loss=0.288645
2025-12-24 12:41:46 INFO Epoch 051 | 25% complete (batch 46/181)
2025-12-24 12:41:47 INFO Epoch 051 | 50% complete (batch 91/181)
2025-12-24 12:41:48 INFO Epoch 051 | 75% complete (batch 136/181)
2025-12-24 12:41:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.278790
2025-12-24 12:42:02 INFO Tuning ranking metrics: regret=0.133814 spearman=0.140598 (groups=39, skipped=329)
2025-12-24 12:42:02 INFO Epoch 051 | train_mse=0.289073 | val_loss=0.318298 | best_val_loss=0.288645
2025-12-24 12:42:11 INFO Epoch 052 | 25% complete (batch 46/181)
2025-12-24 12:42:12 INFO Epoch 052 | 50% complete (batch 91/181)
2025-12-24 12:42:13 INFO Epoch 052 | 75% complete (batch 136/181)
2025-12-24 12:42:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.278790
2025-12-24 12:42:27 INFO Tuning ranking metrics: regret=0.133814 spearman=0.140598 (groups=39, skipped=329)
2025-12-24 12:42:27 INFO Epoch 052 | train_mse=0.253113 | val_loss=0.318298 | best_val_loss=0.288645
2025-12-24 12:42:35 INFO Epoch 053 | 25% complete (batch 46/181)
2025-12-24 12:42:36 INFO Epoch 053 | 50% complete (batch 91/181)
2025-12-24 12:42:37 INFO Epoch 053 | 75% complete (batch 136/181)
2025-12-24 12:42:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.278790
2025-12-24 12:42:51 INFO Tuning ranking metrics: regret=0.133814 spearman=0.140598 (groups=39, skipped=329)
2025-12-24 12:42:51 INFO Epoch 053 | train_mse=0.290501 | val_loss=0.318298 | best_val_loss=0.288645
2025-12-24 12:43:00 INFO Epoch 054 | 25% complete (batch 46/181)
2025-12-24 12:43:01 INFO Epoch 054 | 50% complete (batch 91/181)
2025-12-24 12:43:01 INFO Epoch 054 | 75% complete (batch 136/181)
2025-12-24 12:43:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.278790
2025-12-24 12:43:15 INFO Tuning ranking metrics: regret=0.133814 spearman=0.140598 (groups=39, skipped=329)
2025-12-24 12:43:15 INFO Epoch 054 | train_mse=0.311497 | val_loss=0.318298 | best_val_loss=0.288645
2025-12-24 12:43:24 INFO Epoch 055 | 25% complete (batch 46/181)
2025-12-24 12:43:25 INFO Epoch 055 | 50% complete (batch 91/181)
2025-12-24 12:43:25 INFO Epoch 055 | 75% complete (batch 136/181)
2025-12-24 12:43:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.278790
2025-12-24 12:43:39 INFO Tuning ranking metrics: regret=0.133814 spearman=0.140598 (groups=39, skipped=329)
2025-12-24 12:43:39 INFO Epoch 055 | train_mse=0.301959 | val_loss=0.318298 | best_val_loss=0.288645
2025-12-24 12:43:48 INFO Epoch 056 | 25% complete (batch 46/181)
2025-12-24 12:43:48 INFO Epoch 056 | 50% complete (batch 91/181)
2025-12-24 12:43:49 INFO Epoch 056 | 75% complete (batch 136/181)
2025-12-24 12:43:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.278790
2025-12-24 12:44:03 INFO Tuning ranking metrics: regret=0.133814 spearman=0.140598 (groups=39, skipped=329)
2025-12-24 12:44:03 INFO Epoch 056 | train_mse=0.365364 | val_loss=0.318298 | best_val_loss=0.288645
2025-12-24 12:44:12 INFO Epoch 057 | 25% complete (batch 46/181)
2025-12-24 12:44:13 INFO Epoch 057 | 50% complete (batch 91/181)
2025-12-24 12:44:13 INFO Epoch 057 | 75% complete (batch 136/181)
2025-12-24 12:44:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.278790
2025-12-24 12:44:28 INFO Tuning ranking metrics: regret=0.133814 spearman=0.140598 (groups=39, skipped=329)
2025-12-24 12:44:28 INFO Epoch 057 | train_mse=0.330406 | val_loss=0.318298 | best_val_loss=0.288645
2025-12-24 12:44:36 INFO Epoch 058 | 25% complete (batch 46/181)
2025-12-24 12:44:37 INFO Epoch 058 | 50% complete (batch 91/181)
2025-12-24 12:44:39 INFO Epoch 058 | 75% complete (batch 136/181)
2025-12-24 12:44:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.278790
2025-12-24 12:44:52 INFO Tuning ranking metrics: regret=0.133814 spearman=0.140598 (groups=39, skipped=329)
2025-12-24 12:44:52 INFO Epoch 058 | train_mse=0.292399 | val_loss=0.318298 | best_val_loss=0.288645
2025-12-24 12:45:01 INFO Epoch 059 | 25% complete (batch 46/181)
2025-12-24 12:45:02 INFO Epoch 059 | 50% complete (batch 91/181)
2025-12-24 12:45:03 INFO Epoch 059 | 75% complete (batch 136/181)
2025-12-24 12:45:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.278790
2025-12-24 12:45:16 INFO Tuning ranking metrics: regret=0.133814 spearman=0.140598 (groups=39, skipped=329)
2025-12-24 12:45:16 INFO Epoch 059 | train_mse=0.322986 | val_loss=0.318298 | best_val_loss=0.288645
2025-12-24 12:45:25 INFO Epoch 060 | 25% complete (batch 46/181)
2025-12-24 12:45:26 INFO Epoch 060 | 50% complete (batch 91/181)
2025-12-24 12:45:27 INFO Epoch 060 | 75% complete (batch 136/181)
2025-12-24 12:45:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.278790
2025-12-24 12:45:40 INFO Tuning ranking metrics: regret=0.133814 spearman=0.140598 (groups=39, skipped=329)
2025-12-24 12:45:40 INFO Epoch 060 | train_mse=0.305204 | val_loss=0.318298 | best_val_loss=0.288645
2025-12-24 12:45:49 INFO Epoch 061 | 25% complete (batch 46/181)
2025-12-24 12:45:50 INFO Epoch 061 | 50% complete (batch 91/181)
2025-12-24 12:45:50 INFO Epoch 061 | 75% complete (batch 136/181)
2025-12-24 12:45:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.278790
2025-12-24 12:46:04 INFO Tuning ranking metrics: regret=0.133814 spearman=0.140598 (groups=39, skipped=329)
2025-12-24 12:46:04 INFO Epoch 061 | train_mse=0.293384 | val_loss=0.318298 | best_val_loss=0.288645
2025-12-24 12:46:13 INFO Epoch 062 | 25% complete (batch 46/181)
2025-12-24 12:46:13 INFO Epoch 062 | 50% complete (batch 91/181)
2025-12-24 12:46:14 INFO Epoch 062 | 75% complete (batch 136/181)
2025-12-24 12:46:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.278790
2025-12-24 12:46:28 INFO Tuning ranking metrics: regret=0.133814 spearman=0.140598 (groups=39, skipped=329)
2025-12-24 12:46:28 INFO Epoch 062 | train_mse=0.308771 | val_loss=0.318298 | best_val_loss=0.288645
2025-12-24 12:46:37 INFO Epoch 063 | 25% complete (batch 46/181)
2025-12-24 12:46:38 INFO Epoch 063 | 50% complete (batch 91/181)
2025-12-24 12:46:39 INFO Epoch 063 | 75% complete (batch 136/181)
2025-12-24 12:46:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.278790
2025-12-24 12:46:52 INFO Tuning ranking metrics: regret=0.133814 spearman=0.140598 (groups=39, skipped=329)
2025-12-24 12:46:52 INFO Epoch 063 | train_mse=0.293253 | val_loss=0.318298 | best_val_loss=0.288645
2025-12-24 12:47:01 INFO Epoch 064 | 25% complete (batch 46/181)
2025-12-24 12:47:02 INFO Epoch 064 | 50% complete (batch 91/181)
2025-12-24 12:47:03 INFO Epoch 064 | 75% complete (batch 136/181)
2025-12-24 12:47:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.278790
2025-12-24 12:47:16 INFO Tuning ranking metrics: regret=0.133814 spearman=0.140598 (groups=39, skipped=329)
2025-12-24 12:47:16 INFO Epoch 064 | train_mse=0.315123 | val_loss=0.318298 | best_val_loss=0.288645
2025-12-24 12:47:24 INFO Epoch 065 | 25% complete (batch 46/181)
2025-12-24 12:47:26 INFO Epoch 065 | 50% complete (batch 91/181)
2025-12-24 12:47:27 INFO Epoch 065 | 75% complete (batch 136/181)
2025-12-24 12:47:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.278790
2025-12-24 12:47:40 INFO Tuning ranking metrics: regret=0.133814 spearman=0.140598 (groups=39, skipped=329)
2025-12-24 12:47:40 INFO Epoch 065 | train_mse=0.327784 | val_loss=0.318298 | best_val_loss=0.288645
2025-12-24 12:47:49 INFO Epoch 066 | 25% complete (batch 46/181)
2025-12-24 12:47:50 INFO Epoch 066 | 50% complete (batch 91/181)
2025-12-24 12:47:51 INFO Epoch 066 | 75% complete (batch 136/181)
2025-12-24 12:47:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.278790
2025-12-24 12:48:04 INFO Tuning ranking metrics: regret=0.133814 spearman=0.140598 (groups=39, skipped=329)
2025-12-24 12:48:04 INFO Epoch 066 | train_mse=0.315493 | val_loss=0.318298 | best_val_loss=0.288645
2025-12-24 12:48:13 INFO Epoch 067 | 25% complete (batch 46/181)
2025-12-24 12:48:14 INFO Epoch 067 | 50% complete (batch 91/181)
2025-12-24 12:48:15 INFO Epoch 067 | 75% complete (batch 136/181)
2025-12-24 12:48:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.278790
2025-12-24 12:48:28 INFO Tuning ranking metrics: regret=0.133814 spearman=0.140598 (groups=39, skipped=329)
2025-12-24 12:48:28 INFO Epoch 067 | train_mse=0.324688 | val_loss=0.318298 | best_val_loss=0.288645
2025-12-24 12:48:37 INFO Epoch 068 | 25% complete (batch 46/181)
2025-12-24 12:48:38 INFO Epoch 068 | 50% complete (batch 91/181)
2025-12-24 12:48:38 INFO Epoch 068 | 75% complete (batch 136/181)
2025-12-24 12:48:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.278790
2025-12-24 12:48:52 INFO Tuning ranking metrics: regret=0.133814 spearman=0.140598 (groups=39, skipped=329)
2025-12-24 12:48:52 INFO Epoch 068 | train_mse=0.345845 | val_loss=0.318298 | best_val_loss=0.288645
2025-12-24 12:49:01 INFO Epoch 069 | 25% complete (batch 46/181)
2025-12-24 12:49:02 INFO Epoch 069 | 50% complete (batch 91/181)
2025-12-24 12:49:03 INFO Epoch 069 | 75% complete (batch 136/181)
2025-12-24 12:49:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.278790
2025-12-24 12:49:16 INFO Tuning ranking metrics: regret=0.133814 spearman=0.140598 (groups=39, skipped=329)
2025-12-24 12:49:16 INFO Epoch 069 | train_mse=0.325813 | val_loss=0.318298 | best_val_loss=0.288645
2025-12-24 12:49:25 INFO Epoch 070 | 25% complete (batch 46/181)
2025-12-24 12:49:26 INFO Epoch 070 | 50% complete (batch 91/181)
2025-12-24 12:49:26 INFO Epoch 070 | 75% complete (batch 136/181)
2025-12-24 12:49:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.278790
2025-12-24 12:49:40 INFO Tuning ranking metrics: regret=0.133814 spearman=0.140598 (groups=39, skipped=329)
2025-12-24 12:49:40 INFO Epoch 070 | train_mse=0.319288 | val_loss=0.318298 | best_val_loss=0.288645
2025-12-24 12:49:49 INFO Epoch 071 | 25% complete (batch 46/181)
2025-12-24 12:49:50 INFO Epoch 071 | 50% complete (batch 91/181)
2025-12-24 12:49:51 INFO Epoch 071 | 75% complete (batch 136/181)
2025-12-24 12:49:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.278790
2025-12-24 12:50:04 INFO Tuning ranking metrics: regret=0.133814 spearman=0.140598 (groups=39, skipped=329)
2025-12-24 12:50:04 INFO Epoch 071 | train_mse=0.310123 | val_loss=0.318298 | best_val_loss=0.288645
2025-12-24 12:50:13 INFO Epoch 072 | 25% complete (batch 46/181)
2025-12-24 12:50:14 INFO Epoch 072 | 50% complete (batch 91/181)
2025-12-24 12:50:15 INFO Epoch 072 | 75% complete (batch 136/181)
2025-12-24 12:50:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.278790
2025-12-24 12:50:29 INFO Tuning ranking metrics: regret=0.133814 spearman=0.140598 (groups=39, skipped=329)
2025-12-24 12:50:29 INFO Epoch 072 | train_mse=0.334360 | val_loss=0.318298 | best_val_loss=0.288645
2025-12-24 12:50:38 INFO Epoch 073 | 25% complete (batch 46/181)
2025-12-24 12:50:39 INFO Epoch 073 | 50% complete (batch 91/181)
2025-12-24 12:50:40 INFO Epoch 073 | 75% complete (batch 136/181)
2025-12-24 12:50:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.278790
2025-12-24 12:50:53 INFO Tuning ranking metrics: regret=0.133814 spearman=0.140598 (groups=39, skipped=329)
2025-12-24 12:50:53 INFO Epoch 073 | train_mse=0.312351 | val_loss=0.318298 | best_val_loss=0.288645
2025-12-24 12:51:02 INFO Epoch 074 | 25% complete (batch 46/181)
2025-12-24 12:51:03 INFO Epoch 074 | 50% complete (batch 91/181)
2025-12-24 12:51:04 INFO Epoch 074 | 75% complete (batch 136/181)
2025-12-24 12:51:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.278790
2025-12-24 12:51:17 INFO Tuning ranking metrics: regret=0.133814 spearman=0.140598 (groups=39, skipped=329)
2025-12-24 12:51:17 INFO Epoch 074 | train_mse=0.275287 | val_loss=0.318298 | best_val_loss=0.288645
Monitored metric tuning_rank_spearman did not improve in the last 40 records. Best score: 0.289. Signaling Trainer to stop.
2025-12-24 12:51:18 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.22943_val-0.31777_epoch035.chkpt, checkpoint.tuning_rank_spearman-0.25116_val-0.11819_epoch032.chkpt, checkpoint.tuning_rank_spearman-0.28864_val-0.09706_epoch034.chkpt
2025-12-24 12:51:18 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-24_12-20-58/model_checkpoints/checkpoint.tuning_rank_spearman-0.28864_val-0.09706_epoch034.chkpt
2025-12-24 12:51:18 INFO Best validation loss: tensor(0.2886)
2025-12-24 12:51:18 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-24_12-20-58/model_checkpoints/checkpoint.tuning_rank_spearman-0.28864_val-0.09706_epoch034.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-24_12-20-58/model_checkpoints/checkpoint.tuning_rank_spearman-0.28864_val-0.09706_epoch034.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-24 12:51:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.097059
2025-12-24 12:51:31 INFO Tuning ranking metrics: regret=0.092632 spearman=0.288645 (groups=39, skipped=329)
2025-12-24 12:51:31 INFO Epoch 075 | val_loss=0.097059 | best_val_loss=0.288645
2025-12-24 12:51:31 INFO Validation metrics: [{'val_loss': 0.09705942124128342, 'tuning_rank_regret': 0.09263183176517487, 'tuning_rank_spearman': 0.2886447012424469, 'val_pearson_corr': 0.678322970867157, 'val_spearman_corr': 0.681511402130127, 'val_rank_regret': 0.07269555330276489, 'val_rank_spearman': 0.5555555820465088}]
2025-12-24 12:51:31 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.28864_val-0.09706_epoch034.chkpt
2025-12-24 12:51:31 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.25116_val-0.11819_epoch032.chkpt
2025-12-24 12:51:31 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.22943_val-0.31777_epoch035.chkpt
2025-12-24 12:51:31 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.11231_epoch027.ckpt
2025-12-24 12:51:31 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.09263183176517487
  tuning_rank_spearman      0.2886447012424469
        val_loss            0.09705942124128342
    val_pearson_corr         0.678322970867157
     val_rank_regret        0.07269555330276489
    val_rank_spearman       0.5555555820465088
    val_spearman_corr        0.681511402130127
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run polish_seed555_2025-12-24_12-20-58 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-24_12-20-58
[train_cli][batch] job 'polish_seed555' finished.
[train_cli][batch] (4/6) running job 'polish_lr_low_seed555' -> run_name=polish_lr_low_seed555_2025-12-24_12-51-34
[train_cli] run_id=polish_lr_low_seed555_2025-12-24_12-51-34 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-24_12-51-34/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-24_12-51-34 --git-commit 9b1bb2b320 --git-dirty
2025-12-24 12:51:37 INFO git_commit = 9b1bb2b320 (dirty)
2025-12-24 12:51:37 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-24 12:51:37 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-24_12-51-34/config/config.yaml
2025-12-24 12:51:37 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data
2025-12-24 12:51:37 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-24 12:51:37 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-24 12:51:37 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-24_12-51-34
2025-12-24 12:51:37 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-24 12:51:37 INFO   metadata_path = None
2025-12-24 12:51:37 INFO   summary_path = None
2025-12-24 12:51:37 INFO   accelerator = cpu
2025-12-24 12:51:37 INFO   devices = 1
2025-12-24 12:51:37 INFO   attention_head = 8
2025-12-24 12:51:37 INFO   pooling_type = mean
2025-12-24 12:51:37 INFO   model_self_loops = False
2025-12-24 12:51:37 INFO   model_self_loop_fill = mean
2025-12-24 12:51:37 INFO   model_residual = False
2025-12-24 12:51:37 INFO   batch_size = 12
2025-12-24 12:51:37 INFO   learning_rate = 0.002
2025-12-24 12:51:37 INFO   num_epochs = 360
2025-12-24 12:51:37 INFO   accumulate_grad_batches = 48
2025-12-24 12:51:37 INFO   seed = 555
2025-12-24 12:51:37 INFO   num_workers = 2
2025-12-24 12:51:37 INFO   precision = 32
2025-12-24 12:51:37 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-24 12:51:37 INFO   early_stopping_patience = 50
2025-12-24 12:51:37 INFO   lr_scheduler_patience = 25
2025-12-24 12:51:37 INFO   lr_scheduler_factor = 0.3
2025-12-24 12:51:37 INFO   fast_dev_run = False
2025-12-24 12:51:37 INFO   limit_train_batches = None
2025-12-24 12:51:37 INFO   limit_val_batches = None
2025-12-24 12:51:37 INFO   log_lr = False
2025-12-24 12:51:37 INFO   progress_bar_refresh_rate = 0
2025-12-24 12:51:37 INFO   log_every_n_steps = 100
2025-12-24 12:51:37 INFO   use_val_spearman_as_secondary = True
2025-12-24 12:51:37 INFO   spearman_secondary_min_delta = 0.0
2025-12-24 12:51:37 INFO   spearman_secondary_weight = 1.0
2025-12-24 12:51:37 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-24 12:51:37 INFO   tuning_max_samples = 500
2025-12-24 12:51:37 INFO   tuning_fraction = None
2025-12-24 12:51:37 INFO   tuning_eval_every = 1
2025-12-24 12:51:37 INFO   rank_loss_weight = 0.0
2025-12-24 12:51:37 INFO   rank_loss_margin = 0.0
2025-12-24 12:51:37 INFO   rank_loss_mode = hinge
2025-12-24 12:51:37 INFO   rank_loss_grouped = True
2025-12-24 12:51:37 INFO   variance_reduction_enabled = False
2025-12-24 12:51:37 INFO   variance_reduction_method = topk_avg
2025-12-24 12:51:37 INFO   variance_reduction_top_k = 3
2025-12-24 12:51:37 INFO   coverage_minimum = 0.0
2025-12-24 12:51:37 INFO   coverage_fail_on_missing = False
2025-12-24 12:51:37 INFO   graph_load_profiling = False
2025-12-24 12:51:37 INFO   graph_load_top_k = 5
2025-12-24 12:51:37 INFO   enable_graph_cache = True
2025-12-24 12:51:37 INFO   graph_cache_size = 256
2025-12-24 12:51:37 INFO   canonicalize_on_load = False
2025-12-24 12:51:37 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-24 12:51:37 INFO   edge_schema = {}
2025-12-24 12:51:37 INFO   topology_schema = {}
Seed set to 555
2025-12-24 12:51:38 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-24 12:51:38 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 12:51:38 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-24 12:51:38 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 12:51:38 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-24 12:51:38 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 12:51:40 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-24 12:51:40 INFO Tuning group stats: groups=368 groups>=2=39 singletons=329 max_group=9
2025-12-24 12:51:40 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-24_12-51-34/dataset_coverage.json
2025-12-24 12:51:40 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-24_12-51-34/dataset_coverage.json for details.
2025-12-24 12:51:40 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-24_12-51-34/dataset_coverage.json for details.
2025-12-24 12:51:40 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-24_12-51-34/dataset_coverage.json for details.
2025-12-24 12:51:40 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-24_12-51-34/schema_summary.json
2025-12-24 12:51:40 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-24_12-51-34/feature_metadata.json
2025-12-24 12:51:40 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-24 12:51:40 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/advanced_k_partite_v2/feature-config.yaml.advanced_lean.10A.v2, sha256=2022a36e7b21668173af3af66c25cf6b6a0494e642c0934eac38abbcfeebec3d
2025-12-24 12:51:40 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/work/edge_features)
2025-12-24 12:51:40 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json
2025-12-24 12:51:40 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-24_12-51-34/schema_summary.json
2025-12-24 12:51:40 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-24 12:51:40 INFO Topology: topology/persistence_k_partite_advanced/v2 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 628-dimensional node features.
2025-12-24 12:51:40 INFO Node: node/dssp_topo_merge_passthrough/v1; metadata lists 628 feature columns matching the .pt tensor.
2025-12-24 12:51:40 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-24 12:51:40 INFO → Total feature dimensionality observed and confirmed: node_dim = 628, edge_dim = 11.
2025-12-24 12:51:40 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-24 12:51:40 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 628,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge_passthrough/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 628,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-24_12-51-34/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge_passthrough/v1",
      "alias": "Passthrough (all dims from topology module) = Node Dynamic Dims",
      "jobs": 16,
      "summary": "DSSP/basic features merged with all topology columns (passthrough)."
    },
    "topology": {
      "id": "topology/persistence_k_partite_advanced/v2",
      "alias": "Advanced k-partite PH (v2 lean) topo_dim 596",
      "jobs": 16,
      "summary": "Fixed-width k-partite persistent homology with slot padding + missingness channels."
    }
  },
  "notes": []
}
2025-12-24 12:51:40 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-24 12:51:40 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=6585da4c3f7243e1b2e42c688a151030)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-24 12:51:40 INFO Starting training (fast_dev_run=False)
2025-12-24 12:51:40 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-24_12-51-34/model_checkpoints exists and is not empty.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 20.1 K | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
180 K     Trainable params
0         Non-trainable params
180 K     Total params
0.721     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-24 12:51:57 INFO Epoch 000 | 25% complete (batch 181/724)
2025-12-24 12:52:00 INFO Epoch 000 | 50% complete (batch 362/724)
2025-12-24 12:52:03 INFO Epoch 000 | 75% complete (batch 543/724)
2025-12-24 12:52:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.144791
2025-12-24 12:52:22 INFO Tuning ranking metrics: regret=0.171966 spearman=0.034188 (groups=39, skipped=329)
2025-12-24 12:52:22 INFO Epoch 000 | val_loss=0.144791
Metric tuning_rank_spearman improved. New best score: 0.034
2025-12-24 12:52:33 INFO Epoch 001 | 25% complete (batch 181/724)
2025-12-24 12:52:36 INFO Epoch 001 | 50% complete (batch 362/724)
2025-12-24 12:52:39 INFO Epoch 001 | 75% complete (batch 543/724)
2025-12-24 12:52:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.052430
2025-12-24 12:52:58 INFO Tuning ranking metrics: regret=0.152466 spearman=0.081380 (groups=39, skipped=329)
2025-12-24 12:52:58 INFO Epoch 001 | train_mse=0.152877 | val_loss=0.147373 | best_val_loss=0.034188
Metric tuning_rank_spearman improved by 0.047 >= min_delta = 0.0. New best score: 0.081
2025-12-24 12:53:09 INFO Epoch 002 | 25% complete (batch 181/724)
2025-12-24 12:53:12 INFO Epoch 002 | 50% complete (batch 362/724)
2025-12-24 12:53:15 INFO Epoch 002 | 75% complete (batch 543/724)
2025-12-24 12:53:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.271514
2025-12-24 12:53:33 INFO Tuning ranking metrics: regret=0.164240 spearman=0.083028 (groups=39, skipped=329)
2025-12-24 12:53:33 INFO Epoch 002 | train_mse=0.143837 | val_loss=0.143252 | best_val_loss=0.081380
Metric tuning_rank_spearman improved by 0.002 >= min_delta = 0.0. New best score: 0.083
2025-12-24 12:53:44 INFO Epoch 003 | 25% complete (batch 181/724)
2025-12-24 12:53:48 INFO Epoch 003 | 50% complete (batch 362/724)
2025-12-24 12:53:52 INFO Epoch 003 | 75% complete (batch 543/724)
2025-12-24 12:54:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.403800
2025-12-24 12:54:11 INFO Tuning ranking metrics: regret=0.133845 spearman=0.226679 (groups=39, skipped=329)
2025-12-24 12:54:11 INFO Epoch 003 | train_mse=0.140321 | val_loss=0.113016 | best_val_loss=0.083028
Metric tuning_rank_spearman improved by 0.144 >= min_delta = 0.0. New best score: 0.227
2025-12-24 12:54:21 INFO Epoch 004 | 25% complete (batch 181/724)
2025-12-24 12:54:25 INFO Epoch 004 | 50% complete (batch 362/724)
2025-12-24 12:54:28 INFO Epoch 004 | 75% complete (batch 543/724)
2025-12-24 12:54:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.391054
2025-12-24 12:54:47 INFO Tuning ranking metrics: regret=0.117562 spearman=0.141026 (groups=39, skipped=329)
2025-12-24 12:54:47 INFO Epoch 004 | train_mse=0.122899 | val_loss=0.151755 | best_val_loss=0.226679
2025-12-24 12:54:57 INFO Epoch 005 | 25% complete (batch 181/724)
2025-12-24 12:55:01 INFO Epoch 005 | 50% complete (batch 362/724)
2025-12-24 12:55:04 INFO Epoch 005 | 75% complete (batch 543/724)
2025-12-24 12:55:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.472510
2025-12-24 12:55:23 INFO Tuning ranking metrics: regret=0.112434 spearman=0.195482 (groups=39, skipped=329)
2025-12-24 12:55:23 INFO Epoch 005 | train_mse=0.126817 | val_loss=0.115900 | best_val_loss=0.226679
2025-12-24 12:55:34 INFO Epoch 006 | 25% complete (batch 181/724)
2025-12-24 12:55:37 INFO Epoch 006 | 50% complete (batch 362/724)
2025-12-24 12:55:40 INFO Epoch 006 | 75% complete (batch 543/724)
2025-12-24 12:55:53 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.480786
2025-12-24 12:55:58 INFO Tuning ranking metrics: regret=0.098351 spearman=0.272894 (groups=39, skipped=329)
2025-12-24 12:55:58 INFO Epoch 006 | train_mse=0.119623 | val_loss=0.134658 | best_val_loss=0.226679
Metric tuning_rank_spearman improved by 0.046 >= min_delta = 0.0. New best score: 0.273
2025-12-24 12:56:09 INFO Epoch 007 | 25% complete (batch 181/724)
2025-12-24 12:56:12 INFO Epoch 007 | 50% complete (batch 362/724)
2025-12-24 12:56:15 INFO Epoch 007 | 75% complete (batch 543/724)
2025-12-24 12:56:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.539108
2025-12-24 12:56:34 INFO Tuning ranking metrics: regret=0.104325 spearman=0.252259 (groups=39, skipped=329)
2025-12-24 12:56:34 INFO Epoch 007 | train_mse=0.117084 | val_loss=0.095184 | best_val_loss=0.272894
2025-12-24 12:56:45 INFO Epoch 008 | 25% complete (batch 181/724)
2025-12-24 12:56:48 INFO Epoch 008 | 50% complete (batch 362/724)
2025-12-24 12:56:52 INFO Epoch 008 | 75% complete (batch 543/724)
2025-12-24 12:57:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.564718
2025-12-24 12:57:10 INFO Tuning ranking metrics: regret=0.125473 spearman=0.245421 (groups=39, skipped=329)
2025-12-24 12:57:10 INFO Epoch 008 | train_mse=0.114307 | val_loss=0.075542 | best_val_loss=0.272894
2025-12-24 12:57:21 INFO Epoch 009 | 25% complete (batch 181/724)
2025-12-24 12:57:24 INFO Epoch 009 | 50% complete (batch 362/724)
2025-12-24 12:57:28 INFO Epoch 009 | 75% complete (batch 543/724)
2025-12-24 12:57:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.584708
2025-12-24 12:57:46 INFO Tuning ranking metrics: regret=0.120605 spearman=0.268864 (groups=39, skipped=329)
2025-12-24 12:57:46 INFO Epoch 009 | train_mse=0.092320 | val_loss=0.071050 | best_val_loss=0.272894
2025-12-24 12:57:57 INFO Epoch 010 | 25% complete (batch 181/724)
2025-12-24 12:58:01 INFO Epoch 010 | 50% complete (batch 362/724)
2025-12-24 12:58:04 INFO Epoch 010 | 75% complete (batch 543/724)
2025-12-24 12:58:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.602772
2025-12-24 12:58:23 INFO Tuning ranking metrics: regret=0.101594 spearman=0.238278 (groups=39, skipped=329)
2025-12-24 12:58:23 INFO Epoch 010 | train_mse=0.074658 | val_loss=0.076066 | best_val_loss=0.272894
2025-12-24 12:58:34 INFO Epoch 011 | 25% complete (batch 181/724)
2025-12-24 12:58:37 INFO Epoch 011 | 50% complete (batch 362/724)
2025-12-24 12:58:40 INFO Epoch 011 | 75% complete (batch 543/724)
2025-12-24 12:58:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.577637
2025-12-24 12:58:59 INFO Tuning ranking metrics: regret=0.100498 spearman=0.253358 (groups=39, skipped=329)
2025-12-24 12:58:59 INFO Epoch 011 | train_mse=0.072003 | val_loss=0.110944 | best_val_loss=0.272894
2025-12-24 12:59:10 INFO Epoch 012 | 25% complete (batch 181/724)
2025-12-24 12:59:13 INFO Epoch 012 | 50% complete (batch 362/724)
2025-12-24 12:59:16 INFO Epoch 012 | 75% complete (batch 543/724)
2025-12-24 12:59:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.622324
2025-12-24 12:59:35 INFO Tuning ranking metrics: regret=0.118987 spearman=0.273260 (groups=39, skipped=329)
2025-12-24 12:59:35 INFO Epoch 012 | train_mse=0.084477 | val_loss=0.070373 | best_val_loss=0.272894
Metric tuning_rank_spearman improved by 0.000 >= min_delta = 0.0. New best score: 0.273
2025-12-24 12:59:45 INFO Epoch 013 | 25% complete (batch 181/724)
2025-12-24 12:59:49 INFO Epoch 013 | 50% complete (batch 362/724)
2025-12-24 12:59:51 INFO Epoch 013 | 75% complete (batch 543/724)
2025-12-24 13:00:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.571300
2025-12-24 13:00:10 INFO Tuning ranking metrics: regret=0.109250 spearman=0.273993 (groups=39, skipped=329)
2025-12-24 13:00:10 INFO Epoch 013 | train_mse=0.076421 | val_loss=0.127100 | best_val_loss=0.273260
Metric tuning_rank_spearman improved by 0.001 >= min_delta = 0.0. New best score: 0.274
2025-12-24 13:00:21 INFO Epoch 014 | 25% complete (batch 181/724)
2025-12-24 13:00:24 INFO Epoch 014 | 50% complete (batch 362/724)
2025-12-24 13:00:28 INFO Epoch 014 | 75% complete (batch 543/724)
2025-12-24 13:00:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.631166
2025-12-24 13:00:46 INFO Tuning ranking metrics: regret=0.118987 spearman=0.281624 (groups=39, skipped=329)
2025-12-24 13:00:46 INFO Epoch 014 | train_mse=0.076110 | val_loss=0.075307 | best_val_loss=0.273993
Metric tuning_rank_spearman improved by 0.008 >= min_delta = 0.0. New best score: 0.282
2025-12-24 13:00:57 INFO Epoch 015 | 25% complete (batch 181/724)
2025-12-24 13:01:01 INFO Epoch 015 | 50% complete (batch 362/724)
2025-12-24 13:01:04 INFO Epoch 015 | 75% complete (batch 543/724)
2025-12-24 13:01:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.573196
2025-12-24 13:01:23 INFO Tuning ranking metrics: regret=0.109250 spearman=0.286630 (groups=39, skipped=329)
2025-12-24 13:01:23 INFO Epoch 015 | train_mse=0.087623 | val_loss=0.133840 | best_val_loss=0.281624
Metric tuning_rank_spearman improved by 0.005 >= min_delta = 0.0. New best score: 0.287
2025-12-24 13:01:34 INFO Epoch 016 | 25% complete (batch 181/724)
2025-12-24 13:01:37 INFO Epoch 016 | 50% complete (batch 362/724)
2025-12-24 13:01:41 INFO Epoch 016 | 75% complete (batch 543/724)
2025-12-24 13:01:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.598846
2025-12-24 13:02:00 INFO Tuning ranking metrics: regret=0.109943 spearman=0.227839 (groups=39, skipped=329)
2025-12-24 13:02:00 INFO Epoch 016 | train_mse=0.063740 | val_loss=0.109320 | best_val_loss=0.286630
2025-12-24 13:02:11 INFO Epoch 017 | 25% complete (batch 181/724)
2025-12-24 13:02:14 INFO Epoch 017 | 50% complete (batch 362/724)
2025-12-24 13:02:17 INFO Epoch 017 | 75% complete (batch 543/724)
2025-12-24 13:02:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.600272
2025-12-24 13:02:36 INFO Tuning ranking metrics: regret=0.107126 spearman=0.307204 (groups=39, skipped=329)
2025-12-24 13:02:36 INFO Epoch 017 | train_mse=0.093278 | val_loss=0.100818 | best_val_loss=0.286630
Metric tuning_rank_spearman improved by 0.021 >= min_delta = 0.0. New best score: 0.307
2025-12-24 13:02:47 INFO Epoch 018 | 25% complete (batch 181/724)
2025-12-24 13:02:51 INFO Epoch 018 | 50% complete (batch 362/724)
2025-12-24 13:02:54 INFO Epoch 018 | 75% complete (batch 543/724)
2025-12-24 13:03:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.643261
2025-12-24 13:03:13 INFO Tuning ranking metrics: regret=0.103889 spearman=0.286996 (groups=39, skipped=329)
2025-12-24 13:03:13 INFO Epoch 018 | train_mse=0.087313 | val_loss=0.065851 | best_val_loss=0.307204
2025-12-24 13:03:24 INFO Epoch 019 | 25% complete (batch 181/724)
2025-12-24 13:03:27 INFO Epoch 019 | 50% complete (batch 362/724)
2025-12-24 13:03:31 INFO Epoch 019 | 75% complete (batch 543/724)
2025-12-24 13:03:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.643119
2025-12-24 13:03:49 INFO Tuning ranking metrics: regret=0.107682 spearman=0.245665 (groups=39, skipped=329)
2025-12-24 13:03:49 INFO Epoch 019 | train_mse=0.078627 | val_loss=0.067244 | best_val_loss=0.307204
2025-12-24 13:04:00 INFO Epoch 020 | 25% complete (batch 181/724)
2025-12-24 13:04:03 INFO Epoch 020 | 50% complete (batch 362/724)
2025-12-24 13:04:06 INFO Epoch 020 | 75% complete (batch 543/724)
2025-12-24 13:04:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.647221
2025-12-24 13:04:25 INFO Tuning ranking metrics: regret=0.109008 spearman=0.244994 (groups=39, skipped=329)
2025-12-24 13:04:25 INFO Epoch 020 | train_mse=0.060748 | val_loss=0.068529 | best_val_loss=0.307204
2025-12-24 13:04:36 INFO Epoch 021 | 25% complete (batch 181/724)
2025-12-24 13:04:39 INFO Epoch 021 | 50% complete (batch 362/724)
2025-12-24 13:04:43 INFO Epoch 021 | 75% complete (batch 543/724)
2025-12-24 13:04:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.654507
2025-12-24 13:05:01 INFO Tuning ranking metrics: regret=0.090166 spearman=0.295665 (groups=39, skipped=329)
2025-12-24 13:05:01 INFO Epoch 021 | train_mse=0.066973 | val_loss=0.061107 | best_val_loss=0.307204
2025-12-24 13:05:12 INFO Epoch 022 | 25% complete (batch 181/724)
2025-12-24 13:05:16 INFO Epoch 022 | 50% complete (batch 362/724)
2025-12-24 13:05:19 INFO Epoch 022 | 75% complete (batch 543/724)
2025-12-24 13:05:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.657485
2025-12-24 13:05:38 INFO Tuning ranking metrics: regret=0.105585 spearman=0.260867 (groups=39, skipped=329)
2025-12-24 13:05:38 INFO Epoch 022 | train_mse=0.060712 | val_loss=0.063124 | best_val_loss=0.307204
2025-12-24 13:05:49 INFO Epoch 023 | 25% complete (batch 181/724)
2025-12-24 13:05:53 INFO Epoch 023 | 50% complete (batch 362/724)
2025-12-24 13:05:56 INFO Epoch 023 | 75% complete (batch 543/724)
2025-12-24 13:06:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.657329
2025-12-24 13:06:15 INFO Tuning ranking metrics: regret=0.103673 spearman=0.272650 (groups=39, skipped=329)
2025-12-24 13:06:15 INFO Epoch 023 | train_mse=0.051470 | val_loss=0.068025 | best_val_loss=0.307204
2025-12-24 13:06:26 INFO Epoch 024 | 25% complete (batch 181/724)
2025-12-24 13:06:29 INFO Epoch 024 | 50% complete (batch 362/724)
2025-12-24 13:06:33 INFO Epoch 024 | 75% complete (batch 543/724)
2025-12-24 13:06:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.657772
2025-12-24 13:06:51 INFO Tuning ranking metrics: regret=0.100280 spearman=0.283455 (groups=39, skipped=329)
2025-12-24 13:06:51 INFO Epoch 024 | train_mse=0.059725 | val_loss=0.074063 | best_val_loss=0.307204
2025-12-24 13:07:02 INFO Epoch 025 | 25% complete (batch 181/724)
2025-12-24 13:07:05 INFO Epoch 025 | 50% complete (batch 362/724)
2025-12-24 13:07:09 INFO Epoch 025 | 75% complete (batch 543/724)
2025-12-24 13:07:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.662502
2025-12-24 13:07:28 INFO Tuning ranking metrics: regret=0.101376 spearman=0.272466 (groups=39, skipped=329)
2025-12-24 13:07:28 INFO Epoch 025 | train_mse=0.059391 | val_loss=0.066196 | best_val_loss=0.307204
2025-12-24 13:07:39 INFO Epoch 026 | 25% complete (batch 181/724)
2025-12-24 13:07:42 INFO Epoch 026 | 50% complete (batch 362/724)
2025-12-24 13:07:45 INFO Epoch 026 | 75% complete (batch 543/724)
2025-12-24 13:07:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.661499
2025-12-24 13:08:04 INFO Tuning ranking metrics: regret=0.119061 spearman=0.248291 (groups=39, skipped=329)
2025-12-24 13:08:04 INFO Epoch 026 | train_mse=0.062755 | val_loss=0.065660 | best_val_loss=0.307204
2025-12-24 13:08:15 INFO Epoch 027 | 25% complete (batch 181/724)
2025-12-24 13:08:18 INFO Epoch 027 | 50% complete (batch 362/724)
2025-12-24 13:08:22 INFO Epoch 027 | 75% complete (batch 543/724)
2025-12-24 13:08:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.664812
2025-12-24 13:08:41 INFO Tuning ranking metrics: regret=0.119272 spearman=0.245238 (groups=39, skipped=329)
2025-12-24 13:08:41 INFO Epoch 027 | train_mse=0.064997 | val_loss=0.069534 | best_val_loss=0.307204
2025-12-24 13:08:52 INFO Epoch 028 | 25% complete (batch 181/724)
2025-12-24 13:08:55 INFO Epoch 028 | 50% complete (batch 362/724)
2025-12-24 13:08:59 INFO Epoch 028 | 75% complete (batch 543/724)
2025-12-24 13:09:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.677576
2025-12-24 13:09:18 INFO Tuning ranking metrics: regret=0.120368 spearman=0.251709 (groups=39, skipped=329)
2025-12-24 13:09:18 INFO Epoch 028 | train_mse=0.056570 | val_loss=0.059267 | best_val_loss=0.307204
2025-12-24 13:09:29 INFO Epoch 029 | 25% complete (batch 181/724)
2025-12-24 13:09:32 INFO Epoch 029 | 50% complete (batch 362/724)
2025-12-24 13:09:36 INFO Epoch 029 | 75% complete (batch 543/724)
2025-12-24 13:09:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.667907
2025-12-24 13:09:54 INFO Tuning ranking metrics: regret=0.119272 spearman=0.267705 (groups=39, skipped=329)
2025-12-24 13:09:54 INFO Epoch 029 | train_mse=0.050745 | val_loss=0.070324 | best_val_loss=0.307204
2025-12-24 13:10:05 INFO Epoch 030 | 25% complete (batch 181/724)
2025-12-24 13:10:09 INFO Epoch 030 | 50% complete (batch 362/724)
2025-12-24 13:10:12 INFO Epoch 030 | 75% complete (batch 543/724)
2025-12-24 13:10:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.686230
2025-12-24 13:10:31 INFO Tuning ranking metrics: regret=0.105862 spearman=0.259341 (groups=39, skipped=329)
2025-12-24 13:10:31 INFO Epoch 030 | train_mse=0.053762 | val_loss=0.057110 | best_val_loss=0.307204
2025-12-24 13:10:42 INFO Epoch 031 | 25% complete (batch 181/724)
2025-12-24 13:10:45 INFO Epoch 031 | 50% complete (batch 362/724)
2025-12-24 13:10:48 INFO Epoch 031 | 75% complete (batch 543/724)
2025-12-24 13:11:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.682947
2025-12-24 13:11:08 INFO Tuning ranking metrics: regret=0.119272 spearman=0.267460 (groups=39, skipped=329)
2025-12-24 13:11:08 INFO Epoch 031 | train_mse=0.052299 | val_loss=0.057696 | best_val_loss=0.307204
2025-12-24 13:11:19 INFO Epoch 032 | 25% complete (batch 181/724)
2025-12-24 13:11:22 INFO Epoch 032 | 50% complete (batch 362/724)
2025-12-24 13:11:26 INFO Epoch 032 | 75% complete (batch 543/724)
2025-12-24 13:11:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.689995
2025-12-24 13:11:45 INFO Tuning ranking metrics: regret=0.100491 spearman=0.285653 (groups=39, skipped=329)
2025-12-24 13:11:45 INFO Epoch 032 | train_mse=0.052799 | val_loss=0.055318 | best_val_loss=0.307204
2025-12-24 13:11:56 INFO Epoch 033 | 25% complete (batch 181/724)
2025-12-24 13:11:59 INFO Epoch 033 | 50% complete (batch 362/724)
2025-12-24 13:12:03 INFO Epoch 033 | 75% complete (batch 543/724)
2025-12-24 13:12:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.660957
2025-12-24 13:12:22 INFO Tuning ranking metrics: regret=0.098790 spearman=0.301282 (groups=39, skipped=329)
2025-12-24 13:12:22 INFO Epoch 033 | train_mse=0.055878 | val_loss=0.084701 | best_val_loss=0.307204
2025-12-24 13:12:33 INFO Epoch 034 | 25% complete (batch 181/724)
2025-12-24 13:12:36 INFO Epoch 034 | 50% complete (batch 362/724)
2025-12-24 13:12:39 INFO Epoch 034 | 75% complete (batch 543/724)
2025-12-24 13:12:53 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.681010
2025-12-24 13:12:58 INFO Tuning ranking metrics: regret=0.100280 spearman=0.290598 (groups=39, skipped=329)
2025-12-24 13:12:58 INFO Epoch 034 | train_mse=0.050315 | val_loss=0.068163 | best_val_loss=0.307204
2025-12-24 13:13:09 INFO Epoch 035 | 25% complete (batch 181/724)
2025-12-24 13:13:13 INFO Epoch 035 | 50% complete (batch 362/724)
2025-12-24 13:13:16 INFO Epoch 035 | 75% complete (batch 543/724)
2025-12-24 13:13:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.688928
2025-12-24 13:13:35 INFO Tuning ranking metrics: regret=0.100280 spearman=0.292735 (groups=39, skipped=329)
2025-12-24 13:13:35 INFO Epoch 035 | train_mse=0.069892 | val_loss=0.054744 | best_val_loss=0.307204
2025-12-24 13:13:46 INFO Epoch 036 | 25% complete (batch 181/724)
2025-12-24 13:13:50 INFO Epoch 036 | 50% complete (batch 362/724)
2025-12-24 13:13:53 INFO Epoch 036 | 75% complete (batch 543/724)
2025-12-24 13:14:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.625553
2025-12-24 13:14:12 INFO Tuning ranking metrics: regret=0.099546 spearman=0.307326 (groups=39, skipped=329)
2025-12-24 13:14:12 INFO Epoch 036 | train_mse=0.049158 | val_loss=0.117832 | best_val_loss=0.307204
Metric tuning_rank_spearman improved by 0.000 >= min_delta = 0.0. New best score: 0.307
2025-12-24 13:14:23 INFO Epoch 037 | 25% complete (batch 181/724)
2025-12-24 13:14:26 INFO Epoch 037 | 50% complete (batch 362/724)
2025-12-24 13:14:29 INFO Epoch 037 | 75% complete (batch 543/724)
2025-12-24 13:14:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.690278
2025-12-24 13:14:48 INFO Tuning ranking metrics: regret=0.094937 spearman=0.345543 (groups=39, skipped=329)
2025-12-24 13:14:48 INFO Epoch 037 | train_mse=0.065762 | val_loss=0.060764 | best_val_loss=0.307326
Metric tuning_rank_spearman improved by 0.038 >= min_delta = 0.0. New best score: 0.346
2025-12-24 13:14:59 INFO Epoch 038 | 25% complete (batch 181/724)
2025-12-24 13:15:02 INFO Epoch 038 | 50% complete (batch 362/724)
2025-12-24 13:15:06 INFO Epoch 038 | 75% complete (batch 543/724)
2025-12-24 13:15:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.661191
2025-12-24 13:15:25 INFO Tuning ranking metrics: regret=0.096427 spearman=0.329609 (groups=39, skipped=329)
2025-12-24 13:15:25 INFO Epoch 038 | train_mse=0.086358 | val_loss=0.083570 | best_val_loss=0.345543
2025-12-24 13:15:36 INFO Epoch 039 | 25% complete (batch 181/724)
2025-12-24 13:15:39 INFO Epoch 039 | 50% complete (batch 362/724)
2025-12-24 13:15:42 INFO Epoch 039 | 75% complete (batch 543/724)
2025-12-24 13:15:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.662685
2025-12-24 13:16:01 INFO Tuning ranking metrics: regret=0.099886 spearman=0.298107 (groups=39, skipped=329)
2025-12-24 13:16:01 INFO Epoch 039 | train_mse=0.066498 | val_loss=0.069305 | best_val_loss=0.345543
2025-12-24 13:16:12 INFO Epoch 040 | 25% complete (batch 181/724)
2025-12-24 13:16:15 INFO Epoch 040 | 50% complete (batch 362/724)
2025-12-24 13:16:18 INFO Epoch 040 | 75% complete (batch 543/724)
2025-12-24 13:16:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.683825
2025-12-24 13:16:38 INFO Tuning ranking metrics: regret=0.107164 spearman=0.266606 (groups=39, skipped=329)
2025-12-24 13:16:38 INFO Epoch 040 | train_mse=0.053208 | val_loss=0.058532 | best_val_loss=0.345543
2025-12-24 13:16:48 INFO Epoch 041 | 25% complete (batch 181/724)
2025-12-24 13:16:52 INFO Epoch 041 | 50% complete (batch 362/724)
2025-12-24 13:16:55 INFO Epoch 041 | 75% complete (batch 543/724)
2025-12-24 13:17:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.688550
2025-12-24 13:17:14 INFO Tuning ranking metrics: regret=0.107164 spearman=0.247985 (groups=39, skipped=329)
2025-12-24 13:17:14 INFO Epoch 041 | train_mse=0.049589 | val_loss=0.056269 | best_val_loss=0.345543
2025-12-24 13:17:25 INFO Epoch 042 | 25% complete (batch 181/724)
2025-12-24 13:17:28 INFO Epoch 042 | 50% complete (batch 362/724)
2025-12-24 13:17:32 INFO Epoch 042 | 75% complete (batch 543/724)
2025-12-24 13:17:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.691111
2025-12-24 13:17:51 INFO Tuning ranking metrics: regret=0.107164 spearman=0.241941 (groups=39, skipped=329)
2025-12-24 13:17:51 INFO Epoch 042 | train_mse=0.051127 | val_loss=0.055033 | best_val_loss=0.345543
2025-12-24 13:18:02 INFO Epoch 043 | 25% complete (batch 181/724)
2025-12-24 13:18:05 INFO Epoch 043 | 50% complete (batch 362/724)
2025-12-24 13:18:09 INFO Epoch 043 | 75% complete (batch 543/724)
2025-12-24 13:18:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.696304
2025-12-24 13:18:28 INFO Tuning ranking metrics: regret=0.107164 spearman=0.263675 (groups=39, skipped=329)
2025-12-24 13:18:28 INFO Epoch 043 | train_mse=0.047041 | val_loss=0.055183 | best_val_loss=0.345543
2025-12-24 13:18:39 INFO Epoch 044 | 25% complete (batch 181/724)
2025-12-24 13:18:43 INFO Epoch 044 | 50% complete (batch 362/724)
2025-12-24 13:18:46 INFO Epoch 044 | 75% complete (batch 543/724)
2025-12-24 13:19:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.694803
2025-12-24 13:19:06 INFO Tuning ranking metrics: regret=0.101376 spearman=0.286508 (groups=39, skipped=329)
2025-12-24 13:19:06 INFO Epoch 044 | train_mse=0.049039 | val_loss=0.054628 | best_val_loss=0.345543
2025-12-24 13:19:16 INFO Epoch 045 | 25% complete (batch 181/724)
2025-12-24 13:19:20 INFO Epoch 045 | 50% complete (batch 362/724)
2025-12-24 13:19:23 INFO Epoch 045 | 75% complete (batch 543/724)
2025-12-24 13:19:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.696648
2025-12-24 13:19:43 INFO Tuning ranking metrics: regret=0.100280 spearman=0.290354 (groups=39, skipped=329)
2025-12-24 13:19:43 INFO Epoch 045 | train_mse=0.056715 | val_loss=0.057246 | best_val_loss=0.345543
2025-12-24 13:19:54 INFO Epoch 046 | 25% complete (batch 181/724)
2025-12-24 13:19:57 INFO Epoch 046 | 50% complete (batch 362/724)
2025-12-24 13:20:01 INFO Epoch 046 | 75% complete (batch 543/724)
2025-12-24 13:20:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.694669
2025-12-24 13:20:20 INFO Tuning ranking metrics: regret=0.100280 spearman=0.283272 (groups=39, skipped=329)
2025-12-24 13:20:20 INFO Epoch 046 | train_mse=0.050602 | val_loss=0.059799 | best_val_loss=0.345543
2025-12-24 13:20:31 INFO Epoch 047 | 25% complete (batch 181/724)
2025-12-24 13:20:34 INFO Epoch 047 | 50% complete (batch 362/724)
2025-12-24 13:20:38 INFO Epoch 047 | 75% complete (batch 543/724)
2025-12-24 13:20:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.700211
2025-12-24 13:20:57 INFO Tuning ranking metrics: regret=0.100291 spearman=0.271429 (groups=39, skipped=329)
2025-12-24 13:20:57 INFO Epoch 047 | train_mse=0.053272 | val_loss=0.054869 | best_val_loss=0.345543
2025-12-24 13:21:07 INFO Epoch 048 | 25% complete (batch 181/724)
2025-12-24 13:21:11 INFO Epoch 048 | 50% complete (batch 362/724)
2025-12-24 13:21:15 INFO Epoch 048 | 75% complete (batch 543/724)
2025-12-24 13:21:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.634870
2025-12-24 13:21:34 INFO Tuning ranking metrics: regret=0.127827 spearman=0.199389 (groups=39, skipped=329)
2025-12-24 13:21:34 INFO Epoch 048 | train_mse=0.047963 | val_loss=0.115889 | best_val_loss=0.345543
2025-12-24 13:21:45 INFO Epoch 049 | 25% complete (batch 181/724)
2025-12-24 13:21:48 INFO Epoch 049 | 50% complete (batch 362/724)
2025-12-24 13:21:51 INFO Epoch 049 | 75% complete (batch 543/724)
2025-12-24 13:22:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.690202
2025-12-24 13:22:10 INFO Tuning ranking metrics: regret=0.100280 spearman=0.293162 (groups=39, skipped=329)
2025-12-24 13:22:10 INFO Epoch 049 | train_mse=0.059361 | val_loss=0.062749 | best_val_loss=0.345543
2025-12-24 13:22:21 INFO Epoch 050 | 25% complete (batch 181/724)
2025-12-24 13:22:25 INFO Epoch 050 | 50% complete (batch 362/724)
2025-12-24 13:22:28 INFO Epoch 050 | 75% complete (batch 543/724)
2025-12-24 13:22:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.696435
2025-12-24 13:22:47 INFO Tuning ranking metrics: regret=0.100280 spearman=0.272344 (groups=39, skipped=329)
2025-12-24 13:22:47 INFO Epoch 050 | train_mse=0.070705 | val_loss=0.055738 | best_val_loss=0.345543
2025-12-24 13:22:58 INFO Epoch 051 | 25% complete (batch 181/724)
2025-12-24 13:23:01 INFO Epoch 051 | 50% complete (batch 362/724)
2025-12-24 13:23:05 INFO Epoch 051 | 75% complete (batch 543/724)
2025-12-24 13:23:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.693336
2025-12-24 13:23:24 INFO Tuning ranking metrics: regret=0.101376 spearman=0.269902 (groups=39, skipped=329)
2025-12-24 13:23:24 INFO Epoch 051 | train_mse=0.050075 | val_loss=0.061650 | best_val_loss=0.345543
2025-12-24 13:23:35 INFO Epoch 052 | 25% complete (batch 181/724)
2025-12-24 13:23:38 INFO Epoch 052 | 50% complete (batch 362/724)
2025-12-24 13:23:42 INFO Epoch 052 | 75% complete (batch 543/724)
2025-12-24 13:23:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.697302
2025-12-24 13:24:01 INFO Tuning ranking metrics: regret=0.100473 spearman=0.271917 (groups=39, skipped=329)
2025-12-24 13:24:01 INFO Epoch 052 | train_mse=0.047356 | val_loss=0.053075 | best_val_loss=0.345543
2025-12-24 13:24:12 INFO Epoch 053 | 25% complete (batch 181/724)
2025-12-24 13:24:15 INFO Epoch 053 | 50% complete (batch 362/724)
2025-12-24 13:24:18 INFO Epoch 053 | 75% complete (batch 543/724)
2025-12-24 13:24:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.703990
2025-12-24 13:24:37 INFO Tuning ranking metrics: regret=0.100262 spearman=0.271917 (groups=39, skipped=329)
2025-12-24 13:24:37 INFO Epoch 053 | train_mse=0.052448 | val_loss=0.056615 | best_val_loss=0.345543
2025-12-24 13:24:48 INFO Epoch 054 | 25% complete (batch 181/724)
2025-12-24 13:24:51 INFO Epoch 054 | 50% complete (batch 362/724)
2025-12-24 13:24:55 INFO Epoch 054 | 75% complete (batch 543/724)
2025-12-24 13:25:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.705614
2025-12-24 13:25:14 INFO Tuning ranking metrics: regret=0.100500 spearman=0.256105 (groups=39, skipped=329)
2025-12-24 13:25:14 INFO Epoch 054 | train_mse=0.046022 | val_loss=0.052882 | best_val_loss=0.345543
2025-12-24 13:25:24 INFO Epoch 055 | 25% complete (batch 181/724)
2025-12-24 13:25:28 INFO Epoch 055 | 50% complete (batch 362/724)
2025-12-24 13:25:32 INFO Epoch 055 | 75% complete (batch 543/724)
2025-12-24 13:25:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.705920
2025-12-24 13:25:51 INFO Tuning ranking metrics: regret=0.103880 spearman=0.253053 (groups=39, skipped=329)
2025-12-24 13:25:51 INFO Epoch 055 | train_mse=0.050095 | val_loss=0.051791 | best_val_loss=0.345543
2025-12-24 13:26:02 INFO Epoch 056 | 25% complete (batch 181/724)
2025-12-24 13:26:05 INFO Epoch 056 | 50% complete (batch 362/724)
2025-12-24 13:26:08 INFO Epoch 056 | 75% complete (batch 543/724)
2025-12-24 13:26:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.707633
2025-12-24 13:26:27 INFO Tuning ranking metrics: regret=0.103862 spearman=0.218315 (groups=39, skipped=329)
2025-12-24 13:26:27 INFO Epoch 056 | train_mse=0.052294 | val_loss=0.051801 | best_val_loss=0.345543
2025-12-24 13:26:38 INFO Epoch 057 | 25% complete (batch 181/724)
2025-12-24 13:26:42 INFO Epoch 057 | 50% complete (batch 362/724)
2025-12-24 13:26:45 INFO Epoch 057 | 75% complete (batch 543/724)
2025-12-24 13:26:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.710233
2025-12-24 13:27:04 INFO Tuning ranking metrics: regret=0.104776 spearman=0.247497 (groups=39, skipped=329)
2025-12-24 13:27:04 INFO Epoch 057 | train_mse=0.046197 | val_loss=0.050269 | best_val_loss=0.345543
2025-12-24 13:27:15 INFO Epoch 058 | 25% complete (batch 181/724)
2025-12-24 13:27:19 INFO Epoch 058 | 50% complete (batch 362/724)
2025-12-24 13:27:22 INFO Epoch 058 | 75% complete (batch 543/724)
2025-12-24 13:27:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.673077
2025-12-24 13:27:42 INFO Tuning ranking metrics: regret=0.108179 spearman=0.234676 (groups=39, skipped=329)
2025-12-24 13:27:42 INFO Epoch 058 | train_mse=0.049357 | val_loss=0.090350 | best_val_loss=0.345543
2025-12-24 13:27:53 INFO Epoch 059 | 25% complete (batch 181/724)
2025-12-24 13:27:56 INFO Epoch 059 | 50% complete (batch 362/724)
2025-12-24 13:27:59 INFO Epoch 059 | 75% complete (batch 543/724)
2025-12-24 13:28:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.687982
2025-12-24 13:28:18 INFO Tuning ranking metrics: regret=0.107173 spearman=0.237118 (groups=39, skipped=329)
2025-12-24 13:28:18 INFO Epoch 059 | train_mse=0.053235 | val_loss=0.079567 | best_val_loss=0.345543
2025-12-24 13:28:29 INFO Epoch 060 | 25% complete (batch 181/724)
2025-12-24 13:28:32 INFO Epoch 060 | 50% complete (batch 362/724)
2025-12-24 13:28:35 INFO Epoch 060 | 75% complete (batch 543/724)
2025-12-24 13:28:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.686431
2025-12-24 13:28:53 INFO Tuning ranking metrics: regret=0.103651 spearman=0.263858 (groups=39, skipped=329)
2025-12-24 13:28:53 INFO Epoch 060 | train_mse=0.052581 | val_loss=0.062367 | best_val_loss=0.345543
2025-12-24 13:29:04 INFO Epoch 061 | 25% complete (batch 181/724)
2025-12-24 13:29:07 INFO Epoch 061 | 50% complete (batch 362/724)
2025-12-24 13:29:11 INFO Epoch 061 | 75% complete (batch 543/724)
2025-12-24 13:29:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.717165
2025-12-24 13:29:30 INFO Tuning ranking metrics: regret=0.103651 spearman=0.240537 (groups=39, skipped=329)
2025-12-24 13:29:30 INFO Epoch 061 | train_mse=0.053575 | val_loss=0.050150 | best_val_loss=0.345543
2025-12-24 13:29:41 INFO Epoch 062 | 25% complete (batch 181/724)
2025-12-24 13:29:45 INFO Epoch 062 | 50% complete (batch 362/724)
2025-12-24 13:29:48 INFO Epoch 062 | 75% complete (batch 543/724)
2025-12-24 13:30:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.707613
2025-12-24 13:30:07 INFO Tuning ranking metrics: regret=0.101385 spearman=0.272527 (groups=39, skipped=329)
2025-12-24 13:30:07 INFO Epoch 062 | train_mse=0.045626 | val_loss=0.053263 | best_val_loss=0.345543
2025-12-24 13:30:18 INFO Epoch 063 | 25% complete (batch 181/724)
2025-12-24 13:30:21 INFO Epoch 063 | 50% complete (batch 362/724)
2025-12-24 13:30:24 INFO Epoch 063 | 75% complete (batch 543/724)
2025-12-24 13:30:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.708942
2025-12-24 13:30:44 INFO Tuning ranking metrics: regret=0.103651 spearman=0.239194 (groups=39, skipped=329)
2025-12-24 13:30:44 INFO Epoch 063 | train_mse=0.047888 | val_loss=0.052961 | best_val_loss=0.345543
2025-12-24 13:30:55 INFO Epoch 064 | 25% complete (batch 181/724)
2025-12-24 13:30:58 INFO Epoch 064 | 50% complete (batch 362/724)
2025-12-24 13:31:01 INFO Epoch 064 | 75% complete (batch 543/724)
2025-12-24 13:31:15 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.694016
2025-12-24 13:31:20 INFO Tuning ranking metrics: regret=0.104712 spearman=0.226435 (groups=39, skipped=329)
2025-12-24 13:31:20 INFO Epoch 064 | train_mse=0.045527 | val_loss=0.068728 | best_val_loss=0.345543
2025-12-24 13:31:31 INFO Epoch 065 | 25% complete (batch 181/724)
2025-12-24 13:31:34 INFO Epoch 065 | 50% complete (batch 362/724)
2025-12-24 13:31:38 INFO Epoch 065 | 75% complete (batch 543/724)
2025-12-24 13:31:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.714044
2025-12-24 13:31:57 INFO Tuning ranking metrics: regret=0.102797 spearman=0.230891 (groups=39, skipped=329)
2025-12-24 13:31:57 INFO Epoch 065 | train_mse=0.051876 | val_loss=0.057003 | best_val_loss=0.345543
2025-12-24 13:32:08 INFO Epoch 066 | 25% complete (batch 181/724)
2025-12-24 13:32:12 INFO Epoch 066 | 50% complete (batch 362/724)
2025-12-24 13:32:15 INFO Epoch 066 | 75% complete (batch 543/724)
2025-12-24 13:32:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.723488
2025-12-24 13:32:34 INFO Tuning ranking metrics: regret=0.102893 spearman=0.219292 (groups=39, skipped=329)
2025-12-24 13:32:34 INFO Epoch 066 | train_mse=0.054808 | val_loss=0.049335 | best_val_loss=0.345543
2025-12-24 13:32:45 INFO Epoch 067 | 25% complete (batch 181/724)
2025-12-24 13:32:48 INFO Epoch 067 | 50% complete (batch 362/724)
2025-12-24 13:32:52 INFO Epoch 067 | 75% complete (batch 543/724)
2025-12-24 13:33:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.720094
2025-12-24 13:33:11 INFO Tuning ranking metrics: regret=0.102808 spearman=0.233028 (groups=39, skipped=329)
2025-12-24 13:33:11 INFO Epoch 067 | train_mse=0.048153 | val_loss=0.053836 | best_val_loss=0.345543
2025-12-24 13:33:22 INFO Epoch 068 | 25% complete (batch 181/724)
2025-12-24 13:33:26 INFO Epoch 068 | 50% complete (batch 362/724)
2025-12-24 13:33:29 INFO Epoch 068 | 75% complete (batch 543/724)
2025-12-24 13:33:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.713881
2025-12-24 13:33:48 INFO Tuning ranking metrics: regret=0.102586 spearman=0.230159 (groups=39, skipped=329)
2025-12-24 13:33:48 INFO Epoch 068 | train_mse=0.050784 | val_loss=0.060640 | best_val_loss=0.345543
2025-12-24 13:33:59 INFO Epoch 069 | 25% complete (batch 181/724)
2025-12-24 13:34:03 INFO Epoch 069 | 50% complete (batch 362/724)
2025-12-24 13:34:07 INFO Epoch 069 | 75% complete (batch 543/724)
2025-12-24 13:34:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.714193
2025-12-24 13:34:26 INFO Tuning ranking metrics: regret=0.102808 spearman=0.228144 (groups=39, skipped=329)
2025-12-24 13:34:26 INFO Epoch 069 | train_mse=0.045588 | val_loss=0.051151 | best_val_loss=0.345543
2025-12-24 13:34:37 INFO Epoch 070 | 25% complete (batch 181/724)
2025-12-24 13:34:40 INFO Epoch 070 | 50% complete (batch 362/724)
2025-12-24 13:34:43 INFO Epoch 070 | 75% complete (batch 543/724)
2025-12-24 13:34:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.721113
2025-12-24 13:35:02 INFO Tuning ranking metrics: regret=0.107184 spearman=0.208974 (groups=39, skipped=329)
2025-12-24 13:35:02 INFO Epoch 070 | train_mse=0.044026 | val_loss=0.048193 | best_val_loss=0.345543
2025-12-24 13:35:13 INFO Epoch 071 | 25% complete (batch 181/724)
2025-12-24 13:35:17 INFO Epoch 071 | 50% complete (batch 362/724)
2025-12-24 13:35:21 INFO Epoch 071 | 75% complete (batch 543/724)
2025-12-24 13:35:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.707713
2025-12-24 13:35:40 INFO Tuning ranking metrics: regret=0.102808 spearman=0.243468 (groups=39, skipped=329)
2025-12-24 13:35:40 INFO Epoch 071 | train_mse=0.046361 | val_loss=0.062831 | best_val_loss=0.345543
2025-12-24 13:35:51 INFO Epoch 072 | 25% complete (batch 181/724)
2025-12-24 13:35:55 INFO Epoch 072 | 50% complete (batch 362/724)
2025-12-24 13:35:58 INFO Epoch 072 | 75% complete (batch 543/724)
2025-12-24 13:36:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.719909
2025-12-24 13:36:17 INFO Tuning ranking metrics: regret=0.100914 spearman=0.221551 (groups=39, skipped=329)
2025-12-24 13:36:17 INFO Epoch 072 | train_mse=0.042890 | val_loss=0.054495 | best_val_loss=0.345543
2025-12-24 13:36:28 INFO Epoch 073 | 25% complete (batch 181/724)
2025-12-24 13:36:31 INFO Epoch 073 | 50% complete (batch 362/724)
2025-12-24 13:36:35 INFO Epoch 073 | 75% complete (batch 543/724)
2025-12-24 13:36:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.728820
2025-12-24 13:36:54 INFO Tuning ranking metrics: regret=0.105091 spearman=0.157631 (groups=39, skipped=329)
2025-12-24 13:36:54 INFO Epoch 073 | train_mse=0.045844 | val_loss=0.049142 | best_val_loss=0.345543
2025-12-24 13:37:05 INFO Epoch 074 | 25% complete (batch 181/724)
2025-12-24 13:37:08 INFO Epoch 074 | 50% complete (batch 362/724)
2025-12-24 13:37:12 INFO Epoch 074 | 75% complete (batch 543/724)
2025-12-24 13:37:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.714170
2025-12-24 13:37:31 INFO Tuning ranking metrics: regret=0.107184 spearman=0.214530 (groups=39, skipped=329)
2025-12-24 13:37:31 INFO Epoch 074 | train_mse=0.050639 | val_loss=0.062818 | best_val_loss=0.345543
2025-12-24 13:37:42 INFO Epoch 075 | 25% complete (batch 181/724)
2025-12-24 13:37:45 INFO Epoch 075 | 50% complete (batch 362/724)
2025-12-24 13:37:49 INFO Epoch 075 | 75% complete (batch 543/724)
2025-12-24 13:38:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.713518
2025-12-24 13:38:08 INFO Tuning ranking metrics: regret=0.105708 spearman=0.175031 (groups=39, skipped=329)
2025-12-24 13:38:08 INFO Epoch 075 | train_mse=0.043399 | val_loss=0.055833 | best_val_loss=0.345543
2025-12-24 13:38:18 INFO Epoch 076 | 25% complete (batch 181/724)
2025-12-24 13:38:22 INFO Epoch 076 | 50% complete (batch 362/724)
2025-12-24 13:38:25 INFO Epoch 076 | 75% complete (batch 543/724)
2025-12-24 13:38:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.724643
2025-12-24 13:38:44 INFO Tuning ranking metrics: regret=0.102839 spearman=0.219780 (groups=39, skipped=329)
2025-12-24 13:38:44 INFO Epoch 076 | train_mse=0.055444 | val_loss=0.051580 | best_val_loss=0.345543
2025-12-24 13:38:55 INFO Epoch 077 | 25% complete (batch 181/724)
2025-12-24 13:38:59 INFO Epoch 077 | 50% complete (batch 362/724)
2025-12-24 13:39:02 INFO Epoch 077 | 75% complete (batch 543/724)
2025-12-24 13:39:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.719537
2025-12-24 13:39:21 INFO Tuning ranking metrics: regret=0.112623 spearman=0.160073 (groups=39, skipped=329)
2025-12-24 13:39:21 INFO Epoch 077 | train_mse=0.039309 | val_loss=0.052666 | best_val_loss=0.345543
2025-12-24 13:39:32 INFO Epoch 078 | 25% complete (batch 181/724)
2025-12-24 13:39:36 INFO Epoch 078 | 50% complete (batch 362/724)
2025-12-24 13:39:39 INFO Epoch 078 | 75% complete (batch 543/724)
2025-12-24 13:39:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.712718
2025-12-24 13:39:58 INFO Tuning ranking metrics: regret=0.102839 spearman=0.237912 (groups=39, skipped=329)
2025-12-24 13:39:58 INFO Epoch 078 | train_mse=0.041319 | val_loss=0.056851 | best_val_loss=0.345543
2025-12-24 13:40:09 INFO Epoch 079 | 25% complete (batch 181/724)
2025-12-24 13:40:12 INFO Epoch 079 | 50% complete (batch 362/724)
2025-12-24 13:40:15 INFO Epoch 079 | 75% complete (batch 543/724)
2025-12-24 13:40:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.731652
2025-12-24 13:40:34 INFO Tuning ranking metrics: regret=0.104816 spearman=0.224969 (groups=39, skipped=329)
2025-12-24 13:40:34 INFO Epoch 079 | train_mse=0.046919 | val_loss=0.046697 | best_val_loss=0.345543
2025-12-24 13:40:45 INFO Epoch 080 | 25% complete (batch 181/724)
2025-12-24 13:40:48 INFO Epoch 080 | 50% complete (batch 362/724)
2025-12-24 13:40:52 INFO Epoch 080 | 75% complete (batch 543/724)
2025-12-24 13:41:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.722914
2025-12-24 13:41:11 INFO Tuning ranking metrics: regret=0.108627 spearman=0.199451 (groups=39, skipped=329)
2025-12-24 13:41:11 INFO Epoch 080 | train_mse=0.044985 | val_loss=0.059344 | best_val_loss=0.345543
2025-12-24 13:41:22 INFO Epoch 081 | 25% complete (batch 181/724)
2025-12-24 13:41:25 INFO Epoch 081 | 50% complete (batch 362/724)
2025-12-24 13:41:29 INFO Epoch 081 | 75% complete (batch 543/724)
2025-12-24 13:41:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.726838
2025-12-24 13:41:48 INFO Tuning ranking metrics: regret=0.108192 spearman=0.171917 (groups=39, skipped=329)
2025-12-24 13:41:48 INFO Epoch 081 | train_mse=0.052305 | val_loss=0.056400 | best_val_loss=0.345543
2025-12-24 13:41:59 INFO Epoch 082 | 25% complete (batch 181/724)
2025-12-24 13:42:03 INFO Epoch 082 | 50% complete (batch 362/724)
2025-12-24 13:42:06 INFO Epoch 082 | 75% complete (batch 543/724)
2025-12-24 13:42:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.679734
2025-12-24 13:42:25 INFO Tuning ranking metrics: regret=0.108048 spearman=0.160195 (groups=39, skipped=329)
2025-12-24 13:42:25 INFO Epoch 082 | train_mse=0.045864 | val_loss=0.102885 | best_val_loss=0.345543
2025-12-24 13:42:36 INFO Epoch 083 | 25% complete (batch 181/724)
2025-12-24 13:42:39 INFO Epoch 083 | 50% complete (batch 362/724)
2025-12-24 13:42:43 INFO Epoch 083 | 75% complete (batch 543/724)
2025-12-24 13:42:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.696442
2025-12-24 13:43:02 INFO Tuning ranking metrics: regret=0.113797 spearman=0.146703 (groups=39, skipped=329)
2025-12-24 13:43:02 INFO Epoch 083 | train_mse=0.046601 | val_loss=0.055227 | best_val_loss=0.345543
2025-12-24 13:43:12 INFO Epoch 084 | 25% complete (batch 181/724)
2025-12-24 13:43:16 INFO Epoch 084 | 50% complete (batch 362/724)
2025-12-24 13:43:19 INFO Epoch 084 | 75% complete (batch 543/724)
2025-12-24 13:43:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.705045
2025-12-24 13:43:38 INFO Tuning ranking metrics: regret=0.106240 spearman=0.244628 (groups=39, skipped=329)
2025-12-24 13:43:38 INFO Epoch 084 | train_mse=0.058253 | val_loss=0.075514 | best_val_loss=0.345543
2025-12-24 13:43:49 INFO Epoch 085 | 25% complete (batch 181/724)
2025-12-24 13:43:53 INFO Epoch 085 | 50% complete (batch 362/724)
2025-12-24 13:43:56 INFO Epoch 085 | 75% complete (batch 543/724)
2025-12-24 13:44:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.720447
2025-12-24 13:44:15 INFO Tuning ranking metrics: regret=0.107981 spearman=0.153602 (groups=39, skipped=329)
2025-12-24 13:44:15 INFO Epoch 085 | train_mse=0.044476 | val_loss=0.054359 | best_val_loss=0.345543
2025-12-24 13:44:26 INFO Epoch 086 | 25% complete (batch 181/724)
2025-12-24 13:44:29 INFO Epoch 086 | 50% complete (batch 362/724)
2025-12-24 13:44:33 INFO Epoch 086 | 75% complete (batch 543/724)
2025-12-24 13:44:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.734625
2025-12-24 13:44:51 INFO Tuning ranking metrics: regret=0.108439 spearman=0.207814 (groups=39, skipped=329)
2025-12-24 13:44:51 INFO Epoch 086 | train_mse=0.049235 | val_loss=0.048323 | best_val_loss=0.345543
2025-12-24 13:45:02 INFO Epoch 087 | 25% complete (batch 181/724)
2025-12-24 13:45:06 INFO Epoch 087 | 50% complete (batch 362/724)
2025-12-24 13:45:09 INFO Epoch 087 | 75% complete (batch 543/724)
2025-12-24 13:45:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.725486
2025-12-24 13:45:29 INFO Tuning ranking metrics: regret=0.107927 spearman=0.185653 (groups=39, skipped=329)
2025-12-24 13:45:29 INFO Epoch 087 | train_mse=0.049300 | val_loss=0.057223 | best_val_loss=0.345543
Monitored metric tuning_rank_spearman did not improve in the last 50 records. Best score: 0.346. Signaling Trainer to stop.
2025-12-24 13:45:30 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.30733_val-0.11783_epoch036.chkpt, checkpoint.tuning_rank_spearman-0.32961_val-0.08357_epoch038.chkpt, checkpoint.tuning_rank_spearman-0.34554_val-0.06076_epoch037.chkpt
2025-12-24 13:45:30 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-24_12-51-34/model_checkpoints/checkpoint.tuning_rank_spearman-0.34554_val-0.06076_epoch037.chkpt
2025-12-24 13:45:30 INFO Best validation loss: tensor(0.3455)
2025-12-24 13:45:30 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-24_12-51-34/model_checkpoints/checkpoint.tuning_rank_spearman-0.34554_val-0.06076_epoch037.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-24_12-51-34/model_checkpoints/checkpoint.tuning_rank_spearman-0.34554_val-0.06076_epoch037.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-24 13:45:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.060764
2025-12-24 13:45:45 INFO Tuning ranking metrics: regret=0.094937 spearman=0.345543 (groups=39, skipped=329)
2025-12-24 13:45:45 INFO Epoch 088 | val_loss=0.060764 | best_val_loss=0.345543
2025-12-24 13:45:45 INFO Validation metrics: [{'val_loss': 0.060764379799366, 'tuning_rank_regret': 0.09493742138147354, 'tuning_rank_spearman': 0.34554335474967957, 'val_pearson_corr': 0.7924008965492249, 'val_spearman_corr': 0.7447605133056641, 'val_rank_regret': 0.24485887587070465, 'val_rank_spearman': 0.20269359648227692}]
2025-12-24 13:45:45 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.34554_val-0.06076_epoch037.chkpt
2025-12-24 13:45:45 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.30733_val-0.11783_epoch036.chkpt
2025-12-24 13:45:45 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.32961_val-0.08357_epoch038.chkpt
2025-12-24 13:45:45 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.05474_epoch035.ckpt
2025-12-24 13:45:45 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.09493742138147354
  tuning_rank_spearman      0.34554335474967957
        val_loss             0.060764379799366
    val_pearson_corr        0.7924008965492249
     val_rank_regret        0.24485887587070465
    val_rank_spearman       0.20269359648227692
    val_spearman_corr       0.7447605133056641
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run polish_lr_low_seed555_2025-12-24_12-51-34 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-24_12-51-34
[train_cli][batch] job 'polish_lr_low_seed555' finished.
[train_cli][batch] (5/6) running job 'polish_seed888' -> run_name=polish_seed888_2025-12-24_13-45-48
[train_cli] run_id=polish_seed888_2025-12-24_13-45-48 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-24_13-45-48/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-24_13-45-48 --git-commit 9b1bb2b320 --git-dirty
2025-12-24 13:45:52 INFO git_commit = 9b1bb2b320 (dirty)
2025-12-24 13:45:52 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-24 13:45:52 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-24_13-45-48/config/config.yaml
2025-12-24 13:45:52 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data
2025-12-24 13:45:52 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-24 13:45:52 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-24 13:45:52 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-24_13-45-48
2025-12-24 13:45:52 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-24 13:45:52 INFO   metadata_path = None
2025-12-24 13:45:52 INFO   summary_path = None
2025-12-24 13:45:52 INFO   accelerator = cpu
2025-12-24 13:45:52 INFO   devices = 1
2025-12-24 13:45:52 INFO   attention_head = 8
2025-12-24 13:45:52 INFO   pooling_type = mean
2025-12-24 13:45:52 INFO   model_self_loops = False
2025-12-24 13:45:52 INFO   model_self_loop_fill = mean
2025-12-24 13:45:52 INFO   model_residual = False
2025-12-24 13:45:52 INFO   batch_size = 48
2025-12-24 13:45:52 INFO   learning_rate = 0.003
2025-12-24 13:45:52 INFO   num_epochs = 320
2025-12-24 13:45:52 INFO   accumulate_grad_batches = 8
2025-12-24 13:45:52 INFO   seed = 888
2025-12-24 13:45:52 INFO   num_workers = 2
2025-12-24 13:45:52 INFO   precision = 32
2025-12-24 13:45:52 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-24 13:45:52 INFO   early_stopping_patience = 40
2025-12-24 13:45:52 INFO   lr_scheduler_patience = 20
2025-12-24 13:45:52 INFO   lr_scheduler_factor = 0.3
2025-12-24 13:45:52 INFO   fast_dev_run = False
2025-12-24 13:45:52 INFO   limit_train_batches = None
2025-12-24 13:45:52 INFO   limit_val_batches = None
2025-12-24 13:45:52 INFO   log_lr = False
2025-12-24 13:45:52 INFO   progress_bar_refresh_rate = 0
2025-12-24 13:45:52 INFO   log_every_n_steps = 100
2025-12-24 13:45:52 INFO   use_val_spearman_as_secondary = True
2025-12-24 13:45:52 INFO   spearman_secondary_min_delta = 0.0
2025-12-24 13:45:52 INFO   spearman_secondary_weight = 1.0
2025-12-24 13:45:52 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-24 13:45:52 INFO   tuning_max_samples = 500
2025-12-24 13:45:52 INFO   tuning_fraction = None
2025-12-24 13:45:52 INFO   tuning_eval_every = 1
2025-12-24 13:45:52 INFO   rank_loss_weight = 0.0
2025-12-24 13:45:52 INFO   rank_loss_margin = 0.0
2025-12-24 13:45:52 INFO   rank_loss_mode = hinge
2025-12-24 13:45:52 INFO   rank_loss_grouped = True
2025-12-24 13:45:52 INFO   variance_reduction_enabled = False
2025-12-24 13:45:52 INFO   variance_reduction_method = topk_avg
2025-12-24 13:45:52 INFO   variance_reduction_top_k = 3
2025-12-24 13:45:52 INFO   coverage_minimum = 0.0
2025-12-24 13:45:52 INFO   coverage_fail_on_missing = False
2025-12-24 13:45:52 INFO   graph_load_profiling = False
2025-12-24 13:45:52 INFO   graph_load_top_k = 5
2025-12-24 13:45:52 INFO   enable_graph_cache = True
2025-12-24 13:45:52 INFO   graph_cache_size = 256
2025-12-24 13:45:52 INFO   canonicalize_on_load = False
2025-12-24 13:45:52 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-24 13:45:52 INFO   edge_schema = {}
2025-12-24 13:45:52 INFO   topology_schema = {}
Seed set to 888
2025-12-24 13:45:52 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-24 13:45:52 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 13:45:52 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-24 13:45:52 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 13:45:52 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-24 13:45:52 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 13:45:54 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-24 13:45:54 INFO Tuning group stats: groups=351 groups>=2=40 singletons=311 max_group=10
2025-12-24 13:45:54 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-24_13-45-48/dataset_coverage.json
2025-12-24 13:45:54 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-24_13-45-48/dataset_coverage.json for details.
2025-12-24 13:45:54 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-24_13-45-48/dataset_coverage.json for details.
2025-12-24 13:45:54 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-24_13-45-48/dataset_coverage.json for details.
2025-12-24 13:45:54 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-24_13-45-48/schema_summary.json
2025-12-24 13:45:54 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-24_13-45-48/feature_metadata.json
2025-12-24 13:45:54 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-24 13:45:54 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/advanced_k_partite_v2/feature-config.yaml.advanced_lean.10A.v2, sha256=2022a36e7b21668173af3af66c25cf6b6a0494e642c0934eac38abbcfeebec3d
2025-12-24 13:45:54 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/work/edge_features)
2025-12-24 13:45:54 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json
2025-12-24 13:45:54 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-24_13-45-48/schema_summary.json
2025-12-24 13:45:54 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-24 13:45:54 INFO Topology: topology/persistence_k_partite_advanced/v2 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 628-dimensional node features.
2025-12-24 13:45:54 INFO Node: node/dssp_topo_merge_passthrough/v1; metadata lists 628 feature columns matching the .pt tensor.
2025-12-24 13:45:54 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-24 13:45:54 INFO → Total feature dimensionality observed and confirmed: node_dim = 628, edge_dim = 11.
2025-12-24 13:45:54 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-24 13:45:54 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 628,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge_passthrough/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 628,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-24_13-45-48/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge_passthrough/v1",
      "alias": "Passthrough (all dims from topology module) = Node Dynamic Dims",
      "jobs": 16,
      "summary": "DSSP/basic features merged with all topology columns (passthrough)."
    },
    "topology": {
      "id": "topology/persistence_k_partite_advanced/v2",
      "alias": "Advanced k-partite PH (v2 lean) topo_dim 596",
      "jobs": 16,
      "summary": "Fixed-width k-partite persistent homology with slot padding + missingness channels."
    }
  },
  "notes": []
}
2025-12-24 13:45:54 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-24 13:45:55 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=4a0130093ab44766a5afd337722d18bd)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-24 13:45:55 INFO Starting training (fast_dev_run=False)
2025-12-24 13:45:55 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-24_13-45-48/model_checkpoints exists and is not empty.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 20.1 K | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
180 K     Trainable params
0         Non-trainable params
180 K     Total params
0.721     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-24 13:46:09 INFO Epoch 000 | 25% complete (batch 46/181)
2025-12-24 13:46:10 INFO Epoch 000 | 50% complete (batch 91/181)
2025-12-24 13:46:11 INFO Epoch 000 | 75% complete (batch 136/181)
2025-12-24 13:46:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.140763
2025-12-24 13:46:24 INFO Tuning ranking metrics: regret=0.201793 spearman=-0.003355 (groups=40, skipped=311)
2025-12-24 13:46:24 INFO Epoch 000 | val_loss=0.140763
Metric tuning_rank_spearman improved. New best score: -0.003
2025-12-24 13:46:33 INFO Epoch 001 | 25% complete (batch 46/181)
2025-12-24 13:46:34 INFO Epoch 001 | 50% complete (batch 91/181)
2025-12-24 13:46:34 INFO Epoch 001 | 75% complete (batch 136/181)
2025-12-24 13:46:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.054046
2025-12-24 13:46:48 INFO Tuning ranking metrics: regret=0.187195 spearman=0.002008 (groups=40, skipped=311)
2025-12-24 13:46:48 INFO Epoch 001 | train_mse=0.150672 | val_loss=0.140499 | best_val_loss=-0.003355
Metric tuning_rank_spearman improved by 0.005 >= min_delta = 0.0. New best score: 0.002
2025-12-24 13:46:56 INFO Epoch 002 | 25% complete (batch 46/181)
2025-12-24 13:46:58 INFO Epoch 002 | 50% complete (batch 91/181)
2025-12-24 13:46:58 INFO Epoch 002 | 75% complete (batch 136/181)
2025-12-24 13:47:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.016539
2025-12-24 13:47:12 INFO Tuning ranking metrics: regret=0.167542 spearman=0.017089 (groups=40, skipped=311)
2025-12-24 13:47:12 INFO Epoch 002 | train_mse=0.153941 | val_loss=0.140148 | best_val_loss=0.002008
Metric tuning_rank_spearman improved by 0.015 >= min_delta = 0.0. New best score: 0.017
2025-12-24 13:47:20 INFO Epoch 003 | 25% complete (batch 46/181)
2025-12-24 13:47:21 INFO Epoch 003 | 50% complete (batch 91/181)
2025-12-24 13:47:22 INFO Epoch 003 | 75% complete (batch 136/181)
2025-12-24 13:47:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.306353
2025-12-24 13:47:36 INFO Tuning ranking metrics: regret=0.128063 spearman=0.128766 (groups=40, skipped=311)
2025-12-24 13:47:36 INFO Epoch 003 | train_mse=0.145519 | val_loss=0.138436 | best_val_loss=0.017089
Metric tuning_rank_spearman improved by 0.112 >= min_delta = 0.0. New best score: 0.129
2025-12-24 13:47:44 INFO Epoch 004 | 25% complete (batch 46/181)
2025-12-24 13:47:45 INFO Epoch 004 | 50% complete (batch 91/181)
2025-12-24 13:47:46 INFO Epoch 004 | 75% complete (batch 136/181)
2025-12-24 13:47:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.371318
2025-12-24 13:48:00 INFO Tuning ranking metrics: regret=0.152252 spearman=0.177435 (groups=40, skipped=311)
2025-12-24 13:48:00 INFO Epoch 004 | train_mse=0.147149 | val_loss=0.158431 | best_val_loss=0.128766
Metric tuning_rank_spearman improved by 0.049 >= min_delta = 0.0. New best score: 0.177
2025-12-24 13:48:08 INFO Epoch 005 | 25% complete (batch 46/181)
2025-12-24 13:48:09 INFO Epoch 005 | 50% complete (batch 91/181)
2025-12-24 13:48:10 INFO Epoch 005 | 75% complete (batch 136/181)
2025-12-24 13:48:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.516951
2025-12-24 13:48:24 INFO Tuning ranking metrics: regret=0.166334 spearman=0.207224 (groups=40, skipped=311)
2025-12-24 13:48:24 INFO Epoch 005 | train_mse=0.128939 | val_loss=0.098396 | best_val_loss=0.177435
Metric tuning_rank_spearman improved by 0.030 >= min_delta = 0.0. New best score: 0.207
2025-12-24 13:48:32 INFO Epoch 006 | 25% complete (batch 46/181)
2025-12-24 13:48:33 INFO Epoch 006 | 50% complete (batch 91/181)
2025-12-24 13:48:34 INFO Epoch 006 | 75% complete (batch 136/181)
2025-12-24 13:48:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.556214
2025-12-24 13:48:48 INFO Tuning ranking metrics: regret=0.193855 spearman=0.123469 (groups=40, skipped=311)
2025-12-24 13:48:48 INFO Epoch 006 | train_mse=0.136260 | val_loss=0.125432 | best_val_loss=0.207224
2025-12-24 13:48:56 INFO Epoch 007 | 25% complete (batch 46/181)
2025-12-24 13:48:57 INFO Epoch 007 | 50% complete (batch 91/181)
2025-12-24 13:48:58 INFO Epoch 007 | 75% complete (batch 136/181)
2025-12-24 13:49:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.571787
2025-12-24 13:49:12 INFO Tuning ranking metrics: regret=0.172070 spearman=0.153658 (groups=40, skipped=311)
2025-12-24 13:49:12 INFO Epoch 007 | train_mse=0.131212 | val_loss=0.114335 | best_val_loss=0.207224
2025-12-24 13:49:20 INFO Epoch 008 | 25% complete (batch 46/181)
2025-12-24 13:49:21 INFO Epoch 008 | 50% complete (batch 91/181)
2025-12-24 13:49:22 INFO Epoch 008 | 75% complete (batch 136/181)
2025-12-24 13:49:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.604739
2025-12-24 13:49:36 INFO Tuning ranking metrics: regret=0.171133 spearman=0.178874 (groups=40, skipped=311)
2025-12-24 13:49:36 INFO Epoch 008 | train_mse=0.134734 | val_loss=0.099258 | best_val_loss=0.207224
2025-12-24 13:49:44 INFO Epoch 009 | 25% complete (batch 46/181)
2025-12-24 13:49:45 INFO Epoch 009 | 50% complete (batch 91/181)
2025-12-24 13:49:46 INFO Epoch 009 | 75% complete (batch 136/181)
2025-12-24 13:49:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.606778
2025-12-24 13:50:00 INFO Tuning ranking metrics: regret=0.175771 spearman=0.103864 (groups=40, skipped=311)
2025-12-24 13:50:00 INFO Epoch 009 | train_mse=0.122582 | val_loss=0.103389 | best_val_loss=0.207224
2025-12-24 13:50:08 INFO Epoch 010 | 25% complete (batch 46/181)
2025-12-24 13:50:09 INFO Epoch 010 | 50% complete (batch 91/181)
2025-12-24 13:50:10 INFO Epoch 010 | 75% complete (batch 136/181)
2025-12-24 13:50:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.622035
2025-12-24 13:50:24 INFO Tuning ranking metrics: regret=0.185961 spearman=0.153198 (groups=40, skipped=311)
2025-12-24 13:50:24 INFO Epoch 010 | train_mse=0.117012 | val_loss=0.096515 | best_val_loss=0.207224
2025-12-24 13:50:33 INFO Epoch 011 | 25% complete (batch 46/181)
2025-12-24 13:50:34 INFO Epoch 011 | 50% complete (batch 91/181)
2025-12-24 13:50:34 INFO Epoch 011 | 75% complete (batch 136/181)
2025-12-24 13:50:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.628448
2025-12-24 13:50:48 INFO Tuning ranking metrics: regret=0.169490 spearman=0.187879 (groups=40, skipped=311)
2025-12-24 13:50:48 INFO Epoch 011 | train_mse=0.110565 | val_loss=0.094227 | best_val_loss=0.207224
2025-12-24 13:50:57 INFO Epoch 012 | 25% complete (batch 46/181)
2025-12-24 13:50:57 INFO Epoch 012 | 50% complete (batch 91/181)
2025-12-24 13:50:58 INFO Epoch 012 | 75% complete (batch 136/181)
2025-12-24 13:51:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.625146
2025-12-24 13:51:12 INFO Tuning ranking metrics: regret=0.170265 spearman=0.214297 (groups=40, skipped=311)
2025-12-24 13:51:12 INFO Epoch 012 | train_mse=0.096935 | val_loss=0.089598 | best_val_loss=0.207224
Metric tuning_rank_spearman improved by 0.007 >= min_delta = 0.0. New best score: 0.214
2025-12-24 13:51:21 INFO Epoch 013 | 25% complete (batch 46/181)
2025-12-24 13:51:22 INFO Epoch 013 | 50% complete (batch 91/181)
2025-12-24 13:51:23 INFO Epoch 013 | 75% complete (batch 136/181)
2025-12-24 13:51:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.667840
2025-12-24 13:51:36 INFO Tuning ranking metrics: regret=0.172587 spearman=0.221412 (groups=40, skipped=311)
2025-12-24 13:51:36 INFO Epoch 013 | train_mse=0.111075 | val_loss=0.066086 | best_val_loss=0.214297
Metric tuning_rank_spearman improved by 0.007 >= min_delta = 0.0. New best score: 0.221
2025-12-24 13:51:45 INFO Epoch 014 | 25% complete (batch 46/181)
2025-12-24 13:51:46 INFO Epoch 014 | 50% complete (batch 91/181)
2025-12-24 13:51:47 INFO Epoch 014 | 75% complete (batch 136/181)
2025-12-24 13:51:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.619276
2025-12-24 13:52:00 INFO Tuning ranking metrics: regret=0.153101 spearman=0.100833 (groups=40, skipped=311)
2025-12-24 13:52:00 INFO Epoch 014 | train_mse=0.088157 | val_loss=0.109839 | best_val_loss=0.221412
2025-12-24 13:52:09 INFO Epoch 015 | 25% complete (batch 46/181)
2025-12-24 13:52:10 INFO Epoch 015 | 50% complete (batch 91/181)
2025-12-24 13:52:11 INFO Epoch 015 | 75% complete (batch 136/181)
2025-12-24 13:52:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.631939
2025-12-24 13:52:25 INFO Tuning ranking metrics: regret=0.151814 spearman=0.191158 (groups=40, skipped=311)
2025-12-24 13:52:25 INFO Epoch 015 | train_mse=0.107339 | val_loss=0.102238 | best_val_loss=0.221412
2025-12-24 13:52:33 INFO Epoch 016 | 25% complete (batch 46/181)
2025-12-24 13:52:34 INFO Epoch 016 | 50% complete (batch 91/181)
2025-12-24 13:52:35 INFO Epoch 016 | 75% complete (batch 136/181)
2025-12-24 13:52:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.661538
2025-12-24 13:52:49 INFO Tuning ranking metrics: regret=0.151950 spearman=0.158718 (groups=40, skipped=311)
2025-12-24 13:52:49 INFO Epoch 016 | train_mse=0.082978 | val_loss=0.070913 | best_val_loss=0.221412
2025-12-24 13:52:57 INFO Epoch 017 | 25% complete (batch 46/181)
2025-12-24 13:52:58 INFO Epoch 017 | 50% complete (batch 91/181)
2025-12-24 13:52:59 INFO Epoch 017 | 75% complete (batch 136/181)
2025-12-24 13:53:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.689056
2025-12-24 13:53:13 INFO Tuning ranking metrics: regret=0.133058 spearman=0.198214 (groups=40, skipped=311)
2025-12-24 13:53:13 INFO Epoch 017 | train_mse=0.072873 | val_loss=0.067322 | best_val_loss=0.221412
2025-12-24 13:53:21 INFO Epoch 018 | 25% complete (batch 46/181)
2025-12-24 13:53:22 INFO Epoch 018 | 50% complete (batch 91/181)
2025-12-24 13:53:23 INFO Epoch 018 | 75% complete (batch 136/181)
2025-12-24 13:53:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.642246
2025-12-24 13:53:37 INFO Tuning ranking metrics: regret=0.149749 spearman=0.223431 (groups=40, skipped=311)
2025-12-24 13:53:37 INFO Epoch 018 | train_mse=0.059555 | val_loss=0.112187 | best_val_loss=0.221412
Metric tuning_rank_spearman improved by 0.002 >= min_delta = 0.0. New best score: 0.223
2025-12-24 13:53:45 INFO Epoch 019 | 25% complete (batch 46/181)
2025-12-24 13:53:46 INFO Epoch 019 | 50% complete (batch 91/181)
2025-12-24 13:53:47 INFO Epoch 019 | 75% complete (batch 136/181)
2025-12-24 13:53:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.694541
2025-12-24 13:54:01 INFO Tuning ranking metrics: regret=0.149794 spearman=0.225265 (groups=40, skipped=311)
2025-12-24 13:54:01 INFO Epoch 019 | train_mse=0.083576 | val_loss=0.061083 | best_val_loss=0.223431
Metric tuning_rank_spearman improved by 0.002 >= min_delta = 0.0. New best score: 0.225
2025-12-24 13:54:10 INFO Epoch 020 | 25% complete (batch 46/181)
2025-12-24 13:54:12 INFO Epoch 020 | 50% complete (batch 91/181)
2025-12-24 13:54:13 INFO Epoch 020 | 75% complete (batch 136/181)
2025-12-24 13:54:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.694304
2025-12-24 13:54:27 INFO Tuning ranking metrics: regret=0.130561 spearman=0.240758 (groups=40, skipped=311)
2025-12-24 13:54:27 INFO Epoch 020 | train_mse=0.085464 | val_loss=0.063566 | best_val_loss=0.225265
Metric tuning_rank_spearman improved by 0.015 >= min_delta = 0.0. New best score: 0.241
2025-12-24 13:54:35 INFO Epoch 021 | 25% complete (batch 46/181)
2025-12-24 13:54:36 INFO Epoch 021 | 50% complete (batch 91/181)
2025-12-24 13:54:37 INFO Epoch 021 | 75% complete (batch 136/181)
2025-12-24 13:54:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.702485
2025-12-24 13:54:51 INFO Tuning ranking metrics: regret=0.138609 spearman=0.133171 (groups=40, skipped=311)
2025-12-24 13:54:51 INFO Epoch 021 | train_mse=0.067786 | val_loss=0.062595 | best_val_loss=0.240758
2025-12-24 13:54:59 INFO Epoch 022 | 25% complete (batch 46/181)
2025-12-24 13:55:00 INFO Epoch 022 | 50% complete (batch 91/181)
2025-12-24 13:55:01 INFO Epoch 022 | 75% complete (batch 136/181)
2025-12-24 13:55:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.704976
2025-12-24 13:55:15 INFO Tuning ranking metrics: regret=0.136344 spearman=0.115152 (groups=40, skipped=311)
2025-12-24 13:55:15 INFO Epoch 022 | train_mse=0.079634 | val_loss=0.063038 | best_val_loss=0.240758
2025-12-24 13:55:23 INFO Epoch 023 | 25% complete (batch 46/181)
2025-12-24 13:55:24 INFO Epoch 023 | 50% complete (batch 91/181)
2025-12-24 13:55:25 INFO Epoch 023 | 75% complete (batch 136/181)
2025-12-24 13:55:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.708548
2025-12-24 13:55:39 INFO Tuning ranking metrics: regret=0.141753 spearman=0.183555 (groups=40, skipped=311)
2025-12-24 13:55:39 INFO Epoch 023 | train_mse=0.066398 | val_loss=0.059399 | best_val_loss=0.240758
2025-12-24 13:55:47 INFO Epoch 024 | 25% complete (batch 46/181)
2025-12-24 13:55:48 INFO Epoch 024 | 50% complete (batch 91/181)
2025-12-24 13:55:49 INFO Epoch 024 | 75% complete (batch 136/181)
2025-12-24 13:55:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.672514
2025-12-24 13:56:03 INFO Tuning ranking metrics: regret=0.144401 spearman=0.190211 (groups=40, skipped=311)
2025-12-24 13:56:03 INFO Epoch 024 | train_mse=0.061337 | val_loss=0.105528 | best_val_loss=0.240758
2025-12-24 13:56:11 INFO Epoch 025 | 25% complete (batch 46/181)
2025-12-24 13:56:12 INFO Epoch 025 | 50% complete (batch 91/181)
2025-12-24 13:56:13 INFO Epoch 025 | 75% complete (batch 136/181)
2025-12-24 13:56:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.715023
2025-12-24 13:56:27 INFO Tuning ranking metrics: regret=0.148096 spearman=0.163929 (groups=40, skipped=311)
2025-12-24 13:56:27 INFO Epoch 025 | train_mse=0.086619 | val_loss=0.076952 | best_val_loss=0.240758
2025-12-24 13:56:35 INFO Epoch 026 | 25% complete (batch 46/181)
2025-12-24 13:56:36 INFO Epoch 026 | 50% complete (batch 91/181)
2025-12-24 13:56:37 INFO Epoch 026 | 75% complete (batch 136/181)
2025-12-24 13:56:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.708137
2025-12-24 13:56:51 INFO Tuning ranking metrics: regret=0.148242 spearman=0.201872 (groups=40, skipped=311)
2025-12-24 13:56:51 INFO Epoch 026 | train_mse=0.074626 | val_loss=0.058637 | best_val_loss=0.240758
2025-12-24 13:56:59 INFO Epoch 027 | 25% complete (batch 46/181)
2025-12-24 13:57:00 INFO Epoch 027 | 50% complete (batch 91/181)
2025-12-24 13:57:01 INFO Epoch 027 | 75% complete (batch 136/181)
2025-12-24 13:57:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.731622
2025-12-24 13:57:15 INFO Tuning ranking metrics: regret=0.149807 spearman=0.174123 (groups=40, skipped=311)
2025-12-24 13:57:15 INFO Epoch 027 | train_mse=0.070276 | val_loss=0.055138 | best_val_loss=0.240758
2025-12-24 13:57:23 INFO Epoch 028 | 25% complete (batch 46/181)
2025-12-24 13:57:24 INFO Epoch 028 | 50% complete (batch 91/181)
2025-12-24 13:57:25 INFO Epoch 028 | 75% complete (batch 136/181)
2025-12-24 13:57:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.739422
2025-12-24 13:57:39 INFO Tuning ranking metrics: regret=0.130060 spearman=0.219329 (groups=40, skipped=311)
2025-12-24 13:57:39 INFO Epoch 028 | train_mse=0.049299 | val_loss=0.054884 | best_val_loss=0.240758
2025-12-24 13:57:48 INFO Epoch 029 | 25% complete (batch 46/181)
2025-12-24 13:57:48 INFO Epoch 029 | 50% complete (batch 91/181)
2025-12-24 13:57:49 INFO Epoch 029 | 75% complete (batch 136/181)
2025-12-24 13:57:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.712481
2025-12-24 13:58:03 INFO Tuning ranking metrics: regret=0.135159 spearman=0.124324 (groups=40, skipped=311)
2025-12-24 13:58:03 INFO Epoch 029 | train_mse=0.069858 | val_loss=0.077013 | best_val_loss=0.240758
2025-12-24 13:58:12 INFO Epoch 030 | 25% complete (batch 46/181)
2025-12-24 13:58:13 INFO Epoch 030 | 50% complete (batch 91/181)
2025-12-24 13:58:13 INFO Epoch 030 | 75% complete (batch 136/181)
2025-12-24 13:58:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.717490
2025-12-24 13:58:27 INFO Tuning ranking metrics: regret=0.133758 spearman=0.086872 (groups=40, skipped=311)
2025-12-24 13:58:27 INFO Epoch 030 | train_mse=0.077479 | val_loss=0.064274 | best_val_loss=0.240758
2025-12-24 13:58:36 INFO Epoch 031 | 25% complete (batch 46/181)
2025-12-24 13:58:37 INFO Epoch 031 | 50% complete (batch 91/181)
2025-12-24 13:58:38 INFO Epoch 031 | 75% complete (batch 136/181)
2025-12-24 13:58:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.709811
2025-12-24 13:58:51 INFO Tuning ranking metrics: regret=0.149936 spearman=0.104026 (groups=40, skipped=311)
2025-12-24 13:58:51 INFO Epoch 031 | train_mse=0.047755 | val_loss=0.069170 | best_val_loss=0.240758
2025-12-24 13:59:00 INFO Epoch 032 | 25% complete (batch 46/181)
2025-12-24 13:59:01 INFO Epoch 032 | 50% complete (batch 91/181)
2025-12-24 13:59:02 INFO Epoch 032 | 75% complete (batch 136/181)
2025-12-24 13:59:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.709780
2025-12-24 13:59:15 INFO Tuning ranking metrics: regret=0.146677 spearman=0.141515 (groups=40, skipped=311)
2025-12-24 13:59:15 INFO Epoch 032 | train_mse=0.064284 | val_loss=0.063482 | best_val_loss=0.240758
2025-12-24 13:59:24 INFO Epoch 033 | 25% complete (batch 46/181)
2025-12-24 13:59:25 INFO Epoch 033 | 50% complete (batch 91/181)
2025-12-24 13:59:26 INFO Epoch 033 | 75% complete (batch 136/181)
2025-12-24 13:59:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.728656
2025-12-24 13:59:40 INFO Tuning ranking metrics: regret=0.168970 spearman=0.060065 (groups=40, skipped=311)
2025-12-24 13:59:40 INFO Epoch 033 | train_mse=0.061249 | val_loss=0.058574 | best_val_loss=0.240758
2025-12-24 13:59:48 INFO Epoch 034 | 25% complete (batch 46/181)
2025-12-24 13:59:49 INFO Epoch 034 | 50% complete (batch 91/181)
2025-12-24 13:59:50 INFO Epoch 034 | 75% complete (batch 136/181)
2025-12-24 13:59:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.717493
2025-12-24 14:00:04 INFO Tuning ranking metrics: regret=0.136270 spearman=0.121434 (groups=40, skipped=311)
2025-12-24 14:00:04 INFO Epoch 034 | train_mse=0.052263 | val_loss=0.052869 | best_val_loss=0.240758
2025-12-24 14:00:12 INFO Epoch 035 | 25% complete (batch 46/181)
2025-12-24 14:00:13 INFO Epoch 035 | 50% complete (batch 91/181)
2025-12-24 14:00:14 INFO Epoch 035 | 75% complete (batch 136/181)
2025-12-24 14:00:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.711301
2025-12-24 14:00:28 INFO Tuning ranking metrics: regret=0.136601 spearman=0.077511 (groups=40, skipped=311)
2025-12-24 14:00:28 INFO Epoch 035 | train_mse=0.071025 | val_loss=0.074504 | best_val_loss=0.240758
2025-12-24 14:00:36 INFO Epoch 036 | 25% complete (batch 46/181)
2025-12-24 14:00:37 INFO Epoch 036 | 50% complete (batch 91/181)
2025-12-24 14:00:38 INFO Epoch 036 | 75% complete (batch 136/181)
2025-12-24 14:00:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.728593
2025-12-24 14:00:52 INFO Tuning ranking metrics: regret=0.133465 spearman=0.182576 (groups=40, skipped=311)
2025-12-24 14:00:52 INFO Epoch 036 | train_mse=0.094368 | val_loss=0.052534 | best_val_loss=0.240758
2025-12-24 14:01:00 INFO Epoch 037 | 25% complete (batch 46/181)
2025-12-24 14:01:01 INFO Epoch 037 | 50% complete (batch 91/181)
2025-12-24 14:01:02 INFO Epoch 037 | 75% complete (batch 136/181)
2025-12-24 14:01:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.718249
2025-12-24 14:01:16 INFO Tuning ranking metrics: regret=0.138802 spearman=0.189302 (groups=40, skipped=311)
2025-12-24 14:01:16 INFO Epoch 037 | train_mse=0.071866 | val_loss=0.064705 | best_val_loss=0.240758
2025-12-24 14:01:25 INFO Epoch 038 | 25% complete (batch 46/181)
2025-12-24 14:01:26 INFO Epoch 038 | 50% complete (batch 91/181)
2025-12-24 14:01:26 INFO Epoch 038 | 75% complete (batch 136/181)
2025-12-24 14:01:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.722905
2025-12-24 14:01:40 INFO Tuning ranking metrics: regret=0.133029 spearman=0.195135 (groups=40, skipped=311)
2025-12-24 14:01:40 INFO Epoch 038 | train_mse=0.083460 | val_loss=0.064207 | best_val_loss=0.240758
2025-12-24 14:01:49 INFO Epoch 039 | 25% complete (batch 46/181)
2025-12-24 14:01:50 INFO Epoch 039 | 50% complete (batch 91/181)
2025-12-24 14:01:51 INFO Epoch 039 | 75% complete (batch 136/181)
2025-12-24 14:01:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.707213
2025-12-24 14:02:05 INFO Tuning ranking metrics: regret=0.132643 spearman=0.198295 (groups=40, skipped=311)
2025-12-24 14:02:05 INFO Epoch 039 | train_mse=0.073706 | val_loss=0.075104 | best_val_loss=0.240758
2025-12-24 14:02:13 INFO Epoch 040 | 25% complete (batch 46/181)
2025-12-24 14:02:14 INFO Epoch 040 | 50% complete (batch 91/181)
2025-12-24 14:02:15 INFO Epoch 040 | 75% complete (batch 136/181)
2025-12-24 14:02:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.689331
2025-12-24 14:02:29 INFO Tuning ranking metrics: regret=0.113288 spearman=0.229253 (groups=40, skipped=311)
2025-12-24 14:02:29 INFO Epoch 040 | train_mse=0.057270 | val_loss=0.088275 | best_val_loss=0.240758
2025-12-24 14:02:37 INFO Epoch 041 | 25% complete (batch 46/181)
2025-12-24 14:02:38 INFO Epoch 041 | 50% complete (batch 91/181)
2025-12-24 14:02:39 INFO Epoch 041 | 75% complete (batch 136/181)
2025-12-24 14:02:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.729903
2025-12-24 14:02:53 INFO Tuning ranking metrics: regret=0.133300 spearman=0.208929 (groups=40, skipped=311)
2025-12-24 14:02:53 INFO Epoch 041 | train_mse=0.078579 | val_loss=0.055885 | best_val_loss=0.240758
2025-12-24 14:03:02 INFO Epoch 042 | 25% complete (batch 46/181)
2025-12-24 14:03:03 INFO Epoch 042 | 50% complete (batch 91/181)
2025-12-24 14:03:04 INFO Epoch 042 | 75% complete (batch 136/181)
2025-12-24 14:03:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.730245
2025-12-24 14:03:17 INFO Tuning ranking metrics: regret=0.138801 spearman=0.035427 (groups=40, skipped=311)
2025-12-24 14:03:17 INFO Epoch 042 | train_mse=0.082350 | val_loss=0.057606 | best_val_loss=0.240758
2025-12-24 14:03:26 INFO Epoch 043 | 25% complete (batch 46/181)
2025-12-24 14:03:27 INFO Epoch 043 | 50% complete (batch 91/181)
2025-12-24 14:03:28 INFO Epoch 043 | 75% complete (batch 136/181)
2025-12-24 14:03:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.702753
2025-12-24 14:03:41 INFO Tuning ranking metrics: regret=0.149771 spearman=0.008690 (groups=40, skipped=311)
2025-12-24 14:03:41 INFO Epoch 043 | train_mse=0.074278 | val_loss=0.067643 | best_val_loss=0.240758
2025-12-24 14:03:50 INFO Epoch 044 | 25% complete (batch 46/181)
2025-12-24 14:03:51 INFO Epoch 044 | 50% complete (batch 91/181)
2025-12-24 14:03:52 INFO Epoch 044 | 75% complete (batch 136/181)
2025-12-24 14:04:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.685822
2025-12-24 14:04:05 INFO Tuning ranking metrics: regret=0.136620 spearman=0.074275 (groups=40, skipped=311)
2025-12-24 14:04:05 INFO Epoch 044 | train_mse=0.071172 | val_loss=0.076542 | best_val_loss=0.240758
2025-12-24 14:04:14 INFO Epoch 045 | 25% complete (batch 46/181)
2025-12-24 14:04:15 INFO Epoch 045 | 50% complete (batch 91/181)
2025-12-24 14:04:15 INFO Epoch 045 | 75% complete (batch 136/181)
2025-12-24 14:04:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.701539
2025-12-24 14:04:29 INFO Tuning ranking metrics: regret=0.155823 spearman=0.056153 (groups=40, skipped=311)
2025-12-24 14:04:29 INFO Epoch 045 | train_mse=0.071507 | val_loss=0.084601 | best_val_loss=0.240758
2025-12-24 14:04:38 INFO Epoch 046 | 25% complete (batch 46/181)
2025-12-24 14:04:39 INFO Epoch 046 | 50% complete (batch 91/181)
2025-12-24 14:04:40 INFO Epoch 046 | 75% complete (batch 136/181)
2025-12-24 14:04:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.712613
2025-12-24 14:04:53 INFO Tuning ranking metrics: regret=0.137954 spearman=0.106331 (groups=40, skipped=311)
2025-12-24 14:04:53 INFO Epoch 046 | train_mse=0.085058 | val_loss=0.058722 | best_val_loss=0.240758
2025-12-24 14:05:02 INFO Epoch 047 | 25% complete (batch 46/181)
2025-12-24 14:05:03 INFO Epoch 047 | 50% complete (batch 91/181)
2025-12-24 14:05:04 INFO Epoch 047 | 75% complete (batch 136/181)
2025-12-24 14:05:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.712596
2025-12-24 14:05:17 INFO Tuning ranking metrics: regret=0.135779 spearman=0.126180 (groups=40, skipped=311)
2025-12-24 14:05:17 INFO Epoch 047 | train_mse=0.064767 | val_loss=0.060063 | best_val_loss=0.240758
2025-12-24 14:05:26 INFO Epoch 048 | 25% complete (batch 46/181)
2025-12-24 14:05:27 INFO Epoch 048 | 50% complete (batch 91/181)
2025-12-24 14:05:28 INFO Epoch 048 | 75% complete (batch 136/181)
2025-12-24 14:05:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.723846
2025-12-24 14:05:42 INFO Tuning ranking metrics: regret=0.135614 spearman=0.112738 (groups=40, skipped=311)
2025-12-24 14:05:42 INFO Epoch 048 | train_mse=0.065628 | val_loss=0.058270 | best_val_loss=0.240758
2025-12-24 14:05:50 INFO Epoch 049 | 25% complete (batch 46/181)
2025-12-24 14:05:51 INFO Epoch 049 | 50% complete (batch 91/181)
2025-12-24 14:05:52 INFO Epoch 049 | 75% complete (batch 136/181)
2025-12-24 14:06:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.720250
2025-12-24 14:06:05 INFO Tuning ranking metrics: regret=0.137883 spearman=0.193176 (groups=40, skipped=311)
2025-12-24 14:06:05 INFO Epoch 049 | train_mse=0.081640 | val_loss=0.058797 | best_val_loss=0.240758
2025-12-24 14:06:14 INFO Epoch 050 | 25% complete (batch 46/181)
2025-12-24 14:06:15 INFO Epoch 050 | 50% complete (batch 91/181)
2025-12-24 14:06:16 INFO Epoch 050 | 75% complete (batch 136/181)
2025-12-24 14:06:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.691621
2025-12-24 14:06:29 INFO Tuning ranking metrics: regret=0.159558 spearman=0.144648 (groups=40, skipped=311)
2025-12-24 14:06:29 INFO Epoch 050 | train_mse=0.078208 | val_loss=0.095341 | best_val_loss=0.240758
2025-12-24 14:06:38 INFO Epoch 051 | 25% complete (batch 46/181)
2025-12-24 14:06:39 INFO Epoch 051 | 50% complete (batch 91/181)
2025-12-24 14:06:40 INFO Epoch 051 | 75% complete (batch 136/181)
2025-12-24 14:06:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.722078
2025-12-24 14:06:54 INFO Tuning ranking metrics: regret=0.121804 spearman=0.128615 (groups=40, skipped=311)
2025-12-24 14:06:54 INFO Epoch 051 | train_mse=0.063438 | val_loss=0.055896 | best_val_loss=0.240758
2025-12-24 14:07:02 INFO Epoch 052 | 25% complete (batch 46/181)
2025-12-24 14:07:03 INFO Epoch 052 | 50% complete (batch 91/181)
2025-12-24 14:07:04 INFO Epoch 052 | 75% complete (batch 136/181)
2025-12-24 14:07:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.733760
2025-12-24 14:07:18 INFO Tuning ranking metrics: regret=0.116038 spearman=0.126981 (groups=40, skipped=311)
2025-12-24 14:07:18 INFO Epoch 052 | train_mse=0.057643 | val_loss=0.053772 | best_val_loss=0.240758
2025-12-24 14:07:26 INFO Epoch 053 | 25% complete (batch 46/181)
2025-12-24 14:07:27 INFO Epoch 053 | 50% complete (batch 91/181)
2025-12-24 14:07:28 INFO Epoch 053 | 75% complete (batch 136/181)
2025-12-24 14:07:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.710715
2025-12-24 14:07:42 INFO Tuning ranking metrics: regret=0.135099 spearman=0.120547 (groups=40, skipped=311)
2025-12-24 14:07:42 INFO Epoch 053 | train_mse=0.063617 | val_loss=0.077957 | best_val_loss=0.240758
2025-12-24 14:07:51 INFO Epoch 054 | 25% complete (batch 46/181)
2025-12-24 14:07:52 INFO Epoch 054 | 50% complete (batch 91/181)
2025-12-24 14:07:53 INFO Epoch 054 | 75% complete (batch 136/181)
2025-12-24 14:08:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.729831
2025-12-24 14:08:06 INFO Tuning ranking metrics: regret=0.141940 spearman=0.107251 (groups=40, skipped=311)
2025-12-24 14:08:06 INFO Epoch 054 | train_mse=0.050887 | val_loss=0.050624 | best_val_loss=0.240758
2025-12-24 14:08:15 INFO Epoch 055 | 25% complete (batch 46/181)
2025-12-24 14:08:16 INFO Epoch 055 | 50% complete (batch 91/181)
2025-12-24 14:08:17 INFO Epoch 055 | 75% complete (batch 136/181)
2025-12-24 14:08:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.724562
2025-12-24 14:08:30 INFO Tuning ranking metrics: regret=0.116013 spearman=0.179334 (groups=40, skipped=311)
2025-12-24 14:08:30 INFO Epoch 055 | train_mse=0.064284 | val_loss=0.061712 | best_val_loss=0.240758
2025-12-24 14:08:39 INFO Epoch 056 | 25% complete (batch 46/181)
2025-12-24 14:08:40 INFO Epoch 056 | 50% complete (batch 91/181)
2025-12-24 14:08:41 INFO Epoch 056 | 75% complete (batch 136/181)
2025-12-24 14:08:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.699992
2025-12-24 14:08:55 INFO Tuning ranking metrics: regret=0.165669 spearman=0.109307 (groups=40, skipped=311)
2025-12-24 14:08:55 INFO Epoch 056 | train_mse=0.088806 | val_loss=0.087775 | best_val_loss=0.240758
2025-12-24 14:09:03 INFO Epoch 057 | 25% complete (batch 46/181)
2025-12-24 14:09:04 INFO Epoch 057 | 50% complete (batch 91/181)
2025-12-24 14:09:05 INFO Epoch 057 | 75% complete (batch 136/181)
2025-12-24 14:09:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.692148
2025-12-24 14:09:18 INFO Tuning ranking metrics: regret=0.161259 spearman=0.156034 (groups=40, skipped=311)
2025-12-24 14:09:18 INFO Epoch 057 | train_mse=0.087217 | val_loss=0.080461 | best_val_loss=0.240758
2025-12-24 14:09:27 INFO Epoch 058 | 25% complete (batch 46/181)
2025-12-24 14:09:28 INFO Epoch 058 | 50% complete (batch 91/181)
2025-12-24 14:09:29 INFO Epoch 058 | 75% complete (batch 136/181)
2025-12-24 14:09:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.708446
2025-12-24 14:09:42 INFO Tuning ranking metrics: regret=0.116450 spearman=0.099746 (groups=40, skipped=311)
2025-12-24 14:09:42 INFO Epoch 058 | train_mse=0.081408 | val_loss=0.067735 | best_val_loss=0.240758
2025-12-24 14:09:51 INFO Epoch 059 | 25% complete (batch 46/181)
2025-12-24 14:09:52 INFO Epoch 059 | 50% complete (batch 91/181)
2025-12-24 14:09:53 INFO Epoch 059 | 75% complete (batch 136/181)
2025-12-24 14:10:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.739051
2025-12-24 14:10:07 INFO Tuning ranking metrics: regret=0.118624 spearman=0.079746 (groups=40, skipped=311)
2025-12-24 14:10:07 INFO Epoch 059 | train_mse=0.061549 | val_loss=0.054215 | best_val_loss=0.240758
2025-12-24 14:10:15 INFO Epoch 060 | 25% complete (batch 46/181)
2025-12-24 14:10:16 INFO Epoch 060 | 50% complete (batch 91/181)
2025-12-24 14:10:17 INFO Epoch 060 | 75% complete (batch 136/181)
2025-12-24 14:10:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.700000
2025-12-24 14:10:30 INFO Tuning ranking metrics: regret=0.122899 spearman=0.139470 (groups=40, skipped=311)
2025-12-24 14:10:30 INFO Epoch 060 | train_mse=0.071670 | val_loss=0.074218 | best_val_loss=0.240758
Monitored metric tuning_rank_spearman did not improve in the last 40 records. Best score: 0.241. Signaling Trainer to stop.
2025-12-24 14:10:31 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.22527_val-0.06108_epoch019.chkpt, checkpoint.tuning_rank_spearman-0.22925_val-0.08827_epoch040.chkpt, checkpoint.tuning_rank_spearman-0.24076_val-0.06357_epoch020.chkpt
2025-12-24 14:10:31 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-24_13-45-48/model_checkpoints/checkpoint.tuning_rank_spearman-0.24076_val-0.06357_epoch020.chkpt
2025-12-24 14:10:31 INFO Best validation loss: tensor(0.2408)
2025-12-24 14:10:31 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-24_13-45-48/model_checkpoints/checkpoint.tuning_rank_spearman-0.24076_val-0.06357_epoch020.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-24_13-45-48/model_checkpoints/checkpoint.tuning_rank_spearman-0.24076_val-0.06357_epoch020.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-24 14:10:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.063566
2025-12-24 14:10:44 INFO Tuning ranking metrics: regret=0.130561 spearman=0.240758 (groups=40, skipped=311)
2025-12-24 14:10:44 INFO Epoch 061 | val_loss=0.063566 | best_val_loss=0.240758
2025-12-24 14:10:44 INFO Validation metrics: [{'val_loss': 0.0635657012462616, 'tuning_rank_regret': 0.13056066632270813, 'tuning_rank_spearman': 0.24075756967067719, 'val_pearson_corr': 0.7577940821647644, 'val_spearman_corr': 0.7650802135467529, 'val_rank_regret': 0.003012067638337612, 'val_rank_spearman': 0.4444444477558136}]
2025-12-24 14:10:44 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.24076_val-0.06357_epoch020.chkpt
2025-12-24 14:10:44 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.22527_val-0.06108_epoch019.chkpt
2025-12-24 14:10:44 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.22925_val-0.08827_epoch040.chkpt
2025-12-24 14:10:44 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.06108_epoch019.ckpt
2025-12-24 14:10:44 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.13056066632270813
  tuning_rank_spearman      0.24075756967067719
        val_loss            0.0635657012462616
    val_pearson_corr        0.7577940821647644
     val_rank_regret       0.003012067638337612
    val_rank_spearman       0.4444444477558136
    val_spearman_corr       0.7650802135467529
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run polish_seed888_2025-12-24_13-45-48 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-24_13-45-48
[train_cli][batch] job 'polish_seed888' finished.
[train_cli][batch] (6/6) running job 'polish_lr_low_seed888' -> run_name=polish_lr_low_seed888_2025-12-24_14-10-47
[train_cli] run_id=polish_lr_low_seed888_2025-12-24_14-10-47 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-24_14-10-47/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-24_14-10-47 --git-commit 9b1bb2b320 --git-dirty
2025-12-24 14:10:50 INFO git_commit = 9b1bb2b320 (dirty)
2025-12-24 14:10:50 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-24 14:10:50 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-24_14-10-47/config/config.yaml
2025-12-24 14:10:50 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data
2025-12-24 14:10:50 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-24 14:10:50 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-24 14:10:50 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-24_14-10-47
2025-12-24 14:10:50 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-24 14:10:50 INFO   metadata_path = None
2025-12-24 14:10:50 INFO   summary_path = None
2025-12-24 14:10:50 INFO   accelerator = cpu
2025-12-24 14:10:50 INFO   devices = 1
2025-12-24 14:10:50 INFO   attention_head = 8
2025-12-24 14:10:50 INFO   pooling_type = mean
2025-12-24 14:10:50 INFO   model_self_loops = False
2025-12-24 14:10:50 INFO   model_self_loop_fill = mean
2025-12-24 14:10:50 INFO   model_residual = False
2025-12-24 14:10:50 INFO   batch_size = 12
2025-12-24 14:10:50 INFO   learning_rate = 0.002
2025-12-24 14:10:50 INFO   num_epochs = 360
2025-12-24 14:10:50 INFO   accumulate_grad_batches = 48
2025-12-24 14:10:50 INFO   seed = 888
2025-12-24 14:10:50 INFO   num_workers = 2
2025-12-24 14:10:50 INFO   precision = 32
2025-12-24 14:10:50 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-24 14:10:50 INFO   early_stopping_patience = 50
2025-12-24 14:10:50 INFO   lr_scheduler_patience = 25
2025-12-24 14:10:50 INFO   lr_scheduler_factor = 0.3
2025-12-24 14:10:50 INFO   fast_dev_run = False
2025-12-24 14:10:50 INFO   limit_train_batches = None
2025-12-24 14:10:50 INFO   limit_val_batches = None
2025-12-24 14:10:50 INFO   log_lr = False
2025-12-24 14:10:50 INFO   progress_bar_refresh_rate = 0
2025-12-24 14:10:50 INFO   log_every_n_steps = 100
2025-12-24 14:10:50 INFO   use_val_spearman_as_secondary = True
2025-12-24 14:10:50 INFO   spearman_secondary_min_delta = 0.0
2025-12-24 14:10:50 INFO   spearman_secondary_weight = 1.0
2025-12-24 14:10:50 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-24 14:10:50 INFO   tuning_max_samples = 500
2025-12-24 14:10:50 INFO   tuning_fraction = None
2025-12-24 14:10:50 INFO   tuning_eval_every = 1
2025-12-24 14:10:50 INFO   rank_loss_weight = 0.0
2025-12-24 14:10:50 INFO   rank_loss_margin = 0.0
2025-12-24 14:10:50 INFO   rank_loss_mode = hinge
2025-12-24 14:10:50 INFO   rank_loss_grouped = True
2025-12-24 14:10:50 INFO   variance_reduction_enabled = False
2025-12-24 14:10:50 INFO   variance_reduction_method = topk_avg
2025-12-24 14:10:50 INFO   variance_reduction_top_k = 3
2025-12-24 14:10:50 INFO   coverage_minimum = 0.0
2025-12-24 14:10:50 INFO   coverage_fail_on_missing = False
2025-12-24 14:10:50 INFO   graph_load_profiling = False
2025-12-24 14:10:50 INFO   graph_load_top_k = 5
2025-12-24 14:10:50 INFO   enable_graph_cache = True
2025-12-24 14:10:50 INFO   graph_cache_size = 256
2025-12-24 14:10:50 INFO   canonicalize_on_load = False
2025-12-24 14:10:50 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-24 14:10:50 INFO   edge_schema = {}
2025-12-24 14:10:50 INFO   topology_schema = {}
Seed set to 888
2025-12-24 14:10:51 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-24 14:10:51 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 14:10:51 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-24 14:10:51 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 14:10:51 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-24 14:10:51 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 14:10:53 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-24 14:10:53 INFO Tuning group stats: groups=351 groups>=2=40 singletons=311 max_group=10
2025-12-24 14:10:53 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-24_14-10-47/dataset_coverage.json
2025-12-24 14:10:53 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-24_14-10-47/dataset_coverage.json for details.
2025-12-24 14:10:53 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-24_14-10-47/dataset_coverage.json for details.
2025-12-24 14:10:53 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-24_14-10-47/dataset_coverage.json for details.
2025-12-24 14:10:53 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-24_14-10-47/schema_summary.json
2025-12-24 14:10:53 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-24_14-10-47/feature_metadata.json
2025-12-24 14:10:53 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-24 14:10:53 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/advanced_k_partite_v2/feature-config.yaml.advanced_lean.10A.v2, sha256=2022a36e7b21668173af3af66c25cf6b6a0494e642c0934eac38abbcfeebec3d
2025-12-24 14:10:53 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/work/edge_features)
2025-12-24 14:10:53 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json
2025-12-24 14:10:53 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-24_14-10-47/schema_summary.json
2025-12-24 14:10:53 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-24 14:10:53 INFO Topology: topology/persistence_k_partite_advanced/v2 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 628-dimensional node features.
2025-12-24 14:10:53 INFO Node: node/dssp_topo_merge_passthrough/v1; metadata lists 628 feature columns matching the .pt tensor.
2025-12-24 14:10:53 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-24 14:10:53 INFO → Total feature dimensionality observed and confirmed: node_dim = 628, edge_dim = 11.
2025-12-24 14:10:53 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-24 14:10:53 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 628,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge_passthrough/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 628,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-24_14-10-47/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge_passthrough/v1",
      "alias": "Passthrough (all dims from topology module) = Node Dynamic Dims",
      "jobs": 16,
      "summary": "DSSP/basic features merged with all topology columns (passthrough)."
    },
    "topology": {
      "id": "topology/persistence_k_partite_advanced/v2",
      "alias": "Advanced k-partite PH (v2 lean) topo_dim 596",
      "jobs": 16,
      "summary": "Fixed-width k-partite persistent homology with slot padding + missingness channels."
    }
  },
  "notes": []
}
2025-12-24 14:10:53 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-24 14:10:53 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=c2a2635c58df49b9bbbf30dd62f95b1f)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-24 14:10:53 INFO Starting training (fast_dev_run=False)
2025-12-24 14:10:53 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-24_14-10-47/model_checkpoints exists and is not empty.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 20.1 K | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
180 K     Trainable params
0         Non-trainable params
180 K     Total params
0.721     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-24 14:11:10 INFO Epoch 000 | 25% complete (batch 181/724)
2025-12-24 14:11:13 INFO Epoch 000 | 50% complete (batch 362/724)
2025-12-24 14:11:16 INFO Epoch 000 | 75% complete (batch 543/724)
2025-12-24 14:11:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.145014
2025-12-24 14:11:34 INFO Tuning ranking metrics: regret=0.242115 spearman=-0.084481 (groups=40, skipped=311)
2025-12-24 14:11:34 INFO Epoch 000 | val_loss=0.145014
Metric tuning_rank_spearman improved. New best score: -0.084
2025-12-24 14:11:45 INFO Epoch 001 | 25% complete (batch 181/724)
2025-12-24 14:11:48 INFO Epoch 001 | 50% complete (batch 362/724)
2025-12-24 14:11:51 INFO Epoch 001 | 75% complete (batch 543/724)
2025-12-24 14:12:04 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.145346
2025-12-24 14:12:09 INFO Tuning ranking metrics: regret=0.121492 spearman=0.128139 (groups=40, skipped=311)
2025-12-24 14:12:09 INFO Epoch 001 | train_mse=0.145963 | val_loss=0.145346 | best_val_loss=-0.084481
Metric tuning_rank_spearman improved by 0.213 >= min_delta = 0.0. New best score: 0.128
2025-12-24 14:12:19 INFO Epoch 002 | 25% complete (batch 181/724)
2025-12-24 14:12:22 INFO Epoch 002 | 50% complete (batch 362/724)
2025-12-24 14:12:26 INFO Epoch 002 | 75% complete (batch 543/724)
2025-12-24 14:12:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.370275
2025-12-24 14:12:44 INFO Tuning ranking metrics: regret=0.173646 spearman=0.000276 (groups=40, skipped=311)
2025-12-24 14:12:44 INFO Epoch 002 | train_mse=0.145326 | val_loss=0.152915 | best_val_loss=0.128139
2025-12-24 14:12:55 INFO Epoch 003 | 25% complete (batch 181/724)
2025-12-24 14:12:58 INFO Epoch 003 | 50% complete (batch 362/724)
2025-12-24 14:13:01 INFO Epoch 003 | 75% complete (batch 543/724)
2025-12-24 14:13:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.267119
2025-12-24 14:13:19 INFO Tuning ranking metrics: regret=0.142837 spearman=0.153804 (groups=40, skipped=311)
2025-12-24 14:13:19 INFO Epoch 003 | train_mse=0.145439 | val_loss=0.146367 | best_val_loss=0.128139
Metric tuning_rank_spearman improved by 0.026 >= min_delta = 0.0. New best score: 0.154
2025-12-24 14:13:30 INFO Epoch 004 | 25% complete (batch 181/724)
2025-12-24 14:13:33 INFO Epoch 004 | 50% complete (batch 362/724)
2025-12-24 14:13:36 INFO Epoch 004 | 75% complete (batch 543/724)
2025-12-24 14:13:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.403275
2025-12-24 14:13:54 INFO Tuning ranking metrics: regret=0.141834 spearman=0.209302 (groups=40, skipped=311)
2025-12-24 14:13:54 INFO Epoch 004 | train_mse=0.145580 | val_loss=0.139905 | best_val_loss=0.153804
Metric tuning_rank_spearman improved by 0.055 >= min_delta = 0.0. New best score: 0.209
2025-12-24 14:14:05 INFO Epoch 005 | 25% complete (batch 181/724)
2025-12-24 14:14:08 INFO Epoch 005 | 50% complete (batch 362/724)
2025-12-24 14:14:11 INFO Epoch 005 | 75% complete (batch 543/724)
2025-12-24 14:14:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.414289
2025-12-24 14:14:30 INFO Tuning ranking metrics: regret=0.151122 spearman=0.153555 (groups=40, skipped=311)
2025-12-24 14:14:30 INFO Epoch 005 | train_mse=0.139505 | val_loss=0.148324 | best_val_loss=0.209302
2025-12-24 14:14:40 INFO Epoch 006 | 25% complete (batch 181/724)
2025-12-24 14:14:43 INFO Epoch 006 | 50% complete (batch 362/724)
2025-12-24 14:14:46 INFO Epoch 006 | 75% complete (batch 543/724)
2025-12-24 14:15:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.393019
2025-12-24 14:15:05 INFO Tuning ranking metrics: regret=0.150223 spearman=0.235319 (groups=40, skipped=311)
2025-12-24 14:15:05 INFO Epoch 006 | train_mse=0.121326 | val_loss=0.180418 | best_val_loss=0.209302
Metric tuning_rank_spearman improved by 0.026 >= min_delta = 0.0. New best score: 0.235
2025-12-24 14:15:16 INFO Epoch 007 | 25% complete (batch 181/724)
2025-12-24 14:15:19 INFO Epoch 007 | 50% complete (batch 362/724)
2025-12-24 14:15:22 INFO Epoch 007 | 75% complete (batch 543/724)
2025-12-24 14:15:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.512219
2025-12-24 14:15:41 INFO Tuning ranking metrics: regret=0.153697 spearman=0.170227 (groups=40, skipped=311)
2025-12-24 14:15:41 INFO Epoch 007 | train_mse=0.096953 | val_loss=0.114750 | best_val_loss=0.235319
2025-12-24 14:15:52 INFO Epoch 008 | 25% complete (batch 181/724)
2025-12-24 14:15:55 INFO Epoch 008 | 50% complete (batch 362/724)
2025-12-24 14:15:58 INFO Epoch 008 | 75% complete (batch 543/724)
2025-12-24 14:16:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.553897
2025-12-24 14:16:16 INFO Tuning ranking metrics: regret=0.148872 spearman=0.248474 (groups=40, skipped=311)
2025-12-24 14:16:16 INFO Epoch 008 | train_mse=0.118226 | val_loss=0.089884 | best_val_loss=0.235319
Metric tuning_rank_spearman improved by 0.013 >= min_delta = 0.0. New best score: 0.248
2025-12-24 14:16:27 INFO Epoch 009 | 25% complete (batch 181/724)
2025-12-24 14:16:30 INFO Epoch 009 | 50% complete (batch 362/724)
2025-12-24 14:16:34 INFO Epoch 009 | 75% complete (batch 543/724)
2025-12-24 14:16:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.569493
2025-12-24 14:16:52 INFO Tuning ranking metrics: regret=0.159148 spearman=0.174042 (groups=40, skipped=311)
2025-12-24 14:16:52 INFO Epoch 009 | train_mse=0.097181 | val_loss=0.076725 | best_val_loss=0.248474
2025-12-24 14:17:03 INFO Epoch 010 | 25% complete (batch 181/724)
2025-12-24 14:17:06 INFO Epoch 010 | 50% complete (batch 362/724)
2025-12-24 14:17:09 INFO Epoch 010 | 75% complete (batch 543/724)
2025-12-24 14:17:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.586455
2025-12-24 14:17:28 INFO Tuning ranking metrics: regret=0.135142 spearman=0.158295 (groups=40, skipped=311)
2025-12-24 14:17:28 INFO Epoch 010 | train_mse=0.095849 | val_loss=0.072580 | best_val_loss=0.248474
2025-12-24 14:17:38 INFO Epoch 011 | 25% complete (batch 181/724)
2025-12-24 14:17:42 INFO Epoch 011 | 50% complete (batch 362/724)
2025-12-24 14:17:45 INFO Epoch 011 | 75% complete (batch 543/724)
2025-12-24 14:17:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.597251
2025-12-24 14:18:03 INFO Tuning ranking metrics: regret=0.130885 spearman=0.233176 (groups=40, skipped=311)
2025-12-24 14:18:03 INFO Epoch 011 | train_mse=0.070401 | val_loss=0.069570 | best_val_loss=0.248474
2025-12-24 14:18:14 INFO Epoch 012 | 25% complete (batch 181/724)
2025-12-24 14:18:17 INFO Epoch 012 | 50% complete (batch 362/724)
2025-12-24 14:18:21 INFO Epoch 012 | 75% complete (batch 543/724)
2025-12-24 14:18:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.600122
2025-12-24 14:18:40 INFO Tuning ranking metrics: regret=0.131835 spearman=0.194805 (groups=40, skipped=311)
2025-12-24 14:18:40 INFO Epoch 012 | train_mse=0.065770 | val_loss=0.075988 | best_val_loss=0.248474
2025-12-24 14:18:51 INFO Epoch 013 | 25% complete (batch 181/724)
2025-12-24 14:18:54 INFO Epoch 013 | 50% complete (batch 362/724)
2025-12-24 14:18:57 INFO Epoch 013 | 75% complete (batch 543/724)
2025-12-24 14:19:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.611321
2025-12-24 14:19:16 INFO Tuning ranking metrics: regret=0.149025 spearman=0.177695 (groups=40, skipped=311)
2025-12-24 14:19:16 INFO Epoch 013 | train_mse=0.070602 | val_loss=0.071550 | best_val_loss=0.248474
2025-12-24 14:19:27 INFO Epoch 014 | 25% complete (batch 181/724)
2025-12-24 14:19:30 INFO Epoch 014 | 50% complete (batch 362/724)
2025-12-24 14:19:33 INFO Epoch 014 | 75% complete (batch 543/724)
2025-12-24 14:19:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.617140
2025-12-24 14:19:51 INFO Tuning ranking metrics: regret=0.131917 spearman=0.178436 (groups=40, skipped=311)
2025-12-24 14:19:51 INFO Epoch 014 | train_mse=0.070729 | val_loss=0.070344 | best_val_loss=0.248474
2025-12-24 14:20:02 INFO Epoch 015 | 25% complete (batch 181/724)
2025-12-24 14:20:05 INFO Epoch 015 | 50% complete (batch 362/724)
2025-12-24 14:20:08 INFO Epoch 015 | 75% complete (batch 543/724)
2025-12-24 14:20:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.624158
2025-12-24 14:20:27 INFO Tuning ranking metrics: regret=0.131917 spearman=0.170368 (groups=40, skipped=311)
2025-12-24 14:20:27 INFO Epoch 015 | train_mse=0.068598 | val_loss=0.069325 | best_val_loss=0.248474
2025-12-24 14:20:38 INFO Epoch 016 | 25% complete (batch 181/724)
2025-12-24 14:20:41 INFO Epoch 016 | 50% complete (batch 362/724)
2025-12-24 14:20:44 INFO Epoch 016 | 75% complete (batch 543/724)
2025-12-24 14:20:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.635048
2025-12-24 14:21:03 INFO Tuning ranking metrics: regret=0.134816 spearman=0.162711 (groups=40, skipped=311)
2025-12-24 14:21:03 INFO Epoch 016 | train_mse=0.064311 | val_loss=0.063964 | best_val_loss=0.248474
2025-12-24 14:21:14 INFO Epoch 017 | 25% complete (batch 181/724)
2025-12-24 14:21:18 INFO Epoch 017 | 50% complete (batch 362/724)
2025-12-24 14:21:21 INFO Epoch 017 | 75% complete (batch 543/724)
2025-12-24 14:21:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.640681
2025-12-24 14:21:40 INFO Tuning ranking metrics: regret=0.134816 spearman=0.155947 (groups=40, skipped=311)
2025-12-24 14:21:40 INFO Epoch 017 | train_mse=0.064304 | val_loss=0.061975 | best_val_loss=0.248474
2025-12-24 14:21:50 INFO Epoch 018 | 25% complete (batch 181/724)
2025-12-24 14:21:53 INFO Epoch 018 | 50% complete (batch 362/724)
2025-12-24 14:21:57 INFO Epoch 018 | 75% complete (batch 543/724)
2025-12-24 14:22:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.644912
2025-12-24 14:22:16 INFO Tuning ranking metrics: regret=0.156402 spearman=0.188496 (groups=40, skipped=311)
2025-12-24 14:22:16 INFO Epoch 018 | train_mse=0.058166 | val_loss=0.062691 | best_val_loss=0.248474
2025-12-24 14:22:27 INFO Epoch 019 | 25% complete (batch 181/724)
2025-12-24 14:22:30 INFO Epoch 019 | 50% complete (batch 362/724)
2025-12-24 14:22:33 INFO Epoch 019 | 75% complete (batch 543/724)
2025-12-24 14:22:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.648889
2025-12-24 14:22:52 INFO Tuning ranking metrics: regret=0.155334 spearman=0.189085 (groups=40, skipped=311)
2025-12-24 14:22:52 INFO Epoch 019 | train_mse=0.059033 | val_loss=0.061360 | best_val_loss=0.248474
2025-12-24 14:23:03 INFO Epoch 020 | 25% complete (batch 181/724)
2025-12-24 14:23:06 INFO Epoch 020 | 50% complete (batch 362/724)
2025-12-24 14:23:10 INFO Epoch 020 | 75% complete (batch 543/724)
2025-12-24 14:23:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.652686
2025-12-24 14:23:29 INFO Tuning ranking metrics: regret=0.155351 spearman=0.190958 (groups=40, skipped=311)
2025-12-24 14:23:29 INFO Epoch 020 | train_mse=0.059210 | val_loss=0.062853 | best_val_loss=0.248474
2025-12-24 14:23:40 INFO Epoch 021 | 25% complete (batch 181/724)
2025-12-24 14:23:43 INFO Epoch 021 | 50% complete (batch 362/724)
2025-12-24 14:23:46 INFO Epoch 021 | 75% complete (batch 543/724)
2025-12-24 14:23:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.658948
2025-12-24 14:24:05 INFO Tuning ranking metrics: regret=0.154788 spearman=0.215887 (groups=40, skipped=311)
2025-12-24 14:24:05 INFO Epoch 021 | train_mse=0.054952 | val_loss=0.061540 | best_val_loss=0.248474
2025-12-24 14:24:16 INFO Epoch 022 | 25% complete (batch 181/724)
2025-12-24 14:24:19 INFO Epoch 022 | 50% complete (batch 362/724)
2025-12-24 14:24:23 INFO Epoch 022 | 75% complete (batch 543/724)
2025-12-24 14:24:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.660850
2025-12-24 14:24:41 INFO Tuning ranking metrics: regret=0.156405 spearman=0.210601 (groups=40, skipped=311)
2025-12-24 14:24:41 INFO Epoch 022 | train_mse=0.054094 | val_loss=0.060065 | best_val_loss=0.248474
2025-12-24 14:24:52 INFO Epoch 023 | 25% complete (batch 181/724)
2025-12-24 14:24:56 INFO Epoch 023 | 50% complete (batch 362/724)
2025-12-24 14:24:59 INFO Epoch 023 | 75% complete (batch 543/724)
2025-12-24 14:25:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.624380
2025-12-24 14:25:18 INFO Tuning ranking metrics: regret=0.159855 spearman=0.152235 (groups=40, skipped=311)
2025-12-24 14:25:18 INFO Epoch 023 | train_mse=0.066467 | val_loss=0.102494 | best_val_loss=0.248474
2025-12-24 14:25:29 INFO Epoch 024 | 25% complete (batch 181/724)
2025-12-24 14:25:32 INFO Epoch 024 | 50% complete (batch 362/724)
2025-12-24 14:25:35 INFO Epoch 024 | 75% complete (batch 543/724)
2025-12-24 14:25:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.662291
2025-12-24 14:25:54 INFO Tuning ranking metrics: regret=0.156629 spearman=0.206585 (groups=40, skipped=311)
2025-12-24 14:25:54 INFO Epoch 024 | train_mse=0.049780 | val_loss=0.064413 | best_val_loss=0.248474
2025-12-24 14:26:05 INFO Epoch 025 | 25% complete (batch 181/724)
2025-12-24 14:26:08 INFO Epoch 025 | 50% complete (batch 362/724)
2025-12-24 14:26:12 INFO Epoch 025 | 75% complete (batch 543/724)
2025-12-24 14:26:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.670970
2025-12-24 14:26:31 INFO Tuning ranking metrics: regret=0.159317 spearman=0.146878 (groups=40, skipped=311)
2025-12-24 14:26:31 INFO Epoch 025 | train_mse=0.069447 | val_loss=0.057668 | best_val_loss=0.248474
2025-12-24 14:26:41 INFO Epoch 026 | 25% complete (batch 181/724)
2025-12-24 14:26:45 INFO Epoch 026 | 50% complete (batch 362/724)
2025-12-24 14:26:48 INFO Epoch 026 | 75% complete (batch 543/724)
2025-12-24 14:27:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.658030
2025-12-24 14:27:07 INFO Tuning ranking metrics: regret=0.139766 spearman=0.111293 (groups=40, skipped=311)
2025-12-24 14:27:07 INFO Epoch 026 | train_mse=0.058096 | val_loss=0.072863 | best_val_loss=0.248474
2025-12-24 14:27:17 INFO Epoch 027 | 25% complete (batch 181/724)
2025-12-24 14:27:21 INFO Epoch 027 | 50% complete (batch 362/724)
2025-12-24 14:27:24 INFO Epoch 027 | 75% complete (batch 543/724)
2025-12-24 14:27:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.679532
2025-12-24 14:27:43 INFO Tuning ranking metrics: regret=0.125481 spearman=0.169367 (groups=40, skipped=311)
2025-12-24 14:27:43 INFO Epoch 027 | train_mse=0.063932 | val_loss=0.055571 | best_val_loss=0.248474
2025-12-24 14:27:54 INFO Epoch 028 | 25% complete (batch 181/724)
2025-12-24 14:27:57 INFO Epoch 028 | 50% complete (batch 362/724)
2025-12-24 14:28:00 INFO Epoch 028 | 75% complete (batch 543/724)
2025-12-24 14:28:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.658686
2025-12-24 14:28:19 INFO Tuning ranking metrics: regret=0.137144 spearman=0.172045 (groups=40, skipped=311)
2025-12-24 14:28:19 INFO Epoch 028 | train_mse=0.061866 | val_loss=0.075648 | best_val_loss=0.248474
2025-12-24 14:28:31 INFO Epoch 029 | 25% complete (batch 181/724)
2025-12-24 14:28:34 INFO Epoch 029 | 50% complete (batch 362/724)
2025-12-24 14:28:38 INFO Epoch 029 | 75% complete (batch 543/724)
2025-12-24 14:28:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.649858
2025-12-24 14:28:57 INFO Tuning ranking metrics: regret=0.124413 spearman=0.164367 (groups=40, skipped=311)
2025-12-24 14:28:57 INFO Epoch 029 | train_mse=0.062281 | val_loss=0.087432 | best_val_loss=0.248474
2025-12-24 14:29:08 INFO Epoch 030 | 25% complete (batch 181/724)
2025-12-24 14:29:11 INFO Epoch 030 | 50% complete (batch 362/724)
2025-12-24 14:29:14 INFO Epoch 030 | 75% complete (batch 543/724)
2025-12-24 14:29:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.667162
2025-12-24 14:29:33 INFO Tuning ranking metrics: regret=0.142807 spearman=0.108415 (groups=40, skipped=311)
2025-12-24 14:29:33 INFO Epoch 030 | train_mse=0.052910 | val_loss=0.063591 | best_val_loss=0.248474
2025-12-24 14:29:44 INFO Epoch 031 | 25% complete (batch 181/724)
2025-12-24 14:29:48 INFO Epoch 031 | 50% complete (batch 362/724)
2025-12-24 14:29:51 INFO Epoch 031 | 75% complete (batch 543/724)
2025-12-24 14:30:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.679556
2025-12-24 14:30:10 INFO Tuning ranking metrics: regret=0.136517 spearman=0.180996 (groups=40, skipped=311)
2025-12-24 14:30:10 INFO Epoch 031 | train_mse=0.057308 | val_loss=0.059479 | best_val_loss=0.248474
2025-12-24 14:30:21 INFO Epoch 032 | 25% complete (batch 181/724)
2025-12-24 14:30:24 INFO Epoch 032 | 50% complete (batch 362/724)
2025-12-24 14:30:28 INFO Epoch 032 | 75% complete (batch 543/724)
2025-12-24 14:30:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.675153
2025-12-24 14:30:46 INFO Tuning ranking metrics: regret=0.122261 spearman=0.174010 (groups=40, skipped=311)
2025-12-24 14:30:46 INFO Epoch 032 | train_mse=0.045125 | val_loss=0.058999 | best_val_loss=0.248474
2025-12-24 14:30:57 INFO Epoch 033 | 25% complete (batch 181/724)
2025-12-24 14:31:00 INFO Epoch 033 | 50% complete (batch 362/724)
2025-12-24 14:31:03 INFO Epoch 033 | 75% complete (batch 543/724)
2025-12-24 14:31:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.654767
2025-12-24 14:31:22 INFO Tuning ranking metrics: regret=0.121192 spearman=0.176629 (groups=40, skipped=311)
2025-12-24 14:31:22 INFO Epoch 033 | train_mse=0.055256 | val_loss=0.082263 | best_val_loss=0.248474
2025-12-24 14:31:32 INFO Epoch 034 | 25% complete (batch 181/724)
2025-12-24 14:31:36 INFO Epoch 034 | 50% complete (batch 362/724)
2025-12-24 14:31:39 INFO Epoch 034 | 75% complete (batch 543/724)
2025-12-24 14:31:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.681101
2025-12-24 14:31:58 INFO Tuning ranking metrics: regret=0.122257 spearman=0.185974 (groups=40, skipped=311)
2025-12-24 14:31:58 INFO Epoch 034 | train_mse=0.059787 | val_loss=0.063853 | best_val_loss=0.248474
2025-12-24 14:32:09 INFO Epoch 035 | 25% complete (batch 181/724)
2025-12-24 14:32:12 INFO Epoch 035 | 50% complete (batch 362/724)
2025-12-24 14:32:16 INFO Epoch 035 | 75% complete (batch 543/724)
2025-12-24 14:32:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.610875
2025-12-24 14:32:35 INFO Tuning ranking metrics: regret=0.137352 spearman=0.159177 (groups=40, skipped=311)
2025-12-24 14:32:35 INFO Epoch 035 | train_mse=0.051962 | val_loss=0.132488 | best_val_loss=0.248474
2025-12-24 14:32:45 INFO Epoch 036 | 25% complete (batch 181/724)
2025-12-24 14:32:49 INFO Epoch 036 | 50% complete (batch 362/724)
2025-12-24 14:32:52 INFO Epoch 036 | 75% complete (batch 543/724)
2025-12-24 14:33:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.624472
2025-12-24 14:33:11 INFO Tuning ranking metrics: regret=0.138358 spearman=0.136775 (groups=40, skipped=311)
2025-12-24 14:33:11 INFO Epoch 036 | train_mse=0.055839 | val_loss=0.093999 | best_val_loss=0.248474
2025-12-24 14:33:22 INFO Epoch 037 | 25% complete (batch 181/724)
2025-12-24 14:33:25 INFO Epoch 037 | 50% complete (batch 362/724)
2025-12-24 14:33:29 INFO Epoch 037 | 75% complete (batch 543/724)
2025-12-24 14:33:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.614093
2025-12-24 14:33:47 INFO Tuning ranking metrics: regret=0.125922 spearman=0.114394 (groups=40, skipped=311)
2025-12-24 14:33:47 INFO Epoch 037 | train_mse=0.068013 | val_loss=0.131894 | best_val_loss=0.248474
2025-12-24 14:33:58 INFO Epoch 038 | 25% complete (batch 181/724)
2025-12-24 14:34:02 INFO Epoch 038 | 50% complete (batch 362/724)
2025-12-24 14:34:05 INFO Epoch 038 | 75% complete (batch 543/724)
2025-12-24 14:34:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.653264
2025-12-24 14:34:23 INFO Tuning ranking metrics: regret=0.136409 spearman=0.145016 (groups=40, skipped=311)
2025-12-24 14:34:23 INFO Epoch 038 | train_mse=0.075739 | val_loss=0.061938 | best_val_loss=0.248474
2025-12-24 14:34:34 INFO Epoch 039 | 25% complete (batch 181/724)
2025-12-24 14:34:37 INFO Epoch 039 | 50% complete (batch 362/724)
2025-12-24 14:34:41 INFO Epoch 039 | 75% complete (batch 543/724)
2025-12-24 14:34:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.674507
2025-12-24 14:35:00 INFO Tuning ranking metrics: regret=0.124416 spearman=0.176353 (groups=40, skipped=311)
2025-12-24 14:35:00 INFO Epoch 039 | train_mse=0.066239 | val_loss=0.067165 | best_val_loss=0.248474
2025-12-24 14:35:11 INFO Epoch 040 | 25% complete (batch 181/724)
2025-12-24 14:35:15 INFO Epoch 040 | 50% complete (batch 362/724)
2025-12-24 14:35:18 INFO Epoch 040 | 75% complete (batch 543/724)
2025-12-24 14:35:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.683151
2025-12-24 14:35:38 INFO Tuning ranking metrics: regret=0.122179 spearman=0.227284 (groups=40, skipped=311)
2025-12-24 14:35:38 INFO Epoch 040 | train_mse=0.049934 | val_loss=0.052086 | best_val_loss=0.248474
2025-12-24 14:35:48 INFO Epoch 041 | 25% complete (batch 181/724)
2025-12-24 14:35:52 INFO Epoch 041 | 50% complete (batch 362/724)
2025-12-24 14:35:55 INFO Epoch 041 | 75% complete (batch 543/724)
2025-12-24 14:36:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.694969
2025-12-24 14:36:14 INFO Tuning ranking metrics: regret=0.136458 spearman=0.184448 (groups=40, skipped=311)
2025-12-24 14:36:14 INFO Epoch 041 | train_mse=0.051052 | val_loss=0.060793 | best_val_loss=0.248474
2025-12-24 14:36:25 INFO Epoch 042 | 25% complete (batch 181/724)
2025-12-24 14:36:28 INFO Epoch 042 | 50% complete (batch 362/724)
2025-12-24 14:36:32 INFO Epoch 042 | 75% complete (batch 543/724)
2025-12-24 14:36:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.684502
2025-12-24 14:36:51 INFO Tuning ranking metrics: regret=0.135389 spearman=0.169194 (groups=40, skipped=311)
2025-12-24 14:36:51 INFO Epoch 042 | train_mse=0.056244 | val_loss=0.061085 | best_val_loss=0.248474
2025-12-24 14:37:02 INFO Epoch 043 | 25% complete (batch 181/724)
2025-12-24 14:37:05 INFO Epoch 043 | 50% complete (batch 362/724)
2025-12-24 14:37:08 INFO Epoch 043 | 75% complete (batch 543/724)
2025-12-24 14:37:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.698033
2025-12-24 14:37:27 INFO Tuning ranking metrics: regret=0.141670 spearman=0.080022 (groups=40, skipped=311)
2025-12-24 14:37:27 INFO Epoch 043 | train_mse=0.050245 | val_loss=0.058239 | best_val_loss=0.248474
2025-12-24 14:37:38 INFO Epoch 044 | 25% complete (batch 181/724)
2025-12-24 14:37:42 INFO Epoch 044 | 50% complete (batch 362/724)
2025-12-24 14:37:45 INFO Epoch 044 | 75% complete (batch 543/724)
2025-12-24 14:37:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.698409
2025-12-24 14:38:04 INFO Tuning ranking metrics: regret=0.141670 spearman=0.086034 (groups=40, skipped=311)
2025-12-24 14:38:04 INFO Epoch 044 | train_mse=0.049830 | val_loss=0.061994 | best_val_loss=0.248474
2025-12-24 14:38:15 INFO Epoch 045 | 25% complete (batch 181/724)
2025-12-24 14:38:18 INFO Epoch 045 | 50% complete (batch 362/724)
2025-12-24 14:38:22 INFO Epoch 045 | 75% complete (batch 543/724)
2025-12-24 14:38:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.707296
2025-12-24 14:38:41 INFO Tuning ranking metrics: regret=0.113434 spearman=0.081964 (groups=40, skipped=311)
2025-12-24 14:38:41 INFO Epoch 045 | train_mse=0.056834 | val_loss=0.051693 | best_val_loss=0.248474
2025-12-24 14:38:52 INFO Epoch 046 | 25% complete (batch 181/724)
2025-12-24 14:38:55 INFO Epoch 046 | 50% complete (batch 362/724)
2025-12-24 14:38:59 INFO Epoch 046 | 75% complete (batch 543/724)
2025-12-24 14:39:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.686213
2025-12-24 14:39:18 INFO Tuning ranking metrics: regret=0.137843 spearman=0.138350 (groups=40, skipped=311)
2025-12-24 14:39:18 INFO Epoch 046 | train_mse=0.051452 | val_loss=0.072650 | best_val_loss=0.248474
2025-12-24 14:39:29 INFO Epoch 047 | 25% complete (batch 181/724)
2025-12-24 14:39:33 INFO Epoch 047 | 50% complete (batch 362/724)
2025-12-24 14:39:36 INFO Epoch 047 | 75% complete (batch 543/724)
2025-12-24 14:39:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.690424
2025-12-24 14:39:55 INFO Tuning ranking metrics: regret=0.105940 spearman=0.172738 (groups=40, skipped=311)
2025-12-24 14:39:55 INFO Epoch 047 | train_mse=0.045814 | val_loss=0.072565 | best_val_loss=0.248474
2025-12-24 14:40:06 INFO Epoch 048 | 25% complete (batch 181/724)
2025-12-24 14:40:09 INFO Epoch 048 | 50% complete (batch 362/724)
2025-12-24 14:40:12 INFO Epoch 048 | 75% complete (batch 543/724)
2025-12-24 14:40:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.689074
2025-12-24 14:40:31 INFO Tuning ranking metrics: regret=0.125800 spearman=0.121315 (groups=40, skipped=311)
2025-12-24 14:40:31 INFO Epoch 048 | train_mse=0.063248 | val_loss=0.063235 | best_val_loss=0.248474
2025-12-24 14:40:42 INFO Epoch 049 | 25% complete (batch 181/724)
2025-12-24 14:40:45 INFO Epoch 049 | 50% complete (batch 362/724)
2025-12-24 14:40:49 INFO Epoch 049 | 75% complete (batch 543/724)
2025-12-24 14:41:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.703516
2025-12-24 14:41:08 INFO Tuning ranking metrics: regret=0.111834 spearman=0.118366 (groups=40, skipped=311)
2025-12-24 14:41:08 INFO Epoch 049 | train_mse=0.055784 | val_loss=0.056447 | best_val_loss=0.248474
2025-12-24 14:41:19 INFO Epoch 050 | 25% complete (batch 181/724)
2025-12-24 14:41:22 INFO Epoch 050 | 50% complete (batch 362/724)
2025-12-24 14:41:25 INFO Epoch 050 | 75% complete (batch 543/724)
2025-12-24 14:41:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.704530
2025-12-24 14:41:44 INFO Tuning ranking metrics: regret=0.113416 spearman=0.103663 (groups=40, skipped=311)
2025-12-24 14:41:44 INFO Epoch 050 | train_mse=0.053744 | val_loss=0.052194 | best_val_loss=0.248474
2025-12-24 14:41:55 INFO Epoch 051 | 25% complete (batch 181/724)
2025-12-24 14:41:59 INFO Epoch 051 | 50% complete (batch 362/724)
2025-12-24 14:42:02 INFO Epoch 051 | 75% complete (batch 543/724)
2025-12-24 14:42:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.710738
2025-12-24 14:42:21 INFO Tuning ranking metrics: regret=0.139484 spearman=0.123539 (groups=40, skipped=311)
2025-12-24 14:42:21 INFO Epoch 051 | train_mse=0.057632 | val_loss=0.050869 | best_val_loss=0.248474
2025-12-24 14:42:32 INFO Epoch 052 | 25% complete (batch 181/724)
2025-12-24 14:42:36 INFO Epoch 052 | 50% complete (batch 362/724)
2025-12-24 14:42:39 INFO Epoch 052 | 75% complete (batch 543/724)
2025-12-24 14:42:53 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.711247
2025-12-24 14:42:58 INFO Tuning ranking metrics: regret=0.127115 spearman=0.106829 (groups=40, skipped=311)
2025-12-24 14:42:58 INFO Epoch 052 | train_mse=0.049625 | val_loss=0.051126 | best_val_loss=0.248474
2025-12-24 14:43:09 INFO Epoch 053 | 25% complete (batch 181/724)
2025-12-24 14:43:13 INFO Epoch 053 | 50% complete (batch 362/724)
2025-12-24 14:43:17 INFO Epoch 053 | 75% complete (batch 543/724)
2025-12-24 14:43:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.694684
2025-12-24 14:43:36 INFO Tuning ranking metrics: regret=0.122709 spearman=0.192359 (groups=40, skipped=311)
2025-12-24 14:43:36 INFO Epoch 053 | train_mse=0.046962 | val_loss=0.071750 | best_val_loss=0.248474
2025-12-24 14:43:47 INFO Epoch 054 | 25% complete (batch 181/724)
2025-12-24 14:43:50 INFO Epoch 054 | 50% complete (batch 362/724)
2025-12-24 14:43:54 INFO Epoch 054 | 75% complete (batch 543/724)
2025-12-24 14:44:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.687226
2025-12-24 14:44:13 INFO Tuning ranking metrics: regret=0.126047 spearman=0.108295 (groups=40, skipped=311)
2025-12-24 14:44:13 INFO Epoch 054 | train_mse=0.054772 | val_loss=0.059749 | best_val_loss=0.248474
2025-12-24 14:44:24 INFO Epoch 055 | 25% complete (batch 181/724)
2025-12-24 14:44:27 INFO Epoch 055 | 50% complete (batch 362/724)
2025-12-24 14:44:31 INFO Epoch 055 | 75% complete (batch 543/724)
2025-12-24 14:44:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.707884
2025-12-24 14:44:50 INFO Tuning ranking metrics: regret=0.126472 spearman=0.107202 (groups=40, skipped=311)
2025-12-24 14:44:50 INFO Epoch 055 | train_mse=0.050896 | val_loss=0.055680 | best_val_loss=0.248474
2025-12-24 14:45:01 INFO Epoch 056 | 25% complete (batch 181/724)
2025-12-24 14:45:04 INFO Epoch 056 | 50% complete (batch 362/724)
2025-12-24 14:45:07 INFO Epoch 056 | 75% complete (batch 543/724)
2025-12-24 14:45:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.690526
2025-12-24 14:45:27 INFO Tuning ranking metrics: regret=0.126472 spearman=0.082013 (groups=40, skipped=311)
2025-12-24 14:45:27 INFO Epoch 056 | train_mse=0.050897 | val_loss=0.072607 | best_val_loss=0.248474
2025-12-24 14:45:38 INFO Epoch 057 | 25% complete (batch 181/724)
2025-12-24 14:45:41 INFO Epoch 057 | 50% complete (batch 362/724)
2025-12-24 14:45:44 INFO Epoch 057 | 75% complete (batch 543/724)
2025-12-24 14:45:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.671022
2025-12-24 14:46:03 INFO Tuning ranking metrics: regret=0.139669 spearman=0.107495 (groups=40, skipped=311)
2025-12-24 14:46:03 INFO Epoch 057 | train_mse=0.046994 | val_loss=0.080420 | best_val_loss=0.248474
2025-12-24 14:46:14 INFO Epoch 058 | 25% complete (batch 181/724)
2025-12-24 14:46:17 INFO Epoch 058 | 50% complete (batch 362/724)
2025-12-24 14:46:21 INFO Epoch 058 | 75% complete (batch 543/724)
2025-12-24 14:46:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.705489
2025-12-24 14:46:40 INFO Tuning ranking metrics: regret=0.124009 spearman=0.154800 (groups=40, skipped=311)
2025-12-24 14:46:40 INFO Epoch 058 | train_mse=0.068174 | val_loss=0.060516 | best_val_loss=0.248474
Monitored metric tuning_rank_spearman did not improve in the last 50 records. Best score: 0.248. Signaling Trainer to stop.
2025-12-24 14:46:41 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.23318_val-0.06957_epoch011.chkpt, checkpoint.tuning_rank_spearman-0.23532_val-0.18042_epoch006.chkpt, checkpoint.tuning_rank_spearman-0.24847_val-0.08988_epoch008.chkpt
2025-12-24 14:46:41 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-24_14-10-47/model_checkpoints/checkpoint.tuning_rank_spearman-0.24847_val-0.08988_epoch008.chkpt
2025-12-24 14:46:41 INFO Best validation loss: tensor(0.2485)
2025-12-24 14:46:41 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-24_14-10-47/model_checkpoints/checkpoint.tuning_rank_spearman-0.24847_val-0.08988_epoch008.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-24_14-10-47/model_checkpoints/checkpoint.tuning_rank_spearman-0.24847_val-0.08988_epoch008.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-24 14:46:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.089884
2025-12-24 14:46:56 INFO Tuning ranking metrics: regret=0.148872 spearman=0.248474 (groups=40, skipped=311)
2025-12-24 14:46:56 INFO Epoch 059 | val_loss=0.089884 | best_val_loss=0.248474
2025-12-24 14:46:57 INFO Validation metrics: [{'val_loss': 0.08988387882709503, 'tuning_rank_regret': 0.14887157082557678, 'tuning_rank_spearman': 0.24847403168678284, 'val_pearson_corr': 0.684458315372467, 'val_spearman_corr': 0.6462175846099854, 'val_rank_regret': 0.30908140540122986, 'val_rank_spearman': 0.12554112076759338}]
2025-12-24 14:46:57 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.24847_val-0.08988_epoch008.chkpt
2025-12-24 14:46:57 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.23532_val-0.18042_epoch006.chkpt
2025-12-24 14:46:57 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.23318_val-0.06957_epoch011.chkpt
2025-12-24 14:46:57 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.11475_epoch007.ckpt
2025-12-24 14:46:57 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.14887157082557678
  tuning_rank_spearman      0.24847403168678284
        val_loss            0.08988387882709503
    val_pearson_corr         0.684458315372467
     val_rank_regret        0.30908140540122986
    val_rank_spearman       0.12554112076759338
    val_spearman_corr       0.6462175846099854
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run polish_lr_low_seed888_2025-12-24_14-10-47 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-24_14-10-47
[train_cli][batch] job 'polish_lr_low_seed888' finished.
[run_full_pipeline] Best run: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07 (tuning_rank_spearman=0.20233415067195892)
[run_full_pipeline] Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07/model_checkpoints/checkpoint.tuning_rank_spearman-0.20233_val-0.07235_epoch032.chkpt
[run_full_pipeline] Phase 1 fine-tuning -> polish_seed101_2025-12-24_11-12-07_phase1
[train_cli] run_id=polish_seed101_2025-12-24_11-12-07_phase1 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase1/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase1 --git-commit 9b1bb2b320 --git-dirty --resume-from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07/model_checkpoints/checkpoint.tuning_rank_spearman-0.20233_val-0.07235_epoch032.chkpt
2025-12-24 14:47:03 INFO git_commit = 9b1bb2b320 (dirty)
2025-12-24 14:47:03 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-24 14:47:03 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase1/config/config.yaml
2025-12-24 14:47:03 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data
2025-12-24 14:47:03 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-24 14:47:03 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-24 14:47:03 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase1
2025-12-24 14:47:03 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-24 14:47:03 INFO   metadata_path = None
2025-12-24 14:47:03 INFO   summary_path = None
2025-12-24 14:47:03 INFO   accelerator = cpu
2025-12-24 14:47:03 INFO   devices = 1
2025-12-24 14:47:03 INFO   attention_head = 8
2025-12-24 14:47:03 INFO   pooling_type = mean
2025-12-24 14:47:03 INFO   model_self_loops = False
2025-12-24 14:47:03 INFO   model_self_loop_fill = mean
2025-12-24 14:47:03 INFO   model_residual = False
2025-12-24 14:47:03 INFO   batch_size = 48
2025-12-24 14:47:03 INFO   learning_rate = 0.001
2025-12-24 14:47:03 INFO   num_epochs = 320
2025-12-24 14:47:03 INFO   accumulate_grad_batches = 8
2025-12-24 14:47:03 INFO   seed = 222
2025-12-24 14:47:03 INFO   num_workers = 2
2025-12-24 14:47:03 INFO   precision = 32
2025-12-24 14:47:03 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-24 14:47:03 INFO   early_stopping_patience = 20
2025-12-24 14:47:03 INFO   lr_scheduler_patience = 4
2025-12-24 14:47:03 INFO   lr_scheduler_factor = 0.2
2025-12-24 14:47:03 INFO   fast_dev_run = False
2025-12-24 14:47:03 INFO   limit_train_batches = None
2025-12-24 14:47:03 INFO   limit_val_batches = None
2025-12-24 14:47:03 INFO   log_lr = False
2025-12-24 14:47:03 INFO   progress_bar_refresh_rate = 0
2025-12-24 14:47:03 INFO   log_every_n_steps = 100
2025-12-24 14:47:03 INFO   use_val_spearman_as_secondary = True
2025-12-24 14:47:03 INFO   spearman_secondary_min_delta = 0.0
2025-12-24 14:47:03 INFO   spearman_secondary_weight = 1.0
2025-12-24 14:47:03 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-24 14:47:03 INFO   tuning_max_samples = 500
2025-12-24 14:47:03 INFO   tuning_fraction = None
2025-12-24 14:47:03 INFO   tuning_eval_every = 1
2025-12-24 14:47:03 INFO   rank_loss_weight = 0.0
2025-12-24 14:47:03 INFO   rank_loss_margin = 0.0
2025-12-24 14:47:03 INFO   rank_loss_mode = hinge
2025-12-24 14:47:03 INFO   rank_loss_grouped = True
2025-12-24 14:47:03 INFO   variance_reduction_enabled = False
2025-12-24 14:47:03 INFO   variance_reduction_method = topk_avg
2025-12-24 14:47:03 INFO   variance_reduction_top_k = 3
2025-12-24 14:47:03 INFO   coverage_minimum = 0.0
2025-12-24 14:47:03 INFO   coverage_fail_on_missing = False
2025-12-24 14:47:03 INFO   graph_load_profiling = False
2025-12-24 14:47:03 INFO   graph_load_top_k = 5
2025-12-24 14:47:03 INFO   enable_graph_cache = True
2025-12-24 14:47:03 INFO   graph_cache_size = 256
2025-12-24 14:47:03 INFO   canonicalize_on_load = False
2025-12-24 14:47:03 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-24 14:47:03 INFO   edge_schema = {}
2025-12-24 14:47:03 INFO   topology_schema = {}
Seed set to 222
2025-12-24 14:47:04 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-24 14:47:04 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 14:47:04 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-24 14:47:04 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 14:47:04 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-24 14:47:04 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 14:47:06 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-24 14:47:06 INFO Tuning group stats: groups=352 groups>=2=34 singletons=318 max_group=11
2025-12-24 14:47:06 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase1/dataset_coverage.json
2025-12-24 14:47:06 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase1/dataset_coverage.json for details.
2025-12-24 14:47:06 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase1/dataset_coverage.json for details.
2025-12-24 14:47:06 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase1/dataset_coverage.json for details.
2025-12-24 14:47:06 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase1/schema_summary.json
2025-12-24 14:47:06 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase1/feature_metadata.json
2025-12-24 14:47:06 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-24 14:47:06 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/advanced_k_partite_v2/feature-config.yaml.advanced_lean.10A.v2, sha256=2022a36e7b21668173af3af66c25cf6b6a0494e642c0934eac38abbcfeebec3d
2025-12-24 14:47:06 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/work/edge_features)
2025-12-24 14:47:06 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json
2025-12-24 14:47:06 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase1/schema_summary.json
2025-12-24 14:47:06 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-24 14:47:06 INFO Topology: topology/persistence_k_partite_advanced/v2 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 628-dimensional node features.
2025-12-24 14:47:06 INFO Node: node/dssp_topo_merge_passthrough/v1; metadata lists 628 feature columns matching the .pt tensor.
2025-12-24 14:47:06 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-24 14:47:06 INFO → Total feature dimensionality observed and confirmed: node_dim = 628, edge_dim = 11.
2025-12-24 14:47:06 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-24 14:47:06 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 628,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge_passthrough/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 628,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase1/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge_passthrough/v1",
      "alias": "Passthrough (all dims from topology module) = Node Dynamic Dims",
      "jobs": 16,
      "summary": "DSSP/basic features merged with all topology columns (passthrough)."
    },
    "topology": {
      "id": "topology/persistence_k_partite_advanced/v2",
      "alias": "Advanced k-partite PH (v2 lean) topo_dim 596",
      "jobs": 16,
      "summary": "Fixed-width k-partite persistent homology with slot padding + missingness channels."
    }
  },
  "notes": []
}
2025-12-24 14:47:06 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-24 14:47:06 INFO Resuming from checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07/model_checkpoints/checkpoint.tuning_rank_spearman-0.20233_val-0.07235_epoch032.chkpt (epoch=32)
2025-12-24 14:47:06 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=9751695dffbb45768934d6160d88259f)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-24 14:47:06 INFO Starting training (fast_dev_run=False)
2025-12-24 14:47:06 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase1/model_checkpoints exists and is not empty.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07/model_checkpoints/checkpoint.tuning_rank_spearman-0.20233_val-0.07235_epoch032.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07/model_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase1/model_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07/model_checkpoints/val_loss_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase1/model_checkpoints/val_loss_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 20.1 K | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
180 K     Trainable params
0         Non-trainable params
180 K     Total params
0.721     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
Restored all states from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07/model_checkpoints/checkpoint.tuning_rank_spearman-0.20233_val-0.07235_epoch032.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-24 14:47:21 INFO Epoch 033 | 25% complete (batch 46/181)
2025-12-24 14:47:21 INFO Epoch 033 | 50% complete (batch 91/181)
2025-12-24 14:47:22 INFO Epoch 033 | 75% complete (batch 136/181)
2025-12-24 14:47:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.073962
2025-12-24 14:47:36 INFO Tuning ranking metrics: regret=0.087394 spearman=0.064235 (groups=34, skipped=318)
2025-12-24 14:47:36 INFO Epoch 033 | val_loss=0.073962
2025-12-24 14:47:44 INFO Epoch 034 | 25% complete (batch 46/181)
2025-12-24 14:47:45 INFO Epoch 034 | 50% complete (batch 91/181)
2025-12-24 14:47:46 INFO Epoch 034 | 75% complete (batch 136/181)
2025-12-24 14:47:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.681785
2025-12-24 14:48:00 INFO Tuning ranking metrics: regret=0.129781 spearman=0.035065 (groups=34, skipped=318)
2025-12-24 14:48:00 INFO Epoch 034 | train_mse=0.091940 | val_loss=0.083530 | best_val_loss=0.064235
2025-12-24 14:48:08 INFO Epoch 035 | 25% complete (batch 46/181)
2025-12-24 14:48:09 INFO Epoch 035 | 50% complete (batch 91/181)
2025-12-24 14:48:10 INFO Epoch 035 | 75% complete (batch 136/181)
2025-12-24 14:48:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.634526
2025-12-24 14:48:23 INFO Tuning ranking metrics: regret=0.128361 spearman=0.018481 (groups=34, skipped=318)
2025-12-24 14:48:23 INFO Epoch 035 | train_mse=0.084324 | val_loss=0.118549 | best_val_loss=0.064235
2025-12-24 14:48:32 INFO Epoch 036 | 25% complete (batch 46/181)
2025-12-24 14:48:33 INFO Epoch 036 | 50% complete (batch 91/181)
2025-12-24 14:48:33 INFO Epoch 036 | 75% complete (batch 136/181)
2025-12-24 14:48:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.661591
2025-12-24 14:48:47 INFO Tuning ranking metrics: regret=0.127668 spearman=0.008282 (groups=34, skipped=318)
2025-12-24 14:48:47 INFO Epoch 036 | train_mse=0.089342 | val_loss=0.102936 | best_val_loss=0.064235
2025-12-24 14:48:56 INFO Epoch 037 | 25% complete (batch 46/181)
2025-12-24 14:48:56 INFO Epoch 037 | 50% complete (batch 91/181)
2025-12-24 14:48:57 INFO Epoch 037 | 75% complete (batch 136/181)
2025-12-24 14:49:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.678867
2025-12-24 14:49:11 INFO Tuning ranking metrics: regret=0.130448 spearman=0.049847 (groups=34, skipped=318)
2025-12-24 14:49:11 INFO Epoch 037 | train_mse=0.093785 | val_loss=0.063007 | best_val_loss=0.064235
2025-12-24 14:49:19 INFO Epoch 038 | 25% complete (batch 46/181)
2025-12-24 14:49:20 INFO Epoch 038 | 50% complete (batch 91/181)
2025-12-24 14:49:21 INFO Epoch 038 | 75% complete (batch 136/181)
2025-12-24 14:49:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.684620
2025-12-24 14:49:35 INFO Tuning ranking metrics: regret=0.129447 spearman=0.043188 (groups=34, skipped=318)
2025-12-24 14:49:35 INFO Epoch 038 | train_mse=0.092364 | val_loss=0.067449 | best_val_loss=0.064235
2025-12-24 14:49:43 INFO Epoch 039 | 25% complete (batch 46/181)
2025-12-24 14:49:44 INFO Epoch 039 | 50% complete (batch 91/181)
2025-12-24 14:49:45 INFO Epoch 039 | 75% complete (batch 136/181)
2025-12-24 14:49:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.663427
2025-12-24 14:49:59 INFO Tuning ranking metrics: regret=0.130551 spearman=0.042125 (groups=34, skipped=318)
2025-12-24 14:49:59 INFO Epoch 039 | train_mse=0.069253 | val_loss=0.093672 | best_val_loss=0.064235
2025-12-24 14:50:07 INFO Epoch 040 | 25% complete (batch 46/181)
2025-12-24 14:50:08 INFO Epoch 040 | 50% complete (batch 91/181)
2025-12-24 14:50:09 INFO Epoch 040 | 75% complete (batch 136/181)
2025-12-24 14:50:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.666108
2025-12-24 14:50:23 INFO Tuning ranking metrics: regret=0.133071 spearman=-0.037191 (groups=34, skipped=318)
2025-12-24 14:50:23 INFO Epoch 040 | train_mse=0.071237 | val_loss=0.088946 | best_val_loss=0.064235
2025-12-24 14:50:31 INFO Epoch 041 | 25% complete (batch 46/181)
2025-12-24 14:50:32 INFO Epoch 041 | 50% complete (batch 91/181)
2025-12-24 14:50:33 INFO Epoch 041 | 75% complete (batch 136/181)
2025-12-24 14:50:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.678257
2025-12-24 14:50:47 INFO Tuning ranking metrics: regret=0.105030 spearman=0.012299 (groups=34, skipped=318)
2025-12-24 14:50:47 INFO Epoch 041 | train_mse=0.084694 | val_loss=0.073946 | best_val_loss=0.064235
2025-12-24 14:50:55 INFO Epoch 042 | 25% complete (batch 46/181)
2025-12-24 14:50:56 INFO Epoch 042 | 50% complete (batch 91/181)
2025-12-24 14:50:57 INFO Epoch 042 | 75% complete (batch 136/181)
2025-12-24 14:51:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.701081
2025-12-24 14:51:11 INFO Tuning ranking metrics: regret=0.111267 spearman=-0.014025 (groups=34, skipped=318)
2025-12-24 14:51:11 INFO Epoch 042 | train_mse=0.097447 | val_loss=0.060763 | best_val_loss=0.064235
2025-12-24 14:51:19 INFO Epoch 043 | 25% complete (batch 46/181)
2025-12-24 14:51:20 INFO Epoch 043 | 50% complete (batch 91/181)
2025-12-24 14:51:21 INFO Epoch 043 | 75% complete (batch 136/181)
2025-12-24 14:51:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.687217
2025-12-24 14:51:35 INFO Tuning ranking metrics: regret=0.091962 spearman=-0.039540 (groups=34, skipped=318)
2025-12-24 14:51:35 INFO Epoch 043 | train_mse=0.072377 | val_loss=0.060962 | best_val_loss=0.064235
2025-12-24 14:51:43 INFO Epoch 044 | 25% complete (batch 46/181)
2025-12-24 14:51:44 INFO Epoch 044 | 50% complete (batch 91/181)
2025-12-24 14:51:45 INFO Epoch 044 | 75% complete (batch 136/181)
2025-12-24 14:51:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.697791
2025-12-24 14:51:59 INFO Tuning ranking metrics: regret=0.105159 spearman=0.014031 (groups=34, skipped=318)
2025-12-24 14:51:59 INFO Epoch 044 | train_mse=0.065277 | val_loss=0.058168 | best_val_loss=0.064235
2025-12-24 14:52:07 INFO Epoch 045 | 25% complete (batch 46/181)
2025-12-24 14:52:08 INFO Epoch 045 | 50% complete (batch 91/181)
2025-12-24 14:52:09 INFO Epoch 045 | 75% complete (batch 136/181)
2025-12-24 14:52:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.699874
2025-12-24 14:52:23 INFO Tuning ranking metrics: regret=0.085854 spearman=-0.004641 (groups=34, skipped=318)
2025-12-24 14:52:23 INFO Epoch 045 | train_mse=0.070374 | val_loss=0.060981 | best_val_loss=0.064235
2025-12-24 14:52:31 INFO Epoch 046 | 25% complete (batch 46/181)
2025-12-24 14:52:32 INFO Epoch 046 | 50% complete (batch 91/181)
2025-12-24 14:52:33 INFO Epoch 046 | 75% complete (batch 136/181)
2025-12-24 14:52:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.692053
2025-12-24 14:52:46 INFO Tuning ranking metrics: regret=0.086545 spearman=-0.043882 (groups=34, skipped=318)
2025-12-24 14:52:46 INFO Epoch 046 | train_mse=0.061965 | val_loss=0.067477 | best_val_loss=0.064235
2025-12-24 14:52:55 INFO Epoch 047 | 25% complete (batch 46/181)
2025-12-24 14:52:56 INFO Epoch 047 | 50% complete (batch 91/181)
2025-12-24 14:52:57 INFO Epoch 047 | 75% complete (batch 136/181)
2025-12-24 14:53:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.652272
2025-12-24 14:53:10 INFO Tuning ranking metrics: regret=0.091958 spearman=-0.048383 (groups=34, skipped=318)
2025-12-24 14:53:10 INFO Epoch 047 | train_mse=0.053968 | val_loss=0.104692 | best_val_loss=0.064235
2025-12-24 14:53:19 INFO Epoch 048 | 25% complete (batch 46/181)
2025-12-24 14:53:19 INFO Epoch 048 | 50% complete (batch 91/181)
2025-12-24 14:53:20 INFO Epoch 048 | 75% complete (batch 136/181)
2025-12-24 14:53:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.674649
2025-12-24 14:53:34 INFO Tuning ranking metrics: regret=0.104334 spearman=-0.001942 (groups=34, skipped=318)
2025-12-24 14:53:34 INFO Epoch 048 | train_mse=0.061577 | val_loss=0.073144 | best_val_loss=0.064235
2025-12-24 14:53:43 INFO Epoch 049 | 25% complete (batch 46/181)
2025-12-24 14:53:44 INFO Epoch 049 | 50% complete (batch 91/181)
2025-12-24 14:53:45 INFO Epoch 049 | 75% complete (batch 136/181)
2025-12-24 14:53:53 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.684518
2025-12-24 14:53:58 INFO Tuning ranking metrics: regret=0.104114 spearman=-0.035651 (groups=34, skipped=318)
2025-12-24 14:53:58 INFO Epoch 049 | train_mse=0.086371 | val_loss=0.061079 | best_val_loss=0.064235
2025-12-24 14:54:07 INFO Epoch 050 | 25% complete (batch 46/181)
2025-12-24 14:54:08 INFO Epoch 050 | 50% complete (batch 91/181)
2025-12-24 14:54:09 INFO Epoch 050 | 75% complete (batch 136/181)
2025-12-24 14:54:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.664713
2025-12-24 14:54:23 INFO Tuning ranking metrics: regret=0.103119 spearman=-0.021734 (groups=34, skipped=318)
2025-12-24 14:54:23 INFO Epoch 050 | train_mse=0.071615 | val_loss=0.084807 | best_val_loss=0.064235
2025-12-24 14:54:31 INFO Epoch 051 | 25% complete (batch 46/181)
2025-12-24 14:54:32 INFO Epoch 051 | 50% complete (batch 91/181)
2025-12-24 14:54:33 INFO Epoch 051 | 75% complete (batch 136/181)
2025-12-24 14:54:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.664075
2025-12-24 14:54:47 INFO Tuning ranking metrics: regret=0.111815 spearman=-0.012802 (groups=34, skipped=318)
2025-12-24 14:54:47 INFO Epoch 051 | train_mse=0.080712 | val_loss=0.062943 | best_val_loss=0.064235
2025-12-24 14:54:55 INFO Epoch 052 | 25% complete (batch 46/181)
2025-12-24 14:54:56 INFO Epoch 052 | 50% complete (batch 91/181)
2025-12-24 14:54:57 INFO Epoch 052 | 75% complete (batch 136/181)
2025-12-24 14:55:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.670376
2025-12-24 14:55:11 INFO Tuning ranking metrics: regret=0.091047 spearman=-0.054698 (groups=34, skipped=318)
2025-12-24 14:55:11 INFO Epoch 052 | train_mse=0.085878 | val_loss=0.087729 | best_val_loss=0.064235
2025-12-24 14:55:19 INFO Epoch 053 | 25% complete (batch 46/181)
2025-12-24 14:55:20 INFO Epoch 053 | 50% complete (batch 91/181)
2025-12-24 14:55:21 INFO Epoch 053 | 75% complete (batch 136/181)
2025-12-24 14:55:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.680542
2025-12-24 14:55:35 INFO Tuning ranking metrics: regret=0.083625 spearman=0.039095 (groups=34, skipped=318)
2025-12-24 14:55:35 INFO Epoch 053 | train_mse=0.069717 | val_loss=0.064434 | best_val_loss=0.064235
2025-12-24 14:55:44 INFO Epoch 054 | 25% complete (batch 46/181)
2025-12-24 14:55:45 INFO Epoch 054 | 50% complete (batch 91/181)
2025-12-24 14:55:46 INFO Epoch 054 | 75% complete (batch 136/181)
2025-12-24 14:55:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.688369
2025-12-24 14:55:59 INFO Tuning ranking metrics: regret=0.088813 spearman=0.034116 (groups=34, skipped=318)
2025-12-24 14:55:59 INFO Epoch 054 | train_mse=0.073921 | val_loss=0.087007 | best_val_loss=0.064235
2025-12-24 14:56:08 INFO Epoch 055 | 25% complete (batch 46/181)
2025-12-24 14:56:09 INFO Epoch 055 | 50% complete (batch 91/181)
2025-12-24 14:56:09 INFO Epoch 055 | 75% complete (batch 136/181)
2025-12-24 14:56:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.694402
2025-12-24 14:56:23 INFO Tuning ranking metrics: regret=0.104132 spearman=-0.034600 (groups=34, skipped=318)
2025-12-24 14:56:23 INFO Epoch 055 | train_mse=0.063841 | val_loss=0.063401 | best_val_loss=0.064235
2025-12-24 14:56:32 INFO Epoch 056 | 25% complete (batch 46/181)
2025-12-24 14:56:33 INFO Epoch 056 | 50% complete (batch 91/181)
2025-12-24 14:56:34 INFO Epoch 056 | 75% complete (batch 136/181)
2025-12-24 14:56:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.714694
2025-12-24 14:56:47 INFO Tuning ranking metrics: regret=0.101189 spearman=0.062077 (groups=34, skipped=318)
2025-12-24 14:56:47 INFO Epoch 056 | train_mse=0.082389 | val_loss=0.058250 | best_val_loss=0.064235
2025-12-24 14:56:56 INFO Epoch 057 | 25% complete (batch 46/181)
2025-12-24 14:56:57 INFO Epoch 057 | 50% complete (batch 91/181)
2025-12-24 14:56:58 INFO Epoch 057 | 75% complete (batch 136/181)
2025-12-24 14:57:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.699906
2025-12-24 14:57:12 INFO Tuning ranking metrics: regret=0.101189 spearman=0.071709 (groups=34, skipped=318)
2025-12-24 14:57:12 INFO Epoch 057 | train_mse=0.077994 | val_loss=0.064101 | best_val_loss=0.064235
2025-12-24 14:57:21 INFO Epoch 058 | 25% complete (batch 46/181)
2025-12-24 14:57:22 INFO Epoch 058 | 50% complete (batch 91/181)
2025-12-24 14:57:23 INFO Epoch 058 | 75% complete (batch 136/181)
2025-12-24 14:57:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.710519
2025-12-24 14:57:36 INFO Tuning ranking metrics: regret=0.081884 spearman=0.046448 (groups=34, skipped=318)
2025-12-24 14:57:36 INFO Epoch 058 | train_mse=0.053824 | val_loss=0.065259 | best_val_loss=0.071709
2025-12-24 14:57:45 INFO Epoch 059 | 25% complete (batch 46/181)
2025-12-24 14:57:46 INFO Epoch 059 | 50% complete (batch 91/181)
2025-12-24 14:57:47 INFO Epoch 059 | 75% complete (batch 136/181)
2025-12-24 14:57:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.731586
2025-12-24 14:58:01 INFO Tuning ranking metrics: regret=0.081884 spearman=0.018054 (groups=34, skipped=318)
2025-12-24 14:58:01 INFO Epoch 059 | train_mse=0.062474 | val_loss=0.058880 | best_val_loss=0.071709
2025-12-24 14:58:09 INFO Epoch 060 | 25% complete (batch 46/181)
2025-12-24 14:58:10 INFO Epoch 060 | 50% complete (batch 91/181)
2025-12-24 14:58:11 INFO Epoch 060 | 75% complete (batch 136/181)
2025-12-24 14:58:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.722136
2025-12-24 14:58:25 INFO Tuning ranking metrics: regret=0.079805 spearman=0.058951 (groups=34, skipped=318)
2025-12-24 14:58:25 INFO Epoch 060 | train_mse=0.060827 | val_loss=0.056208 | best_val_loss=0.071709
2025-12-24 14:58:33 INFO Epoch 061 | 25% complete (batch 46/181)
2025-12-24 14:58:34 INFO Epoch 061 | 50% complete (batch 91/181)
2025-12-24 14:58:35 INFO Epoch 061 | 75% complete (batch 136/181)
2025-12-24 14:58:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.704219
2025-12-24 14:58:49 INFO Tuning ranking metrics: regret=0.081884 spearman=0.050267 (groups=34, skipped=318)
2025-12-24 14:58:49 INFO Epoch 061 | train_mse=0.052165 | val_loss=0.060995 | best_val_loss=0.071709
2025-12-24 14:58:57 INFO Epoch 062 | 25% complete (batch 46/181)
2025-12-24 14:58:58 INFO Epoch 062 | 50% complete (batch 91/181)
2025-12-24 14:58:59 INFO Epoch 062 | 75% complete (batch 136/181)
2025-12-24 14:59:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.695457
2025-12-24 14:59:13 INFO Tuning ranking metrics: regret=0.081884 spearman=0.060638 (groups=34, skipped=318)
2025-12-24 14:59:13 INFO Epoch 062 | train_mse=0.078036 | val_loss=0.077990 | best_val_loss=0.071709
2025-12-24 14:59:21 INFO Epoch 063 | 25% complete (batch 46/181)
2025-12-24 14:59:22 INFO Epoch 063 | 50% complete (batch 91/181)
2025-12-24 14:59:23 INFO Epoch 063 | 75% complete (batch 136/181)
2025-12-24 14:59:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.688629
2025-12-24 14:59:37 INFO Tuning ranking metrics: regret=0.082912 spearman=0.087802 (groups=34, skipped=318)
2025-12-24 14:59:37 INFO Epoch 063 | train_mse=0.050208 | val_loss=0.064647 | best_val_loss=0.071709
2025-12-24 14:59:45 INFO Epoch 064 | 25% complete (batch 46/181)
2025-12-24 14:59:46 INFO Epoch 064 | 50% complete (batch 91/181)
2025-12-24 14:59:47 INFO Epoch 064 | 75% complete (batch 136/181)
2025-12-24 14:59:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.704189
2025-12-24 15:00:01 INFO Tuning ranking metrics: regret=0.082393 spearman=0.051445 (groups=34, skipped=318)
2025-12-24 15:00:01 INFO Epoch 064 | train_mse=0.066365 | val_loss=0.057135 | best_val_loss=0.087802
2025-12-24 15:00:10 INFO Epoch 065 | 25% complete (batch 46/181)
2025-12-24 15:00:10 INFO Epoch 065 | 50% complete (batch 91/181)
2025-12-24 15:00:11 INFO Epoch 065 | 75% complete (batch 136/181)
2025-12-24 15:00:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.719096
2025-12-24 15:00:25 INFO Tuning ranking metrics: regret=0.079273 spearman=0.101318 (groups=34, skipped=318)
2025-12-24 15:00:25 INFO Epoch 065 | train_mse=0.063585 | val_loss=0.058207 | best_val_loss=0.087802
2025-12-24 15:00:33 INFO Epoch 066 | 25% complete (batch 46/181)
2025-12-24 15:00:34 INFO Epoch 066 | 50% complete (batch 91/181)
2025-12-24 15:00:35 INFO Epoch 066 | 75% complete (batch 136/181)
2025-12-24 15:00:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.715418
2025-12-24 15:00:49 INFO Tuning ranking metrics: regret=0.079273 spearman=0.083480 (groups=34, skipped=318)
2025-12-24 15:00:49 INFO Epoch 066 | train_mse=0.063837 | val_loss=0.065608 | best_val_loss=0.101318
2025-12-24 15:00:57 INFO Epoch 067 | 25% complete (batch 46/181)
2025-12-24 15:00:58 INFO Epoch 067 | 50% complete (batch 91/181)
2025-12-24 15:00:59 INFO Epoch 067 | 75% complete (batch 136/181)
2025-12-24 15:01:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.703052
2025-12-24 15:01:12 INFO Tuning ranking metrics: regret=0.084266 spearman=0.006513 (groups=34, skipped=318)
2025-12-24 15:01:12 INFO Epoch 067 | train_mse=0.055859 | val_loss=0.076080 | best_val_loss=0.101318
2025-12-24 15:01:21 INFO Epoch 068 | 25% complete (batch 46/181)
2025-12-24 15:01:22 INFO Epoch 068 | 50% complete (batch 91/181)
2025-12-24 15:01:23 INFO Epoch 068 | 75% complete (batch 136/181)
2025-12-24 15:01:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.665022
2025-12-24 15:01:37 INFO Tuning ranking metrics: regret=0.106931 spearman=0.080227 (groups=34, skipped=318)
2025-12-24 15:01:37 INFO Epoch 068 | train_mse=0.066834 | val_loss=0.115652 | best_val_loss=0.101318
2025-12-24 15:01:45 INFO Epoch 069 | 25% complete (batch 46/181)
2025-12-24 15:01:46 INFO Epoch 069 | 50% complete (batch 91/181)
2025-12-24 15:01:47 INFO Epoch 069 | 75% complete (batch 136/181)
2025-12-24 15:01:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.710270
2025-12-24 15:02:01 INFO Tuning ranking metrics: regret=0.069376 spearman=0.060186 (groups=34, skipped=318)
2025-12-24 15:02:01 INFO Epoch 069 | train_mse=0.080274 | val_loss=0.060495 | best_val_loss=0.101318
2025-12-24 15:02:10 INFO Epoch 070 | 25% complete (batch 46/181)
2025-12-24 15:02:11 INFO Epoch 070 | 50% complete (batch 91/181)
2025-12-24 15:02:12 INFO Epoch 070 | 75% complete (batch 136/181)
2025-12-24 15:02:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.676612
2025-12-24 15:02:26 INFO Tuning ranking metrics: regret=0.081580 spearman=0.026095 (groups=34, skipped=318)
2025-12-24 15:02:26 INFO Epoch 070 | train_mse=0.077819 | val_loss=0.108472 | best_val_loss=0.101318
2025-12-24 15:02:35 INFO Epoch 071 | 25% complete (batch 46/181)
2025-12-24 15:02:35 INFO Epoch 071 | 50% complete (batch 91/181)
2025-12-24 15:02:36 INFO Epoch 071 | 75% complete (batch 136/181)
2025-12-24 15:02:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.707486
2025-12-24 15:02:50 INFO Tuning ranking metrics: regret=0.068717 spearman=0.015826 (groups=34, skipped=318)
2025-12-24 15:02:50 INFO Epoch 071 | train_mse=0.066035 | val_loss=0.058516 | best_val_loss=0.101318
2025-12-24 15:02:59 INFO Epoch 072 | 25% complete (batch 46/181)
2025-12-24 15:03:00 INFO Epoch 072 | 50% complete (batch 91/181)
2025-12-24 15:03:00 INFO Epoch 072 | 75% complete (batch 136/181)
2025-12-24 15:03:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.719971
2025-12-24 15:03:14 INFO Tuning ranking metrics: regret=0.081110 spearman=0.043112 (groups=34, skipped=318)
2025-12-24 15:03:14 INFO Epoch 072 | train_mse=0.074016 | val_loss=0.057266 | best_val_loss=0.101318
Monitored metric tuning_rank_spearman did not improve in the last 40 records. Best score: 0.202. Signaling Trainer to stop.
2025-12-24 15:03:16 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.08348_val-0.06561_epoch066.chkpt, checkpoint.tuning_rank_spearman-0.08780_val-0.06465_epoch063.chkpt, checkpoint.tuning_rank_spearman-0.10132_val-0.05821_epoch065.chkpt
2025-12-24 15:03:16 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.10132_val-0.05821_epoch065.chkpt
2025-12-24 15:03:16 INFO Best validation loss: tensor(0.1013)
2025-12-24 15:03:16 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.10132_val-0.05821_epoch065.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.10132_val-0.05821_epoch065.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-24 15:03:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.058207
2025-12-24 15:03:28 INFO Tuning ranking metrics: regret=0.079273 spearman=0.101318 (groups=34, skipped=318)
2025-12-24 15:03:28 INFO Epoch 073 | val_loss=0.058207 | best_val_loss=0.101318
2025-12-24 15:03:29 INFO Validation metrics: [{'val_loss': 0.0582074299454689, 'tuning_rank_regret': 0.07927294075489044, 'tuning_rank_spearman': 0.10131780058145523, 'val_pearson_corr': 0.782322347164154, 'val_spearman_corr': 0.7810260057449341, 'val_rank_regret': 0.0, 'val_rank_spearman': 1.0}]
2025-12-24 15:03:29 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.10132_val-0.05821_epoch065.chkpt
2025-12-24 15:03:29 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.08780_val-0.06465_epoch063.chkpt
2025-12-24 15:03:29 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.08348_val-0.06561_epoch066.chkpt
2025-12-24 15:03:29 INFO Renamed checkpoint file: alt_val.val-0.05621_epoch060.ckpt -> alt_val.val-0.05621_epoch060.chkpt
2025-12-24 15:03:29 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.05621_epoch060.chkpt
2025-12-24 15:03:29 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.07927294075489044
  tuning_rank_spearman      0.10131780058145523
        val_loss            0.0582074299454689
    val_pearson_corr         0.782322347164154
     val_rank_regret                0.0
    val_rank_spearman               1.0
    val_spearman_corr       0.7810260057449341
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run polish_seed101_2025-12-24_11-12-07_phase1 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase1
[run_full_pipeline] Phase 1 best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.10132_val-0.05821_epoch065.chkpt (tuning_rank_spearman=0.10131780058145523)
[run_full_pipeline] Phase 2 fine-tuning (seed 101) -> polish_seed101_2025-12-24_11-12-07_phase2_seed101
[train_cli] run_id=polish_seed101_2025-12-24_11-12-07_phase2_seed101 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed101/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed101 --git-commit 9b1bb2b320 --git-dirty --resume-from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.10132_val-0.05821_epoch065.chkpt
2025-12-24 15:03:35 INFO git_commit = 9b1bb2b320 (dirty)
2025-12-24 15:03:35 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-24 15:03:35 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed101/config/config.yaml
2025-12-24 15:03:35 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data
2025-12-24 15:03:35 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-24 15:03:35 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-24 15:03:35 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed101
2025-12-24 15:03:35 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-24 15:03:35 INFO   metadata_path = None
2025-12-24 15:03:35 INFO   summary_path = None
2025-12-24 15:03:35 INFO   accelerator = cpu
2025-12-24 15:03:35 INFO   devices = 1
2025-12-24 15:03:35 INFO   attention_head = 8
2025-12-24 15:03:35 INFO   pooling_type = mean
2025-12-24 15:03:35 INFO   model_self_loops = False
2025-12-24 15:03:35 INFO   model_self_loop_fill = mean
2025-12-24 15:03:35 INFO   model_residual = False
2025-12-24 15:03:35 INFO   batch_size = 48
2025-12-24 15:03:35 INFO   learning_rate = 0.001
2025-12-24 15:03:35 INFO   num_epochs = 320
2025-12-24 15:03:35 INFO   accumulate_grad_batches = 8
2025-12-24 15:03:35 INFO   seed = 101
2025-12-24 15:03:35 INFO   num_workers = 2
2025-12-24 15:03:35 INFO   precision = 32
2025-12-24 15:03:35 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-24 15:03:35 INFO   early_stopping_patience = 20
2025-12-24 15:03:35 INFO   lr_scheduler_patience = 4
2025-12-24 15:03:35 INFO   lr_scheduler_factor = 0.2
2025-12-24 15:03:35 INFO   fast_dev_run = False
2025-12-24 15:03:35 INFO   limit_train_batches = None
2025-12-24 15:03:35 INFO   limit_val_batches = None
2025-12-24 15:03:35 INFO   log_lr = False
2025-12-24 15:03:35 INFO   progress_bar_refresh_rate = 0
2025-12-24 15:03:35 INFO   log_every_n_steps = 100
2025-12-24 15:03:35 INFO   use_val_spearman_as_secondary = True
2025-12-24 15:03:35 INFO   spearman_secondary_min_delta = 0.0
2025-12-24 15:03:35 INFO   spearman_secondary_weight = 1.0
2025-12-24 15:03:35 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-24 15:03:35 INFO   tuning_max_samples = 500
2025-12-24 15:03:35 INFO   tuning_fraction = None
2025-12-24 15:03:35 INFO   tuning_eval_every = 1
2025-12-24 15:03:35 INFO   rank_loss_weight = 0.0
2025-12-24 15:03:35 INFO   rank_loss_margin = 0.0
2025-12-24 15:03:35 INFO   rank_loss_mode = hinge
2025-12-24 15:03:35 INFO   rank_loss_grouped = True
2025-12-24 15:03:35 INFO   variance_reduction_enabled = False
2025-12-24 15:03:35 INFO   variance_reduction_method = topk_avg
2025-12-24 15:03:35 INFO   variance_reduction_top_k = 3
2025-12-24 15:03:35 INFO   coverage_minimum = 0.0
2025-12-24 15:03:35 INFO   coverage_fail_on_missing = False
2025-12-24 15:03:35 INFO   graph_load_profiling = False
2025-12-24 15:03:35 INFO   graph_load_top_k = 5
2025-12-24 15:03:35 INFO   enable_graph_cache = True
2025-12-24 15:03:35 INFO   graph_cache_size = 256
2025-12-24 15:03:35 INFO   canonicalize_on_load = False
2025-12-24 15:03:35 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-24 15:03:35 INFO   edge_schema = {}
2025-12-24 15:03:35 INFO   topology_schema = {}
Seed set to 101
2025-12-24 15:03:35 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-24 15:03:35 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 15:03:35 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-24 15:03:35 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 15:03:35 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-24 15:03:35 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 15:03:37 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-24 15:03:37 INFO Tuning group stats: groups=348 groups>=2=37 singletons=311 max_group=11
2025-12-24 15:03:38 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed101/dataset_coverage.json
2025-12-24 15:03:38 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed101/dataset_coverage.json for details.
2025-12-24 15:03:38 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed101/dataset_coverage.json for details.
2025-12-24 15:03:38 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed101/dataset_coverage.json for details.
2025-12-24 15:03:38 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed101/schema_summary.json
2025-12-24 15:03:38 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed101/feature_metadata.json
2025-12-24 15:03:38 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-24 15:03:38 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/advanced_k_partite_v2/feature-config.yaml.advanced_lean.10A.v2, sha256=2022a36e7b21668173af3af66c25cf6b6a0494e642c0934eac38abbcfeebec3d
2025-12-24 15:03:38 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/work/edge_features)
2025-12-24 15:03:38 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json
2025-12-24 15:03:38 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed101/schema_summary.json
2025-12-24 15:03:38 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-24 15:03:38 INFO Topology: topology/persistence_k_partite_advanced/v2 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 628-dimensional node features.
2025-12-24 15:03:38 INFO Node: node/dssp_topo_merge_passthrough/v1; metadata lists 628 feature columns matching the .pt tensor.
2025-12-24 15:03:38 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-24 15:03:38 INFO → Total feature dimensionality observed and confirmed: node_dim = 628, edge_dim = 11.
2025-12-24 15:03:38 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-24 15:03:38 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 628,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge_passthrough/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 628,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed101/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge_passthrough/v1",
      "alias": "Passthrough (all dims from topology module) = Node Dynamic Dims",
      "jobs": 16,
      "summary": "DSSP/basic features merged with all topology columns (passthrough)."
    },
    "topology": {
      "id": "topology/persistence_k_partite_advanced/v2",
      "alias": "Advanced k-partite PH (v2 lean) topo_dim 596",
      "jobs": 16,
      "summary": "Fixed-width k-partite persistent homology with slot padding + missingness channels."
    }
  },
  "notes": []
}
2025-12-24 15:03:38 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-24 15:03:38 INFO Resuming from checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.10132_val-0.05821_epoch065.chkpt (epoch=65)
2025-12-24 15:03:38 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=2caccca8d93241448ea6dc6c027c0bd0)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-24 15:03:38 INFO Starting training (fast_dev_run=False)
2025-12-24 15:03:38 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed101/model_checkpoints exists and is not empty.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.10132_val-0.05821_epoch065.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase1/model_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed101/model_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase1/model_checkpoints/val_loss_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed101/model_checkpoints/val_loss_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 20.1 K | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
180 K     Trainable params
0         Non-trainable params
180 K     Total params
0.721     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
Restored all states from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.10132_val-0.05821_epoch065.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-24 15:03:52 INFO Epoch 066 | 25% complete (batch 46/181)
2025-12-24 15:03:53 INFO Epoch 066 | 50% complete (batch 91/181)
2025-12-24 15:03:54 INFO Epoch 066 | 75% complete (batch 136/181)
2025-12-24 15:04:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.059092
2025-12-24 15:04:08 INFO Tuning ranking metrics: regret=0.114918 spearman=0.082111 (groups=37, skipped=311)
2025-12-24 15:04:08 INFO Epoch 066 | val_loss=0.059092
2025-12-24 15:04:16 INFO Epoch 067 | 25% complete (batch 46/181)
2025-12-24 15:04:17 INFO Epoch 067 | 50% complete (batch 91/181)
2025-12-24 15:04:18 INFO Epoch 067 | 75% complete (batch 136/181)
2025-12-24 15:04:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.718778
2025-12-24 15:04:32 INFO Tuning ranking metrics: regret=0.131659 spearman=0.080028 (groups=37, skipped=311)
2025-12-24 15:04:32 INFO Epoch 067 | train_mse=0.069953 | val_loss=0.059213 | best_val_loss=0.082111
2025-12-24 15:04:40 INFO Epoch 068 | 25% complete (batch 46/181)
2025-12-24 15:04:41 INFO Epoch 068 | 50% complete (batch 91/181)
2025-12-24 15:04:42 INFO Epoch 068 | 75% complete (batch 136/181)
2025-12-24 15:04:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.713500
2025-12-24 15:04:56 INFO Tuning ranking metrics: regret=0.114130 spearman=0.089833 (groups=37, skipped=311)
2025-12-24 15:04:56 INFO Epoch 068 | train_mse=0.069083 | val_loss=0.055319 | best_val_loss=0.082111
2025-12-24 15:05:04 INFO Epoch 069 | 25% complete (batch 46/181)
2025-12-24 15:05:05 INFO Epoch 069 | 50% complete (batch 91/181)
2025-12-24 15:05:06 INFO Epoch 069 | 75% complete (batch 136/181)
2025-12-24 15:05:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.713779
2025-12-24 15:05:19 INFO Tuning ranking metrics: regret=0.114537 spearman=0.104715 (groups=37, skipped=311)
2025-12-24 15:05:19 INFO Epoch 069 | train_mse=0.052611 | val_loss=0.062350 | best_val_loss=0.089833
2025-12-24 15:05:28 INFO Epoch 070 | 25% complete (batch 46/181)
2025-12-24 15:05:29 INFO Epoch 070 | 50% complete (batch 91/181)
2025-12-24 15:05:30 INFO Epoch 070 | 75% complete (batch 136/181)
2025-12-24 15:05:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.730135
2025-12-24 15:05:43 INFO Tuning ranking metrics: regret=0.112832 spearman=0.088072 (groups=37, skipped=311)
2025-12-24 15:05:43 INFO Epoch 070 | train_mse=0.055373 | val_loss=0.055150 | best_val_loss=0.104715
2025-12-24 15:05:52 INFO Epoch 071 | 25% complete (batch 46/181)
2025-12-24 15:05:53 INFO Epoch 071 | 50% complete (batch 91/181)
2025-12-24 15:05:54 INFO Epoch 071 | 75% complete (batch 136/181)
2025-12-24 15:06:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.703800
2025-12-24 15:06:07 INFO Tuning ranking metrics: regret=0.112999 spearman=0.093764 (groups=37, skipped=311)
2025-12-24 15:06:07 INFO Epoch 071 | train_mse=0.046496 | val_loss=0.077729 | best_val_loss=0.104715
2025-12-24 15:06:16 INFO Epoch 072 | 25% complete (batch 46/181)
2025-12-24 15:06:16 INFO Epoch 072 | 50% complete (batch 91/181)
2025-12-24 15:06:17 INFO Epoch 072 | 75% complete (batch 136/181)
2025-12-24 15:06:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.723816
2025-12-24 15:06:31 INFO Tuning ranking metrics: regret=0.132226 spearman=0.089920 (groups=37, skipped=311)
2025-12-24 15:06:31 INFO Epoch 072 | train_mse=0.057892 | val_loss=0.053068 | best_val_loss=0.104715
Monitored metric tuning_rank_spearman did not improve in the last 40 records. Best score: 0.202. Signaling Trainer to stop.
2025-12-24 15:06:32 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.08992_val-0.05307_epoch072.chkpt, checkpoint.tuning_rank_spearman-0.09376_val-0.07773_epoch071.chkpt, checkpoint.tuning_rank_spearman-0.10472_val-0.06235_epoch069.chkpt
2025-12-24 15:06:32 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed101/model_checkpoints/checkpoint.tuning_rank_spearman-0.10472_val-0.06235_epoch069.chkpt
2025-12-24 15:06:32 INFO Best validation loss: tensor(0.1047)
2025-12-24 15:06:32 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed101/model_checkpoints/checkpoint.tuning_rank_spearman-0.10472_val-0.06235_epoch069.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed101/model_checkpoints/checkpoint.tuning_rank_spearman-0.10472_val-0.06235_epoch069.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-24 15:06:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.062350
2025-12-24 15:06:44 INFO Tuning ranking metrics: regret=0.114537 spearman=0.104715 (groups=37, skipped=311)
2025-12-24 15:06:44 INFO Epoch 073 | val_loss=0.062350 | best_val_loss=0.104715
2025-12-24 15:06:45 INFO Validation metrics: [{'val_loss': 0.06235045567154884, 'tuning_rank_regret': 0.11453723162412643, 'tuning_rank_spearman': 0.10471510142087936, 'val_pearson_corr': 0.7743845582008362, 'val_spearman_corr': 0.7852849364280701, 'val_rank_regret': 0.02874894253909588, 'val_rank_spearman': 0.8333333134651184}]
2025-12-24 15:06:45 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.10472_val-0.06235_epoch069.chkpt
2025-12-24 15:06:45 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.09376_val-0.07773_epoch071.chkpt
2025-12-24 15:06:45 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.08992_val-0.05307_epoch072.chkpt
2025-12-24 15:06:45 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.05532_epoch068.ckpt
2025-12-24 15:06:45 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.11453723162412643
  tuning_rank_spearman      0.10471510142087936
        val_loss            0.06235045567154884
    val_pearson_corr        0.7743845582008362
     val_rank_regret        0.02874894253909588
    val_rank_spearman       0.8333333134651184
    val_spearman_corr       0.7852849364280701
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run polish_seed101_2025-12-24_11-12-07_phase2_seed101 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed101
[run_full_pipeline] Phase 2 (seed 101) best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed101/model_checkpoints/checkpoint.tuning_rank_spearman-0.10472_val-0.06235_epoch069.chkpt (tuning_rank_spearman=0.10471510142087936)
[run_full_pipeline] Phase 2 fine-tuning (seed 555) -> polish_seed101_2025-12-24_11-12-07_phase2_seed555
[train_cli] run_id=polish_seed101_2025-12-24_11-12-07_phase2_seed555 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed555/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed555 --git-commit 9b1bb2b320 --git-dirty --resume-from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.10132_val-0.05821_epoch065.chkpt
2025-12-24 15:06:51 INFO git_commit = 9b1bb2b320 (dirty)
2025-12-24 15:06:51 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-24 15:06:51 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed555/config/config.yaml
2025-12-24 15:06:51 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data
2025-12-24 15:06:51 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-24 15:06:51 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-24 15:06:51 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed555
2025-12-24 15:06:51 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-24 15:06:51 INFO   metadata_path = None
2025-12-24 15:06:51 INFO   summary_path = None
2025-12-24 15:06:51 INFO   accelerator = cpu
2025-12-24 15:06:51 INFO   devices = 1
2025-12-24 15:06:51 INFO   attention_head = 8
2025-12-24 15:06:51 INFO   pooling_type = mean
2025-12-24 15:06:51 INFO   model_self_loops = False
2025-12-24 15:06:51 INFO   model_self_loop_fill = mean
2025-12-24 15:06:51 INFO   model_residual = False
2025-12-24 15:06:51 INFO   batch_size = 48
2025-12-24 15:06:51 INFO   learning_rate = 0.001
2025-12-24 15:06:51 INFO   num_epochs = 320
2025-12-24 15:06:51 INFO   accumulate_grad_batches = 8
2025-12-24 15:06:51 INFO   seed = 555
2025-12-24 15:06:51 INFO   num_workers = 2
2025-12-24 15:06:51 INFO   precision = 32
2025-12-24 15:06:51 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-24 15:06:51 INFO   early_stopping_patience = 20
2025-12-24 15:06:51 INFO   lr_scheduler_patience = 4
2025-12-24 15:06:51 INFO   lr_scheduler_factor = 0.2
2025-12-24 15:06:51 INFO   fast_dev_run = False
2025-12-24 15:06:51 INFO   limit_train_batches = None
2025-12-24 15:06:51 INFO   limit_val_batches = None
2025-12-24 15:06:51 INFO   log_lr = False
2025-12-24 15:06:51 INFO   progress_bar_refresh_rate = 0
2025-12-24 15:06:51 INFO   log_every_n_steps = 100
2025-12-24 15:06:51 INFO   use_val_spearman_as_secondary = True
2025-12-24 15:06:51 INFO   spearman_secondary_min_delta = 0.0
2025-12-24 15:06:51 INFO   spearman_secondary_weight = 1.0
2025-12-24 15:06:51 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-24 15:06:51 INFO   tuning_max_samples = 500
2025-12-24 15:06:51 INFO   tuning_fraction = None
2025-12-24 15:06:51 INFO   tuning_eval_every = 1
2025-12-24 15:06:51 INFO   rank_loss_weight = 0.0
2025-12-24 15:06:51 INFO   rank_loss_margin = 0.0
2025-12-24 15:06:51 INFO   rank_loss_mode = hinge
2025-12-24 15:06:51 INFO   rank_loss_grouped = True
2025-12-24 15:06:51 INFO   variance_reduction_enabled = False
2025-12-24 15:06:51 INFO   variance_reduction_method = topk_avg
2025-12-24 15:06:51 INFO   variance_reduction_top_k = 3
2025-12-24 15:06:51 INFO   coverage_minimum = 0.0
2025-12-24 15:06:51 INFO   coverage_fail_on_missing = False
2025-12-24 15:06:51 INFO   graph_load_profiling = False
2025-12-24 15:06:51 INFO   graph_load_top_k = 5
2025-12-24 15:06:51 INFO   enable_graph_cache = True
2025-12-24 15:06:51 INFO   graph_cache_size = 256
2025-12-24 15:06:51 INFO   canonicalize_on_load = False
2025-12-24 15:06:51 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-24 15:06:51 INFO   edge_schema = {}
2025-12-24 15:06:51 INFO   topology_schema = {}
Seed set to 555
2025-12-24 15:06:52 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-24 15:06:52 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 15:06:52 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-24 15:06:52 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 15:06:52 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-24 15:06:52 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 15:06:54 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-24 15:06:54 INFO Tuning group stats: groups=368 groups>=2=39 singletons=329 max_group=9
2025-12-24 15:06:54 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed555/dataset_coverage.json
2025-12-24 15:06:54 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed555/dataset_coverage.json for details.
2025-12-24 15:06:54 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed555/dataset_coverage.json for details.
2025-12-24 15:06:54 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed555/dataset_coverage.json for details.
2025-12-24 15:06:54 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed555/schema_summary.json
2025-12-24 15:06:54 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed555/feature_metadata.json
2025-12-24 15:06:54 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-24 15:06:54 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/advanced_k_partite_v2/feature-config.yaml.advanced_lean.10A.v2, sha256=2022a36e7b21668173af3af66c25cf6b6a0494e642c0934eac38abbcfeebec3d
2025-12-24 15:06:54 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/work/edge_features)
2025-12-24 15:06:54 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json
2025-12-24 15:06:54 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed555/schema_summary.json
2025-12-24 15:06:54 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-24 15:06:54 INFO Topology: topology/persistence_k_partite_advanced/v2 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 628-dimensional node features.
2025-12-24 15:06:54 INFO Node: node/dssp_topo_merge_passthrough/v1; metadata lists 628 feature columns matching the .pt tensor.
2025-12-24 15:06:54 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-24 15:06:54 INFO → Total feature dimensionality observed and confirmed: node_dim = 628, edge_dim = 11.
2025-12-24 15:06:54 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-24 15:06:54 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 628,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge_passthrough/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 628,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed555/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge_passthrough/v1",
      "alias": "Passthrough (all dims from topology module) = Node Dynamic Dims",
      "jobs": 16,
      "summary": "DSSP/basic features merged with all topology columns (passthrough)."
    },
    "topology": {
      "id": "topology/persistence_k_partite_advanced/v2",
      "alias": "Advanced k-partite PH (v2 lean) topo_dim 596",
      "jobs": 16,
      "summary": "Fixed-width k-partite persistent homology with slot padding + missingness channels."
    }
  },
  "notes": []
}
2025-12-24 15:06:54 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-24 15:06:54 INFO Resuming from checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.10132_val-0.05821_epoch065.chkpt (epoch=65)
2025-12-24 15:06:54 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=942909b9e2154e90901ded39eef7b0a7)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-24 15:06:54 INFO Starting training (fast_dev_run=False)
2025-12-24 15:06:54 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed555/model_checkpoints exists and is not empty.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.10132_val-0.05821_epoch065.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase1/model_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed555/model_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase1/model_checkpoints/val_loss_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed555/model_checkpoints/val_loss_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 20.1 K | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
180 K     Trainable params
0         Non-trainable params
180 K     Total params
0.721     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
Restored all states from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.10132_val-0.05821_epoch065.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-24 15:07:09 INFO Epoch 066 | 25% complete (batch 46/181)
2025-12-24 15:07:09 INFO Epoch 066 | 50% complete (batch 91/181)
2025-12-24 15:07:10 INFO Epoch 066 | 75% complete (batch 136/181)
2025-12-24 15:07:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.071977
2025-12-24 15:07:24 INFO Tuning ranking metrics: regret=0.093601 spearman=0.261905 (groups=39, skipped=329)
2025-12-24 15:07:24 INFO Epoch 066 | val_loss=0.071977
Metric tuning_rank_spearman improved by 0.060 >= min_delta = 0.0. New best score: 0.262
2025-12-24 15:07:32 INFO Epoch 067 | 25% complete (batch 46/181)
2025-12-24 15:07:33 INFO Epoch 067 | 50% complete (batch 91/181)
2025-12-24 15:07:34 INFO Epoch 067 | 75% complete (batch 136/181)
2025-12-24 15:07:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.708712
2025-12-24 15:07:48 INFO Tuning ranking metrics: regret=0.089879 spearman=0.240476 (groups=39, skipped=329)
2025-12-24 15:07:48 INFO Epoch 067 | train_mse=0.055443 | val_loss=0.068088 | best_val_loss=0.261905
2025-12-24 15:07:56 INFO Epoch 068 | 25% complete (batch 46/181)
2025-12-24 15:07:57 INFO Epoch 068 | 50% complete (batch 91/181)
2025-12-24 15:07:58 INFO Epoch 068 | 75% complete (batch 136/181)
2025-12-24 15:08:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.609159
2025-12-24 15:08:12 INFO Tuning ranking metrics: regret=0.101320 spearman=0.273993 (groups=39, skipped=329)
2025-12-24 15:08:12 INFO Epoch 068 | train_mse=0.099767 | val_loss=0.157498 | best_val_loss=0.261905
Metric tuning_rank_spearman improved by 0.012 >= min_delta = 0.0. New best score: 0.274
2025-12-24 15:08:20 INFO Epoch 069 | 25% complete (batch 46/181)
2025-12-24 15:08:21 INFO Epoch 069 | 50% complete (batch 91/181)
2025-12-24 15:08:22 INFO Epoch 069 | 75% complete (batch 136/181)
2025-12-24 15:08:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.687467
2025-12-24 15:08:35 INFO Tuning ranking metrics: regret=0.100609 spearman=0.313919 (groups=39, skipped=329)
2025-12-24 15:08:35 INFO Epoch 069 | train_mse=0.058736 | val_loss=0.080983 | best_val_loss=0.273993
Metric tuning_rank_spearman improved by 0.040 >= min_delta = 0.0. New best score: 0.314
2025-12-24 15:08:44 INFO Epoch 070 | 25% complete (batch 46/181)
2025-12-24 15:08:45 INFO Epoch 070 | 50% complete (batch 91/181)
2025-12-24 15:08:46 INFO Epoch 070 | 75% complete (batch 136/181)
2025-12-24 15:08:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.714167
2025-12-24 15:09:00 INFO Tuning ranking metrics: regret=0.092337 spearman=0.310501 (groups=39, skipped=329)
2025-12-24 15:09:00 INFO Epoch 070 | train_mse=0.142799 | val_loss=0.058006 | best_val_loss=0.313919
2025-12-24 15:09:08 INFO Epoch 071 | 25% complete (batch 46/181)
2025-12-24 15:09:09 INFO Epoch 071 | 50% complete (batch 91/181)
2025-12-24 15:09:10 INFO Epoch 071 | 75% complete (batch 136/181)
2025-12-24 15:09:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.721323
2025-12-24 15:09:24 INFO Tuning ranking metrics: regret=0.096152 spearman=0.266484 (groups=39, skipped=329)
2025-12-24 15:09:24 INFO Epoch 071 | train_mse=0.055290 | val_loss=0.050984 | best_val_loss=0.313919
2025-12-24 15:09:32 INFO Epoch 072 | 25% complete (batch 46/181)
2025-12-24 15:09:33 INFO Epoch 072 | 50% complete (batch 91/181)
2025-12-24 15:09:34 INFO Epoch 072 | 75% complete (batch 136/181)
2025-12-24 15:09:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.721751
2025-12-24 15:09:48 INFO Tuning ranking metrics: regret=0.093886 spearman=0.264713 (groups=39, skipped=329)
2025-12-24 15:09:48 INFO Epoch 072 | train_mse=0.054882 | val_loss=0.052115 | best_val_loss=0.313919
2025-12-24 15:09:56 INFO Epoch 073 | 25% complete (batch 46/181)
2025-12-24 15:09:57 INFO Epoch 073 | 50% complete (batch 91/181)
2025-12-24 15:09:58 INFO Epoch 073 | 75% complete (batch 136/181)
2025-12-24 15:10:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.736468
2025-12-24 15:10:12 INFO Tuning ranking metrics: regret=0.093886 spearman=0.263126 (groups=39, skipped=329)
2025-12-24 15:10:12 INFO Epoch 073 | train_mse=0.059050 | val_loss=0.050896 | best_val_loss=0.313919
2025-12-24 15:10:20 INFO Epoch 074 | 25% complete (batch 46/181)
2025-12-24 15:10:21 INFO Epoch 074 | 50% complete (batch 91/181)
2025-12-24 15:10:22 INFO Epoch 074 | 75% complete (batch 136/181)
2025-12-24 15:10:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.744040
2025-12-24 15:10:36 INFO Tuning ranking metrics: regret=0.093886 spearman=0.241148 (groups=39, skipped=329)
2025-12-24 15:10:36 INFO Epoch 074 | train_mse=0.066167 | val_loss=0.050920 | best_val_loss=0.313919
2025-12-24 15:10:44 INFO Epoch 075 | 25% complete (batch 46/181)
2025-12-24 15:10:45 INFO Epoch 075 | 50% complete (batch 91/181)
2025-12-24 15:10:46 INFO Epoch 075 | 75% complete (batch 136/181)
2025-12-24 15:10:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.738730
2025-12-24 15:11:00 INFO Tuning ranking metrics: regret=0.093338 spearman=0.241880 (groups=39, skipped=329)
2025-12-24 15:11:00 INFO Epoch 075 | train_mse=0.061714 | val_loss=0.053413 | best_val_loss=0.313919
2025-12-24 15:11:08 INFO Epoch 076 | 25% complete (batch 46/181)
2025-12-24 15:11:09 INFO Epoch 076 | 50% complete (batch 91/181)
2025-12-24 15:11:10 INFO Epoch 076 | 75% complete (batch 136/181)
2025-12-24 15:11:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.728953
2025-12-24 15:11:24 INFO Tuning ranking metrics: regret=0.093338 spearman=0.198046 (groups=39, skipped=329)
2025-12-24 15:11:24 INFO Epoch 076 | train_mse=0.069101 | val_loss=0.057556 | best_val_loss=0.313919
2025-12-24 15:11:32 INFO Epoch 077 | 25% complete (batch 46/181)
2025-12-24 15:11:33 INFO Epoch 077 | 50% complete (batch 91/181)
2025-12-24 15:11:34 INFO Epoch 077 | 75% complete (batch 136/181)
2025-12-24 15:11:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.716841
2025-12-24 15:11:48 INFO Tuning ranking metrics: regret=0.093525 spearman=0.215995 (groups=39, skipped=329)
2025-12-24 15:11:48 INFO Epoch 077 | train_mse=0.065721 | val_loss=0.061150 | best_val_loss=0.313919
2025-12-24 15:11:56 INFO Epoch 078 | 25% complete (batch 46/181)
2025-12-24 15:11:57 INFO Epoch 078 | 50% complete (batch 91/181)
2025-12-24 15:11:58 INFO Epoch 078 | 75% complete (batch 136/181)
2025-12-24 15:12:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.727342
2025-12-24 15:12:12 INFO Tuning ranking metrics: regret=0.093338 spearman=0.214408 (groups=39, skipped=329)
2025-12-24 15:12:12 INFO Epoch 078 | train_mse=0.047820 | val_loss=0.056417 | best_val_loss=0.313919
2025-12-24 15:12:20 INFO Epoch 079 | 25% complete (batch 46/181)
2025-12-24 15:12:21 INFO Epoch 079 | 50% complete (batch 91/181)
2025-12-24 15:12:23 INFO Epoch 079 | 75% complete (batch 136/181)
2025-12-24 15:12:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.715896
2025-12-24 15:12:36 INFO Tuning ranking metrics: regret=0.092869 spearman=0.235287 (groups=39, skipped=329)
2025-12-24 15:12:36 INFO Epoch 079 | train_mse=0.069551 | val_loss=0.075911 | best_val_loss=0.313919
2025-12-24 15:12:45 INFO Epoch 080 | 25% complete (batch 46/181)
2025-12-24 15:12:46 INFO Epoch 080 | 50% complete (batch 91/181)
2025-12-24 15:12:47 INFO Epoch 080 | 75% complete (batch 136/181)
2025-12-24 15:12:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.751980
2025-12-24 15:13:00 INFO Tuning ranking metrics: regret=0.092790 spearman=0.271306 (groups=39, skipped=329)
2025-12-24 15:13:00 INFO Epoch 080 | train_mse=0.066824 | val_loss=0.051833 | best_val_loss=0.313919
2025-12-24 15:13:09 INFO Epoch 081 | 25% complete (batch 46/181)
2025-12-24 15:13:10 INFO Epoch 081 | 50% complete (batch 91/181)
2025-12-24 15:13:10 INFO Epoch 081 | 75% complete (batch 136/181)
2025-12-24 15:13:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.732967
2025-12-24 15:13:24 INFO Tuning ranking metrics: regret=0.093886 spearman=0.313614 (groups=39, skipped=329)
2025-12-24 15:13:24 INFO Epoch 081 | train_mse=0.071964 | val_loss=0.069075 | best_val_loss=0.313919
2025-12-24 15:13:33 INFO Epoch 082 | 25% complete (batch 46/181)
2025-12-24 15:13:34 INFO Epoch 082 | 50% complete (batch 91/181)
2025-12-24 15:13:35 INFO Epoch 082 | 75% complete (batch 136/181)
2025-12-24 15:13:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.741673
2025-12-24 15:13:48 INFO Tuning ranking metrics: regret=0.093886 spearman=0.292918 (groups=39, skipped=329)
2025-12-24 15:13:48 INFO Epoch 082 | train_mse=0.066946 | val_loss=0.050201 | best_val_loss=0.313919
2025-12-24 15:13:57 INFO Epoch 083 | 25% complete (batch 46/181)
2025-12-24 15:13:58 INFO Epoch 083 | 50% complete (batch 91/181)
2025-12-24 15:13:59 INFO Epoch 083 | 75% complete (batch 136/181)
2025-12-24 15:14:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.732309
2025-12-24 15:14:12 INFO Tuning ranking metrics: regret=0.093311 spearman=0.320391 (groups=39, skipped=329)
2025-12-24 15:14:12 INFO Epoch 083 | train_mse=0.057479 | val_loss=0.056581 | best_val_loss=0.313919
Metric tuning_rank_spearman improved by 0.006 >= min_delta = 0.0. New best score: 0.320
2025-12-24 15:14:21 INFO Epoch 084 | 25% complete (batch 46/181)
2025-12-24 15:14:22 INFO Epoch 084 | 50% complete (batch 91/181)
2025-12-24 15:14:23 INFO Epoch 084 | 75% complete (batch 136/181)
2025-12-24 15:14:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.731797
2025-12-24 15:14:36 INFO Tuning ranking metrics: regret=0.107573 spearman=0.285897 (groups=39, skipped=329)
2025-12-24 15:14:36 INFO Epoch 084 | train_mse=0.050885 | val_loss=0.060916 | best_val_loss=0.320391
2025-12-24 15:14:45 INFO Epoch 085 | 25% complete (batch 46/181)
2025-12-24 15:14:46 INFO Epoch 085 | 50% complete (batch 91/181)
2025-12-24 15:14:47 INFO Epoch 085 | 75% complete (batch 136/181)
2025-12-24 15:14:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.744317
2025-12-24 15:15:00 INFO Tuning ranking metrics: regret=0.093523 spearman=0.312759 (groups=39, skipped=329)
2025-12-24 15:15:00 INFO Epoch 085 | train_mse=0.075440 | val_loss=0.056998 | best_val_loss=0.320391
2025-12-24 15:15:09 INFO Epoch 086 | 25% complete (batch 46/181)
2025-12-24 15:15:10 INFO Epoch 086 | 50% complete (batch 91/181)
2025-12-24 15:15:10 INFO Epoch 086 | 75% complete (batch 136/181)
2025-12-24 15:15:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.750517
2025-12-24 15:15:24 INFO Tuning ranking metrics: regret=0.093311 spearman=0.314591 (groups=39, skipped=329)
2025-12-24 15:15:24 INFO Epoch 086 | train_mse=0.087636 | val_loss=0.048417 | best_val_loss=0.320391
2025-12-24 15:15:32 INFO Epoch 087 | 25% complete (batch 46/181)
2025-12-24 15:15:33 INFO Epoch 087 | 50% complete (batch 91/181)
2025-12-24 15:15:34 INFO Epoch 087 | 75% complete (batch 136/181)
2025-12-24 15:15:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.730915
2025-12-24 15:15:48 INFO Tuning ranking metrics: regret=0.093311 spearman=0.323748 (groups=39, skipped=329)
2025-12-24 15:15:48 INFO Epoch 087 | train_mse=0.063754 | val_loss=0.066393 | best_val_loss=0.320391
Metric tuning_rank_spearman improved by 0.003 >= min_delta = 0.0. New best score: 0.324
2025-12-24 15:15:56 INFO Epoch 088 | 25% complete (batch 46/181)
2025-12-24 15:15:57 INFO Epoch 088 | 50% complete (batch 91/181)
2025-12-24 15:15:58 INFO Epoch 088 | 75% complete (batch 136/181)
2025-12-24 15:16:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.748335
2025-12-24 15:16:12 INFO Tuning ranking metrics: regret=0.093886 spearman=0.273016 (groups=39, skipped=329)
2025-12-24 15:16:12 INFO Epoch 088 | train_mse=0.067095 | val_loss=0.048654 | best_val_loss=0.323748
2025-12-24 15:16:21 INFO Epoch 089 | 25% complete (batch 46/181)
2025-12-24 15:16:22 INFO Epoch 089 | 50% complete (batch 91/181)
2025-12-24 15:16:23 INFO Epoch 089 | 75% complete (batch 136/181)
2025-12-24 15:16:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.746533
2025-12-24 15:16:36 INFO Tuning ranking metrics: regret=0.093311 spearman=0.291392 (groups=39, skipped=329)
2025-12-24 15:16:36 INFO Epoch 089 | train_mse=0.044692 | val_loss=0.052467 | best_val_loss=0.323748
2025-12-24 15:16:45 INFO Epoch 090 | 25% complete (batch 46/181)
2025-12-24 15:16:46 INFO Epoch 090 | 50% complete (batch 91/181)
2025-12-24 15:16:47 INFO Epoch 090 | 75% complete (batch 136/181)
2025-12-24 15:16:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.743433
2025-12-24 15:17:01 INFO Tuning ranking metrics: regret=0.093946 spearman=0.276923 (groups=39, skipped=329)
2025-12-24 15:17:01 INFO Epoch 090 | train_mse=0.058785 | val_loss=0.052751 | best_val_loss=0.323748
2025-12-24 15:17:09 INFO Epoch 091 | 25% complete (batch 46/181)
2025-12-24 15:17:10 INFO Epoch 091 | 50% complete (batch 91/181)
2025-12-24 15:17:11 INFO Epoch 091 | 75% complete (batch 136/181)
2025-12-24 15:17:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.753978
2025-12-24 15:17:25 INFO Tuning ranking metrics: regret=0.093886 spearman=0.281441 (groups=39, skipped=329)
2025-12-24 15:17:25 INFO Epoch 091 | train_mse=0.069074 | val_loss=0.049399 | best_val_loss=0.323748
2025-12-24 15:17:33 INFO Epoch 092 | 25% complete (batch 46/181)
2025-12-24 15:17:34 INFO Epoch 092 | 50% complete (batch 91/181)
2025-12-24 15:17:35 INFO Epoch 092 | 75% complete (batch 136/181)
2025-12-24 15:17:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.756513
2025-12-24 15:17:49 INFO Tuning ranking metrics: regret=0.087734 spearman=0.285043 (groups=39, skipped=329)
2025-12-24 15:17:49 INFO Epoch 092 | train_mse=0.057568 | val_loss=0.055952 | best_val_loss=0.323748
2025-12-24 15:17:57 INFO Epoch 093 | 25% complete (batch 46/181)
2025-12-24 15:17:58 INFO Epoch 093 | 50% complete (batch 91/181)
2025-12-24 15:17:59 INFO Epoch 093 | 75% complete (batch 136/181)
2025-12-24 15:18:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.754905
2025-12-24 15:18:13 INFO Tuning ranking metrics: regret=0.093886 spearman=0.256532 (groups=39, skipped=329)
2025-12-24 15:18:13 INFO Epoch 093 | train_mse=0.081314 | val_loss=0.048003 | best_val_loss=0.323748
2025-12-24 15:18:21 INFO Epoch 094 | 25% complete (batch 46/181)
2025-12-24 15:18:22 INFO Epoch 094 | 50% complete (batch 91/181)
2025-12-24 15:18:23 INFO Epoch 094 | 75% complete (batch 136/181)
2025-12-24 15:18:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.759337
2025-12-24 15:18:37 INFO Tuning ranking metrics: regret=0.093523 spearman=0.253175 (groups=39, skipped=329)
2025-12-24 15:18:37 INFO Epoch 094 | train_mse=0.061256 | val_loss=0.048350 | best_val_loss=0.323748
2025-12-24 15:18:45 INFO Epoch 095 | 25% complete (batch 46/181)
2025-12-24 15:18:46 INFO Epoch 095 | 50% complete (batch 91/181)
2025-12-24 15:18:47 INFO Epoch 095 | 75% complete (batch 136/181)
2025-12-24 15:18:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.739190
2025-12-24 15:19:01 INFO Tuning ranking metrics: regret=0.093523 spearman=0.246764 (groups=39, skipped=329)
2025-12-24 15:19:01 INFO Epoch 095 | train_mse=0.051122 | val_loss=0.064539 | best_val_loss=0.323748
2025-12-24 15:19:09 INFO Epoch 096 | 25% complete (batch 46/181)
2025-12-24 15:19:10 INFO Epoch 096 | 50% complete (batch 91/181)
2025-12-24 15:19:11 INFO Epoch 096 | 75% complete (batch 136/181)
2025-12-24 15:19:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.703070
2025-12-24 15:19:25 INFO Tuning ranking metrics: regret=0.093511 spearman=0.309707 (groups=39, skipped=329)
2025-12-24 15:19:25 INFO Epoch 096 | train_mse=0.050178 | val_loss=0.083120 | best_val_loss=0.323748
2025-12-24 15:19:33 INFO Epoch 097 | 25% complete (batch 46/181)
2025-12-24 15:19:34 INFO Epoch 097 | 50% complete (batch 91/181)
2025-12-24 15:19:35 INFO Epoch 097 | 75% complete (batch 136/181)
2025-12-24 15:19:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.709508
2025-12-24 15:19:49 INFO Tuning ranking metrics: regret=0.092415 spearman=0.298901 (groups=39, skipped=329)
2025-12-24 15:19:49 INFO Epoch 097 | train_mse=0.055855 | val_loss=0.079130 | best_val_loss=0.323748
2025-12-24 15:19:57 INFO Epoch 098 | 25% complete (batch 46/181)
2025-12-24 15:19:58 INFO Epoch 098 | 50% complete (batch 91/181)
2025-12-24 15:19:59 INFO Epoch 098 | 75% complete (batch 136/181)
2025-12-24 15:20:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.737011
2025-12-24 15:20:13 INFO Tuning ranking metrics: regret=0.093538 spearman=0.274847 (groups=39, skipped=329)
2025-12-24 15:20:13 INFO Epoch 098 | train_mse=0.067146 | val_loss=0.056926 | best_val_loss=0.323748
2025-12-24 15:20:22 INFO Epoch 099 | 25% complete (batch 46/181)
2025-12-24 15:20:23 INFO Epoch 099 | 50% complete (batch 91/181)
2025-12-24 15:20:23 INFO Epoch 099 | 75% complete (batch 136/181)
2025-12-24 15:20:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.734070
2025-12-24 15:20:37 INFO Tuning ranking metrics: regret=0.093523 spearman=0.267766 (groups=39, skipped=329)
2025-12-24 15:20:37 INFO Epoch 099 | train_mse=0.056530 | val_loss=0.053629 | best_val_loss=0.323748
2025-12-24 15:20:45 INFO Epoch 100 | 25% complete (batch 46/181)
2025-12-24 15:20:46 INFO Epoch 100 | 50% complete (batch 91/181)
2025-12-24 15:20:47 INFO Epoch 100 | 75% complete (batch 136/181)
2025-12-24 15:20:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.744561
2025-12-24 15:21:01 INFO Tuning ranking metrics: regret=0.080143 spearman=0.284310 (groups=39, skipped=329)
2025-12-24 15:21:01 INFO Epoch 100 | train_mse=0.068103 | val_loss=0.049846 | best_val_loss=0.323748
2025-12-24 15:21:09 INFO Epoch 101 | 25% complete (batch 46/181)
2025-12-24 15:21:10 INFO Epoch 101 | 50% complete (batch 91/181)
2025-12-24 15:21:11 INFO Epoch 101 | 75% complete (batch 136/181)
2025-12-24 15:21:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.673142
2025-12-24 15:21:25 INFO Tuning ranking metrics: regret=0.093722 spearman=0.299756 (groups=39, skipped=329)
2025-12-24 15:21:25 INFO Epoch 101 | train_mse=0.043112 | val_loss=0.131090 | best_val_loss=0.323748
2025-12-24 15:21:34 INFO Epoch 102 | 25% complete (batch 46/181)
2025-12-24 15:21:35 INFO Epoch 102 | 50% complete (batch 91/181)
2025-12-24 15:21:36 INFO Epoch 102 | 75% complete (batch 136/181)
2025-12-24 15:21:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.752720
2025-12-24 15:21:50 INFO Tuning ranking metrics: regret=0.093538 spearman=0.259280 (groups=39, skipped=329)
2025-12-24 15:21:50 INFO Epoch 102 | train_mse=0.053758 | val_loss=0.053910 | best_val_loss=0.323748
2025-12-24 15:21:58 INFO Epoch 103 | 25% complete (batch 46/181)
2025-12-24 15:21:59 INFO Epoch 103 | 50% complete (batch 91/181)
2025-12-24 15:22:00 INFO Epoch 103 | 75% complete (batch 136/181)
2025-12-24 15:22:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.729097
2025-12-24 15:22:14 INFO Tuning ranking metrics: regret=0.093096 spearman=0.277167 (groups=39, skipped=329)
2025-12-24 15:22:14 INFO Epoch 103 | train_mse=0.074644 | val_loss=0.067187 | best_val_loss=0.323748
2025-12-24 15:22:22 INFO Epoch 104 | 25% complete (batch 46/181)
2025-12-24 15:22:23 INFO Epoch 104 | 50% complete (batch 91/181)
2025-12-24 15:22:24 INFO Epoch 104 | 75% complete (batch 136/181)
2025-12-24 15:22:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.761058
2025-12-24 15:22:38 INFO Tuning ranking metrics: regret=0.107025 spearman=0.260989 (groups=39, skipped=329)
2025-12-24 15:22:38 INFO Epoch 104 | train_mse=0.054944 | val_loss=0.046024 | best_val_loss=0.323748
2025-12-24 15:22:46 INFO Epoch 105 | 25% complete (batch 46/181)
2025-12-24 15:22:47 INFO Epoch 105 | 50% complete (batch 91/181)
2025-12-24 15:22:48 INFO Epoch 105 | 75% complete (batch 136/181)
2025-12-24 15:22:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.738743
2025-12-24 15:23:02 INFO Tuning ranking metrics: regret=0.100343 spearman=0.290415 (groups=39, skipped=329)
2025-12-24 15:23:02 INFO Epoch 105 | train_mse=0.063472 | val_loss=0.073068 | best_val_loss=0.323748
2025-12-24 15:23:10 INFO Epoch 106 | 25% complete (batch 46/181)
2025-12-24 15:23:12 INFO Epoch 106 | 50% complete (batch 91/181)
2025-12-24 15:23:12 INFO Epoch 106 | 75% complete (batch 136/181)
2025-12-24 15:23:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.751438
2025-12-24 15:23:26 INFO Tuning ranking metrics: regret=0.093338 spearman=0.260501 (groups=39, skipped=329)
2025-12-24 15:23:26 INFO Epoch 106 | train_mse=0.063576 | val_loss=0.046305 | best_val_loss=0.323748
2025-12-24 15:23:35 INFO Epoch 107 | 25% complete (batch 46/181)
2025-12-24 15:23:36 INFO Epoch 107 | 50% complete (batch 91/181)
2025-12-24 15:23:37 INFO Epoch 107 | 75% complete (batch 136/181)
2025-12-24 15:23:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.761930
2025-12-24 15:23:51 INFO Tuning ranking metrics: regret=0.093538 spearman=0.272955 (groups=39, skipped=329)
2025-12-24 15:23:51 INFO Epoch 107 | train_mse=0.050896 | val_loss=0.048338 | best_val_loss=0.323748
2025-12-24 15:23:59 INFO Epoch 108 | 25% complete (batch 46/181)
2025-12-24 15:24:00 INFO Epoch 108 | 50% complete (batch 91/181)
2025-12-24 15:24:01 INFO Epoch 108 | 75% complete (batch 136/181)
2025-12-24 15:24:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.749274
2025-12-24 15:24:15 INFO Tuning ranking metrics: regret=0.081938 spearman=0.326801 (groups=39, skipped=329)
2025-12-24 15:24:15 INFO Epoch 108 | train_mse=0.049489 | val_loss=0.051554 | best_val_loss=0.323748
Metric tuning_rank_spearman improved by 0.003 >= min_delta = 0.0. New best score: 0.327
2025-12-24 15:24:23 INFO Epoch 109 | 25% complete (batch 46/181)
2025-12-24 15:24:24 INFO Epoch 109 | 50% complete (batch 91/181)
2025-12-24 15:24:25 INFO Epoch 109 | 75% complete (batch 136/181)
2025-12-24 15:24:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.735761
2025-12-24 15:24:39 INFO Tuning ranking metrics: regret=0.093569 spearman=0.280647 (groups=39, skipped=329)
2025-12-24 15:24:39 INFO Epoch 109 | train_mse=0.044072 | val_loss=0.052391 | best_val_loss=0.326801
2025-12-24 15:24:47 INFO Epoch 110 | 25% complete (batch 46/181)
2025-12-24 15:24:48 INFO Epoch 110 | 50% complete (batch 91/181)
2025-12-24 15:24:50 INFO Epoch 110 | 75% complete (batch 136/181)
2025-12-24 15:24:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.729120
2025-12-24 15:25:03 INFO Tuning ranking metrics: regret=0.088389 spearman=0.327350 (groups=39, skipped=329)
2025-12-24 15:25:03 INFO Epoch 110 | train_mse=0.053690 | val_loss=0.060474 | best_val_loss=0.326801
Metric tuning_rank_spearman improved by 0.001 >= min_delta = 0.0. New best score: 0.327
2025-12-24 15:25:12 INFO Epoch 111 | 25% complete (batch 46/181)
2025-12-24 15:25:13 INFO Epoch 111 | 50% complete (batch 91/181)
2025-12-24 15:25:14 INFO Epoch 111 | 75% complete (batch 136/181)
2025-12-24 15:25:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.748806
2025-12-24 15:25:27 INFO Tuning ranking metrics: regret=0.093569 spearman=0.268437 (groups=39, skipped=329)
2025-12-24 15:25:27 INFO Epoch 111 | train_mse=0.058015 | val_loss=0.050680 | best_val_loss=0.327350
2025-12-24 15:25:36 INFO Epoch 112 | 25% complete (batch 46/181)
2025-12-24 15:25:37 INFO Epoch 112 | 50% complete (batch 91/181)
2025-12-24 15:25:38 INFO Epoch 112 | 75% complete (batch 136/181)
2025-12-24 15:25:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.742452
2025-12-24 15:25:52 INFO Tuning ranking metrics: regret=0.106744 spearman=0.230830 (groups=39, skipped=329)
2025-12-24 15:25:52 INFO Epoch 112 | train_mse=0.072890 | val_loss=0.058360 | best_val_loss=0.327350
2025-12-24 15:26:00 INFO Epoch 113 | 25% complete (batch 46/181)
2025-12-24 15:26:02 INFO Epoch 113 | 50% complete (batch 91/181)
2025-12-24 15:26:03 INFO Epoch 113 | 75% complete (batch 136/181)
2025-12-24 15:26:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.740170
2025-12-24 15:26:17 INFO Tuning ranking metrics: regret=0.107365 spearman=0.209158 (groups=39, skipped=329)
2025-12-24 15:26:17 INFO Epoch 113 | train_mse=0.059716 | val_loss=0.051386 | best_val_loss=0.327350
2025-12-24 15:26:25 INFO Epoch 114 | 25% complete (batch 46/181)
2025-12-24 15:26:26 INFO Epoch 114 | 50% complete (batch 91/181)
2025-12-24 15:26:27 INFO Epoch 114 | 75% complete (batch 136/181)
2025-12-24 15:26:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.736191
2025-12-24 15:26:40 INFO Tuning ranking metrics: regret=0.093719 spearman=0.298352 (groups=39, skipped=329)
2025-12-24 15:26:40 INFO Epoch 114 | train_mse=0.048737 | val_loss=0.055030 | best_val_loss=0.327350
2025-12-24 15:26:49 INFO Epoch 115 | 25% complete (batch 46/181)
2025-12-24 15:26:50 INFO Epoch 115 | 50% complete (batch 91/181)
2025-12-24 15:26:51 INFO Epoch 115 | 75% complete (batch 136/181)
2025-12-24 15:26:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.729570
2025-12-24 15:27:04 INFO Tuning ranking metrics: regret=0.093753 spearman=0.277839 (groups=39, skipped=329)
2025-12-24 15:27:04 INFO Epoch 115 | train_mse=0.048640 | val_loss=0.059203 | best_val_loss=0.327350
2025-12-24 15:27:13 INFO Epoch 116 | 25% complete (batch 46/181)
2025-12-24 15:27:14 INFO Epoch 116 | 50% complete (batch 91/181)
2025-12-24 15:27:14 INFO Epoch 116 | 75% complete (batch 136/181)
2025-12-24 15:27:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.717035
2025-12-24 15:27:28 INFO Tuning ranking metrics: regret=0.095777 spearman=0.293162 (groups=39, skipped=329)
2025-12-24 15:27:28 INFO Epoch 116 | train_mse=0.061348 | val_loss=0.061493 | best_val_loss=0.327350
2025-12-24 15:27:37 INFO Epoch 117 | 25% complete (batch 46/181)
2025-12-24 15:27:37 INFO Epoch 117 | 50% complete (batch 91/181)
2025-12-24 15:27:38 INFO Epoch 117 | 75% complete (batch 136/181)
2025-12-24 15:27:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.728351
2025-12-24 15:27:52 INFO Tuning ranking metrics: regret=0.093342 spearman=0.270452 (groups=39, skipped=329)
2025-12-24 15:27:52 INFO Epoch 117 | train_mse=0.060974 | val_loss=0.049774 | best_val_loss=0.327350
2025-12-24 15:28:01 INFO Epoch 118 | 25% complete (batch 46/181)
2025-12-24 15:28:02 INFO Epoch 118 | 50% complete (batch 91/181)
2025-12-24 15:28:03 INFO Epoch 118 | 75% complete (batch 136/181)
2025-12-24 15:28:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.758574
2025-12-24 15:28:16 INFO Tuning ranking metrics: regret=0.092106 spearman=0.209890 (groups=39, skipped=329)
2025-12-24 15:28:16 INFO Epoch 118 | train_mse=0.056235 | val_loss=0.043428 | best_val_loss=0.327350
2025-12-24 15:28:25 INFO Epoch 119 | 25% complete (batch 46/181)
2025-12-24 15:28:26 INFO Epoch 119 | 50% complete (batch 91/181)
2025-12-24 15:28:27 INFO Epoch 119 | 75% complete (batch 136/181)
2025-12-24 15:28:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.759325
2025-12-24 15:28:41 INFO Tuning ranking metrics: regret=0.093549 spearman=0.268864 (groups=39, skipped=329)
2025-12-24 15:28:41 INFO Epoch 119 | train_mse=0.055457 | val_loss=0.049267 | best_val_loss=0.327350
2025-12-24 15:28:49 INFO Epoch 120 | 25% complete (batch 46/181)
2025-12-24 15:28:50 INFO Epoch 120 | 50% complete (batch 91/181)
2025-12-24 15:28:51 INFO Epoch 120 | 75% complete (batch 136/181)
2025-12-24 15:29:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.755742
2025-12-24 15:29:05 INFO Tuning ranking metrics: regret=0.093523 spearman=0.270452 (groups=39, skipped=329)
2025-12-24 15:29:05 INFO Epoch 120 | train_mse=0.045619 | val_loss=0.050770 | best_val_loss=0.327350
2025-12-24 15:29:13 INFO Epoch 121 | 25% complete (batch 46/181)
2025-12-24 15:29:14 INFO Epoch 121 | 50% complete (batch 91/181)
2025-12-24 15:29:15 INFO Epoch 121 | 75% complete (batch 136/181)
2025-12-24 15:29:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.752262
2025-12-24 15:29:29 INFO Tuning ranking metrics: regret=0.094086 spearman=0.263797 (groups=39, skipped=329)
2025-12-24 15:29:29 INFO Epoch 121 | train_mse=0.048706 | val_loss=0.049992 | best_val_loss=0.327350
2025-12-24 15:29:37 INFO Epoch 122 | 25% complete (batch 46/181)
2025-12-24 15:29:38 INFO Epoch 122 | 50% complete (batch 91/181)
2025-12-24 15:29:39 INFO Epoch 122 | 75% complete (batch 136/181)
2025-12-24 15:29:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.752381
2025-12-24 15:29:53 INFO Tuning ranking metrics: regret=0.094085 spearman=0.269414 (groups=39, skipped=329)
2025-12-24 15:29:53 INFO Epoch 122 | train_mse=0.058947 | val_loss=0.049168 | best_val_loss=0.327350
2025-12-24 15:30:01 INFO Epoch 123 | 25% complete (batch 46/181)
2025-12-24 15:30:02 INFO Epoch 123 | 50% complete (batch 91/181)
2025-12-24 15:30:03 INFO Epoch 123 | 75% complete (batch 136/181)
2025-12-24 15:30:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.749878
2025-12-24 15:30:17 INFO Tuning ranking metrics: regret=0.106885 spearman=0.236752 (groups=39, skipped=329)
2025-12-24 15:30:17 INFO Epoch 123 | train_mse=0.043612 | val_loss=0.050984 | best_val_loss=0.327350
2025-12-24 15:30:25 INFO Epoch 124 | 25% complete (batch 46/181)
2025-12-24 15:30:26 INFO Epoch 124 | 50% complete (batch 91/181)
2025-12-24 15:30:27 INFO Epoch 124 | 75% complete (batch 136/181)
2025-12-24 15:30:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.751436
2025-12-24 15:30:41 INFO Tuning ranking metrics: regret=0.125377 spearman=0.234005 (groups=39, skipped=329)
2025-12-24 15:30:41 INFO Epoch 124 | train_mse=0.049809 | val_loss=0.048688 | best_val_loss=0.327350
2025-12-24 15:30:49 INFO Epoch 125 | 25% complete (batch 46/181)
2025-12-24 15:30:50 INFO Epoch 125 | 50% complete (batch 91/181)
2025-12-24 15:30:51 INFO Epoch 125 | 75% complete (batch 136/181)
2025-12-24 15:31:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.747694
2025-12-24 15:31:05 INFO Tuning ranking metrics: regret=0.117713 spearman=0.237668 (groups=39, skipped=329)
2025-12-24 15:31:05 INFO Epoch 125 | train_mse=0.046665 | val_loss=0.046612 | best_val_loss=0.327350
2025-12-24 15:31:13 INFO Epoch 126 | 25% complete (batch 46/181)
2025-12-24 15:31:14 INFO Epoch 126 | 50% complete (batch 91/181)
2025-12-24 15:31:15 INFO Epoch 126 | 75% complete (batch 136/181)
2025-12-24 15:31:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.757192
2025-12-24 15:31:29 INFO Tuning ranking metrics: regret=0.127237 spearman=0.233211 (groups=39, skipped=329)
2025-12-24 15:31:29 INFO Epoch 126 | train_mse=0.054525 | val_loss=0.061561 | best_val_loss=0.327350
2025-12-24 15:31:37 INFO Epoch 127 | 25% complete (batch 46/181)
2025-12-24 15:31:38 INFO Epoch 127 | 50% complete (batch 91/181)
2025-12-24 15:31:39 INFO Epoch 127 | 75% complete (batch 136/181)
2025-12-24 15:31:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.732623
2025-12-24 15:31:53 INFO Tuning ranking metrics: regret=0.109494 spearman=0.255006 (groups=39, skipped=329)
2025-12-24 15:31:53 INFO Epoch 127 | train_mse=0.054433 | val_loss=0.072447 | best_val_loss=0.327350
2025-12-24 15:32:01 INFO Epoch 128 | 25% complete (batch 46/181)
2025-12-24 15:32:02 INFO Epoch 128 | 50% complete (batch 91/181)
2025-12-24 15:32:03 INFO Epoch 128 | 75% complete (batch 136/181)
2025-12-24 15:32:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.729686
2025-12-24 15:32:17 INFO Tuning ranking metrics: regret=0.108767 spearman=0.217705 (groups=39, skipped=329)
2025-12-24 15:32:17 INFO Epoch 128 | train_mse=0.060582 | val_loss=0.054123 | best_val_loss=0.327350
2025-12-24 15:32:25 INFO Epoch 129 | 25% complete (batch 46/181)
2025-12-24 15:32:26 INFO Epoch 129 | 50% complete (batch 91/181)
2025-12-24 15:32:27 INFO Epoch 129 | 75% complete (batch 136/181)
2025-12-24 15:32:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.732168
2025-12-24 15:32:41 INFO Tuning ranking metrics: regret=0.107236 spearman=0.178510 (groups=39, skipped=329)
2025-12-24 15:32:41 INFO Epoch 129 | train_mse=0.086165 | val_loss=0.058282 | best_val_loss=0.327350
2025-12-24 15:32:49 INFO Epoch 130 | 25% complete (batch 46/181)
2025-12-24 15:32:50 INFO Epoch 130 | 50% complete (batch 91/181)
2025-12-24 15:32:51 INFO Epoch 130 | 75% complete (batch 136/181)
2025-12-24 15:33:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.728513
2025-12-24 15:33:05 INFO Tuning ranking metrics: regret=0.095448 spearman=0.234982 (groups=39, skipped=329)
2025-12-24 15:33:05 INFO Epoch 130 | train_mse=0.050054 | val_loss=0.055179 | best_val_loss=0.327350
2025-12-24 15:33:13 INFO Epoch 131 | 25% complete (batch 46/181)
2025-12-24 15:33:14 INFO Epoch 131 | 50% complete (batch 91/181)
2025-12-24 15:33:15 INFO Epoch 131 | 75% complete (batch 136/181)
2025-12-24 15:33:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.722930
2025-12-24 15:33:29 INFO Tuning ranking metrics: regret=0.112330 spearman=0.186752 (groups=39, skipped=329)
2025-12-24 15:33:29 INFO Epoch 131 | train_mse=0.063564 | val_loss=0.052478 | best_val_loss=0.327350
2025-12-24 15:33:37 INFO Epoch 132 | 25% complete (batch 46/181)
2025-12-24 15:33:38 INFO Epoch 132 | 50% complete (batch 91/181)
2025-12-24 15:33:39 INFO Epoch 132 | 75% complete (batch 136/181)
2025-12-24 15:33:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.741208
2025-12-24 15:33:53 INFO Tuning ranking metrics: regret=0.107025 spearman=0.184737 (groups=39, skipped=329)
2025-12-24 15:33:53 INFO Epoch 132 | train_mse=0.048193 | val_loss=0.052561 | best_val_loss=0.327350
2025-12-24 15:34:02 INFO Epoch 133 | 25% complete (batch 46/181)
2025-12-24 15:34:03 INFO Epoch 133 | 50% complete (batch 91/181)
2025-12-24 15:34:04 INFO Epoch 133 | 75% complete (batch 136/181)
2025-12-24 15:34:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.737352
2025-12-24 15:34:17 INFO Tuning ranking metrics: regret=0.107367 spearman=0.162027 (groups=39, skipped=329)
2025-12-24 15:34:17 INFO Epoch 133 | train_mse=0.064857 | val_loss=0.065991 | best_val_loss=0.327350
2025-12-24 15:34:26 INFO Epoch 134 | 25% complete (batch 46/181)
2025-12-24 15:34:27 INFO Epoch 134 | 50% complete (batch 91/181)
2025-12-24 15:34:28 INFO Epoch 134 | 75% complete (batch 136/181)
2025-12-24 15:34:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.728437
2025-12-24 15:34:41 INFO Tuning ranking metrics: regret=0.106909 spearman=0.224237 (groups=39, skipped=329)
2025-12-24 15:34:41 INFO Epoch 134 | train_mse=0.047825 | val_loss=0.055859 | best_val_loss=0.327350
2025-12-24 15:34:50 INFO Epoch 135 | 25% complete (batch 46/181)
2025-12-24 15:34:51 INFO Epoch 135 | 50% complete (batch 91/181)
2025-12-24 15:34:52 INFO Epoch 135 | 75% complete (batch 136/181)
2025-12-24 15:35:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.722066
2025-12-24 15:35:05 INFO Tuning ranking metrics: regret=0.107398 spearman=0.209524 (groups=39, skipped=329)
2025-12-24 15:35:05 INFO Epoch 135 | train_mse=0.064074 | val_loss=0.061072 | best_val_loss=0.327350
2025-12-24 15:35:14 INFO Epoch 136 | 25% complete (batch 46/181)
2025-12-24 15:35:15 INFO Epoch 136 | 50% complete (batch 91/181)
2025-12-24 15:35:16 INFO Epoch 136 | 75% complete (batch 136/181)
2025-12-24 15:35:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.675533
2025-12-24 15:35:30 INFO Tuning ranking metrics: regret=0.083203 spearman=0.215873 (groups=39, skipped=329)
2025-12-24 15:35:30 INFO Epoch 136 | train_mse=0.044311 | val_loss=0.091039 | best_val_loss=0.327350
2025-12-24 15:35:38 INFO Epoch 137 | 25% complete (batch 46/181)
2025-12-24 15:35:39 INFO Epoch 137 | 50% complete (batch 91/181)
2025-12-24 15:35:40 INFO Epoch 137 | 75% complete (batch 136/181)
2025-12-24 15:35:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.690698
2025-12-24 15:35:54 INFO Tuning ranking metrics: regret=0.052104 spearman=0.392552 (groups=39, skipped=329)
2025-12-24 15:35:54 INFO Epoch 137 | train_mse=0.077138 | val_loss=0.066065 | best_val_loss=0.327350
Metric tuning_rank_spearman improved by 0.065 >= min_delta = 0.0. New best score: 0.393
2025-12-24 15:36:02 INFO Epoch 138 | 25% complete (batch 46/181)
2025-12-24 15:36:03 INFO Epoch 138 | 50% complete (batch 91/181)
2025-12-24 15:36:04 INFO Epoch 138 | 75% complete (batch 136/181)
2025-12-24 15:36:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.702840
2025-12-24 15:36:18 INFO Tuning ranking metrics: regret=0.107309 spearman=0.213614 (groups=39, skipped=329)
2025-12-24 15:36:18 INFO Epoch 138 | train_mse=0.044181 | val_loss=0.067774 | best_val_loss=0.392552
2025-12-24 15:36:26 INFO Epoch 139 | 25% complete (batch 46/181)
2025-12-24 15:36:27 INFO Epoch 139 | 50% complete (batch 91/181)
2025-12-24 15:36:28 INFO Epoch 139 | 75% complete (batch 136/181)
2025-12-24 15:36:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.728926
2025-12-24 15:36:42 INFO Tuning ranking metrics: regret=0.073499 spearman=0.232173 (groups=39, skipped=329)
2025-12-24 15:36:42 INFO Epoch 139 | train_mse=0.051957 | val_loss=0.055923 | best_val_loss=0.392552
2025-12-24 15:36:51 INFO Epoch 140 | 25% complete (batch 46/181)
2025-12-24 15:36:51 INFO Epoch 140 | 50% complete (batch 91/181)
2025-12-24 15:36:52 INFO Epoch 140 | 75% complete (batch 136/181)
2025-12-24 15:37:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.725705
2025-12-24 15:37:06 INFO Tuning ranking metrics: regret=0.100596 spearman=0.205617 (groups=39, skipped=329)
2025-12-24 15:37:06 INFO Epoch 140 | train_mse=0.055839 | val_loss=0.052487 | best_val_loss=0.392552
2025-12-24 15:37:15 INFO Epoch 141 | 25% complete (batch 46/181)
2025-12-24 15:37:15 INFO Epoch 141 | 50% complete (batch 91/181)
2025-12-24 15:37:16 INFO Epoch 141 | 75% complete (batch 136/181)
2025-12-24 15:37:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.730422
2025-12-24 15:37:30 INFO Tuning ranking metrics: regret=0.107247 spearman=0.183089 (groups=39, skipped=329)
2025-12-24 15:37:30 INFO Epoch 141 | train_mse=0.048698 | val_loss=0.050973 | best_val_loss=0.392552
2025-12-24 15:37:38 INFO Epoch 142 | 25% complete (batch 46/181)
2025-12-24 15:37:39 INFO Epoch 142 | 50% complete (batch 91/181)
2025-12-24 15:37:40 INFO Epoch 142 | 75% complete (batch 136/181)
2025-12-24 15:37:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.721347
2025-12-24 15:37:54 INFO Tuning ranking metrics: regret=0.073831 spearman=0.243895 (groups=39, skipped=329)
2025-12-24 15:37:54 INFO Epoch 142 | train_mse=0.046091 | val_loss=0.056929 | best_val_loss=0.392552
2025-12-24 15:38:03 INFO Epoch 143 | 25% complete (batch 46/181)
2025-12-24 15:38:04 INFO Epoch 143 | 50% complete (batch 91/181)
2025-12-24 15:38:05 INFO Epoch 143 | 75% complete (batch 136/181)
2025-12-24 15:38:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.731922
2025-12-24 15:38:18 INFO Tuning ranking metrics: regret=0.080181 spearman=0.222772 (groups=39, skipped=329)
2025-12-24 15:38:18 INFO Epoch 143 | train_mse=0.046446 | val_loss=0.051519 | best_val_loss=0.392552
2025-12-24 15:38:27 INFO Epoch 144 | 25% complete (batch 46/181)
2025-12-24 15:38:28 INFO Epoch 144 | 50% complete (batch 91/181)
2025-12-24 15:38:29 INFO Epoch 144 | 75% complete (batch 136/181)
2025-12-24 15:38:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.735572
2025-12-24 15:38:43 INFO Tuning ranking metrics: regret=0.080181 spearman=0.202930 (groups=39, skipped=329)
2025-12-24 15:38:43 INFO Epoch 144 | train_mse=0.057120 | val_loss=0.049143 | best_val_loss=0.392552
2025-12-24 15:38:51 INFO Epoch 145 | 25% complete (batch 46/181)
2025-12-24 15:38:52 INFO Epoch 145 | 50% complete (batch 91/181)
2025-12-24 15:38:53 INFO Epoch 145 | 75% complete (batch 136/181)
2025-12-24 15:39:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.737413
2025-12-24 15:39:07 INFO Tuning ranking metrics: regret=0.073499 spearman=0.197985 (groups=39, skipped=329)
2025-12-24 15:39:07 INFO Epoch 145 | train_mse=0.054148 | val_loss=0.049531 | best_val_loss=0.392552
2025-12-24 15:39:15 INFO Epoch 146 | 25% complete (batch 46/181)
2025-12-24 15:39:16 INFO Epoch 146 | 50% complete (batch 91/181)
2025-12-24 15:39:17 INFO Epoch 146 | 75% complete (batch 136/181)
2025-12-24 15:39:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.738922
2025-12-24 15:39:31 INFO Tuning ranking metrics: regret=0.073862 spearman=0.201648 (groups=39, skipped=329)
2025-12-24 15:39:31 INFO Epoch 146 | train_mse=0.040907 | val_loss=0.051360 | best_val_loss=0.392552
2025-12-24 15:39:39 INFO Epoch 147 | 25% complete (batch 46/181)
2025-12-24 15:39:40 INFO Epoch 147 | 50% complete (batch 91/181)
2025-12-24 15:39:41 INFO Epoch 147 | 75% complete (batch 136/181)
2025-12-24 15:39:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.743806
2025-12-24 15:39:55 INFO Tuning ranking metrics: regret=0.080504 spearman=0.242430 (groups=39, skipped=329)
2025-12-24 15:39:55 INFO Epoch 147 | train_mse=0.038454 | val_loss=0.049712 | best_val_loss=0.392552
2025-12-24 15:40:03 INFO Epoch 148 | 25% complete (batch 46/181)
2025-12-24 15:40:04 INFO Epoch 148 | 50% complete (batch 91/181)
2025-12-24 15:40:05 INFO Epoch 148 | 75% complete (batch 136/181)
2025-12-24 15:40:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.745433
2025-12-24 15:40:18 INFO Tuning ranking metrics: regret=0.073247 spearman=0.248901 (groups=39, skipped=329)
2025-12-24 15:40:18 INFO Epoch 148 | train_mse=0.055381 | val_loss=0.050331 | best_val_loss=0.392552
2025-12-24 15:40:27 INFO Epoch 149 | 25% complete (batch 46/181)
2025-12-24 15:40:28 INFO Epoch 149 | 50% complete (batch 91/181)
2025-12-24 15:40:28 INFO Epoch 149 | 75% complete (batch 136/181)
2025-12-24 15:40:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.743843
2025-12-24 15:40:42 INFO Tuning ranking metrics: regret=0.073189 spearman=0.281502 (groups=39, skipped=329)
2025-12-24 15:40:42 INFO Epoch 149 | train_mse=0.058594 | val_loss=0.049390 | best_val_loss=0.392552
2025-12-24 15:40:51 INFO Epoch 150 | 25% complete (batch 46/181)
2025-12-24 15:40:52 INFO Epoch 150 | 50% complete (batch 91/181)
2025-12-24 15:40:53 INFO Epoch 150 | 75% complete (batch 136/181)
2025-12-24 15:41:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.748803
2025-12-24 15:41:06 INFO Tuning ranking metrics: regret=0.073862 spearman=0.204274 (groups=39, skipped=329)
2025-12-24 15:41:06 INFO Epoch 150 | train_mse=0.057258 | val_loss=0.051287 | best_val_loss=0.392552
2025-12-24 15:41:15 INFO Epoch 151 | 25% complete (batch 46/181)
2025-12-24 15:41:16 INFO Epoch 151 | 50% complete (batch 91/181)
2025-12-24 15:41:17 INFO Epoch 151 | 75% complete (batch 136/181)
2025-12-24 15:41:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.746478
2025-12-24 15:41:30 INFO Tuning ranking metrics: regret=0.093868 spearman=0.202442 (groups=39, skipped=329)
2025-12-24 15:41:30 INFO Epoch 151 | train_mse=0.055645 | val_loss=0.050930 | best_val_loss=0.392552
2025-12-24 15:41:39 INFO Epoch 152 | 25% complete (batch 46/181)
2025-12-24 15:41:40 INFO Epoch 152 | 50% complete (batch 91/181)
2025-12-24 15:41:41 INFO Epoch 152 | 75% complete (batch 136/181)
2025-12-24 15:41:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.745859
2025-12-24 15:41:55 INFO Tuning ranking metrics: regret=0.079929 spearman=0.233761 (groups=39, skipped=329)
2025-12-24 15:41:55 INFO Epoch 152 | train_mse=0.040164 | val_loss=0.047424 | best_val_loss=0.392552
2025-12-24 15:42:03 INFO Epoch 153 | 25% complete (batch 46/181)
2025-12-24 15:42:04 INFO Epoch 153 | 50% complete (batch 91/181)
2025-12-24 15:42:05 INFO Epoch 153 | 75% complete (batch 136/181)
2025-12-24 15:42:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.744013
2025-12-24 15:42:19 INFO Tuning ranking metrics: regret=0.093349 spearman=0.220513 (groups=39, skipped=329)
2025-12-24 15:42:19 INFO Epoch 153 | train_mse=0.057533 | val_loss=0.049672 | best_val_loss=0.392552
2025-12-24 15:42:27 INFO Epoch 154 | 25% complete (batch 46/181)
2025-12-24 15:42:28 INFO Epoch 154 | 50% complete (batch 91/181)
2025-12-24 15:42:29 INFO Epoch 154 | 75% complete (batch 136/181)
2025-12-24 15:42:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.746908
2025-12-24 15:42:43 INFO Tuning ranking metrics: regret=0.093349 spearman=0.221184 (groups=39, skipped=329)
2025-12-24 15:42:43 INFO Epoch 154 | train_mse=0.043133 | val_loss=0.049561 | best_val_loss=0.392552
2025-12-24 15:42:51 INFO Epoch 155 | 25% complete (batch 46/181)
2025-12-24 15:42:52 INFO Epoch 155 | 50% complete (batch 91/181)
2025-12-24 15:42:53 INFO Epoch 155 | 75% complete (batch 136/181)
2025-12-24 15:43:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.737018
2025-12-24 15:43:07 INFO Tuning ranking metrics: regret=0.105982 spearman=0.231197 (groups=39, skipped=329)
2025-12-24 15:43:07 INFO Epoch 155 | train_mse=0.043672 | val_loss=0.057422 | best_val_loss=0.392552
2025-12-24 15:43:15 INFO Epoch 156 | 25% complete (batch 46/181)
2025-12-24 15:43:16 INFO Epoch 156 | 50% complete (batch 91/181)
2025-12-24 15:43:17 INFO Epoch 156 | 75% complete (batch 136/181)
2025-12-24 15:43:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.746177
2025-12-24 15:43:31 INFO Tuning ranking metrics: regret=0.080098 spearman=0.255922 (groups=39, skipped=329)
2025-12-24 15:43:31 INFO Epoch 156 | train_mse=0.040609 | val_loss=0.050040 | best_val_loss=0.392552
2025-12-24 15:43:39 INFO Epoch 157 | 25% complete (batch 46/181)
2025-12-24 15:43:40 INFO Epoch 157 | 50% complete (batch 91/181)
2025-12-24 15:43:41 INFO Epoch 157 | 75% complete (batch 136/181)
2025-12-24 15:43:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.740432
2025-12-24 15:43:55 INFO Tuning ranking metrics: regret=0.080258 spearman=0.232967 (groups=39, skipped=329)
2025-12-24 15:43:55 INFO Epoch 157 | train_mse=0.059615 | val_loss=0.056388 | best_val_loss=0.392552
2025-12-24 15:44:04 INFO Epoch 158 | 25% complete (batch 46/181)
2025-12-24 15:44:05 INFO Epoch 158 | 50% complete (batch 91/181)
2025-12-24 15:44:06 INFO Epoch 158 | 75% complete (batch 136/181)
2025-12-24 15:44:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.743781
2025-12-24 15:44:19 INFO Tuning ranking metrics: regret=0.079086 spearman=0.245665 (groups=39, skipped=329)
2025-12-24 15:44:19 INFO Epoch 158 | train_mse=0.039594 | val_loss=0.053610 | best_val_loss=0.392552
2025-12-24 15:44:28 INFO Epoch 159 | 25% complete (batch 46/181)
2025-12-24 15:44:28 INFO Epoch 159 | 50% complete (batch 91/181)
2025-12-24 15:44:29 INFO Epoch 159 | 75% complete (batch 136/181)
2025-12-24 15:44:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.741106
2025-12-24 15:44:43 INFO Tuning ranking metrics: regret=0.078534 spearman=0.254151 (groups=39, skipped=329)
2025-12-24 15:44:43 INFO Epoch 159 | train_mse=0.042638 | val_loss=0.052647 | best_val_loss=0.392552
2025-12-24 15:44:52 INFO Epoch 160 | 25% complete (batch 46/181)
2025-12-24 15:44:53 INFO Epoch 160 | 50% complete (batch 91/181)
2025-12-24 15:44:53 INFO Epoch 160 | 75% complete (batch 136/181)
2025-12-24 15:45:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.748084
2025-12-24 15:45:07 INFO Tuning ranking metrics: regret=0.080183 spearman=0.198474 (groups=39, skipped=329)
2025-12-24 15:45:07 INFO Epoch 160 | train_mse=0.053489 | val_loss=0.048737 | best_val_loss=0.392552
2025-12-24 15:45:16 INFO Epoch 161 | 25% complete (batch 46/181)
2025-12-24 15:45:17 INFO Epoch 161 | 50% complete (batch 91/181)
2025-12-24 15:45:18 INFO Epoch 161 | 75% complete (batch 136/181)
2025-12-24 15:45:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.747593
2025-12-24 15:45:32 INFO Tuning ranking metrics: regret=0.080183 spearman=0.199451 (groups=39, skipped=329)
2025-12-24 15:45:32 INFO Epoch 161 | train_mse=0.048920 | val_loss=0.048339 | best_val_loss=0.392552
2025-12-24 15:45:40 INFO Epoch 162 | 25% complete (batch 46/181)
2025-12-24 15:45:41 INFO Epoch 162 | 50% complete (batch 91/181)
2025-12-24 15:45:42 INFO Epoch 162 | 75% complete (batch 136/181)
2025-12-24 15:45:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.748869
2025-12-24 15:45:56 INFO Tuning ranking metrics: regret=0.073541 spearman=0.202747 (groups=39, skipped=329)
2025-12-24 15:45:56 INFO Epoch 162 | train_mse=0.045148 | val_loss=0.048706 | best_val_loss=0.392552
2025-12-24 15:46:05 INFO Epoch 163 | 25% complete (batch 46/181)
2025-12-24 15:46:05 INFO Epoch 163 | 50% complete (batch 91/181)
2025-12-24 15:46:06 INFO Epoch 163 | 75% complete (batch 136/181)
2025-12-24 15:46:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.746769
2025-12-24 15:46:21 INFO Tuning ranking metrics: regret=0.073541 spearman=0.211661 (groups=39, skipped=329)
2025-12-24 15:46:21 INFO Epoch 163 | train_mse=0.054527 | val_loss=0.049784 | best_val_loss=0.392552
2025-12-24 15:46:29 INFO Epoch 164 | 25% complete (batch 46/181)
2025-12-24 15:46:30 INFO Epoch 164 | 50% complete (batch 91/181)
2025-12-24 15:46:31 INFO Epoch 164 | 75% complete (batch 136/181)
2025-12-24 15:46:40 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.750439
2025-12-24 15:46:45 INFO Tuning ranking metrics: regret=0.073541 spearman=0.207753 (groups=39, skipped=329)
2025-12-24 15:46:45 INFO Epoch 164 | train_mse=0.043410 | val_loss=0.049064 | best_val_loss=0.392552
2025-12-24 15:46:54 INFO Epoch 165 | 25% complete (batch 46/181)
2025-12-24 15:46:55 INFO Epoch 165 | 50% complete (batch 91/181)
2025-12-24 15:46:55 INFO Epoch 165 | 75% complete (batch 136/181)
2025-12-24 15:47:04 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.746789
2025-12-24 15:47:09 INFO Tuning ranking metrics: regret=0.073500 spearman=0.226496 (groups=39, skipped=329)
2025-12-24 15:47:09 INFO Epoch 165 | train_mse=0.049346 | val_loss=0.051943 | best_val_loss=0.392552
2025-12-24 15:47:18 INFO Epoch 166 | 25% complete (batch 46/181)
2025-12-24 15:47:19 INFO Epoch 166 | 50% complete (batch 91/181)
2025-12-24 15:47:20 INFO Epoch 166 | 75% complete (batch 136/181)
2025-12-24 15:47:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.749785
2025-12-24 15:47:33 INFO Tuning ranking metrics: regret=0.073541 spearman=0.215690 (groups=39, skipped=329)
2025-12-24 15:47:33 INFO Epoch 166 | train_mse=0.041032 | val_loss=0.048780 | best_val_loss=0.392552
2025-12-24 15:47:42 INFO Epoch 167 | 25% complete (batch 46/181)
2025-12-24 15:47:43 INFO Epoch 167 | 50% complete (batch 91/181)
2025-12-24 15:47:44 INFO Epoch 167 | 75% complete (batch 136/181)
2025-12-24 15:47:53 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.750767
2025-12-24 15:47:58 INFO Tuning ranking metrics: regret=0.073500 spearman=0.207631 (groups=39, skipped=329)
2025-12-24 15:47:58 INFO Epoch 167 | train_mse=0.047410 | val_loss=0.047899 | best_val_loss=0.392552
2025-12-24 15:48:07 INFO Epoch 168 | 25% complete (batch 46/181)
2025-12-24 15:48:08 INFO Epoch 168 | 50% complete (batch 91/181)
2025-12-24 15:48:09 INFO Epoch 168 | 75% complete (batch 136/181)
2025-12-24 15:48:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.752485
2025-12-24 15:48:22 INFO Tuning ranking metrics: regret=0.073500 spearman=0.221368 (groups=39, skipped=329)
2025-12-24 15:48:22 INFO Epoch 168 | train_mse=0.058598 | val_loss=0.047555 | best_val_loss=0.392552
2025-12-24 15:48:31 INFO Epoch 169 | 25% complete (batch 46/181)
2025-12-24 15:48:32 INFO Epoch 169 | 50% complete (batch 91/181)
2025-12-24 15:48:33 INFO Epoch 169 | 75% complete (batch 136/181)
2025-12-24 15:48:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.750386
2025-12-24 15:48:46 INFO Tuning ranking metrics: regret=0.073500 spearman=0.221368 (groups=39, skipped=329)
2025-12-24 15:48:46 INFO Epoch 169 | train_mse=0.052004 | val_loss=0.047709 | best_val_loss=0.392552
2025-12-24 15:48:54 INFO Epoch 170 | 25% complete (batch 46/181)
2025-12-24 15:48:55 INFO Epoch 170 | 50% complete (batch 91/181)
2025-12-24 15:48:56 INFO Epoch 170 | 75% complete (batch 136/181)
2025-12-24 15:49:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.750991
2025-12-24 15:49:10 INFO Tuning ranking metrics: regret=0.073500 spearman=0.223810 (groups=39, skipped=329)
2025-12-24 15:49:10 INFO Epoch 170 | train_mse=0.053183 | val_loss=0.047406 | best_val_loss=0.392552
2025-12-24 15:49:19 INFO Epoch 171 | 25% complete (batch 46/181)
2025-12-24 15:49:20 INFO Epoch 171 | 50% complete (batch 91/181)
2025-12-24 15:49:21 INFO Epoch 171 | 75% complete (batch 136/181)
2025-12-24 15:49:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.752348
2025-12-24 15:49:34 INFO Tuning ranking metrics: regret=0.073500 spearman=0.223810 (groups=39, skipped=329)
2025-12-24 15:49:34 INFO Epoch 171 | train_mse=0.048556 | val_loss=0.047525 | best_val_loss=0.392552
2025-12-24 15:49:43 INFO Epoch 172 | 25% complete (batch 46/181)
2025-12-24 15:49:44 INFO Epoch 172 | 50% complete (batch 91/181)
2025-12-24 15:49:45 INFO Epoch 172 | 75% complete (batch 136/181)
2025-12-24 15:49:53 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.752181
2025-12-24 15:49:58 INFO Tuning ranking metrics: regret=0.073541 spearman=0.214469 (groups=39, skipped=329)
2025-12-24 15:49:58 INFO Epoch 172 | train_mse=0.036352 | val_loss=0.047591 | best_val_loss=0.392552
2025-12-24 15:50:07 INFO Epoch 173 | 25% complete (batch 46/181)
2025-12-24 15:50:08 INFO Epoch 173 | 50% complete (batch 91/181)
2025-12-24 15:50:09 INFO Epoch 173 | 75% complete (batch 136/181)
2025-12-24 15:50:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.750191
2025-12-24 15:50:23 INFO Tuning ranking metrics: regret=0.080223 spearman=0.212759 (groups=39, skipped=329)
2025-12-24 15:50:23 INFO Epoch 173 | train_mse=0.038802 | val_loss=0.048675 | best_val_loss=0.392552
2025-12-24 15:50:32 INFO Epoch 174 | 25% complete (batch 46/181)
2025-12-24 15:50:33 INFO Epoch 174 | 50% complete (batch 91/181)
2025-12-24 15:50:34 INFO Epoch 174 | 75% complete (batch 136/181)
2025-12-24 15:50:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.750059
2025-12-24 15:50:48 INFO Tuning ranking metrics: regret=0.080223 spearman=0.214408 (groups=39, skipped=329)
2025-12-24 15:50:48 INFO Epoch 174 | train_mse=0.051106 | val_loss=0.049545 | best_val_loss=0.392552
2025-12-24 15:50:56 INFO Epoch 175 | 25% complete (batch 46/181)
2025-12-24 15:50:57 INFO Epoch 175 | 50% complete (batch 91/181)
2025-12-24 15:50:58 INFO Epoch 175 | 75% complete (batch 136/181)
2025-12-24 15:51:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.749207
2025-12-24 15:51:12 INFO Tuning ranking metrics: regret=0.080223 spearman=0.211844 (groups=39, skipped=329)
2025-12-24 15:51:12 INFO Epoch 175 | train_mse=0.041727 | val_loss=0.050331 | best_val_loss=0.392552
2025-12-24 15:51:21 INFO Epoch 176 | 25% complete (batch 46/181)
2025-12-24 15:51:22 INFO Epoch 176 | 50% complete (batch 91/181)
2025-12-24 15:51:23 INFO Epoch 176 | 75% complete (batch 136/181)
2025-12-24 15:51:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.751290
2025-12-24 15:51:36 INFO Tuning ranking metrics: regret=0.079969 spearman=0.196703 (groups=39, skipped=329)
2025-12-24 15:51:36 INFO Epoch 176 | train_mse=0.033449 | val_loss=0.048549 | best_val_loss=0.392552
2025-12-24 15:51:45 INFO Epoch 177 | 25% complete (batch 46/181)
2025-12-24 15:51:46 INFO Epoch 177 | 50% complete (batch 91/181)
2025-12-24 15:51:47 INFO Epoch 177 | 75% complete (batch 136/181)
2025-12-24 15:51:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.753094
2025-12-24 15:52:00 INFO Tuning ranking metrics: regret=0.080223 spearman=0.189072 (groups=39, skipped=329)
2025-12-24 15:52:00 INFO Epoch 177 | train_mse=0.042684 | val_loss=0.049880 | best_val_loss=0.392552
Monitored metric tuning_rank_spearman did not improve in the last 40 records. Best score: 0.393. Signaling Trainer to stop.
2025-12-24 15:52:01 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.32680_val-0.05155_epoch108.chkpt, checkpoint.tuning_rank_spearman-0.32735_val-0.06047_epoch110.chkpt, checkpoint.tuning_rank_spearman-0.39255_val-0.06607_epoch137.chkpt
2025-12-24 15:52:01 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed555/model_checkpoints/checkpoint.tuning_rank_spearman-0.39255_val-0.06607_epoch137.chkpt
2025-12-24 15:52:01 INFO Best validation loss: tensor(0.3926)
2025-12-24 15:52:01 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed555/model_checkpoints/checkpoint.tuning_rank_spearman-0.39255_val-0.06607_epoch137.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed555/model_checkpoints/checkpoint.tuning_rank_spearman-0.39255_val-0.06607_epoch137.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-24 15:52:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.066065
2025-12-24 15:52:14 INFO Tuning ranking metrics: regret=0.052104 spearman=0.392552 (groups=39, skipped=329)
2025-12-24 15:52:14 INFO Epoch 178 | val_loss=0.066065 | best_val_loss=0.392552
2025-12-24 15:52:14 INFO Validation metrics: [{'val_loss': 0.06606541574001312, 'tuning_rank_regret': 0.05210406333208084, 'tuning_rank_spearman': 0.39255189895629883, 'val_pearson_corr': 0.754959225654602, 'val_spearman_corr': 0.770613431930542, 'val_rank_regret': 0.02874894253909588, 'val_rank_spearman': 0.7777777910232544}]
2025-12-24 15:52:14 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.39255_val-0.06607_epoch137.chkpt
2025-12-24 15:52:14 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.32680_val-0.05155_epoch108.chkpt
2025-12-24 15:52:14 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.32735_val-0.06047_epoch110.chkpt
2025-12-24 15:52:14 INFO Renamed checkpoint file: alt_val.val-0.04343_epoch118.ckpt -> alt_val.val-0.04343_epoch118.chkpt
2025-12-24 15:52:14 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.04343_epoch118.chkpt
2025-12-24 15:52:14 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.05210406333208084
  tuning_rank_spearman      0.39255189895629883
        val_loss            0.06606541574001312
    val_pearson_corr         0.754959225654602
     val_rank_regret        0.02874894253909588
    val_rank_spearman       0.7777777910232544
    val_spearman_corr        0.770613431930542
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run polish_seed101_2025-12-24_11-12-07_phase2_seed555 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed555
[run_full_pipeline] Phase 2 (seed 555) best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed555/model_checkpoints/checkpoint.tuning_rank_spearman-0.39255_val-0.06607_epoch137.chkpt (tuning_rank_spearman=0.39255189895629883)
[run_full_pipeline] Phase 2 fine-tuning (seed 888) -> polish_seed101_2025-12-24_11-12-07_phase2_seed888
[train_cli] run_id=polish_seed101_2025-12-24_11-12-07_phase2_seed888 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed888/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed888 --git-commit 9b1bb2b320 --git-dirty --resume-from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.10132_val-0.05821_epoch065.chkpt
2025-12-24 15:52:21 INFO git_commit = 9b1bb2b320 (dirty)
2025-12-24 15:52:21 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-24 15:52:21 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed888/config/config.yaml
2025-12-24 15:52:21 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data
2025-12-24 15:52:21 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-24 15:52:21 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-24 15:52:21 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed888
2025-12-24 15:52:21 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-24 15:52:21 INFO   metadata_path = None
2025-12-24 15:52:21 INFO   summary_path = None
2025-12-24 15:52:21 INFO   accelerator = cpu
2025-12-24 15:52:21 INFO   devices = 1
2025-12-24 15:52:21 INFO   attention_head = 8
2025-12-24 15:52:21 INFO   pooling_type = mean
2025-12-24 15:52:21 INFO   model_self_loops = False
2025-12-24 15:52:21 INFO   model_self_loop_fill = mean
2025-12-24 15:52:21 INFO   model_residual = False
2025-12-24 15:52:21 INFO   batch_size = 48
2025-12-24 15:52:21 INFO   learning_rate = 0.001
2025-12-24 15:52:21 INFO   num_epochs = 320
2025-12-24 15:52:21 INFO   accumulate_grad_batches = 8
2025-12-24 15:52:21 INFO   seed = 888
2025-12-24 15:52:21 INFO   num_workers = 2
2025-12-24 15:52:21 INFO   precision = 32
2025-12-24 15:52:21 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-24 15:52:21 INFO   early_stopping_patience = 20
2025-12-24 15:52:21 INFO   lr_scheduler_patience = 4
2025-12-24 15:52:21 INFO   lr_scheduler_factor = 0.2
2025-12-24 15:52:21 INFO   fast_dev_run = False
2025-12-24 15:52:21 INFO   limit_train_batches = None
2025-12-24 15:52:21 INFO   limit_val_batches = None
2025-12-24 15:52:21 INFO   log_lr = False
2025-12-24 15:52:21 INFO   progress_bar_refresh_rate = 0
2025-12-24 15:52:21 INFO   log_every_n_steps = 100
2025-12-24 15:52:21 INFO   use_val_spearman_as_secondary = True
2025-12-24 15:52:21 INFO   spearman_secondary_min_delta = 0.0
2025-12-24 15:52:21 INFO   spearman_secondary_weight = 1.0
2025-12-24 15:52:21 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-24 15:52:21 INFO   tuning_max_samples = 500
2025-12-24 15:52:21 INFO   tuning_fraction = None
2025-12-24 15:52:21 INFO   tuning_eval_every = 1
2025-12-24 15:52:21 INFO   rank_loss_weight = 0.0
2025-12-24 15:52:21 INFO   rank_loss_margin = 0.0
2025-12-24 15:52:21 INFO   rank_loss_mode = hinge
2025-12-24 15:52:21 INFO   rank_loss_grouped = True
2025-12-24 15:52:21 INFO   variance_reduction_enabled = False
2025-12-24 15:52:21 INFO   variance_reduction_method = topk_avg
2025-12-24 15:52:21 INFO   variance_reduction_top_k = 3
2025-12-24 15:52:21 INFO   coverage_minimum = 0.0
2025-12-24 15:52:21 INFO   coverage_fail_on_missing = False
2025-12-24 15:52:21 INFO   graph_load_profiling = False
2025-12-24 15:52:21 INFO   graph_load_top_k = 5
2025-12-24 15:52:21 INFO   enable_graph_cache = True
2025-12-24 15:52:21 INFO   graph_cache_size = 256
2025-12-24 15:52:21 INFO   canonicalize_on_load = False
2025-12-24 15:52:21 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-24 15:52:21 INFO   edge_schema = {}
2025-12-24 15:52:21 INFO   topology_schema = {}
Seed set to 888
2025-12-24 15:52:21 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-24 15:52:21 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 15:52:21 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-24 15:52:21 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 15:52:21 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-24 15:52:21 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-24 15:52:23 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-24 15:52:23 INFO Tuning group stats: groups=351 groups>=2=40 singletons=311 max_group=10
2025-12-24 15:52:23 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed888/dataset_coverage.json
2025-12-24 15:52:23 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed888/dataset_coverage.json for details.
2025-12-24 15:52:23 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed888/dataset_coverage.json for details.
2025-12-24 15:52:23 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed888/dataset_coverage.json for details.
2025-12-24 15:52:23 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed888/schema_summary.json
2025-12-24 15:52:23 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed888/feature_metadata.json
2025-12-24 15:52:23 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-24 15:52:23 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/advanced_k_partite_v2/feature-config.yaml.advanced_lean.10A.v2, sha256=2022a36e7b21668173af3af66c25cf6b6a0494e642c0934eac38abbcfeebec3d
2025-12-24 15:52:23 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/work/edge_features)
2025-12-24 15:52:23 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json
2025-12-24 15:52:23 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed888/schema_summary.json
2025-12-24 15:52:23 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-24 15:52:23 INFO Topology: topology/persistence_k_partite_advanced/v2 (filtration_cutoff 8 Å, min_persistence 0.01) supporting the 628-dimensional node features.
2025-12-24 15:52:23 INFO Node: node/dssp_topo_merge_passthrough/v1; metadata lists 628 feature columns matching the .pt tensor.
2025-12-24 15:52:23 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-24 15:52:23 INFO → Total feature dimensionality observed and confirmed: node_dim = 628, edge_dim = 11.
2025-12-24 15:52:23 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-24 15:52:23 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 628,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge_passthrough/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 628,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/advanced_lean_10A/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed888/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge_passthrough/v1",
      "alias": "Passthrough (all dims from topology module) = Node Dynamic Dims",
      "jobs": 16,
      "summary": "DSSP/basic features merged with all topology columns (passthrough)."
    },
    "topology": {
      "id": "topology/persistence_k_partite_advanced/v2",
      "alias": "Advanced k-partite PH (v2 lean) topo_dim 596",
      "jobs": 16,
      "summary": "Fixed-width k-partite persistent homology with slot padding + missingness channels."
    }
  },
  "notes": []
}
2025-12-24 15:52:23 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-24 15:52:23 INFO Resuming from checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.10132_val-0.05821_epoch065.chkpt (epoch=65)
2025-12-24 15:52:24 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=5767a4c69bae4a978ed747a73716eb70)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-24 15:52:24 INFO Starting training (fast_dev_run=False)
2025-12-24 15:52:24 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed888/model_checkpoints exists and is not empty.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.10132_val-0.05821_epoch065.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase1/model_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed888/model_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase1/model_checkpoints/val_loss_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed888/model_checkpoints/val_loss_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 20.1 K | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
180 K     Trainable params
0         Non-trainable params
180 K     Total params
0.721     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
Restored all states from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.10132_val-0.05821_epoch065.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-24 15:52:38 INFO Epoch 066 | 25% complete (batch 46/181)
2025-12-24 15:52:39 INFO Epoch 066 | 50% complete (batch 91/181)
2025-12-24 15:52:39 INFO Epoch 066 | 75% complete (batch 136/181)
2025-12-24 15:52:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.068842
2025-12-24 15:52:53 INFO Tuning ranking metrics: regret=0.151002 spearman=0.161185 (groups=40, skipped=311)
2025-12-24 15:52:53 INFO Epoch 066 | val_loss=0.068842
2025-12-24 15:53:02 INFO Epoch 067 | 25% complete (batch 46/181)
2025-12-24 15:53:03 INFO Epoch 067 | 50% complete (batch 91/181)
2025-12-24 15:53:03 INFO Epoch 067 | 75% complete (batch 136/181)
2025-12-24 15:53:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.699158
2025-12-24 15:53:17 INFO Tuning ranking metrics: regret=0.134005 spearman=0.159995 (groups=40, skipped=311)
2025-12-24 15:53:17 INFO Epoch 067 | train_mse=0.059352 | val_loss=0.081315 | best_val_loss=0.161185
2025-12-24 15:53:26 INFO Epoch 068 | 25% complete (batch 46/181)
2025-12-24 15:53:27 INFO Epoch 068 | 50% complete (batch 91/181)
2025-12-24 15:53:27 INFO Epoch 068 | 75% complete (batch 136/181)
2025-12-24 15:53:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.691799
2025-12-24 15:53:41 INFO Tuning ranking metrics: regret=0.149194 spearman=0.188869 (groups=40, skipped=311)
2025-12-24 15:53:41 INFO Epoch 068 | train_mse=0.066783 | val_loss=0.071219 | best_val_loss=0.161185
2025-12-24 15:53:49 INFO Epoch 069 | 25% complete (batch 46/181)
2025-12-24 15:53:50 INFO Epoch 069 | 50% complete (batch 91/181)
2025-12-24 15:53:51 INFO Epoch 069 | 75% complete (batch 136/181)
2025-12-24 15:54:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.696673
2025-12-24 15:54:05 INFO Tuning ranking metrics: regret=0.129453 spearman=0.186228 (groups=40, skipped=311)
2025-12-24 15:54:05 INFO Epoch 069 | train_mse=0.069233 | val_loss=0.063427 | best_val_loss=0.188869
2025-12-24 15:54:13 INFO Epoch 070 | 25% complete (batch 46/181)
2025-12-24 15:54:14 INFO Epoch 070 | 50% complete (batch 91/181)
2025-12-24 15:54:15 INFO Epoch 070 | 75% complete (batch 136/181)
2025-12-24 15:54:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.715625
2025-12-24 15:54:29 INFO Tuning ranking metrics: regret=0.148756 spearman=0.188782 (groups=40, skipped=311)
2025-12-24 15:54:29 INFO Epoch 070 | train_mse=0.060852 | val_loss=0.058459 | best_val_loss=0.188869
2025-12-24 15:54:38 INFO Epoch 071 | 25% complete (batch 46/181)
2025-12-24 15:54:39 INFO Epoch 071 | 50% complete (batch 91/181)
2025-12-24 15:54:40 INFO Epoch 071 | 75% complete (batch 136/181)
2025-12-24 15:54:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.693002
2025-12-24 15:54:53 INFO Tuning ranking metrics: regret=0.147891 spearman=0.144389 (groups=40, skipped=311)
2025-12-24 15:54:53 INFO Epoch 071 | train_mse=0.064129 | val_loss=0.080077 | best_val_loss=0.188869
2025-12-24 15:55:02 INFO Epoch 072 | 25% complete (batch 46/181)
2025-12-24 15:55:03 INFO Epoch 072 | 50% complete (batch 91/181)
2025-12-24 15:55:03 INFO Epoch 072 | 75% complete (batch 136/181)
2025-12-24 15:55:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.698799
2025-12-24 15:55:17 INFO Tuning ranking metrics: regret=0.147984 spearman=0.122895 (groups=40, skipped=311)
2025-12-24 15:55:17 INFO Epoch 072 | train_mse=0.061080 | val_loss=0.062726 | best_val_loss=0.188869
Monitored metric tuning_rank_spearman did not improve in the last 40 records. Best score: 0.202. Signaling Trainer to stop.
2025-12-24 15:55:18 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.18623_val-0.06343_epoch069.chkpt, checkpoint.tuning_rank_spearman-0.18878_val-0.05846_epoch070.chkpt, checkpoint.tuning_rank_spearman-0.18887_val-0.07122_epoch068.chkpt
2025-12-24 15:55:18 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed888/model_checkpoints/checkpoint.tuning_rank_spearman-0.18887_val-0.07122_epoch068.chkpt
2025-12-24 15:55:18 INFO Best validation loss: tensor(0.1889)
2025-12-24 15:55:18 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed888/model_checkpoints/checkpoint.tuning_rank_spearman-0.18887_val-0.07122_epoch068.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed888/model_checkpoints/checkpoint.tuning_rank_spearman-0.18887_val-0.07122_epoch068.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-24 15:55:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.071219
2025-12-24 15:55:30 INFO Tuning ranking metrics: regret=0.149194 spearman=0.188869 (groups=40, skipped=311)
2025-12-24 15:55:30 INFO Epoch 073 | val_loss=0.071219 | best_val_loss=0.188869
2025-12-24 15:55:31 INFO Validation metrics: [{'val_loss': 0.07121855020523071, 'tuning_rank_regret': 0.14919359982013702, 'tuning_rank_spearman': 0.18886904418468475, 'val_pearson_corr': 0.7329074144363403, 'val_spearman_corr': 0.760100245475769, 'val_rank_regret': 0.0, 'val_rank_spearman': 0.9444444179534912}]
2025-12-24 15:55:31 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.18887_val-0.07122_epoch068.chkpt
2025-12-24 15:55:31 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.18623_val-0.06343_epoch069.chkpt
2025-12-24 15:55:31 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.18878_val-0.05846_epoch070.chkpt
2025-12-24 15:55:31 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.06884_epoch066.ckpt
2025-12-24 15:55:31 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.14919359982013702
  tuning_rank_spearman      0.18886904418468475
        val_loss            0.07121855020523071
    val_pearson_corr        0.7329074144363403
     val_rank_regret                0.0
    val_rank_spearman       0.9444444179534912
    val_spearman_corr        0.760100245475769
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run polish_seed101_2025-12-24_11-12-07_phase2_seed888 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed888
[run_full_pipeline] Phase 2 (seed 888) best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-24_11-12-07_phase2_seed888/model_checkpoints/checkpoint.tuning_rank_spearman-0.18887_val-0.07122_epoch068.chkpt (tuning_rank_spearman=0.18886904418468475)
[run_full_pipeline] Pipeline complete at 2025-12-24T15:55:34Z
    24743.51 real     41600.35 user     70675.16 sys
