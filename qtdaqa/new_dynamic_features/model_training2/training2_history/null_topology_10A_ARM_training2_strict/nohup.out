Skipped Validating graphs using standalone tool ...
Starting model training ...
[run_full_pipeline] Validating graphs before training...
[validate_graphs] OK: validated 14391 graph(s) in /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data
[run_full_pipeline] Starting sweep at 2025-12-25T07:48:06.770954+00:00 using manifest /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/manifests/run_lean.yaml
[train_cli][batch] (1/3) running job 'sched_boost_lean_seed222' -> run_name=sched_boost_lean_seed222_2025-12-25_07-48-06
[train_cli] run_id=sched_boost_lean_seed222_2025-12-25_07-48-06 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-25_07-48-06/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-25_07-48-06 --git-commit 9b1bb2b320 --git-dirty
2025-12-25 07:48:11 INFO git_commit = 9b1bb2b320 (dirty)
2025-12-25 07:48:11 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-25 07:48:11 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-25_07-48-06/config/config.yaml
2025-12-25 07:48:11 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data
2025-12-25 07:48:11 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-25 07:48:11 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-25 07:48:11 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-25_07-48-06
2025-12-25 07:48:11 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-25 07:48:11 INFO   metadata_path = None
2025-12-25 07:48:11 INFO   summary_path = None
2025-12-25 07:48:11 INFO   accelerator = cpu
2025-12-25 07:48:11 INFO   devices = 1
2025-12-25 07:48:11 INFO   attention_head = 8
2025-12-25 07:48:11 INFO   pooling_type = mean
2025-12-25 07:48:11 INFO   model_self_loops = False
2025-12-25 07:48:11 INFO   model_self_loop_fill = mean
2025-12-25 07:48:11 INFO   model_residual = False
2025-12-25 07:48:11 INFO   batch_size = 48
2025-12-25 07:48:11 INFO   learning_rate = 0.005
2025-12-25 07:48:11 INFO   num_epochs = 140
2025-12-25 07:48:11 INFO   accumulate_grad_batches = 8
2025-12-25 07:48:11 INFO   seed = 222
2025-12-25 07:48:11 INFO   num_workers = 2
2025-12-25 07:48:11 INFO   precision = 32
2025-12-25 07:48:11 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-25 07:48:11 INFO   early_stopping_patience = 24
2025-12-25 07:48:11 INFO   lr_scheduler_patience = 6
2025-12-25 07:48:11 INFO   lr_scheduler_factor = 0.2
2025-12-25 07:48:11 INFO   fast_dev_run = False
2025-12-25 07:48:11 INFO   limit_train_batches = None
2025-12-25 07:48:11 INFO   limit_val_batches = None
2025-12-25 07:48:11 INFO   log_lr = False
2025-12-25 07:48:11 INFO   progress_bar_refresh_rate = 0
2025-12-25 07:48:11 INFO   log_every_n_steps = 100
2025-12-25 07:48:11 INFO   use_val_spearman_as_secondary = True
2025-12-25 07:48:11 INFO   spearman_secondary_min_delta = 0.0
2025-12-25 07:48:11 INFO   spearman_secondary_weight = 1.0
2025-12-25 07:48:11 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-25 07:48:11 INFO   tuning_max_samples = 500
2025-12-25 07:48:11 INFO   tuning_fraction = None
2025-12-25 07:48:11 INFO   tuning_eval_every = 1
2025-12-25 07:48:11 INFO   rank_loss_weight = 0.0
2025-12-25 07:48:11 INFO   rank_loss_margin = 0.0
2025-12-25 07:48:11 INFO   rank_loss_mode = hinge
2025-12-25 07:48:11 INFO   rank_loss_grouped = True
2025-12-25 07:48:11 INFO   variance_reduction_enabled = False
2025-12-25 07:48:11 INFO   variance_reduction_method = topk_avg
2025-12-25 07:48:11 INFO   variance_reduction_top_k = 3
2025-12-25 07:48:11 INFO   coverage_minimum = 0.0
2025-12-25 07:48:11 INFO   coverage_fail_on_missing = False
2025-12-25 07:48:11 INFO   graph_load_profiling = False
2025-12-25 07:48:11 INFO   graph_load_top_k = 5
2025-12-25 07:48:11 INFO   enable_graph_cache = True
2025-12-25 07:48:11 INFO   graph_cache_size = 256
2025-12-25 07:48:11 INFO   canonicalize_on_load = False
2025-12-25 07:48:11 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-25 07:48:11 INFO   edge_schema = {}
2025-12-25 07:48:11 INFO   topology_schema = {}
Seed set to 222
2025-12-25 07:48:12 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-25 07:48:12 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 07:48:12 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-25 07:48:12 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 07:48:12 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-25 07:48:12 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 07:48:13 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-25 07:48:13 INFO Tuning group stats: groups=352 groups>=2=34 singletons=318 max_group=11
2025-12-25 07:48:13 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-25_07-48-06/dataset_coverage.json
2025-12-25 07:48:13 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-25_07-48-06/dataset_coverage.json for details.
2025-12-25 07:48:13 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-25_07-48-06/dataset_coverage.json for details.
2025-12-25 07:48:13 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-25_07-48-06/dataset_coverage.json for details.
2025-12-25 07:48:13 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-25_07-48-06/schema_summary.json
2025-12-25 07:48:13 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-25_07-48-06/feature_metadata.json
2025-12-25 07:48:13 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-25 07:48:13 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/null_topology/feature-config.yaml.null.10A, sha256=f618659ace5620de7e794485915dadd4243f3ec2ca6726b4a9af3989817a8579
2025-12-25 07:48:13 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/work/edge_features)
2025-12-25 07:48:13 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json
2025-12-25 07:48:13 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-25_07-48-06/schema_summary.json
2025-12-25 07:48:13 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-25 07:48:13 INFO Topology: topology/persistence_null/v1 supporting the 172-dimensional node features.
2025-12-25 07:48:13 INFO Node: node/dssp_topo_merge/v1; metadata lists 172 feature columns matching the .pt tensor.
2025-12-25 07:48:13 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-25 07:48:13 INFO → Total feature dimensionality observed and confirmed: node_dim = 172, edge_dim = 11.
2025-12-25 07:48:13 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-25 07:48:13 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 172,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 172,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-25_07-48-06/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge/v1",
      "alias": "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA",
      "jobs": 16,
      "summary": "DSSP-derived node features merged with topology statistics."
    },
    "topology": {
      "id": "topology/persistence_null/v1",
      "alias": "Null topology (constant zeros) = 140D ablation",
      "jobs": 16,
      "summary": "Topology ablation: constant features with PH-compatible schema."
    }
  },
  "notes": []
}
2025-12-25 07:48:13 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-25 07:48:13 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=303c169eb56642baa7de8f5f4d1afd4b)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-25 07:48:13 INFO Starting training (fast_dev_run=False)
2025-12-25 07:48:13 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-25_07-48-06/model_checkpoints exists and is not empty.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 5.5 K  | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
165 K     Trainable params
0         Non-trainable params
165 K     Total params
0.662     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-25 07:48:28 INFO Epoch 000 | 25% complete (batch 46/181)
2025-12-25 07:48:29 INFO Epoch 000 | 50% complete (batch 91/181)
2025-12-25 07:48:30 INFO Epoch 000 | 75% complete (batch 136/181)
2025-12-25 07:48:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.140282
2025-12-25 07:48:43 INFO Tuning ranking metrics: regret=0.153788 spearman=-0.308913 (groups=34, skipped=318)
2025-12-25 07:48:43 INFO Epoch 000 | val_loss=0.140282
Metric tuning_rank_spearman improved. New best score: -0.309
2025-12-25 07:48:52 INFO Epoch 001 | 25% complete (batch 46/181)
2025-12-25 07:48:52 INFO Epoch 001 | 50% complete (batch 91/181)
2025-12-25 07:48:53 INFO Epoch 001 | 75% complete (batch 136/181)
2025-12-25 07:49:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.264662
2025-12-25 07:49:07 INFO Tuning ranking metrics: regret=0.140149 spearman=-0.122638 (groups=34, skipped=318)
2025-12-25 07:49:07 INFO Epoch 001 | train_mse=0.144464 | val_loss=0.142987 | best_val_loss=-0.308913
Metric tuning_rank_spearman improved by 0.186 >= min_delta = 0.0. New best score: -0.123
2025-12-25 07:49:15 INFO Epoch 002 | 25% complete (batch 46/181)
2025-12-25 07:49:16 INFO Epoch 002 | 50% complete (batch 91/181)
2025-12-25 07:49:17 INFO Epoch 002 | 75% complete (batch 136/181)
2025-12-25 07:49:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.336397
2025-12-25 07:49:31 INFO Tuning ranking metrics: regret=0.126887 spearman=-0.081678 (groups=34, skipped=318)
2025-12-25 07:49:31 INFO Epoch 002 | train_mse=0.137907 | val_loss=0.105777 | best_val_loss=-0.122638
Metric tuning_rank_spearman improved by 0.041 >= min_delta = 0.0. New best score: -0.082
2025-12-25 07:49:39 INFO Epoch 003 | 25% complete (batch 46/181)
2025-12-25 07:49:40 INFO Epoch 003 | 50% complete (batch 91/181)
2025-12-25 07:49:41 INFO Epoch 003 | 75% complete (batch 136/181)
2025-12-25 07:49:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.445988
2025-12-25 07:49:55 INFO Tuning ranking metrics: regret=0.122383 spearman=-0.132111 (groups=34, skipped=318)
2025-12-25 07:49:55 INFO Epoch 003 | train_mse=0.113868 | val_loss=0.088976 | best_val_loss=-0.081678
2025-12-25 07:50:03 INFO Epoch 004 | 25% complete (batch 46/181)
2025-12-25 07:50:04 INFO Epoch 004 | 50% complete (batch 91/181)
2025-12-25 07:50:05 INFO Epoch 004 | 75% complete (batch 136/181)
2025-12-25 07:50:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.508810
2025-12-25 07:50:19 INFO Tuning ranking metrics: regret=0.123814 spearman=-0.143175 (groups=34, skipped=318)
2025-12-25 07:50:19 INFO Epoch 004 | train_mse=0.096640 | val_loss=0.090390 | best_val_loss=-0.081678
2025-12-25 07:50:27 INFO Epoch 005 | 25% complete (batch 46/181)
2025-12-25 07:50:28 INFO Epoch 005 | 50% complete (batch 91/181)
2025-12-25 07:50:29 INFO Epoch 005 | 75% complete (batch 136/181)
2025-12-25 07:50:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.513407
2025-12-25 07:50:42 INFO Tuning ranking metrics: regret=0.127698 spearman=-0.100102 (groups=34, skipped=318)
2025-12-25 07:50:42 INFO Epoch 005 | train_mse=0.105054 | val_loss=0.092533 | best_val_loss=-0.081678
2025-12-25 07:50:51 INFO Epoch 006 | 25% complete (batch 46/181)
2025-12-25 07:50:52 INFO Epoch 006 | 50% complete (batch 91/181)
2025-12-25 07:50:53 INFO Epoch 006 | 75% complete (batch 136/181)
2025-12-25 07:51:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.508631
2025-12-25 07:51:06 INFO Tuning ranking metrics: regret=0.086498 spearman=-0.041571 (groups=34, skipped=318)
2025-12-25 07:51:06 INFO Epoch 006 | train_mse=0.098028 | val_loss=0.112401 | best_val_loss=-0.081678
Metric tuning_rank_spearman improved by 0.040 >= min_delta = 0.0. New best score: -0.042
2025-12-25 07:51:15 INFO Epoch 007 | 25% complete (batch 46/181)
2025-12-25 07:51:16 INFO Epoch 007 | 50% complete (batch 91/181)
2025-12-25 07:51:17 INFO Epoch 007 | 75% complete (batch 136/181)
2025-12-25 07:51:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.505476
2025-12-25 07:51:31 INFO Tuning ranking metrics: regret=0.114488 spearman=-0.133830 (groups=34, skipped=318)
2025-12-25 07:51:31 INFO Epoch 007 | train_mse=0.109329 | val_loss=0.106166 | best_val_loss=-0.041571
2025-12-25 07:51:39 INFO Epoch 008 | 25% complete (batch 46/181)
2025-12-25 07:51:40 INFO Epoch 008 | 50% complete (batch 91/181)
2025-12-25 07:51:41 INFO Epoch 008 | 75% complete (batch 136/181)
2025-12-25 07:51:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.480976
2025-12-25 07:51:54 INFO Tuning ranking metrics: regret=0.113380 spearman=-0.144557 (groups=34, skipped=318)
2025-12-25 07:51:54 INFO Epoch 008 | train_mse=0.104454 | val_loss=0.106017 | best_val_loss=-0.041571
2025-12-25 07:52:03 INFO Epoch 009 | 25% complete (batch 46/181)
2025-12-25 07:52:04 INFO Epoch 009 | 50% complete (batch 91/181)
2025-12-25 07:52:04 INFO Epoch 009 | 75% complete (batch 136/181)
2025-12-25 07:52:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.494588
2025-12-25 07:52:18 INFO Tuning ranking metrics: regret=0.104846 spearman=-0.105615 (groups=34, skipped=318)
2025-12-25 07:52:18 INFO Epoch 009 | train_mse=0.091944 | val_loss=0.092707 | best_val_loss=-0.041571
2025-12-25 07:52:26 INFO Epoch 010 | 25% complete (batch 46/181)
2025-12-25 07:52:27 INFO Epoch 010 | 50% complete (batch 91/181)
2025-12-25 07:52:28 INFO Epoch 010 | 75% complete (batch 136/181)
2025-12-25 07:52:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.503196
2025-12-25 07:52:42 INFO Tuning ranking metrics: regret=0.099380 spearman=-0.112637 (groups=34, skipped=318)
2025-12-25 07:52:42 INFO Epoch 010 | train_mse=0.097765 | val_loss=0.100079 | best_val_loss=-0.041571
2025-12-25 07:52:50 INFO Epoch 011 | 25% complete (batch 46/181)
2025-12-25 07:52:51 INFO Epoch 011 | 50% complete (batch 91/181)
2025-12-25 07:52:52 INFO Epoch 011 | 75% complete (batch 136/181)
2025-12-25 07:53:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.523052
2025-12-25 07:53:06 INFO Tuning ranking metrics: regret=0.099499 spearman=-0.105901 (groups=34, skipped=318)
2025-12-25 07:53:06 INFO Epoch 011 | train_mse=0.083064 | val_loss=0.084650 | best_val_loss=-0.041571
2025-12-25 07:53:14 INFO Epoch 012 | 25% complete (batch 46/181)
2025-12-25 07:53:15 INFO Epoch 012 | 50% complete (batch 91/181)
2025-12-25 07:53:16 INFO Epoch 012 | 75% complete (batch 136/181)
2025-12-25 07:53:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.539703
2025-12-25 07:53:29 INFO Tuning ranking metrics: regret=0.093980 spearman=-0.059155 (groups=34, skipped=318)
2025-12-25 07:53:29 INFO Epoch 012 | train_mse=0.104366 | val_loss=0.083542 | best_val_loss=-0.041571
2025-12-25 07:53:38 INFO Epoch 013 | 25% complete (batch 46/181)
2025-12-25 07:53:39 INFO Epoch 013 | 50% complete (batch 91/181)
2025-12-25 07:53:39 INFO Epoch 013 | 75% complete (batch 136/181)
2025-12-25 07:53:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.526667
2025-12-25 07:53:53 INFO Tuning ranking metrics: regret=0.094074 spearman=-0.054163 (groups=34, skipped=318)
2025-12-25 07:53:53 INFO Epoch 013 | train_mse=0.088141 | val_loss=0.090105 | best_val_loss=-0.041571
2025-12-25 07:54:02 INFO Epoch 014 | 25% complete (batch 46/181)
2025-12-25 07:54:03 INFO Epoch 014 | 50% complete (batch 91/181)
2025-12-25 07:54:03 INFO Epoch 014 | 75% complete (batch 136/181)
2025-12-25 07:54:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.528178
2025-12-25 07:54:17 INFO Tuning ranking metrics: regret=0.093913 spearman=-0.046161 (groups=34, skipped=318)
2025-12-25 07:54:17 INFO Epoch 014 | train_mse=0.077642 | val_loss=0.087923 | best_val_loss=-0.041571
2025-12-25 07:54:25 INFO Epoch 015 | 25% complete (batch 46/181)
2025-12-25 07:54:26 INFO Epoch 015 | 50% complete (batch 91/181)
2025-12-25 07:54:27 INFO Epoch 015 | 75% complete (batch 136/181)
2025-12-25 07:54:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.534778
2025-12-25 07:54:41 INFO Tuning ranking metrics: regret=0.106780 spearman=-0.084104 (groups=34, skipped=318)
2025-12-25 07:54:41 INFO Epoch 015 | train_mse=0.096944 | val_loss=0.082799 | best_val_loss=-0.041571
2025-12-25 07:54:50 INFO Epoch 016 | 25% complete (batch 46/181)
2025-12-25 07:54:51 INFO Epoch 016 | 50% complete (batch 91/181)
2025-12-25 07:54:51 INFO Epoch 016 | 75% complete (batch 136/181)
2025-12-25 07:55:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.524493
2025-12-25 07:55:05 INFO Tuning ranking metrics: regret=0.079245 spearman=-0.059097 (groups=34, skipped=318)
2025-12-25 07:55:05 INFO Epoch 016 | train_mse=0.093010 | val_loss=0.088624 | best_val_loss=-0.041571
2025-12-25 07:55:14 INFO Epoch 017 | 25% complete (batch 46/181)
2025-12-25 07:55:15 INFO Epoch 017 | 50% complete (batch 91/181)
2025-12-25 07:55:16 INFO Epoch 017 | 75% complete (batch 136/181)
2025-12-25 07:55:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.545335
2025-12-25 07:55:29 INFO Tuning ranking metrics: regret=0.104236 spearman=-0.010702 (groups=34, skipped=318)
2025-12-25 07:55:29 INFO Epoch 017 | train_mse=0.098448 | val_loss=0.081481 | best_val_loss=-0.041571
Metric tuning_rank_spearman improved by 0.031 >= min_delta = 0.0. New best score: -0.011
2025-12-25 07:55:37 INFO Epoch 018 | 25% complete (batch 46/181)
2025-12-25 07:55:38 INFO Epoch 018 | 50% complete (batch 91/181)
2025-12-25 07:55:39 INFO Epoch 018 | 75% complete (batch 136/181)
2025-12-25 07:55:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.545864
2025-12-25 07:55:53 INFO Tuning ranking metrics: regret=0.088155 spearman=-0.013267 (groups=34, skipped=318)
2025-12-25 07:55:53 INFO Epoch 018 | train_mse=0.072201 | val_loss=0.083753 | best_val_loss=-0.010702
2025-12-25 07:56:01 INFO Epoch 019 | 25% complete (batch 46/181)
2025-12-25 07:56:02 INFO Epoch 019 | 50% complete (batch 91/181)
2025-12-25 07:56:03 INFO Epoch 019 | 75% complete (batch 136/181)
2025-12-25 07:56:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.548036
2025-12-25 07:56:17 INFO Tuning ranking metrics: regret=0.064976 spearman=0.011134 (groups=34, skipped=318)
2025-12-25 07:56:17 INFO Epoch 019 | train_mse=0.084408 | val_loss=0.081647 | best_val_loss=-0.010702
Metric tuning_rank_spearman improved by 0.022 >= min_delta = 0.0. New best score: 0.011
2025-12-25 07:56:25 INFO Epoch 020 | 25% complete (batch 46/181)
2025-12-25 07:56:26 INFO Epoch 020 | 50% complete (batch 91/181)
2025-12-25 07:56:27 INFO Epoch 020 | 75% complete (batch 136/181)
2025-12-25 07:56:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.545308
2025-12-25 07:56:41 INFO Tuning ranking metrics: regret=0.069618 spearman=-0.044971 (groups=34, skipped=318)
2025-12-25 07:56:41 INFO Epoch 020 | train_mse=0.075343 | val_loss=0.082984 | best_val_loss=0.011134
2025-12-25 07:56:50 INFO Epoch 021 | 25% complete (batch 46/181)
2025-12-25 07:56:51 INFO Epoch 021 | 50% complete (batch 91/181)
2025-12-25 07:56:51 INFO Epoch 021 | 75% complete (batch 136/181)
2025-12-25 07:57:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.543356
2025-12-25 07:57:05 INFO Tuning ranking metrics: regret=0.082308 spearman=0.010345 (groups=34, skipped=318)
2025-12-25 07:57:05 INFO Epoch 021 | train_mse=0.075222 | val_loss=0.081431 | best_val_loss=0.011134
2025-12-25 07:57:14 INFO Epoch 022 | 25% complete (batch 46/181)
2025-12-25 07:57:14 INFO Epoch 022 | 50% complete (batch 91/181)
2025-12-25 07:57:15 INFO Epoch 022 | 75% complete (batch 136/181)
2025-12-25 07:57:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.544755
2025-12-25 07:57:29 INFO Tuning ranking metrics: regret=0.083323 spearman=0.016705 (groups=34, skipped=318)
2025-12-25 07:57:29 INFO Epoch 022 | train_mse=0.087560 | val_loss=0.081659 | best_val_loss=0.011134
Metric tuning_rank_spearman improved by 0.006 >= min_delta = 0.0. New best score: 0.017
2025-12-25 07:57:37 INFO Epoch 023 | 25% complete (batch 46/181)
2025-12-25 07:57:38 INFO Epoch 023 | 50% complete (batch 91/181)
2025-12-25 07:57:39 INFO Epoch 023 | 75% complete (batch 136/181)
2025-12-25 07:57:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.526249
2025-12-25 07:57:53 INFO Tuning ranking metrics: regret=0.079262 spearman=0.100089 (groups=34, skipped=318)
2025-12-25 07:57:53 INFO Epoch 023 | train_mse=0.088132 | val_loss=0.097800 | best_val_loss=0.016705
Metric tuning_rank_spearman improved by 0.083 >= min_delta = 0.0. New best score: 0.100
2025-12-25 07:58:01 INFO Epoch 024 | 25% complete (batch 46/181)
2025-12-25 07:58:02 INFO Epoch 024 | 50% complete (batch 91/181)
2025-12-25 07:58:03 INFO Epoch 024 | 75% complete (batch 136/181)
2025-12-25 07:58:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.538301
2025-12-25 07:58:17 INFO Tuning ranking metrics: regret=0.083342 spearman=0.014515 (groups=34, skipped=318)
2025-12-25 07:58:17 INFO Epoch 024 | train_mse=0.083255 | val_loss=0.082345 | best_val_loss=0.100089
2025-12-25 07:58:25 INFO Epoch 025 | 25% complete (batch 46/181)
2025-12-25 07:58:26 INFO Epoch 025 | 50% complete (batch 91/181)
2025-12-25 07:58:27 INFO Epoch 025 | 75% complete (batch 136/181)
2025-12-25 07:58:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.538339
2025-12-25 07:58:41 INFO Tuning ranking metrics: regret=0.063576 spearman=0.007436 (groups=34, skipped=318)
2025-12-25 07:58:41 INFO Epoch 025 | train_mse=0.088461 | val_loss=0.085777 | best_val_loss=0.100089
2025-12-25 07:58:49 INFO Epoch 026 | 25% complete (batch 46/181)
2025-12-25 07:58:50 INFO Epoch 026 | 50% complete (batch 91/181)
2025-12-25 07:58:51 INFO Epoch 026 | 75% complete (batch 136/181)
2025-12-25 07:59:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.535962
2025-12-25 07:59:05 INFO Tuning ranking metrics: regret=0.087589 spearman=-0.005761 (groups=34, skipped=318)
2025-12-25 07:59:05 INFO Epoch 026 | train_mse=0.081393 | val_loss=0.085874 | best_val_loss=0.100089
2025-12-25 07:59:13 INFO Epoch 027 | 25% complete (batch 46/181)
2025-12-25 07:59:14 INFO Epoch 027 | 50% complete (batch 91/181)
2025-12-25 07:59:15 INFO Epoch 027 | 75% complete (batch 136/181)
2025-12-25 07:59:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.533915
2025-12-25 07:59:29 INFO Tuning ranking metrics: regret=0.061167 spearman=0.061968 (groups=34, skipped=318)
2025-12-25 07:59:29 INFO Epoch 027 | train_mse=0.068001 | val_loss=0.093421 | best_val_loss=0.100089
2025-12-25 07:59:38 INFO Epoch 028 | 25% complete (batch 46/181)
2025-12-25 07:59:39 INFO Epoch 028 | 50% complete (batch 91/181)
2025-12-25 07:59:40 INFO Epoch 028 | 75% complete (batch 136/181)
2025-12-25 07:59:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.538670
2025-12-25 07:59:53 INFO Tuning ranking metrics: regret=0.091887 spearman=-0.058868 (groups=34, skipped=318)
2025-12-25 07:59:53 INFO Epoch 028 | train_mse=0.062912 | val_loss=0.084943 | best_val_loss=0.100089
2025-12-25 08:00:02 INFO Epoch 029 | 25% complete (batch 46/181)
2025-12-25 08:00:03 INFO Epoch 029 | 50% complete (batch 91/181)
2025-12-25 08:00:04 INFO Epoch 029 | 75% complete (batch 136/181)
2025-12-25 08:00:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.542130
2025-12-25 08:00:18 INFO Tuning ranking metrics: regret=0.070257 spearman=0.000516 (groups=34, skipped=318)
2025-12-25 08:00:18 INFO Epoch 029 | train_mse=0.083952 | val_loss=0.085692 | best_val_loss=0.100089
2025-12-25 08:00:26 INFO Epoch 030 | 25% complete (batch 46/181)
2025-12-25 08:00:27 INFO Epoch 030 | 50% complete (batch 91/181)
2025-12-25 08:00:28 INFO Epoch 030 | 75% complete (batch 136/181)
2025-12-25 08:00:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.547617
2025-12-25 08:00:42 INFO Tuning ranking metrics: regret=0.089004 spearman=0.008817 (groups=34, skipped=318)
2025-12-25 08:00:42 INFO Epoch 030 | train_mse=0.090451 | val_loss=0.081865 | best_val_loss=0.100089
2025-12-25 08:00:51 INFO Epoch 031 | 25% complete (batch 46/181)
2025-12-25 08:00:52 INFO Epoch 031 | 50% complete (batch 91/181)
2025-12-25 08:00:52 INFO Epoch 031 | 75% complete (batch 136/181)
2025-12-25 08:01:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.546556
2025-12-25 08:01:06 INFO Tuning ranking metrics: regret=0.070434 spearman=-0.053457 (groups=34, skipped=318)
2025-12-25 08:01:06 INFO Epoch 031 | train_mse=0.089536 | val_loss=0.082004 | best_val_loss=0.100089
2025-12-25 08:01:14 INFO Epoch 032 | 25% complete (batch 46/181)
2025-12-25 08:01:15 INFO Epoch 032 | 50% complete (batch 91/181)
2025-12-25 08:01:16 INFO Epoch 032 | 75% complete (batch 136/181)
2025-12-25 08:01:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.549092
2025-12-25 08:01:30 INFO Tuning ranking metrics: regret=0.089181 spearman=-0.053298 (groups=34, skipped=318)
2025-12-25 08:01:30 INFO Epoch 032 | train_mse=0.080240 | val_loss=0.082151 | best_val_loss=0.100089
2025-12-25 08:01:39 INFO Epoch 033 | 25% complete (batch 46/181)
2025-12-25 08:01:40 INFO Epoch 033 | 50% complete (batch 91/181)
2025-12-25 08:01:40 INFO Epoch 033 | 75% complete (batch 136/181)
2025-12-25 08:01:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.549053
2025-12-25 08:01:54 INFO Tuning ranking metrics: regret=0.089181 spearman=-0.055399 (groups=34, skipped=318)
2025-12-25 08:01:54 INFO Epoch 033 | train_mse=0.084143 | val_loss=0.082391 | best_val_loss=0.100089
2025-12-25 08:02:02 INFO Epoch 034 | 25% complete (batch 46/181)
2025-12-25 08:02:03 INFO Epoch 034 | 50% complete (batch 91/181)
2025-12-25 08:02:04 INFO Epoch 034 | 75% complete (batch 136/181)
2025-12-25 08:02:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.550635
2025-12-25 08:02:18 INFO Tuning ranking metrics: regret=0.070434 spearman=-0.057238 (groups=34, skipped=318)
2025-12-25 08:02:18 INFO Epoch 034 | train_mse=0.074852 | val_loss=0.082486 | best_val_loss=0.100089
2025-12-25 08:02:26 INFO Epoch 035 | 25% complete (batch 46/181)
2025-12-25 08:02:27 INFO Epoch 035 | 50% complete (batch 91/181)
2025-12-25 08:02:28 INFO Epoch 035 | 75% complete (batch 136/181)
2025-12-25 08:02:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.547577
2025-12-25 08:02:42 INFO Tuning ranking metrics: regret=0.068054 spearman=-0.036580 (groups=34, skipped=318)
2025-12-25 08:02:42 INFO Epoch 035 | train_mse=0.065814 | val_loss=0.083665 | best_val_loss=0.100089
2025-12-25 08:02:50 INFO Epoch 036 | 25% complete (batch 46/181)
2025-12-25 08:02:51 INFO Epoch 036 | 50% complete (batch 91/181)
2025-12-25 08:02:52 INFO Epoch 036 | 75% complete (batch 136/181)
2025-12-25 08:03:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.546218
2025-12-25 08:03:06 INFO Tuning ranking metrics: regret=0.068054 spearman=-0.037631 (groups=34, skipped=318)
2025-12-25 08:03:06 INFO Epoch 036 | train_mse=0.089316 | val_loss=0.083432 | best_val_loss=0.100089
2025-12-25 08:03:14 INFO Epoch 037 | 25% complete (batch 46/181)
2025-12-25 08:03:15 INFO Epoch 037 | 50% complete (batch 91/181)
2025-12-25 08:03:16 INFO Epoch 037 | 75% complete (batch 136/181)
2025-12-25 08:03:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.547258
2025-12-25 08:03:30 INFO Tuning ranking metrics: regret=0.068054 spearman=-0.037631 (groups=34, skipped=318)
2025-12-25 08:03:30 INFO Epoch 037 | train_mse=0.083567 | val_loss=0.083263 | best_val_loss=0.100089
2025-12-25 08:03:38 INFO Epoch 038 | 25% complete (batch 46/181)
2025-12-25 08:03:39 INFO Epoch 038 | 50% complete (batch 91/181)
2025-12-25 08:03:40 INFO Epoch 038 | 75% complete (batch 136/181)
2025-12-25 08:03:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.546877
2025-12-25 08:03:54 INFO Tuning ranking metrics: regret=0.068054 spearman=-0.039591 (groups=34, skipped=318)
2025-12-25 08:03:54 INFO Epoch 038 | train_mse=0.071097 | val_loss=0.082974 | best_val_loss=0.100089
2025-12-25 08:04:02 INFO Epoch 039 | 25% complete (batch 46/181)
2025-12-25 08:04:03 INFO Epoch 039 | 50% complete (batch 91/181)
2025-12-25 08:04:04 INFO Epoch 039 | 75% complete (batch 136/181)
2025-12-25 08:04:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.546505
2025-12-25 08:04:17 INFO Tuning ranking metrics: regret=0.068054 spearman=-0.036580 (groups=34, skipped=318)
2025-12-25 08:04:17 INFO Epoch 039 | train_mse=0.082102 | val_loss=0.083346 | best_val_loss=0.100089
2025-12-25 08:04:26 INFO Epoch 040 | 25% complete (batch 46/181)
2025-12-25 08:04:27 INFO Epoch 040 | 50% complete (batch 91/181)
2025-12-25 08:04:28 INFO Epoch 040 | 75% complete (batch 136/181)
2025-12-25 08:04:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.548607
2025-12-25 08:04:41 INFO Tuning ranking metrics: regret=0.068054 spearman=-0.036580 (groups=34, skipped=318)
2025-12-25 08:04:41 INFO Epoch 040 | train_mse=0.071361 | val_loss=0.083189 | best_val_loss=0.100089
2025-12-25 08:04:50 INFO Epoch 041 | 25% complete (batch 46/181)
2025-12-25 08:04:51 INFO Epoch 041 | 50% complete (batch 91/181)
2025-12-25 08:04:51 INFO Epoch 041 | 75% complete (batch 136/181)
2025-12-25 08:05:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.547255
2025-12-25 08:05:05 INFO Tuning ranking metrics: regret=0.068054 spearman=-0.037471 (groups=34, skipped=318)
2025-12-25 08:05:05 INFO Epoch 041 | train_mse=0.085977 | val_loss=0.082965 | best_val_loss=0.100089
2025-12-25 08:05:13 INFO Epoch 042 | 25% complete (batch 46/181)
2025-12-25 08:05:14 INFO Epoch 042 | 50% complete (batch 91/181)
2025-12-25 08:05:15 INFO Epoch 042 | 75% complete (batch 136/181)
2025-12-25 08:05:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.545955
2025-12-25 08:05:29 INFO Tuning ranking metrics: regret=0.088799 spearman=-0.056589 (groups=34, skipped=318)
2025-12-25 08:05:29 INFO Epoch 042 | train_mse=0.080159 | val_loss=0.082756 | best_val_loss=0.100089
2025-12-25 08:05:38 INFO Epoch 043 | 25% complete (batch 46/181)
2025-12-25 08:05:39 INFO Epoch 043 | 50% complete (batch 91/181)
2025-12-25 08:05:39 INFO Epoch 043 | 75% complete (batch 136/181)
2025-12-25 08:05:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.544206
2025-12-25 08:05:53 INFO Tuning ranking metrics: regret=0.068054 spearman=-0.038541 (groups=34, skipped=318)
2025-12-25 08:05:53 INFO Epoch 043 | train_mse=0.094492 | val_loss=0.082828 | best_val_loss=0.100089
2025-12-25 08:06:02 INFO Epoch 044 | 25% complete (batch 46/181)
2025-12-25 08:06:03 INFO Epoch 044 | 50% complete (batch 91/181)
2025-12-25 08:06:04 INFO Epoch 044 | 75% complete (batch 136/181)
2025-12-25 08:06:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.544173
2025-12-25 08:06:17 INFO Tuning ranking metrics: regret=0.068054 spearman=-0.037560 (groups=34, skipped=318)
2025-12-25 08:06:17 INFO Epoch 044 | train_mse=0.072176 | val_loss=0.082929 | best_val_loss=0.100089
2025-12-25 08:06:26 INFO Epoch 045 | 25% complete (batch 46/181)
2025-12-25 08:06:27 INFO Epoch 045 | 50% complete (batch 91/181)
2025-12-25 08:06:28 INFO Epoch 045 | 75% complete (batch 136/181)
2025-12-25 08:06:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.544347
2025-12-25 08:06:42 INFO Tuning ranking metrics: regret=0.068054 spearman=-0.038541 (groups=34, skipped=318)
2025-12-25 08:06:42 INFO Epoch 045 | train_mse=0.084835 | val_loss=0.082888 | best_val_loss=0.100089
2025-12-25 08:06:50 INFO Epoch 046 | 25% complete (batch 46/181)
2025-12-25 08:06:51 INFO Epoch 046 | 50% complete (batch 91/181)
2025-12-25 08:06:52 INFO Epoch 046 | 75% complete (batch 136/181)
2025-12-25 08:07:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.544125
2025-12-25 08:07:06 INFO Tuning ranking metrics: regret=0.068054 spearman=-0.037560 (groups=34, skipped=318)
2025-12-25 08:07:06 INFO Epoch 046 | train_mse=0.097019 | val_loss=0.082976 | best_val_loss=0.100089
2025-12-25 08:07:14 INFO Epoch 047 | 25% complete (batch 46/181)
2025-12-25 08:07:15 INFO Epoch 047 | 50% complete (batch 91/181)
2025-12-25 08:07:16 INFO Epoch 047 | 75% complete (batch 136/181)
2025-12-25 08:07:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.544634
2025-12-25 08:07:29 INFO Tuning ranking metrics: regret=0.068054 spearman=-0.037560 (groups=34, skipped=318)
2025-12-25 08:07:29 INFO Epoch 047 | train_mse=0.085726 | val_loss=0.082970 | best_val_loss=0.100089
Monitored metric tuning_rank_spearman did not improve in the last 24 records. Best score: 0.100. Signaling Trainer to stop.
2025-12-25 08:07:30 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.01670_val-0.08166_epoch022.chkpt, checkpoint.tuning_rank_spearman-0.06197_val-0.09342_epoch027.chkpt, checkpoint.tuning_rank_spearman-0.10009_val-0.09780_epoch023.chkpt
2025-12-25 08:07:30 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-25_07-48-06/model_checkpoints/checkpoint.tuning_rank_spearman-0.10009_val-0.09780_epoch023.chkpt
2025-12-25 08:07:30 INFO Best validation loss: tensor(0.1001)
2025-12-25 08:07:30 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-25_07-48-06/model_checkpoints/checkpoint.tuning_rank_spearman-0.10009_val-0.09780_epoch023.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-25_07-48-06/model_checkpoints/checkpoint.tuning_rank_spearman-0.10009_val-0.09780_epoch023.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-25 08:07:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.097800
2025-12-25 08:07:43 INFO Tuning ranking metrics: regret=0.079262 spearman=0.100089 (groups=34, skipped=318)
2025-12-25 08:07:43 INFO Epoch 048 | val_loss=0.097800 | best_val_loss=0.100089
2025-12-25 08:07:43 INFO Validation metrics: [{'val_loss': 0.09780014306306839, 'tuning_rank_regret': 0.07926179468631744, 'tuning_rank_spearman': 0.10008912533521652, 'val_pearson_corr': 0.612659752368927, 'val_spearman_corr': 0.6206457018852234, 'val_rank_regret': 0.03156936913728714, 'val_rank_spearman': 0.7222222089767456}]
2025-12-25 08:07:43 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.10009_val-0.09780_epoch023.chkpt
2025-12-25 08:07:43 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.01670_val-0.08166_epoch022.chkpt
2025-12-25 08:07:43 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.06197_val-0.09342_epoch027.chkpt
2025-12-25 08:07:43 INFO Renamed checkpoint file: alt_val.val-0.08143_epoch021.ckpt -> alt_val.val-0.08143_epoch021.chkpt
2025-12-25 08:07:43 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.08143_epoch021.chkpt
2025-12-25 08:07:43 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.07926179468631744
  tuning_rank_spearman      0.10008912533521652
        val_loss            0.09780014306306839
    val_pearson_corr         0.612659752368927
     val_rank_regret        0.03156936913728714
    val_rank_spearman       0.7222222089767456
    val_spearman_corr       0.6206457018852234
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run sched_boost_lean_seed222_2025-12-25_07-48-06 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lean_seed222_2025-12-25_07-48-06
[train_cli][batch] job 'sched_boost_lean_seed222' finished.
[train_cli][batch] (2/3) running job 'sched_boost_lr035_lean_seed222' -> run_name=sched_boost_lr035_lean_seed222_2025-12-25_08-07-46
[train_cli] run_id=sched_boost_lr035_lean_seed222_2025-12-25_08-07-46 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46 --git-commit 9b1bb2b320 --git-dirty
2025-12-25 08:07:49 INFO git_commit = 9b1bb2b320 (dirty)
2025-12-25 08:07:49 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-25 08:07:49 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46/config/config.yaml
2025-12-25 08:07:49 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data
2025-12-25 08:07:49 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-25 08:07:49 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-25 08:07:49 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46
2025-12-25 08:07:49 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-25 08:07:49 INFO   metadata_path = None
2025-12-25 08:07:49 INFO   summary_path = None
2025-12-25 08:07:49 INFO   accelerator = cpu
2025-12-25 08:07:49 INFO   devices = 1
2025-12-25 08:07:49 INFO   attention_head = 8
2025-12-25 08:07:49 INFO   pooling_type = mean
2025-12-25 08:07:49 INFO   model_self_loops = False
2025-12-25 08:07:49 INFO   model_self_loop_fill = mean
2025-12-25 08:07:49 INFO   model_residual = False
2025-12-25 08:07:49 INFO   batch_size = 48
2025-12-25 08:07:49 INFO   learning_rate = 0.0035
2025-12-25 08:07:49 INFO   num_epochs = 140
2025-12-25 08:07:49 INFO   accumulate_grad_batches = 8
2025-12-25 08:07:49 INFO   seed = 222
2025-12-25 08:07:49 INFO   num_workers = 2
2025-12-25 08:07:49 INFO   precision = 32
2025-12-25 08:07:49 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-25 08:07:49 INFO   early_stopping_patience = 24
2025-12-25 08:07:49 INFO   lr_scheduler_patience = 6
2025-12-25 08:07:49 INFO   lr_scheduler_factor = 0.2
2025-12-25 08:07:49 INFO   fast_dev_run = False
2025-12-25 08:07:49 INFO   limit_train_batches = None
2025-12-25 08:07:49 INFO   limit_val_batches = None
2025-12-25 08:07:49 INFO   log_lr = False
2025-12-25 08:07:49 INFO   progress_bar_refresh_rate = 0
2025-12-25 08:07:49 INFO   log_every_n_steps = 100
2025-12-25 08:07:49 INFO   use_val_spearman_as_secondary = True
2025-12-25 08:07:49 INFO   spearman_secondary_min_delta = 0.0
2025-12-25 08:07:49 INFO   spearman_secondary_weight = 1.0
2025-12-25 08:07:49 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-25 08:07:49 INFO   tuning_max_samples = 500
2025-12-25 08:07:49 INFO   tuning_fraction = None
2025-12-25 08:07:49 INFO   tuning_eval_every = 1
2025-12-25 08:07:49 INFO   rank_loss_weight = 0.0
2025-12-25 08:07:49 INFO   rank_loss_margin = 0.0
2025-12-25 08:07:49 INFO   rank_loss_mode = hinge
2025-12-25 08:07:49 INFO   rank_loss_grouped = True
2025-12-25 08:07:49 INFO   variance_reduction_enabled = False
2025-12-25 08:07:49 INFO   variance_reduction_method = topk_avg
2025-12-25 08:07:49 INFO   variance_reduction_top_k = 3
2025-12-25 08:07:49 INFO   coverage_minimum = 0.0
2025-12-25 08:07:49 INFO   coverage_fail_on_missing = False
2025-12-25 08:07:49 INFO   graph_load_profiling = False
2025-12-25 08:07:49 INFO   graph_load_top_k = 5
2025-12-25 08:07:49 INFO   enable_graph_cache = True
2025-12-25 08:07:49 INFO   graph_cache_size = 256
2025-12-25 08:07:49 INFO   canonicalize_on_load = False
2025-12-25 08:07:49 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-25 08:07:49 INFO   edge_schema = {}
2025-12-25 08:07:49 INFO   topology_schema = {}
Seed set to 222
2025-12-25 08:07:50 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-25 08:07:50 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 08:07:50 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-25 08:07:50 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 08:07:50 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-25 08:07:50 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 08:07:51 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-25 08:07:51 INFO Tuning group stats: groups=352 groups>=2=34 singletons=318 max_group=11
2025-12-25 08:07:51 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46/dataset_coverage.json
2025-12-25 08:07:51 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46/dataset_coverage.json for details.
2025-12-25 08:07:51 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46/dataset_coverage.json for details.
2025-12-25 08:07:51 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46/dataset_coverage.json for details.
2025-12-25 08:07:51 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46/schema_summary.json
2025-12-25 08:07:51 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46/feature_metadata.json
2025-12-25 08:07:51 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-25 08:07:51 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/null_topology/feature-config.yaml.null.10A, sha256=f618659ace5620de7e794485915dadd4243f3ec2ca6726b4a9af3989817a8579
2025-12-25 08:07:51 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/work/edge_features)
2025-12-25 08:07:51 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json
2025-12-25 08:07:51 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46/schema_summary.json
2025-12-25 08:07:51 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-25 08:07:51 INFO Topology: topology/persistence_null/v1 supporting the 172-dimensional node features.
2025-12-25 08:07:51 INFO Node: node/dssp_topo_merge/v1; metadata lists 172 feature columns matching the .pt tensor.
2025-12-25 08:07:51 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-25 08:07:51 INFO → Total feature dimensionality observed and confirmed: node_dim = 172, edge_dim = 11.
2025-12-25 08:07:51 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-25 08:07:51 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 172,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 172,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge/v1",
      "alias": "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA",
      "jobs": 16,
      "summary": "DSSP-derived node features merged with topology statistics."
    },
    "topology": {
      "id": "topology/persistence_null/v1",
      "alias": "Null topology (constant zeros) = 140D ablation",
      "jobs": 16,
      "summary": "Topology ablation: constant features with PH-compatible schema."
    }
  },
  "notes": []
}
2025-12-25 08:07:51 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-25 08:07:51 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=76e4224dc9834dd7b25c0f8ed84b3d3a)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-25 08:07:51 INFO Starting training (fast_dev_run=False)
2025-12-25 08:07:51 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46/model_checkpoints exists and is not empty.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 5.5 K  | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
165 K     Trainable params
0         Non-trainable params
165 K     Total params
0.662     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-25 08:08:06 INFO Epoch 000 | 25% complete (batch 46/181)
2025-12-25 08:08:06 INFO Epoch 000 | 50% complete (batch 91/181)
2025-12-25 08:08:07 INFO Epoch 000 | 75% complete (batch 136/181)
2025-12-25 08:08:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.140640
2025-12-25 08:08:21 INFO Tuning ranking metrics: regret=0.149725 spearman=-0.178139 (groups=34, skipped=318)
2025-12-25 08:08:21 INFO Epoch 000 | val_loss=0.140640
Metric tuning_rank_spearman improved. New best score: -0.178
2025-12-25 08:08:29 INFO Epoch 001 | 25% complete (batch 46/181)
2025-12-25 08:08:30 INFO Epoch 001 | 50% complete (batch 91/181)
2025-12-25 08:08:31 INFO Epoch 001 | 75% complete (batch 136/181)
2025-12-25 08:08:40 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.266852
2025-12-25 08:08:45 INFO Tuning ranking metrics: regret=0.140047 spearman=0.001738 (groups=34, skipped=318)
2025-12-25 08:08:45 INFO Epoch 001 | train_mse=0.144467 | val_loss=0.125556 | best_val_loss=-0.178139
Metric tuning_rank_spearman improved by 0.180 >= min_delta = 0.0. New best score: 0.002
2025-12-25 08:08:53 INFO Epoch 002 | 25% complete (batch 46/181)
2025-12-25 08:08:54 INFO Epoch 002 | 50% complete (batch 91/181)
2025-12-25 08:08:55 INFO Epoch 002 | 75% complete (batch 136/181)
2025-12-25 08:09:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.310085
2025-12-25 08:09:08 INFO Tuning ranking metrics: regret=0.132389 spearman=0.024141 (groups=34, skipped=318)
2025-12-25 08:09:08 INFO Epoch 002 | train_mse=0.146265 | val_loss=0.129539 | best_val_loss=0.001738
Metric tuning_rank_spearman improved by 0.022 >= min_delta = 0.0. New best score: 0.024
2025-12-25 08:09:17 INFO Epoch 003 | 25% complete (batch 46/181)
2025-12-25 08:09:17 INFO Epoch 003 | 50% complete (batch 91/181)
2025-12-25 08:09:18 INFO Epoch 003 | 75% complete (batch 136/181)
2025-12-25 08:09:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.394821
2025-12-25 08:09:32 INFO Tuning ranking metrics: regret=0.125837 spearman=-0.017793 (groups=34, skipped=318)
2025-12-25 08:09:32 INFO Epoch 003 | train_mse=0.118903 | val_loss=0.101578 | best_val_loss=0.024141
2025-12-25 08:09:40 INFO Epoch 004 | 25% complete (batch 46/181)
2025-12-25 08:09:41 INFO Epoch 004 | 50% complete (batch 91/181)
2025-12-25 08:09:42 INFO Epoch 004 | 75% complete (batch 136/181)
2025-12-25 08:09:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.455811
2025-12-25 08:09:56 INFO Tuning ranking metrics: regret=0.138841 spearman=-0.013350 (groups=34, skipped=318)
2025-12-25 08:09:56 INFO Epoch 004 | train_mse=0.097344 | val_loss=0.097665 | best_val_loss=0.024141
2025-12-25 08:10:04 INFO Epoch 005 | 25% complete (batch 46/181)
2025-12-25 08:10:05 INFO Epoch 005 | 50% complete (batch 91/181)
2025-12-25 08:10:06 INFO Epoch 005 | 75% complete (batch 136/181)
2025-12-25 08:10:15 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.472889
2025-12-25 08:10:20 INFO Tuning ranking metrics: regret=0.122154 spearman=-0.043990 (groups=34, skipped=318)
2025-12-25 08:10:20 INFO Epoch 005 | train_mse=0.101747 | val_loss=0.093950 | best_val_loss=0.024141
2025-12-25 08:10:28 INFO Epoch 006 | 25% complete (batch 46/181)
2025-12-25 08:10:29 INFO Epoch 006 | 50% complete (batch 91/181)
2025-12-25 08:10:30 INFO Epoch 006 | 75% complete (batch 136/181)
2025-12-25 08:10:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.454249
2025-12-25 08:10:43 INFO Tuning ranking metrics: regret=0.101254 spearman=0.002782 (groups=34, skipped=318)
2025-12-25 08:10:43 INFO Epoch 006 | train_mse=0.101072 | val_loss=0.122584 | best_val_loss=0.024141
2025-12-25 08:10:52 INFO Epoch 007 | 25% complete (batch 46/181)
2025-12-25 08:10:53 INFO Epoch 007 | 50% complete (batch 91/181)
2025-12-25 08:10:54 INFO Epoch 007 | 75% complete (batch 136/181)
2025-12-25 08:11:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.466616
2025-12-25 08:11:07 INFO Tuning ranking metrics: regret=0.099340 spearman=0.002718 (groups=34, skipped=318)
2025-12-25 08:11:07 INFO Epoch 007 | train_mse=0.108468 | val_loss=0.096467 | best_val_loss=0.024141
2025-12-25 08:11:16 INFO Epoch 008 | 25% complete (batch 46/181)
2025-12-25 08:11:17 INFO Epoch 008 | 50% complete (batch 91/181)
2025-12-25 08:11:18 INFO Epoch 008 | 75% complete (batch 136/181)
2025-12-25 08:11:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.468736
2025-12-25 08:11:31 INFO Tuning ranking metrics: regret=0.079718 spearman=-0.032321 (groups=34, skipped=318)
2025-12-25 08:11:31 INFO Epoch 008 | train_mse=0.113118 | val_loss=0.099243 | best_val_loss=0.024141
2025-12-25 08:11:40 INFO Epoch 009 | 25% complete (batch 46/181)
2025-12-25 08:11:41 INFO Epoch 009 | 50% complete (batch 91/181)
2025-12-25 08:11:42 INFO Epoch 009 | 75% complete (batch 136/181)
2025-12-25 08:11:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.460981
2025-12-25 08:11:55 INFO Tuning ranking metrics: regret=0.091755 spearman=0.022345 (groups=34, skipped=318)
2025-12-25 08:11:55 INFO Epoch 009 | train_mse=0.092826 | val_loss=0.102404 | best_val_loss=0.024141
2025-12-25 08:12:03 INFO Epoch 010 | 25% complete (batch 46/181)
2025-12-25 08:12:04 INFO Epoch 010 | 50% complete (batch 91/181)
2025-12-25 08:12:05 INFO Epoch 010 | 75% complete (batch 136/181)
2025-12-25 08:12:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.465076
2025-12-25 08:12:19 INFO Tuning ranking metrics: regret=0.096543 spearman=-0.068004 (groups=34, skipped=318)
2025-12-25 08:12:19 INFO Epoch 010 | train_mse=0.090719 | val_loss=0.096012 | best_val_loss=0.024141
2025-12-25 08:12:27 INFO Epoch 011 | 25% complete (batch 46/181)
2025-12-25 08:12:28 INFO Epoch 011 | 50% complete (batch 91/181)
2025-12-25 08:12:29 INFO Epoch 011 | 75% complete (batch 136/181)
2025-12-25 08:12:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.465155
2025-12-25 08:12:43 INFO Tuning ranking metrics: regret=0.075586 spearman=-0.099962 (groups=34, skipped=318)
2025-12-25 08:12:43 INFO Epoch 011 | train_mse=0.078868 | val_loss=0.105557 | best_val_loss=0.024141
2025-12-25 08:12:51 INFO Epoch 012 | 25% complete (batch 46/181)
2025-12-25 08:12:52 INFO Epoch 012 | 50% complete (batch 91/181)
2025-12-25 08:12:53 INFO Epoch 012 | 75% complete (batch 136/181)
2025-12-25 08:13:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.488463
2025-12-25 08:13:06 INFO Tuning ranking metrics: regret=0.069108 spearman=-0.001140 (groups=34, skipped=318)
2025-12-25 08:13:06 INFO Epoch 012 | train_mse=0.106723 | val_loss=0.094154 | best_val_loss=0.024141
2025-12-25 08:13:15 INFO Epoch 013 | 25% complete (batch 46/181)
2025-12-25 08:13:16 INFO Epoch 013 | 50% complete (batch 91/181)
2025-12-25 08:13:16 INFO Epoch 013 | 75% complete (batch 136/181)
2025-12-25 08:13:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.502390
2025-12-25 08:13:30 INFO Tuning ranking metrics: regret=0.072289 spearman=-0.003107 (groups=34, skipped=318)
2025-12-25 08:13:30 INFO Epoch 013 | train_mse=0.116553 | val_loss=0.094664 | best_val_loss=0.024141
2025-12-25 08:13:38 INFO Epoch 014 | 25% complete (batch 46/181)
2025-12-25 08:13:39 INFO Epoch 014 | 50% complete (batch 91/181)
2025-12-25 08:13:40 INFO Epoch 014 | 75% complete (batch 136/181)
2025-12-25 08:13:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.505052
2025-12-25 08:13:54 INFO Tuning ranking metrics: regret=0.070666 spearman=0.003947 (groups=34, skipped=318)
2025-12-25 08:13:54 INFO Epoch 014 | train_mse=0.080184 | val_loss=0.088967 | best_val_loss=0.024141
2025-12-25 08:14:02 INFO Epoch 015 | 25% complete (batch 46/181)
2025-12-25 08:14:03 INFO Epoch 015 | 50% complete (batch 91/181)
2025-12-25 08:14:04 INFO Epoch 015 | 75% complete (batch 136/181)
2025-12-25 08:14:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.499950
2025-12-25 08:14:17 INFO Tuning ranking metrics: regret=0.080881 spearman=-0.039865 (groups=34, skipped=318)
2025-12-25 08:14:17 INFO Epoch 015 | train_mse=0.098263 | val_loss=0.088301 | best_val_loss=0.024141
2025-12-25 08:14:26 INFO Epoch 016 | 25% complete (batch 46/181)
2025-12-25 08:14:27 INFO Epoch 016 | 50% complete (batch 91/181)
2025-12-25 08:14:28 INFO Epoch 016 | 75% complete (batch 136/181)
2025-12-25 08:14:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.517102
2025-12-25 08:14:41 INFO Tuning ranking metrics: regret=0.073583 spearman=-0.023014 (groups=34, skipped=318)
2025-12-25 08:14:41 INFO Epoch 016 | train_mse=0.093745 | val_loss=0.090213 | best_val_loss=0.024141
2025-12-25 08:14:50 INFO Epoch 017 | 25% complete (batch 46/181)
2025-12-25 08:14:51 INFO Epoch 017 | 50% complete (batch 91/181)
2025-12-25 08:14:51 INFO Epoch 017 | 75% complete (batch 136/181)
2025-12-25 08:15:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.516488
2025-12-25 08:15:05 INFO Tuning ranking metrics: regret=0.072228 spearman=-0.025866 (groups=34, skipped=318)
2025-12-25 08:15:05 INFO Epoch 017 | train_mse=0.098224 | val_loss=0.087005 | best_val_loss=0.024141
2025-12-25 08:15:13 INFO Epoch 018 | 25% complete (batch 46/181)
2025-12-25 08:15:14 INFO Epoch 018 | 50% complete (batch 91/181)
2025-12-25 08:15:15 INFO Epoch 018 | 75% complete (batch 136/181)
2025-12-25 08:15:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.514497
2025-12-25 08:15:29 INFO Tuning ranking metrics: regret=0.085990 spearman=-0.022396 (groups=34, skipped=318)
2025-12-25 08:15:29 INFO Epoch 018 | train_mse=0.076132 | val_loss=0.087470 | best_val_loss=0.024141
2025-12-25 08:15:37 INFO Epoch 019 | 25% complete (batch 46/181)
2025-12-25 08:15:38 INFO Epoch 019 | 50% complete (batch 91/181)
2025-12-25 08:15:39 INFO Epoch 019 | 75% complete (batch 136/181)
2025-12-25 08:15:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.521584
2025-12-25 08:15:53 INFO Tuning ranking metrics: regret=0.086234 spearman=-0.035307 (groups=34, skipped=318)
2025-12-25 08:15:53 INFO Epoch 019 | train_mse=0.087538 | val_loss=0.088985 | best_val_loss=0.024141
2025-12-25 08:16:01 INFO Epoch 020 | 25% complete (batch 46/181)
2025-12-25 08:16:02 INFO Epoch 020 | 50% complete (batch 91/181)
2025-12-25 08:16:03 INFO Epoch 020 | 75% complete (batch 136/181)
2025-12-25 08:16:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.509397
2025-12-25 08:16:17 INFO Tuning ranking metrics: regret=0.074685 spearman=-0.033123 (groups=34, skipped=318)
2025-12-25 08:16:17 INFO Epoch 020 | train_mse=0.072626 | val_loss=0.090659 | best_val_loss=0.024141
2025-12-25 08:16:25 INFO Epoch 021 | 25% complete (batch 46/181)
2025-12-25 08:16:26 INFO Epoch 021 | 50% complete (batch 91/181)
2025-12-25 08:16:27 INFO Epoch 021 | 75% complete (batch 136/181)
2025-12-25 08:16:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.520291
2025-12-25 08:16:40 INFO Tuning ranking metrics: regret=0.083854 spearman=-0.005087 (groups=34, skipped=318)
2025-12-25 08:16:40 INFO Epoch 021 | train_mse=0.076940 | val_loss=0.087292 | best_val_loss=0.024141
2025-12-25 08:16:49 INFO Epoch 022 | 25% complete (batch 46/181)
2025-12-25 08:16:50 INFO Epoch 022 | 50% complete (batch 91/181)
2025-12-25 08:16:51 INFO Epoch 022 | 75% complete (batch 136/181)
2025-12-25 08:16:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.517295
2025-12-25 08:17:04 INFO Tuning ranking metrics: regret=0.086234 spearman=-0.006169 (groups=34, skipped=318)
2025-12-25 08:17:04 INFO Epoch 022 | train_mse=0.087478 | val_loss=0.088310 | best_val_loss=0.024141
2025-12-25 08:17:12 INFO Epoch 023 | 25% complete (batch 46/181)
2025-12-25 08:17:13 INFO Epoch 023 | 50% complete (batch 91/181)
2025-12-25 08:17:14 INFO Epoch 023 | 75% complete (batch 136/181)
2025-12-25 08:17:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.511432
2025-12-25 08:17:28 INFO Tuning ranking metrics: regret=0.088974 spearman=-0.048943 (groups=34, skipped=318)
2025-12-25 08:17:28 INFO Epoch 023 | train_mse=0.088021 | val_loss=0.091021 | best_val_loss=0.024141
2025-12-25 08:17:36 INFO Epoch 024 | 25% complete (batch 46/181)
2025-12-25 08:17:37 INFO Epoch 024 | 50% complete (batch 91/181)
2025-12-25 08:17:38 INFO Epoch 024 | 75% complete (batch 136/181)
2025-12-25 08:17:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.514348
2025-12-25 08:17:52 INFO Tuning ranking metrics: regret=0.089116 spearman=-0.063019 (groups=34, skipped=318)
2025-12-25 08:17:52 INFO Epoch 024 | train_mse=0.080932 | val_loss=0.087216 | best_val_loss=0.024141
2025-12-25 08:18:00 INFO Epoch 025 | 25% complete (batch 46/181)
2025-12-25 08:18:01 INFO Epoch 025 | 50% complete (batch 91/181)
2025-12-25 08:18:02 INFO Epoch 025 | 75% complete (batch 136/181)
2025-12-25 08:18:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.517605
2025-12-25 08:18:15 INFO Tuning ranking metrics: regret=0.089116 spearman=-0.062529 (groups=34, skipped=318)
2025-12-25 08:18:15 INFO Epoch 025 | train_mse=0.082232 | val_loss=0.086826 | best_val_loss=0.024141
2025-12-25 08:18:24 INFO Epoch 026 | 25% complete (batch 46/181)
2025-12-25 08:18:25 INFO Epoch 026 | 50% complete (batch 91/181)
2025-12-25 08:18:26 INFO Epoch 026 | 75% complete (batch 136/181)
2025-12-25 08:18:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.513684
2025-12-25 08:18:40 INFO Tuning ranking metrics: regret=0.067621 spearman=-0.049643 (groups=34, skipped=318)
2025-12-25 08:18:40 INFO Epoch 026 | train_mse=0.080306 | val_loss=0.087428 | best_val_loss=0.024141
Monitored metric tuning_rank_spearman did not improve in the last 24 records. Best score: 0.024. Signaling Trainer to stop.
2025-12-25 08:18:41 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.00395_val-0.08897_epoch014.chkpt, checkpoint.tuning_rank_spearman-0.02235_val-0.10240_epoch009.chkpt, checkpoint.tuning_rank_spearman-0.02414_val-0.12954_epoch002.chkpt
2025-12-25 08:18:41 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46/model_checkpoints/checkpoint.tuning_rank_spearman-0.02414_val-0.12954_epoch002.chkpt
2025-12-25 08:18:41 INFO Best validation loss: tensor(0.0241)
2025-12-25 08:18:41 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46/model_checkpoints/checkpoint.tuning_rank_spearman-0.02414_val-0.12954_epoch002.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46/model_checkpoints/checkpoint.tuning_rank_spearman-0.02414_val-0.12954_epoch002.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-25 08:18:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.129539
2025-12-25 08:18:53 INFO Tuning ranking metrics: regret=0.132389 spearman=0.024141 (groups=34, skipped=318)
2025-12-25 08:18:53 INFO Epoch 027 | val_loss=0.129539 | best_val_loss=0.024141
2025-12-25 08:18:54 INFO Validation metrics: [{'val_loss': 0.12953931093215942, 'tuning_rank_regret': 0.13238918781280518, 'tuning_rank_spearman': 0.02414056472480297, 'val_pearson_corr': 0.46975716948509216, 'val_spearman_corr': 0.4963991940021515, 'val_rank_regret': 0.03156936913728714, 'val_rank_spearman': 0.6666666865348816}]
2025-12-25 08:18:54 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.02414_val-0.12954_epoch002.chkpt
2025-12-25 08:18:54 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.02235_val-0.10240_epoch009.chkpt
2025-12-25 08:18:54 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.00395_val-0.08897_epoch014.chkpt
2025-12-25 08:18:54 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.12556_epoch001.ckpt
2025-12-25 08:18:54 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.13238918781280518
  tuning_rank_spearman      0.02414056472480297
        val_loss            0.12953931093215942
    val_pearson_corr        0.46975716948509216
     val_rank_regret        0.03156936913728714
    val_rank_spearman       0.6666666865348816
    val_spearman_corr       0.4963991940021515
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run sched_boost_lr035_lean_seed222_2025-12-25_08-07-46 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46
[train_cli][batch] job 'sched_boost_lr035_lean_seed222' finished.
[train_cli][batch] (3/3) running job 'large_batch_sched_boost_lean_seed222' -> run_name=large_batch_sched_boost_lean_seed222_2025-12-25_08-18-57
[train_cli] run_id=large_batch_sched_boost_lean_seed222_2025-12-25_08-18-57 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-25_08-18-57/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-25_08-18-57 --git-commit 9b1bb2b320 --git-dirty
2025-12-25 08:19:00 INFO git_commit = 9b1bb2b320 (dirty)
2025-12-25 08:19:00 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-25 08:19:00 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-25_08-18-57/config/config.yaml
2025-12-25 08:19:00 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data
2025-12-25 08:19:00 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-25 08:19:00 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-25 08:19:00 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-25_08-18-57
2025-12-25 08:19:00 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-25 08:19:00 INFO   metadata_path = None
2025-12-25 08:19:00 INFO   summary_path = None
2025-12-25 08:19:00 INFO   accelerator = cpu
2025-12-25 08:19:00 INFO   devices = 1
2025-12-25 08:19:00 INFO   attention_head = 8
2025-12-25 08:19:00 INFO   pooling_type = mean
2025-12-25 08:19:00 INFO   model_self_loops = False
2025-12-25 08:19:00 INFO   model_self_loop_fill = mean
2025-12-25 08:19:00 INFO   model_residual = False
2025-12-25 08:19:00 INFO   batch_size = 48
2025-12-25 08:19:00 INFO   learning_rate = 0.004
2025-12-25 08:19:00 INFO   num_epochs = 120
2025-12-25 08:19:00 INFO   accumulate_grad_batches = 8
2025-12-25 08:19:00 INFO   seed = 222
2025-12-25 08:19:00 INFO   num_workers = 2
2025-12-25 08:19:00 INFO   precision = 32
2025-12-25 08:19:00 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-25 08:19:00 INFO   early_stopping_patience = 20
2025-12-25 08:19:00 INFO   lr_scheduler_patience = 5
2025-12-25 08:19:00 INFO   lr_scheduler_factor = 0.2
2025-12-25 08:19:00 INFO   fast_dev_run = False
2025-12-25 08:19:00 INFO   limit_train_batches = None
2025-12-25 08:19:00 INFO   limit_val_batches = None
2025-12-25 08:19:00 INFO   log_lr = False
2025-12-25 08:19:00 INFO   progress_bar_refresh_rate = 0
2025-12-25 08:19:00 INFO   log_every_n_steps = 100
2025-12-25 08:19:00 INFO   use_val_spearman_as_secondary = True
2025-12-25 08:19:00 INFO   spearman_secondary_min_delta = 0.0
2025-12-25 08:19:00 INFO   spearman_secondary_weight = 1.0
2025-12-25 08:19:00 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-25 08:19:00 INFO   tuning_max_samples = 500
2025-12-25 08:19:00 INFO   tuning_fraction = None
2025-12-25 08:19:00 INFO   tuning_eval_every = 1
2025-12-25 08:19:00 INFO   rank_loss_weight = 0.0
2025-12-25 08:19:00 INFO   rank_loss_margin = 0.0
2025-12-25 08:19:00 INFO   rank_loss_mode = hinge
2025-12-25 08:19:00 INFO   rank_loss_grouped = True
2025-12-25 08:19:00 INFO   variance_reduction_enabled = False
2025-12-25 08:19:00 INFO   variance_reduction_method = topk_avg
2025-12-25 08:19:00 INFO   variance_reduction_top_k = 3
2025-12-25 08:19:00 INFO   coverage_minimum = 0.0
2025-12-25 08:19:00 INFO   coverage_fail_on_missing = False
2025-12-25 08:19:00 INFO   graph_load_profiling = False
2025-12-25 08:19:00 INFO   graph_load_top_k = 5
2025-12-25 08:19:00 INFO   enable_graph_cache = True
2025-12-25 08:19:00 INFO   graph_cache_size = 256
2025-12-25 08:19:00 INFO   canonicalize_on_load = False
2025-12-25 08:19:00 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-25 08:19:00 INFO   edge_schema = {}
2025-12-25 08:19:00 INFO   topology_schema = {}
Seed set to 222
2025-12-25 08:19:01 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-25 08:19:01 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 08:19:01 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-25 08:19:01 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 08:19:01 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-25 08:19:01 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 08:19:02 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-25 08:19:02 INFO Tuning group stats: groups=352 groups>=2=34 singletons=318 max_group=11
2025-12-25 08:19:02 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-25_08-18-57/dataset_coverage.json
2025-12-25 08:19:02 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-25_08-18-57/dataset_coverage.json for details.
2025-12-25 08:19:02 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-25_08-18-57/dataset_coverage.json for details.
2025-12-25 08:19:02 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-25_08-18-57/dataset_coverage.json for details.
2025-12-25 08:19:02 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-25_08-18-57/schema_summary.json
2025-12-25 08:19:02 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-25_08-18-57/feature_metadata.json
2025-12-25 08:19:02 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-25 08:19:02 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/null_topology/feature-config.yaml.null.10A, sha256=f618659ace5620de7e794485915dadd4243f3ec2ca6726b4a9af3989817a8579
2025-12-25 08:19:02 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/work/edge_features)
2025-12-25 08:19:02 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json
2025-12-25 08:19:02 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-25_08-18-57/schema_summary.json
2025-12-25 08:19:02 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-25 08:19:02 INFO Topology: topology/persistence_null/v1 supporting the 172-dimensional node features.
2025-12-25 08:19:02 INFO Node: node/dssp_topo_merge/v1; metadata lists 172 feature columns matching the .pt tensor.
2025-12-25 08:19:02 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-25 08:19:02 INFO → Total feature dimensionality observed and confirmed: node_dim = 172, edge_dim = 11.
2025-12-25 08:19:02 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-25 08:19:02 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 172,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 172,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-25_08-18-57/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge/v1",
      "alias": "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA",
      "jobs": 16,
      "summary": "DSSP-derived node features merged with topology statistics."
    },
    "topology": {
      "id": "topology/persistence_null/v1",
      "alias": "Null topology (constant zeros) = 140D ablation",
      "jobs": 16,
      "summary": "Topology ablation: constant features with PH-compatible schema."
    }
  },
  "notes": []
}
2025-12-25 08:19:02 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-25 08:19:02 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=bc6ac1de241846c38d180b1fa638bee6)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-25 08:19:02 INFO Starting training (fast_dev_run=False)
2025-12-25 08:19:02 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-25_08-18-57/model_checkpoints exists and is not empty.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 5.5 K  | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
165 K     Trainable params
0         Non-trainable params
165 K     Total params
0.662     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-25 08:19:17 INFO Epoch 000 | 25% complete (batch 46/181)
2025-12-25 08:19:18 INFO Epoch 000 | 50% complete (batch 91/181)
2025-12-25 08:19:19 INFO Epoch 000 | 75% complete (batch 136/181)
2025-12-25 08:19:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.140406
2025-12-25 08:19:33 INFO Tuning ranking metrics: regret=0.153784 spearman=-0.237325 (groups=34, skipped=318)
2025-12-25 08:19:33 INFO Epoch 000 | val_loss=0.140406
Metric tuning_rank_spearman improved. New best score: -0.237
2025-12-25 08:19:41 INFO Epoch 001 | 25% complete (batch 46/181)
2025-12-25 08:19:42 INFO Epoch 001 | 50% complete (batch 91/181)
2025-12-25 08:19:43 INFO Epoch 001 | 75% complete (batch 136/181)
2025-12-25 08:19:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.262142
2025-12-25 08:19:57 INFO Tuning ranking metrics: regret=0.142841 spearman=-0.125344 (groups=34, skipped=318)
2025-12-25 08:19:57 INFO Epoch 001 | train_mse=0.144576 | val_loss=0.132915 | best_val_loss=-0.237325
Metric tuning_rank_spearman improved by 0.112 >= min_delta = 0.0. New best score: -0.125
2025-12-25 08:20:05 INFO Epoch 002 | 25% complete (batch 46/181)
2025-12-25 08:20:06 INFO Epoch 002 | 50% complete (batch 91/181)
2025-12-25 08:20:07 INFO Epoch 002 | 75% complete (batch 136/181)
2025-12-25 08:20:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.314209
2025-12-25 08:20:21 INFO Tuning ranking metrics: regret=0.118811 spearman=0.008321 (groups=34, skipped=318)
2025-12-25 08:20:21 INFO Epoch 002 | train_mse=0.140677 | val_loss=0.118675 | best_val_loss=-0.125344
Metric tuning_rank_spearman improved by 0.134 >= min_delta = 0.0. New best score: 0.008
2025-12-25 08:20:29 INFO Epoch 003 | 25% complete (batch 46/181)
2025-12-25 08:20:30 INFO Epoch 003 | 50% complete (batch 91/181)
2025-12-25 08:20:31 INFO Epoch 003 | 75% complete (batch 136/181)
2025-12-25 08:20:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.427265
2025-12-25 08:20:45 INFO Tuning ranking metrics: regret=0.125449 spearman=-0.022422 (groups=34, skipped=318)
2025-12-25 08:20:45 INFO Epoch 003 | train_mse=0.116258 | val_loss=0.096834 | best_val_loss=0.008321
2025-12-25 08:20:53 INFO Epoch 004 | 25% complete (batch 46/181)
2025-12-25 08:20:54 INFO Epoch 004 | 50% complete (batch 91/181)
2025-12-25 08:20:55 INFO Epoch 004 | 75% complete (batch 136/181)
2025-12-25 08:21:04 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.465174
2025-12-25 08:21:09 INFO Tuning ranking metrics: regret=0.137723 spearman=0.015763 (groups=34, skipped=318)
2025-12-25 08:21:09 INFO Epoch 004 | train_mse=0.102206 | val_loss=0.102051 | best_val_loss=0.008321
Metric tuning_rank_spearman improved by 0.007 >= min_delta = 0.0. New best score: 0.016
2025-12-25 08:21:18 INFO Epoch 005 | 25% complete (batch 46/181)
2025-12-25 08:21:19 INFO Epoch 005 | 50% complete (batch 91/181)
2025-12-25 08:21:19 INFO Epoch 005 | 75% complete (batch 136/181)
2025-12-25 08:21:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.482470
2025-12-25 08:21:33 INFO Tuning ranking metrics: regret=0.123461 spearman=0.049885 (groups=34, skipped=318)
2025-12-25 08:21:33 INFO Epoch 005 | train_mse=0.104699 | val_loss=0.093406 | best_val_loss=0.015763
Metric tuning_rank_spearman improved by 0.034 >= min_delta = 0.0. New best score: 0.050
2025-12-25 08:21:42 INFO Epoch 006 | 25% complete (batch 46/181)
2025-12-25 08:21:43 INFO Epoch 006 | 50% complete (batch 91/181)
2025-12-25 08:21:44 INFO Epoch 006 | 75% complete (batch 136/181)
2025-12-25 08:21:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.486511
2025-12-25 08:21:58 INFO Tuning ranking metrics: regret=0.086547 spearman=-0.052152 (groups=34, skipped=318)
2025-12-25 08:21:58 INFO Epoch 006 | train_mse=0.101647 | val_loss=0.099828 | best_val_loss=0.049885
2025-12-25 08:22:06 INFO Epoch 007 | 25% complete (batch 46/181)
2025-12-25 08:22:07 INFO Epoch 007 | 50% complete (batch 91/181)
2025-12-25 08:22:08 INFO Epoch 007 | 75% complete (batch 136/181)
2025-12-25 08:22:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.495680
2025-12-25 08:22:22 INFO Tuning ranking metrics: regret=0.122676 spearman=-0.113165 (groups=34, skipped=318)
2025-12-25 08:22:22 INFO Epoch 007 | train_mse=0.120842 | val_loss=0.091967 | best_val_loss=0.049885
2025-12-25 08:22:30 INFO Epoch 008 | 25% complete (batch 46/181)
2025-12-25 08:22:31 INFO Epoch 008 | 50% complete (batch 91/181)
2025-12-25 08:22:32 INFO Epoch 008 | 75% complete (batch 136/181)
2025-12-25 08:22:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.485387
2025-12-25 08:22:46 INFO Tuning ranking metrics: regret=0.120962 spearman=-0.114127 (groups=34, skipped=318)
2025-12-25 08:22:46 INFO Epoch 008 | train_mse=0.107076 | val_loss=0.093558 | best_val_loss=0.049885
2025-12-25 08:22:55 INFO Epoch 009 | 25% complete (batch 46/181)
2025-12-25 08:22:55 INFO Epoch 009 | 50% complete (batch 91/181)
2025-12-25 08:22:56 INFO Epoch 009 | 75% complete (batch 136/181)
2025-12-25 08:23:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.475971
2025-12-25 08:23:10 INFO Tuning ranking metrics: regret=0.097117 spearman=-0.157429 (groups=34, skipped=318)
2025-12-25 08:23:10 INFO Epoch 009 | train_mse=0.093880 | val_loss=0.098329 | best_val_loss=0.049885
2025-12-25 08:23:19 INFO Epoch 010 | 25% complete (batch 46/181)
2025-12-25 08:23:20 INFO Epoch 010 | 50% complete (batch 91/181)
2025-12-25 08:23:21 INFO Epoch 010 | 75% complete (batch 136/181)
2025-12-25 08:23:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.507341
2025-12-25 08:23:35 INFO Tuning ranking metrics: regret=0.110510 spearman=-0.104329 (groups=34, skipped=318)
2025-12-25 08:23:35 INFO Epoch 010 | train_mse=0.094133 | val_loss=0.086544 | best_val_loss=0.049885
2025-12-25 08:23:43 INFO Epoch 011 | 25% complete (batch 46/181)
2025-12-25 08:23:44 INFO Epoch 011 | 50% complete (batch 91/181)
2025-12-25 08:23:45 INFO Epoch 011 | 75% complete (batch 136/181)
2025-12-25 08:23:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.483243
2025-12-25 08:23:59 INFO Tuning ranking metrics: regret=0.091327 spearman=-0.121906 (groups=34, skipped=318)
2025-12-25 08:23:59 INFO Epoch 011 | train_mse=0.082816 | val_loss=0.108059 | best_val_loss=0.049885
2025-12-25 08:24:07 INFO Epoch 012 | 25% complete (batch 46/181)
2025-12-25 08:24:08 INFO Epoch 012 | 50% complete (batch 91/181)
2025-12-25 08:24:09 INFO Epoch 012 | 75% complete (batch 136/181)
2025-12-25 08:24:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.495290
2025-12-25 08:24:23 INFO Tuning ranking metrics: regret=0.079188 spearman=-0.043487 (groups=34, skipped=318)
2025-12-25 08:24:23 INFO Epoch 012 | train_mse=0.109743 | val_loss=0.094873 | best_val_loss=0.049885
2025-12-25 08:24:32 INFO Epoch 013 | 25% complete (batch 46/181)
2025-12-25 08:24:33 INFO Epoch 013 | 50% complete (batch 91/181)
2025-12-25 08:24:33 INFO Epoch 013 | 75% complete (batch 136/181)
2025-12-25 08:24:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.478299
2025-12-25 08:24:48 INFO Tuning ranking metrics: regret=0.065939 spearman=0.015591 (groups=34, skipped=318)
2025-12-25 08:24:48 INFO Epoch 013 | train_mse=0.115882 | val_loss=0.120398 | best_val_loss=0.049885
2025-12-25 08:24:56 INFO Epoch 014 | 25% complete (batch 46/181)
2025-12-25 08:24:57 INFO Epoch 014 | 50% complete (batch 91/181)
2025-12-25 08:24:58 INFO Epoch 014 | 75% complete (batch 136/181)
2025-12-25 08:25:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.518597
2025-12-25 08:25:12 INFO Tuning ranking metrics: regret=0.071920 spearman=-0.112866 (groups=34, skipped=318)
2025-12-25 08:25:12 INFO Epoch 014 | train_mse=0.080807 | val_loss=0.094470 | best_val_loss=0.049885
2025-12-25 08:25:20 INFO Epoch 015 | 25% complete (batch 46/181)
2025-12-25 08:25:21 INFO Epoch 015 | 50% complete (batch 91/181)
2025-12-25 08:25:22 INFO Epoch 015 | 75% complete (batch 136/181)
2025-12-25 08:25:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.531228
2025-12-25 08:25:36 INFO Tuning ranking metrics: regret=0.098116 spearman=-0.057837 (groups=34, skipped=318)
2025-12-25 08:25:36 INFO Epoch 015 | train_mse=0.108025 | val_loss=0.084924 | best_val_loss=0.049885
2025-12-25 08:25:45 INFO Epoch 016 | 25% complete (batch 46/181)
2025-12-25 08:25:46 INFO Epoch 016 | 50% complete (batch 91/181)
2025-12-25 08:25:47 INFO Epoch 016 | 75% complete (batch 136/181)
2025-12-25 08:25:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.530447
2025-12-25 08:26:00 INFO Tuning ranking metrics: regret=0.087463 spearman=0.027941 (groups=34, skipped=318)
2025-12-25 08:26:00 INFO Epoch 016 | train_mse=0.101439 | val_loss=0.085789 | best_val_loss=0.049885
2025-12-25 08:26:09 INFO Epoch 017 | 25% complete (batch 46/181)
2025-12-25 08:26:10 INFO Epoch 017 | 50% complete (batch 91/181)
2025-12-25 08:26:11 INFO Epoch 017 | 75% complete (batch 136/181)
2025-12-25 08:26:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.517484
2025-12-25 08:26:25 INFO Tuning ranking metrics: regret=0.083742 spearman=-0.146594 (groups=34, skipped=318)
2025-12-25 08:26:25 INFO Epoch 017 | train_mse=0.108057 | val_loss=0.086964 | best_val_loss=0.049885
2025-12-25 08:26:33 INFO Epoch 018 | 25% complete (batch 46/181)
2025-12-25 08:26:34 INFO Epoch 018 | 50% complete (batch 91/181)
2025-12-25 08:26:35 INFO Epoch 018 | 75% complete (batch 136/181)
2025-12-25 08:26:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.528218
2025-12-25 08:26:49 INFO Tuning ranking metrics: regret=0.060935 spearman=-0.031888 (groups=34, skipped=318)
2025-12-25 08:26:49 INFO Epoch 018 | train_mse=0.077651 | val_loss=0.094573 | best_val_loss=0.049885
2025-12-25 08:26:57 INFO Epoch 019 | 25% complete (batch 46/181)
2025-12-25 08:26:58 INFO Epoch 019 | 50% complete (batch 91/181)
2025-12-25 08:26:59 INFO Epoch 019 | 75% complete (batch 136/181)
2025-12-25 08:27:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.514778
2025-12-25 08:27:13 INFO Tuning ranking metrics: regret=0.038002 spearman=0.093150 (groups=34, skipped=318)
2025-12-25 08:27:13 INFO Epoch 019 | train_mse=0.088677 | val_loss=0.105751 | best_val_loss=0.049885
Metric tuning_rank_spearman improved by 0.043 >= min_delta = 0.0. New best score: 0.093
2025-12-25 08:27:22 INFO Epoch 020 | 25% complete (batch 46/181)
2025-12-25 08:27:23 INFO Epoch 020 | 50% complete (batch 91/181)
2025-12-25 08:27:24 INFO Epoch 020 | 75% complete (batch 136/181)
2025-12-25 08:27:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.507901
2025-12-25 08:27:38 INFO Tuning ranking metrics: regret=0.053350 spearman=-0.004838 (groups=34, skipped=318)
2025-12-25 08:27:38 INFO Epoch 020 | train_mse=0.086913 | val_loss=0.097654 | best_val_loss=0.093150
2025-12-25 08:27:47 INFO Epoch 021 | 25% complete (batch 46/181)
2025-12-25 08:27:48 INFO Epoch 021 | 50% complete (batch 91/181)
2025-12-25 08:27:49 INFO Epoch 021 | 75% complete (batch 136/181)
2025-12-25 08:27:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.517929
2025-12-25 08:28:02 INFO Tuning ranking metrics: regret=0.073637 spearman=-0.023109 (groups=34, skipped=318)
2025-12-25 08:28:02 INFO Epoch 021 | train_mse=0.089113 | val_loss=0.099347 | best_val_loss=0.093150
2025-12-25 08:28:11 INFO Epoch 022 | 25% complete (batch 46/181)
2025-12-25 08:28:12 INFO Epoch 022 | 50% complete (batch 91/181)
2025-12-25 08:28:13 INFO Epoch 022 | 75% complete (batch 136/181)
2025-12-25 08:28:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.510005
2025-12-25 08:28:27 INFO Tuning ranking metrics: regret=0.086462 spearman=-0.069780 (groups=34, skipped=318)
2025-12-25 08:28:27 INFO Epoch 022 | train_mse=0.094555 | val_loss=0.087116 | best_val_loss=0.093150
2025-12-25 08:28:35 INFO Epoch 023 | 25% complete (batch 46/181)
2025-12-25 08:28:36 INFO Epoch 023 | 50% complete (batch 91/181)
2025-12-25 08:28:37 INFO Epoch 023 | 75% complete (batch 136/181)
2025-12-25 08:28:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.519467
2025-12-25 08:28:51 INFO Tuning ranking metrics: regret=0.092520 spearman=-0.115177 (groups=34, skipped=318)
2025-12-25 08:28:51 INFO Epoch 023 | train_mse=0.099126 | val_loss=0.089676 | best_val_loss=0.093150
2025-12-25 08:29:00 INFO Epoch 024 | 25% complete (batch 46/181)
2025-12-25 08:29:00 INFO Epoch 024 | 50% complete (batch 91/181)
2025-12-25 08:29:01 INFO Epoch 024 | 75% complete (batch 136/181)
2025-12-25 08:29:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.540827
2025-12-25 08:29:15 INFO Tuning ranking metrics: regret=0.092520 spearman=-0.127254 (groups=34, skipped=318)
2025-12-25 08:29:15 INFO Epoch 024 | train_mse=0.088477 | val_loss=0.085251 | best_val_loss=0.093150
2025-12-25 08:29:24 INFO Epoch 025 | 25% complete (batch 46/181)
2025-12-25 08:29:25 INFO Epoch 025 | 50% complete (batch 91/181)
2025-12-25 08:29:26 INFO Epoch 025 | 75% complete (batch 136/181)
2025-12-25 08:29:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.537436
2025-12-25 08:29:39 INFO Tuning ranking metrics: regret=0.092138 spearman=-0.132964 (groups=34, skipped=318)
2025-12-25 08:29:39 INFO Epoch 025 | train_mse=0.083273 | val_loss=0.085239 | best_val_loss=0.093150
2025-12-25 08:29:48 INFO Epoch 026 | 25% complete (batch 46/181)
2025-12-25 08:29:49 INFO Epoch 026 | 50% complete (batch 91/181)
2025-12-25 08:29:50 INFO Epoch 026 | 75% complete (batch 136/181)
2025-12-25 08:29:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.533594
2025-12-25 08:30:04 INFO Tuning ranking metrics: regret=0.092138 spearman=-0.125134 (groups=34, skipped=318)
2025-12-25 08:30:04 INFO Epoch 026 | train_mse=0.083573 | val_loss=0.088510 | best_val_loss=0.093150
2025-12-25 08:30:12 INFO Epoch 027 | 25% complete (batch 46/181)
2025-12-25 08:30:13 INFO Epoch 027 | 50% complete (batch 91/181)
2025-12-25 08:30:14 INFO Epoch 027 | 75% complete (batch 136/181)
2025-12-25 08:30:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.538321
2025-12-25 08:30:28 INFO Tuning ranking metrics: regret=0.092520 spearman=-0.135517 (groups=34, skipped=318)
2025-12-25 08:30:28 INFO Epoch 027 | train_mse=0.070371 | val_loss=0.086668 | best_val_loss=0.093150
2025-12-25 08:30:37 INFO Epoch 028 | 25% complete (batch 46/181)
2025-12-25 08:30:38 INFO Epoch 028 | 50% complete (batch 91/181)
2025-12-25 08:30:39 INFO Epoch 028 | 75% complete (batch 136/181)
2025-12-25 08:30:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.537310
2025-12-25 08:30:53 INFO Tuning ranking metrics: regret=0.092520 spearman=-0.135517 (groups=34, skipped=318)
2025-12-25 08:30:53 INFO Epoch 028 | train_mse=0.064079 | val_loss=0.086405 | best_val_loss=0.093150
2025-12-25 08:31:02 INFO Epoch 029 | 25% complete (batch 46/181)
2025-12-25 08:31:03 INFO Epoch 029 | 50% complete (batch 91/181)
2025-12-25 08:31:04 INFO Epoch 029 | 75% complete (batch 136/181)
2025-12-25 08:31:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.533782
2025-12-25 08:31:17 INFO Tuning ranking metrics: regret=0.086462 spearman=-0.068303 (groups=34, skipped=318)
2025-12-25 08:31:17 INFO Epoch 029 | train_mse=0.080706 | val_loss=0.088171 | best_val_loss=0.093150
2025-12-25 08:31:26 INFO Epoch 030 | 25% complete (batch 46/181)
2025-12-25 08:31:27 INFO Epoch 030 | 50% complete (batch 91/181)
2025-12-25 08:31:28 INFO Epoch 030 | 75% complete (batch 136/181)
2025-12-25 08:31:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.539230
2025-12-25 08:31:42 INFO Tuning ranking metrics: regret=0.092138 spearman=-0.136510 (groups=34, skipped=318)
2025-12-25 08:31:42 INFO Epoch 030 | train_mse=0.086107 | val_loss=0.085490 | best_val_loss=0.093150
2025-12-25 08:31:51 INFO Epoch 031 | 25% complete (batch 46/181)
2025-12-25 08:31:52 INFO Epoch 031 | 50% complete (batch 91/181)
2025-12-25 08:31:53 INFO Epoch 031 | 75% complete (batch 136/181)
2025-12-25 08:32:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.536687
2025-12-25 08:32:06 INFO Tuning ranking metrics: regret=0.086462 spearman=-0.076006 (groups=34, skipped=318)
2025-12-25 08:32:06 INFO Epoch 031 | train_mse=0.090014 | val_loss=0.085770 | best_val_loss=0.093150
2025-12-25 08:32:15 INFO Epoch 032 | 25% complete (batch 46/181)
2025-12-25 08:32:16 INFO Epoch 032 | 50% complete (batch 91/181)
2025-12-25 08:32:17 INFO Epoch 032 | 75% complete (batch 136/181)
2025-12-25 08:32:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.538483
2025-12-25 08:32:31 INFO Tuning ranking metrics: regret=0.092138 spearman=-0.136510 (groups=34, skipped=318)
2025-12-25 08:32:31 INFO Epoch 032 | train_mse=0.083689 | val_loss=0.085080 | best_val_loss=0.093150
2025-12-25 08:32:40 INFO Epoch 033 | 25% complete (batch 46/181)
2025-12-25 08:32:40 INFO Epoch 033 | 50% complete (batch 91/181)
2025-12-25 08:32:41 INFO Epoch 033 | 75% complete (batch 136/181)
2025-12-25 08:32:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.539353
2025-12-25 08:32:55 INFO Tuning ranking metrics: regret=0.092138 spearman=-0.132588 (groups=34, skipped=318)
2025-12-25 08:32:55 INFO Epoch 033 | train_mse=0.080235 | val_loss=0.084948 | best_val_loss=0.093150
2025-12-25 08:33:03 INFO Epoch 034 | 25% complete (batch 46/181)
2025-12-25 08:33:04 INFO Epoch 034 | 50% complete (batch 91/181)
2025-12-25 08:33:05 INFO Epoch 034 | 75% complete (batch 136/181)
2025-12-25 08:33:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.545363
2025-12-25 08:33:19 INFO Tuning ranking metrics: regret=0.092138 spearman=-0.132588 (groups=34, skipped=318)
2025-12-25 08:33:19 INFO Epoch 034 | train_mse=0.079053 | val_loss=0.084907 | best_val_loss=0.093150
2025-12-25 08:33:28 INFO Epoch 035 | 25% complete (batch 46/181)
2025-12-25 08:33:28 INFO Epoch 035 | 50% complete (batch 91/181)
2025-12-25 08:33:29 INFO Epoch 035 | 75% complete (batch 136/181)
2025-12-25 08:33:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.544457
2025-12-25 08:33:43 INFO Tuning ranking metrics: regret=0.092138 spearman=-0.132588 (groups=34, skipped=318)
2025-12-25 08:33:43 INFO Epoch 035 | train_mse=0.066042 | val_loss=0.084975 | best_val_loss=0.093150
2025-12-25 08:33:52 INFO Epoch 036 | 25% complete (batch 46/181)
2025-12-25 08:33:52 INFO Epoch 036 | 50% complete (batch 91/181)
2025-12-25 08:33:53 INFO Epoch 036 | 75% complete (batch 136/181)
2025-12-25 08:34:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.541925
2025-12-25 08:34:07 INFO Tuning ranking metrics: regret=0.092138 spearman=-0.132588 (groups=34, skipped=318)
2025-12-25 08:34:07 INFO Epoch 036 | train_mse=0.094807 | val_loss=0.084959 | best_val_loss=0.093150
2025-12-25 08:34:15 INFO Epoch 037 | 25% complete (batch 46/181)
2025-12-25 08:34:16 INFO Epoch 037 | 50% complete (batch 91/181)
2025-12-25 08:34:17 INFO Epoch 037 | 75% complete (batch 136/181)
2025-12-25 08:34:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.543069
2025-12-25 08:34:31 INFO Tuning ranking metrics: regret=0.092138 spearman=-0.132588 (groups=34, skipped=318)
2025-12-25 08:34:31 INFO Epoch 037 | train_mse=0.086561 | val_loss=0.084988 | best_val_loss=0.093150
2025-12-25 08:34:40 INFO Epoch 038 | 25% complete (batch 46/181)
2025-12-25 08:34:41 INFO Epoch 038 | 50% complete (batch 91/181)
2025-12-25 08:34:42 INFO Epoch 038 | 75% complete (batch 136/181)
2025-12-25 08:34:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.543473
2025-12-25 08:34:55 INFO Tuning ranking metrics: regret=0.092138 spearman=-0.132588 (groups=34, skipped=318)
2025-12-25 08:34:55 INFO Epoch 038 | train_mse=0.074162 | val_loss=0.084885 | best_val_loss=0.093150
2025-12-25 08:35:04 INFO Epoch 039 | 25% complete (batch 46/181)
2025-12-25 08:35:05 INFO Epoch 039 | 50% complete (batch 91/181)
2025-12-25 08:35:06 INFO Epoch 039 | 75% complete (batch 136/181)
2025-12-25 08:35:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.543225
2025-12-25 08:35:19 INFO Tuning ranking metrics: regret=0.092138 spearman=-0.125306 (groups=34, skipped=318)
2025-12-25 08:35:19 INFO Epoch 039 | train_mse=0.090492 | val_loss=0.085133 | best_val_loss=0.093150
Monitored metric tuning_rank_spearman did not improve in the last 20 records. Best score: 0.093. Signaling Trainer to stop.
2025-12-25 08:35:20 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.02794_val-0.08579_epoch016.chkpt, checkpoint.tuning_rank_spearman-0.04989_val-0.09341_epoch005.chkpt, checkpoint.tuning_rank_spearman-0.09315_val-0.10575_epoch019.chkpt
2025-12-25 08:35:20 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-25_08-18-57/model_checkpoints/checkpoint.tuning_rank_spearman-0.09315_val-0.10575_epoch019.chkpt
2025-12-25 08:35:20 INFO Best validation loss: tensor(0.0931)
2025-12-25 08:35:20 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-25_08-18-57/model_checkpoints/checkpoint.tuning_rank_spearman-0.09315_val-0.10575_epoch019.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-25_08-18-57/model_checkpoints/checkpoint.tuning_rank_spearman-0.09315_val-0.10575_epoch019.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-25 08:35:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.105751
2025-12-25 08:35:33 INFO Tuning ranking metrics: regret=0.038002 spearman=0.093150 (groups=34, skipped=318)
2025-12-25 08:35:33 INFO Epoch 040 | val_loss=0.105751 | best_val_loss=0.093150
2025-12-25 08:35:34 INFO Validation metrics: [{'val_loss': 0.10575076192617416, 'tuning_rank_regret': 0.038002341985702515, 'tuning_rank_spearman': 0.09314998984336853, 'val_pearson_corr': 0.5895146727561951, 'val_spearman_corr': 0.6055550575256348, 'val_rank_regret': 0.007135567255318165, 'val_rank_spearman': 0.5555555820465088}]
2025-12-25 08:35:34 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.09315_val-0.10575_epoch019.chkpt
2025-12-25 08:35:34 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.04989_val-0.09341_epoch005.chkpt
2025-12-25 08:35:34 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.02794_val-0.08579_epoch016.chkpt
2025-12-25 08:35:34 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.08492_epoch015.ckpt
2025-12-25 08:35:34 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret      0.038002341985702515
  tuning_rank_spearman      0.09314998984336853
        val_loss            0.10575076192617416
    val_pearson_corr        0.5895146727561951
     val_rank_regret       0.007135567255318165
    val_rank_spearman       0.5555555820465088
    val_spearman_corr       0.6055550575256348
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run large_batch_sched_boost_lean_seed222_2025-12-25_08-18-57 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/large_batch_sched_boost_lean_seed222_2025-12-25_08-18-57
[train_cli][batch] job 'large_batch_sched_boost_lean_seed222' finished.
[run_full_pipeline] Best run: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46 (tuning_rank_spearman=0.02414056472480297)
[run_full_pipeline] Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46/model_checkpoints/checkpoint.tuning_rank_spearman-0.02414_val-0.12954_epoch002.chkpt
[run_full_pipeline] Phase 1 fine-tuning -> sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase1
[train_cli] run_id=sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase1 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase1/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase1 --git-commit 9b1bb2b320 --git-dirty --resume-from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46/model_checkpoints/checkpoint.tuning_rank_spearman-0.02414_val-0.12954_epoch002.chkpt
2025-12-25 08:35:40 INFO git_commit = 9b1bb2b320 (dirty)
2025-12-25 08:35:40 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-25 08:35:40 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase1/config/config.yaml
2025-12-25 08:35:40 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data
2025-12-25 08:35:40 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-25 08:35:40 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-25 08:35:40 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase1
2025-12-25 08:35:40 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-25 08:35:40 INFO   metadata_path = None
2025-12-25 08:35:40 INFO   summary_path = None
2025-12-25 08:35:40 INFO   accelerator = cpu
2025-12-25 08:35:40 INFO   devices = 1
2025-12-25 08:35:40 INFO   attention_head = 8
2025-12-25 08:35:40 INFO   pooling_type = mean
2025-12-25 08:35:40 INFO   model_self_loops = False
2025-12-25 08:35:40 INFO   model_self_loop_fill = mean
2025-12-25 08:35:40 INFO   model_residual = False
2025-12-25 08:35:40 INFO   batch_size = 48
2025-12-25 08:35:40 INFO   learning_rate = 0.001
2025-12-25 08:35:40 INFO   num_epochs = 320
2025-12-25 08:35:40 INFO   accumulate_grad_batches = 8
2025-12-25 08:35:40 INFO   seed = 222
2025-12-25 08:35:40 INFO   num_workers = 2
2025-12-25 08:35:40 INFO   precision = 32
2025-12-25 08:35:40 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-25 08:35:40 INFO   early_stopping_patience = 20
2025-12-25 08:35:40 INFO   lr_scheduler_patience = 4
2025-12-25 08:35:40 INFO   lr_scheduler_factor = 0.2
2025-12-25 08:35:40 INFO   fast_dev_run = False
2025-12-25 08:35:40 INFO   limit_train_batches = None
2025-12-25 08:35:40 INFO   limit_val_batches = None
2025-12-25 08:35:40 INFO   log_lr = False
2025-12-25 08:35:40 INFO   progress_bar_refresh_rate = 0
2025-12-25 08:35:40 INFO   log_every_n_steps = 100
2025-12-25 08:35:40 INFO   use_val_spearman_as_secondary = True
2025-12-25 08:35:40 INFO   spearman_secondary_min_delta = 0.0
2025-12-25 08:35:40 INFO   spearman_secondary_weight = 1.0
2025-12-25 08:35:40 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-25 08:35:40 INFO   tuning_max_samples = 500
2025-12-25 08:35:40 INFO   tuning_fraction = None
2025-12-25 08:35:40 INFO   tuning_eval_every = 1
2025-12-25 08:35:40 INFO   rank_loss_weight = 0.0
2025-12-25 08:35:40 INFO   rank_loss_margin = 0.0
2025-12-25 08:35:40 INFO   rank_loss_mode = hinge
2025-12-25 08:35:40 INFO   rank_loss_grouped = True
2025-12-25 08:35:40 INFO   variance_reduction_enabled = False
2025-12-25 08:35:40 INFO   variance_reduction_method = topk_avg
2025-12-25 08:35:40 INFO   variance_reduction_top_k = 3
2025-12-25 08:35:40 INFO   coverage_minimum = 0.0
2025-12-25 08:35:40 INFO   coverage_fail_on_missing = False
2025-12-25 08:35:40 INFO   graph_load_profiling = False
2025-12-25 08:35:40 INFO   graph_load_top_k = 5
2025-12-25 08:35:40 INFO   enable_graph_cache = True
2025-12-25 08:35:40 INFO   graph_cache_size = 256
2025-12-25 08:35:40 INFO   canonicalize_on_load = False
2025-12-25 08:35:40 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-25 08:35:40 INFO   edge_schema = {}
2025-12-25 08:35:40 INFO   topology_schema = {}
Seed set to 222
2025-12-25 08:35:41 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-25 08:35:41 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 08:35:41 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-25 08:35:41 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 08:35:41 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-25 08:35:41 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 08:35:42 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-25 08:35:42 INFO Tuning group stats: groups=352 groups>=2=34 singletons=318 max_group=11
2025-12-25 08:35:42 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase1/dataset_coverage.json
2025-12-25 08:35:42 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase1/dataset_coverage.json for details.
2025-12-25 08:35:42 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase1/dataset_coverage.json for details.
2025-12-25 08:35:42 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase1/dataset_coverage.json for details.
2025-12-25 08:35:42 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase1/schema_summary.json
2025-12-25 08:35:42 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase1/feature_metadata.json
2025-12-25 08:35:42 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-25 08:35:42 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/null_topology/feature-config.yaml.null.10A, sha256=f618659ace5620de7e794485915dadd4243f3ec2ca6726b4a9af3989817a8579
2025-12-25 08:35:42 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/work/edge_features)
2025-12-25 08:35:42 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json
2025-12-25 08:35:42 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase1/schema_summary.json
2025-12-25 08:35:42 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-25 08:35:42 INFO Topology: topology/persistence_null/v1 supporting the 172-dimensional node features.
2025-12-25 08:35:42 INFO Node: node/dssp_topo_merge/v1; metadata lists 172 feature columns matching the .pt tensor.
2025-12-25 08:35:42 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-25 08:35:42 INFO → Total feature dimensionality observed and confirmed: node_dim = 172, edge_dim = 11.
2025-12-25 08:35:42 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-25 08:35:42 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 172,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 172,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase1/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge/v1",
      "alias": "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA",
      "jobs": 16,
      "summary": "DSSP-derived node features merged with topology statistics."
    },
    "topology": {
      "id": "topology/persistence_null/v1",
      "alias": "Null topology (constant zeros) = 140D ablation",
      "jobs": 16,
      "summary": "Topology ablation: constant features with PH-compatible schema."
    }
  },
  "notes": []
}
2025-12-25 08:35:42 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-25 08:35:42 INFO Resuming from checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46/model_checkpoints/checkpoint.tuning_rank_spearman-0.02414_val-0.12954_epoch002.chkpt (epoch=2)
2025-12-25 08:35:42 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=1160edd359e44ca7b337fc14159ee7e8)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-25 08:35:42 INFO Starting training (fast_dev_run=False)
2025-12-25 08:35:42 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase1/model_checkpoints exists and is not empty.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46/model_checkpoints/checkpoint.tuning_rank_spearman-0.02414_val-0.12954_epoch002.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46/model_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase1/model_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46/model_checkpoints/val_loss_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase1/model_checkpoints/val_loss_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 5.5 K  | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
165 K     Trainable params
0         Non-trainable params
165 K     Total params
0.662     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
Restored all states from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46/model_checkpoints/checkpoint.tuning_rank_spearman-0.02414_val-0.12954_epoch002.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-25 08:35:58 INFO Epoch 003 | 25% complete (batch 46/181)
2025-12-25 08:35:59 INFO Epoch 003 | 50% complete (batch 91/181)
2025-12-25 08:35:59 INFO Epoch 003 | 75% complete (batch 136/181)
2025-12-25 08:36:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.103544
2025-12-25 08:36:14 INFO Tuning ranking metrics: regret=0.123851 spearman=-0.066094 (groups=34, skipped=318)
2025-12-25 08:36:14 INFO Epoch 003 | val_loss=0.103544
2025-12-25 08:36:23 INFO Epoch 004 | 25% complete (batch 46/181)
2025-12-25 08:36:24 INFO Epoch 004 | 50% complete (batch 91/181)
2025-12-25 08:36:25 INFO Epoch 004 | 75% complete (batch 136/181)
2025-12-25 08:36:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.371981
2025-12-25 08:36:40 INFO Tuning ranking metrics: regret=0.118163 spearman=0.019079 (groups=34, skipped=318)
2025-12-25 08:36:40 INFO Epoch 004 | train_mse=0.105574 | val_loss=0.132651 | best_val_loss=-0.066094
2025-12-25 08:36:49 INFO Epoch 005 | 25% complete (batch 46/181)
2025-12-25 08:36:50 INFO Epoch 005 | 50% complete (batch 91/181)
2025-12-25 08:36:51 INFO Epoch 005 | 75% complete (batch 136/181)
2025-12-25 08:37:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.411886
2025-12-25 08:37:05 INFO Tuning ranking metrics: regret=0.108118 spearman=-0.059365 (groups=34, skipped=318)
2025-12-25 08:37:05 INFO Epoch 005 | train_mse=0.088795 | val_loss=0.098414 | best_val_loss=0.019079
2025-12-25 08:37:14 INFO Epoch 006 | 25% complete (batch 46/181)
2025-12-25 08:37:14 INFO Epoch 006 | 50% complete (batch 91/181)
2025-12-25 08:37:15 INFO Epoch 006 | 75% complete (batch 136/181)
2025-12-25 08:37:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.422164
2025-12-25 08:37:29 INFO Tuning ranking metrics: regret=0.119759 spearman=-0.023765 (groups=34, skipped=318)
2025-12-25 08:37:29 INFO Epoch 006 | train_mse=0.097593 | val_loss=0.094976 | best_val_loss=0.019079
2025-12-25 08:37:38 INFO Epoch 007 | 25% complete (batch 46/181)
2025-12-25 08:37:39 INFO Epoch 007 | 50% complete (batch 91/181)
2025-12-25 08:37:40 INFO Epoch 007 | 75% complete (batch 136/181)
2025-12-25 08:37:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.448052
2025-12-25 08:37:53 INFO Tuning ranking metrics: regret=0.122383 spearman=-0.101553 (groups=34, skipped=318)
2025-12-25 08:37:53 INFO Epoch 007 | train_mse=0.097550 | val_loss=0.099739 | best_val_loss=0.019079
2025-12-25 08:38:02 INFO Epoch 008 | 25% complete (batch 46/181)
2025-12-25 08:38:03 INFO Epoch 008 | 50% complete (batch 91/181)
2025-12-25 08:38:04 INFO Epoch 008 | 75% complete (batch 136/181)
2025-12-25 08:38:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.471687
2025-12-25 08:38:17 INFO Tuning ranking metrics: regret=0.107510 spearman=-0.165712 (groups=34, skipped=318)
2025-12-25 08:38:17 INFO Epoch 008 | train_mse=0.097471 | val_loss=0.092067 | best_val_loss=0.019079
2025-12-25 08:38:26 INFO Epoch 009 | 25% complete (batch 46/181)
2025-12-25 08:38:27 INFO Epoch 009 | 50% complete (batch 91/181)
2025-12-25 08:38:28 INFO Epoch 009 | 75% complete (batch 136/181)
2025-12-25 08:38:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.466245
2025-12-25 08:38:41 INFO Tuning ranking metrics: regret=0.075107 spearman=-0.021403 (groups=34, skipped=318)
2025-12-25 08:38:41 INFO Epoch 009 | train_mse=0.096987 | val_loss=0.110722 | best_val_loss=0.019079
2025-12-25 08:38:50 INFO Epoch 010 | 25% complete (batch 46/181)
2025-12-25 08:38:51 INFO Epoch 010 | 50% complete (batch 91/181)
2025-12-25 08:38:52 INFO Epoch 010 | 75% complete (batch 136/181)
2025-12-25 08:39:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.479666
2025-12-25 08:39:06 INFO Tuning ranking metrics: regret=0.107086 spearman=-0.145499 (groups=34, skipped=318)
2025-12-25 08:39:06 INFO Epoch 010 | train_mse=0.100158 | val_loss=0.095624 | best_val_loss=0.019079
2025-12-25 08:39:14 INFO Epoch 011 | 25% complete (batch 46/181)
2025-12-25 08:39:15 INFO Epoch 011 | 50% complete (batch 91/181)
2025-12-25 08:39:16 INFO Epoch 011 | 75% complete (batch 136/181)
2025-12-25 08:39:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.462943
2025-12-25 08:39:30 INFO Tuning ranking metrics: regret=0.110639 spearman=-0.191718 (groups=34, skipped=318)
2025-12-25 08:39:30 INFO Epoch 011 | train_mse=0.097693 | val_loss=0.093786 | best_val_loss=0.019079
2025-12-25 08:39:38 INFO Epoch 012 | 25% complete (batch 46/181)
2025-12-25 08:39:39 INFO Epoch 012 | 50% complete (batch 91/181)
2025-12-25 08:39:40 INFO Epoch 012 | 75% complete (batch 136/181)
2025-12-25 08:39:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.465314
2025-12-25 08:39:54 INFO Tuning ranking metrics: regret=0.107554 spearman=-0.099077 (groups=34, skipped=318)
2025-12-25 08:39:54 INFO Epoch 012 | train_mse=0.091382 | val_loss=0.100837 | best_val_loss=0.019079
2025-12-25 08:40:03 INFO Epoch 013 | 25% complete (batch 46/181)
2025-12-25 08:40:03 INFO Epoch 013 | 50% complete (batch 91/181)
2025-12-25 08:40:04 INFO Epoch 013 | 75% complete (batch 136/181)
2025-12-25 08:40:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.438934
2025-12-25 08:40:18 INFO Tuning ranking metrics: regret=0.108811 spearman=-0.181831 (groups=34, skipped=318)
2025-12-25 08:40:18 INFO Epoch 013 | train_mse=0.089896 | val_loss=0.112798 | best_val_loss=0.019079
2025-12-25 08:40:27 INFO Epoch 014 | 25% complete (batch 46/181)
2025-12-25 08:40:28 INFO Epoch 014 | 50% complete (batch 91/181)
2025-12-25 08:40:29 INFO Epoch 014 | 75% complete (batch 136/181)
2025-12-25 08:40:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.464937
2025-12-25 08:40:42 INFO Tuning ranking metrics: regret=0.100277 spearman=-0.166628 (groups=34, skipped=318)
2025-12-25 08:40:42 INFO Epoch 014 | train_mse=0.092461 | val_loss=0.098784 | best_val_loss=0.019079
2025-12-25 08:40:51 INFO Epoch 015 | 25% complete (batch 46/181)
2025-12-25 08:40:52 INFO Epoch 015 | 50% complete (batch 91/181)
2025-12-25 08:40:53 INFO Epoch 015 | 75% complete (batch 136/181)
2025-12-25 08:41:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.475144
2025-12-25 08:41:06 INFO Tuning ranking metrics: regret=0.098426 spearman=-0.149446 (groups=34, skipped=318)
2025-12-25 08:41:06 INFO Epoch 015 | train_mse=0.113831 | val_loss=0.092450 | best_val_loss=0.019079
2025-12-25 08:41:15 INFO Epoch 016 | 25% complete (batch 46/181)
2025-12-25 08:41:16 INFO Epoch 016 | 50% complete (batch 91/181)
2025-12-25 08:41:16 INFO Epoch 016 | 75% complete (batch 136/181)
2025-12-25 08:41:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.473365
2025-12-25 08:41:30 INFO Tuning ranking metrics: regret=0.097630 spearman=-0.083416 (groups=34, skipped=318)
2025-12-25 08:41:30 INFO Epoch 016 | train_mse=0.084965 | val_loss=0.097481 | best_val_loss=0.019079
2025-12-25 08:41:39 INFO Epoch 017 | 25% complete (batch 46/181)
2025-12-25 08:41:40 INFO Epoch 017 | 50% complete (batch 91/181)
2025-12-25 08:41:41 INFO Epoch 017 | 75% complete (batch 136/181)
2025-12-25 08:41:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.478109
2025-12-25 08:41:54 INFO Tuning ranking metrics: regret=0.100375 spearman=-0.161752 (groups=34, skipped=318)
2025-12-25 08:41:54 INFO Epoch 017 | train_mse=0.072523 | val_loss=0.088478 | best_val_loss=0.019079
2025-12-25 08:42:03 INFO Epoch 018 | 25% complete (batch 46/181)
2025-12-25 08:42:04 INFO Epoch 018 | 50% complete (batch 91/181)
2025-12-25 08:42:05 INFO Epoch 018 | 75% complete (batch 136/181)
2025-12-25 08:42:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.497343
2025-12-25 08:42:18 INFO Tuning ranking metrics: regret=0.100375 spearman=-0.153005 (groups=34, skipped=318)
2025-12-25 08:42:18 INFO Epoch 018 | train_mse=0.094873 | val_loss=0.088209 | best_val_loss=0.019079
2025-12-25 08:42:27 INFO Epoch 019 | 25% complete (batch 46/181)
2025-12-25 08:42:28 INFO Epoch 019 | 50% complete (batch 91/181)
2025-12-25 08:42:28 INFO Epoch 019 | 75% complete (batch 136/181)
2025-12-25 08:42:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.493374
2025-12-25 08:42:42 INFO Tuning ranking metrics: regret=0.092988 spearman=-0.008378 (groups=34, skipped=318)
2025-12-25 08:42:42 INFO Epoch 019 | train_mse=0.089375 | val_loss=0.092462 | best_val_loss=0.019079
2025-12-25 08:42:51 INFO Epoch 020 | 25% complete (batch 46/181)
2025-12-25 08:42:52 INFO Epoch 020 | 50% complete (batch 91/181)
2025-12-25 08:42:52 INFO Epoch 020 | 75% complete (batch 136/181)
2025-12-25 08:43:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.489675
2025-12-25 08:43:06 INFO Tuning ranking metrics: regret=0.097632 spearman=-0.071772 (groups=34, skipped=318)
2025-12-25 08:43:06 INFO Epoch 020 | train_mse=0.100942 | val_loss=0.087577 | best_val_loss=0.019079
2025-12-25 08:43:15 INFO Epoch 021 | 25% complete (batch 46/181)
2025-12-25 08:43:16 INFO Epoch 021 | 50% complete (batch 91/181)
2025-12-25 08:43:17 INFO Epoch 021 | 75% complete (batch 136/181)
2025-12-25 08:43:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.497666
2025-12-25 08:43:30 INFO Tuning ranking metrics: regret=0.098665 spearman=-0.068602 (groups=34, skipped=318)
2025-12-25 08:43:30 INFO Epoch 021 | train_mse=0.072229 | val_loss=0.090149 | best_val_loss=0.019079
2025-12-25 08:43:39 INFO Epoch 022 | 25% complete (batch 46/181)
2025-12-25 08:43:40 INFO Epoch 022 | 50% complete (batch 91/181)
2025-12-25 08:43:41 INFO Epoch 022 | 75% complete (batch 136/181)
2025-12-25 08:43:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.502490
2025-12-25 08:43:54 INFO Tuning ranking metrics: regret=0.095157 spearman=-0.082620 (groups=34, skipped=318)
2025-12-25 08:43:54 INFO Epoch 022 | train_mse=0.083870 | val_loss=0.088460 | best_val_loss=0.019079
2025-12-25 08:44:03 INFO Epoch 023 | 25% complete (batch 46/181)
2025-12-25 08:44:04 INFO Epoch 023 | 50% complete (batch 91/181)
2025-12-25 08:44:05 INFO Epoch 023 | 75% complete (batch 136/181)
2025-12-25 08:44:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.497575
2025-12-25 08:44:18 INFO Tuning ranking metrics: regret=0.095048 spearman=-0.091240 (groups=34, skipped=318)
2025-12-25 08:44:18 INFO Epoch 023 | train_mse=0.071503 | val_loss=0.090106 | best_val_loss=0.019079
2025-12-25 08:44:27 INFO Epoch 024 | 25% complete (batch 46/181)
2025-12-25 08:44:28 INFO Epoch 024 | 50% complete (batch 91/181)
2025-12-25 08:44:29 INFO Epoch 024 | 75% complete (batch 136/181)
2025-12-25 08:44:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.490745
2025-12-25 08:44:43 INFO Tuning ranking metrics: regret=0.094123 spearman=-0.098975 (groups=34, skipped=318)
2025-12-25 08:44:43 INFO Epoch 024 | train_mse=0.071817 | val_loss=0.087915 | best_val_loss=0.019079
2025-12-25 08:44:51 INFO Epoch 025 | 25% complete (batch 46/181)
2025-12-25 08:44:52 INFO Epoch 025 | 50% complete (batch 91/181)
2025-12-25 08:44:53 INFO Epoch 025 | 75% complete (batch 136/181)
2025-12-25 08:45:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.489575
2025-12-25 08:45:06 INFO Tuning ranking metrics: regret=0.089099 spearman=-0.027445 (groups=34, skipped=318)
2025-12-25 08:45:06 INFO Epoch 025 | train_mse=0.088932 | val_loss=0.091198 | best_val_loss=0.019079
2025-12-25 08:45:15 INFO Epoch 026 | 25% complete (batch 46/181)
2025-12-25 08:45:16 INFO Epoch 026 | 50% complete (batch 91/181)
2025-12-25 08:45:17 INFO Epoch 026 | 75% complete (batch 136/181)
2025-12-25 08:45:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.493222
2025-12-25 08:45:31 INFO Tuning ranking metrics: regret=0.079207 spearman=-0.153081 (groups=34, skipped=318)
2025-12-25 08:45:31 INFO Epoch 026 | train_mse=0.086202 | val_loss=0.093453 | best_val_loss=0.019079
Monitored metric tuning_rank_spearman did not improve in the last 24 records. Best score: 0.024. Signaling Trainer to stop.
2025-12-25 08:45:32 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman--0.00838_val-0.09246_epoch019.chkpt, checkpoint.tuning_rank_spearman--0.02140_val-0.11072_epoch009.chkpt, checkpoint.tuning_rank_spearman-0.01908_val-0.13265_epoch004.chkpt
2025-12-25 08:45:32 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.01908_val-0.13265_epoch004.chkpt
2025-12-25 08:45:32 INFO Best validation loss: tensor(0.0191)
2025-12-25 08:45:32 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.01908_val-0.13265_epoch004.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.01908_val-0.13265_epoch004.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-25 08:45:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.132651
2025-12-25 08:45:44 INFO Tuning ranking metrics: regret=0.118163 spearman=0.019079 (groups=34, skipped=318)
2025-12-25 08:45:44 INFO Epoch 027 | val_loss=0.132651 | best_val_loss=0.019079
2025-12-25 08:45:45 INFO Validation metrics: [{'val_loss': 0.13265123963356018, 'tuning_rank_regret': 0.11816287785768509, 'tuning_rank_spearman': 0.019079450517892838, 'val_pearson_corr': 0.5072527527809143, 'val_spearman_corr': 0.5102993845939636, 'val_rank_regret': 0.03156936913728714, 'val_rank_spearman': 0.6666666865348816}]
2025-12-25 08:45:45 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.01908_val-0.13265_epoch004.chkpt
2025-12-25 08:45:45 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman--0.02140_val-0.11072_epoch009.chkpt
2025-12-25 08:45:45 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman--0.00838_val-0.09246_epoch019.chkpt
2025-12-25 08:45:45 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.10354_epoch003.ckpt
2025-12-25 08:45:45 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.11816287785768509
  tuning_rank_spearman     0.019079450517892838
        val_loss            0.13265123963356018
    val_pearson_corr        0.5072527527809143
     val_rank_regret        0.03156936913728714
    val_rank_spearman       0.6666666865348816
    val_spearman_corr       0.5102993845939636
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase1 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase1
[run_full_pipeline] Phase 1 best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.01908_val-0.13265_epoch004.chkpt (tuning_rank_spearman=0.019079450517892838)
[run_full_pipeline] Phase 2 fine-tuning (seed 101) -> sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed101
[train_cli] run_id=sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed101 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed101/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed101 --git-commit 9b1bb2b320 --git-dirty --resume-from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.01908_val-0.13265_epoch004.chkpt
2025-12-25 08:45:51 INFO git_commit = 9b1bb2b320 (dirty)
2025-12-25 08:45:51 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-25 08:45:51 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed101/config/config.yaml
2025-12-25 08:45:51 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data
2025-12-25 08:45:51 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-25 08:45:51 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-25 08:45:51 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed101
2025-12-25 08:45:51 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-25 08:45:51 INFO   metadata_path = None
2025-12-25 08:45:51 INFO   summary_path = None
2025-12-25 08:45:51 INFO   accelerator = cpu
2025-12-25 08:45:51 INFO   devices = 1
2025-12-25 08:45:51 INFO   attention_head = 8
2025-12-25 08:45:51 INFO   pooling_type = mean
2025-12-25 08:45:51 INFO   model_self_loops = False
2025-12-25 08:45:51 INFO   model_self_loop_fill = mean
2025-12-25 08:45:51 INFO   model_residual = False
2025-12-25 08:45:51 INFO   batch_size = 48
2025-12-25 08:45:51 INFO   learning_rate = 0.001
2025-12-25 08:45:51 INFO   num_epochs = 320
2025-12-25 08:45:51 INFO   accumulate_grad_batches = 8
2025-12-25 08:45:51 INFO   seed = 101
2025-12-25 08:45:51 INFO   num_workers = 2
2025-12-25 08:45:51 INFO   precision = 32
2025-12-25 08:45:51 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-25 08:45:51 INFO   early_stopping_patience = 20
2025-12-25 08:45:51 INFO   lr_scheduler_patience = 4
2025-12-25 08:45:51 INFO   lr_scheduler_factor = 0.2
2025-12-25 08:45:51 INFO   fast_dev_run = False
2025-12-25 08:45:51 INFO   limit_train_batches = None
2025-12-25 08:45:51 INFO   limit_val_batches = None
2025-12-25 08:45:51 INFO   log_lr = False
2025-12-25 08:45:51 INFO   progress_bar_refresh_rate = 0
2025-12-25 08:45:51 INFO   log_every_n_steps = 100
2025-12-25 08:45:51 INFO   use_val_spearman_as_secondary = True
2025-12-25 08:45:51 INFO   spearman_secondary_min_delta = 0.0
2025-12-25 08:45:51 INFO   spearman_secondary_weight = 1.0
2025-12-25 08:45:51 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-25 08:45:51 INFO   tuning_max_samples = 500
2025-12-25 08:45:51 INFO   tuning_fraction = None
2025-12-25 08:45:51 INFO   tuning_eval_every = 1
2025-12-25 08:45:51 INFO   rank_loss_weight = 0.0
2025-12-25 08:45:51 INFO   rank_loss_margin = 0.0
2025-12-25 08:45:51 INFO   rank_loss_mode = hinge
2025-12-25 08:45:51 INFO   rank_loss_grouped = True
2025-12-25 08:45:51 INFO   variance_reduction_enabled = False
2025-12-25 08:45:51 INFO   variance_reduction_method = topk_avg
2025-12-25 08:45:51 INFO   variance_reduction_top_k = 3
2025-12-25 08:45:51 INFO   coverage_minimum = 0.0
2025-12-25 08:45:51 INFO   coverage_fail_on_missing = False
2025-12-25 08:45:51 INFO   graph_load_profiling = False
2025-12-25 08:45:51 INFO   graph_load_top_k = 5
2025-12-25 08:45:51 INFO   enable_graph_cache = True
2025-12-25 08:45:51 INFO   graph_cache_size = 256
2025-12-25 08:45:51 INFO   canonicalize_on_load = False
2025-12-25 08:45:51 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-25 08:45:51 INFO   edge_schema = {}
2025-12-25 08:45:51 INFO   topology_schema = {}
Seed set to 101
2025-12-25 08:45:51 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-25 08:45:51 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 08:45:51 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-25 08:45:51 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 08:45:51 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-25 08:45:51 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 08:45:52 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-25 08:45:52 INFO Tuning group stats: groups=348 groups>=2=37 singletons=311 max_group=11
2025-12-25 08:45:52 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed101/dataset_coverage.json
2025-12-25 08:45:52 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed101/dataset_coverage.json for details.
2025-12-25 08:45:52 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed101/dataset_coverage.json for details.
2025-12-25 08:45:52 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed101/dataset_coverage.json for details.
2025-12-25 08:45:52 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed101/schema_summary.json
2025-12-25 08:45:52 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed101/feature_metadata.json
2025-12-25 08:45:52 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-25 08:45:52 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/null_topology/feature-config.yaml.null.10A, sha256=f618659ace5620de7e794485915dadd4243f3ec2ca6726b4a9af3989817a8579
2025-12-25 08:45:52 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/work/edge_features)
2025-12-25 08:45:52 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json
2025-12-25 08:45:52 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed101/schema_summary.json
2025-12-25 08:45:52 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-25 08:45:52 INFO Topology: topology/persistence_null/v1 supporting the 172-dimensional node features.
2025-12-25 08:45:52 INFO Node: node/dssp_topo_merge/v1; metadata lists 172 feature columns matching the .pt tensor.
2025-12-25 08:45:52 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-25 08:45:52 INFO → Total feature dimensionality observed and confirmed: node_dim = 172, edge_dim = 11.
2025-12-25 08:45:52 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-25 08:45:52 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 172,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 172,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed101/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge/v1",
      "alias": "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA",
      "jobs": 16,
      "summary": "DSSP-derived node features merged with topology statistics."
    },
    "topology": {
      "id": "topology/persistence_null/v1",
      "alias": "Null topology (constant zeros) = 140D ablation",
      "jobs": 16,
      "summary": "Topology ablation: constant features with PH-compatible schema."
    }
  },
  "notes": []
}
2025-12-25 08:45:52 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-25 08:45:52 INFO Resuming from checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.01908_val-0.13265_epoch004.chkpt (epoch=4)
2025-12-25 08:45:53 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=48fdbe771cf5423d8ac71b5e0a34243a)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-25 08:45:53 INFO Starting training (fast_dev_run=False)
2025-12-25 08:45:53 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed101/model_checkpoints exists and is not empty.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.01908_val-0.13265_epoch004.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase1/model_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed101/model_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase1/model_checkpoints/val_loss_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed101/model_checkpoints/val_loss_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 5.5 K  | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
165 K     Trainable params
0         Non-trainable params
165 K     Total params
0.662     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
Restored all states from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.01908_val-0.13265_epoch004.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-25 08:46:07 INFO Epoch 005 | 25% complete (batch 46/181)
2025-12-25 08:46:08 INFO Epoch 005 | 50% complete (batch 91/181)
2025-12-25 08:46:09 INFO Epoch 005 | 75% complete (batch 136/181)
2025-12-25 08:46:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.127077
2025-12-25 08:46:22 INFO Tuning ranking metrics: regret=0.109742 spearman=0.085849 (groups=37, skipped=311)
2025-12-25 08:46:22 INFO Epoch 005 | val_loss=0.127077
Metric tuning_rank_spearman improved by 0.062 >= min_delta = 0.0. New best score: 0.086
2025-12-25 08:46:31 INFO Epoch 006 | 25% complete (batch 46/181)
2025-12-25 08:46:32 INFO Epoch 006 | 50% complete (batch 91/181)
2025-12-25 08:46:32 INFO Epoch 006 | 75% complete (batch 136/181)
2025-12-25 08:46:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.401640
2025-12-25 08:46:46 INFO Tuning ranking metrics: regret=0.079055 spearman=0.096759 (groups=37, skipped=311)
2025-12-25 08:46:46 INFO Epoch 006 | train_mse=0.115767 | val_loss=0.111292 | best_val_loss=0.085849
Metric tuning_rank_spearman improved by 0.011 >= min_delta = 0.0. New best score: 0.097
2025-12-25 08:46:54 INFO Epoch 007 | 25% complete (batch 46/181)
2025-12-25 08:46:55 INFO Epoch 007 | 50% complete (batch 91/181)
2025-12-25 08:46:56 INFO Epoch 007 | 75% complete (batch 136/181)
2025-12-25 08:47:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.439403
2025-12-25 08:47:10 INFO Tuning ranking metrics: regret=0.106818 spearman=0.078993 (groups=37, skipped=311)
2025-12-25 08:47:10 INFO Epoch 007 | train_mse=0.120105 | val_loss=0.096198 | best_val_loss=0.096759
2025-12-25 08:47:18 INFO Epoch 008 | 25% complete (batch 46/181)
2025-12-25 08:47:19 INFO Epoch 008 | 50% complete (batch 91/181)
2025-12-25 08:47:20 INFO Epoch 008 | 75% complete (batch 136/181)
2025-12-25 08:47:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.414041
2025-12-25 08:47:34 INFO Tuning ranking metrics: regret=0.090871 spearman=0.047139 (groups=37, skipped=311)
2025-12-25 08:47:34 INFO Epoch 008 | train_mse=0.113119 | val_loss=0.106503 | best_val_loss=0.096759
2025-12-25 08:47:42 INFO Epoch 009 | 25% complete (batch 46/181)
2025-12-25 08:47:43 INFO Epoch 009 | 50% complete (batch 91/181)
2025-12-25 08:47:44 INFO Epoch 009 | 75% complete (batch 136/181)
2025-12-25 08:47:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.429877
2025-12-25 08:47:57 INFO Tuning ranking metrics: regret=0.092070 spearman=-0.001176 (groups=37, skipped=311)
2025-12-25 08:47:57 INFO Epoch 009 | train_mse=0.088367 | val_loss=0.095680 | best_val_loss=0.096759
2025-12-25 08:48:05 INFO Epoch 010 | 25% complete (batch 46/181)
2025-12-25 08:48:06 INFO Epoch 010 | 50% complete (batch 91/181)
2025-12-25 08:48:07 INFO Epoch 010 | 75% complete (batch 136/181)
2025-12-25 08:48:15 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.442504
2025-12-25 08:48:21 INFO Tuning ranking metrics: regret=0.149265 spearman=-0.112396 (groups=37, skipped=311)
2025-12-25 08:48:21 INFO Epoch 010 | train_mse=0.109894 | val_loss=0.093332 | best_val_loss=0.096759
2025-12-25 08:48:30 INFO Epoch 011 | 25% complete (batch 46/181)
2025-12-25 08:48:30 INFO Epoch 011 | 50% complete (batch 91/181)
2025-12-25 08:48:31 INFO Epoch 011 | 75% complete (batch 136/181)
2025-12-25 08:48:40 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.456689
2025-12-25 08:48:45 INFO Tuning ranking metrics: regret=0.126649 spearman=0.040266 (groups=37, skipped=311)
2025-12-25 08:48:45 INFO Epoch 011 | train_mse=0.085044 | val_loss=0.107836 | best_val_loss=0.096759
2025-12-25 08:48:53 INFO Epoch 012 | 25% complete (batch 46/181)
2025-12-25 08:48:54 INFO Epoch 012 | 50% complete (batch 91/181)
2025-12-25 08:48:55 INFO Epoch 012 | 75% complete (batch 136/181)
2025-12-25 08:49:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.451111
2025-12-25 08:49:08 INFO Tuning ranking metrics: regret=0.128559 spearman=0.040248 (groups=37, skipped=311)
2025-12-25 08:49:08 INFO Epoch 012 | train_mse=0.086282 | val_loss=0.100923 | best_val_loss=0.096759
2025-12-25 08:49:17 INFO Epoch 013 | 25% complete (batch 46/181)
2025-12-25 08:49:18 INFO Epoch 013 | 50% complete (batch 91/181)
2025-12-25 08:49:19 INFO Epoch 013 | 75% complete (batch 136/181)
2025-12-25 08:49:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.441145
2025-12-25 08:49:32 INFO Tuning ranking metrics: regret=0.147266 spearman=0.118217 (groups=37, skipped=311)
2025-12-25 08:49:32 INFO Epoch 013 | train_mse=0.083448 | val_loss=0.101046 | best_val_loss=0.096759
Metric tuning_rank_spearman improved by 0.021 >= min_delta = 0.0. New best score: 0.118
2025-12-25 08:49:40 INFO Epoch 014 | 25% complete (batch 46/181)
2025-12-25 08:49:41 INFO Epoch 014 | 50% complete (batch 91/181)
2025-12-25 08:49:42 INFO Epoch 014 | 75% complete (batch 136/181)
2025-12-25 08:49:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.445742
2025-12-25 08:49:56 INFO Tuning ranking metrics: regret=0.135799 spearman=0.026354 (groups=37, skipped=311)
2025-12-25 08:49:56 INFO Epoch 014 | train_mse=0.092971 | val_loss=0.093598 | best_val_loss=0.118217
2025-12-25 08:50:04 INFO Epoch 015 | 25% complete (batch 46/181)
2025-12-25 08:50:05 INFO Epoch 015 | 50% complete (batch 91/181)
2025-12-25 08:50:06 INFO Epoch 015 | 75% complete (batch 136/181)
2025-12-25 08:50:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.453921
2025-12-25 08:50:19 INFO Tuning ranking metrics: regret=0.110339 spearman=0.017685 (groups=37, skipped=311)
2025-12-25 08:50:19 INFO Epoch 015 | train_mse=0.085863 | val_loss=0.107351 | best_val_loss=0.118217
2025-12-25 08:50:27 INFO Epoch 016 | 25% complete (batch 46/181)
2025-12-25 08:50:28 INFO Epoch 016 | 50% complete (batch 91/181)
2025-12-25 08:50:29 INFO Epoch 016 | 75% complete (batch 136/181)
2025-12-25 08:50:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.489682
2025-12-25 08:50:43 INFO Tuning ranking metrics: regret=0.107197 spearman=0.025184 (groups=37, skipped=311)
2025-12-25 08:50:43 INFO Epoch 016 | train_mse=0.090299 | val_loss=0.102107 | best_val_loss=0.118217
2025-12-25 08:50:51 INFO Epoch 017 | 25% complete (batch 46/181)
2025-12-25 08:50:52 INFO Epoch 017 | 50% complete (batch 91/181)
2025-12-25 08:50:53 INFO Epoch 017 | 75% complete (batch 136/181)
2025-12-25 08:51:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.515866
2025-12-25 08:51:07 INFO Tuning ranking metrics: regret=0.124166 spearman=0.000801 (groups=37, skipped=311)
2025-12-25 08:51:07 INFO Epoch 017 | train_mse=0.098093 | val_loss=0.089387 | best_val_loss=0.118217
2025-12-25 08:51:15 INFO Epoch 018 | 25% complete (batch 46/181)
2025-12-25 08:51:16 INFO Epoch 018 | 50% complete (batch 91/181)
2025-12-25 08:51:17 INFO Epoch 018 | 75% complete (batch 136/181)
2025-12-25 08:51:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.493610
2025-12-25 08:51:30 INFO Tuning ranking metrics: regret=0.119749 spearman=-0.021756 (groups=37, skipped=311)
2025-12-25 08:51:30 INFO Epoch 018 | train_mse=0.092078 | val_loss=0.099923 | best_val_loss=0.118217
2025-12-25 08:51:38 INFO Epoch 019 | 25% complete (batch 46/181)
2025-12-25 08:51:39 INFO Epoch 019 | 50% complete (batch 91/181)
2025-12-25 08:51:40 INFO Epoch 019 | 75% complete (batch 136/181)
2025-12-25 08:51:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.490430
2025-12-25 08:51:54 INFO Tuning ranking metrics: regret=0.096036 spearman=0.058289 (groups=37, skipped=311)
2025-12-25 08:51:54 INFO Epoch 019 | train_mse=0.095941 | val_loss=0.094736 | best_val_loss=0.118217
2025-12-25 08:52:02 INFO Epoch 020 | 25% complete (batch 46/181)
2025-12-25 08:52:03 INFO Epoch 020 | 50% complete (batch 91/181)
2025-12-25 08:52:04 INFO Epoch 020 | 75% complete (batch 136/181)
2025-12-25 08:52:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.467118
2025-12-25 08:52:18 INFO Tuning ranking metrics: regret=0.100881 spearman=0.158640 (groups=37, skipped=311)
2025-12-25 08:52:18 INFO Epoch 020 | train_mse=0.097374 | val_loss=0.133524 | best_val_loss=0.118217
Metric tuning_rank_spearman improved by 0.040 >= min_delta = 0.0. New best score: 0.159
2025-12-25 08:52:26 INFO Epoch 021 | 25% complete (batch 46/181)
2025-12-25 08:52:27 INFO Epoch 021 | 50% complete (batch 91/181)
2025-12-25 08:52:28 INFO Epoch 021 | 75% complete (batch 136/181)
2025-12-25 08:52:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.477420
2025-12-25 08:52:42 INFO Tuning ranking metrics: regret=0.108652 spearman=0.095724 (groups=37, skipped=311)
2025-12-25 08:52:42 INFO Epoch 021 | train_mse=0.123318 | val_loss=0.090509 | best_val_loss=0.158640
2025-12-25 08:52:51 INFO Epoch 022 | 25% complete (batch 46/181)
2025-12-25 08:52:51 INFO Epoch 022 | 50% complete (batch 91/181)
2025-12-25 08:52:52 INFO Epoch 022 | 75% complete (batch 136/181)
2025-12-25 08:53:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.513601
2025-12-25 08:53:06 INFO Tuning ranking metrics: regret=0.143426 spearman=0.081233 (groups=37, skipped=311)
2025-12-25 08:53:06 INFO Epoch 022 | train_mse=0.112930 | val_loss=0.092356 | best_val_loss=0.158640
2025-12-25 08:53:15 INFO Epoch 023 | 25% complete (batch 46/181)
2025-12-25 08:53:16 INFO Epoch 023 | 50% complete (batch 91/181)
2025-12-25 08:53:17 INFO Epoch 023 | 75% complete (batch 136/181)
2025-12-25 08:53:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.485016
2025-12-25 08:53:30 INFO Tuning ranking metrics: regret=0.124063 spearman=0.118626 (groups=37, skipped=311)
2025-12-25 08:53:30 INFO Epoch 023 | train_mse=0.068962 | val_loss=0.130180 | best_val_loss=0.158640
2025-12-25 08:53:39 INFO Epoch 024 | 25% complete (batch 46/181)
2025-12-25 08:53:40 INFO Epoch 024 | 50% complete (batch 91/181)
2025-12-25 08:53:41 INFO Epoch 024 | 75% complete (batch 136/181)
2025-12-25 08:53:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.507712
2025-12-25 08:53:55 INFO Tuning ranking metrics: regret=0.107241 spearman=0.083480 (groups=37, skipped=311)
2025-12-25 08:53:55 INFO Epoch 024 | train_mse=0.090754 | val_loss=0.085117 | best_val_loss=0.158640
2025-12-25 08:54:03 INFO Epoch 025 | 25% complete (batch 46/181)
2025-12-25 08:54:04 INFO Epoch 025 | 50% complete (batch 91/181)
2025-12-25 08:54:05 INFO Epoch 025 | 75% complete (batch 136/181)
2025-12-25 08:54:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.536062
2025-12-25 08:54:19 INFO Tuning ranking metrics: regret=0.105707 spearman=0.070598 (groups=37, skipped=311)
2025-12-25 08:54:19 INFO Epoch 025 | train_mse=0.084634 | val_loss=0.084131 | best_val_loss=0.158640
2025-12-25 08:54:28 INFO Epoch 026 | 25% complete (batch 46/181)
2025-12-25 08:54:29 INFO Epoch 026 | 50% complete (batch 91/181)
2025-12-25 08:54:29 INFO Epoch 026 | 75% complete (batch 136/181)
2025-12-25 08:54:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.506821
2025-12-25 08:54:43 INFO Tuning ranking metrics: regret=0.109510 spearman=0.045495 (groups=37, skipped=311)
2025-12-25 08:54:43 INFO Epoch 026 | train_mse=0.064251 | val_loss=0.107017 | best_val_loss=0.158640
2025-12-25 08:54:51 INFO Epoch 027 | 25% complete (batch 46/181)
2025-12-25 08:54:52 INFO Epoch 027 | 50% complete (batch 91/181)
2025-12-25 08:54:53 INFO Epoch 027 | 75% complete (batch 136/181)
2025-12-25 08:55:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.531286
2025-12-25 08:55:07 INFO Tuning ranking metrics: regret=0.089862 spearman=0.145583 (groups=37, skipped=311)
2025-12-25 08:55:07 INFO Epoch 027 | train_mse=0.102494 | val_loss=0.082217 | best_val_loss=0.158640
2025-12-25 08:55:15 INFO Epoch 028 | 25% complete (batch 46/181)
2025-12-25 08:55:16 INFO Epoch 028 | 50% complete (batch 91/181)
2025-12-25 08:55:17 INFO Epoch 028 | 75% complete (batch 136/181)
2025-12-25 08:55:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.529349
2025-12-25 08:55:30 INFO Tuning ranking metrics: regret=0.141018 spearman=0.012975 (groups=37, skipped=311)
2025-12-25 08:55:30 INFO Epoch 028 | train_mse=0.078300 | val_loss=0.095002 | best_val_loss=0.158640
2025-12-25 08:55:39 INFO Epoch 029 | 25% complete (batch 46/181)
2025-12-25 08:55:40 INFO Epoch 029 | 50% complete (batch 91/181)
2025-12-25 08:55:40 INFO Epoch 029 | 75% complete (batch 136/181)
2025-12-25 08:55:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.528562
2025-12-25 08:55:54 INFO Tuning ranking metrics: regret=0.124094 spearman=0.062150 (groups=37, skipped=311)
2025-12-25 08:55:54 INFO Epoch 029 | train_mse=0.088890 | val_loss=0.100669 | best_val_loss=0.158640
2025-12-25 08:56:03 INFO Epoch 030 | 25% complete (batch 46/181)
2025-12-25 08:56:04 INFO Epoch 030 | 50% complete (batch 91/181)
2025-12-25 08:56:04 INFO Epoch 030 | 75% complete (batch 136/181)
2025-12-25 08:56:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.534985
2025-12-25 08:56:18 INFO Tuning ranking metrics: regret=0.141783 spearman=0.116228 (groups=37, skipped=311)
2025-12-25 08:56:18 INFO Epoch 030 | train_mse=0.104598 | val_loss=0.089937 | best_val_loss=0.158640
2025-12-25 08:56:27 INFO Epoch 031 | 25% complete (batch 46/181)
2025-12-25 08:56:28 INFO Epoch 031 | 50% complete (batch 91/181)
2025-12-25 08:56:29 INFO Epoch 031 | 75% complete (batch 136/181)
2025-12-25 08:56:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.524940
2025-12-25 08:56:42 INFO Tuning ranking metrics: regret=0.141762 spearman=0.058494 (groups=37, skipped=311)
2025-12-25 08:56:42 INFO Epoch 031 | train_mse=0.085236 | val_loss=0.103956 | best_val_loss=0.158640
2025-12-25 08:56:51 INFO Epoch 032 | 25% complete (batch 46/181)
2025-12-25 08:56:52 INFO Epoch 032 | 50% complete (batch 91/181)
2025-12-25 08:56:53 INFO Epoch 032 | 75% complete (batch 136/181)
2025-12-25 08:57:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.549263
2025-12-25 08:57:06 INFO Tuning ranking metrics: regret=0.103467 spearman=0.166953 (groups=37, skipped=311)
2025-12-25 08:57:06 INFO Epoch 032 | train_mse=0.097366 | val_loss=0.081996 | best_val_loss=0.158640
Metric tuning_rank_spearman improved by 0.008 >= min_delta = 0.0. New best score: 0.167
2025-12-25 08:57:15 INFO Epoch 033 | 25% complete (batch 46/181)
2025-12-25 08:57:16 INFO Epoch 033 | 50% complete (batch 91/181)
2025-12-25 08:57:16 INFO Epoch 033 | 75% complete (batch 136/181)
2025-12-25 08:57:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.545731
2025-12-25 08:57:30 INFO Tuning ranking metrics: regret=0.104831 spearman=0.119200 (groups=37, skipped=311)
2025-12-25 08:57:30 INFO Epoch 033 | train_mse=0.087270 | val_loss=0.093728 | best_val_loss=0.166953
2025-12-25 08:57:39 INFO Epoch 034 | 25% complete (batch 46/181)
2025-12-25 08:57:40 INFO Epoch 034 | 50% complete (batch 91/181)
2025-12-25 08:57:40 INFO Epoch 034 | 75% complete (batch 136/181)
2025-12-25 08:57:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.547999
2025-12-25 08:57:54 INFO Tuning ranking metrics: regret=0.127075 spearman=0.084544 (groups=37, skipped=311)
2025-12-25 08:57:54 INFO Epoch 034 | train_mse=0.093529 | val_loss=0.082171 | best_val_loss=0.166953
2025-12-25 08:58:03 INFO Epoch 035 | 25% complete (batch 46/181)
2025-12-25 08:58:04 INFO Epoch 035 | 50% complete (batch 91/181)
2025-12-25 08:58:05 INFO Epoch 035 | 75% complete (batch 136/181)
2025-12-25 08:58:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.549066
2025-12-25 08:58:18 INFO Tuning ranking metrics: regret=0.143044 spearman=0.019908 (groups=37, skipped=311)
2025-12-25 08:58:18 INFO Epoch 035 | train_mse=0.091754 | val_loss=0.086436 | best_val_loss=0.166953
2025-12-25 08:58:27 INFO Epoch 036 | 25% complete (batch 46/181)
2025-12-25 08:58:28 INFO Epoch 036 | 50% complete (batch 91/181)
2025-12-25 08:58:29 INFO Epoch 036 | 75% complete (batch 136/181)
2025-12-25 08:58:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.542955
2025-12-25 08:58:42 INFO Tuning ranking metrics: regret=0.149516 spearman=-0.091868 (groups=37, skipped=311)
2025-12-25 08:58:42 INFO Epoch 036 | train_mse=0.090346 | val_loss=0.082134 | best_val_loss=0.166953
2025-12-25 08:58:51 INFO Epoch 037 | 25% complete (batch 46/181)
2025-12-25 08:58:52 INFO Epoch 037 | 50% complete (batch 91/181)
2025-12-25 08:58:53 INFO Epoch 037 | 75% complete (batch 136/181)
2025-12-25 08:59:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.536210
2025-12-25 08:59:06 INFO Tuning ranking metrics: regret=0.140920 spearman=0.121136 (groups=37, skipped=311)
2025-12-25 08:59:06 INFO Epoch 037 | train_mse=0.085279 | val_loss=0.105881 | best_val_loss=0.166953
2025-12-25 08:59:15 INFO Epoch 038 | 25% complete (batch 46/181)
2025-12-25 08:59:16 INFO Epoch 038 | 50% complete (batch 91/181)
2025-12-25 08:59:17 INFO Epoch 038 | 75% complete (batch 136/181)
2025-12-25 08:59:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.502822
2025-12-25 08:59:30 INFO Tuning ranking metrics: regret=0.134476 spearman=0.118030 (groups=37, skipped=311)
2025-12-25 08:59:30 INFO Epoch 038 | train_mse=0.081577 | val_loss=0.122753 | best_val_loss=0.166953
2025-12-25 08:59:39 INFO Epoch 039 | 25% complete (batch 46/181)
2025-12-25 08:59:40 INFO Epoch 039 | 50% complete (batch 91/181)
2025-12-25 08:59:41 INFO Epoch 039 | 75% complete (batch 136/181)
2025-12-25 08:59:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.508021
2025-12-25 08:59:54 INFO Tuning ranking metrics: regret=0.150177 spearman=0.025828 (groups=37, skipped=311)
2025-12-25 08:59:54 INFO Epoch 039 | train_mse=0.095476 | val_loss=0.114720 | best_val_loss=0.166953
2025-12-25 09:00:03 INFO Epoch 040 | 25% complete (batch 46/181)
2025-12-25 09:00:04 INFO Epoch 040 | 50% complete (batch 91/181)
2025-12-25 09:00:04 INFO Epoch 040 | 75% complete (batch 136/181)
2025-12-25 09:00:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.558160
2025-12-25 09:00:18 INFO Tuning ranking metrics: regret=0.151420 spearman=-0.108342 (groups=37, skipped=311)
2025-12-25 09:00:18 INFO Epoch 040 | train_mse=0.078232 | val_loss=0.080075 | best_val_loss=0.166953
2025-12-25 09:00:27 INFO Epoch 041 | 25% complete (batch 46/181)
2025-12-25 09:00:28 INFO Epoch 041 | 50% complete (batch 91/181)
2025-12-25 09:00:29 INFO Epoch 041 | 75% complete (batch 136/181)
2025-12-25 09:00:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.570520
2025-12-25 09:00:42 INFO Tuning ranking metrics: regret=0.151408 spearman=-0.046291 (groups=37, skipped=311)
2025-12-25 09:00:42 INFO Epoch 041 | train_mse=0.085460 | val_loss=0.080357 | best_val_loss=0.166953
2025-12-25 09:00:51 INFO Epoch 042 | 25% complete (batch 46/181)
2025-12-25 09:00:52 INFO Epoch 042 | 50% complete (batch 91/181)
2025-12-25 09:00:53 INFO Epoch 042 | 75% complete (batch 136/181)
2025-12-25 09:01:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.567810
2025-12-25 09:01:06 INFO Tuning ranking metrics: regret=0.148138 spearman=0.074055 (groups=37, skipped=311)
2025-12-25 09:01:06 INFO Epoch 042 | train_mse=0.081035 | val_loss=0.079161 | best_val_loss=0.166953
2025-12-25 09:01:15 INFO Epoch 043 | 25% complete (batch 46/181)
2025-12-25 09:01:16 INFO Epoch 043 | 50% complete (batch 91/181)
2025-12-25 09:01:17 INFO Epoch 043 | 75% complete (batch 136/181)
2025-12-25 09:01:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.574527
2025-12-25 09:01:30 INFO Tuning ranking metrics: regret=0.142634 spearman=0.092038 (groups=37, skipped=311)
2025-12-25 09:01:30 INFO Epoch 043 | train_mse=0.082755 | val_loss=0.080659 | best_val_loss=0.166953
2025-12-25 09:01:39 INFO Epoch 044 | 25% complete (batch 46/181)
2025-12-25 09:01:40 INFO Epoch 044 | 50% complete (batch 91/181)
2025-12-25 09:01:41 INFO Epoch 044 | 75% complete (batch 136/181)
2025-12-25 09:01:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.583163
2025-12-25 09:01:55 INFO Tuning ranking metrics: regret=0.141665 spearman=0.118281 (groups=37, skipped=311)
2025-12-25 09:01:55 INFO Epoch 044 | train_mse=0.076055 | val_loss=0.087969 | best_val_loss=0.166953
2025-12-25 09:02:03 INFO Epoch 045 | 25% complete (batch 46/181)
2025-12-25 09:02:04 INFO Epoch 045 | 50% complete (batch 91/181)
2025-12-25 09:02:05 INFO Epoch 045 | 75% complete (batch 136/181)
2025-12-25 09:02:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.562497
2025-12-25 09:02:18 INFO Tuning ranking metrics: regret=0.142800 spearman=0.118404 (groups=37, skipped=311)
2025-12-25 09:02:18 INFO Epoch 045 | train_mse=0.073131 | val_loss=0.081741 | best_val_loss=0.166953
2025-12-25 09:02:27 INFO Epoch 046 | 25% complete (batch 46/181)
2025-12-25 09:02:28 INFO Epoch 046 | 50% complete (batch 91/181)
2025-12-25 09:02:28 INFO Epoch 046 | 75% complete (batch 136/181)
2025-12-25 09:02:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.591070
2025-12-25 09:02:42 INFO Tuning ranking metrics: regret=0.140674 spearman=0.125611 (groups=37, skipped=311)
2025-12-25 09:02:42 INFO Epoch 046 | train_mse=0.083693 | val_loss=0.078050 | best_val_loss=0.166953
2025-12-25 09:02:51 INFO Epoch 047 | 25% complete (batch 46/181)
2025-12-25 09:02:52 INFO Epoch 047 | 50% complete (batch 91/181)
2025-12-25 09:02:53 INFO Epoch 047 | 75% complete (batch 136/181)
2025-12-25 09:03:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.581688
2025-12-25 09:03:07 INFO Tuning ranking metrics: regret=0.140869 spearman=0.128835 (groups=37, skipped=311)
2025-12-25 09:03:07 INFO Epoch 047 | train_mse=0.069936 | val_loss=0.077875 | best_val_loss=0.166953
2025-12-25 09:03:15 INFO Epoch 048 | 25% complete (batch 46/181)
2025-12-25 09:03:16 INFO Epoch 048 | 50% complete (batch 91/181)
2025-12-25 09:03:17 INFO Epoch 048 | 75% complete (batch 136/181)
2025-12-25 09:03:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.575700
2025-12-25 09:03:31 INFO Tuning ranking metrics: regret=0.140674 spearman=0.117275 (groups=37, skipped=311)
2025-12-25 09:03:31 INFO Epoch 048 | train_mse=0.059845 | val_loss=0.081079 | best_val_loss=0.166953
2025-12-25 09:03:39 INFO Epoch 049 | 25% complete (batch 46/181)
2025-12-25 09:03:40 INFO Epoch 049 | 50% complete (batch 91/181)
2025-12-25 09:03:41 INFO Epoch 049 | 75% complete (batch 136/181)
2025-12-25 09:03:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.576395
2025-12-25 09:03:55 INFO Tuning ranking metrics: regret=0.142800 spearman=0.117129 (groups=37, skipped=311)
2025-12-25 09:03:55 INFO Epoch 049 | train_mse=0.070956 | val_loss=0.076780 | best_val_loss=0.166953
2025-12-25 09:04:03 INFO Epoch 050 | 25% complete (batch 46/181)
2025-12-25 09:04:04 INFO Epoch 050 | 50% complete (batch 91/181)
2025-12-25 09:04:05 INFO Epoch 050 | 75% complete (batch 136/181)
2025-12-25 09:04:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.585171
2025-12-25 09:04:19 INFO Tuning ranking metrics: regret=0.142800 spearman=0.112039 (groups=37, skipped=311)
2025-12-25 09:04:19 INFO Epoch 050 | train_mse=0.092237 | val_loss=0.077611 | best_val_loss=0.166953
2025-12-25 09:04:27 INFO Epoch 051 | 25% complete (batch 46/181)
2025-12-25 09:04:28 INFO Epoch 051 | 50% complete (batch 91/181)
2025-12-25 09:04:29 INFO Epoch 051 | 75% complete (batch 136/181)
2025-12-25 09:04:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.591700
2025-12-25 09:04:43 INFO Tuning ranking metrics: regret=0.142800 spearman=0.115731 (groups=37, skipped=311)
2025-12-25 09:04:43 INFO Epoch 051 | train_mse=0.068828 | val_loss=0.077957 | best_val_loss=0.166953
2025-12-25 09:04:51 INFO Epoch 052 | 25% complete (batch 46/181)
2025-12-25 09:04:52 INFO Epoch 052 | 50% complete (batch 91/181)
2025-12-25 09:04:53 INFO Epoch 052 | 75% complete (batch 136/181)
2025-12-25 09:05:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.582089
2025-12-25 09:05:06 INFO Tuning ranking metrics: regret=0.142800 spearman=0.123769 (groups=37, skipped=311)
2025-12-25 09:05:06 INFO Epoch 052 | train_mse=0.081064 | val_loss=0.078682 | best_val_loss=0.166953
2025-12-25 09:05:15 INFO Epoch 053 | 25% complete (batch 46/181)
2025-12-25 09:05:16 INFO Epoch 053 | 50% complete (batch 91/181)
2025-12-25 09:05:17 INFO Epoch 053 | 75% complete (batch 136/181)
2025-12-25 09:05:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.576356
2025-12-25 09:05:31 INFO Tuning ranking metrics: regret=0.143715 spearman=-0.018188 (groups=37, skipped=311)
2025-12-25 09:05:31 INFO Epoch 053 | train_mse=0.073105 | val_loss=0.077724 | best_val_loss=0.166953
2025-12-25 09:05:39 INFO Epoch 054 | 25% complete (batch 46/181)
2025-12-25 09:05:40 INFO Epoch 054 | 50% complete (batch 91/181)
2025-12-25 09:05:41 INFO Epoch 054 | 75% complete (batch 136/181)
2025-12-25 09:05:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.583821
2025-12-25 09:05:54 INFO Tuning ranking metrics: regret=0.143688 spearman=0.016128 (groups=37, skipped=311)
2025-12-25 09:05:54 INFO Epoch 054 | train_mse=0.072358 | val_loss=0.077855 | best_val_loss=0.166953
2025-12-25 09:06:03 INFO Epoch 055 | 25% complete (batch 46/181)
2025-12-25 09:06:04 INFO Epoch 055 | 50% complete (batch 91/181)
2025-12-25 09:06:05 INFO Epoch 055 | 75% complete (batch 136/181)
2025-12-25 09:06:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.576770
2025-12-25 09:06:18 INFO Tuning ranking metrics: regret=0.142634 spearman=0.093928 (groups=37, skipped=311)
2025-12-25 09:06:18 INFO Epoch 055 | train_mse=0.081643 | val_loss=0.082642 | best_val_loss=0.166953
2025-12-25 09:06:27 INFO Epoch 056 | 25% complete (batch 46/181)
2025-12-25 09:06:28 INFO Epoch 056 | 50% complete (batch 91/181)
2025-12-25 09:06:29 INFO Epoch 056 | 75% complete (batch 136/181)
2025-12-25 09:06:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.588740
2025-12-25 09:06:43 INFO Tuning ranking metrics: regret=0.142661 spearman=0.051199 (groups=37, skipped=311)
2025-12-25 09:06:43 INFO Epoch 056 | train_mse=0.065557 | val_loss=0.078368 | best_val_loss=0.166953
Monitored metric tuning_rank_spearman did not improve in the last 24 records. Best score: 0.167. Signaling Trainer to stop.
2025-12-25 09:06:44 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.14558_val-0.08222_epoch027.chkpt, checkpoint.tuning_rank_spearman-0.15864_val-0.13352_epoch020.chkpt, checkpoint.tuning_rank_spearman-0.16695_val-0.08200_epoch032.chkpt
2025-12-25 09:06:44 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed101/model_checkpoints/checkpoint.tuning_rank_spearman-0.16695_val-0.08200_epoch032.chkpt
2025-12-25 09:06:44 INFO Best validation loss: tensor(0.1670)
2025-12-25 09:06:44 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed101/model_checkpoints/checkpoint.tuning_rank_spearman-0.16695_val-0.08200_epoch032.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed101/model_checkpoints/checkpoint.tuning_rank_spearman-0.16695_val-0.08200_epoch032.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-25 09:06:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.081996
2025-12-25 09:06:56 INFO Tuning ranking metrics: regret=0.103467 spearman=0.166953 (groups=37, skipped=311)
2025-12-25 09:06:56 INFO Epoch 057 | val_loss=0.081996 | best_val_loss=0.166953
2025-12-25 09:06:56 INFO Validation metrics: [{'val_loss': 0.08199626207351685, 'tuning_rank_regret': 0.10346663743257523, 'tuning_rank_spearman': 0.16695331037044525, 'val_pearson_corr': 0.6585812568664551, 'val_spearman_corr': 0.6394587755203247, 'val_rank_regret': 0.03156936913728714, 'val_rank_spearman': 0.7777777910232544}]
2025-12-25 09:06:56 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.16695_val-0.08200_epoch032.chkpt
2025-12-25 09:06:56 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.15864_val-0.13352_epoch020.chkpt
2025-12-25 09:06:56 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.14558_val-0.08222_epoch027.chkpt
2025-12-25 09:06:56 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.08222_epoch027.ckpt
2025-12-25 09:06:56 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.10346663743257523
  tuning_rank_spearman      0.16695331037044525
        val_loss            0.08199626207351685
    val_pearson_corr        0.6585812568664551
     val_rank_regret        0.03156936913728714
    val_rank_spearman       0.7777777910232544
    val_spearman_corr       0.6394587755203247
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed101 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed101
[run_full_pipeline] Phase 2 (seed 101) best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed101/model_checkpoints/checkpoint.tuning_rank_spearman-0.16695_val-0.08200_epoch032.chkpt (tuning_rank_spearman=0.16695331037044525)
[run_full_pipeline] Phase 2 fine-tuning (seed 555) -> sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed555
[train_cli] run_id=sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed555 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed555/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed555 --git-commit 9b1bb2b320 --git-dirty --resume-from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.01908_val-0.13265_epoch004.chkpt
2025-12-25 09:07:03 INFO git_commit = 9b1bb2b320 (dirty)
2025-12-25 09:07:03 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-25 09:07:03 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed555/config/config.yaml
2025-12-25 09:07:03 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data
2025-12-25 09:07:03 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-25 09:07:03 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-25 09:07:03 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed555
2025-12-25 09:07:03 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-25 09:07:03 INFO   metadata_path = None
2025-12-25 09:07:03 INFO   summary_path = None
2025-12-25 09:07:03 INFO   accelerator = cpu
2025-12-25 09:07:03 INFO   devices = 1
2025-12-25 09:07:03 INFO   attention_head = 8
2025-12-25 09:07:03 INFO   pooling_type = mean
2025-12-25 09:07:03 INFO   model_self_loops = False
2025-12-25 09:07:03 INFO   model_self_loop_fill = mean
2025-12-25 09:07:03 INFO   model_residual = False
2025-12-25 09:07:03 INFO   batch_size = 48
2025-12-25 09:07:03 INFO   learning_rate = 0.001
2025-12-25 09:07:03 INFO   num_epochs = 320
2025-12-25 09:07:03 INFO   accumulate_grad_batches = 8
2025-12-25 09:07:03 INFO   seed = 555
2025-12-25 09:07:03 INFO   num_workers = 2
2025-12-25 09:07:03 INFO   precision = 32
2025-12-25 09:07:03 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-25 09:07:03 INFO   early_stopping_patience = 20
2025-12-25 09:07:03 INFO   lr_scheduler_patience = 4
2025-12-25 09:07:03 INFO   lr_scheduler_factor = 0.2
2025-12-25 09:07:03 INFO   fast_dev_run = False
2025-12-25 09:07:03 INFO   limit_train_batches = None
2025-12-25 09:07:03 INFO   limit_val_batches = None
2025-12-25 09:07:03 INFO   log_lr = False
2025-12-25 09:07:03 INFO   progress_bar_refresh_rate = 0
2025-12-25 09:07:03 INFO   log_every_n_steps = 100
2025-12-25 09:07:03 INFO   use_val_spearman_as_secondary = True
2025-12-25 09:07:03 INFO   spearman_secondary_min_delta = 0.0
2025-12-25 09:07:03 INFO   spearman_secondary_weight = 1.0
2025-12-25 09:07:03 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-25 09:07:03 INFO   tuning_max_samples = 500
2025-12-25 09:07:03 INFO   tuning_fraction = None
2025-12-25 09:07:03 INFO   tuning_eval_every = 1
2025-12-25 09:07:03 INFO   rank_loss_weight = 0.0
2025-12-25 09:07:03 INFO   rank_loss_margin = 0.0
2025-12-25 09:07:03 INFO   rank_loss_mode = hinge
2025-12-25 09:07:03 INFO   rank_loss_grouped = True
2025-12-25 09:07:03 INFO   variance_reduction_enabled = False
2025-12-25 09:07:03 INFO   variance_reduction_method = topk_avg
2025-12-25 09:07:03 INFO   variance_reduction_top_k = 3
2025-12-25 09:07:03 INFO   coverage_minimum = 0.0
2025-12-25 09:07:03 INFO   coverage_fail_on_missing = False
2025-12-25 09:07:03 INFO   graph_load_profiling = False
2025-12-25 09:07:03 INFO   graph_load_top_k = 5
2025-12-25 09:07:03 INFO   enable_graph_cache = True
2025-12-25 09:07:03 INFO   graph_cache_size = 256
2025-12-25 09:07:03 INFO   canonicalize_on_load = False
2025-12-25 09:07:03 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-25 09:07:03 INFO   edge_schema = {}
2025-12-25 09:07:03 INFO   topology_schema = {}
Seed set to 555
2025-12-25 09:07:03 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-25 09:07:03 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 09:07:03 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-25 09:07:03 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 09:07:03 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-25 09:07:03 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 09:07:04 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-25 09:07:04 INFO Tuning group stats: groups=368 groups>=2=39 singletons=329 max_group=9
2025-12-25 09:07:04 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed555/dataset_coverage.json
2025-12-25 09:07:04 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed555/dataset_coverage.json for details.
2025-12-25 09:07:04 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed555/dataset_coverage.json for details.
2025-12-25 09:07:04 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed555/dataset_coverage.json for details.
2025-12-25 09:07:04 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed555/schema_summary.json
2025-12-25 09:07:04 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed555/feature_metadata.json
2025-12-25 09:07:04 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-25 09:07:04 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/null_topology/feature-config.yaml.null.10A, sha256=f618659ace5620de7e794485915dadd4243f3ec2ca6726b4a9af3989817a8579
2025-12-25 09:07:04 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/work/edge_features)
2025-12-25 09:07:04 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json
2025-12-25 09:07:04 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed555/schema_summary.json
2025-12-25 09:07:04 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-25 09:07:04 INFO Topology: topology/persistence_null/v1 supporting the 172-dimensional node features.
2025-12-25 09:07:04 INFO Node: node/dssp_topo_merge/v1; metadata lists 172 feature columns matching the .pt tensor.
2025-12-25 09:07:04 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-25 09:07:04 INFO → Total feature dimensionality observed and confirmed: node_dim = 172, edge_dim = 11.
2025-12-25 09:07:04 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-25 09:07:04 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 172,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 172,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed555/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge/v1",
      "alias": "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA",
      "jobs": 16,
      "summary": "DSSP-derived node features merged with topology statistics."
    },
    "topology": {
      "id": "topology/persistence_null/v1",
      "alias": "Null topology (constant zeros) = 140D ablation",
      "jobs": 16,
      "summary": "Topology ablation: constant features with PH-compatible schema."
    }
  },
  "notes": []
}
2025-12-25 09:07:04 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-25 09:07:04 INFO Resuming from checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.01908_val-0.13265_epoch004.chkpt (epoch=4)
2025-12-25 09:07:04 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=5692c024bc8c4051b5d63a5014b89ffb)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-25 09:07:04 INFO Starting training (fast_dev_run=False)
2025-12-25 09:07:04 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed555/model_checkpoints exists and is not empty.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.01908_val-0.13265_epoch004.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase1/model_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed555/model_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase1/model_checkpoints/val_loss_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed555/model_checkpoints/val_loss_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 5.5 K  | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
165 K     Trainable params
0         Non-trainable params
165 K     Total params
0.662     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
Restored all states from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.01908_val-0.13265_epoch004.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-25 09:07:19 INFO Epoch 005 | 25% complete (batch 46/181)
2025-12-25 09:07:19 INFO Epoch 005 | 50% complete (batch 91/181)
2025-12-25 09:07:20 INFO Epoch 005 | 75% complete (batch 136/181)
2025-12-25 09:07:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.114684
2025-12-25 09:07:34 INFO Tuning ranking metrics: regret=0.077645 spearman=0.327350 (groups=39, skipped=329)
2025-12-25 09:07:34 INFO Epoch 005 | val_loss=0.114684
Metric tuning_rank_spearman improved by 0.303 >= min_delta = 0.0. New best score: 0.327
2025-12-25 09:07:42 INFO Epoch 006 | 25% complete (batch 46/181)
2025-12-25 09:07:43 INFO Epoch 006 | 50% complete (batch 91/181)
2025-12-25 09:07:44 INFO Epoch 006 | 75% complete (batch 136/181)
2025-12-25 09:07:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.392177
2025-12-25 09:07:57 INFO Tuning ranking metrics: regret=0.097859 spearman=0.333700 (groups=39, skipped=329)
2025-12-25 09:07:57 INFO Epoch 006 | train_mse=0.118565 | val_loss=0.121442 | best_val_loss=0.327350
Metric tuning_rank_spearman improved by 0.006 >= min_delta = 0.0. New best score: 0.334
2025-12-25 09:08:05 INFO Epoch 007 | 25% complete (batch 46/181)
2025-12-25 09:08:06 INFO Epoch 007 | 50% complete (batch 91/181)
2025-12-25 09:08:07 INFO Epoch 007 | 75% complete (batch 136/181)
2025-12-25 09:08:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.421057
2025-12-25 09:08:21 INFO Tuning ranking metrics: regret=0.109130 spearman=0.306899 (groups=39, skipped=329)
2025-12-25 09:08:21 INFO Epoch 007 | train_mse=0.109457 | val_loss=0.106647 | best_val_loss=0.333700
2025-12-25 09:08:29 INFO Epoch 008 | 25% complete (batch 46/181)
2025-12-25 09:08:30 INFO Epoch 008 | 50% complete (batch 91/181)
2025-12-25 09:08:31 INFO Epoch 008 | 75% complete (batch 136/181)
2025-12-25 09:08:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.428612
2025-12-25 09:08:44 INFO Tuning ranking metrics: regret=0.104984 spearman=0.262271 (groups=39, skipped=329)
2025-12-25 09:08:44 INFO Epoch 008 | train_mse=0.116167 | val_loss=0.099276 | best_val_loss=0.333700
2025-12-25 09:08:53 INFO Epoch 009 | 25% complete (batch 46/181)
2025-12-25 09:08:54 INFO Epoch 009 | 50% complete (batch 91/181)
2025-12-25 09:08:55 INFO Epoch 009 | 75% complete (batch 136/181)
2025-12-25 09:09:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.421377
2025-12-25 09:09:08 INFO Tuning ranking metrics: regret=0.092350 spearman=0.253602 (groups=39, skipped=329)
2025-12-25 09:09:08 INFO Epoch 009 | train_mse=0.115916 | val_loss=0.107685 | best_val_loss=0.333700
2025-12-25 09:09:17 INFO Epoch 010 | 25% complete (batch 46/181)
2025-12-25 09:09:18 INFO Epoch 010 | 50% complete (batch 91/181)
2025-12-25 09:09:18 INFO Epoch 010 | 75% complete (batch 136/181)
2025-12-25 09:09:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.442658
2025-12-25 09:09:32 INFO Tuning ranking metrics: regret=0.091213 spearman=0.302381 (groups=39, skipped=329)
2025-12-25 09:09:32 INFO Epoch 010 | train_mse=0.106580 | val_loss=0.105167 | best_val_loss=0.333700
2025-12-25 09:09:41 INFO Epoch 011 | 25% complete (batch 46/181)
2025-12-25 09:09:42 INFO Epoch 011 | 50% complete (batch 91/181)
2025-12-25 09:09:43 INFO Epoch 011 | 75% complete (batch 136/181)
2025-12-25 09:09:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.411749
2025-12-25 09:09:56 INFO Tuning ranking metrics: regret=0.098697 spearman=0.194322 (groups=39, skipped=329)
2025-12-25 09:09:56 INFO Epoch 011 | train_mse=0.094433 | val_loss=0.128715 | best_val_loss=0.333700
2025-12-25 09:10:05 INFO Epoch 012 | 25% complete (batch 46/181)
2025-12-25 09:10:05 INFO Epoch 012 | 50% complete (batch 91/181)
2025-12-25 09:10:06 INFO Epoch 012 | 75% complete (batch 136/181)
2025-12-25 09:10:15 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.455150
2025-12-25 09:10:20 INFO Tuning ranking metrics: regret=0.095644 spearman=0.231319 (groups=39, skipped=329)
2025-12-25 09:10:20 INFO Epoch 012 | train_mse=0.086724 | val_loss=0.095576 | best_val_loss=0.333700
2025-12-25 09:10:28 INFO Epoch 013 | 25% complete (batch 46/181)
2025-12-25 09:10:29 INFO Epoch 013 | 50% complete (batch 91/181)
2025-12-25 09:10:30 INFO Epoch 013 | 75% complete (batch 136/181)
2025-12-25 09:10:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.475620
2025-12-25 09:10:44 INFO Tuning ranking metrics: regret=0.100410 spearman=0.177106 (groups=39, skipped=329)
2025-12-25 09:10:44 INFO Epoch 013 | train_mse=0.090262 | val_loss=0.094656 | best_val_loss=0.333700
2025-12-25 09:10:52 INFO Epoch 014 | 25% complete (batch 46/181)
2025-12-25 09:10:53 INFO Epoch 014 | 50% complete (batch 91/181)
2025-12-25 09:10:54 INFO Epoch 014 | 75% complete (batch 136/181)
2025-12-25 09:11:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.463167
2025-12-25 09:11:07 INFO Tuning ranking metrics: regret=0.118772 spearman=0.223382 (groups=39, skipped=329)
2025-12-25 09:11:07 INFO Epoch 014 | train_mse=0.106625 | val_loss=0.096915 | best_val_loss=0.333700
2025-12-25 09:11:16 INFO Epoch 015 | 25% complete (batch 46/181)
2025-12-25 09:11:17 INFO Epoch 015 | 50% complete (batch 91/181)
2025-12-25 09:11:18 INFO Epoch 015 | 75% complete (batch 136/181)
2025-12-25 09:11:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.449013
2025-12-25 09:11:31 INFO Tuning ranking metrics: regret=0.100319 spearman=0.207021 (groups=39, skipped=329)
2025-12-25 09:11:31 INFO Epoch 015 | train_mse=0.103435 | val_loss=0.093111 | best_val_loss=0.333700
2025-12-25 09:11:40 INFO Epoch 016 | 25% complete (batch 46/181)
2025-12-25 09:11:41 INFO Epoch 016 | 50% complete (batch 91/181)
2025-12-25 09:11:42 INFO Epoch 016 | 75% complete (batch 136/181)
2025-12-25 09:11:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.435863
2025-12-25 09:11:55 INFO Tuning ranking metrics: regret=0.094051 spearman=0.307814 (groups=39, skipped=329)
2025-12-25 09:11:55 INFO Epoch 016 | train_mse=0.091225 | val_loss=0.123683 | best_val_loss=0.333700
2025-12-25 09:12:04 INFO Epoch 017 | 25% complete (batch 46/181)
2025-12-25 09:12:05 INFO Epoch 017 | 50% complete (batch 91/181)
2025-12-25 09:12:06 INFO Epoch 017 | 75% complete (batch 136/181)
2025-12-25 09:12:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.468425
2025-12-25 09:12:20 INFO Tuning ranking metrics: regret=0.086269 spearman=0.293895 (groups=39, skipped=329)
2025-12-25 09:12:20 INFO Epoch 017 | train_mse=0.093639 | val_loss=0.103143 | best_val_loss=0.333700
2025-12-25 09:12:28 INFO Epoch 018 | 25% complete (batch 46/181)
2025-12-25 09:12:29 INFO Epoch 018 | 50% complete (batch 91/181)
2025-12-25 09:12:30 INFO Epoch 018 | 75% complete (batch 136/181)
2025-12-25 09:12:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.456018
2025-12-25 09:12:44 INFO Tuning ranking metrics: regret=0.100011 spearman=0.274115 (groups=39, skipped=329)
2025-12-25 09:12:44 INFO Epoch 018 | train_mse=0.125833 | val_loss=0.092897 | best_val_loss=0.333700
2025-12-25 09:12:53 INFO Epoch 019 | 25% complete (batch 46/181)
2025-12-25 09:12:53 INFO Epoch 019 | 50% complete (batch 91/181)
2025-12-25 09:12:54 INFO Epoch 019 | 75% complete (batch 136/181)
2025-12-25 09:13:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.464197
2025-12-25 09:13:08 INFO Tuning ranking metrics: regret=0.113709 spearman=0.261722 (groups=39, skipped=329)
2025-12-25 09:13:08 INFO Epoch 019 | train_mse=0.095291 | val_loss=0.099406 | best_val_loss=0.333700
2025-12-25 09:13:17 INFO Epoch 020 | 25% complete (batch 46/181)
2025-12-25 09:13:18 INFO Epoch 020 | 50% complete (batch 91/181)
2025-12-25 09:13:18 INFO Epoch 020 | 75% complete (batch 136/181)
2025-12-25 09:13:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.455077
2025-12-25 09:13:32 INFO Tuning ranking metrics: regret=0.091109 spearman=0.217155 (groups=39, skipped=329)
2025-12-25 09:13:32 INFO Epoch 020 | train_mse=0.101455 | val_loss=0.091725 | best_val_loss=0.333700
2025-12-25 09:13:41 INFO Epoch 021 | 25% complete (batch 46/181)
2025-12-25 09:13:42 INFO Epoch 021 | 50% complete (batch 91/181)
2025-12-25 09:13:43 INFO Epoch 021 | 75% complete (batch 136/181)
2025-12-25 09:13:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.483801
2025-12-25 09:13:56 INFO Tuning ranking metrics: regret=0.096377 spearman=0.150427 (groups=39, skipped=329)
2025-12-25 09:13:56 INFO Epoch 021 | train_mse=0.088945 | val_loss=0.103008 | best_val_loss=0.333700
2025-12-25 09:14:05 INFO Epoch 022 | 25% complete (batch 46/181)
2025-12-25 09:14:06 INFO Epoch 022 | 50% complete (batch 91/181)
2025-12-25 09:14:07 INFO Epoch 022 | 75% complete (batch 136/181)
2025-12-25 09:14:15 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.489322
2025-12-25 09:14:21 INFO Tuning ranking metrics: regret=0.102136 spearman=0.139744 (groups=39, skipped=329)
2025-12-25 09:14:21 INFO Epoch 022 | train_mse=0.105381 | val_loss=0.094955 | best_val_loss=0.333700
2025-12-25 09:14:29 INFO Epoch 023 | 25% complete (batch 46/181)
2025-12-25 09:14:30 INFO Epoch 023 | 50% complete (batch 91/181)
2025-12-25 09:14:31 INFO Epoch 023 | 75% complete (batch 136/181)
2025-12-25 09:14:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.456051
2025-12-25 09:14:45 INFO Tuning ranking metrics: regret=0.075455 spearman=0.231441 (groups=39, skipped=329)
2025-12-25 09:14:45 INFO Epoch 023 | train_mse=0.101418 | val_loss=0.115819 | best_val_loss=0.333700
2025-12-25 09:14:53 INFO Epoch 024 | 25% complete (batch 46/181)
2025-12-25 09:14:54 INFO Epoch 024 | 50% complete (batch 91/181)
2025-12-25 09:14:55 INFO Epoch 024 | 75% complete (batch 136/181)
2025-12-25 09:15:04 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.431961
2025-12-25 09:15:09 INFO Tuning ranking metrics: regret=0.080150 spearman=0.189988 (groups=39, skipped=329)
2025-12-25 09:15:09 INFO Epoch 024 | train_mse=0.094810 | val_loss=0.112192 | best_val_loss=0.333700
2025-12-25 09:15:18 INFO Epoch 025 | 25% complete (batch 46/181)
2025-12-25 09:15:19 INFO Epoch 025 | 50% complete (batch 91/181)
2025-12-25 09:15:19 INFO Epoch 025 | 75% complete (batch 136/181)
2025-12-25 09:15:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.432026
2025-12-25 09:15:33 INFO Tuning ranking metrics: regret=0.079363 spearman=0.247863 (groups=39, skipped=329)
2025-12-25 09:15:33 INFO Epoch 025 | train_mse=0.088983 | val_loss=0.112445 | best_val_loss=0.333700
2025-12-25 09:15:42 INFO Epoch 026 | 25% complete (batch 46/181)
2025-12-25 09:15:43 INFO Epoch 026 | 50% complete (batch 91/181)
2025-12-25 09:15:43 INFO Epoch 026 | 75% complete (batch 136/181)
2025-12-25 09:15:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.474649
2025-12-25 09:15:57 INFO Tuning ranking metrics: regret=0.073286 spearman=0.268559 (groups=39, skipped=329)
2025-12-25 09:15:57 INFO Epoch 026 | train_mse=0.079984 | val_loss=0.093732 | best_val_loss=0.333700
2025-12-25 09:16:06 INFO Epoch 027 | 25% complete (batch 46/181)
2025-12-25 09:16:07 INFO Epoch 027 | 50% complete (batch 91/181)
2025-12-25 09:16:08 INFO Epoch 027 | 75% complete (batch 136/181)
2025-12-25 09:16:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.517476
2025-12-25 09:16:22 INFO Tuning ranking metrics: regret=0.074256 spearman=0.307082 (groups=39, skipped=329)
2025-12-25 09:16:22 INFO Epoch 027 | train_mse=0.096745 | val_loss=0.092170 | best_val_loss=0.333700
2025-12-25 09:16:30 INFO Epoch 028 | 25% complete (batch 46/181)
2025-12-25 09:16:31 INFO Epoch 028 | 50% complete (batch 91/181)
2025-12-25 09:16:32 INFO Epoch 028 | 75% complete (batch 136/181)
2025-12-25 09:16:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.480558
2025-12-25 09:16:46 INFO Tuning ranking metrics: regret=0.078138 spearman=0.320879 (groups=39, skipped=329)
2025-12-25 09:16:46 INFO Epoch 028 | train_mse=0.101703 | val_loss=0.104507 | best_val_loss=0.333700
2025-12-25 09:16:54 INFO Epoch 029 | 25% complete (batch 46/181)
2025-12-25 09:16:55 INFO Epoch 029 | 50% complete (batch 91/181)
2025-12-25 09:16:56 INFO Epoch 029 | 75% complete (batch 136/181)
2025-12-25 09:17:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.514938
2025-12-25 09:17:10 INFO Tuning ranking metrics: regret=0.074638 spearman=0.292369 (groups=39, skipped=329)
2025-12-25 09:17:10 INFO Epoch 029 | train_mse=0.085569 | val_loss=0.086643 | best_val_loss=0.333700
2025-12-25 09:17:19 INFO Epoch 030 | 25% complete (batch 46/181)
2025-12-25 09:17:20 INFO Epoch 030 | 50% complete (batch 91/181)
2025-12-25 09:17:21 INFO Epoch 030 | 75% complete (batch 136/181)
2025-12-25 09:17:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.521890
2025-12-25 09:17:35 INFO Tuning ranking metrics: regret=0.074421 spearman=0.301038 (groups=39, skipped=329)
2025-12-25 09:17:35 INFO Epoch 030 | train_mse=0.092880 | val_loss=0.089199 | best_val_loss=0.333700
Monitored metric tuning_rank_spearman did not improve in the last 24 records. Best score: 0.334. Signaling Trainer to stop.
2025-12-25 09:17:36 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.32088_val-0.10451_epoch028.chkpt, checkpoint.tuning_rank_spearman-0.32735_val-0.11468_epoch005.chkpt, checkpoint.tuning_rank_spearman-0.33370_val-0.12144_epoch006.chkpt
2025-12-25 09:17:36 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed555/model_checkpoints/checkpoint.tuning_rank_spearman-0.33370_val-0.12144_epoch006.chkpt
2025-12-25 09:17:36 INFO Best validation loss: tensor(0.3337)
2025-12-25 09:17:36 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed555/model_checkpoints/checkpoint.tuning_rank_spearman-0.33370_val-0.12144_epoch006.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed555/model_checkpoints/checkpoint.tuning_rank_spearman-0.33370_val-0.12144_epoch006.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-25 09:17:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.121442
2025-12-25 09:17:48 INFO Tuning ranking metrics: regret=0.097859 spearman=0.333700 (groups=39, skipped=329)
2025-12-25 09:17:48 INFO Epoch 031 | val_loss=0.121442 | best_val_loss=0.333700
2025-12-25 09:17:49 INFO Validation metrics: [{'val_loss': 0.12144220620393753, 'tuning_rank_regret': 0.09785907715559006, 'tuning_rank_spearman': 0.33369964361190796, 'val_pearson_corr': 0.5278115272521973, 'val_spearman_corr': 0.5277039408683777, 'val_rank_regret': 0.03156936913728714, 'val_rank_spearman': 0.6666666865348816}]
2025-12-25 09:17:49 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.33370_val-0.12144_epoch006.chkpt
2025-12-25 09:17:49 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.32735_val-0.11468_epoch005.chkpt
2025-12-25 09:17:49 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.32088_val-0.10451_epoch028.chkpt
2025-12-25 09:17:49 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.11468_epoch005.ckpt
2025-12-25 09:17:49 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.09785907715559006
  tuning_rank_spearman      0.33369964361190796
        val_loss            0.12144220620393753
    val_pearson_corr        0.5278115272521973
     val_rank_regret        0.03156936913728714
    val_rank_spearman       0.6666666865348816
    val_spearman_corr       0.5277039408683777
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed555 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed555
[run_full_pipeline] Phase 2 (seed 555) best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed555/model_checkpoints/checkpoint.tuning_rank_spearman-0.33370_val-0.12144_epoch006.chkpt (tuning_rank_spearman=0.33369964361190796)
[run_full_pipeline] Phase 2 fine-tuning (seed 888) -> sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed888
[train_cli] run_id=sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed888 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed888/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed888 --git-commit 9b1bb2b320 --git-dirty --resume-from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.01908_val-0.13265_epoch004.chkpt
2025-12-25 09:17:55 INFO git_commit = 9b1bb2b320 (dirty)
2025-12-25 09:17:55 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-25 09:17:55 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed888/config/config.yaml
2025-12-25 09:17:55 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data
2025-12-25 09:17:55 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-25 09:17:55 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-25 09:17:55 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed888
2025-12-25 09:17:55 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-25 09:17:55 INFO   metadata_path = None
2025-12-25 09:17:55 INFO   summary_path = None
2025-12-25 09:17:55 INFO   accelerator = cpu
2025-12-25 09:17:55 INFO   devices = 1
2025-12-25 09:17:55 INFO   attention_head = 8
2025-12-25 09:17:55 INFO   pooling_type = mean
2025-12-25 09:17:55 INFO   model_self_loops = False
2025-12-25 09:17:55 INFO   model_self_loop_fill = mean
2025-12-25 09:17:55 INFO   model_residual = False
2025-12-25 09:17:55 INFO   batch_size = 48
2025-12-25 09:17:55 INFO   learning_rate = 0.001
2025-12-25 09:17:55 INFO   num_epochs = 320
2025-12-25 09:17:55 INFO   accumulate_grad_batches = 8
2025-12-25 09:17:55 INFO   seed = 888
2025-12-25 09:17:55 INFO   num_workers = 2
2025-12-25 09:17:55 INFO   precision = 32
2025-12-25 09:17:55 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-25 09:17:55 INFO   early_stopping_patience = 20
2025-12-25 09:17:55 INFO   lr_scheduler_patience = 4
2025-12-25 09:17:55 INFO   lr_scheduler_factor = 0.2
2025-12-25 09:17:55 INFO   fast_dev_run = False
2025-12-25 09:17:55 INFO   limit_train_batches = None
2025-12-25 09:17:55 INFO   limit_val_batches = None
2025-12-25 09:17:55 INFO   log_lr = False
2025-12-25 09:17:55 INFO   progress_bar_refresh_rate = 0
2025-12-25 09:17:55 INFO   log_every_n_steps = 100
2025-12-25 09:17:55 INFO   use_val_spearman_as_secondary = True
2025-12-25 09:17:55 INFO   spearman_secondary_min_delta = 0.0
2025-12-25 09:17:55 INFO   spearman_secondary_weight = 1.0
2025-12-25 09:17:55 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-25 09:17:55 INFO   tuning_max_samples = 500
2025-12-25 09:17:55 INFO   tuning_fraction = None
2025-12-25 09:17:55 INFO   tuning_eval_every = 1
2025-12-25 09:17:55 INFO   rank_loss_weight = 0.0
2025-12-25 09:17:55 INFO   rank_loss_margin = 0.0
2025-12-25 09:17:55 INFO   rank_loss_mode = hinge
2025-12-25 09:17:55 INFO   rank_loss_grouped = True
2025-12-25 09:17:55 INFO   variance_reduction_enabled = False
2025-12-25 09:17:55 INFO   variance_reduction_method = topk_avg
2025-12-25 09:17:55 INFO   variance_reduction_top_k = 3
2025-12-25 09:17:55 INFO   coverage_minimum = 0.0
2025-12-25 09:17:55 INFO   coverage_fail_on_missing = False
2025-12-25 09:17:55 INFO   graph_load_profiling = False
2025-12-25 09:17:55 INFO   graph_load_top_k = 5
2025-12-25 09:17:55 INFO   enable_graph_cache = True
2025-12-25 09:17:55 INFO   graph_cache_size = 256
2025-12-25 09:17:55 INFO   canonicalize_on_load = False
2025-12-25 09:17:55 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-25 09:17:55 INFO   edge_schema = {}
2025-12-25 09:17:55 INFO   topology_schema = {}
Seed set to 888
2025-12-25 09:17:56 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-25 09:17:56 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 09:17:56 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-25 09:17:56 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 09:17:56 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-25 09:17:56 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 09:17:57 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-25 09:17:57 INFO Tuning group stats: groups=351 groups>=2=40 singletons=311 max_group=10
2025-12-25 09:17:57 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed888/dataset_coverage.json
2025-12-25 09:17:57 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed888/dataset_coverage.json for details.
2025-12-25 09:17:57 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed888/dataset_coverage.json for details.
2025-12-25 09:17:57 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed888/dataset_coverage.json for details.
2025-12-25 09:17:57 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed888/schema_summary.json
2025-12-25 09:17:57 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed888/feature_metadata.json
2025-12-25 09:17:57 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-25 09:17:57 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/null_topology/feature-config.yaml.null.10A, sha256=f618659ace5620de7e794485915dadd4243f3ec2ca6726b4a9af3989817a8579
2025-12-25 09:17:57 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/work/edge_features)
2025-12-25 09:17:57 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json
2025-12-25 09:17:57 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed888/schema_summary.json
2025-12-25 09:17:57 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-25 09:17:57 INFO Topology: topology/persistence_null/v1 supporting the 172-dimensional node features.
2025-12-25 09:17:57 INFO Node: node/dssp_topo_merge/v1; metadata lists 172 feature columns matching the .pt tensor.
2025-12-25 09:17:57 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-25 09:17:57 INFO → Total feature dimensionality observed and confirmed: node_dim = 172, edge_dim = 11.
2025-12-25 09:17:57 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-25 09:17:57 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 172,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 172,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed888/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge/v1",
      "alias": "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA",
      "jobs": 16,
      "summary": "DSSP-derived node features merged with topology statistics."
    },
    "topology": {
      "id": "topology/persistence_null/v1",
      "alias": "Null topology (constant zeros) = 140D ablation",
      "jobs": 16,
      "summary": "Topology ablation: constant features with PH-compatible schema."
    }
  },
  "notes": []
}
2025-12-25 09:17:57 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-25 09:17:57 INFO Resuming from checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.01908_val-0.13265_epoch004.chkpt (epoch=4)
2025-12-25 09:17:57 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=62656e9708774bf582989fe013a06216)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-25 09:17:57 INFO Starting training (fast_dev_run=False)
2025-12-25 09:17:57 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed888/model_checkpoints exists and is not empty.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.01908_val-0.13265_epoch004.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase1/model_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed888/model_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase1/model_checkpoints/val_loss_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed888/model_checkpoints/val_loss_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 5.5 K  | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
165 K     Trainable params
0         Non-trainable params
165 K     Total params
0.662     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
Restored all states from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.01908_val-0.13265_epoch004.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-25 09:18:12 INFO Epoch 005 | 25% complete (batch 46/181)
2025-12-25 09:18:12 INFO Epoch 005 | 50% complete (batch 91/181)
2025-12-25 09:18:13 INFO Epoch 005 | 75% complete (batch 136/181)
2025-12-25 09:18:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.099380
2025-12-25 09:18:27 INFO Tuning ranking metrics: regret=0.084429 spearman=0.036066 (groups=40, skipped=311)
2025-12-25 09:18:27 INFO Epoch 005 | val_loss=0.099380
Metric tuning_rank_spearman improved by 0.012 >= min_delta = 0.0. New best score: 0.036
2025-12-25 09:18:36 INFO Epoch 006 | 25% complete (batch 46/181)
2025-12-25 09:18:37 INFO Epoch 006 | 50% complete (batch 91/181)
2025-12-25 09:18:37 INFO Epoch 006 | 75% complete (batch 136/181)
2025-12-25 09:18:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.414346
2025-12-25 09:18:51 INFO Tuning ranking metrics: regret=0.110849 spearman=0.006239 (groups=40, skipped=311)
2025-12-25 09:18:51 INFO Epoch 006 | train_mse=0.106532 | val_loss=0.108110 | best_val_loss=0.036066
2025-12-25 09:19:00 INFO Epoch 007 | 25% complete (batch 46/181)
2025-12-25 09:19:01 INFO Epoch 007 | 50% complete (batch 91/181)
2025-12-25 09:19:02 INFO Epoch 007 | 75% complete (batch 136/181)
2025-12-25 09:19:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.446740
2025-12-25 09:19:15 INFO Tuning ranking metrics: regret=0.100031 spearman=-0.043544 (groups=40, skipped=311)
2025-12-25 09:19:15 INFO Epoch 007 | train_mse=0.099108 | val_loss=0.092483 | best_val_loss=0.036066
2025-12-25 09:19:24 INFO Epoch 008 | 25% complete (batch 46/181)
2025-12-25 09:19:25 INFO Epoch 008 | 50% complete (batch 91/181)
2025-12-25 09:19:26 INFO Epoch 008 | 75% complete (batch 136/181)
2025-12-25 09:19:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.449077
2025-12-25 09:19:40 INFO Tuning ranking metrics: regret=0.095031 spearman=0.045801 (groups=40, skipped=311)
2025-12-25 09:19:40 INFO Epoch 008 | train_mse=0.098397 | val_loss=0.098211 | best_val_loss=0.036066
Metric tuning_rank_spearman improved by 0.010 >= min_delta = 0.0. New best score: 0.046
2025-12-25 09:19:48 INFO Epoch 009 | 25% complete (batch 46/181)
2025-12-25 09:19:49 INFO Epoch 009 | 50% complete (batch 91/181)
2025-12-25 09:19:50 INFO Epoch 009 | 75% complete (batch 136/181)
2025-12-25 09:19:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.458345
2025-12-25 09:20:04 INFO Tuning ranking metrics: regret=0.108253 spearman=0.039908 (groups=40, skipped=311)
2025-12-25 09:20:04 INFO Epoch 009 | train_mse=0.089257 | val_loss=0.113910 | best_val_loss=0.045801
2025-12-25 09:20:12 INFO Epoch 010 | 25% complete (batch 46/181)
2025-12-25 09:20:13 INFO Epoch 010 | 50% complete (batch 91/181)
2025-12-25 09:20:14 INFO Epoch 010 | 75% complete (batch 136/181)
2025-12-25 09:20:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.475354
2025-12-25 09:20:28 INFO Tuning ranking metrics: regret=0.096284 spearman=0.037949 (groups=40, skipped=311)
2025-12-25 09:20:28 INFO Epoch 010 | train_mse=0.109384 | val_loss=0.093179 | best_val_loss=0.045801
2025-12-25 09:20:36 INFO Epoch 011 | 25% complete (batch 46/181)
2025-12-25 09:20:37 INFO Epoch 011 | 50% complete (batch 91/181)
2025-12-25 09:20:38 INFO Epoch 011 | 75% complete (batch 136/181)
2025-12-25 09:20:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.457500
2025-12-25 09:20:52 INFO Tuning ranking metrics: regret=0.118766 spearman=0.023047 (groups=40, skipped=311)
2025-12-25 09:20:52 INFO Epoch 011 | train_mse=0.096779 | val_loss=0.113246 | best_val_loss=0.045801
2025-12-25 09:21:01 INFO Epoch 012 | 25% complete (batch 46/181)
2025-12-25 09:21:01 INFO Epoch 012 | 50% complete (batch 91/181)
2025-12-25 09:21:02 INFO Epoch 012 | 75% complete (batch 136/181)
2025-12-25 09:21:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.487092
2025-12-25 09:21:16 INFO Tuning ranking metrics: regret=0.130380 spearman=0.056548 (groups=40, skipped=311)
2025-12-25 09:21:16 INFO Epoch 012 | train_mse=0.098145 | val_loss=0.092809 | best_val_loss=0.045801
Metric tuning_rank_spearman improved by 0.011 >= min_delta = 0.0. New best score: 0.057
2025-12-25 09:21:25 INFO Epoch 013 | 25% complete (batch 46/181)
2025-12-25 09:21:26 INFO Epoch 013 | 50% complete (batch 91/181)
2025-12-25 09:21:27 INFO Epoch 013 | 75% complete (batch 136/181)
2025-12-25 09:21:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.491389
2025-12-25 09:21:40 INFO Tuning ranking metrics: regret=0.116121 spearman=0.001153 (groups=40, skipped=311)
2025-12-25 09:21:40 INFO Epoch 013 | train_mse=0.102506 | val_loss=0.089937 | best_val_loss=0.056548
2025-12-25 09:21:49 INFO Epoch 014 | 25% complete (batch 46/181)
2025-12-25 09:21:50 INFO Epoch 014 | 50% complete (batch 91/181)
2025-12-25 09:21:51 INFO Epoch 014 | 75% complete (batch 136/181)
2025-12-25 09:22:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.497279
2025-12-25 09:22:05 INFO Tuning ranking metrics: regret=0.110344 spearman=-0.010915 (groups=40, skipped=311)
2025-12-25 09:22:05 INFO Epoch 014 | train_mse=0.097406 | val_loss=0.091726 | best_val_loss=0.056548
2025-12-25 09:22:13 INFO Epoch 015 | 25% complete (batch 46/181)
2025-12-25 09:22:14 INFO Epoch 015 | 50% complete (batch 91/181)
2025-12-25 09:22:15 INFO Epoch 015 | 75% complete (batch 136/181)
2025-12-25 09:22:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.495201
2025-12-25 09:22:29 INFO Tuning ranking metrics: regret=0.106690 spearman=0.018831 (groups=40, skipped=311)
2025-12-25 09:22:29 INFO Epoch 015 | train_mse=0.087945 | val_loss=0.089932 | best_val_loss=0.056548
2025-12-25 09:22:38 INFO Epoch 016 | 25% complete (batch 46/181)
2025-12-25 09:22:38 INFO Epoch 016 | 50% complete (batch 91/181)
2025-12-25 09:22:39 INFO Epoch 016 | 75% complete (batch 136/181)
2025-12-25 09:22:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.485168
2025-12-25 09:22:53 INFO Tuning ranking metrics: regret=0.091464 spearman=0.109291 (groups=40, skipped=311)
2025-12-25 09:22:53 INFO Epoch 016 | train_mse=0.096866 | val_loss=0.107593 | best_val_loss=0.056548
Metric tuning_rank_spearman improved by 0.053 >= min_delta = 0.0. New best score: 0.109
2025-12-25 09:23:02 INFO Epoch 017 | 25% complete (batch 46/181)
2025-12-25 09:23:03 INFO Epoch 017 | 50% complete (batch 91/181)
2025-12-25 09:23:03 INFO Epoch 017 | 75% complete (batch 136/181)
2025-12-25 09:23:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.516246
2025-12-25 09:23:17 INFO Tuning ranking metrics: regret=0.093079 spearman=0.027922 (groups=40, skipped=311)
2025-12-25 09:23:17 INFO Epoch 017 | train_mse=0.096081 | val_loss=0.088521 | best_val_loss=0.109291
2025-12-25 09:23:26 INFO Epoch 018 | 25% complete (batch 46/181)
2025-12-25 09:23:27 INFO Epoch 018 | 50% complete (batch 91/181)
2025-12-25 09:23:28 INFO Epoch 018 | 75% complete (batch 136/181)
2025-12-25 09:23:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.502068
2025-12-25 09:23:42 INFO Tuning ranking metrics: regret=0.094737 spearman=0.051807 (groups=40, skipped=311)
2025-12-25 09:23:42 INFO Epoch 018 | train_mse=0.097212 | val_loss=0.094349 | best_val_loss=0.109291
2025-12-25 09:23:50 INFO Epoch 019 | 25% complete (batch 46/181)
2025-12-25 09:23:52 INFO Epoch 019 | 50% complete (batch 91/181)
2025-12-25 09:23:52 INFO Epoch 019 | 75% complete (batch 136/181)
2025-12-25 09:24:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.497756
2025-12-25 09:24:06 INFO Tuning ranking metrics: regret=0.112683 spearman=0.014789 (groups=40, skipped=311)
2025-12-25 09:24:06 INFO Epoch 019 | train_mse=0.095576 | val_loss=0.093832 | best_val_loss=0.109291
2025-12-25 09:24:15 INFO Epoch 020 | 25% complete (batch 46/181)
2025-12-25 09:24:16 INFO Epoch 020 | 50% complete (batch 91/181)
2025-12-25 09:24:17 INFO Epoch 020 | 75% complete (batch 136/181)
2025-12-25 09:24:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.497339
2025-12-25 09:24:31 INFO Tuning ranking metrics: regret=0.114159 spearman=0.028360 (groups=40, skipped=311)
2025-12-25 09:24:31 INFO Epoch 020 | train_mse=0.084333 | val_loss=0.089118 | best_val_loss=0.109291
2025-12-25 09:24:39 INFO Epoch 021 | 25% complete (batch 46/181)
2025-12-25 09:24:40 INFO Epoch 021 | 50% complete (batch 91/181)
2025-12-25 09:24:41 INFO Epoch 021 | 75% complete (batch 136/181)
2025-12-25 09:24:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.506449
2025-12-25 09:24:55 INFO Tuning ranking metrics: regret=0.126146 spearman=-0.030747 (groups=40, skipped=311)
2025-12-25 09:24:55 INFO Epoch 021 | train_mse=0.099215 | val_loss=0.089750 | best_val_loss=0.109291
2025-12-25 09:25:03 INFO Epoch 022 | 25% complete (batch 46/181)
2025-12-25 09:25:04 INFO Epoch 022 | 50% complete (batch 91/181)
2025-12-25 09:25:05 INFO Epoch 022 | 75% complete (batch 136/181)
2025-12-25 09:25:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.503210
2025-12-25 09:25:19 INFO Tuning ranking metrics: regret=0.107543 spearman=0.020855 (groups=40, skipped=311)
2025-12-25 09:25:19 INFO Epoch 022 | train_mse=0.091626 | val_loss=0.107811 | best_val_loss=0.109291
2025-12-25 09:25:28 INFO Epoch 023 | 25% complete (batch 46/181)
2025-12-25 09:25:28 INFO Epoch 023 | 50% complete (batch 91/181)
2025-12-25 09:25:29 INFO Epoch 023 | 75% complete (batch 136/181)
2025-12-25 09:25:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.496338
2025-12-25 09:25:43 INFO Tuning ranking metrics: regret=0.107523 spearman=0.057538 (groups=40, skipped=311)
2025-12-25 09:25:43 INFO Epoch 023 | train_mse=0.088207 | val_loss=0.090471 | best_val_loss=0.109291
2025-12-25 09:25:52 INFO Epoch 024 | 25% complete (batch 46/181)
2025-12-25 09:25:53 INFO Epoch 024 | 50% complete (batch 91/181)
2025-12-25 09:25:54 INFO Epoch 024 | 75% complete (batch 136/181)
2025-12-25 09:26:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.502801
2025-12-25 09:26:08 INFO Tuning ranking metrics: regret=0.130646 spearman=0.139508 (groups=40, skipped=311)
2025-12-25 09:26:08 INFO Epoch 024 | train_mse=0.083289 | val_loss=0.108639 | best_val_loss=0.109291
Metric tuning_rank_spearman improved by 0.030 >= min_delta = 0.0. New best score: 0.140
2025-12-25 09:26:16 INFO Epoch 025 | 25% complete (batch 46/181)
2025-12-25 09:26:17 INFO Epoch 025 | 50% complete (batch 91/181)
2025-12-25 09:26:18 INFO Epoch 025 | 75% complete (batch 136/181)
2025-12-25 09:26:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.490556
2025-12-25 09:26:32 INFO Tuning ranking metrics: regret=0.088621 spearman=0.079903 (groups=40, skipped=311)
2025-12-25 09:26:32 INFO Epoch 025 | train_mse=0.091623 | val_loss=0.092565 | best_val_loss=0.139508
2025-12-25 09:26:42 INFO Epoch 026 | 25% complete (batch 46/181)
2025-12-25 09:26:43 INFO Epoch 026 | 50% complete (batch 91/181)
2025-12-25 09:26:44 INFO Epoch 026 | 75% complete (batch 136/181)
2025-12-25 09:26:53 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.515065
2025-12-25 09:26:58 INFO Tuning ranking metrics: regret=0.104222 spearman=0.094708 (groups=40, skipped=311)
2025-12-25 09:26:58 INFO Epoch 026 | train_mse=0.088555 | val_loss=0.087438 | best_val_loss=0.139508
2025-12-25 09:27:07 INFO Epoch 027 | 25% complete (batch 46/181)
2025-12-25 09:27:08 INFO Epoch 027 | 50% complete (batch 91/181)
2025-12-25 09:27:09 INFO Epoch 027 | 75% complete (batch 136/181)
2025-12-25 09:27:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.510704
2025-12-25 09:27:22 INFO Tuning ranking metrics: regret=0.085472 spearman=0.129551 (groups=40, skipped=311)
2025-12-25 09:27:22 INFO Epoch 027 | train_mse=0.083156 | val_loss=0.090743 | best_val_loss=0.139508
2025-12-25 09:27:31 INFO Epoch 028 | 25% complete (batch 46/181)
2025-12-25 09:27:32 INFO Epoch 028 | 50% complete (batch 91/181)
2025-12-25 09:27:33 INFO Epoch 028 | 75% complete (batch 136/181)
2025-12-25 09:27:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.523582
2025-12-25 09:27:46 INFO Tuning ranking metrics: regret=0.105680 spearman=0.057408 (groups=40, skipped=311)
2025-12-25 09:27:46 INFO Epoch 028 | train_mse=0.093883 | val_loss=0.085779 | best_val_loss=0.139508
2025-12-25 09:27:55 INFO Epoch 029 | 25% complete (batch 46/181)
2025-12-25 09:27:56 INFO Epoch 029 | 50% complete (batch 91/181)
2025-12-25 09:27:56 INFO Epoch 029 | 75% complete (batch 136/181)
2025-12-25 09:28:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.514151
2025-12-25 09:28:10 INFO Tuning ranking metrics: regret=0.082966 spearman=0.139313 (groups=40, skipped=311)
2025-12-25 09:28:10 INFO Epoch 029 | train_mse=0.086660 | val_loss=0.089257 | best_val_loss=0.139508
2025-12-25 09:28:19 INFO Epoch 030 | 25% complete (batch 46/181)
2025-12-25 09:28:20 INFO Epoch 030 | 50% complete (batch 91/181)
2025-12-25 09:28:20 INFO Epoch 030 | 75% complete (batch 136/181)
2025-12-25 09:28:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.521912
2025-12-25 09:28:34 INFO Tuning ranking metrics: regret=0.087054 spearman=0.086277 (groups=40, skipped=311)
2025-12-25 09:28:34 INFO Epoch 030 | train_mse=0.080151 | val_loss=0.086125 | best_val_loss=0.139508
2025-12-25 09:28:43 INFO Epoch 031 | 25% complete (batch 46/181)
2025-12-25 09:28:44 INFO Epoch 031 | 50% complete (batch 91/181)
2025-12-25 09:28:45 INFO Epoch 031 | 75% complete (batch 136/181)
2025-12-25 09:28:53 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.509403
2025-12-25 09:28:58 INFO Tuning ranking metrics: regret=0.087054 spearman=0.067944 (groups=40, skipped=311)
2025-12-25 09:28:58 INFO Epoch 031 | train_mse=0.081890 | val_loss=0.096386 | best_val_loss=0.139508
2025-12-25 09:29:07 INFO Epoch 032 | 25% complete (batch 46/181)
2025-12-25 09:29:08 INFO Epoch 032 | 50% complete (batch 91/181)
2025-12-25 09:29:09 INFO Epoch 032 | 75% complete (batch 136/181)
2025-12-25 09:29:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.529046
2025-12-25 09:29:22 INFO Tuning ranking metrics: regret=0.080209 spearman=0.128279 (groups=40, skipped=311)
2025-12-25 09:29:22 INFO Epoch 032 | train_mse=0.070943 | val_loss=0.084993 | best_val_loss=0.139508
2025-12-25 09:29:31 INFO Epoch 033 | 25% complete (batch 46/181)
2025-12-25 09:29:32 INFO Epoch 033 | 50% complete (batch 91/181)
2025-12-25 09:29:33 INFO Epoch 033 | 75% complete (batch 136/181)
2025-12-25 09:29:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.526024
2025-12-25 09:29:47 INFO Tuning ranking metrics: regret=0.095010 spearman=0.153160 (groups=40, skipped=311)
2025-12-25 09:29:47 INFO Epoch 033 | train_mse=0.082678 | val_loss=0.084494 | best_val_loss=0.139508
Metric tuning_rank_spearman improved by 0.014 >= min_delta = 0.0. New best score: 0.153
2025-12-25 09:29:56 INFO Epoch 034 | 25% complete (batch 46/181)
2025-12-25 09:29:56 INFO Epoch 034 | 50% complete (batch 91/181)
2025-12-25 09:29:57 INFO Epoch 034 | 75% complete (batch 136/181)
2025-12-25 09:30:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.530420
2025-12-25 09:30:11 INFO Tuning ranking metrics: regret=0.080359 spearman=0.106136 (groups=40, skipped=311)
2025-12-25 09:30:11 INFO Epoch 034 | train_mse=0.091957 | val_loss=0.086537 | best_val_loss=0.153160
2025-12-25 09:30:20 INFO Epoch 035 | 25% complete (batch 46/181)
2025-12-25 09:30:20 INFO Epoch 035 | 50% complete (batch 91/181)
2025-12-25 09:30:21 INFO Epoch 035 | 75% complete (batch 136/181)
2025-12-25 09:30:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.533753
2025-12-25 09:30:35 INFO Tuning ranking metrics: regret=0.098514 spearman=0.091553 (groups=40, skipped=311)
2025-12-25 09:30:35 INFO Epoch 035 | train_mse=0.074268 | val_loss=0.091772 | best_val_loss=0.153160
2025-12-25 09:30:44 INFO Epoch 036 | 25% complete (batch 46/181)
2025-12-25 09:30:45 INFO Epoch 036 | 50% complete (batch 91/181)
2025-12-25 09:30:45 INFO Epoch 036 | 75% complete (batch 136/181)
2025-12-25 09:30:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.531699
2025-12-25 09:30:59 INFO Tuning ranking metrics: regret=0.097233 spearman=0.102208 (groups=40, skipped=311)
2025-12-25 09:30:59 INFO Epoch 036 | train_mse=0.092757 | val_loss=0.083883 | best_val_loss=0.153160
2025-12-25 09:31:08 INFO Epoch 037 | 25% complete (batch 46/181)
2025-12-25 09:31:09 INFO Epoch 037 | 50% complete (batch 91/181)
2025-12-25 09:31:10 INFO Epoch 037 | 75% complete (batch 136/181)
2025-12-25 09:31:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.534981
2025-12-25 09:31:23 INFO Tuning ranking metrics: regret=0.097232 spearman=0.116672 (groups=40, skipped=311)
2025-12-25 09:31:23 INFO Epoch 037 | train_mse=0.081388 | val_loss=0.086486 | best_val_loss=0.153160
2025-12-25 09:31:32 INFO Epoch 038 | 25% complete (batch 46/181)
2025-12-25 09:31:33 INFO Epoch 038 | 50% complete (batch 91/181)
2025-12-25 09:31:34 INFO Epoch 038 | 75% complete (batch 136/181)
2025-12-25 09:31:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.540731
2025-12-25 09:31:47 INFO Tuning ranking metrics: regret=0.079834 spearman=0.064886 (groups=40, skipped=311)
2025-12-25 09:31:47 INFO Epoch 038 | train_mse=0.092193 | val_loss=0.085348 | best_val_loss=0.153160
2025-12-25 09:31:56 INFO Epoch 039 | 25% complete (batch 46/181)
2025-12-25 09:31:57 INFO Epoch 039 | 50% complete (batch 91/181)
2025-12-25 09:31:57 INFO Epoch 039 | 75% complete (batch 136/181)
2025-12-25 09:32:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.536822
2025-12-25 09:32:11 INFO Tuning ranking metrics: regret=0.078884 spearman=0.099529 (groups=40, skipped=311)
2025-12-25 09:32:11 INFO Epoch 039 | train_mse=0.080351 | val_loss=0.085484 | best_val_loss=0.153160
2025-12-25 09:32:20 INFO Epoch 040 | 25% complete (batch 46/181)
2025-12-25 09:32:20 INFO Epoch 040 | 50% complete (batch 91/181)
2025-12-25 09:32:21 INFO Epoch 040 | 75% complete (batch 136/181)
2025-12-25 09:32:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.532050
2025-12-25 09:32:35 INFO Tuning ranking metrics: regret=0.078909 spearman=0.048696 (groups=40, skipped=311)
2025-12-25 09:32:35 INFO Epoch 040 | train_mse=0.081925 | val_loss=0.086819 | best_val_loss=0.153160
2025-12-25 09:32:43 INFO Epoch 041 | 25% complete (batch 46/181)
2025-12-25 09:32:44 INFO Epoch 041 | 50% complete (batch 91/181)
2025-12-25 09:32:45 INFO Epoch 041 | 75% complete (batch 136/181)
2025-12-25 09:32:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.530741
2025-12-25 09:32:59 INFO Tuning ranking metrics: regret=0.078759 spearman=0.091315 (groups=40, skipped=311)
2025-12-25 09:32:59 INFO Epoch 041 | train_mse=0.071532 | val_loss=0.089603 | best_val_loss=0.153160
2025-12-25 09:33:07 INFO Epoch 042 | 25% complete (batch 46/181)
2025-12-25 09:33:08 INFO Epoch 042 | 50% complete (batch 91/181)
2025-12-25 09:33:09 INFO Epoch 042 | 75% complete (batch 136/181)
2025-12-25 09:33:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.532557
2025-12-25 09:33:23 INFO Tuning ranking metrics: regret=0.097219 spearman=0.029940 (groups=40, skipped=311)
2025-12-25 09:33:23 INFO Epoch 042 | train_mse=0.083156 | val_loss=0.087753 | best_val_loss=0.153160
2025-12-25 09:33:31 INFO Epoch 043 | 25% complete (batch 46/181)
2025-12-25 09:33:32 INFO Epoch 043 | 50% complete (batch 91/181)
2025-12-25 09:33:33 INFO Epoch 043 | 75% complete (batch 136/181)
2025-12-25 09:33:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.541369
2025-12-25 09:33:46 INFO Tuning ranking metrics: regret=0.100218 spearman=0.014524 (groups=40, skipped=311)
2025-12-25 09:33:46 INFO Epoch 043 | train_mse=0.087402 | val_loss=0.084005 | best_val_loss=0.153160
2025-12-25 09:33:55 INFO Epoch 044 | 25% complete (batch 46/181)
2025-12-25 09:33:56 INFO Epoch 044 | 50% complete (batch 91/181)
2025-12-25 09:33:57 INFO Epoch 044 | 75% complete (batch 136/181)
2025-12-25 09:34:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.544485
2025-12-25 09:34:10 INFO Tuning ranking metrics: regret=0.100218 spearman=0.014524 (groups=40, skipped=311)
2025-12-25 09:34:10 INFO Epoch 044 | train_mse=0.072779 | val_loss=0.084310 | best_val_loss=0.153160
2025-12-25 09:34:19 INFO Epoch 045 | 25% complete (batch 46/181)
2025-12-25 09:34:20 INFO Epoch 045 | 50% complete (batch 91/181)
2025-12-25 09:34:21 INFO Epoch 045 | 75% complete (batch 136/181)
2025-12-25 09:34:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.540202
2025-12-25 09:34:35 INFO Tuning ranking metrics: regret=0.101436 spearman=-0.035655 (groups=40, skipped=311)
2025-12-25 09:34:35 INFO Epoch 045 | train_mse=0.072972 | val_loss=0.084501 | best_val_loss=0.153160
2025-12-25 09:34:43 INFO Epoch 046 | 25% complete (batch 46/181)
2025-12-25 09:34:44 INFO Epoch 046 | 50% complete (batch 91/181)
2025-12-25 09:34:45 INFO Epoch 046 | 75% complete (batch 136/181)
2025-12-25 09:34:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.539595
2025-12-25 09:34:59 INFO Tuning ranking metrics: regret=0.101430 spearman=-0.021369 (groups=40, skipped=311)
2025-12-25 09:34:59 INFO Epoch 046 | train_mse=0.069288 | val_loss=0.085712 | best_val_loss=0.153160
2025-12-25 09:35:07 INFO Epoch 047 | 25% complete (batch 46/181)
2025-12-25 09:35:08 INFO Epoch 047 | 50% complete (batch 91/181)
2025-12-25 09:35:09 INFO Epoch 047 | 75% complete (batch 136/181)
2025-12-25 09:35:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.540279
2025-12-25 09:35:23 INFO Tuning ranking metrics: regret=0.101430 spearman=0.003631 (groups=40, skipped=311)
2025-12-25 09:35:23 INFO Epoch 047 | train_mse=0.072047 | val_loss=0.084827 | best_val_loss=0.153160
2025-12-25 09:35:31 INFO Epoch 048 | 25% complete (batch 46/181)
2025-12-25 09:35:32 INFO Epoch 048 | 50% complete (batch 91/181)
2025-12-25 09:35:33 INFO Epoch 048 | 75% complete (batch 136/181)
2025-12-25 09:35:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.545275
2025-12-25 09:35:47 INFO Tuning ranking metrics: regret=0.102361 spearman=-0.032029 (groups=40, skipped=311)
2025-12-25 09:35:47 INFO Epoch 048 | train_mse=0.085445 | val_loss=0.084677 | best_val_loss=0.153160
2025-12-25 09:35:55 INFO Epoch 049 | 25% complete (batch 46/181)
2025-12-25 09:35:56 INFO Epoch 049 | 50% complete (batch 91/181)
2025-12-25 09:35:57 INFO Epoch 049 | 75% complete (batch 136/181)
2025-12-25 09:36:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.529980
2025-12-25 09:36:11 INFO Tuning ranking metrics: regret=0.101405 spearman=0.028328 (groups=40, skipped=311)
2025-12-25 09:36:11 INFO Epoch 049 | train_mse=0.074862 | val_loss=0.084730 | best_val_loss=0.153160
2025-12-25 09:36:19 INFO Epoch 050 | 25% complete (batch 46/181)
2025-12-25 09:36:20 INFO Epoch 050 | 50% complete (batch 91/181)
2025-12-25 09:36:21 INFO Epoch 050 | 75% complete (batch 136/181)
2025-12-25 09:36:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.533468
2025-12-25 09:36:35 INFO Tuning ranking metrics: regret=0.080009 spearman=0.065417 (groups=40, skipped=311)
2025-12-25 09:36:35 INFO Epoch 050 | train_mse=0.075246 | val_loss=0.089894 | best_val_loss=0.153160
2025-12-25 09:36:43 INFO Epoch 051 | 25% complete (batch 46/181)
2025-12-25 09:36:44 INFO Epoch 051 | 50% complete (batch 91/181)
2025-12-25 09:36:45 INFO Epoch 051 | 75% complete (batch 136/181)
2025-12-25 09:36:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.531452
2025-12-25 09:36:59 INFO Tuning ranking metrics: regret=0.080009 spearman=0.065417 (groups=40, skipped=311)
2025-12-25 09:36:59 INFO Epoch 051 | train_mse=0.069656 | val_loss=0.090200 | best_val_loss=0.153160
2025-12-25 09:37:08 INFO Epoch 052 | 25% complete (batch 46/181)
2025-12-25 09:37:09 INFO Epoch 052 | 50% complete (batch 91/181)
2025-12-25 09:37:10 INFO Epoch 052 | 75% complete (batch 136/181)
2025-12-25 09:37:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.532636
2025-12-25 09:37:23 INFO Tuning ranking metrics: regret=0.080009 spearman=0.065417 (groups=40, skipped=311)
2025-12-25 09:37:23 INFO Epoch 052 | train_mse=0.068737 | val_loss=0.089988 | best_val_loss=0.153160
2025-12-25 09:37:32 INFO Epoch 053 | 25% complete (batch 46/181)
2025-12-25 09:37:33 INFO Epoch 053 | 50% complete (batch 91/181)
2025-12-25 09:37:34 INFO Epoch 053 | 75% complete (batch 136/181)
2025-12-25 09:37:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.532788
2025-12-25 09:37:48 INFO Tuning ranking metrics: regret=0.080009 spearman=0.065417 (groups=40, skipped=311)
2025-12-25 09:37:48 INFO Epoch 053 | train_mse=0.070493 | val_loss=0.089802 | best_val_loss=0.153160
2025-12-25 09:37:56 INFO Epoch 054 | 25% complete (batch 46/181)
2025-12-25 09:37:57 INFO Epoch 054 | 50% complete (batch 91/181)
2025-12-25 09:37:58 INFO Epoch 054 | 75% complete (batch 136/181)
2025-12-25 09:38:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.532815
2025-12-25 09:38:11 INFO Tuning ranking metrics: regret=0.080009 spearman=0.065417 (groups=40, skipped=311)
2025-12-25 09:38:11 INFO Epoch 054 | train_mse=0.077950 | val_loss=0.089675 | best_val_loss=0.153160
2025-12-25 09:38:20 INFO Epoch 055 | 25% complete (batch 46/181)
2025-12-25 09:38:21 INFO Epoch 055 | 50% complete (batch 91/181)
2025-12-25 09:38:22 INFO Epoch 055 | 75% complete (batch 136/181)
2025-12-25 09:38:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.533669
2025-12-25 09:38:36 INFO Tuning ranking metrics: regret=0.080009 spearman=0.063988 (groups=40, skipped=311)
2025-12-25 09:38:36 INFO Epoch 055 | train_mse=0.086039 | val_loss=0.089190 | best_val_loss=0.153160
2025-12-25 09:38:44 INFO Epoch 056 | 25% complete (batch 46/181)
2025-12-25 09:38:45 INFO Epoch 056 | 50% complete (batch 91/181)
2025-12-25 09:38:46 INFO Epoch 056 | 75% complete (batch 136/181)
2025-12-25 09:38:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.535612
2025-12-25 09:39:00 INFO Tuning ranking metrics: regret=0.080009 spearman=0.066488 (groups=40, skipped=311)
2025-12-25 09:39:00 INFO Epoch 056 | train_mse=0.083929 | val_loss=0.088052 | best_val_loss=0.153160
2025-12-25 09:39:08 INFO Epoch 057 | 25% complete (batch 46/181)
2025-12-25 09:39:09 INFO Epoch 057 | 50% complete (batch 91/181)
2025-12-25 09:39:10 INFO Epoch 057 | 75% complete (batch 136/181)
2025-12-25 09:39:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.536469
2025-12-25 09:39:24 INFO Tuning ranking metrics: regret=0.080009 spearman=0.063988 (groups=40, skipped=311)
2025-12-25 09:39:24 INFO Epoch 057 | train_mse=0.077658 | val_loss=0.088000 | best_val_loss=0.153160
Monitored metric tuning_rank_spearman did not improve in the last 24 records. Best score: 0.153. Signaling Trainer to stop.
2025-12-25 09:39:25 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.13931_val-0.08926_epoch029.chkpt, checkpoint.tuning_rank_spearman-0.13951_val-0.10864_epoch024.chkpt, checkpoint.tuning_rank_spearman-0.15316_val-0.08449_epoch033.chkpt
2025-12-25 09:39:25 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed888/model_checkpoints/checkpoint.tuning_rank_spearman-0.15316_val-0.08449_epoch033.chkpt
2025-12-25 09:39:25 INFO Best validation loss: tensor(0.1532)
2025-12-25 09:39:25 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed888/model_checkpoints/checkpoint.tuning_rank_spearman-0.15316_val-0.08449_epoch033.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed888/model_checkpoints/checkpoint.tuning_rank_spearman-0.15316_val-0.08449_epoch033.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-25 09:39:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.084494
2025-12-25 09:39:38 INFO Tuning ranking metrics: regret=0.095010 spearman=0.153160 (groups=40, skipped=311)
2025-12-25 09:39:38 INFO Epoch 058 | val_loss=0.084494 | best_val_loss=0.153160
2025-12-25 09:39:38 INFO Validation metrics: [{'val_loss': 0.08449394255876541, 'tuning_rank_regret': 0.09500982612371445, 'tuning_rank_spearman': 0.15316016972064972, 'val_pearson_corr': 0.6336172819137573, 'val_spearman_corr': 0.616956889629364, 'val_rank_regret': 0.03174496442079544, 'val_rank_spearman': 0.5555555820465088}]
2025-12-25 09:39:38 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.15316_val-0.08449_epoch033.chkpt
2025-12-25 09:39:38 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.13951_val-0.10864_epoch024.chkpt
2025-12-25 09:39:38 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.13931_val-0.08926_epoch029.chkpt
2025-12-25 09:39:38 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.08499_epoch032.ckpt
2025-12-25 09:39:38 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.09500982612371445
  tuning_rank_spearman      0.15316016972064972
        val_loss            0.08449394255876541
    val_pearson_corr        0.6336172819137573
     val_rank_regret        0.03174496442079544
    val_rank_spearman       0.5555555820465088
    val_spearman_corr        0.616956889629364
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed888 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed888
[run_full_pipeline] Phase 2 (seed 888) best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed888/model_checkpoints/checkpoint.tuning_rank_spearman-0.15316_val-0.08449_epoch033.chkpt (tuning_rank_spearman=0.15316016972064972)
[run_full_pipeline] Pipeline complete at 2025-12-25T09:39:41Z
Starting post model training polishing ...
[polish_from_best] Manifest written to manifests/run_polish_lean.yaml
[polish_from_best] Best run: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/sched_boost_lr035_lean_seed222_2025-12-25_08-07-46_phase2_seed555
[polish_from_best] Base config: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/configs/sched_boost_finetune_seed555.yaml
[polish_from_best] Seeds: 101 555 888
[polish_from_best] Launching run_full_pipeline.sh with manifests/run_polish_lean.yaml
[run_full_pipeline] Validating graphs before training...
[validate_graphs] OK: validated 14391 graph(s) in /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data
[run_full_pipeline] Starting sweep at 2025-12-25T09:39:57.202507+00:00 using manifest /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/manifests/run_polish_lean.yaml
[train_cli][batch] (1/6) running job 'polish_seed101' -> run_name=polish_seed101_2025-12-25_09-39-57
[train_cli] run_id=polish_seed101_2025-12-25_09-39-57 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57 --git-commit 9b1bb2b320 --git-dirty
2025-12-25 09:40:00 INFO git_commit = 9b1bb2b320 (dirty)
2025-12-25 09:40:00 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-25 09:40:00 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57/config/config.yaml
2025-12-25 09:40:00 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data
2025-12-25 09:40:00 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-25 09:40:00 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-25 09:40:00 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57
2025-12-25 09:40:00 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-25 09:40:00 INFO   metadata_path = None
2025-12-25 09:40:00 INFO   summary_path = None
2025-12-25 09:40:00 INFO   accelerator = cpu
2025-12-25 09:40:00 INFO   devices = 1
2025-12-25 09:40:00 INFO   attention_head = 8
2025-12-25 09:40:00 INFO   pooling_type = mean
2025-12-25 09:40:00 INFO   model_self_loops = False
2025-12-25 09:40:00 INFO   model_self_loop_fill = mean
2025-12-25 09:40:00 INFO   model_residual = False
2025-12-25 09:40:00 INFO   batch_size = 48
2025-12-25 09:40:00 INFO   learning_rate = 0.003
2025-12-25 09:40:00 INFO   num_epochs = 320
2025-12-25 09:40:00 INFO   accumulate_grad_batches = 8
2025-12-25 09:40:00 INFO   seed = 101
2025-12-25 09:40:00 INFO   num_workers = 2
2025-12-25 09:40:00 INFO   precision = 32
2025-12-25 09:40:00 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-25 09:40:00 INFO   early_stopping_patience = 40
2025-12-25 09:40:00 INFO   lr_scheduler_patience = 20
2025-12-25 09:40:00 INFO   lr_scheduler_factor = 0.3
2025-12-25 09:40:00 INFO   fast_dev_run = False
2025-12-25 09:40:00 INFO   limit_train_batches = None
2025-12-25 09:40:00 INFO   limit_val_batches = None
2025-12-25 09:40:00 INFO   log_lr = False
2025-12-25 09:40:00 INFO   progress_bar_refresh_rate = 0
2025-12-25 09:40:00 INFO   log_every_n_steps = 100
2025-12-25 09:40:00 INFO   use_val_spearman_as_secondary = True
2025-12-25 09:40:00 INFO   spearman_secondary_min_delta = 0.0
2025-12-25 09:40:00 INFO   spearman_secondary_weight = 1.0
2025-12-25 09:40:00 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-25 09:40:00 INFO   tuning_max_samples = 500
2025-12-25 09:40:00 INFO   tuning_fraction = None
2025-12-25 09:40:00 INFO   tuning_eval_every = 1
2025-12-25 09:40:00 INFO   rank_loss_weight = 0.0
2025-12-25 09:40:00 INFO   rank_loss_margin = 0.0
2025-12-25 09:40:00 INFO   rank_loss_mode = hinge
2025-12-25 09:40:00 INFO   rank_loss_grouped = True
2025-12-25 09:40:00 INFO   variance_reduction_enabled = False
2025-12-25 09:40:00 INFO   variance_reduction_method = topk_avg
2025-12-25 09:40:00 INFO   variance_reduction_top_k = 3
2025-12-25 09:40:00 INFO   coverage_minimum = 0.0
2025-12-25 09:40:00 INFO   coverage_fail_on_missing = False
2025-12-25 09:40:00 INFO   graph_load_profiling = False
2025-12-25 09:40:00 INFO   graph_load_top_k = 5
2025-12-25 09:40:00 INFO   enable_graph_cache = True
2025-12-25 09:40:00 INFO   graph_cache_size = 256
2025-12-25 09:40:00 INFO   canonicalize_on_load = False
2025-12-25 09:40:00 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-25 09:40:00 INFO   edge_schema = {}
2025-12-25 09:40:00 INFO   topology_schema = {}
Seed set to 101
2025-12-25 09:40:01 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-25 09:40:01 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 09:40:01 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-25 09:40:01 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 09:40:01 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-25 09:40:01 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 09:40:02 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-25 09:40:02 INFO Tuning group stats: groups=348 groups>=2=37 singletons=311 max_group=11
2025-12-25 09:40:02 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57/dataset_coverage.json
2025-12-25 09:40:02 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57/dataset_coverage.json for details.
2025-12-25 09:40:02 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57/dataset_coverage.json for details.
2025-12-25 09:40:02 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57/dataset_coverage.json for details.
2025-12-25 09:40:02 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57/schema_summary.json
2025-12-25 09:40:02 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57/feature_metadata.json
2025-12-25 09:40:02 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-25 09:40:02 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/null_topology/feature-config.yaml.null.10A, sha256=f618659ace5620de7e794485915dadd4243f3ec2ca6726b4a9af3989817a8579
2025-12-25 09:40:02 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/work/edge_features)
2025-12-25 09:40:02 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json
2025-12-25 09:40:02 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57/schema_summary.json
2025-12-25 09:40:02 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-25 09:40:02 INFO Topology: topology/persistence_null/v1 supporting the 172-dimensional node features.
2025-12-25 09:40:02 INFO Node: node/dssp_topo_merge/v1; metadata lists 172 feature columns matching the .pt tensor.
2025-12-25 09:40:02 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-25 09:40:02 INFO → Total feature dimensionality observed and confirmed: node_dim = 172, edge_dim = 11.
2025-12-25 09:40:02 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-25 09:40:02 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 172,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 172,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge/v1",
      "alias": "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA",
      "jobs": 16,
      "summary": "DSSP-derived node features merged with topology statistics."
    },
    "topology": {
      "id": "topology/persistence_null/v1",
      "alias": "Null topology (constant zeros) = 140D ablation",
      "jobs": 16,
      "summary": "Topology ablation: constant features with PH-compatible schema."
    }
  },
  "notes": []
}
2025-12-25 09:40:02 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-25 09:40:02 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=bbb7d942c33242b8b3799cd555dbdd93)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-25 09:40:02 INFO Starting training (fast_dev_run=False)
2025-12-25 09:40:02 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57/model_checkpoints exists and is not empty.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 5.5 K  | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
165 K     Trainable params
0         Non-trainable params
165 K     Total params
0.662     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-25 09:40:17 INFO Epoch 000 | 25% complete (batch 46/181)
2025-12-25 09:40:17 INFO Epoch 000 | 50% complete (batch 91/181)
2025-12-25 09:40:18 INFO Epoch 000 | 75% complete (batch 136/181)
2025-12-25 09:40:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.150340
2025-12-25 09:40:32 INFO Tuning ranking metrics: regret=0.160974 spearman=-0.120627 (groups=37, skipped=311)
2025-12-25 09:40:32 INFO Epoch 000 | val_loss=0.150340
Metric tuning_rank_spearman improved. New best score: -0.121
2025-12-25 09:40:40 INFO Epoch 001 | 25% complete (batch 46/181)
2025-12-25 09:40:41 INFO Epoch 001 | 50% complete (batch 91/181)
2025-12-25 09:40:42 INFO Epoch 001 | 75% complete (batch 136/181)
2025-12-25 09:40:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.265198
2025-12-25 09:40:55 INFO Tuning ranking metrics: regret=0.175517 spearman=-0.118217 (groups=37, skipped=311)
2025-12-25 09:40:55 INFO Epoch 001 | train_mse=0.142460 | val_loss=0.140104 | best_val_loss=-0.120627
Metric tuning_rank_spearman improved by 0.002 >= min_delta = 0.0. New best score: -0.118
2025-12-25 09:41:04 INFO Epoch 002 | 25% complete (batch 46/181)
2025-12-25 09:41:04 INFO Epoch 002 | 50% complete (batch 91/181)
2025-12-25 09:41:05 INFO Epoch 002 | 75% complete (batch 136/181)
2025-12-25 09:41:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.268476
2025-12-25 09:41:19 INFO Tuning ranking metrics: regret=0.163103 spearman=-0.173453 (groups=37, skipped=311)
2025-12-25 09:41:19 INFO Epoch 002 | train_mse=0.144948 | val_loss=0.138687 | best_val_loss=-0.118217
2025-12-25 09:41:27 INFO Epoch 003 | 25% complete (batch 46/181)
2025-12-25 09:41:28 INFO Epoch 003 | 50% complete (batch 91/181)
2025-12-25 09:41:29 INFO Epoch 003 | 75% complete (batch 136/181)
2025-12-25 09:41:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.300652
2025-12-25 09:41:43 INFO Tuning ranking metrics: regret=0.158479 spearman=-0.040915 (groups=37, skipped=311)
2025-12-25 09:41:43 INFO Epoch 003 | train_mse=0.146182 | val_loss=0.119723 | best_val_loss=-0.118217
Metric tuning_rank_spearman improved by 0.077 >= min_delta = 0.0. New best score: -0.041
2025-12-25 09:41:51 INFO Epoch 004 | 25% complete (batch 46/181)
2025-12-25 09:41:52 INFO Epoch 004 | 50% complete (batch 91/181)
2025-12-25 09:41:53 INFO Epoch 004 | 75% complete (batch 136/181)
2025-12-25 09:42:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.336043
2025-12-25 09:42:06 INFO Tuning ranking metrics: regret=0.145459 spearman=-0.160945 (groups=37, skipped=311)
2025-12-25 09:42:06 INFO Epoch 004 | train_mse=0.128498 | val_loss=0.112418 | best_val_loss=-0.040915
2025-12-25 09:42:15 INFO Epoch 005 | 25% complete (batch 46/181)
2025-12-25 09:42:16 INFO Epoch 005 | 50% complete (batch 91/181)
2025-12-25 09:42:17 INFO Epoch 005 | 75% complete (batch 136/181)
2025-12-25 09:42:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.364340
2025-12-25 09:42:30 INFO Tuning ranking metrics: regret=0.146370 spearman=-0.121452 (groups=37, skipped=311)
2025-12-25 09:42:30 INFO Epoch 005 | train_mse=0.127080 | val_loss=0.116214 | best_val_loss=-0.040915
2025-12-25 09:42:38 INFO Epoch 006 | 25% complete (batch 46/181)
2025-12-25 09:42:39 INFO Epoch 006 | 50% complete (batch 91/181)
2025-12-25 09:42:40 INFO Epoch 006 | 75% complete (batch 136/181)
2025-12-25 09:42:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.374769
2025-12-25 09:42:54 INFO Tuning ranking metrics: regret=0.130765 spearman=-0.040149 (groups=37, skipped=311)
2025-12-25 09:42:54 INFO Epoch 006 | train_mse=0.107499 | val_loss=0.108703 | best_val_loss=-0.040915
Metric tuning_rank_spearman improved by 0.001 >= min_delta = 0.0. New best score: -0.040
2025-12-25 09:43:02 INFO Epoch 007 | 25% complete (batch 46/181)
2025-12-25 09:43:03 INFO Epoch 007 | 50% complete (batch 91/181)
2025-12-25 09:43:04 INFO Epoch 007 | 75% complete (batch 136/181)
2025-12-25 09:43:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.412928
2025-12-25 09:43:17 INFO Tuning ranking metrics: regret=0.141212 spearman=-0.033959 (groups=37, skipped=311)
2025-12-25 09:43:17 INFO Epoch 007 | train_mse=0.106878 | val_loss=0.105705 | best_val_loss=-0.040149
Metric tuning_rank_spearman improved by 0.006 >= min_delta = 0.0. New best score: -0.034
2025-12-25 09:43:26 INFO Epoch 008 | 25% complete (batch 46/181)
2025-12-25 09:43:27 INFO Epoch 008 | 50% complete (batch 91/181)
2025-12-25 09:43:28 INFO Epoch 008 | 75% complete (batch 136/181)
2025-12-25 09:43:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.408760
2025-12-25 09:43:41 INFO Tuning ranking metrics: regret=0.108154 spearman=0.012110 (groups=37, skipped=311)
2025-12-25 09:43:41 INFO Epoch 008 | train_mse=0.086856 | val_loss=0.104876 | best_val_loss=-0.033959
Metric tuning_rank_spearman improved by 0.046 >= min_delta = 0.0. New best score: 0.012
2025-12-25 09:43:49 INFO Epoch 009 | 25% complete (batch 46/181)
2025-12-25 09:43:50 INFO Epoch 009 | 50% complete (batch 91/181)
2025-12-25 09:43:51 INFO Epoch 009 | 75% complete (batch 136/181)
2025-12-25 09:44:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.421701
2025-12-25 09:44:05 INFO Tuning ranking metrics: regret=0.125210 spearman=-0.051170 (groups=37, skipped=311)
2025-12-25 09:44:05 INFO Epoch 009 | train_mse=0.098473 | val_loss=0.102264 | best_val_loss=0.012110
2025-12-25 09:44:13 INFO Epoch 010 | 25% complete (batch 46/181)
2025-12-25 09:44:14 INFO Epoch 010 | 50% complete (batch 91/181)
2025-12-25 09:44:15 INFO Epoch 010 | 75% complete (batch 136/181)
2025-12-25 09:44:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.429753
2025-12-25 09:44:28 INFO Tuning ranking metrics: regret=0.130565 spearman=-0.079010 (groups=37, skipped=311)
2025-12-25 09:44:28 INFO Epoch 010 | train_mse=0.100133 | val_loss=0.112538 | best_val_loss=0.012110
2025-12-25 09:44:37 INFO Epoch 011 | 25% complete (batch 46/181)
2025-12-25 09:44:38 INFO Epoch 011 | 50% complete (batch 91/181)
2025-12-25 09:44:39 INFO Epoch 011 | 75% complete (batch 136/181)
2025-12-25 09:44:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.458362
2025-12-25 09:44:52 INFO Tuning ranking metrics: regret=0.110599 spearman=-0.085293 (groups=37, skipped=311)
2025-12-25 09:44:52 INFO Epoch 011 | train_mse=0.089803 | val_loss=0.102743 | best_val_loss=0.012110
2025-12-25 09:45:01 INFO Epoch 012 | 25% complete (batch 46/181)
2025-12-25 09:45:01 INFO Epoch 012 | 50% complete (batch 91/181)
2025-12-25 09:45:02 INFO Epoch 012 | 75% complete (batch 136/181)
2025-12-25 09:45:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.446585
2025-12-25 09:45:16 INFO Tuning ranking metrics: regret=0.099868 spearman=-0.048303 (groups=37, skipped=311)
2025-12-25 09:45:16 INFO Epoch 012 | train_mse=0.098445 | val_loss=0.107260 | best_val_loss=0.012110
2025-12-25 09:45:24 INFO Epoch 013 | 25% complete (batch 46/181)
2025-12-25 09:45:25 INFO Epoch 013 | 50% complete (batch 91/181)
2025-12-25 09:45:26 INFO Epoch 013 | 75% complete (batch 136/181)
2025-12-25 09:45:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.444847
2025-12-25 09:45:40 INFO Tuning ranking metrics: regret=0.117080 spearman=-0.040716 (groups=37, skipped=311)
2025-12-25 09:45:40 INFO Epoch 013 | train_mse=0.087356 | val_loss=0.099055 | best_val_loss=0.012110
2025-12-25 09:45:48 INFO Epoch 014 | 25% complete (batch 46/181)
2025-12-25 09:45:49 INFO Epoch 014 | 50% complete (batch 91/181)
2025-12-25 09:45:50 INFO Epoch 014 | 75% complete (batch 136/181)
2025-12-25 09:45:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.480475
2025-12-25 09:46:04 INFO Tuning ranking metrics: regret=0.114248 spearman=-0.001971 (groups=37, skipped=311)
2025-12-25 09:46:04 INFO Epoch 014 | train_mse=0.095591 | val_loss=0.100768 | best_val_loss=0.012110
2025-12-25 09:46:12 INFO Epoch 015 | 25% complete (batch 46/181)
2025-12-25 09:46:13 INFO Epoch 015 | 50% complete (batch 91/181)
2025-12-25 09:46:14 INFO Epoch 015 | 75% complete (batch 136/181)
2025-12-25 09:46:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.489470
2025-12-25 09:46:27 INFO Tuning ranking metrics: regret=0.114248 spearman=-0.014175 (groups=37, skipped=311)
2025-12-25 09:46:27 INFO Epoch 015 | train_mse=0.100925 | val_loss=0.101012 | best_val_loss=0.012110
2025-12-25 09:46:36 INFO Epoch 016 | 25% complete (batch 46/181)
2025-12-25 09:46:37 INFO Epoch 016 | 50% complete (batch 91/181)
2025-12-25 09:46:38 INFO Epoch 016 | 75% complete (batch 136/181)
2025-12-25 09:46:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.448600
2025-12-25 09:46:51 INFO Tuning ranking metrics: regret=0.110055 spearman=0.055844 (groups=37, skipped=311)
2025-12-25 09:46:51 INFO Epoch 016 | train_mse=0.132546 | val_loss=0.128534 | best_val_loss=0.012110
Metric tuning_rank_spearman improved by 0.044 >= min_delta = 0.0. New best score: 0.056
2025-12-25 09:47:00 INFO Epoch 017 | 25% complete (batch 46/181)
2025-12-25 09:47:01 INFO Epoch 017 | 50% complete (batch 91/181)
2025-12-25 09:47:02 INFO Epoch 017 | 75% complete (batch 136/181)
2025-12-25 09:47:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.464967
2025-12-25 09:47:16 INFO Tuning ranking metrics: regret=0.072705 spearman=0.010934 (groups=37, skipped=311)
2025-12-25 09:47:16 INFO Epoch 017 | train_mse=0.127772 | val_loss=0.096238 | best_val_loss=0.055844
2025-12-25 09:47:24 INFO Epoch 018 | 25% complete (batch 46/181)
2025-12-25 09:47:25 INFO Epoch 018 | 50% complete (batch 91/181)
2025-12-25 09:47:26 INFO Epoch 018 | 75% complete (batch 136/181)
2025-12-25 09:47:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.461745
2025-12-25 09:47:40 INFO Tuning ranking metrics: regret=0.106649 spearman=0.038458 (groups=37, skipped=311)
2025-12-25 09:47:40 INFO Epoch 018 | train_mse=0.089038 | val_loss=0.109621 | best_val_loss=0.055844
2025-12-25 09:47:48 INFO Epoch 019 | 25% complete (batch 46/181)
2025-12-25 09:47:50 INFO Epoch 019 | 50% complete (batch 91/181)
2025-12-25 09:47:51 INFO Epoch 019 | 75% complete (batch 136/181)
2025-12-25 09:47:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.472777
2025-12-25 09:48:04 INFO Tuning ranking metrics: regret=0.086645 spearman=0.077173 (groups=37, skipped=311)
2025-12-25 09:48:04 INFO Epoch 019 | train_mse=0.086277 | val_loss=0.091849 | best_val_loss=0.055844
Metric tuning_rank_spearman improved by 0.021 >= min_delta = 0.0. New best score: 0.077
2025-12-25 09:48:13 INFO Epoch 020 | 25% complete (batch 46/181)
2025-12-25 09:48:13 INFO Epoch 020 | 50% complete (batch 91/181)
2025-12-25 09:48:14 INFO Epoch 020 | 75% complete (batch 136/181)
2025-12-25 09:48:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.484570
2025-12-25 09:48:28 INFO Tuning ranking metrics: regret=0.103927 spearman=0.056733 (groups=37, skipped=311)
2025-12-25 09:48:28 INFO Epoch 020 | train_mse=0.086056 | val_loss=0.097393 | best_val_loss=0.077173
2025-12-25 09:48:37 INFO Epoch 021 | 25% complete (batch 46/181)
2025-12-25 09:48:37 INFO Epoch 021 | 50% complete (batch 91/181)
2025-12-25 09:48:38 INFO Epoch 021 | 75% complete (batch 136/181)
2025-12-25 09:48:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.463052
2025-12-25 09:48:52 INFO Tuning ranking metrics: regret=0.070395 spearman=0.074061 (groups=37, skipped=311)
2025-12-25 09:48:52 INFO Epoch 021 | train_mse=0.062890 | val_loss=0.111466 | best_val_loss=0.077173
2025-12-25 09:49:00 INFO Epoch 022 | 25% complete (batch 46/181)
2025-12-25 09:49:01 INFO Epoch 022 | 50% complete (batch 91/181)
2025-12-25 09:49:02 INFO Epoch 022 | 75% complete (batch 136/181)
2025-12-25 09:49:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.473628
2025-12-25 09:49:16 INFO Tuning ranking metrics: regret=0.092210 spearman=0.000807 (groups=37, skipped=311)
2025-12-25 09:49:16 INFO Epoch 022 | train_mse=0.098893 | val_loss=0.094167 | best_val_loss=0.077173
2025-12-25 09:49:25 INFO Epoch 023 | 25% complete (batch 46/181)
2025-12-25 09:49:26 INFO Epoch 023 | 50% complete (batch 91/181)
2025-12-25 09:49:26 INFO Epoch 023 | 75% complete (batch 136/181)
2025-12-25 09:49:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.489789
2025-12-25 09:49:40 INFO Tuning ranking metrics: regret=0.109161 spearman=0.017322 (groups=37, skipped=311)
2025-12-25 09:49:40 INFO Epoch 023 | train_mse=0.084512 | val_loss=0.097221 | best_val_loss=0.077173
2025-12-25 09:49:49 INFO Epoch 024 | 25% complete (batch 46/181)
2025-12-25 09:49:50 INFO Epoch 024 | 50% complete (batch 91/181)
2025-12-25 09:49:51 INFO Epoch 024 | 75% complete (batch 136/181)
2025-12-25 09:49:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.481767
2025-12-25 09:50:04 INFO Tuning ranking metrics: regret=0.092183 spearman=0.053832 (groups=37, skipped=311)
2025-12-25 09:50:04 INFO Epoch 024 | train_mse=0.089546 | val_loss=0.102091 | best_val_loss=0.077173
2025-12-25 09:50:13 INFO Epoch 025 | 25% complete (batch 46/181)
2025-12-25 09:50:14 INFO Epoch 025 | 50% complete (batch 91/181)
2025-12-25 09:50:15 INFO Epoch 025 | 75% complete (batch 136/181)
2025-12-25 09:50:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.475861
2025-12-25 09:50:29 INFO Tuning ranking metrics: regret=0.099728 spearman=0.055558 (groups=37, skipped=311)
2025-12-25 09:50:29 INFO Epoch 025 | train_mse=0.102028 | val_loss=0.105062 | best_val_loss=0.077173
2025-12-25 09:50:37 INFO Epoch 026 | 25% complete (batch 46/181)
2025-12-25 09:50:38 INFO Epoch 026 | 50% complete (batch 91/181)
2025-12-25 09:50:39 INFO Epoch 026 | 75% complete (batch 136/181)
2025-12-25 09:50:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.488041
2025-12-25 09:50:53 INFO Tuning ranking metrics: regret=0.104862 spearman=0.009957 (groups=37, skipped=311)
2025-12-25 09:50:53 INFO Epoch 026 | train_mse=0.093990 | val_loss=0.093470 | best_val_loss=0.077173
2025-12-25 09:51:01 INFO Epoch 027 | 25% complete (batch 46/181)
2025-12-25 09:51:02 INFO Epoch 027 | 50% complete (batch 91/181)
2025-12-25 09:51:03 INFO Epoch 027 | 75% complete (batch 136/181)
2025-12-25 09:51:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.499179
2025-12-25 09:51:16 INFO Tuning ranking metrics: regret=0.088510 spearman=0.076951 (groups=37, skipped=311)
2025-12-25 09:51:16 INFO Epoch 027 | train_mse=0.102183 | val_loss=0.092039 | best_val_loss=0.077173
2025-12-25 09:51:25 INFO Epoch 028 | 25% complete (batch 46/181)
2025-12-25 09:51:26 INFO Epoch 028 | 50% complete (batch 91/181)
2025-12-25 09:51:27 INFO Epoch 028 | 75% complete (batch 136/181)
2025-12-25 09:51:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.492840
2025-12-25 09:51:40 INFO Tuning ranking metrics: regret=0.068739 spearman=0.096303 (groups=37, skipped=311)
2025-12-25 09:51:40 INFO Epoch 028 | train_mse=0.086749 | val_loss=0.090749 | best_val_loss=0.077173
Metric tuning_rank_spearman improved by 0.019 >= min_delta = 0.0. New best score: 0.096
2025-12-25 09:51:48 INFO Epoch 029 | 25% complete (batch 46/181)
2025-12-25 09:51:49 INFO Epoch 029 | 50% complete (batch 91/181)
2025-12-25 09:51:50 INFO Epoch 029 | 75% complete (batch 136/181)
2025-12-25 09:51:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.487226
2025-12-25 09:52:04 INFO Tuning ranking metrics: regret=0.086941 spearman=0.048871 (groups=37, skipped=311)
2025-12-25 09:52:04 INFO Epoch 029 | train_mse=0.090641 | val_loss=0.092725 | best_val_loss=0.096303
2025-12-25 09:52:12 INFO Epoch 030 | 25% complete (batch 46/181)
2025-12-25 09:52:13 INFO Epoch 030 | 50% complete (batch 91/181)
2025-12-25 09:52:14 INFO Epoch 030 | 75% complete (batch 136/181)
2025-12-25 09:52:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.494246
2025-12-25 09:52:28 INFO Tuning ranking metrics: regret=0.140241 spearman=-0.000878 (groups=37, skipped=311)
2025-12-25 09:52:28 INFO Epoch 030 | train_mse=0.099694 | val_loss=0.090300 | best_val_loss=0.096303
2025-12-25 09:52:36 INFO Epoch 031 | 25% complete (batch 46/181)
2025-12-25 09:52:37 INFO Epoch 031 | 50% complete (batch 91/181)
2025-12-25 09:52:38 INFO Epoch 031 | 75% complete (batch 136/181)
2025-12-25 09:52:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.499345
2025-12-25 09:52:51 INFO Tuning ranking metrics: regret=0.145923 spearman=-0.082625 (groups=37, skipped=311)
2025-12-25 09:52:51 INFO Epoch 031 | train_mse=0.094190 | val_loss=0.091857 | best_val_loss=0.096303
2025-12-25 09:53:00 INFO Epoch 032 | 25% complete (batch 46/181)
2025-12-25 09:53:01 INFO Epoch 032 | 50% complete (batch 91/181)
2025-12-25 09:53:02 INFO Epoch 032 | 75% complete (batch 136/181)
2025-12-25 09:53:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.481302
2025-12-25 09:53:15 INFO Tuning ranking metrics: regret=0.119073 spearman=0.021709 (groups=37, skipped=311)
2025-12-25 09:53:15 INFO Epoch 032 | train_mse=0.087704 | val_loss=0.117479 | best_val_loss=0.096303
2025-12-25 09:53:24 INFO Epoch 033 | 25% complete (batch 46/181)
2025-12-25 09:53:25 INFO Epoch 033 | 50% complete (batch 91/181)
2025-12-25 09:53:26 INFO Epoch 033 | 75% complete (batch 136/181)
2025-12-25 09:53:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.464503
2025-12-25 09:53:39 INFO Tuning ranking metrics: regret=0.116586 spearman=0.018691 (groups=37, skipped=311)
2025-12-25 09:53:39 INFO Epoch 033 | train_mse=0.092827 | val_loss=0.133088 | best_val_loss=0.096303
2025-12-25 09:53:47 INFO Epoch 034 | 25% complete (batch 46/181)
2025-12-25 09:53:48 INFO Epoch 034 | 50% complete (batch 91/181)
2025-12-25 09:53:50 INFO Epoch 034 | 75% complete (batch 136/181)
2025-12-25 09:53:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.516329
2025-12-25 09:54:03 INFO Tuning ranking metrics: regret=0.146448 spearman=-0.042009 (groups=37, skipped=311)
2025-12-25 09:54:03 INFO Epoch 034 | train_mse=0.098024 | val_loss=0.096117 | best_val_loss=0.096303
2025-12-25 09:54:12 INFO Epoch 035 | 25% complete (batch 46/181)
2025-12-25 09:54:12 INFO Epoch 035 | 50% complete (batch 91/181)
2025-12-25 09:54:13 INFO Epoch 035 | 75% complete (batch 136/181)
2025-12-25 09:54:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.522860
2025-12-25 09:54:27 INFO Tuning ranking metrics: regret=0.148962 spearman=-0.057418 (groups=37, skipped=311)
2025-12-25 09:54:27 INFO Epoch 035 | train_mse=0.081467 | val_loss=0.082628 | best_val_loss=0.096303
2025-12-25 09:54:36 INFO Epoch 036 | 25% complete (batch 46/181)
2025-12-25 09:54:36 INFO Epoch 036 | 50% complete (batch 91/181)
2025-12-25 09:54:37 INFO Epoch 036 | 75% complete (batch 136/181)
2025-12-25 09:54:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.544435
2025-12-25 09:54:51 INFO Tuning ranking metrics: regret=0.131262 spearman=0.006967 (groups=37, skipped=311)
2025-12-25 09:54:51 INFO Epoch 036 | train_mse=0.087110 | val_loss=0.083991 | best_val_loss=0.096303
2025-12-25 09:55:00 INFO Epoch 037 | 25% complete (batch 46/181)
2025-12-25 09:55:01 INFO Epoch 037 | 50% complete (batch 91/181)
2025-12-25 09:55:02 INFO Epoch 037 | 75% complete (batch 136/181)
2025-12-25 09:55:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.527964
2025-12-25 09:55:16 INFO Tuning ranking metrics: regret=0.111484 spearman=-0.083041 (groups=37, skipped=311)
2025-12-25 09:55:16 INFO Epoch 037 | train_mse=0.084218 | val_loss=0.095968 | best_val_loss=0.096303
2025-12-25 09:55:24 INFO Epoch 038 | 25% complete (batch 46/181)
2025-12-25 09:55:25 INFO Epoch 038 | 50% complete (batch 91/181)
2025-12-25 09:55:26 INFO Epoch 038 | 75% complete (batch 136/181)
2025-12-25 09:55:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.525553
2025-12-25 09:55:40 INFO Tuning ranking metrics: regret=0.129232 spearman=-0.003253 (groups=37, skipped=311)
2025-12-25 09:55:40 INFO Epoch 038 | train_mse=0.088788 | val_loss=0.088084 | best_val_loss=0.096303
2025-12-25 09:55:48 INFO Epoch 039 | 25% complete (batch 46/181)
2025-12-25 09:55:49 INFO Epoch 039 | 50% complete (batch 91/181)
2025-12-25 09:55:50 INFO Epoch 039 | 75% complete (batch 136/181)
2025-12-25 09:55:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.513754
2025-12-25 09:56:04 INFO Tuning ranking metrics: regret=0.131381 spearman=-0.130367 (groups=37, skipped=311)
2025-12-25 09:56:04 INFO Epoch 039 | train_mse=0.082391 | val_loss=0.098709 | best_val_loss=0.096303
2025-12-25 09:56:12 INFO Epoch 040 | 25% complete (batch 46/181)
2025-12-25 09:56:13 INFO Epoch 040 | 50% complete (batch 91/181)
2025-12-25 09:56:14 INFO Epoch 040 | 75% complete (batch 136/181)
2025-12-25 09:56:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.511686
2025-12-25 09:56:28 INFO Tuning ranking metrics: regret=0.132460 spearman=-0.128431 (groups=37, skipped=311)
2025-12-25 09:56:28 INFO Epoch 040 | train_mse=0.073161 | val_loss=0.105372 | best_val_loss=0.096303
2025-12-25 09:56:36 INFO Epoch 041 | 25% complete (batch 46/181)
2025-12-25 09:56:37 INFO Epoch 041 | 50% complete (batch 91/181)
2025-12-25 09:56:38 INFO Epoch 041 | 75% complete (batch 136/181)
2025-12-25 09:56:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.520707
2025-12-25 09:56:51 INFO Tuning ranking metrics: regret=0.128270 spearman=-0.038007 (groups=37, skipped=311)
2025-12-25 09:56:51 INFO Epoch 041 | train_mse=0.086150 | val_loss=0.110385 | best_val_loss=0.096303
2025-12-25 09:57:00 INFO Epoch 042 | 25% complete (batch 46/181)
2025-12-25 09:57:01 INFO Epoch 042 | 50% complete (batch 91/181)
2025-12-25 09:57:02 INFO Epoch 042 | 75% complete (batch 136/181)
2025-12-25 09:57:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.516385
2025-12-25 09:57:15 INFO Tuning ranking metrics: regret=0.127422 spearman=-0.034246 (groups=37, skipped=311)
2025-12-25 09:57:15 INFO Epoch 042 | train_mse=0.076782 | val_loss=0.094787 | best_val_loss=0.096303
2025-12-25 09:57:24 INFO Epoch 043 | 25% complete (batch 46/181)
2025-12-25 09:57:24 INFO Epoch 043 | 50% complete (batch 91/181)
2025-12-25 09:57:25 INFO Epoch 043 | 75% complete (batch 136/181)
2025-12-25 09:57:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.499641
2025-12-25 09:57:39 INFO Tuning ranking metrics: regret=0.108483 spearman=-0.017339 (groups=37, skipped=311)
2025-12-25 09:57:39 INFO Epoch 043 | train_mse=0.068113 | val_loss=0.119412 | best_val_loss=0.096303
2025-12-25 09:57:48 INFO Epoch 044 | 25% complete (batch 46/181)
2025-12-25 09:57:48 INFO Epoch 044 | 50% complete (batch 91/181)
2025-12-25 09:57:49 INFO Epoch 044 | 75% complete (batch 136/181)
2025-12-25 09:57:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.505313
2025-12-25 09:58:03 INFO Tuning ranking metrics: regret=0.087221 spearman=0.092939 (groups=37, skipped=311)
2025-12-25 09:58:03 INFO Epoch 044 | train_mse=0.075309 | val_loss=0.116373 | best_val_loss=0.096303
2025-12-25 09:58:11 INFO Epoch 045 | 25% complete (batch 46/181)
2025-12-25 09:58:12 INFO Epoch 045 | 50% complete (batch 91/181)
2025-12-25 09:58:13 INFO Epoch 045 | 75% complete (batch 136/181)
2025-12-25 09:58:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.516049
2025-12-25 09:58:27 INFO Tuning ranking metrics: regret=0.115308 spearman=-0.006359 (groups=37, skipped=311)
2025-12-25 09:58:27 INFO Epoch 045 | train_mse=0.099330 | val_loss=0.086940 | best_val_loss=0.096303
2025-12-25 09:58:35 INFO Epoch 046 | 25% complete (batch 46/181)
2025-12-25 09:58:36 INFO Epoch 046 | 50% complete (batch 91/181)
2025-12-25 09:58:37 INFO Epoch 046 | 75% complete (batch 136/181)
2025-12-25 09:58:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.539293
2025-12-25 09:58:51 INFO Tuning ranking metrics: regret=0.149458 spearman=-0.122955 (groups=37, skipped=311)
2025-12-25 09:58:51 INFO Epoch 046 | train_mse=0.080747 | val_loss=0.079793 | best_val_loss=0.096303
2025-12-25 09:58:59 INFO Epoch 047 | 25% complete (batch 46/181)
2025-12-25 09:59:00 INFO Epoch 047 | 50% complete (batch 91/181)
2025-12-25 09:59:01 INFO Epoch 047 | 75% complete (batch 136/181)
2025-12-25 09:59:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.544609
2025-12-25 09:59:15 INFO Tuning ranking metrics: regret=0.087983 spearman=0.010565 (groups=37, skipped=311)
2025-12-25 09:59:15 INFO Epoch 047 | train_mse=0.080381 | val_loss=0.092888 | best_val_loss=0.096303
2025-12-25 09:59:23 INFO Epoch 048 | 25% complete (batch 46/181)
2025-12-25 09:59:24 INFO Epoch 048 | 50% complete (batch 91/181)
2025-12-25 09:59:25 INFO Epoch 048 | 75% complete (batch 136/181)
2025-12-25 09:59:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.506334
2025-12-25 09:59:39 INFO Tuning ranking metrics: regret=0.145156 spearman=-0.019153 (groups=37, skipped=311)
2025-12-25 09:59:39 INFO Epoch 048 | train_mse=0.080758 | val_loss=0.099355 | best_val_loss=0.096303
2025-12-25 09:59:47 INFO Epoch 049 | 25% complete (batch 46/181)
2025-12-25 09:59:48 INFO Epoch 049 | 50% complete (batch 91/181)
2025-12-25 09:59:49 INFO Epoch 049 | 75% complete (batch 136/181)
2025-12-25 09:59:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.511338
2025-12-25 10:00:02 INFO Tuning ranking metrics: regret=0.149043 spearman=0.043676 (groups=37, skipped=311)
2025-12-25 10:00:02 INFO Epoch 049 | train_mse=0.074494 | val_loss=0.092742 | best_val_loss=0.096303
2025-12-25 10:00:11 INFO Epoch 050 | 25% complete (batch 46/181)
2025-12-25 10:00:12 INFO Epoch 050 | 50% complete (batch 91/181)
2025-12-25 10:00:13 INFO Epoch 050 | 75% complete (batch 136/181)
2025-12-25 10:00:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.544631
2025-12-25 10:00:27 INFO Tuning ranking metrics: regret=0.109582 spearman=0.026015 (groups=37, skipped=311)
2025-12-25 10:00:27 INFO Epoch 050 | train_mse=0.094484 | val_loss=0.085489 | best_val_loss=0.096303
2025-12-25 10:00:35 INFO Epoch 051 | 25% complete (batch 46/181)
2025-12-25 10:00:36 INFO Epoch 051 | 50% complete (batch 91/181)
2025-12-25 10:00:37 INFO Epoch 051 | 75% complete (batch 136/181)
2025-12-25 10:00:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.549910
2025-12-25 10:00:51 INFO Tuning ranking metrics: regret=0.149597 spearman=0.022212 (groups=37, skipped=311)
2025-12-25 10:00:51 INFO Epoch 051 | train_mse=0.068780 | val_loss=0.077845 | best_val_loss=0.096303
2025-12-25 10:00:59 INFO Epoch 052 | 25% complete (batch 46/181)
2025-12-25 10:01:00 INFO Epoch 052 | 50% complete (batch 91/181)
2025-12-25 10:01:01 INFO Epoch 052 | 75% complete (batch 136/181)
2025-12-25 10:01:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.531383
2025-12-25 10:01:14 INFO Tuning ranking metrics: regret=0.149338 spearman=0.028484 (groups=37, skipped=311)
2025-12-25 10:01:14 INFO Epoch 052 | train_mse=0.080552 | val_loss=0.101503 | best_val_loss=0.096303
2025-12-25 10:01:23 INFO Epoch 053 | 25% complete (batch 46/181)
2025-12-25 10:01:24 INFO Epoch 053 | 50% complete (batch 91/181)
2025-12-25 10:01:25 INFO Epoch 053 | 75% complete (batch 136/181)
2025-12-25 10:01:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.543850
2025-12-25 10:01:39 INFO Tuning ranking metrics: regret=0.130677 spearman=0.082707 (groups=37, skipped=311)
2025-12-25 10:01:39 INFO Epoch 053 | train_mse=0.067731 | val_loss=0.088952 | best_val_loss=0.096303
2025-12-25 10:01:47 INFO Epoch 054 | 25% complete (batch 46/181)
2025-12-25 10:01:48 INFO Epoch 054 | 50% complete (batch 91/181)
2025-12-25 10:01:49 INFO Epoch 054 | 75% complete (batch 136/181)
2025-12-25 10:01:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.526874
2025-12-25 10:02:02 INFO Tuning ranking metrics: regret=0.152811 spearman=-0.058687 (groups=37, skipped=311)
2025-12-25 10:02:02 INFO Epoch 054 | train_mse=0.072101 | val_loss=0.091659 | best_val_loss=0.096303
2025-12-25 10:02:11 INFO Epoch 055 | 25% complete (batch 46/181)
2025-12-25 10:02:12 INFO Epoch 055 | 50% complete (batch 91/181)
2025-12-25 10:02:13 INFO Epoch 055 | 75% complete (batch 136/181)
2025-12-25 10:02:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.547749
2025-12-25 10:02:26 INFO Tuning ranking metrics: regret=0.144065 spearman=0.039107 (groups=37, skipped=311)
2025-12-25 10:02:26 INFO Epoch 055 | train_mse=0.062817 | val_loss=0.084081 | best_val_loss=0.096303
2025-12-25 10:02:35 INFO Epoch 056 | 25% complete (batch 46/181)
2025-12-25 10:02:36 INFO Epoch 056 | 50% complete (batch 91/181)
2025-12-25 10:02:37 INFO Epoch 056 | 75% complete (batch 136/181)
2025-12-25 10:02:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.540888
2025-12-25 10:02:51 INFO Tuning ranking metrics: regret=0.143666 spearman=0.007886 (groups=37, skipped=311)
2025-12-25 10:02:51 INFO Epoch 056 | train_mse=0.084917 | val_loss=0.091864 | best_val_loss=0.096303
2025-12-25 10:02:59 INFO Epoch 057 | 25% complete (batch 46/181)
2025-12-25 10:03:00 INFO Epoch 057 | 50% complete (batch 91/181)
2025-12-25 10:03:01 INFO Epoch 057 | 75% complete (batch 136/181)
2025-12-25 10:03:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.538111
2025-12-25 10:03:15 INFO Tuning ranking metrics: regret=0.149753 spearman=0.095244 (groups=37, skipped=311)
2025-12-25 10:03:15 INFO Epoch 057 | train_mse=0.082877 | val_loss=0.082048 | best_val_loss=0.096303
2025-12-25 10:03:23 INFO Epoch 058 | 25% complete (batch 46/181)
2025-12-25 10:03:24 INFO Epoch 058 | 50% complete (batch 91/181)
2025-12-25 10:03:25 INFO Epoch 058 | 75% complete (batch 136/181)
2025-12-25 10:03:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.540368
2025-12-25 10:03:39 INFO Tuning ranking metrics: regret=0.145289 spearman=0.078683 (groups=37, skipped=311)
2025-12-25 10:03:39 INFO Epoch 058 | train_mse=0.065500 | val_loss=0.092518 | best_val_loss=0.096303
2025-12-25 10:03:47 INFO Epoch 059 | 25% complete (batch 46/181)
2025-12-25 10:03:48 INFO Epoch 059 | 50% complete (batch 91/181)
2025-12-25 10:03:49 INFO Epoch 059 | 75% complete (batch 136/181)
2025-12-25 10:03:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.516559
2025-12-25 10:04:03 INFO Tuning ranking metrics: regret=0.135762 spearman=-0.050597 (groups=37, skipped=311)
2025-12-25 10:04:03 INFO Epoch 059 | train_mse=0.068727 | val_loss=0.082523 | best_val_loss=0.096303
2025-12-25 10:04:11 INFO Epoch 060 | 25% complete (batch 46/181)
2025-12-25 10:04:12 INFO Epoch 060 | 50% complete (batch 91/181)
2025-12-25 10:04:13 INFO Epoch 060 | 75% complete (batch 136/181)
2025-12-25 10:04:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.540525
2025-12-25 10:04:27 INFO Tuning ranking metrics: regret=0.130282 spearman=0.036241 (groups=37, skipped=311)
2025-12-25 10:04:27 INFO Epoch 060 | train_mse=0.055871 | val_loss=0.086677 | best_val_loss=0.096303
2025-12-25 10:04:35 INFO Epoch 061 | 25% complete (batch 46/181)
2025-12-25 10:04:36 INFO Epoch 061 | 50% complete (batch 91/181)
2025-12-25 10:04:37 INFO Epoch 061 | 75% complete (batch 136/181)
2025-12-25 10:04:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.523726
2025-12-25 10:04:51 INFO Tuning ranking metrics: regret=0.110006 spearman=-0.001305 (groups=37, skipped=311)
2025-12-25 10:04:51 INFO Epoch 061 | train_mse=0.070319 | val_loss=0.105354 | best_val_loss=0.096303
2025-12-25 10:04:59 INFO Epoch 062 | 25% complete (batch 46/181)
2025-12-25 10:05:00 INFO Epoch 062 | 50% complete (batch 91/181)
2025-12-25 10:05:01 INFO Epoch 062 | 75% complete (batch 136/181)
2025-12-25 10:05:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.517942
2025-12-25 10:05:15 INFO Tuning ranking metrics: regret=0.113041 spearman=0.064643 (groups=37, skipped=311)
2025-12-25 10:05:15 INFO Epoch 062 | train_mse=0.099441 | val_loss=0.085953 | best_val_loss=0.096303
2025-12-25 10:05:23 INFO Epoch 063 | 25% complete (batch 46/181)
2025-12-25 10:05:24 INFO Epoch 063 | 50% complete (batch 91/181)
2025-12-25 10:05:25 INFO Epoch 063 | 75% complete (batch 136/181)
2025-12-25 10:05:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.534703
2025-12-25 10:05:38 INFO Tuning ranking metrics: regret=0.103781 spearman=0.129244 (groups=37, skipped=311)
2025-12-25 10:05:38 INFO Epoch 063 | train_mse=0.079193 | val_loss=0.082723 | best_val_loss=0.096303
Metric tuning_rank_spearman improved by 0.033 >= min_delta = 0.0. New best score: 0.129
2025-12-25 10:05:47 INFO Epoch 064 | 25% complete (batch 46/181)
2025-12-25 10:05:48 INFO Epoch 064 | 50% complete (batch 91/181)
2025-12-25 10:05:49 INFO Epoch 064 | 75% complete (batch 136/181)
2025-12-25 10:05:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.530840
2025-12-25 10:06:03 INFO Tuning ranking metrics: regret=0.114301 spearman=0.154124 (groups=37, skipped=311)
2025-12-25 10:06:03 INFO Epoch 064 | train_mse=0.077284 | val_loss=0.092539 | best_val_loss=0.129244
Metric tuning_rank_spearman improved by 0.025 >= min_delta = 0.0. New best score: 0.154
2025-12-25 10:06:11 INFO Epoch 065 | 25% complete (batch 46/181)
2025-12-25 10:06:12 INFO Epoch 065 | 50% complete (batch 91/181)
2025-12-25 10:06:13 INFO Epoch 065 | 75% complete (batch 136/181)
2025-12-25 10:06:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.525017
2025-12-25 10:06:27 INFO Tuning ranking metrics: regret=0.094655 spearman=0.180765 (groups=37, skipped=311)
2025-12-25 10:06:27 INFO Epoch 065 | train_mse=0.074416 | val_loss=0.091856 | best_val_loss=0.154124
Metric tuning_rank_spearman improved by 0.027 >= min_delta = 0.0. New best score: 0.181
2025-12-25 10:06:35 INFO Epoch 066 | 25% complete (batch 46/181)
2025-12-25 10:06:36 INFO Epoch 066 | 50% complete (batch 91/181)
2025-12-25 10:06:37 INFO Epoch 066 | 75% complete (batch 136/181)
2025-12-25 10:06:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.501158
2025-12-25 10:06:50 INFO Tuning ranking metrics: regret=0.086535 spearman=0.172926 (groups=37, skipped=311)
2025-12-25 10:06:50 INFO Epoch 066 | train_mse=0.088287 | val_loss=0.092576 | best_val_loss=0.180765
2025-12-25 10:06:59 INFO Epoch 067 | 25% complete (batch 46/181)
2025-12-25 10:07:00 INFO Epoch 067 | 50% complete (batch 91/181)
2025-12-25 10:07:01 INFO Epoch 067 | 75% complete (batch 136/181)
2025-12-25 10:07:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.514351
2025-12-25 10:07:14 INFO Tuning ranking metrics: regret=0.161836 spearman=-0.002211 (groups=37, skipped=311)
2025-12-25 10:07:14 INFO Epoch 067 | train_mse=0.081395 | val_loss=0.094088 | best_val_loss=0.180765
2025-12-25 10:07:23 INFO Epoch 068 | 25% complete (batch 46/181)
2025-12-25 10:07:24 INFO Epoch 068 | 50% complete (batch 91/181)
2025-12-25 10:07:24 INFO Epoch 068 | 75% complete (batch 136/181)
2025-12-25 10:07:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.544459
2025-12-25 10:07:38 INFO Tuning ranking metrics: regret=0.142587 spearman=-0.056043 (groups=37, skipped=311)
2025-12-25 10:07:38 INFO Epoch 068 | train_mse=0.086740 | val_loss=0.080999 | best_val_loss=0.180765
2025-12-25 10:07:47 INFO Epoch 069 | 25% complete (batch 46/181)
2025-12-25 10:07:47 INFO Epoch 069 | 50% complete (batch 91/181)
2025-12-25 10:07:48 INFO Epoch 069 | 75% complete (batch 136/181)
2025-12-25 10:07:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.560599
2025-12-25 10:08:02 INFO Tuning ranking metrics: regret=0.109118 spearman=-0.066322 (groups=37, skipped=311)
2025-12-25 10:08:02 INFO Epoch 069 | train_mse=0.079699 | val_loss=0.078139 | best_val_loss=0.180765
2025-12-25 10:08:10 INFO Epoch 070 | 25% complete (batch 46/181)
2025-12-25 10:08:11 INFO Epoch 070 | 50% complete (batch 91/181)
2025-12-25 10:08:12 INFO Epoch 070 | 75% complete (batch 136/181)
2025-12-25 10:08:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.573022
2025-12-25 10:08:26 INFO Tuning ranking metrics: regret=0.112609 spearman=-0.032538 (groups=37, skipped=311)
2025-12-25 10:08:26 INFO Epoch 070 | train_mse=0.079044 | val_loss=0.079482 | best_val_loss=0.180765
2025-12-25 10:08:35 INFO Epoch 071 | 25% complete (batch 46/181)
2025-12-25 10:08:36 INFO Epoch 071 | 50% complete (batch 91/181)
2025-12-25 10:08:37 INFO Epoch 071 | 75% complete (batch 136/181)
2025-12-25 10:08:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.539493
2025-12-25 10:08:51 INFO Tuning ranking metrics: regret=0.114232 spearman=-0.060846 (groups=37, skipped=311)
2025-12-25 10:08:51 INFO Epoch 071 | train_mse=0.074493 | val_loss=0.082495 | best_val_loss=0.180765
2025-12-25 10:09:00 INFO Epoch 072 | 25% complete (batch 46/181)
2025-12-25 10:09:01 INFO Epoch 072 | 50% complete (batch 91/181)
2025-12-25 10:09:01 INFO Epoch 072 | 75% complete (batch 136/181)
2025-12-25 10:09:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.537001
2025-12-25 10:09:15 INFO Tuning ranking metrics: regret=0.111816 spearman=-0.108635 (groups=37, skipped=311)
2025-12-25 10:09:15 INFO Epoch 072 | train_mse=0.074741 | val_loss=0.085908 | best_val_loss=0.180765
2025-12-25 10:09:24 INFO Epoch 073 | 25% complete (batch 46/181)
2025-12-25 10:09:25 INFO Epoch 073 | 50% complete (batch 91/181)
2025-12-25 10:09:25 INFO Epoch 073 | 75% complete (batch 136/181)
2025-12-25 10:09:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.568139
2025-12-25 10:09:39 INFO Tuning ranking metrics: regret=0.107746 spearman=0.040599 (groups=37, skipped=311)
2025-12-25 10:09:39 INFO Epoch 073 | train_mse=0.065441 | val_loss=0.089395 | best_val_loss=0.180765
2025-12-25 10:09:48 INFO Epoch 074 | 25% complete (batch 46/181)
2025-12-25 10:09:49 INFO Epoch 074 | 50% complete (batch 91/181)
2025-12-25 10:09:50 INFO Epoch 074 | 75% complete (batch 136/181)
2025-12-25 10:09:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.570185
2025-12-25 10:10:03 INFO Tuning ranking metrics: regret=0.115736 spearman=-0.068322 (groups=37, skipped=311)
2025-12-25 10:10:03 INFO Epoch 074 | train_mse=0.075371 | val_loss=0.078764 | best_val_loss=0.180765
2025-12-25 10:10:12 INFO Epoch 075 | 25% complete (batch 46/181)
2025-12-25 10:10:13 INFO Epoch 075 | 50% complete (batch 91/181)
2025-12-25 10:10:14 INFO Epoch 075 | 75% complete (batch 136/181)
2025-12-25 10:10:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.564771
2025-12-25 10:10:27 INFO Tuning ranking metrics: regret=0.115738 spearman=-0.080338 (groups=37, skipped=311)
2025-12-25 10:10:27 INFO Epoch 075 | train_mse=0.074002 | val_loss=0.084162 | best_val_loss=0.180765
2025-12-25 10:10:36 INFO Epoch 076 | 25% complete (batch 46/181)
2025-12-25 10:10:37 INFO Epoch 076 | 50% complete (batch 91/181)
2025-12-25 10:10:38 INFO Epoch 076 | 75% complete (batch 136/181)
2025-12-25 10:10:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.569186
2025-12-25 10:10:52 INFO Tuning ranking metrics: regret=0.113655 spearman=-0.142377 (groups=37, skipped=311)
2025-12-25 10:10:52 INFO Epoch 076 | train_mse=0.062954 | val_loss=0.072302 | best_val_loss=0.180765
2025-12-25 10:11:01 INFO Epoch 077 | 25% complete (batch 46/181)
2025-12-25 10:11:01 INFO Epoch 077 | 50% complete (batch 91/181)
2025-12-25 10:11:02 INFO Epoch 077 | 75% complete (batch 136/181)
2025-12-25 10:11:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.578277
2025-12-25 10:11:16 INFO Tuning ranking metrics: regret=0.110433 spearman=-0.077366 (groups=37, skipped=311)
2025-12-25 10:11:16 INFO Epoch 077 | train_mse=0.067219 | val_loss=0.081000 | best_val_loss=0.180765
2025-12-25 10:11:25 INFO Epoch 078 | 25% complete (batch 46/181)
2025-12-25 10:11:25 INFO Epoch 078 | 50% complete (batch 91/181)
2025-12-25 10:11:26 INFO Epoch 078 | 75% complete (batch 136/181)
2025-12-25 10:11:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.574444
2025-12-25 10:11:40 INFO Tuning ranking metrics: regret=0.110433 spearman=-0.075892 (groups=37, skipped=311)
2025-12-25 10:11:40 INFO Epoch 078 | train_mse=0.067401 | val_loss=0.083140 | best_val_loss=0.180765
2025-12-25 10:11:49 INFO Epoch 079 | 25% complete (batch 46/181)
2025-12-25 10:11:50 INFO Epoch 079 | 50% complete (batch 91/181)
2025-12-25 10:11:51 INFO Epoch 079 | 75% complete (batch 136/181)
2025-12-25 10:11:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.599128
2025-12-25 10:12:05 INFO Tuning ranking metrics: regret=0.112279 spearman=-0.140728 (groups=37, skipped=311)
2025-12-25 10:12:05 INFO Epoch 079 | train_mse=0.061571 | val_loss=0.074385 | best_val_loss=0.180765
2025-12-25 10:12:13 INFO Epoch 080 | 25% complete (batch 46/181)
2025-12-25 10:12:14 INFO Epoch 080 | 50% complete (batch 91/181)
2025-12-25 10:12:15 INFO Epoch 080 | 75% complete (batch 136/181)
2025-12-25 10:12:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.591376
2025-12-25 10:12:29 INFO Tuning ranking metrics: regret=0.110986 spearman=-0.098450 (groups=37, skipped=311)
2025-12-25 10:12:29 INFO Epoch 080 | train_mse=0.056203 | val_loss=0.077341 | best_val_loss=0.180765
2025-12-25 10:12:37 INFO Epoch 081 | 25% complete (batch 46/181)
2025-12-25 10:12:38 INFO Epoch 081 | 50% complete (batch 91/181)
2025-12-25 10:12:39 INFO Epoch 081 | 75% complete (batch 136/181)
2025-12-25 10:12:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.579289
2025-12-25 10:12:52 INFO Tuning ranking metrics: regret=0.105968 spearman=-0.060068 (groups=37, skipped=311)
2025-12-25 10:12:52 INFO Epoch 081 | train_mse=0.087565 | val_loss=0.074774 | best_val_loss=0.180765
2025-12-25 10:13:01 INFO Epoch 082 | 25% complete (batch 46/181)
2025-12-25 10:13:02 INFO Epoch 082 | 50% complete (batch 91/181)
2025-12-25 10:13:03 INFO Epoch 082 | 75% complete (batch 136/181)
2025-12-25 10:13:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.576850
2025-12-25 10:13:16 INFO Tuning ranking metrics: regret=0.111757 spearman=0.026173 (groups=37, skipped=311)
2025-12-25 10:13:16 INFO Epoch 082 | train_mse=0.074630 | val_loss=0.078890 | best_val_loss=0.180765
2025-12-25 10:13:25 INFO Epoch 083 | 25% complete (batch 46/181)
2025-12-25 10:13:26 INFO Epoch 083 | 50% complete (batch 91/181)
2025-12-25 10:13:27 INFO Epoch 083 | 75% complete (batch 136/181)
2025-12-25 10:13:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.566886
2025-12-25 10:13:40 INFO Tuning ranking metrics: regret=0.105757 spearman=0.001176 (groups=37, skipped=311)
2025-12-25 10:13:40 INFO Epoch 083 | train_mse=0.059696 | val_loss=0.074535 | best_val_loss=0.180765
2025-12-25 10:13:49 INFO Epoch 084 | 25% complete (batch 46/181)
2025-12-25 10:13:50 INFO Epoch 084 | 50% complete (batch 91/181)
2025-12-25 10:13:50 INFO Epoch 084 | 75% complete (batch 136/181)
2025-12-25 10:13:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.577709
2025-12-25 10:14:04 INFO Tuning ranking metrics: regret=0.122743 spearman=-0.076155 (groups=37, skipped=311)
2025-12-25 10:14:04 INFO Epoch 084 | train_mse=0.056142 | val_loss=0.072917 | best_val_loss=0.180765
2025-12-25 10:14:13 INFO Epoch 085 | 25% complete (batch 46/181)
2025-12-25 10:14:14 INFO Epoch 085 | 50% complete (batch 91/181)
2025-12-25 10:14:15 INFO Epoch 085 | 75% complete (batch 136/181)
2025-12-25 10:14:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.588429
2025-12-25 10:14:28 INFO Tuning ranking metrics: regret=0.123801 spearman=0.055095 (groups=37, skipped=311)
2025-12-25 10:14:28 INFO Epoch 085 | train_mse=0.074332 | val_loss=0.076483 | best_val_loss=0.180765
2025-12-25 10:14:36 INFO Epoch 086 | 25% complete (batch 46/181)
2025-12-25 10:14:37 INFO Epoch 086 | 50% complete (batch 91/181)
2025-12-25 10:14:38 INFO Epoch 086 | 75% complete (batch 136/181)
2025-12-25 10:14:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.569908
2025-12-25 10:14:52 INFO Tuning ranking metrics: regret=0.123801 spearman=0.050638 (groups=37, skipped=311)
2025-12-25 10:14:52 INFO Epoch 086 | train_mse=0.066906 | val_loss=0.076157 | best_val_loss=0.180765
2025-12-25 10:15:00 INFO Epoch 087 | 25% complete (batch 46/181)
2025-12-25 10:15:01 INFO Epoch 087 | 50% complete (batch 91/181)
2025-12-25 10:15:02 INFO Epoch 087 | 75% complete (batch 136/181)
2025-12-25 10:15:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.571587
2025-12-25 10:15:16 INFO Tuning ranking metrics: regret=0.126908 spearman=0.038376 (groups=37, skipped=311)
2025-12-25 10:15:16 INFO Epoch 087 | train_mse=0.060366 | val_loss=0.080782 | best_val_loss=0.180765
2025-12-25 10:15:24 INFO Epoch 088 | 25% complete (batch 46/181)
2025-12-25 10:15:25 INFO Epoch 088 | 50% complete (batch 91/181)
2025-12-25 10:15:26 INFO Epoch 088 | 75% complete (batch 136/181)
2025-12-25 10:15:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.569595
2025-12-25 10:15:39 INFO Tuning ranking metrics: regret=0.127653 spearman=0.046999 (groups=37, skipped=311)
2025-12-25 10:15:39 INFO Epoch 088 | train_mse=0.068681 | val_loss=0.079505 | best_val_loss=0.180765
2025-12-25 10:15:48 INFO Epoch 089 | 25% complete (batch 46/181)
2025-12-25 10:15:49 INFO Epoch 089 | 50% complete (batch 91/181)
2025-12-25 10:15:50 INFO Epoch 089 | 75% complete (batch 136/181)
2025-12-25 10:15:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.580325
2025-12-25 10:16:04 INFO Tuning ranking metrics: regret=0.127653 spearman=0.046075 (groups=37, skipped=311)
2025-12-25 10:16:04 INFO Epoch 089 | train_mse=0.077762 | val_loss=0.081888 | best_val_loss=0.180765
2025-12-25 10:16:12 INFO Epoch 090 | 25% complete (batch 46/181)
2025-12-25 10:16:13 INFO Epoch 090 | 50% complete (batch 91/181)
2025-12-25 10:16:14 INFO Epoch 090 | 75% complete (batch 136/181)
2025-12-25 10:16:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.561024
2025-12-25 10:16:27 INFO Tuning ranking metrics: regret=0.127955 spearman=0.011636 (groups=37, skipped=311)
2025-12-25 10:16:27 INFO Epoch 090 | train_mse=0.051507 | val_loss=0.093693 | best_val_loss=0.180765
2025-12-25 10:16:36 INFO Epoch 091 | 25% complete (batch 46/181)
2025-12-25 10:16:37 INFO Epoch 091 | 50% complete (batch 91/181)
2025-12-25 10:16:38 INFO Epoch 091 | 75% complete (batch 136/181)
2025-12-25 10:16:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.586568
2025-12-25 10:16:51 INFO Tuning ranking metrics: regret=0.126899 spearman=0.035866 (groups=37, skipped=311)
2025-12-25 10:16:51 INFO Epoch 091 | train_mse=0.053630 | val_loss=0.070447 | best_val_loss=0.180765
2025-12-25 10:17:00 INFO Epoch 092 | 25% complete (batch 46/181)
2025-12-25 10:17:01 INFO Epoch 092 | 50% complete (batch 91/181)
2025-12-25 10:17:02 INFO Epoch 092 | 75% complete (batch 136/181)
2025-12-25 10:17:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.600976
2025-12-25 10:17:15 INFO Tuning ranking metrics: regret=0.127020 spearman=0.014040 (groups=37, skipped=311)
2025-12-25 10:17:15 INFO Epoch 092 | train_mse=0.073773 | val_loss=0.068849 | best_val_loss=0.180765
2025-12-25 10:17:24 INFO Epoch 093 | 25% complete (batch 46/181)
2025-12-25 10:17:25 INFO Epoch 093 | 50% complete (batch 91/181)
2025-12-25 10:17:25 INFO Epoch 093 | 75% complete (batch 136/181)
2025-12-25 10:17:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.600885
2025-12-25 10:17:39 INFO Tuning ranking metrics: regret=0.127934 spearman=0.032181 (groups=37, skipped=311)
2025-12-25 10:17:39 INFO Epoch 093 | train_mse=0.060210 | val_loss=0.078061 | best_val_loss=0.180765
2025-12-25 10:17:48 INFO Epoch 094 | 25% complete (batch 46/181)
2025-12-25 10:17:48 INFO Epoch 094 | 50% complete (batch 91/181)
2025-12-25 10:17:49 INFO Epoch 094 | 75% complete (batch 136/181)
2025-12-25 10:17:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.597492
2025-12-25 10:18:03 INFO Tuning ranking metrics: regret=0.117411 spearman=-0.036141 (groups=37, skipped=311)
2025-12-25 10:18:03 INFO Epoch 094 | train_mse=0.072596 | val_loss=0.071243 | best_val_loss=0.180765
2025-12-25 10:18:12 INFO Epoch 095 | 25% complete (batch 46/181)
2025-12-25 10:18:13 INFO Epoch 095 | 50% complete (batch 91/181)
2025-12-25 10:18:14 INFO Epoch 095 | 75% complete (batch 136/181)
2025-12-25 10:18:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.595958
2025-12-25 10:18:28 INFO Tuning ranking metrics: regret=0.121934 spearman=-0.023482 (groups=37, skipped=311)
2025-12-25 10:18:28 INFO Epoch 095 | train_mse=0.051073 | val_loss=0.080021 | best_val_loss=0.180765
2025-12-25 10:18:36 INFO Epoch 096 | 25% complete (batch 46/181)
2025-12-25 10:18:37 INFO Epoch 096 | 50% complete (batch 91/181)
2025-12-25 10:18:38 INFO Epoch 096 | 75% complete (batch 136/181)
2025-12-25 10:18:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.587878
2025-12-25 10:18:51 INFO Tuning ranking metrics: regret=0.121775 spearman=0.019036 (groups=37, skipped=311)
2025-12-25 10:18:51 INFO Epoch 096 | train_mse=0.056430 | val_loss=0.091521 | best_val_loss=0.180765
2025-12-25 10:19:00 INFO Epoch 097 | 25% complete (batch 46/181)
2025-12-25 10:19:01 INFO Epoch 097 | 50% complete (batch 91/181)
2025-12-25 10:19:02 INFO Epoch 097 | 75% complete (batch 136/181)
2025-12-25 10:19:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.595827
2025-12-25 10:19:15 INFO Tuning ranking metrics: regret=0.121937 spearman=-0.028273 (groups=37, skipped=311)
2025-12-25 10:19:15 INFO Epoch 097 | train_mse=0.058592 | val_loss=0.073059 | best_val_loss=0.180765
2025-12-25 10:19:24 INFO Epoch 098 | 25% complete (batch 46/181)
2025-12-25 10:19:25 INFO Epoch 098 | 50% complete (batch 91/181)
2025-12-25 10:19:26 INFO Epoch 098 | 75% complete (batch 136/181)
2025-12-25 10:19:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.585230
2025-12-25 10:19:40 INFO Tuning ranking metrics: regret=0.121773 spearman=0.030742 (groups=37, skipped=311)
2025-12-25 10:19:40 INFO Epoch 098 | train_mse=0.054154 | val_loss=0.088920 | best_val_loss=0.180765
2025-12-25 10:19:48 INFO Epoch 099 | 25% complete (batch 46/181)
2025-12-25 10:19:49 INFO Epoch 099 | 50% complete (batch 91/181)
2025-12-25 10:19:50 INFO Epoch 099 | 75% complete (batch 136/181)
2025-12-25 10:19:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.581971
2025-12-25 10:20:03 INFO Tuning ranking metrics: regret=0.121408 spearman=-0.026378 (groups=37, skipped=311)
2025-12-25 10:20:03 INFO Epoch 099 | train_mse=0.059554 | val_loss=0.091911 | best_val_loss=0.180765
2025-12-25 10:20:12 INFO Epoch 100 | 25% complete (batch 46/181)
2025-12-25 10:20:13 INFO Epoch 100 | 50% complete (batch 91/181)
2025-12-25 10:20:14 INFO Epoch 100 | 75% complete (batch 136/181)
2025-12-25 10:20:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.587734
2025-12-25 10:20:28 INFO Tuning ranking metrics: regret=0.121246 spearman=0.003416 (groups=37, skipped=311)
2025-12-25 10:20:28 INFO Epoch 100 | train_mse=0.078923 | val_loss=0.071678 | best_val_loss=0.180765
2025-12-25 10:20:36 INFO Epoch 101 | 25% complete (batch 46/181)
2025-12-25 10:20:37 INFO Epoch 101 | 50% complete (batch 91/181)
2025-12-25 10:20:38 INFO Epoch 101 | 75% complete (batch 136/181)
2025-12-25 10:20:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.610729
2025-12-25 10:20:51 INFO Tuning ranking metrics: regret=0.122765 spearman=-0.025886 (groups=37, skipped=311)
2025-12-25 10:20:51 INFO Epoch 101 | train_mse=0.078898 | val_loss=0.081027 | best_val_loss=0.180765
2025-12-25 10:21:00 INFO Epoch 102 | 25% complete (batch 46/181)
2025-12-25 10:21:01 INFO Epoch 102 | 50% complete (batch 91/181)
2025-12-25 10:21:02 INFO Epoch 102 | 75% complete (batch 136/181)
2025-12-25 10:21:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.624010
2025-12-25 10:21:15 INFO Tuning ranking metrics: regret=0.139754 spearman=-0.031350 (groups=37, skipped=311)
2025-12-25 10:21:15 INFO Epoch 102 | train_mse=0.066929 | val_loss=0.071233 | best_val_loss=0.180765
2025-12-25 10:21:24 INFO Epoch 103 | 25% complete (batch 46/181)
2025-12-25 10:21:25 INFO Epoch 103 | 50% complete (batch 91/181)
2025-12-25 10:21:26 INFO Epoch 103 | 75% complete (batch 136/181)
2025-12-25 10:21:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.591824
2025-12-25 10:21:39 INFO Tuning ranking metrics: regret=0.138341 spearman=0.057184 (groups=37, skipped=311)
2025-12-25 10:21:39 INFO Epoch 103 | train_mse=0.056064 | val_loss=0.092086 | best_val_loss=0.180765
2025-12-25 10:21:48 INFO Epoch 104 | 25% complete (batch 46/181)
2025-12-25 10:21:49 INFO Epoch 104 | 50% complete (batch 91/181)
2025-12-25 10:21:49 INFO Epoch 104 | 75% complete (batch 136/181)
2025-12-25 10:21:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.621891
2025-12-25 10:22:03 INFO Tuning ranking metrics: regret=0.133460 spearman=0.023160 (groups=37, skipped=311)
2025-12-25 10:22:03 INFO Epoch 104 | train_mse=0.061142 | val_loss=0.068960 | best_val_loss=0.180765
2025-12-25 10:22:11 INFO Epoch 105 | 25% complete (batch 46/181)
2025-12-25 10:22:12 INFO Epoch 105 | 50% complete (batch 91/181)
2025-12-25 10:22:13 INFO Epoch 105 | 75% complete (batch 136/181)
2025-12-25 10:22:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.614045
2025-12-25 10:22:27 INFO Tuning ranking metrics: regret=0.115998 spearman=0.024593 (groups=37, skipped=311)
2025-12-25 10:22:27 INFO Epoch 105 | train_mse=0.090589 | val_loss=0.076454 | best_val_loss=0.180765
Monitored metric tuning_rank_spearman did not improve in the last 40 records. Best score: 0.181. Signaling Trainer to stop.
2025-12-25 10:22:28 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.15412_val-0.09254_epoch064.chkpt, checkpoint.tuning_rank_spearman-0.17293_val-0.09258_epoch066.chkpt, checkpoint.tuning_rank_spearman-0.18077_val-0.09186_epoch065.chkpt
2025-12-25 10:22:28 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57/model_checkpoints/checkpoint.tuning_rank_spearman-0.18077_val-0.09186_epoch065.chkpt
2025-12-25 10:22:28 INFO Best validation loss: tensor(0.1808)
2025-12-25 10:22:28 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57/model_checkpoints/checkpoint.tuning_rank_spearman-0.18077_val-0.09186_epoch065.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57/model_checkpoints/checkpoint.tuning_rank_spearman-0.18077_val-0.09186_epoch065.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-25 10:22:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.091856
2025-12-25 10:22:41 INFO Tuning ranking metrics: regret=0.094655 spearman=0.180765 (groups=37, skipped=311)
2025-12-25 10:22:41 INFO Epoch 106 | val_loss=0.091856 | best_val_loss=0.180765
2025-12-25 10:22:41 INFO Validation metrics: [{'val_loss': 0.09185599535703659, 'tuning_rank_regret': 0.09465506672859192, 'tuning_rank_spearman': 0.18076518177986145, 'val_pearson_corr': 0.5934497714042664, 'val_spearman_corr': 0.5937340259552002, 'val_rank_regret': 0.035918645560741425, 'val_rank_spearman': 0.1666666716337204}]
2025-12-25 10:22:41 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.18077_val-0.09186_epoch065.chkpt
2025-12-25 10:22:41 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.15412_val-0.09254_epoch064.chkpt
2025-12-25 10:22:41 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.17293_val-0.09258_epoch066.chkpt
2025-12-25 10:22:41 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.07785_epoch051.ckpt
2025-12-25 10:22:41 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.09465506672859192
  tuning_rank_spearman      0.18076518177986145
        val_loss            0.09185599535703659
    val_pearson_corr        0.5934497714042664
     val_rank_regret       0.035918645560741425
    val_rank_spearman       0.1666666716337204
    val_spearman_corr       0.5937340259552002
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run polish_seed101_2025-12-25_09-39-57 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57
[train_cli][batch] job 'polish_seed101' finished.
[train_cli][batch] (2/6) running job 'polish_lr_low_seed101' -> run_name=polish_lr_low_seed101_2025-12-25_10-22-44
[train_cli] run_id=polish_lr_low_seed101_2025-12-25_10-22-44 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-25_10-22-44/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-25_10-22-44 --git-commit 9b1bb2b320 --git-dirty
2025-12-25 10:22:47 INFO git_commit = 9b1bb2b320 (dirty)
2025-12-25 10:22:47 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-25 10:22:47 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-25_10-22-44/config/config.yaml
2025-12-25 10:22:47 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data
2025-12-25 10:22:47 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-25 10:22:47 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-25 10:22:47 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-25_10-22-44
2025-12-25 10:22:47 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-25 10:22:47 INFO   metadata_path = None
2025-12-25 10:22:47 INFO   summary_path = None
2025-12-25 10:22:47 INFO   accelerator = cpu
2025-12-25 10:22:47 INFO   devices = 1
2025-12-25 10:22:47 INFO   attention_head = 8
2025-12-25 10:22:47 INFO   pooling_type = mean
2025-12-25 10:22:47 INFO   model_self_loops = False
2025-12-25 10:22:47 INFO   model_self_loop_fill = mean
2025-12-25 10:22:47 INFO   model_residual = False
2025-12-25 10:22:47 INFO   batch_size = 12
2025-12-25 10:22:47 INFO   learning_rate = 0.002
2025-12-25 10:22:47 INFO   num_epochs = 360
2025-12-25 10:22:47 INFO   accumulate_grad_batches = 48
2025-12-25 10:22:47 INFO   seed = 101
2025-12-25 10:22:47 INFO   num_workers = 2
2025-12-25 10:22:47 INFO   precision = 32
2025-12-25 10:22:47 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-25 10:22:47 INFO   early_stopping_patience = 50
2025-12-25 10:22:47 INFO   lr_scheduler_patience = 25
2025-12-25 10:22:47 INFO   lr_scheduler_factor = 0.3
2025-12-25 10:22:47 INFO   fast_dev_run = False
2025-12-25 10:22:47 INFO   limit_train_batches = None
2025-12-25 10:22:47 INFO   limit_val_batches = None
2025-12-25 10:22:47 INFO   log_lr = False
2025-12-25 10:22:47 INFO   progress_bar_refresh_rate = 0
2025-12-25 10:22:47 INFO   log_every_n_steps = 100
2025-12-25 10:22:47 INFO   use_val_spearman_as_secondary = True
2025-12-25 10:22:47 INFO   spearman_secondary_min_delta = 0.0
2025-12-25 10:22:47 INFO   spearman_secondary_weight = 1.0
2025-12-25 10:22:47 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-25 10:22:47 INFO   tuning_max_samples = 500
2025-12-25 10:22:47 INFO   tuning_fraction = None
2025-12-25 10:22:47 INFO   tuning_eval_every = 1
2025-12-25 10:22:47 INFO   rank_loss_weight = 0.0
2025-12-25 10:22:47 INFO   rank_loss_margin = 0.0
2025-12-25 10:22:47 INFO   rank_loss_mode = hinge
2025-12-25 10:22:47 INFO   rank_loss_grouped = True
2025-12-25 10:22:47 INFO   variance_reduction_enabled = False
2025-12-25 10:22:47 INFO   variance_reduction_method = topk_avg
2025-12-25 10:22:47 INFO   variance_reduction_top_k = 3
2025-12-25 10:22:47 INFO   coverage_minimum = 0.0
2025-12-25 10:22:47 INFO   coverage_fail_on_missing = False
2025-12-25 10:22:47 INFO   graph_load_profiling = False
2025-12-25 10:22:47 INFO   graph_load_top_k = 5
2025-12-25 10:22:47 INFO   enable_graph_cache = True
2025-12-25 10:22:47 INFO   graph_cache_size = 256
2025-12-25 10:22:47 INFO   canonicalize_on_load = False
2025-12-25 10:22:47 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-25 10:22:47 INFO   edge_schema = {}
2025-12-25 10:22:47 INFO   topology_schema = {}
Seed set to 101
2025-12-25 10:22:48 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-25 10:22:48 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 10:22:48 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-25 10:22:48 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 10:22:48 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-25 10:22:48 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 10:22:49 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-25 10:22:49 INFO Tuning group stats: groups=348 groups>=2=37 singletons=311 max_group=11
2025-12-25 10:22:49 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-25_10-22-44/dataset_coverage.json
2025-12-25 10:22:49 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-25_10-22-44/dataset_coverage.json for details.
2025-12-25 10:22:49 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-25_10-22-44/dataset_coverage.json for details.
2025-12-25 10:22:49 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-25_10-22-44/dataset_coverage.json for details.
2025-12-25 10:22:49 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-25_10-22-44/schema_summary.json
2025-12-25 10:22:49 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-25_10-22-44/feature_metadata.json
2025-12-25 10:22:49 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-25 10:22:49 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/null_topology/feature-config.yaml.null.10A, sha256=f618659ace5620de7e794485915dadd4243f3ec2ca6726b4a9af3989817a8579
2025-12-25 10:22:49 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/work/edge_features)
2025-12-25 10:22:49 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json
2025-12-25 10:22:49 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-25_10-22-44/schema_summary.json
2025-12-25 10:22:49 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-25 10:22:49 INFO Topology: topology/persistence_null/v1 supporting the 172-dimensional node features.
2025-12-25 10:22:49 INFO Node: node/dssp_topo_merge/v1; metadata lists 172 feature columns matching the .pt tensor.
2025-12-25 10:22:49 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-25 10:22:49 INFO → Total feature dimensionality observed and confirmed: node_dim = 172, edge_dim = 11.
2025-12-25 10:22:49 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-25 10:22:49 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 172,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 172,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-25_10-22-44/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge/v1",
      "alias": "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA",
      "jobs": 16,
      "summary": "DSSP-derived node features merged with topology statistics."
    },
    "topology": {
      "id": "topology/persistence_null/v1",
      "alias": "Null topology (constant zeros) = 140D ablation",
      "jobs": 16,
      "summary": "Topology ablation: constant features with PH-compatible schema."
    }
  },
  "notes": []
}
2025-12-25 10:22:49 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-25 10:22:49 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=9ae2ce4c04b04b8890ff0dda0ef34e03)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-25 10:22:49 INFO Starting training (fast_dev_run=False)
2025-12-25 10:22:49 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-25_10-22-44/model_checkpoints exists and is not empty.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 5.5 K  | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
165 K     Trainable params
0         Non-trainable params
165 K     Total params
0.662     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-25 10:23:05 INFO Epoch 000 | 25% complete (batch 181/724)
2025-12-25 10:23:08 INFO Epoch 000 | 50% complete (batch 362/724)
2025-12-25 10:23:12 INFO Epoch 000 | 75% complete (batch 543/724)
2025-12-25 10:23:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.153409
2025-12-25 10:23:30 INFO Tuning ranking metrics: regret=0.144197 spearman=-0.123388 (groups=37, skipped=311)
2025-12-25 10:23:30 INFO Epoch 000 | val_loss=0.153409
Metric tuning_rank_spearman improved. New best score: -0.123
2025-12-25 10:23:41 INFO Epoch 001 | 25% complete (batch 181/724)
2025-12-25 10:23:44 INFO Epoch 001 | 50% complete (batch 362/724)
2025-12-25 10:23:47 INFO Epoch 001 | 75% complete (batch 543/724)
2025-12-25 10:24:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.237086
2025-12-25 10:24:05 INFO Tuning ranking metrics: regret=0.180775 spearman=-0.179396 (groups=37, skipped=311)
2025-12-25 10:24:05 INFO Epoch 001 | train_mse=0.149356 | val_loss=0.144629 | best_val_loss=-0.123388
2025-12-25 10:24:16 INFO Epoch 002 | 25% complete (batch 181/724)
2025-12-25 10:24:20 INFO Epoch 002 | 50% complete (batch 362/724)
2025-12-25 10:24:23 INFO Epoch 002 | 75% complete (batch 543/724)
2025-12-25 10:24:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.255473
2025-12-25 10:24:41 INFO Tuning ranking metrics: regret=0.166935 spearman=-0.169568 (groups=37, skipped=311)
2025-12-25 10:24:41 INFO Epoch 002 | train_mse=0.146730 | val_loss=0.143941 | best_val_loss=-0.123388
2025-12-25 10:24:52 INFO Epoch 003 | 25% complete (batch 181/724)
2025-12-25 10:24:55 INFO Epoch 003 | 50% complete (batch 362/724)
2025-12-25 10:24:58 INFO Epoch 003 | 75% complete (batch 543/724)
2025-12-25 10:25:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.315515
2025-12-25 10:25:17 INFO Tuning ranking metrics: regret=0.146522 spearman=-0.098877 (groups=37, skipped=311)
2025-12-25 10:25:17 INFO Epoch 003 | train_mse=0.141977 | val_loss=0.113645 | best_val_loss=-0.123388
Metric tuning_rank_spearman improved by 0.025 >= min_delta = 0.0. New best score: -0.099
2025-12-25 10:25:28 INFO Epoch 004 | 25% complete (batch 181/724)
2025-12-25 10:25:31 INFO Epoch 004 | 50% complete (batch 362/724)
2025-12-25 10:25:34 INFO Epoch 004 | 75% complete (batch 543/724)
2025-12-25 10:25:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.373608
2025-12-25 10:25:53 INFO Tuning ranking metrics: regret=0.151517 spearman=-0.070785 (groups=37, skipped=311)
2025-12-25 10:25:53 INFO Epoch 004 | train_mse=0.129156 | val_loss=0.121876 | best_val_loss=-0.098877
Metric tuning_rank_spearman improved by 0.028 >= min_delta = 0.0. New best score: -0.071
2025-12-25 10:26:03 INFO Epoch 005 | 25% complete (batch 181/724)
2025-12-25 10:26:07 INFO Epoch 005 | 50% complete (batch 362/724)
2025-12-25 10:26:10 INFO Epoch 005 | 75% complete (batch 543/724)
2025-12-25 10:26:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.431143
2025-12-25 10:26:29 INFO Tuning ranking metrics: regret=0.144419 spearman=-0.006845 (groups=37, skipped=311)
2025-12-25 10:26:29 INFO Epoch 005 | train_mse=0.105987 | val_loss=0.101181 | best_val_loss=-0.070785
Metric tuning_rank_spearman improved by 0.064 >= min_delta = 0.0. New best score: -0.007
2025-12-25 10:26:40 INFO Epoch 006 | 25% complete (batch 181/724)
2025-12-25 10:26:43 INFO Epoch 006 | 50% complete (batch 362/724)
2025-12-25 10:26:46 INFO Epoch 006 | 75% complete (batch 543/724)
2025-12-25 10:27:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.442508
2025-12-25 10:27:05 INFO Tuning ranking metrics: regret=0.090420 spearman=0.055142 (groups=37, skipped=311)
2025-12-25 10:27:05 INFO Epoch 006 | train_mse=0.100619 | val_loss=0.106219 | best_val_loss=-0.006845
Metric tuning_rank_spearman improved by 0.062 >= min_delta = 0.0. New best score: 0.055
2025-12-25 10:27:16 INFO Epoch 007 | 25% complete (batch 181/724)
2025-12-25 10:27:19 INFO Epoch 007 | 50% complete (batch 362/724)
2025-12-25 10:27:23 INFO Epoch 007 | 75% complete (batch 543/724)
2025-12-25 10:27:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.485916
2025-12-25 10:27:42 INFO Tuning ranking metrics: regret=0.093544 spearman=0.002434 (groups=37, skipped=311)
2025-12-25 10:27:42 INFO Epoch 007 | train_mse=0.097436 | val_loss=0.085119 | best_val_loss=0.055142
2025-12-25 10:27:52 INFO Epoch 008 | 25% complete (batch 181/724)
2025-12-25 10:27:56 INFO Epoch 008 | 50% complete (batch 362/724)
2025-12-25 10:27:59 INFO Epoch 008 | 75% complete (batch 543/724)
2025-12-25 10:28:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.507392
2025-12-25 10:28:18 INFO Tuning ranking metrics: regret=0.090665 spearman=0.041143 (groups=37, skipped=311)
2025-12-25 10:28:18 INFO Epoch 008 | train_mse=0.095338 | val_loss=0.087646 | best_val_loss=0.055142
2025-12-25 10:28:29 INFO Epoch 009 | 25% complete (batch 181/724)
2025-12-25 10:28:32 INFO Epoch 009 | 50% complete (batch 362/724)
2025-12-25 10:28:35 INFO Epoch 009 | 75% complete (batch 543/724)
2025-12-25 10:28:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.509268
2025-12-25 10:28:54 INFO Tuning ranking metrics: regret=0.091658 spearman=0.017076 (groups=37, skipped=311)
2025-12-25 10:28:54 INFO Epoch 009 | train_mse=0.082031 | val_loss=0.090075 | best_val_loss=0.055142
2025-12-25 10:29:05 INFO Epoch 010 | 25% complete (batch 181/724)
2025-12-25 10:29:08 INFO Epoch 010 | 50% complete (batch 362/724)
2025-12-25 10:29:11 INFO Epoch 010 | 75% complete (batch 543/724)
2025-12-25 10:29:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.518320
2025-12-25 10:29:30 INFO Tuning ranking metrics: regret=0.071772 spearman=0.045852 (groups=37, skipped=311)
2025-12-25 10:29:30 INFO Epoch 010 | train_mse=0.079463 | val_loss=0.082838 | best_val_loss=0.055142
2025-12-25 10:29:41 INFO Epoch 011 | 25% complete (batch 181/724)
2025-12-25 10:29:44 INFO Epoch 011 | 50% complete (batch 362/724)
2025-12-25 10:29:47 INFO Epoch 011 | 75% complete (batch 543/724)
2025-12-25 10:30:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.522098
2025-12-25 10:30:06 INFO Tuning ranking metrics: regret=0.109450 spearman=0.033854 (groups=37, skipped=311)
2025-12-25 10:30:06 INFO Epoch 011 | train_mse=0.082633 | val_loss=0.084288 | best_val_loss=0.055142
2025-12-25 10:30:17 INFO Epoch 012 | 25% complete (batch 181/724)
2025-12-25 10:30:21 INFO Epoch 012 | 50% complete (batch 362/724)
2025-12-25 10:30:24 INFO Epoch 012 | 75% complete (batch 543/724)
2025-12-25 10:30:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.530451
2025-12-25 10:30:42 INFO Tuning ranking metrics: regret=0.127421 spearman=-0.053311 (groups=37, skipped=311)
2025-12-25 10:30:42 INFO Epoch 012 | train_mse=0.084173 | val_loss=0.080645 | best_val_loss=0.055142
2025-12-25 10:30:53 INFO Epoch 013 | 25% complete (batch 181/724)
2025-12-25 10:30:56 INFO Epoch 013 | 50% complete (batch 362/724)
2025-12-25 10:31:00 INFO Epoch 013 | 75% complete (batch 543/724)
2025-12-25 10:31:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.536902
2025-12-25 10:31:18 INFO Tuning ranking metrics: regret=0.106331 spearman=-0.042477 (groups=37, skipped=311)
2025-12-25 10:31:18 INFO Epoch 013 | train_mse=0.077915 | val_loss=0.085179 | best_val_loss=0.055142
2025-12-25 10:31:29 INFO Epoch 014 | 25% complete (batch 181/724)
2025-12-25 10:31:32 INFO Epoch 014 | 50% complete (batch 362/724)
2025-12-25 10:31:36 INFO Epoch 014 | 75% complete (batch 543/724)
2025-12-25 10:31:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.550306
2025-12-25 10:31:54 INFO Tuning ranking metrics: regret=0.129802 spearman=-0.049836 (groups=37, skipped=311)
2025-12-25 10:31:54 INFO Epoch 014 | train_mse=0.074783 | val_loss=0.079164 | best_val_loss=0.055142
2025-12-25 10:32:05 INFO Epoch 015 | 25% complete (batch 181/724)
2025-12-25 10:32:09 INFO Epoch 015 | 50% complete (batch 362/724)
2025-12-25 10:32:12 INFO Epoch 015 | 75% complete (batch 543/724)
2025-12-25 10:32:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.543353
2025-12-25 10:32:31 INFO Tuning ranking metrics: regret=0.128227 spearman=0.002358 (groups=37, skipped=311)
2025-12-25 10:32:31 INFO Epoch 015 | train_mse=0.085713 | val_loss=0.086754 | best_val_loss=0.055142
2025-12-25 10:32:41 INFO Epoch 016 | 25% complete (batch 181/724)
2025-12-25 10:32:45 INFO Epoch 016 | 50% complete (batch 362/724)
2025-12-25 10:32:48 INFO Epoch 016 | 75% complete (batch 543/724)
2025-12-25 10:33:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.556522
2025-12-25 10:33:07 INFO Tuning ranking metrics: regret=0.112491 spearman=-0.024974 (groups=37, skipped=311)
2025-12-25 10:33:07 INFO Epoch 016 | train_mse=0.079502 | val_loss=0.077034 | best_val_loss=0.055142
2025-12-25 10:33:18 INFO Epoch 017 | 25% complete (batch 181/724)
2025-12-25 10:33:21 INFO Epoch 017 | 50% complete (batch 362/724)
2025-12-25 10:33:24 INFO Epoch 017 | 75% complete (batch 543/724)
2025-12-25 10:33:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.568519
2025-12-25 10:33:43 INFO Tuning ranking metrics: regret=0.129963 spearman=-0.029367 (groups=37, skipped=311)
2025-12-25 10:33:43 INFO Epoch 017 | train_mse=0.080534 | val_loss=0.077568 | best_val_loss=0.055142
2025-12-25 10:33:54 INFO Epoch 018 | 25% complete (batch 181/724)
2025-12-25 10:33:58 INFO Epoch 018 | 50% complete (batch 362/724)
2025-12-25 10:34:01 INFO Epoch 018 | 75% complete (batch 543/724)
2025-12-25 10:34:15 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.571946
2025-12-25 10:34:20 INFO Tuning ranking metrics: regret=0.128627 spearman=-0.033304 (groups=37, skipped=311)
2025-12-25 10:34:20 INFO Epoch 018 | train_mse=0.084622 | val_loss=0.075704 | best_val_loss=0.055142
2025-12-25 10:34:31 INFO Epoch 019 | 25% complete (batch 181/724)
2025-12-25 10:34:34 INFO Epoch 019 | 50% complete (batch 362/724)
2025-12-25 10:34:37 INFO Epoch 019 | 75% complete (batch 543/724)
2025-12-25 10:34:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.580644
2025-12-25 10:34:56 INFO Tuning ranking metrics: regret=0.109642 spearman=-0.022528 (groups=37, skipped=311)
2025-12-25 10:34:56 INFO Epoch 019 | train_mse=0.079186 | val_loss=0.072383 | best_val_loss=0.055142
2025-12-25 10:35:07 INFO Epoch 020 | 25% complete (batch 181/724)
2025-12-25 10:35:10 INFO Epoch 020 | 50% complete (batch 362/724)
2025-12-25 10:35:13 INFO Epoch 020 | 75% complete (batch 543/724)
2025-12-25 10:35:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.576825
2025-12-25 10:35:32 INFO Tuning ranking metrics: regret=0.089964 spearman=-0.014309 (groups=37, skipped=311)
2025-12-25 10:35:32 INFO Epoch 020 | train_mse=0.071896 | val_loss=0.077694 | best_val_loss=0.055142
2025-12-25 10:35:43 INFO Epoch 021 | 25% complete (batch 181/724)
2025-12-25 10:35:46 INFO Epoch 021 | 50% complete (batch 362/724)
2025-12-25 10:35:50 INFO Epoch 021 | 75% complete (batch 543/724)
2025-12-25 10:36:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.563892
2025-12-25 10:36:09 INFO Tuning ranking metrics: regret=0.108179 spearman=0.017339 (groups=37, skipped=311)
2025-12-25 10:36:09 INFO Epoch 021 | train_mse=0.075129 | val_loss=0.073561 | best_val_loss=0.055142
2025-12-25 10:36:20 INFO Epoch 022 | 25% complete (batch 181/724)
2025-12-25 10:36:23 INFO Epoch 022 | 50% complete (batch 362/724)
2025-12-25 10:36:26 INFO Epoch 022 | 75% complete (batch 543/724)
2025-12-25 10:36:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.578169
2025-12-25 10:36:45 INFO Tuning ranking metrics: regret=0.116283 spearman=0.027284 (groups=37, skipped=311)
2025-12-25 10:36:45 INFO Epoch 022 | train_mse=0.068386 | val_loss=0.076371 | best_val_loss=0.055142
2025-12-25 10:36:56 INFO Epoch 023 | 25% complete (batch 181/724)
2025-12-25 10:36:59 INFO Epoch 023 | 50% complete (batch 362/724)
2025-12-25 10:37:02 INFO Epoch 023 | 75% complete (batch 543/724)
2025-12-25 10:37:15 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.578799
2025-12-25 10:37:21 INFO Tuning ranking metrics: regret=0.133130 spearman=0.041740 (groups=37, skipped=311)
2025-12-25 10:37:21 INFO Epoch 023 | train_mse=0.075493 | val_loss=0.082732 | best_val_loss=0.055142
2025-12-25 10:37:32 INFO Epoch 024 | 25% complete (batch 181/724)
2025-12-25 10:37:35 INFO Epoch 024 | 50% complete (batch 362/724)
2025-12-25 10:37:38 INFO Epoch 024 | 75% complete (batch 543/724)
2025-12-25 10:37:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.588530
2025-12-25 10:37:57 INFO Tuning ranking metrics: regret=0.121702 spearman=0.007143 (groups=37, skipped=311)
2025-12-25 10:37:57 INFO Epoch 024 | train_mse=0.071825 | val_loss=0.077929 | best_val_loss=0.055142
2025-12-25 10:38:08 INFO Epoch 025 | 25% complete (batch 181/724)
2025-12-25 10:38:11 INFO Epoch 025 | 50% complete (batch 362/724)
2025-12-25 10:38:14 INFO Epoch 025 | 75% complete (batch 543/724)
2025-12-25 10:38:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.584294
2025-12-25 10:38:33 INFO Tuning ranking metrics: regret=0.124511 spearman=0.008547 (groups=37, skipped=311)
2025-12-25 10:38:33 INFO Epoch 025 | train_mse=0.070244 | val_loss=0.079970 | best_val_loss=0.055142
2025-12-25 10:38:44 INFO Epoch 026 | 25% complete (batch 181/724)
2025-12-25 10:38:47 INFO Epoch 026 | 50% complete (batch 362/724)
2025-12-25 10:38:50 INFO Epoch 026 | 75% complete (batch 543/724)
2025-12-25 10:39:04 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.583166
2025-12-25 10:39:09 INFO Tuning ranking metrics: regret=0.132036 spearman=-0.101544 (groups=37, skipped=311)
2025-12-25 10:39:09 INFO Epoch 026 | train_mse=0.061858 | val_loss=0.074306 | best_val_loss=0.055142
2025-12-25 10:39:20 INFO Epoch 027 | 25% complete (batch 181/724)
2025-12-25 10:39:23 INFO Epoch 027 | 50% complete (batch 362/724)
2025-12-25 10:39:27 INFO Epoch 027 | 75% complete (batch 543/724)
2025-12-25 10:39:40 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.594112
2025-12-25 10:39:46 INFO Tuning ranking metrics: regret=0.129215 spearman=-0.001667 (groups=37, skipped=311)
2025-12-25 10:39:46 INFO Epoch 027 | train_mse=0.070195 | val_loss=0.071126 | best_val_loss=0.055142
2025-12-25 10:39:57 INFO Epoch 028 | 25% complete (batch 181/724)
2025-12-25 10:40:00 INFO Epoch 028 | 50% complete (batch 362/724)
2025-12-25 10:40:03 INFO Epoch 028 | 75% complete (batch 543/724)
2025-12-25 10:40:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.602265
2025-12-25 10:40:22 INFO Tuning ranking metrics: regret=0.134281 spearman=-0.013402 (groups=37, skipped=311)
2025-12-25 10:40:22 INFO Epoch 028 | train_mse=0.064559 | val_loss=0.067406 | best_val_loss=0.055142
2025-12-25 10:40:33 INFO Epoch 029 | 25% complete (batch 181/724)
2025-12-25 10:40:36 INFO Epoch 029 | 50% complete (batch 362/724)
2025-12-25 10:40:39 INFO Epoch 029 | 75% complete (batch 543/724)
2025-12-25 10:40:53 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.611328
2025-12-25 10:40:58 INFO Tuning ranking metrics: regret=0.123026 spearman=-0.006148 (groups=37, skipped=311)
2025-12-25 10:40:58 INFO Epoch 029 | train_mse=0.068000 | val_loss=0.084957 | best_val_loss=0.055142
2025-12-25 10:41:09 INFO Epoch 030 | 25% complete (batch 181/724)
2025-12-25 10:41:12 INFO Epoch 030 | 50% complete (batch 362/724)
2025-12-25 10:41:16 INFO Epoch 030 | 75% complete (batch 543/724)
2025-12-25 10:41:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.610955
2025-12-25 10:41:34 INFO Tuning ranking metrics: regret=0.131450 spearman=0.023230 (groups=37, skipped=311)
2025-12-25 10:41:34 INFO Epoch 030 | train_mse=0.069827 | val_loss=0.069924 | best_val_loss=0.055142
2025-12-25 10:41:45 INFO Epoch 031 | 25% complete (batch 181/724)
2025-12-25 10:41:48 INFO Epoch 031 | 50% complete (batch 362/724)
2025-12-25 10:41:52 INFO Epoch 031 | 75% complete (batch 543/724)
2025-12-25 10:42:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.636074
2025-12-25 10:42:11 INFO Tuning ranking metrics: regret=0.134281 spearman=-0.033667 (groups=37, skipped=311)
2025-12-25 10:42:11 INFO Epoch 031 | train_mse=0.073417 | val_loss=0.066416 | best_val_loss=0.055142
2025-12-25 10:42:22 INFO Epoch 032 | 25% complete (batch 181/724)
2025-12-25 10:42:25 INFO Epoch 032 | 50% complete (batch 362/724)
2025-12-25 10:42:29 INFO Epoch 032 | 75% complete (batch 543/724)
2025-12-25 10:42:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.639861
2025-12-25 10:42:48 INFO Tuning ranking metrics: regret=0.133045 spearman=-0.003399 (groups=37, skipped=311)
2025-12-25 10:42:48 INFO Epoch 032 | train_mse=0.068877 | val_loss=0.066406 | best_val_loss=0.055142
2025-12-25 10:43:00 INFO Epoch 033 | 25% complete (batch 181/724)
2025-12-25 10:43:03 INFO Epoch 033 | 50% complete (batch 362/724)
2025-12-25 10:43:08 INFO Epoch 033 | 75% complete (batch 543/724)
2025-12-25 10:43:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.653117
2025-12-25 10:43:28 INFO Tuning ranking metrics: regret=0.134308 spearman=-0.074582 (groups=37, skipped=311)
2025-12-25 10:43:28 INFO Epoch 033 | train_mse=0.064375 | val_loss=0.062839 | best_val_loss=0.055142
2025-12-25 10:43:40 INFO Epoch 034 | 25% complete (batch 181/724)
2025-12-25 10:43:43 INFO Epoch 034 | 50% complete (batch 362/724)
2025-12-25 10:43:47 INFO Epoch 034 | 75% complete (batch 543/724)
2025-12-25 10:44:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.634242
2025-12-25 10:44:07 INFO Tuning ranking metrics: regret=0.146082 spearman=-0.093384 (groups=37, skipped=311)
2025-12-25 10:44:07 INFO Epoch 034 | train_mse=0.062687 | val_loss=0.067201 | best_val_loss=0.055142
2025-12-25 10:44:18 INFO Epoch 035 | 25% complete (batch 181/724)
2025-12-25 10:44:22 INFO Epoch 035 | 50% complete (batch 362/724)
2025-12-25 10:44:25 INFO Epoch 035 | 75% complete (batch 543/724)
2025-12-25 10:44:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.622675
2025-12-25 10:44:45 INFO Tuning ranking metrics: regret=0.149081 spearman=-0.074541 (groups=37, skipped=311)
2025-12-25 10:44:45 INFO Epoch 035 | train_mse=0.064808 | val_loss=0.065468 | best_val_loss=0.055142
2025-12-25 10:44:56 INFO Epoch 036 | 25% complete (batch 181/724)
2025-12-25 10:44:59 INFO Epoch 036 | 50% complete (batch 362/724)
2025-12-25 10:45:03 INFO Epoch 036 | 75% complete (batch 543/724)
2025-12-25 10:45:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.633303
2025-12-25 10:45:22 INFO Tuning ranking metrics: regret=0.130137 spearman=-0.021446 (groups=37, skipped=311)
2025-12-25 10:45:22 INFO Epoch 036 | train_mse=0.072494 | val_loss=0.060241 | best_val_loss=0.055142
2025-12-25 10:45:33 INFO Epoch 037 | 25% complete (batch 181/724)
2025-12-25 10:45:37 INFO Epoch 037 | 50% complete (batch 362/724)
2025-12-25 10:45:41 INFO Epoch 037 | 75% complete (batch 543/724)
2025-12-25 10:45:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.644558
2025-12-25 10:46:00 INFO Tuning ranking metrics: regret=0.145805 spearman=-0.060027 (groups=37, skipped=311)
2025-12-25 10:46:00 INFO Epoch 037 | train_mse=0.060001 | val_loss=0.067302 | best_val_loss=0.055142
2025-12-25 10:46:11 INFO Epoch 038 | 25% complete (batch 181/724)
2025-12-25 10:46:14 INFO Epoch 038 | 50% complete (batch 362/724)
2025-12-25 10:46:18 INFO Epoch 038 | 75% complete (batch 543/724)
2025-12-25 10:46:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.609621
2025-12-25 10:46:37 INFO Tuning ranking metrics: regret=0.127988 spearman=-0.032661 (groups=37, skipped=311)
2025-12-25 10:46:37 INFO Epoch 038 | train_mse=0.066042 | val_loss=0.077067 | best_val_loss=0.055142
2025-12-25 10:46:48 INFO Epoch 039 | 25% complete (batch 181/724)
2025-12-25 10:46:51 INFO Epoch 039 | 50% complete (batch 362/724)
2025-12-25 10:46:55 INFO Epoch 039 | 75% complete (batch 543/724)
2025-12-25 10:47:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.617636
2025-12-25 10:47:14 INFO Tuning ranking metrics: regret=0.134200 spearman=-0.021470 (groups=37, skipped=311)
2025-12-25 10:47:14 INFO Epoch 039 | train_mse=0.069933 | val_loss=0.068772 | best_val_loss=0.055142
2025-12-25 10:47:25 INFO Epoch 040 | 25% complete (batch 181/724)
2025-12-25 10:47:28 INFO Epoch 040 | 50% complete (batch 362/724)
2025-12-25 10:47:31 INFO Epoch 040 | 75% complete (batch 543/724)
2025-12-25 10:47:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.631679
2025-12-25 10:47:51 INFO Tuning ranking metrics: regret=0.133669 spearman=0.017796 (groups=37, skipped=311)
2025-12-25 10:47:51 INFO Epoch 040 | train_mse=0.071426 | val_loss=0.062234 | best_val_loss=0.055142
2025-12-25 10:48:02 INFO Epoch 041 | 25% complete (batch 181/724)
2025-12-25 10:48:05 INFO Epoch 041 | 50% complete (batch 362/724)
2025-12-25 10:48:09 INFO Epoch 041 | 75% complete (batch 543/724)
2025-12-25 10:48:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.654938
2025-12-25 10:48:28 INFO Tuning ranking metrics: regret=0.129930 spearman=0.030402 (groups=37, skipped=311)
2025-12-25 10:48:28 INFO Epoch 041 | train_mse=0.067238 | val_loss=0.061151 | best_val_loss=0.055142
2025-12-25 10:48:39 INFO Epoch 042 | 25% complete (batch 181/724)
2025-12-25 10:48:42 INFO Epoch 042 | 50% complete (batch 362/724)
2025-12-25 10:48:46 INFO Epoch 042 | 75% complete (batch 543/724)
2025-12-25 10:49:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.661932
2025-12-25 10:49:05 INFO Tuning ranking metrics: regret=0.147234 spearman=-0.042535 (groups=37, skipped=311)
2025-12-25 10:49:05 INFO Epoch 042 | train_mse=0.052842 | val_loss=0.060716 | best_val_loss=0.055142
2025-12-25 10:49:16 INFO Epoch 043 | 25% complete (batch 181/724)
2025-12-25 10:49:19 INFO Epoch 043 | 50% complete (batch 362/724)
2025-12-25 10:49:23 INFO Epoch 043 | 75% complete (batch 543/724)
2025-12-25 10:49:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.652469
2025-12-25 10:49:42 INFO Tuning ranking metrics: regret=0.143161 spearman=-0.001562 (groups=37, skipped=311)
2025-12-25 10:49:42 INFO Epoch 043 | train_mse=0.065438 | val_loss=0.067138 | best_val_loss=0.055142
2025-12-25 10:49:53 INFO Epoch 044 | 25% complete (batch 181/724)
2025-12-25 10:49:56 INFO Epoch 044 | 50% complete (batch 362/724)
2025-12-25 10:50:00 INFO Epoch 044 | 75% complete (batch 543/724)
2025-12-25 10:50:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.639110
2025-12-25 10:50:19 INFO Tuning ranking metrics: regret=0.144934 spearman=-0.076840 (groups=37, skipped=311)
2025-12-25 10:50:19 INFO Epoch 044 | train_mse=0.062821 | val_loss=0.058574 | best_val_loss=0.055142
2025-12-25 10:50:29 INFO Epoch 045 | 25% complete (batch 181/724)
2025-12-25 10:50:33 INFO Epoch 045 | 50% complete (batch 362/724)
2025-12-25 10:50:36 INFO Epoch 045 | 75% complete (batch 543/724)
2025-12-25 10:50:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.673077
2025-12-25 10:50:55 INFO Tuning ranking metrics: regret=0.147261 spearman=-0.119656 (groups=37, skipped=311)
2025-12-25 10:50:55 INFO Epoch 045 | train_mse=0.065632 | val_loss=0.057580 | best_val_loss=0.055142
2025-12-25 10:51:06 INFO Epoch 046 | 25% complete (batch 181/724)
2025-12-25 10:51:09 INFO Epoch 046 | 50% complete (batch 362/724)
2025-12-25 10:51:13 INFO Epoch 046 | 75% complete (batch 543/724)
2025-12-25 10:51:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.665448
2025-12-25 10:51:32 INFO Tuning ranking metrics: regret=0.134943 spearman=0.007658 (groups=37, skipped=311)
2025-12-25 10:51:32 INFO Epoch 046 | train_mse=0.059172 | val_loss=0.066587 | best_val_loss=0.055142
2025-12-25 10:51:43 INFO Epoch 047 | 25% complete (batch 181/724)
2025-12-25 10:51:46 INFO Epoch 047 | 50% complete (batch 362/724)
2025-12-25 10:51:50 INFO Epoch 047 | 75% complete (batch 543/724)
2025-12-25 10:52:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.648863
2025-12-25 10:52:09 INFO Tuning ranking metrics: regret=0.136303 spearman=-0.017649 (groups=37, skipped=311)
2025-12-25 10:52:09 INFO Epoch 047 | train_mse=0.058671 | val_loss=0.072612 | best_val_loss=0.055142
2025-12-25 10:52:20 INFO Epoch 048 | 25% complete (batch 181/724)
2025-12-25 10:52:24 INFO Epoch 048 | 50% complete (batch 362/724)
2025-12-25 10:52:27 INFO Epoch 048 | 75% complete (batch 543/724)
2025-12-25 10:52:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.659933
2025-12-25 10:52:47 INFO Tuning ranking metrics: regret=0.145313 spearman=-0.109149 (groups=37, skipped=311)
2025-12-25 10:52:47 INFO Epoch 048 | train_mse=0.066653 | val_loss=0.055241 | best_val_loss=0.055142
2025-12-25 10:52:58 INFO Epoch 049 | 25% complete (batch 181/724)
2025-12-25 10:53:01 INFO Epoch 049 | 50% complete (batch 362/724)
2025-12-25 10:53:04 INFO Epoch 049 | 75% complete (batch 543/724)
2025-12-25 10:53:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.680954
2025-12-25 10:53:23 INFO Tuning ranking metrics: regret=0.143045 spearman=-0.071183 (groups=37, skipped=311)
2025-12-25 10:53:23 INFO Epoch 049 | train_mse=0.057204 | val_loss=0.059404 | best_val_loss=0.055142
2025-12-25 10:53:34 INFO Epoch 050 | 25% complete (batch 181/724)
2025-12-25 10:53:38 INFO Epoch 050 | 50% complete (batch 362/724)
2025-12-25 10:53:42 INFO Epoch 050 | 75% complete (batch 543/724)
2025-12-25 10:53:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.683618
2025-12-25 10:54:01 INFO Tuning ranking metrics: regret=0.138199 spearman=-0.043395 (groups=37, skipped=311)
2025-12-25 10:54:01 INFO Epoch 050 | train_mse=0.059642 | val_loss=0.057050 | best_val_loss=0.055142
2025-12-25 10:54:12 INFO Epoch 051 | 25% complete (batch 181/724)
2025-12-25 10:54:15 INFO Epoch 051 | 50% complete (batch 362/724)
2025-12-25 10:54:18 INFO Epoch 051 | 75% complete (batch 543/724)
2025-12-25 10:54:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.662764
2025-12-25 10:54:38 INFO Tuning ranking metrics: regret=0.132966 spearman=-0.004721 (groups=37, skipped=311)
2025-12-25 10:54:38 INFO Epoch 051 | train_mse=0.059961 | val_loss=0.072752 | best_val_loss=0.055142
2025-12-25 10:54:49 INFO Epoch 052 | 25% complete (batch 181/724)
2025-12-25 10:54:52 INFO Epoch 052 | 50% complete (batch 362/724)
2025-12-25 10:54:56 INFO Epoch 052 | 75% complete (batch 543/724)
2025-12-25 10:55:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.628027
2025-12-25 10:55:15 INFO Tuning ranking metrics: regret=0.143197 spearman=-0.005593 (groups=37, skipped=311)
2025-12-25 10:55:15 INFO Epoch 052 | train_mse=0.059213 | val_loss=0.061854 | best_val_loss=0.055142
2025-12-25 10:55:26 INFO Epoch 053 | 25% complete (batch 181/724)
2025-12-25 10:55:30 INFO Epoch 053 | 50% complete (batch 362/724)
2025-12-25 10:55:33 INFO Epoch 053 | 75% complete (batch 543/724)
2025-12-25 10:55:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.681020
2025-12-25 10:55:54 INFO Tuning ranking metrics: regret=0.137456 spearman=-0.020241 (groups=37, skipped=311)
2025-12-25 10:55:54 INFO Epoch 053 | train_mse=0.061802 | val_loss=0.059861 | best_val_loss=0.055142
2025-12-25 10:56:08 INFO Epoch 054 | 25% complete (batch 181/724)
2025-12-25 10:56:13 INFO Epoch 054 | 50% complete (batch 362/724)
2025-12-25 10:56:17 INFO Epoch 054 | 75% complete (batch 543/724)
2025-12-25 10:56:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.649398
2025-12-25 10:56:36 INFO Tuning ranking metrics: regret=0.128643 spearman=0.028490 (groups=37, skipped=311)
2025-12-25 10:56:36 INFO Epoch 054 | train_mse=0.061096 | val_loss=0.067990 | best_val_loss=0.055142
2025-12-25 10:56:47 INFO Epoch 055 | 25% complete (batch 181/724)
2025-12-25 10:56:51 INFO Epoch 055 | 50% complete (batch 362/724)
2025-12-25 10:56:54 INFO Epoch 055 | 75% complete (batch 543/724)
2025-12-25 10:57:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.657990
2025-12-25 10:57:13 INFO Tuning ranking metrics: regret=0.109983 spearman=0.064385 (groups=37, skipped=311)
2025-12-25 10:57:13 INFO Epoch 055 | train_mse=0.056421 | val_loss=0.066517 | best_val_loss=0.055142
Metric tuning_rank_spearman improved by 0.009 >= min_delta = 0.0. New best score: 0.064
2025-12-25 10:57:25 INFO Epoch 056 | 25% complete (batch 181/724)
2025-12-25 10:57:28 INFO Epoch 056 | 50% complete (batch 362/724)
2025-12-25 10:57:31 INFO Epoch 056 | 75% complete (batch 543/724)
2025-12-25 10:57:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.638828
2025-12-25 10:57:50 INFO Tuning ranking metrics: regret=0.105213 spearman=0.088534 (groups=37, skipped=311)
2025-12-25 10:57:50 INFO Epoch 056 | train_mse=0.072462 | val_loss=0.074637 | best_val_loss=0.064385
Metric tuning_rank_spearman improved by 0.024 >= min_delta = 0.0. New best score: 0.089
2025-12-25 10:58:01 INFO Epoch 057 | 25% complete (batch 181/724)
2025-12-25 10:58:05 INFO Epoch 057 | 50% complete (batch 362/724)
2025-12-25 10:58:08 INFO Epoch 057 | 75% complete (batch 543/724)
2025-12-25 10:58:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.689527
2025-12-25 10:58:27 INFO Tuning ranking metrics: regret=0.138483 spearman=0.024289 (groups=37, skipped=311)
2025-12-25 10:58:27 INFO Epoch 057 | train_mse=0.059566 | val_loss=0.055946 | best_val_loss=0.088534
2025-12-25 10:58:38 INFO Epoch 058 | 25% complete (batch 181/724)
2025-12-25 10:58:41 INFO Epoch 058 | 50% complete (batch 362/724)
2025-12-25 10:58:45 INFO Epoch 058 | 75% complete (batch 543/724)
2025-12-25 10:59:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.690971
2025-12-25 10:59:06 INFO Tuning ranking metrics: regret=0.143262 spearman=-0.091301 (groups=37, skipped=311)
2025-12-25 10:59:06 INFO Epoch 058 | train_mse=0.066926 | val_loss=0.054313 | best_val_loss=0.088534
2025-12-25 10:59:19 INFO Epoch 059 | 25% complete (batch 181/724)
2025-12-25 10:59:24 INFO Epoch 059 | 50% complete (batch 362/724)
2025-12-25 10:59:27 INFO Epoch 059 | 75% complete (batch 543/724)
2025-12-25 10:59:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.680567
2025-12-25 10:59:46 INFO Tuning ranking metrics: regret=0.127595 spearman=-0.100889 (groups=37, skipped=311)
2025-12-25 10:59:46 INFO Epoch 059 | train_mse=0.062046 | val_loss=0.062037 | best_val_loss=0.088534
2025-12-25 10:59:57 INFO Epoch 060 | 25% complete (batch 181/724)
2025-12-25 11:00:01 INFO Epoch 060 | 50% complete (batch 362/724)
2025-12-25 11:00:04 INFO Epoch 060 | 75% complete (batch 543/724)
2025-12-25 11:00:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.673687
2025-12-25 11:00:23 INFO Tuning ranking metrics: regret=0.122455 spearman=0.059149 (groups=37, skipped=311)
2025-12-25 11:00:23 INFO Epoch 060 | train_mse=0.067527 | val_loss=0.057474 | best_val_loss=0.088534
2025-12-25 11:00:34 INFO Epoch 061 | 25% complete (batch 181/724)
2025-12-25 11:00:38 INFO Epoch 061 | 50% complete (batch 362/724)
2025-12-25 11:00:41 INFO Epoch 061 | 75% complete (batch 543/724)
2025-12-25 11:00:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.675541
2025-12-25 11:01:00 INFO Tuning ranking metrics: regret=0.124181 spearman=0.016830 (groups=37, skipped=311)
2025-12-25 11:01:00 INFO Epoch 061 | train_mse=0.063830 | val_loss=0.057319 | best_val_loss=0.088534
2025-12-25 11:01:11 INFO Epoch 062 | 25% complete (batch 181/724)
2025-12-25 11:01:14 INFO Epoch 062 | 50% complete (batch 362/724)
2025-12-25 11:01:18 INFO Epoch 062 | 75% complete (batch 543/724)
2025-12-25 11:01:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.697562
2025-12-25 11:01:37 INFO Tuning ranking metrics: regret=0.140448 spearman=0.007342 (groups=37, skipped=311)
2025-12-25 11:01:37 INFO Epoch 062 | train_mse=0.061832 | val_loss=0.054050 | best_val_loss=0.088534
2025-12-25 11:01:48 INFO Epoch 063 | 25% complete (batch 181/724)
2025-12-25 11:01:51 INFO Epoch 063 | 50% complete (batch 362/724)
2025-12-25 11:01:55 INFO Epoch 063 | 75% complete (batch 543/724)
2025-12-25 11:02:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.689172
2025-12-25 11:02:14 INFO Tuning ranking metrics: regret=0.124208 spearman=-0.002556 (groups=37, skipped=311)
2025-12-25 11:02:14 INFO Epoch 063 | train_mse=0.053900 | val_loss=0.058782 | best_val_loss=0.088534
2025-12-25 11:02:25 INFO Epoch 064 | 25% complete (batch 181/724)
2025-12-25 11:02:28 INFO Epoch 064 | 50% complete (batch 362/724)
2025-12-25 11:02:31 INFO Epoch 064 | 75% complete (batch 543/724)
2025-12-25 11:02:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.687470
2025-12-25 11:02:51 INFO Tuning ranking metrics: regret=0.145636 spearman=-0.050509 (groups=37, skipped=311)
2025-12-25 11:02:51 INFO Epoch 064 | train_mse=0.053164 | val_loss=0.055005 | best_val_loss=0.088534
2025-12-25 11:03:01 INFO Epoch 065 | 25% complete (batch 181/724)
2025-12-25 11:03:05 INFO Epoch 065 | 50% complete (batch 362/724)
2025-12-25 11:03:08 INFO Epoch 065 | 75% complete (batch 543/724)
2025-12-25 11:03:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.678466
2025-12-25 11:03:27 INFO Tuning ranking metrics: regret=0.145110 spearman=0.012367 (groups=37, skipped=311)
2025-12-25 11:03:27 INFO Epoch 065 | train_mse=0.062902 | val_loss=0.053304 | best_val_loss=0.088534
2025-12-25 11:03:38 INFO Epoch 066 | 25% complete (batch 181/724)
2025-12-25 11:03:41 INFO Epoch 066 | 50% complete (batch 362/724)
2025-12-25 11:03:45 INFO Epoch 066 | 75% complete (batch 543/724)
2025-12-25 11:03:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.686822
2025-12-25 11:04:04 INFO Tuning ranking metrics: regret=0.122418 spearman=0.007921 (groups=37, skipped=311)
2025-12-25 11:04:04 INFO Epoch 066 | train_mse=0.048261 | val_loss=0.059081 | best_val_loss=0.088534
2025-12-25 11:04:15 INFO Epoch 067 | 25% complete (batch 181/724)
2025-12-25 11:04:18 INFO Epoch 067 | 50% complete (batch 362/724)
2025-12-25 11:04:21 INFO Epoch 067 | 75% complete (batch 543/724)
2025-12-25 11:04:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.694258
2025-12-25 11:04:40 INFO Tuning ranking metrics: regret=0.122439 spearman=0.024324 (groups=37, skipped=311)
2025-12-25 11:04:40 INFO Epoch 067 | train_mse=0.057784 | val_loss=0.053496 | best_val_loss=0.088534
2025-12-25 11:04:50 INFO Epoch 068 | 25% complete (batch 181/724)
2025-12-25 11:04:54 INFO Epoch 068 | 50% complete (batch 362/724)
2025-12-25 11:04:57 INFO Epoch 068 | 75% complete (batch 543/724)
2025-12-25 11:05:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.682664
2025-12-25 11:05:16 INFO Tuning ranking metrics: regret=0.125861 spearman=0.068065 (groups=37, skipped=311)
2025-12-25 11:05:16 INFO Epoch 068 | train_mse=0.056674 | val_loss=0.057790 | best_val_loss=0.088534
2025-12-25 11:05:27 INFO Epoch 069 | 25% complete (batch 181/724)
2025-12-25 11:05:31 INFO Epoch 069 | 50% complete (batch 362/724)
2025-12-25 11:05:34 INFO Epoch 069 | 75% complete (batch 543/724)
2025-12-25 11:05:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.689749
2025-12-25 11:05:53 INFO Tuning ranking metrics: regret=0.110723 spearman=-0.048543 (groups=37, skipped=311)
2025-12-25 11:05:53 INFO Epoch 069 | train_mse=0.058880 | val_loss=0.050406 | best_val_loss=0.088534
2025-12-25 11:06:04 INFO Epoch 070 | 25% complete (batch 181/724)
2025-12-25 11:06:08 INFO Epoch 070 | 50% complete (batch 362/724)
2025-12-25 11:06:11 INFO Epoch 070 | 75% complete (batch 543/724)
2025-12-25 11:06:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.694166
2025-12-25 11:06:30 INFO Tuning ranking metrics: regret=0.108208 spearman=0.008681 (groups=37, skipped=311)
2025-12-25 11:06:30 INFO Epoch 070 | train_mse=0.055250 | val_loss=0.052757 | best_val_loss=0.088534
2025-12-25 11:06:41 INFO Epoch 071 | 25% complete (batch 181/724)
2025-12-25 11:06:45 INFO Epoch 071 | 50% complete (batch 362/724)
2025-12-25 11:06:48 INFO Epoch 071 | 75% complete (batch 543/724)
2025-12-25 11:07:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.690636
2025-12-25 11:07:07 INFO Tuning ranking metrics: regret=0.107682 spearman=0.051287 (groups=37, skipped=311)
2025-12-25 11:07:07 INFO Epoch 071 | train_mse=0.056056 | val_loss=0.053757 | best_val_loss=0.088534
2025-12-25 11:07:18 INFO Epoch 072 | 25% complete (batch 181/724)
2025-12-25 11:07:21 INFO Epoch 072 | 50% complete (batch 362/724)
2025-12-25 11:07:25 INFO Epoch 072 | 75% complete (batch 543/724)
2025-12-25 11:07:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.689961
2025-12-25 11:07:43 INFO Tuning ranking metrics: regret=0.127279 spearman=0.104206 (groups=37, skipped=311)
2025-12-25 11:07:43 INFO Epoch 072 | train_mse=0.050863 | val_loss=0.057176 | best_val_loss=0.088534
Metric tuning_rank_spearman improved by 0.016 >= min_delta = 0.0. New best score: 0.104
2025-12-25 11:07:54 INFO Epoch 073 | 25% complete (batch 181/724)
2025-12-25 11:07:58 INFO Epoch 073 | 50% complete (batch 362/724)
2025-12-25 11:08:01 INFO Epoch 073 | 75% complete (batch 543/724)
2025-12-25 11:08:15 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.689442
2025-12-25 11:08:20 INFO Tuning ranking metrics: regret=0.121525 spearman=-0.016608 (groups=37, skipped=311)
2025-12-25 11:08:20 INFO Epoch 073 | train_mse=0.048103 | val_loss=0.053083 | best_val_loss=0.104206
2025-12-25 11:08:31 INFO Epoch 074 | 25% complete (batch 181/724)
2025-12-25 11:08:34 INFO Epoch 074 | 50% complete (batch 362/724)
2025-12-25 11:08:38 INFO Epoch 074 | 75% complete (batch 543/724)
2025-12-25 11:08:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.705938
2025-12-25 11:08:57 INFO Tuning ranking metrics: regret=0.109669 spearman=0.046092 (groups=37, skipped=311)
2025-12-25 11:08:57 INFO Epoch 074 | train_mse=0.057452 | val_loss=0.052618 | best_val_loss=0.104206
2025-12-25 11:09:07 INFO Epoch 075 | 25% complete (batch 181/724)
2025-12-25 11:09:11 INFO Epoch 075 | 50% complete (batch 362/724)
2025-12-25 11:09:14 INFO Epoch 075 | 75% complete (batch 543/724)
2025-12-25 11:09:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.686197
2025-12-25 11:09:33 INFO Tuning ranking metrics: regret=0.113419 spearman=0.033714 (groups=37, skipped=311)
2025-12-25 11:09:33 INFO Epoch 075 | train_mse=0.055514 | val_loss=0.064466 | best_val_loss=0.104206
2025-12-25 11:09:44 INFO Epoch 076 | 25% complete (batch 181/724)
2025-12-25 11:09:48 INFO Epoch 076 | 50% complete (batch 362/724)
2025-12-25 11:09:51 INFO Epoch 076 | 75% complete (batch 543/724)
2025-12-25 11:10:04 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.693593
2025-12-25 11:10:10 INFO Tuning ranking metrics: regret=0.095603 spearman=0.072423 (groups=37, skipped=311)
2025-12-25 11:10:10 INFO Epoch 076 | train_mse=0.053777 | val_loss=0.056833 | best_val_loss=0.104206
2025-12-25 11:10:21 INFO Epoch 077 | 25% complete (batch 181/724)
2025-12-25 11:10:24 INFO Epoch 077 | 50% complete (batch 362/724)
2025-12-25 11:10:28 INFO Epoch 077 | 75% complete (batch 543/724)
2025-12-25 11:10:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.693617
2025-12-25 11:10:47 INFO Tuning ranking metrics: regret=0.103035 spearman=0.159272 (groups=37, skipped=311)
2025-12-25 11:10:47 INFO Epoch 077 | train_mse=0.050681 | val_loss=0.050567 | best_val_loss=0.104206
Metric tuning_rank_spearman improved by 0.055 >= min_delta = 0.0. New best score: 0.159
2025-12-25 11:10:58 INFO Epoch 078 | 25% complete (batch 181/724)
2025-12-25 11:11:01 INFO Epoch 078 | 50% complete (batch 362/724)
2025-12-25 11:11:05 INFO Epoch 078 | 75% complete (batch 543/724)
2025-12-25 11:11:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.687652
2025-12-25 11:11:23 INFO Tuning ranking metrics: regret=0.101266 spearman=0.115228 (groups=37, skipped=311)
2025-12-25 11:11:23 INFO Epoch 078 | train_mse=0.057694 | val_loss=0.060047 | best_val_loss=0.159272
2025-12-25 11:11:34 INFO Epoch 079 | 25% complete (batch 181/724)
2025-12-25 11:11:38 INFO Epoch 079 | 50% complete (batch 362/724)
2025-12-25 11:11:41 INFO Epoch 079 | 75% complete (batch 543/724)
2025-12-25 11:11:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.690715
2025-12-25 11:12:00 INFO Tuning ranking metrics: regret=0.126193 spearman=0.133667 (groups=37, skipped=311)
2025-12-25 11:12:00 INFO Epoch 079 | train_mse=0.053355 | val_loss=0.055454 | best_val_loss=0.159272
2025-12-25 11:12:11 INFO Epoch 080 | 25% complete (batch 181/724)
2025-12-25 11:12:14 INFO Epoch 080 | 50% complete (batch 362/724)
2025-12-25 11:12:18 INFO Epoch 080 | 75% complete (batch 543/724)
2025-12-25 11:12:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.695469
2025-12-25 11:12:37 INFO Tuning ranking metrics: regret=0.107122 spearman=0.107506 (groups=37, skipped=311)
2025-12-25 11:12:37 INFO Epoch 080 | train_mse=0.047440 | val_loss=0.052679 | best_val_loss=0.159272
2025-12-25 11:12:47 INFO Epoch 081 | 25% complete (batch 181/724)
2025-12-25 11:12:51 INFO Epoch 081 | 50% complete (batch 362/724)
2025-12-25 11:12:54 INFO Epoch 081 | 75% complete (batch 543/724)
2025-12-25 11:13:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.671308
2025-12-25 11:13:13 INFO Tuning ranking metrics: regret=0.091591 spearman=0.070276 (groups=37, skipped=311)
2025-12-25 11:13:13 INFO Epoch 081 | train_mse=0.052719 | val_loss=0.097954 | best_val_loss=0.159272
2025-12-25 11:13:24 INFO Epoch 082 | 25% complete (batch 181/724)
2025-12-25 11:13:28 INFO Epoch 082 | 50% complete (batch 362/724)
2025-12-25 11:13:31 INFO Epoch 082 | 75% complete (batch 543/724)
2025-12-25 11:13:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.674699
2025-12-25 11:13:50 INFO Tuning ranking metrics: regret=0.112054 spearman=0.141225 (groups=37, skipped=311)
2025-12-25 11:13:50 INFO Epoch 082 | train_mse=0.052450 | val_loss=0.060577 | best_val_loss=0.159272
2025-12-25 11:14:00 INFO Epoch 083 | 25% complete (batch 181/724)
2025-12-25 11:14:04 INFO Epoch 083 | 50% complete (batch 362/724)
2025-12-25 11:14:07 INFO Epoch 083 | 75% complete (batch 543/724)
2025-12-25 11:14:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.698713
2025-12-25 11:14:27 INFO Tuning ranking metrics: regret=0.123434 spearman=0.166907 (groups=37, skipped=311)
2025-12-25 11:14:27 INFO Epoch 083 | train_mse=0.064959 | val_loss=0.057345 | best_val_loss=0.159272
Metric tuning_rank_spearman improved by 0.008 >= min_delta = 0.0. New best score: 0.167
2025-12-25 11:14:38 INFO Epoch 084 | 25% complete (batch 181/724)
2025-12-25 11:14:41 INFO Epoch 084 | 50% complete (batch 362/724)
2025-12-25 11:14:45 INFO Epoch 084 | 75% complete (batch 543/724)
2025-12-25 11:14:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.709187
2025-12-25 11:15:04 INFO Tuning ranking metrics: regret=0.101306 spearman=0.128612 (groups=37, skipped=311)
2025-12-25 11:15:04 INFO Epoch 084 | train_mse=0.051760 | val_loss=0.049508 | best_val_loss=0.166907
2025-12-25 11:15:15 INFO Epoch 085 | 25% complete (batch 181/724)
2025-12-25 11:15:18 INFO Epoch 085 | 50% complete (batch 362/724)
2025-12-25 11:15:21 INFO Epoch 085 | 75% complete (batch 543/724)
2025-12-25 11:15:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.719683
2025-12-25 11:15:40 INFO Tuning ranking metrics: regret=0.092660 spearman=0.079145 (groups=37, skipped=311)
2025-12-25 11:15:40 INFO Epoch 085 | train_mse=0.052638 | val_loss=0.052300 | best_val_loss=0.166907
2025-12-25 11:15:51 INFO Epoch 086 | 25% complete (batch 181/724)
2025-12-25 11:15:55 INFO Epoch 086 | 50% complete (batch 362/724)
2025-12-25 11:15:58 INFO Epoch 086 | 75% complete (batch 543/724)
2025-12-25 11:16:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.709106
2025-12-25 11:16:17 INFO Tuning ranking metrics: regret=0.092857 spearman=0.082731 (groups=37, skipped=311)
2025-12-25 11:16:17 INFO Epoch 086 | train_mse=0.044380 | val_loss=0.055195 | best_val_loss=0.166907
2025-12-25 11:16:28 INFO Epoch 087 | 25% complete (batch 181/724)
2025-12-25 11:16:31 INFO Epoch 087 | 50% complete (batch 362/724)
2025-12-25 11:16:34 INFO Epoch 087 | 75% complete (batch 543/724)
2025-12-25 11:16:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.696277
2025-12-25 11:16:53 INFO Tuning ranking metrics: regret=0.086544 spearman=0.122809 (groups=37, skipped=311)
2025-12-25 11:16:53 INFO Epoch 087 | train_mse=0.051796 | val_loss=0.068961 | best_val_loss=0.166907
2025-12-25 11:17:03 INFO Epoch 088 | 25% complete (batch 181/724)
2025-12-25 11:17:07 INFO Epoch 088 | 50% complete (batch 362/724)
2025-12-25 11:17:10 INFO Epoch 088 | 75% complete (batch 543/724)
2025-12-25 11:17:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.684730
2025-12-25 11:17:29 INFO Tuning ranking metrics: regret=0.087565 spearman=0.145999 (groups=37, skipped=311)
2025-12-25 11:17:29 INFO Epoch 088 | train_mse=0.052118 | val_loss=0.053340 | best_val_loss=0.166907
2025-12-25 11:17:40 INFO Epoch 089 | 25% complete (batch 181/724)
2025-12-25 11:17:44 INFO Epoch 089 | 50% complete (batch 362/724)
2025-12-25 11:17:47 INFO Epoch 089 | 75% complete (batch 543/724)
2025-12-25 11:18:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.689638
2025-12-25 11:18:06 INFO Tuning ranking metrics: regret=0.086410 spearman=0.169826 (groups=37, skipped=311)
2025-12-25 11:18:06 INFO Epoch 089 | train_mse=0.049600 | val_loss=0.058598 | best_val_loss=0.166907
Metric tuning_rank_spearman improved by 0.003 >= min_delta = 0.0. New best score: 0.170
2025-12-25 11:18:17 INFO Epoch 090 | 25% complete (batch 181/724)
2025-12-25 11:18:21 INFO Epoch 090 | 50% complete (batch 362/724)
2025-12-25 11:18:24 INFO Epoch 090 | 75% complete (batch 543/724)
2025-12-25 11:18:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.705619
2025-12-25 11:18:43 INFO Tuning ranking metrics: regret=0.074606 spearman=0.283480 (groups=37, skipped=311)
2025-12-25 11:18:43 INFO Epoch 090 | train_mse=0.046891 | val_loss=0.057480 | best_val_loss=0.169826
Metric tuning_rank_spearman improved by 0.114 >= min_delta = 0.0. New best score: 0.283
2025-12-25 11:18:54 INFO Epoch 091 | 25% complete (batch 181/724)
2025-12-25 11:18:57 INFO Epoch 091 | 50% complete (batch 362/724)
2025-12-25 11:19:01 INFO Epoch 091 | 75% complete (batch 543/724)
2025-12-25 11:19:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.692037
2025-12-25 11:19:19 INFO Tuning ranking metrics: regret=0.084600 spearman=0.238048 (groups=37, skipped=311)
2025-12-25 11:19:19 INFO Epoch 091 | train_mse=0.054866 | val_loss=0.054834 | best_val_loss=0.283480
2025-12-25 11:19:30 INFO Epoch 092 | 25% complete (batch 181/724)
2025-12-25 11:19:34 INFO Epoch 092 | 50% complete (batch 362/724)
2025-12-25 11:19:37 INFO Epoch 092 | 75% complete (batch 543/724)
2025-12-25 11:19:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.687149
2025-12-25 11:19:56 INFO Tuning ranking metrics: regret=0.109170 spearman=0.135469 (groups=37, skipped=311)
2025-12-25 11:19:56 INFO Epoch 092 | train_mse=0.047753 | val_loss=0.069931 | best_val_loss=0.283480
2025-12-25 11:20:07 INFO Epoch 093 | 25% complete (batch 181/724)
2025-12-25 11:20:11 INFO Epoch 093 | 50% complete (batch 362/724)
2025-12-25 11:20:14 INFO Epoch 093 | 75% complete (batch 543/724)
2025-12-25 11:20:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.684677
2025-12-25 11:20:33 INFO Tuning ranking metrics: regret=0.077662 spearman=0.288920 (groups=37, skipped=311)
2025-12-25 11:20:33 INFO Epoch 093 | train_mse=0.045848 | val_loss=0.053830 | best_val_loss=0.283480
Metric tuning_rank_spearman improved by 0.005 >= min_delta = 0.0. New best score: 0.289
2025-12-25 11:20:44 INFO Epoch 094 | 25% complete (batch 181/724)
2025-12-25 11:20:48 INFO Epoch 094 | 50% complete (batch 362/724)
2025-12-25 11:20:51 INFO Epoch 094 | 75% complete (batch 543/724)
2025-12-25 11:21:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.703090
2025-12-25 11:21:10 INFO Tuning ranking metrics: regret=0.084770 spearman=0.176296 (groups=37, skipped=311)
2025-12-25 11:21:10 INFO Epoch 094 | train_mse=0.072753 | val_loss=0.056537 | best_val_loss=0.288920
2025-12-25 11:21:21 INFO Epoch 095 | 25% complete (batch 181/724)
2025-12-25 11:21:25 INFO Epoch 095 | 50% complete (batch 362/724)
2025-12-25 11:21:28 INFO Epoch 095 | 75% complete (batch 543/724)
2025-12-25 11:21:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.705153
2025-12-25 11:21:48 INFO Tuning ranking metrics: regret=0.070333 spearman=0.161004 (groups=37, skipped=311)
2025-12-25 11:21:48 INFO Epoch 095 | train_mse=0.058244 | val_loss=0.061392 | best_val_loss=0.288920
2025-12-25 11:21:59 INFO Epoch 096 | 25% complete (batch 181/724)
2025-12-25 11:22:02 INFO Epoch 096 | 50% complete (batch 362/724)
2025-12-25 11:22:06 INFO Epoch 096 | 75% complete (batch 543/724)
2025-12-25 11:22:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.691415
2025-12-25 11:22:25 INFO Tuning ranking metrics: regret=0.069852 spearman=0.248169 (groups=37, skipped=311)
2025-12-25 11:22:25 INFO Epoch 096 | train_mse=0.050535 | val_loss=0.052663 | best_val_loss=0.288920
2025-12-25 11:22:35 INFO Epoch 097 | 25% complete (batch 181/724)
2025-12-25 11:22:39 INFO Epoch 097 | 50% complete (batch 362/724)
2025-12-25 11:22:43 INFO Epoch 097 | 75% complete (batch 543/724)
2025-12-25 11:22:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.705643
2025-12-25 11:23:02 INFO Tuning ranking metrics: regret=0.072069 spearman=0.198473 (groups=37, skipped=311)
2025-12-25 11:23:02 INFO Epoch 097 | train_mse=0.060111 | val_loss=0.052722 | best_val_loss=0.288920
2025-12-25 11:23:13 INFO Epoch 098 | 25% complete (batch 181/724)
2025-12-25 11:23:16 INFO Epoch 098 | 50% complete (batch 362/724)
2025-12-25 11:23:20 INFO Epoch 098 | 75% complete (batch 543/724)
2025-12-25 11:23:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.714757
2025-12-25 11:23:38 INFO Tuning ranking metrics: regret=0.078159 spearman=0.136428 (groups=37, skipped=311)
2025-12-25 11:23:38 INFO Epoch 098 | train_mse=0.050666 | val_loss=0.048648 | best_val_loss=0.288920
2025-12-25 11:23:49 INFO Epoch 099 | 25% complete (batch 181/724)
2025-12-25 11:23:52 INFO Epoch 099 | 50% complete (batch 362/724)
2025-12-25 11:23:56 INFO Epoch 099 | 75% complete (batch 543/724)
2025-12-25 11:24:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.710497
2025-12-25 11:24:15 INFO Tuning ranking metrics: regret=0.086803 spearman=0.124605 (groups=37, skipped=311)
2025-12-25 11:24:15 INFO Epoch 099 | train_mse=0.049924 | val_loss=0.049746 | best_val_loss=0.288920
2025-12-25 11:24:25 INFO Epoch 100 | 25% complete (batch 181/724)
2025-12-25 11:24:29 INFO Epoch 100 | 50% complete (batch 362/724)
2025-12-25 11:24:32 INFO Epoch 100 | 75% complete (batch 543/724)
2025-12-25 11:24:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.715849
2025-12-25 11:24:52 INFO Tuning ranking metrics: regret=0.071354 spearman=0.145601 (groups=37, skipped=311)
2025-12-25 11:24:52 INFO Epoch 100 | train_mse=0.049529 | val_loss=0.050990 | best_val_loss=0.288920
2025-12-25 11:25:03 INFO Epoch 101 | 25% complete (batch 181/724)
2025-12-25 11:25:06 INFO Epoch 101 | 50% complete (batch 362/724)
2025-12-25 11:25:09 INFO Epoch 101 | 75% complete (batch 543/724)
2025-12-25 11:25:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.704036
2025-12-25 11:25:28 INFO Tuning ranking metrics: regret=0.073023 spearman=0.167164 (groups=37, skipped=311)
2025-12-25 11:25:28 INFO Epoch 101 | train_mse=0.043694 | val_loss=0.050444 | best_val_loss=0.288920
2025-12-25 11:25:39 INFO Epoch 102 | 25% complete (batch 181/724)
2025-12-25 11:25:42 INFO Epoch 102 | 50% complete (batch 362/724)
2025-12-25 11:25:46 INFO Epoch 102 | 75% complete (batch 543/724)
2025-12-25 11:25:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.695923
2025-12-25 11:26:05 INFO Tuning ranking metrics: regret=0.081170 spearman=0.138312 (groups=37, skipped=311)
2025-12-25 11:26:05 INFO Epoch 102 | train_mse=0.055446 | val_loss=0.063362 | best_val_loss=0.288920
2025-12-25 11:26:16 INFO Epoch 103 | 25% complete (batch 181/724)
2025-12-25 11:26:19 INFO Epoch 103 | 50% complete (batch 362/724)
2025-12-25 11:26:22 INFO Epoch 103 | 75% complete (batch 543/724)
2025-12-25 11:26:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.709373
2025-12-25 11:26:41 INFO Tuning ranking metrics: regret=0.085421 spearman=0.156295 (groups=37, skipped=311)
2025-12-25 11:26:41 INFO Epoch 103 | train_mse=0.056581 | val_loss=0.055115 | best_val_loss=0.288920
2025-12-25 11:26:53 INFO Epoch 104 | 25% complete (batch 181/724)
2025-12-25 11:26:56 INFO Epoch 104 | 50% complete (batch 362/724)
2025-12-25 11:26:59 INFO Epoch 104 | 75% complete (batch 543/724)
2025-12-25 11:27:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.715484
2025-12-25 11:27:18 INFO Tuning ranking metrics: regret=0.066193 spearman=0.243120 (groups=37, skipped=311)
2025-12-25 11:27:18 INFO Epoch 104 | train_mse=0.045720 | val_loss=0.051155 | best_val_loss=0.288920
2025-12-25 11:27:29 INFO Epoch 105 | 25% complete (batch 181/724)
2025-12-25 11:27:32 INFO Epoch 105 | 50% complete (batch 362/724)
2025-12-25 11:27:36 INFO Epoch 105 | 75% complete (batch 543/724)
2025-12-25 11:27:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.721654
2025-12-25 11:27:54 INFO Tuning ranking metrics: regret=0.076948 spearman=0.191611 (groups=37, skipped=311)
2025-12-25 11:27:54 INFO Epoch 105 | train_mse=0.051546 | val_loss=0.050129 | best_val_loss=0.288920
2025-12-25 11:28:05 INFO Epoch 106 | 25% complete (batch 181/724)
2025-12-25 11:28:09 INFO Epoch 106 | 50% complete (batch 362/724)
2025-12-25 11:28:12 INFO Epoch 106 | 75% complete (batch 543/724)
2025-12-25 11:28:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.721521
2025-12-25 11:28:31 INFO Tuning ranking metrics: regret=0.088703 spearman=0.150415 (groups=37, skipped=311)
2025-12-25 11:28:31 INFO Epoch 106 | train_mse=0.045921 | val_loss=0.054189 | best_val_loss=0.288920
2025-12-25 11:28:42 INFO Epoch 107 | 25% complete (batch 181/724)
2025-12-25 11:28:45 INFO Epoch 107 | 50% complete (batch 362/724)
2025-12-25 11:28:49 INFO Epoch 107 | 75% complete (batch 543/724)
2025-12-25 11:29:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.707999
2025-12-25 11:29:08 INFO Tuning ranking metrics: regret=0.072620 spearman=0.127940 (groups=37, skipped=311)
2025-12-25 11:29:08 INFO Epoch 107 | train_mse=0.047793 | val_loss=0.049114 | best_val_loss=0.288920
2025-12-25 11:29:19 INFO Epoch 108 | 25% complete (batch 181/724)
2025-12-25 11:29:22 INFO Epoch 108 | 50% complete (batch 362/724)
2025-12-25 11:29:26 INFO Epoch 108 | 75% complete (batch 543/724)
2025-12-25 11:29:40 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.728292
2025-12-25 11:29:45 INFO Tuning ranking metrics: regret=0.071083 spearman=0.176044 (groups=37, skipped=311)
2025-12-25 11:29:45 INFO Epoch 108 | train_mse=0.053214 | val_loss=0.048054 | best_val_loss=0.288920
2025-12-25 11:29:56 INFO Epoch 109 | 25% complete (batch 181/724)
2025-12-25 11:30:00 INFO Epoch 109 | 50% complete (batch 362/724)
2025-12-25 11:30:03 INFO Epoch 109 | 75% complete (batch 543/724)
2025-12-25 11:30:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.714277
2025-12-25 11:30:22 INFO Tuning ranking metrics: regret=0.069690 spearman=0.239148 (groups=37, skipped=311)
2025-12-25 11:30:22 INFO Epoch 109 | train_mse=0.050085 | val_loss=0.052830 | best_val_loss=0.288920
2025-12-25 11:30:33 INFO Epoch 110 | 25% complete (batch 181/724)
2025-12-25 11:30:37 INFO Epoch 110 | 50% complete (batch 362/724)
2025-12-25 11:30:40 INFO Epoch 110 | 75% complete (batch 543/724)
2025-12-25 11:30:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.718197
2025-12-25 11:31:00 INFO Tuning ranking metrics: regret=0.069173 spearman=0.176974 (groups=37, skipped=311)
2025-12-25 11:31:00 INFO Epoch 110 | train_mse=0.049260 | val_loss=0.049931 | best_val_loss=0.288920
2025-12-25 11:31:11 INFO Epoch 111 | 25% complete (batch 181/724)
2025-12-25 11:31:14 INFO Epoch 111 | 50% complete (batch 362/724)
2025-12-25 11:31:18 INFO Epoch 111 | 75% complete (batch 543/724)
2025-12-25 11:31:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.721543
2025-12-25 11:31:38 INFO Tuning ranking metrics: regret=0.069173 spearman=0.177940 (groups=37, skipped=311)
2025-12-25 11:31:38 INFO Epoch 111 | train_mse=0.046381 | val_loss=0.051711 | best_val_loss=0.288920
2025-12-25 11:31:49 INFO Epoch 112 | 25% complete (batch 181/724)
2025-12-25 11:31:52 INFO Epoch 112 | 50% complete (batch 362/724)
2025-12-25 11:31:56 INFO Epoch 112 | 75% complete (batch 543/724)
2025-12-25 11:32:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.704280
2025-12-25 11:32:15 INFO Tuning ranking metrics: regret=0.080432 spearman=0.221393 (groups=37, skipped=311)
2025-12-25 11:32:15 INFO Epoch 112 | train_mse=0.046703 | val_loss=0.061068 | best_val_loss=0.288920
2025-12-25 11:32:26 INFO Epoch 113 | 25% complete (batch 181/724)
2025-12-25 11:32:30 INFO Epoch 113 | 50% complete (batch 362/724)
2025-12-25 11:32:34 INFO Epoch 113 | 75% complete (batch 543/724)
2025-12-25 11:32:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.686412
2025-12-25 11:32:53 INFO Tuning ranking metrics: regret=0.065150 spearman=0.165965 (groups=37, skipped=311)
2025-12-25 11:32:53 INFO Epoch 113 | train_mse=0.046291 | val_loss=0.052663 | best_val_loss=0.288920
2025-12-25 11:33:04 INFO Epoch 114 | 25% complete (batch 181/724)
2025-12-25 11:33:07 INFO Epoch 114 | 50% complete (batch 362/724)
2025-12-25 11:33:11 INFO Epoch 114 | 75% complete (batch 543/724)
2025-12-25 11:33:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.710088
2025-12-25 11:33:31 INFO Tuning ranking metrics: regret=0.065727 spearman=0.147291 (groups=37, skipped=311)
2025-12-25 11:33:31 INFO Epoch 114 | train_mse=0.054670 | val_loss=0.058220 | best_val_loss=0.288920
2025-12-25 11:33:42 INFO Epoch 115 | 25% complete (batch 181/724)
2025-12-25 11:33:45 INFO Epoch 115 | 50% complete (batch 362/724)
2025-12-25 11:33:48 INFO Epoch 115 | 75% complete (batch 543/724)
2025-12-25 11:34:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.697638
2025-12-25 11:34:08 INFO Tuning ranking metrics: regret=0.075443 spearman=0.089347 (groups=37, skipped=311)
2025-12-25 11:34:08 INFO Epoch 115 | train_mse=0.042710 | val_loss=0.056684 | best_val_loss=0.288920
2025-12-25 11:34:19 INFO Epoch 116 | 25% complete (batch 181/724)
2025-12-25 11:34:22 INFO Epoch 116 | 50% complete (batch 362/724)
2025-12-25 11:34:26 INFO Epoch 116 | 75% complete (batch 543/724)
2025-12-25 11:34:40 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.717135
2025-12-25 11:34:45 INFO Tuning ranking metrics: regret=0.072069 spearman=0.158208 (groups=37, skipped=311)
2025-12-25 11:34:45 INFO Epoch 116 | train_mse=0.054970 | val_loss=0.053932 | best_val_loss=0.288920
2025-12-25 11:34:56 INFO Epoch 117 | 25% complete (batch 181/724)
2025-12-25 11:34:59 INFO Epoch 117 | 50% complete (batch 362/724)
2025-12-25 11:35:03 INFO Epoch 117 | 75% complete (batch 543/724)
2025-12-25 11:35:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.715958
2025-12-25 11:35:22 INFO Tuning ranking metrics: regret=0.076255 spearman=0.072558 (groups=37, skipped=311)
2025-12-25 11:35:22 INFO Epoch 117 | train_mse=0.050916 | val_loss=0.049787 | best_val_loss=0.288920
2025-12-25 11:35:33 INFO Epoch 118 | 25% complete (batch 181/724)
2025-12-25 11:35:37 INFO Epoch 118 | 50% complete (batch 362/724)
2025-12-25 11:35:40 INFO Epoch 118 | 75% complete (batch 543/724)
2025-12-25 11:35:53 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.725860
2025-12-25 11:35:59 INFO Tuning ranking metrics: regret=0.079554 spearman=0.103955 (groups=37, skipped=311)
2025-12-25 11:35:59 INFO Epoch 118 | train_mse=0.044384 | val_loss=0.049879 | best_val_loss=0.288920
2025-12-25 11:36:10 INFO Epoch 119 | 25% complete (batch 181/724)
2025-12-25 11:36:14 INFO Epoch 119 | 50% complete (batch 362/724)
2025-12-25 11:36:17 INFO Epoch 119 | 75% complete (batch 543/724)
2025-12-25 11:36:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.717177
2025-12-25 11:36:37 INFO Tuning ranking metrics: regret=0.072041 spearman=0.138429 (groups=37, skipped=311)
2025-12-25 11:36:37 INFO Epoch 119 | train_mse=0.046760 | val_loss=0.052424 | best_val_loss=0.288920
2025-12-25 11:36:48 INFO Epoch 120 | 25% complete (batch 181/724)
2025-12-25 11:36:51 INFO Epoch 120 | 50% complete (batch 362/724)
2025-12-25 11:36:55 INFO Epoch 120 | 75% complete (batch 543/724)
2025-12-25 11:37:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.717672
2025-12-25 11:37:15 INFO Tuning ranking metrics: regret=0.078906 spearman=0.171704 (groups=37, skipped=311)
2025-12-25 11:37:15 INFO Epoch 120 | train_mse=0.049341 | val_loss=0.049004 | best_val_loss=0.288920
2025-12-25 11:37:27 INFO Epoch 121 | 25% complete (batch 181/724)
2025-12-25 11:37:31 INFO Epoch 121 | 50% complete (batch 362/724)
2025-12-25 11:37:34 INFO Epoch 121 | 75% complete (batch 543/724)
2025-12-25 11:37:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.718636
2025-12-25 11:37:54 INFO Tuning ranking metrics: regret=0.069173 spearman=0.172025 (groups=37, skipped=311)
2025-12-25 11:37:54 INFO Epoch 121 | train_mse=0.049422 | val_loss=0.047186 | best_val_loss=0.288920
2025-12-25 11:38:05 INFO Epoch 122 | 25% complete (batch 181/724)
2025-12-25 11:38:08 INFO Epoch 122 | 50% complete (batch 362/724)
2025-12-25 11:38:12 INFO Epoch 122 | 75% complete (batch 543/724)
2025-12-25 11:38:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.727834
2025-12-25 11:38:31 INFO Tuning ranking metrics: regret=0.072101 spearman=0.170691 (groups=37, skipped=311)
2025-12-25 11:38:31 INFO Epoch 122 | train_mse=0.046078 | val_loss=0.053219 | best_val_loss=0.288920
2025-12-25 11:38:43 INFO Epoch 123 | 25% complete (batch 181/724)
2025-12-25 11:38:46 INFO Epoch 123 | 50% complete (batch 362/724)
2025-12-25 11:38:50 INFO Epoch 123 | 75% complete (batch 543/724)
2025-12-25 11:39:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.723778
2025-12-25 11:39:09 INFO Tuning ranking metrics: regret=0.070269 spearman=0.204481 (groups=37, skipped=311)
2025-12-25 11:39:09 INFO Epoch 123 | train_mse=0.048998 | val_loss=0.049768 | best_val_loss=0.288920
2025-12-25 11:39:21 INFO Epoch 124 | 25% complete (batch 181/724)
2025-12-25 11:39:24 INFO Epoch 124 | 50% complete (batch 362/724)
2025-12-25 11:39:27 INFO Epoch 124 | 75% complete (batch 543/724)
2025-12-25 11:39:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.725558
2025-12-25 11:39:47 INFO Tuning ranking metrics: regret=0.062830 spearman=0.213145 (groups=37, skipped=311)
2025-12-25 11:39:47 INFO Epoch 124 | train_mse=0.049468 | val_loss=0.054090 | best_val_loss=0.288920
2025-12-25 11:39:58 INFO Epoch 125 | 25% complete (batch 181/724)
2025-12-25 11:40:02 INFO Epoch 125 | 50% complete (batch 362/724)
2025-12-25 11:40:05 INFO Epoch 125 | 75% complete (batch 543/724)
2025-12-25 11:40:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.725598
2025-12-25 11:40:24 INFO Tuning ranking metrics: regret=0.067322 spearman=0.209302 (groups=37, skipped=311)
2025-12-25 11:40:24 INFO Epoch 125 | train_mse=0.050872 | val_loss=0.049150 | best_val_loss=0.288920
2025-12-25 11:40:35 INFO Epoch 126 | 25% complete (batch 181/724)
2025-12-25 11:40:39 INFO Epoch 126 | 50% complete (batch 362/724)
2025-12-25 11:40:42 INFO Epoch 126 | 75% complete (batch 543/724)
2025-12-25 11:40:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.725132
2025-12-25 11:41:01 INFO Tuning ranking metrics: regret=0.070777 spearman=0.171312 (groups=37, skipped=311)
2025-12-25 11:41:01 INFO Epoch 126 | train_mse=0.047841 | val_loss=0.054049 | best_val_loss=0.288920
2025-12-25 11:41:12 INFO Epoch 127 | 25% complete (batch 181/724)
2025-12-25 11:41:15 INFO Epoch 127 | 50% complete (batch 362/724)
2025-12-25 11:41:19 INFO Epoch 127 | 75% complete (batch 543/724)
2025-12-25 11:41:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.721636
2025-12-25 11:41:38 INFO Tuning ranking metrics: regret=0.065217 spearman=0.209635 (groups=37, skipped=311)
2025-12-25 11:41:38 INFO Epoch 127 | train_mse=0.043085 | val_loss=0.052076 | best_val_loss=0.288920
2025-12-25 11:41:49 INFO Epoch 128 | 25% complete (batch 181/724)
2025-12-25 11:41:52 INFO Epoch 128 | 50% complete (batch 362/724)
2025-12-25 11:41:56 INFO Epoch 128 | 75% complete (batch 543/724)
2025-12-25 11:42:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.723971
2025-12-25 11:42:15 INFO Tuning ranking metrics: regret=0.070014 spearman=0.287165 (groups=37, skipped=311)
2025-12-25 11:42:15 INFO Epoch 128 | train_mse=0.040248 | val_loss=0.050459 | best_val_loss=0.288920
2025-12-25 11:42:26 INFO Epoch 129 | 25% complete (batch 181/724)
2025-12-25 11:42:30 INFO Epoch 129 | 50% complete (batch 362/724)
2025-12-25 11:42:33 INFO Epoch 129 | 75% complete (batch 543/724)
2025-12-25 11:42:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.716485
2025-12-25 11:42:52 INFO Tuning ranking metrics: regret=0.073438 spearman=0.215473 (groups=37, skipped=311)
2025-12-25 11:42:52 INFO Epoch 129 | train_mse=0.049482 | val_loss=0.052111 | best_val_loss=0.288920
2025-12-25 11:43:03 INFO Epoch 130 | 25% complete (batch 181/724)
2025-12-25 11:43:07 INFO Epoch 130 | 50% complete (batch 362/724)
2025-12-25 11:43:10 INFO Epoch 130 | 75% complete (batch 543/724)
2025-12-25 11:43:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.692255
2025-12-25 11:43:30 INFO Tuning ranking metrics: regret=0.083422 spearman=0.305715 (groups=37, skipped=311)
2025-12-25 11:43:30 INFO Epoch 130 | train_mse=0.051226 | val_loss=0.074616 | best_val_loss=0.288920
Metric tuning_rank_spearman improved by 0.017 >= min_delta = 0.0. New best score: 0.306
2025-12-25 11:43:40 INFO Epoch 131 | 25% complete (batch 181/724)
2025-12-25 11:43:44 INFO Epoch 131 | 50% complete (batch 362/724)
2025-12-25 11:43:47 INFO Epoch 131 | 75% complete (batch 543/724)
2025-12-25 11:44:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.707947
2025-12-25 11:44:07 INFO Tuning ranking metrics: regret=0.095083 spearman=0.209383 (groups=37, skipped=311)
2025-12-25 11:44:07 INFO Epoch 131 | train_mse=0.046336 | val_loss=0.050446 | best_val_loss=0.305715
2025-12-25 11:44:18 INFO Epoch 132 | 25% complete (batch 181/724)
2025-12-25 11:44:21 INFO Epoch 132 | 50% complete (batch 362/724)
2025-12-25 11:44:24 INFO Epoch 132 | 75% complete (batch 543/724)
2025-12-25 11:44:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.712116
2025-12-25 11:44:43 INFO Tuning ranking metrics: regret=0.080940 spearman=0.191102 (groups=37, skipped=311)
2025-12-25 11:44:43 INFO Epoch 132 | train_mse=0.059395 | val_loss=0.048219 | best_val_loss=0.305715
2025-12-25 11:44:54 INFO Epoch 133 | 25% complete (batch 181/724)
2025-12-25 11:44:57 INFO Epoch 133 | 50% complete (batch 362/724)
2025-12-25 11:45:01 INFO Epoch 133 | 75% complete (batch 543/724)
2025-12-25 11:45:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.732144
2025-12-25 11:45:20 INFO Tuning ranking metrics: regret=0.076513 spearman=0.176009 (groups=37, skipped=311)
2025-12-25 11:45:20 INFO Epoch 133 | train_mse=0.045790 | val_loss=0.053742 | best_val_loss=0.305715
2025-12-25 11:45:31 INFO Epoch 134 | 25% complete (batch 181/724)
2025-12-25 11:45:34 INFO Epoch 134 | 50% complete (batch 362/724)
2025-12-25 11:45:38 INFO Epoch 134 | 75% complete (batch 543/724)
2025-12-25 11:45:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.715968
2025-12-25 11:45:57 INFO Tuning ranking metrics: regret=0.063884 spearman=0.184942 (groups=37, skipped=311)
2025-12-25 11:45:57 INFO Epoch 134 | train_mse=0.052251 | val_loss=0.052494 | best_val_loss=0.305715
2025-12-25 11:46:08 INFO Epoch 135 | 25% complete (batch 181/724)
2025-12-25 11:46:11 INFO Epoch 135 | 50% complete (batch 362/724)
2025-12-25 11:46:15 INFO Epoch 135 | 75% complete (batch 543/724)
2025-12-25 11:46:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.709133
2025-12-25 11:46:34 INFO Tuning ranking metrics: regret=0.069488 spearman=0.296718 (groups=37, skipped=311)
2025-12-25 11:46:34 INFO Epoch 135 | train_mse=0.045405 | val_loss=0.056919 | best_val_loss=0.305715
2025-12-25 11:46:45 INFO Epoch 136 | 25% complete (batch 181/724)
2025-12-25 11:46:48 INFO Epoch 136 | 50% complete (batch 362/724)
2025-12-25 11:46:51 INFO Epoch 136 | 75% complete (batch 543/724)
2025-12-25 11:47:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.707148
2025-12-25 11:47:10 INFO Tuning ranking metrics: regret=0.074720 spearman=0.200503 (groups=37, skipped=311)
2025-12-25 11:47:10 INFO Epoch 136 | train_mse=0.044809 | val_loss=0.052742 | best_val_loss=0.305715
2025-12-25 11:47:21 INFO Epoch 137 | 25% complete (batch 181/724)
2025-12-25 11:47:25 INFO Epoch 137 | 50% complete (batch 362/724)
2025-12-25 11:47:28 INFO Epoch 137 | 75% complete (batch 543/724)
2025-12-25 11:47:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.708369
2025-12-25 11:47:48 INFO Tuning ranking metrics: regret=0.056455 spearman=0.126752 (groups=37, skipped=311)
2025-12-25 11:47:48 INFO Epoch 137 | train_mse=0.046570 | val_loss=0.053034 | best_val_loss=0.305715
2025-12-25 11:47:59 INFO Epoch 138 | 25% complete (batch 181/724)
2025-12-25 11:48:02 INFO Epoch 138 | 50% complete (batch 362/724)
2025-12-25 11:48:06 INFO Epoch 138 | 75% complete (batch 543/724)
2025-12-25 11:48:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.716500
2025-12-25 11:48:25 INFO Tuning ranking metrics: regret=0.074048 spearman=0.198263 (groups=37, skipped=311)
2025-12-25 11:48:25 INFO Epoch 138 | train_mse=0.047559 | val_loss=0.051441 | best_val_loss=0.305715
2025-12-25 11:48:36 INFO Epoch 139 | 25% complete (batch 181/724)
2025-12-25 11:48:39 INFO Epoch 139 | 50% complete (batch 362/724)
2025-12-25 11:48:43 INFO Epoch 139 | 75% complete (batch 543/724)
2025-12-25 11:48:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.712318
2025-12-25 11:49:02 INFO Tuning ranking metrics: regret=0.052865 spearman=0.224400 (groups=37, skipped=311)
2025-12-25 11:49:02 INFO Epoch 139 | train_mse=0.054118 | val_loss=0.055730 | best_val_loss=0.305715
2025-12-25 11:49:13 INFO Epoch 140 | 25% complete (batch 181/724)
2025-12-25 11:49:17 INFO Epoch 140 | 50% complete (batch 362/724)
2025-12-25 11:49:20 INFO Epoch 140 | 75% complete (batch 543/724)
2025-12-25 11:49:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.707121
2025-12-25 11:49:39 INFO Tuning ranking metrics: regret=0.052865 spearman=0.210612 (groups=37, skipped=311)
2025-12-25 11:49:39 INFO Epoch 140 | train_mse=0.043139 | val_loss=0.053043 | best_val_loss=0.305715
2025-12-25 11:49:50 INFO Epoch 141 | 25% complete (batch 181/724)
2025-12-25 11:49:53 INFO Epoch 141 | 50% complete (batch 362/724)
2025-12-25 11:49:57 INFO Epoch 141 | 75% complete (batch 543/724)
2025-12-25 11:50:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.718810
2025-12-25 11:50:15 INFO Tuning ranking metrics: regret=0.072951 spearman=0.168135 (groups=37, skipped=311)
2025-12-25 11:50:15 INFO Epoch 141 | train_mse=0.045460 | val_loss=0.046772 | best_val_loss=0.305715
2025-12-25 11:50:26 INFO Epoch 142 | 25% complete (batch 181/724)
2025-12-25 11:50:29 INFO Epoch 142 | 50% complete (batch 362/724)
2025-12-25 11:50:33 INFO Epoch 142 | 75% complete (batch 543/724)
2025-12-25 11:50:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.719499
2025-12-25 11:50:52 INFO Tuning ranking metrics: regret=0.074048 spearman=0.179800 (groups=37, skipped=311)
2025-12-25 11:50:52 INFO Epoch 142 | train_mse=0.049246 | val_loss=0.049435 | best_val_loss=0.305715
2025-12-25 11:51:03 INFO Epoch 143 | 25% complete (batch 181/724)
2025-12-25 11:51:06 INFO Epoch 143 | 50% complete (batch 362/724)
2025-12-25 11:51:10 INFO Epoch 143 | 75% complete (batch 543/724)
2025-12-25 11:51:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.714529
2025-12-25 11:51:28 INFO Tuning ranking metrics: regret=0.074048 spearman=0.181947 (groups=37, skipped=311)
2025-12-25 11:51:28 INFO Epoch 143 | train_mse=0.043911 | val_loss=0.058977 | best_val_loss=0.305715
2025-12-25 11:51:40 INFO Epoch 144 | 25% complete (batch 181/724)
2025-12-25 11:51:43 INFO Epoch 144 | 50% complete (batch 362/724)
2025-12-25 11:51:46 INFO Epoch 144 | 75% complete (batch 543/724)
2025-12-25 11:52:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.709213
2025-12-25 11:52:05 INFO Tuning ranking metrics: regret=0.095683 spearman=0.131227 (groups=37, skipped=311)
2025-12-25 11:52:05 INFO Epoch 144 | train_mse=0.043216 | val_loss=0.055787 | best_val_loss=0.305715
2025-12-25 11:52:16 INFO Epoch 145 | 25% complete (batch 181/724)
2025-12-25 11:52:19 INFO Epoch 145 | 50% complete (batch 362/724)
2025-12-25 11:52:23 INFO Epoch 145 | 75% complete (batch 543/724)
2025-12-25 11:52:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.709428
2025-12-25 11:52:42 INFO Tuning ranking metrics: regret=0.082900 spearman=0.170768 (groups=37, skipped=311)
2025-12-25 11:52:42 INFO Epoch 145 | train_mse=0.052195 | val_loss=0.049501 | best_val_loss=0.305715
2025-12-25 11:52:53 INFO Epoch 146 | 25% complete (batch 181/724)
2025-12-25 11:52:57 INFO Epoch 146 | 50% complete (batch 362/724)
2025-12-25 11:53:00 INFO Epoch 146 | 75% complete (batch 543/724)
2025-12-25 11:53:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.716808
2025-12-25 11:53:19 INFO Tuning ranking metrics: regret=0.093420 spearman=0.184673 (groups=37, skipped=311)
2025-12-25 11:53:19 INFO Epoch 146 | train_mse=0.039513 | val_loss=0.048495 | best_val_loss=0.305715
2025-12-25 11:53:30 INFO Epoch 147 | 25% complete (batch 181/724)
2025-12-25 11:53:33 INFO Epoch 147 | 50% complete (batch 362/724)
2025-12-25 11:53:37 INFO Epoch 147 | 75% complete (batch 543/724)
2025-12-25 11:53:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.710939
2025-12-25 11:53:56 INFO Tuning ranking metrics: regret=0.087066 spearman=0.178671 (groups=37, skipped=311)
2025-12-25 11:53:56 INFO Epoch 147 | train_mse=0.040598 | val_loss=0.052892 | best_val_loss=0.305715
2025-12-25 11:54:07 INFO Epoch 148 | 25% complete (batch 181/724)
2025-12-25 11:54:10 INFO Epoch 148 | 50% complete (batch 362/724)
2025-12-25 11:54:13 INFO Epoch 148 | 75% complete (batch 543/724)
2025-12-25 11:54:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.707298
2025-12-25 11:54:32 INFO Tuning ranking metrics: regret=0.066727 spearman=0.197625 (groups=37, skipped=311)
2025-12-25 11:54:32 INFO Epoch 148 | train_mse=0.046275 | val_loss=0.056698 | best_val_loss=0.305715
2025-12-25 11:54:43 INFO Epoch 149 | 25% complete (batch 181/724)
2025-12-25 11:54:46 INFO Epoch 149 | 50% complete (batch 362/724)
2025-12-25 11:54:50 INFO Epoch 149 | 75% complete (batch 543/724)
2025-12-25 11:55:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.695146
2025-12-25 11:55:09 INFO Tuning ranking metrics: regret=0.071048 spearman=0.287393 (groups=37, skipped=311)
2025-12-25 11:55:09 INFO Epoch 149 | train_mse=0.036187 | val_loss=0.061407 | best_val_loss=0.305715
2025-12-25 11:55:20 INFO Epoch 150 | 25% complete (batch 181/724)
2025-12-25 11:55:23 INFO Epoch 150 | 50% complete (batch 362/724)
2025-12-25 11:55:27 INFO Epoch 150 | 75% complete (batch 543/724)
2025-12-25 11:55:40 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.677922
2025-12-25 11:55:46 INFO Tuning ranking metrics: regret=0.074932 spearman=0.140207 (groups=37, skipped=311)
2025-12-25 11:55:46 INFO Epoch 150 | train_mse=0.047320 | val_loss=0.060304 | best_val_loss=0.305715
2025-12-25 11:55:57 INFO Epoch 151 | 25% complete (batch 181/724)
2025-12-25 11:56:00 INFO Epoch 151 | 50% complete (batch 362/724)
2025-12-25 11:56:04 INFO Epoch 151 | 75% complete (batch 543/724)
2025-12-25 11:56:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.706454
2025-12-25 11:56:23 INFO Tuning ranking metrics: regret=0.069839 spearman=0.255429 (groups=37, skipped=311)
2025-12-25 11:56:23 INFO Epoch 151 | train_mse=0.040266 | val_loss=0.058068 | best_val_loss=0.305715
2025-12-25 11:56:34 INFO Epoch 152 | 25% complete (batch 181/724)
2025-12-25 11:56:37 INFO Epoch 152 | 50% complete (batch 362/724)
2025-12-25 11:56:40 INFO Epoch 152 | 75% complete (batch 543/724)
2025-12-25 11:56:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.697760
2025-12-25 11:57:00 INFO Tuning ranking metrics: regret=0.079142 spearman=0.154844 (groups=37, skipped=311)
2025-12-25 11:57:00 INFO Epoch 152 | train_mse=0.043024 | val_loss=0.051434 | best_val_loss=0.305715
2025-12-25 11:57:11 INFO Epoch 153 | 25% complete (batch 181/724)
2025-12-25 11:57:14 INFO Epoch 153 | 50% complete (batch 362/724)
2025-12-25 11:57:18 INFO Epoch 153 | 75% complete (batch 543/724)
2025-12-25 11:57:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.698481
2025-12-25 11:57:37 INFO Tuning ranking metrics: regret=0.080353 spearman=0.100345 (groups=37, skipped=311)
2025-12-25 11:57:37 INFO Epoch 153 | train_mse=0.043929 | val_loss=0.053012 | best_val_loss=0.305715
2025-12-25 11:57:48 INFO Epoch 154 | 25% complete (batch 181/724)
2025-12-25 11:57:51 INFO Epoch 154 | 50% complete (batch 362/724)
2025-12-25 11:57:55 INFO Epoch 154 | 75% complete (batch 543/724)
2025-12-25 11:58:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.695453
2025-12-25 11:58:13 INFO Tuning ranking metrics: regret=0.079808 spearman=0.182333 (groups=37, skipped=311)
2025-12-25 11:58:13 INFO Epoch 154 | train_mse=0.045233 | val_loss=0.055722 | best_val_loss=0.305715
2025-12-25 11:58:24 INFO Epoch 155 | 25% complete (batch 181/724)
2025-12-25 11:58:28 INFO Epoch 155 | 50% complete (batch 362/724)
2025-12-25 11:58:31 INFO Epoch 155 | 75% complete (batch 543/724)
2025-12-25 11:58:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.703837
2025-12-25 11:58:50 INFO Tuning ranking metrics: regret=0.079278 spearman=0.166889 (groups=37, skipped=311)
2025-12-25 11:58:50 INFO Epoch 155 | train_mse=0.047072 | val_loss=0.048466 | best_val_loss=0.305715
2025-12-25 11:59:01 INFO Epoch 156 | 25% complete (batch 181/724)
2025-12-25 11:59:05 INFO Epoch 156 | 50% complete (batch 362/724)
2025-12-25 11:59:08 INFO Epoch 156 | 75% complete (batch 543/724)
2025-12-25 11:59:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.714920
2025-12-25 11:59:27 INFO Tuning ranking metrics: regret=0.083035 spearman=0.131783 (groups=37, skipped=311)
2025-12-25 11:59:27 INFO Epoch 156 | train_mse=0.051879 | val_loss=0.048212 | best_val_loss=0.305715
2025-12-25 11:59:38 INFO Epoch 157 | 25% complete (batch 181/724)
2025-12-25 11:59:41 INFO Epoch 157 | 50% complete (batch 362/724)
2025-12-25 11:59:45 INFO Epoch 157 | 75% complete (batch 543/724)
2025-12-25 11:59:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.708838
2025-12-25 12:00:04 INFO Tuning ranking metrics: regret=0.082814 spearman=0.180730 (groups=37, skipped=311)
2025-12-25 12:00:04 INFO Epoch 157 | train_mse=0.046433 | val_loss=0.050002 | best_val_loss=0.305715
2025-12-25 12:00:15 INFO Epoch 158 | 25% complete (batch 181/724)
2025-12-25 12:00:18 INFO Epoch 158 | 50% complete (batch 362/724)
2025-12-25 12:00:21 INFO Epoch 158 | 75% complete (batch 543/724)
2025-12-25 12:00:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.685153
2025-12-25 12:00:40 INFO Tuning ranking metrics: regret=0.071467 spearman=0.213373 (groups=37, skipped=311)
2025-12-25 12:00:40 INFO Epoch 158 | train_mse=0.048054 | val_loss=0.071772 | best_val_loss=0.305715
2025-12-25 12:00:51 INFO Epoch 159 | 25% complete (batch 181/724)
2025-12-25 12:00:54 INFO Epoch 159 | 50% complete (batch 362/724)
2025-12-25 12:00:58 INFO Epoch 159 | 75% complete (batch 543/724)
2025-12-25 12:01:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.691373
2025-12-25 12:01:17 INFO Tuning ranking metrics: regret=0.093764 spearman=0.198578 (groups=37, skipped=311)
2025-12-25 12:01:17 INFO Epoch 159 | train_mse=0.050752 | val_loss=0.051308 | best_val_loss=0.305715
2025-12-25 12:01:28 INFO Epoch 160 | 25% complete (batch 181/724)
2025-12-25 12:01:31 INFO Epoch 160 | 50% complete (batch 362/724)
2025-12-25 12:01:35 INFO Epoch 160 | 75% complete (batch 543/724)
2025-12-25 12:01:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.704380
2025-12-25 12:01:54 INFO Tuning ranking metrics: regret=0.099373 spearman=0.144729 (groups=37, skipped=311)
2025-12-25 12:01:54 INFO Epoch 160 | train_mse=0.039686 | val_loss=0.055075 | best_val_loss=0.305715
2025-12-25 12:02:05 INFO Epoch 161 | 25% complete (batch 181/724)
2025-12-25 12:02:08 INFO Epoch 161 | 50% complete (batch 362/724)
2025-12-25 12:02:12 INFO Epoch 161 | 75% complete (batch 543/724)
2025-12-25 12:02:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.659016
2025-12-25 12:02:31 INFO Tuning ranking metrics: regret=0.100449 spearman=0.162718 (groups=37, skipped=311)
2025-12-25 12:02:31 INFO Epoch 161 | train_mse=0.042958 | val_loss=0.103686 | best_val_loss=0.305715
2025-12-25 12:02:42 INFO Epoch 162 | 25% complete (batch 181/724)
2025-12-25 12:02:46 INFO Epoch 162 | 50% complete (batch 362/724)
2025-12-25 12:02:49 INFO Epoch 162 | 75% complete (batch 543/724)
2025-12-25 12:03:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.683996
2025-12-25 12:03:08 INFO Tuning ranking metrics: regret=0.085238 spearman=0.142453 (groups=37, skipped=311)
2025-12-25 12:03:08 INFO Epoch 162 | train_mse=0.053209 | val_loss=0.056829 | best_val_loss=0.305715
2025-12-25 12:03:19 INFO Epoch 163 | 25% complete (batch 181/724)
2025-12-25 12:03:22 INFO Epoch 163 | 50% complete (batch 362/724)
2025-12-25 12:03:26 INFO Epoch 163 | 75% complete (batch 543/724)
2025-12-25 12:03:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.692806
2025-12-25 12:03:45 INFO Tuning ranking metrics: regret=0.087908 spearman=0.099403 (groups=37, skipped=311)
2025-12-25 12:03:45 INFO Epoch 163 | train_mse=0.072051 | val_loss=0.048586 | best_val_loss=0.305715
2025-12-25 12:03:56 INFO Epoch 164 | 25% complete (batch 181/724)
2025-12-25 12:03:59 INFO Epoch 164 | 50% complete (batch 362/724)
2025-12-25 12:04:03 INFO Epoch 164 | 75% complete (batch 543/724)
2025-12-25 12:04:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.722571
2025-12-25 12:04:22 INFO Tuning ranking metrics: regret=0.078092 spearman=0.103089 (groups=37, skipped=311)
2025-12-25 12:04:22 INFO Epoch 164 | train_mse=0.047920 | val_loss=0.052482 | best_val_loss=0.305715
2025-12-25 12:04:33 INFO Epoch 165 | 25% complete (batch 181/724)
2025-12-25 12:04:37 INFO Epoch 165 | 50% complete (batch 362/724)
2025-12-25 12:04:40 INFO Epoch 165 | 75% complete (batch 543/724)
2025-12-25 12:04:53 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.718574
2025-12-25 12:04:59 INFO Tuning ranking metrics: regret=0.077038 spearman=0.166959 (groups=37, skipped=311)
2025-12-25 12:04:59 INFO Epoch 165 | train_mse=0.049970 | val_loss=0.049029 | best_val_loss=0.305715
2025-12-25 12:05:10 INFO Epoch 166 | 25% complete (batch 181/724)
2025-12-25 12:05:13 INFO Epoch 166 | 50% complete (batch 362/724)
2025-12-25 12:05:17 INFO Epoch 166 | 75% complete (batch 543/724)
2025-12-25 12:05:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.719327
2025-12-25 12:05:36 INFO Tuning ranking metrics: regret=0.074051 spearman=0.173769 (groups=37, skipped=311)
2025-12-25 12:05:36 INFO Epoch 166 | train_mse=0.043444 | val_loss=0.048095 | best_val_loss=0.305715
2025-12-25 12:05:47 INFO Epoch 167 | 25% complete (batch 181/724)
2025-12-25 12:05:50 INFO Epoch 167 | 50% complete (batch 362/724)
2025-12-25 12:05:54 INFO Epoch 167 | 75% complete (batch 543/724)
2025-12-25 12:06:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.717350
2025-12-25 12:06:13 INFO Tuning ranking metrics: regret=0.065114 spearman=0.260542 (groups=37, skipped=311)
2025-12-25 12:06:13 INFO Epoch 167 | train_mse=0.038740 | val_loss=0.054604 | best_val_loss=0.305715
2025-12-25 12:06:24 INFO Epoch 168 | 25% complete (batch 181/724)
2025-12-25 12:06:27 INFO Epoch 168 | 50% complete (batch 362/724)
2025-12-25 12:06:30 INFO Epoch 168 | 75% complete (batch 543/724)
2025-12-25 12:06:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.713772
2025-12-25 12:06:49 INFO Tuning ranking metrics: regret=0.073049 spearman=0.182941 (groups=37, skipped=311)
2025-12-25 12:06:49 INFO Epoch 168 | train_mse=0.051234 | val_loss=0.049538 | best_val_loss=0.305715
2025-12-25 12:07:01 INFO Epoch 169 | 25% complete (batch 181/724)
2025-12-25 12:07:06 INFO Epoch 169 | 50% complete (batch 362/724)
2025-12-25 12:07:09 INFO Epoch 169 | 75% complete (batch 543/724)
2025-12-25 12:07:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.719518
2025-12-25 12:07:29 INFO Tuning ranking metrics: regret=0.074497 spearman=0.143021 (groups=37, skipped=311)
2025-12-25 12:07:29 INFO Epoch 169 | train_mse=0.044438 | val_loss=0.047770 | best_val_loss=0.305715
2025-12-25 12:07:40 INFO Epoch 170 | 25% complete (batch 181/724)
2025-12-25 12:07:44 INFO Epoch 170 | 50% complete (batch 362/724)
2025-12-25 12:07:47 INFO Epoch 170 | 75% complete (batch 543/724)
2025-12-25 12:08:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.722371
2025-12-25 12:08:07 INFO Tuning ranking metrics: regret=0.080988 spearman=0.134451 (groups=37, skipped=311)
2025-12-25 12:08:07 INFO Epoch 170 | train_mse=0.046742 | val_loss=0.048250 | best_val_loss=0.305715
2025-12-25 12:08:19 INFO Epoch 171 | 25% complete (batch 181/724)
2025-12-25 12:08:22 INFO Epoch 171 | 50% complete (batch 362/724)
2025-12-25 12:08:26 INFO Epoch 171 | 75% complete (batch 543/724)
2025-12-25 12:08:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.721791
2025-12-25 12:08:45 INFO Tuning ranking metrics: regret=0.078092 spearman=0.139008 (groups=37, skipped=311)
2025-12-25 12:08:45 INFO Epoch 171 | train_mse=0.042699 | val_loss=0.047882 | best_val_loss=0.305715
2025-12-25 12:08:56 INFO Epoch 172 | 25% complete (batch 181/724)
2025-12-25 12:08:59 INFO Epoch 172 | 50% complete (batch 362/724)
2025-12-25 12:09:03 INFO Epoch 172 | 75% complete (batch 543/724)
2025-12-25 12:09:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.716204
2025-12-25 12:09:22 INFO Tuning ranking metrics: regret=0.079250 spearman=0.186176 (groups=37, skipped=311)
2025-12-25 12:09:22 INFO Epoch 172 | train_mse=0.041405 | val_loss=0.049878 | best_val_loss=0.305715
2025-12-25 12:09:33 INFO Epoch 173 | 25% complete (batch 181/724)
2025-12-25 12:09:37 INFO Epoch 173 | 50% complete (batch 362/724)
2025-12-25 12:09:41 INFO Epoch 173 | 75% complete (batch 543/724)
2025-12-25 12:09:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.716914
2025-12-25 12:10:00 INFO Tuning ranking metrics: regret=0.076881 spearman=0.165456 (groups=37, skipped=311)
2025-12-25 12:10:00 INFO Epoch 173 | train_mse=0.039572 | val_loss=0.048790 | best_val_loss=0.305715
2025-12-25 12:10:11 INFO Epoch 174 | 25% complete (batch 181/724)
2025-12-25 12:10:14 INFO Epoch 174 | 50% complete (batch 362/724)
2025-12-25 12:10:18 INFO Epoch 174 | 75% complete (batch 543/724)
2025-12-25 12:10:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.720374
2025-12-25 12:10:37 INFO Tuning ranking metrics: regret=0.076881 spearman=0.180385 (groups=37, skipped=311)
2025-12-25 12:10:37 INFO Epoch 174 | train_mse=0.044012 | val_loss=0.048327 | best_val_loss=0.305715
2025-12-25 12:10:49 INFO Epoch 175 | 25% complete (batch 181/724)
2025-12-25 12:10:53 INFO Epoch 175 | 50% complete (batch 362/724)
2025-12-25 12:10:56 INFO Epoch 175 | 75% complete (batch 543/724)
2025-12-25 12:11:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.719966
2025-12-25 12:11:16 INFO Tuning ranking metrics: regret=0.077615 spearman=0.178647 (groups=37, skipped=311)
2025-12-25 12:11:16 INFO Epoch 175 | train_mse=0.041267 | val_loss=0.048446 | best_val_loss=0.305715
2025-12-25 12:11:27 INFO Epoch 176 | 25% complete (batch 181/724)
2025-12-25 12:11:30 INFO Epoch 176 | 50% complete (batch 362/724)
2025-12-25 12:11:34 INFO Epoch 176 | 75% complete (batch 543/724)
2025-12-25 12:11:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.718921
2025-12-25 12:11:53 INFO Tuning ranking metrics: regret=0.062070 spearman=0.148268 (groups=37, skipped=311)
2025-12-25 12:11:53 INFO Epoch 176 | train_mse=0.036803 | val_loss=0.048475 | best_val_loss=0.305715
2025-12-25 12:12:04 INFO Epoch 177 | 25% complete (batch 181/724)
2025-12-25 12:12:08 INFO Epoch 177 | 50% complete (batch 362/724)
2025-12-25 12:12:13 INFO Epoch 177 | 75% complete (batch 543/724)
2025-12-25 12:12:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.718517
2025-12-25 12:12:34 INFO Tuning ranking metrics: regret=0.062412 spearman=0.156628 (groups=37, skipped=311)
2025-12-25 12:12:34 INFO Epoch 177 | train_mse=0.045876 | val_loss=0.049849 | best_val_loss=0.305715
2025-12-25 12:12:45 INFO Epoch 178 | 25% complete (batch 181/724)
2025-12-25 12:12:49 INFO Epoch 178 | 50% complete (batch 362/724)
2025-12-25 12:12:53 INFO Epoch 178 | 75% complete (batch 543/724)
2025-12-25 12:13:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.720136
2025-12-25 12:13:12 INFO Tuning ranking metrics: regret=0.061970 spearman=0.166526 (groups=37, skipped=311)
2025-12-25 12:13:12 INFO Epoch 178 | train_mse=0.040465 | val_loss=0.048377 | best_val_loss=0.305715
2025-12-25 12:13:23 INFO Epoch 179 | 25% complete (batch 181/724)
2025-12-25 12:13:27 INFO Epoch 179 | 50% complete (batch 362/724)
2025-12-25 12:13:30 INFO Epoch 179 | 75% complete (batch 543/724)
2025-12-25 12:13:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.723958
2025-12-25 12:13:50 INFO Tuning ranking metrics: regret=0.061970 spearman=0.147830 (groups=37, skipped=311)
2025-12-25 12:13:50 INFO Epoch 179 | train_mse=0.042905 | val_loss=0.046902 | best_val_loss=0.305715
2025-12-25 12:14:01 INFO Epoch 180 | 25% complete (batch 181/724)
2025-12-25 12:14:05 INFO Epoch 180 | 50% complete (batch 362/724)
2025-12-25 12:14:09 INFO Epoch 180 | 75% complete (batch 543/724)
2025-12-25 12:14:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.726276
2025-12-25 12:14:29 INFO Tuning ranking metrics: regret=0.061979 spearman=0.187627 (groups=37, skipped=311)
2025-12-25 12:14:29 INFO Epoch 180 | train_mse=0.034824 | val_loss=0.050536 | best_val_loss=0.305715
Monitored metric tuning_rank_spearman did not improve in the last 50 records. Best score: 0.306. Signaling Trainer to stop.
2025-12-25 12:14:30 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.28892_val-0.05383_epoch093.chkpt, checkpoint.tuning_rank_spearman-0.29672_val-0.05692_epoch135.chkpt, checkpoint.tuning_rank_spearman-0.30572_val-0.07462_epoch130.chkpt
2025-12-25 12:14:30 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-25_10-22-44/model_checkpoints/checkpoint.tuning_rank_spearman-0.30572_val-0.07462_epoch130.chkpt
2025-12-25 12:14:30 INFO Best validation loss: tensor(0.3057)
2025-12-25 12:14:30 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-25_10-22-44/model_checkpoints/checkpoint.tuning_rank_spearman-0.30572_val-0.07462_epoch130.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-25_10-22-44/model_checkpoints/checkpoint.tuning_rank_spearman-0.30572_val-0.07462_epoch130.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-25 12:14:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.074616
2025-12-25 12:14:46 INFO Tuning ranking metrics: regret=0.083422 spearman=0.305715 (groups=37, skipped=311)
2025-12-25 12:14:46 INFO Epoch 181 | val_loss=0.074616 | best_val_loss=0.305715
2025-12-25 12:14:47 INFO Validation metrics: [{'val_loss': 0.07461600750684738, 'tuning_rank_regret': 0.08342187106609344, 'tuning_rank_spearman': 0.3057154417037964, 'val_pearson_corr': 0.7562667727470398, 'val_spearman_corr': 0.7583931684494019, 'val_rank_regret': 0.13583366572856903, 'val_rank_spearman': 0.09874939918518066}]
2025-12-25 12:14:47 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.30572_val-0.07462_epoch130.chkpt
2025-12-25 12:14:47 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.28892_val-0.05383_epoch093.chkpt
2025-12-25 12:14:47 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.29672_val-0.05692_epoch135.chkpt
2025-12-25 12:14:47 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.04719_epoch121.ckpt
2025-12-25 12:14:47 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.08342187106609344
  tuning_rank_spearman      0.3057154417037964
        val_loss            0.07461600750684738
    val_pearson_corr        0.7562667727470398
     val_rank_regret        0.13583366572856903
    val_rank_spearman       0.09874939918518066
    val_spearman_corr       0.7583931684494019
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run polish_lr_low_seed101_2025-12-25_10-22-44 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed101_2025-12-25_10-22-44
[train_cli][batch] job 'polish_lr_low_seed101' finished.
[train_cli][batch] (3/6) running job 'polish_seed555' -> run_name=polish_seed555_2025-12-25_12-14-50
[train_cli] run_id=polish_seed555_2025-12-25_12-14-50 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-25_12-14-50/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-25_12-14-50 --git-commit 9b1bb2b320 --git-dirty
2025-12-25 12:14:54 INFO git_commit = 9b1bb2b320 (dirty)
2025-12-25 12:14:54 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-25 12:14:54 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-25_12-14-50/config/config.yaml
2025-12-25 12:14:54 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data
2025-12-25 12:14:54 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-25 12:14:54 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-25 12:14:54 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-25_12-14-50
2025-12-25 12:14:54 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-25 12:14:54 INFO   metadata_path = None
2025-12-25 12:14:54 INFO   summary_path = None
2025-12-25 12:14:54 INFO   accelerator = cpu
2025-12-25 12:14:54 INFO   devices = 1
2025-12-25 12:14:54 INFO   attention_head = 8
2025-12-25 12:14:54 INFO   pooling_type = mean
2025-12-25 12:14:54 INFO   model_self_loops = False
2025-12-25 12:14:54 INFO   model_self_loop_fill = mean
2025-12-25 12:14:54 INFO   model_residual = False
2025-12-25 12:14:54 INFO   batch_size = 48
2025-12-25 12:14:54 INFO   learning_rate = 0.003
2025-12-25 12:14:54 INFO   num_epochs = 320
2025-12-25 12:14:54 INFO   accumulate_grad_batches = 8
2025-12-25 12:14:54 INFO   seed = 555
2025-12-25 12:14:54 INFO   num_workers = 2
2025-12-25 12:14:54 INFO   precision = 32
2025-12-25 12:14:54 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-25 12:14:54 INFO   early_stopping_patience = 40
2025-12-25 12:14:54 INFO   lr_scheduler_patience = 20
2025-12-25 12:14:54 INFO   lr_scheduler_factor = 0.3
2025-12-25 12:14:54 INFO   fast_dev_run = False
2025-12-25 12:14:54 INFO   limit_train_batches = None
2025-12-25 12:14:54 INFO   limit_val_batches = None
2025-12-25 12:14:54 INFO   log_lr = False
2025-12-25 12:14:54 INFO   progress_bar_refresh_rate = 0
2025-12-25 12:14:54 INFO   log_every_n_steps = 100
2025-12-25 12:14:54 INFO   use_val_spearman_as_secondary = True
2025-12-25 12:14:54 INFO   spearman_secondary_min_delta = 0.0
2025-12-25 12:14:54 INFO   spearman_secondary_weight = 1.0
2025-12-25 12:14:54 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-25 12:14:54 INFO   tuning_max_samples = 500
2025-12-25 12:14:54 INFO   tuning_fraction = None
2025-12-25 12:14:54 INFO   tuning_eval_every = 1
2025-12-25 12:14:54 INFO   rank_loss_weight = 0.0
2025-12-25 12:14:54 INFO   rank_loss_margin = 0.0
2025-12-25 12:14:54 INFO   rank_loss_mode = hinge
2025-12-25 12:14:54 INFO   rank_loss_grouped = True
2025-12-25 12:14:54 INFO   variance_reduction_enabled = False
2025-12-25 12:14:54 INFO   variance_reduction_method = topk_avg
2025-12-25 12:14:54 INFO   variance_reduction_top_k = 3
2025-12-25 12:14:54 INFO   coverage_minimum = 0.0
2025-12-25 12:14:54 INFO   coverage_fail_on_missing = False
2025-12-25 12:14:54 INFO   graph_load_profiling = False
2025-12-25 12:14:54 INFO   graph_load_top_k = 5
2025-12-25 12:14:54 INFO   enable_graph_cache = True
2025-12-25 12:14:54 INFO   graph_cache_size = 256
2025-12-25 12:14:54 INFO   canonicalize_on_load = False
2025-12-25 12:14:54 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-25 12:14:54 INFO   edge_schema = {}
2025-12-25 12:14:54 INFO   topology_schema = {}
Seed set to 555
2025-12-25 12:14:54 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-25 12:14:54 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 12:14:54 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-25 12:14:54 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 12:14:54 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-25 12:14:54 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 12:14:55 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-25 12:14:55 INFO Tuning group stats: groups=368 groups>=2=39 singletons=329 max_group=9
2025-12-25 12:14:55 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-25_12-14-50/dataset_coverage.json
2025-12-25 12:14:55 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-25_12-14-50/dataset_coverage.json for details.
2025-12-25 12:14:55 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-25_12-14-50/dataset_coverage.json for details.
2025-12-25 12:14:55 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-25_12-14-50/dataset_coverage.json for details.
2025-12-25 12:14:55 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-25_12-14-50/schema_summary.json
2025-12-25 12:14:55 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-25_12-14-50/feature_metadata.json
2025-12-25 12:14:55 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-25 12:14:55 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/null_topology/feature-config.yaml.null.10A, sha256=f618659ace5620de7e794485915dadd4243f3ec2ca6726b4a9af3989817a8579
2025-12-25 12:14:55 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/work/edge_features)
2025-12-25 12:14:55 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json
2025-12-25 12:14:55 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-25_12-14-50/schema_summary.json
2025-12-25 12:14:55 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-25 12:14:55 INFO Topology: topology/persistence_null/v1 supporting the 172-dimensional node features.
2025-12-25 12:14:55 INFO Node: node/dssp_topo_merge/v1; metadata lists 172 feature columns matching the .pt tensor.
2025-12-25 12:14:55 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-25 12:14:55 INFO → Total feature dimensionality observed and confirmed: node_dim = 172, edge_dim = 11.
2025-12-25 12:14:55 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-25 12:14:55 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 172,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 172,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-25_12-14-50/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge/v1",
      "alias": "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA",
      "jobs": 16,
      "summary": "DSSP-derived node features merged with topology statistics."
    },
    "topology": {
      "id": "topology/persistence_null/v1",
      "alias": "Null topology (constant zeros) = 140D ablation",
      "jobs": 16,
      "summary": "Topology ablation: constant features with PH-compatible schema."
    }
  },
  "notes": []
}
2025-12-25 12:14:55 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-25 12:14:55 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=90250eb5b360432d9a3ad76c9a4aae8c)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-25 12:14:56 INFO Starting training (fast_dev_run=False)
2025-12-25 12:14:56 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-25_12-14-50/model_checkpoints exists and is not empty.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 5.5 K  | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
165 K     Trainable params
0         Non-trainable params
165 K     Total params
0.662     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-25 12:15:11 INFO Epoch 000 | 25% complete (batch 46/181)
2025-12-25 12:15:12 INFO Epoch 000 | 50% complete (batch 91/181)
2025-12-25 12:15:13 INFO Epoch 000 | 75% complete (batch 136/181)
2025-12-25 12:15:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.142785
2025-12-25 12:15:28 INFO Tuning ranking metrics: regret=0.152464 spearman=0.090354 (groups=39, skipped=329)
2025-12-25 12:15:28 INFO Epoch 000 | val_loss=0.142785
Metric tuning_rank_spearman improved. New best score: 0.090
2025-12-25 12:15:37 INFO Epoch 001 | 25% complete (batch 46/181)
2025-12-25 12:15:38 INFO Epoch 001 | 50% complete (batch 91/181)
2025-12-25 12:15:39 INFO Epoch 001 | 75% complete (batch 136/181)
2025-12-25 12:15:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.217007
2025-12-25 12:15:53 INFO Tuning ranking metrics: regret=0.115090 spearman=0.132418 (groups=39, skipped=329)
2025-12-25 12:15:53 INFO Epoch 001 | train_mse=0.150250 | val_loss=0.139656 | best_val_loss=0.090354
Metric tuning_rank_spearman improved by 0.042 >= min_delta = 0.0. New best score: 0.132
2025-12-25 12:16:02 INFO Epoch 002 | 25% complete (batch 46/181)
2025-12-25 12:16:03 INFO Epoch 002 | 50% complete (batch 91/181)
2025-12-25 12:16:04 INFO Epoch 002 | 75% complete (batch 136/181)
2025-12-25 12:16:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.318325
2025-12-25 12:16:19 INFO Tuning ranking metrics: regret=0.098465 spearman=0.216361 (groups=39, skipped=329)
2025-12-25 12:16:19 INFO Epoch 002 | train_mse=0.149768 | val_loss=0.136022 | best_val_loss=0.132418
Metric tuning_rank_spearman improved by 0.084 >= min_delta = 0.0. New best score: 0.216
2025-12-25 12:16:28 INFO Epoch 003 | 25% complete (batch 46/181)
2025-12-25 12:16:29 INFO Epoch 003 | 50% complete (batch 91/181)
2025-12-25 12:16:30 INFO Epoch 003 | 75% complete (batch 136/181)
2025-12-25 12:16:40 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.333493
2025-12-25 12:16:45 INFO Tuning ranking metrics: regret=0.108925 spearman=0.255495 (groups=39, skipped=329)
2025-12-25 12:16:45 INFO Epoch 003 | train_mse=0.145528 | val_loss=0.115387 | best_val_loss=0.216361
Metric tuning_rank_spearman improved by 0.039 >= min_delta = 0.0. New best score: 0.255
2025-12-25 12:16:54 INFO Epoch 004 | 25% complete (batch 46/181)
2025-12-25 12:16:55 INFO Epoch 004 | 50% complete (batch 91/181)
2025-12-25 12:16:56 INFO Epoch 004 | 75% complete (batch 136/181)
2025-12-25 12:17:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.379278
2025-12-25 12:17:11 INFO Tuning ranking metrics: regret=0.075024 spearman=0.315385 (groups=39, skipped=329)
2025-12-25 12:17:11 INFO Epoch 004 | train_mse=0.136681 | val_loss=0.105602 | best_val_loss=0.255495
Metric tuning_rank_spearman improved by 0.060 >= min_delta = 0.0. New best score: 0.315
2025-12-25 12:17:20 INFO Epoch 005 | 25% complete (batch 46/181)
2025-12-25 12:17:21 INFO Epoch 005 | 50% complete (batch 91/181)
2025-12-25 12:17:22 INFO Epoch 005 | 75% complete (batch 136/181)
2025-12-25 12:17:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.409712
2025-12-25 12:17:37 INFO Tuning ranking metrics: regret=0.066549 spearman=0.364286 (groups=39, skipped=329)
2025-12-25 12:17:37 INFO Epoch 005 | train_mse=0.119841 | val_loss=0.113230 | best_val_loss=0.315385
Metric tuning_rank_spearman improved by 0.049 >= min_delta = 0.0. New best score: 0.364
2025-12-25 12:17:45 INFO Epoch 006 | 25% complete (batch 46/181)
2025-12-25 12:17:46 INFO Epoch 006 | 50% complete (batch 91/181)
2025-12-25 12:17:47 INFO Epoch 006 | 75% complete (batch 136/181)
2025-12-25 12:17:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.454927
2025-12-25 12:18:01 INFO Tuning ranking metrics: regret=0.115467 spearman=0.251954 (groups=39, skipped=329)
2025-12-25 12:18:01 INFO Epoch 006 | train_mse=0.111820 | val_loss=0.097777 | best_val_loss=0.364286
2025-12-25 12:18:10 INFO Epoch 007 | 25% complete (batch 46/181)
2025-12-25 12:18:11 INFO Epoch 007 | 50% complete (batch 91/181)
2025-12-25 12:18:12 INFO Epoch 007 | 75% complete (batch 136/181)
2025-12-25 12:18:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.463090
2025-12-25 12:18:27 INFO Tuning ranking metrics: regret=0.080045 spearman=0.309463 (groups=39, skipped=329)
2025-12-25 12:18:27 INFO Epoch 007 | train_mse=0.101187 | val_loss=0.098048 | best_val_loss=0.364286
2025-12-25 12:18:36 INFO Epoch 008 | 25% complete (batch 46/181)
2025-12-25 12:18:37 INFO Epoch 008 | 50% complete (batch 91/181)
2025-12-25 12:18:38 INFO Epoch 008 | 75% complete (batch 136/181)
2025-12-25 12:18:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.486189
2025-12-25 12:18:53 INFO Tuning ranking metrics: regret=0.090747 spearman=0.346886 (groups=39, skipped=329)
2025-12-25 12:18:53 INFO Epoch 008 | train_mse=0.105614 | val_loss=0.092170 | best_val_loss=0.364286
2025-12-25 12:19:02 INFO Epoch 009 | 25% complete (batch 46/181)
2025-12-25 12:19:03 INFO Epoch 009 | 50% complete (batch 91/181)
2025-12-25 12:19:04 INFO Epoch 009 | 75% complete (batch 136/181)
2025-12-25 12:19:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.524294
2025-12-25 12:19:19 INFO Tuning ranking metrics: regret=0.103982 spearman=0.354701 (groups=39, skipped=329)
2025-12-25 12:19:19 INFO Epoch 009 | train_mse=0.107613 | val_loss=0.088471 | best_val_loss=0.364286
2025-12-25 12:19:28 INFO Epoch 010 | 25% complete (batch 46/181)
2025-12-25 12:19:29 INFO Epoch 010 | 50% complete (batch 91/181)
2025-12-25 12:19:30 INFO Epoch 010 | 75% complete (batch 136/181)
2025-12-25 12:19:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.523440
2025-12-25 12:19:44 INFO Tuning ranking metrics: regret=0.106217 spearman=0.314347 (groups=39, skipped=329)
2025-12-25 12:19:44 INFO Epoch 010 | train_mse=0.112599 | val_loss=0.086961 | best_val_loss=0.364286
2025-12-25 12:19:53 INFO Epoch 011 | 25% complete (batch 46/181)
2025-12-25 12:19:54 INFO Epoch 011 | 50% complete (batch 91/181)
2025-12-25 12:19:55 INFO Epoch 011 | 75% complete (batch 136/181)
2025-12-25 12:20:04 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.496984
2025-12-25 12:20:09 INFO Tuning ranking metrics: regret=0.119740 spearman=0.339683 (groups=39, skipped=329)
2025-12-25 12:20:09 INFO Epoch 011 | train_mse=0.094110 | val_loss=0.104581 | best_val_loss=0.364286
2025-12-25 12:20:18 INFO Epoch 012 | 25% complete (batch 46/181)
2025-12-25 12:20:19 INFO Epoch 012 | 50% complete (batch 91/181)
2025-12-25 12:20:20 INFO Epoch 012 | 75% complete (batch 136/181)
2025-12-25 12:20:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.496366
2025-12-25 12:20:34 INFO Tuning ranking metrics: regret=0.100399 spearman=0.362027 (groups=39, skipped=329)
2025-12-25 12:20:34 INFO Epoch 012 | train_mse=0.090559 | val_loss=0.105232 | best_val_loss=0.364286
2025-12-25 12:20:42 INFO Epoch 013 | 25% complete (batch 46/181)
2025-12-25 12:20:43 INFO Epoch 013 | 50% complete (batch 91/181)
2025-12-25 12:20:44 INFO Epoch 013 | 75% complete (batch 136/181)
2025-12-25 12:20:53 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.510808
2025-12-25 12:20:58 INFO Tuning ranking metrics: regret=0.117248 spearman=0.294994 (groups=39, skipped=329)
2025-12-25 12:20:58 INFO Epoch 013 | train_mse=0.117466 | val_loss=0.090488 | best_val_loss=0.364286
2025-12-25 12:21:07 INFO Epoch 014 | 25% complete (batch 46/181)
2025-12-25 12:21:08 INFO Epoch 014 | 50% complete (batch 91/181)
2025-12-25 12:21:09 INFO Epoch 014 | 75% complete (batch 136/181)
2025-12-25 12:21:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.487422
2025-12-25 12:21:23 INFO Tuning ranking metrics: regret=0.111279 spearman=0.275763 (groups=39, skipped=329)
2025-12-25 12:21:23 INFO Epoch 014 | train_mse=0.092091 | val_loss=0.089494 | best_val_loss=0.364286
2025-12-25 12:21:31 INFO Epoch 015 | 25% complete (batch 46/181)
2025-12-25 12:21:32 INFO Epoch 015 | 50% complete (batch 91/181)
2025-12-25 12:21:33 INFO Epoch 015 | 75% complete (batch 136/181)
2025-12-25 12:21:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.503878
2025-12-25 12:21:47 INFO Tuning ranking metrics: regret=0.120014 spearman=0.308120 (groups=39, skipped=329)
2025-12-25 12:21:47 INFO Epoch 015 | train_mse=0.107290 | val_loss=0.084674 | best_val_loss=0.364286
2025-12-25 12:21:56 INFO Epoch 016 | 25% complete (batch 46/181)
2025-12-25 12:21:57 INFO Epoch 016 | 50% complete (batch 91/181)
2025-12-25 12:21:58 INFO Epoch 016 | 75% complete (batch 136/181)
2025-12-25 12:22:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.528316
2025-12-25 12:22:12 INFO Tuning ranking metrics: regret=0.098277 spearman=0.257753 (groups=39, skipped=329)
2025-12-25 12:22:12 INFO Epoch 016 | train_mse=0.091112 | val_loss=0.090569 | best_val_loss=0.364286
2025-12-25 12:22:21 INFO Epoch 017 | 25% complete (batch 46/181)
2025-12-25 12:22:22 INFO Epoch 017 | 50% complete (batch 91/181)
2025-12-25 12:22:23 INFO Epoch 017 | 75% complete (batch 136/181)
2025-12-25 12:22:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.534369
2025-12-25 12:22:36 INFO Tuning ranking metrics: regret=0.102648 spearman=0.275763 (groups=39, skipped=329)
2025-12-25 12:22:36 INFO Epoch 017 | train_mse=0.106558 | val_loss=0.086562 | best_val_loss=0.364286
2025-12-25 12:22:45 INFO Epoch 018 | 25% complete (batch 46/181)
2025-12-25 12:22:46 INFO Epoch 018 | 50% complete (batch 91/181)
2025-12-25 12:22:47 INFO Epoch 018 | 75% complete (batch 136/181)
2025-12-25 12:22:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.524210
2025-12-25 12:23:01 INFO Tuning ranking metrics: regret=0.079793 spearman=0.409646 (groups=39, skipped=329)
2025-12-25 12:23:01 INFO Epoch 018 | train_mse=0.091339 | val_loss=0.101466 | best_val_loss=0.364286
Metric tuning_rank_spearman improved by 0.045 >= min_delta = 0.0. New best score: 0.410
2025-12-25 12:23:10 INFO Epoch 019 | 25% complete (batch 46/181)
2025-12-25 12:23:11 INFO Epoch 019 | 50% complete (batch 91/181)
2025-12-25 12:23:12 INFO Epoch 019 | 75% complete (batch 136/181)
2025-12-25 12:23:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.514919
2025-12-25 12:23:26 INFO Tuning ranking metrics: regret=0.089828 spearman=0.325641 (groups=39, skipped=329)
2025-12-25 12:23:26 INFO Epoch 019 | train_mse=0.089040 | val_loss=0.095918 | best_val_loss=0.409646
2025-12-25 12:23:34 INFO Epoch 020 | 25% complete (batch 46/181)
2025-12-25 12:23:35 INFO Epoch 020 | 50% complete (batch 91/181)
2025-12-25 12:23:36 INFO Epoch 020 | 75% complete (batch 136/181)
2025-12-25 12:23:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.498844
2025-12-25 12:23:51 INFO Tuning ranking metrics: regret=0.103569 spearman=0.274725 (groups=39, skipped=329)
2025-12-25 12:23:51 INFO Epoch 020 | train_mse=0.088244 | val_loss=0.094304 | best_val_loss=0.409646
2025-12-25 12:23:59 INFO Epoch 021 | 25% complete (batch 46/181)
2025-12-25 12:24:00 INFO Epoch 021 | 50% complete (batch 91/181)
2025-12-25 12:24:01 INFO Epoch 021 | 75% complete (batch 136/181)
2025-12-25 12:24:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.527331
2025-12-25 12:24:15 INFO Tuning ranking metrics: regret=0.094380 spearman=0.263736 (groups=39, skipped=329)
2025-12-25 12:24:15 INFO Epoch 021 | train_mse=0.083045 | val_loss=0.094824 | best_val_loss=0.409646
2025-12-25 12:24:24 INFO Epoch 022 | 25% complete (batch 46/181)
2025-12-25 12:24:25 INFO Epoch 022 | 50% complete (batch 91/181)
2025-12-25 12:24:26 INFO Epoch 022 | 75% complete (batch 136/181)
2025-12-25 12:24:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.543996
2025-12-25 12:24:40 INFO Tuning ranking metrics: regret=0.113812 spearman=0.179731 (groups=39, skipped=329)
2025-12-25 12:24:40 INFO Epoch 022 | train_mse=0.092203 | val_loss=0.084346 | best_val_loss=0.409646
2025-12-25 12:24:49 INFO Epoch 023 | 25% complete (batch 46/181)
2025-12-25 12:24:49 INFO Epoch 023 | 50% complete (batch 91/181)
2025-12-25 12:24:50 INFO Epoch 023 | 75% complete (batch 136/181)
2025-12-25 12:24:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.548484
2025-12-25 12:25:04 INFO Tuning ranking metrics: regret=0.111097 spearman=0.216667 (groups=39, skipped=329)
2025-12-25 12:25:04 INFO Epoch 023 | train_mse=0.103573 | val_loss=0.084402 | best_val_loss=0.409646
2025-12-25 12:25:13 INFO Epoch 024 | 25% complete (batch 46/181)
2025-12-25 12:25:14 INFO Epoch 024 | 50% complete (batch 91/181)
2025-12-25 12:25:15 INFO Epoch 024 | 75% complete (batch 136/181)
2025-12-25 12:25:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.533843
2025-12-25 12:25:29 INFO Tuning ranking metrics: regret=0.111480 spearman=0.197924 (groups=39, skipped=329)
2025-12-25 12:25:29 INFO Epoch 024 | train_mse=0.089339 | val_loss=0.083315 | best_val_loss=0.409646
2025-12-25 12:25:38 INFO Epoch 025 | 25% complete (batch 46/181)
2025-12-25 12:25:39 INFO Epoch 025 | 50% complete (batch 91/181)
2025-12-25 12:25:40 INFO Epoch 025 | 75% complete (batch 136/181)
2025-12-25 12:25:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.545220
2025-12-25 12:25:54 INFO Tuning ranking metrics: regret=0.083448 spearman=0.258730 (groups=39, skipped=329)
2025-12-25 12:25:54 INFO Epoch 025 | train_mse=0.092155 | val_loss=0.080993 | best_val_loss=0.409646
2025-12-25 12:26:03 INFO Epoch 026 | 25% complete (batch 46/181)
2025-12-25 12:26:04 INFO Epoch 026 | 50% complete (batch 91/181)
2025-12-25 12:26:05 INFO Epoch 026 | 75% complete (batch 136/181)
2025-12-25 12:26:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.565942
2025-12-25 12:26:19 INFO Tuning ranking metrics: regret=0.103265 spearman=0.304029 (groups=39, skipped=329)
2025-12-25 12:26:19 INFO Epoch 026 | train_mse=0.089089 | val_loss=0.079067 | best_val_loss=0.409646
2025-12-25 12:26:28 INFO Epoch 027 | 25% complete (batch 46/181)
2025-12-25 12:26:29 INFO Epoch 027 | 50% complete (batch 91/181)
2025-12-25 12:26:30 INFO Epoch 027 | 75% complete (batch 136/181)
2025-12-25 12:26:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.543789
2025-12-25 12:26:44 INFO Tuning ranking metrics: regret=0.101952 spearman=0.298291 (groups=39, skipped=329)
2025-12-25 12:26:44 INFO Epoch 027 | train_mse=0.084794 | val_loss=0.091343 | best_val_loss=0.409646
2025-12-25 12:26:53 INFO Epoch 028 | 25% complete (batch 46/181)
2025-12-25 12:26:54 INFO Epoch 028 | 50% complete (batch 91/181)
2025-12-25 12:26:55 INFO Epoch 028 | 75% complete (batch 136/181)
2025-12-25 12:27:04 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.534386
2025-12-25 12:27:09 INFO Tuning ranking metrics: regret=0.115744 spearman=0.223932 (groups=39, skipped=329)
2025-12-25 12:27:09 INFO Epoch 028 | train_mse=0.090382 | val_loss=0.088339 | best_val_loss=0.409646
2025-12-25 12:27:18 INFO Epoch 029 | 25% complete (batch 46/181)
2025-12-25 12:27:19 INFO Epoch 029 | 50% complete (batch 91/181)
2025-12-25 12:27:20 INFO Epoch 029 | 75% complete (batch 136/181)
2025-12-25 12:27:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.513623
2025-12-25 12:27:34 INFO Tuning ranking metrics: regret=0.124025 spearman=0.236691 (groups=39, skipped=329)
2025-12-25 12:27:34 INFO Epoch 029 | train_mse=0.082151 | val_loss=0.083096 | best_val_loss=0.409646
2025-12-25 12:27:43 INFO Epoch 030 | 25% complete (batch 46/181)
2025-12-25 12:27:44 INFO Epoch 030 | 50% complete (batch 91/181)
2025-12-25 12:27:45 INFO Epoch 030 | 75% complete (batch 136/181)
2025-12-25 12:27:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.555919
2025-12-25 12:27:59 INFO Tuning ranking metrics: regret=0.127922 spearman=0.234921 (groups=39, skipped=329)
2025-12-25 12:27:59 INFO Epoch 030 | train_mse=0.082728 | val_loss=0.090414 | best_val_loss=0.409646
2025-12-25 12:28:07 INFO Epoch 031 | 25% complete (batch 46/181)
2025-12-25 12:28:08 INFO Epoch 031 | 50% complete (batch 91/181)
2025-12-25 12:28:09 INFO Epoch 031 | 75% complete (batch 136/181)
2025-12-25 12:28:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.543066
2025-12-25 12:28:23 INFO Tuning ranking metrics: regret=0.098236 spearman=0.165201 (groups=39, skipped=329)
2025-12-25 12:28:23 INFO Epoch 031 | train_mse=0.097220 | val_loss=0.084689 | best_val_loss=0.409646
2025-12-25 12:28:32 INFO Epoch 032 | 25% complete (batch 46/181)
2025-12-25 12:28:33 INFO Epoch 032 | 50% complete (batch 91/181)
2025-12-25 12:28:34 INFO Epoch 032 | 75% complete (batch 136/181)
2025-12-25 12:28:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.540983
2025-12-25 12:28:48 INFO Tuning ranking metrics: regret=0.112234 spearman=0.226923 (groups=39, skipped=329)
2025-12-25 12:28:48 INFO Epoch 032 | train_mse=0.090633 | val_loss=0.085028 | best_val_loss=0.409646
2025-12-25 12:28:57 INFO Epoch 033 | 25% complete (batch 46/181)
2025-12-25 12:28:58 INFO Epoch 033 | 50% complete (batch 91/181)
2025-12-25 12:28:59 INFO Epoch 033 | 75% complete (batch 136/181)
2025-12-25 12:29:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.545462
2025-12-25 12:29:13 INFO Tuning ranking metrics: regret=0.135401 spearman=0.119353 (groups=39, skipped=329)
2025-12-25 12:29:13 INFO Epoch 033 | train_mse=0.081925 | val_loss=0.081086 | best_val_loss=0.409646
2025-12-25 12:29:22 INFO Epoch 034 | 25% complete (batch 46/181)
2025-12-25 12:29:23 INFO Epoch 034 | 50% complete (batch 91/181)
2025-12-25 12:29:23 INFO Epoch 034 | 75% complete (batch 136/181)
2025-12-25 12:29:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.557355
2025-12-25 12:29:38 INFO Tuning ranking metrics: regret=0.081962 spearman=0.223016 (groups=39, skipped=329)
2025-12-25 12:29:38 INFO Epoch 034 | train_mse=0.072009 | val_loss=0.088492 | best_val_loss=0.409646
2025-12-25 12:29:46 INFO Epoch 035 | 25% complete (batch 46/181)
2025-12-25 12:29:47 INFO Epoch 035 | 50% complete (batch 91/181)
2025-12-25 12:29:48 INFO Epoch 035 | 75% complete (batch 136/181)
2025-12-25 12:29:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.526659
2025-12-25 12:30:02 INFO Tuning ranking metrics: regret=0.074262 spearman=0.346886 (groups=39, skipped=329)
2025-12-25 12:30:02 INFO Epoch 035 | train_mse=0.075801 | val_loss=0.092226 | best_val_loss=0.409646
2025-12-25 12:30:11 INFO Epoch 036 | 25% complete (batch 46/181)
2025-12-25 12:30:12 INFO Epoch 036 | 50% complete (batch 91/181)
2025-12-25 12:30:13 INFO Epoch 036 | 75% complete (batch 136/181)
2025-12-25 12:30:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.507343
2025-12-25 12:30:26 INFO Tuning ranking metrics: regret=0.118635 spearman=0.089744 (groups=39, skipped=329)
2025-12-25 12:30:26 INFO Epoch 036 | train_mse=0.079517 | val_loss=0.098531 | best_val_loss=0.409646
2025-12-25 12:30:35 INFO Epoch 037 | 25% complete (batch 46/181)
2025-12-25 12:30:36 INFO Epoch 037 | 50% complete (batch 91/181)
2025-12-25 12:30:37 INFO Epoch 037 | 75% complete (batch 136/181)
2025-12-25 12:30:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.550391
2025-12-25 12:30:51 INFO Tuning ranking metrics: regret=0.082028 spearman=0.132173 (groups=39, skipped=329)
2025-12-25 12:30:51 INFO Epoch 037 | train_mse=0.097990 | val_loss=0.078705 | best_val_loss=0.409646
2025-12-25 12:30:59 INFO Epoch 038 | 25% complete (batch 46/181)
2025-12-25 12:31:00 INFO Epoch 038 | 50% complete (batch 91/181)
2025-12-25 12:31:01 INFO Epoch 038 | 75% complete (batch 136/181)
2025-12-25 12:31:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.554265
2025-12-25 12:31:15 INFO Tuning ranking metrics: regret=0.114847 spearman=0.167399 (groups=39, skipped=329)
2025-12-25 12:31:15 INFO Epoch 038 | train_mse=0.074789 | val_loss=0.087440 | best_val_loss=0.409646
2025-12-25 12:31:23 INFO Epoch 039 | 25% complete (batch 46/181)
2025-12-25 12:31:24 INFO Epoch 039 | 50% complete (batch 91/181)
2025-12-25 12:31:25 INFO Epoch 039 | 75% complete (batch 136/181)
2025-12-25 12:31:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.592047
2025-12-25 12:31:39 INFO Tuning ranking metrics: regret=0.124629 spearman=0.151038 (groups=39, skipped=329)
2025-12-25 12:31:39 INFO Epoch 039 | train_mse=0.080600 | val_loss=0.081785 | best_val_loss=0.409646
2025-12-25 12:31:48 INFO Epoch 040 | 25% complete (batch 46/181)
2025-12-25 12:31:49 INFO Epoch 040 | 50% complete (batch 91/181)
2025-12-25 12:31:50 INFO Epoch 040 | 75% complete (batch 136/181)
2025-12-25 12:31:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.577645
2025-12-25 12:32:03 INFO Tuning ranking metrics: regret=0.117620 spearman=0.216911 (groups=39, skipped=329)
2025-12-25 12:32:03 INFO Epoch 040 | train_mse=0.084044 | val_loss=0.080643 | best_val_loss=0.409646
2025-12-25 12:32:12 INFO Epoch 041 | 25% complete (batch 46/181)
2025-12-25 12:32:13 INFO Epoch 041 | 50% complete (batch 91/181)
2025-12-25 12:32:14 INFO Epoch 041 | 75% complete (batch 136/181)
2025-12-25 12:32:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.551713
2025-12-25 12:32:27 INFO Tuning ranking metrics: regret=0.138557 spearman=0.197985 (groups=39, skipped=329)
2025-12-25 12:32:27 INFO Epoch 041 | train_mse=0.063994 | val_loss=0.091753 | best_val_loss=0.409646
2025-12-25 12:32:36 INFO Epoch 042 | 25% complete (batch 46/181)
2025-12-25 12:32:37 INFO Epoch 042 | 50% complete (batch 91/181)
2025-12-25 12:32:38 INFO Epoch 042 | 75% complete (batch 136/181)
2025-12-25 12:32:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.547907
2025-12-25 12:32:52 INFO Tuning ranking metrics: regret=0.112322 spearman=0.258791 (groups=39, skipped=329)
2025-12-25 12:32:52 INFO Epoch 042 | train_mse=0.070369 | val_loss=0.088450 | best_val_loss=0.409646
2025-12-25 12:33:00 INFO Epoch 043 | 25% complete (batch 46/181)
2025-12-25 12:33:01 INFO Epoch 043 | 50% complete (batch 91/181)
2025-12-25 12:33:02 INFO Epoch 043 | 75% complete (batch 136/181)
2025-12-25 12:33:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.550468
2025-12-25 12:33:16 INFO Tuning ranking metrics: regret=0.118486 spearman=0.157021 (groups=39, skipped=329)
2025-12-25 12:33:16 INFO Epoch 043 | train_mse=0.065465 | val_loss=0.079651 | best_val_loss=0.409646
2025-12-25 12:33:25 INFO Epoch 044 | 25% complete (batch 46/181)
2025-12-25 12:33:25 INFO Epoch 044 | 50% complete (batch 91/181)
2025-12-25 12:33:26 INFO Epoch 044 | 75% complete (batch 136/181)
2025-12-25 12:33:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.551370
2025-12-25 12:33:40 INFO Tuning ranking metrics: regret=0.098702 spearman=0.172283 (groups=39, skipped=329)
2025-12-25 12:33:40 INFO Epoch 044 | train_mse=0.096900 | val_loss=0.088760 | best_val_loss=0.409646
2025-12-25 12:33:49 INFO Epoch 045 | 25% complete (batch 46/181)
2025-12-25 12:33:50 INFO Epoch 045 | 50% complete (batch 91/181)
2025-12-25 12:33:50 INFO Epoch 045 | 75% complete (batch 136/181)
2025-12-25 12:33:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.534279
2025-12-25 12:34:04 INFO Tuning ranking metrics: regret=0.094065 spearman=0.251404 (groups=39, skipped=329)
2025-12-25 12:34:04 INFO Epoch 045 | train_mse=0.081371 | val_loss=0.087825 | best_val_loss=0.409646
2025-12-25 12:34:13 INFO Epoch 046 | 25% complete (batch 46/181)
2025-12-25 12:34:14 INFO Epoch 046 | 50% complete (batch 91/181)
2025-12-25 12:34:15 INFO Epoch 046 | 75% complete (batch 136/181)
2025-12-25 12:34:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.520261
2025-12-25 12:34:29 INFO Tuning ranking metrics: regret=0.099732 spearman=0.181929 (groups=39, skipped=329)
2025-12-25 12:34:29 INFO Epoch 046 | train_mse=0.065878 | val_loss=0.096965 | best_val_loss=0.409646
2025-12-25 12:34:37 INFO Epoch 047 | 25% complete (batch 46/181)
2025-12-25 12:34:38 INFO Epoch 047 | 50% complete (batch 91/181)
2025-12-25 12:34:39 INFO Epoch 047 | 75% complete (batch 136/181)
2025-12-25 12:34:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.551486
2025-12-25 12:34:53 INFO Tuning ranking metrics: regret=0.101635 spearman=0.132784 (groups=39, skipped=329)
2025-12-25 12:34:53 INFO Epoch 047 | train_mse=0.089028 | val_loss=0.075816 | best_val_loss=0.409646
2025-12-25 12:35:02 INFO Epoch 048 | 25% complete (batch 46/181)
2025-12-25 12:35:02 INFO Epoch 048 | 50% complete (batch 91/181)
2025-12-25 12:35:03 INFO Epoch 048 | 75% complete (batch 136/181)
2025-12-25 12:35:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.572669
2025-12-25 12:35:17 INFO Tuning ranking metrics: regret=0.117213 spearman=0.179731 (groups=39, skipped=329)
2025-12-25 12:35:17 INFO Epoch 048 | train_mse=0.094488 | val_loss=0.077789 | best_val_loss=0.409646
2025-12-25 12:35:26 INFO Epoch 049 | 25% complete (batch 46/181)
2025-12-25 12:35:27 INFO Epoch 049 | 50% complete (batch 91/181)
2025-12-25 12:35:27 INFO Epoch 049 | 75% complete (batch 136/181)
2025-12-25 12:35:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.560526
2025-12-25 12:35:41 INFO Tuning ranking metrics: regret=0.115523 spearman=0.234554 (groups=39, skipped=329)
2025-12-25 12:35:41 INFO Epoch 049 | train_mse=0.069910 | val_loss=0.079050 | best_val_loss=0.409646
2025-12-25 12:35:50 INFO Epoch 050 | 25% complete (batch 46/181)
2025-12-25 12:35:51 INFO Epoch 050 | 50% complete (batch 91/181)
2025-12-25 12:35:51 INFO Epoch 050 | 75% complete (batch 136/181)
2025-12-25 12:36:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.537987
2025-12-25 12:36:05 INFO Tuning ranking metrics: regret=0.113754 spearman=0.103480 (groups=39, skipped=329)
2025-12-25 12:36:05 INFO Epoch 050 | train_mse=0.072671 | val_loss=0.101757 | best_val_loss=0.409646
2025-12-25 12:36:14 INFO Epoch 051 | 25% complete (batch 46/181)
2025-12-25 12:36:15 INFO Epoch 051 | 50% complete (batch 91/181)
2025-12-25 12:36:16 INFO Epoch 051 | 75% complete (batch 136/181)
2025-12-25 12:36:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.562603
2025-12-25 12:36:30 INFO Tuning ranking metrics: regret=0.121005 spearman=0.140110 (groups=39, skipped=329)
2025-12-25 12:36:30 INFO Epoch 051 | train_mse=0.100641 | val_loss=0.099693 | best_val_loss=0.409646
2025-12-25 12:36:38 INFO Epoch 052 | 25% complete (batch 46/181)
2025-12-25 12:36:39 INFO Epoch 052 | 50% complete (batch 91/181)
2025-12-25 12:36:40 INFO Epoch 052 | 75% complete (batch 136/181)
2025-12-25 12:36:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.602797
2025-12-25 12:36:54 INFO Tuning ranking metrics: regret=0.102159 spearman=0.181074 (groups=39, skipped=329)
2025-12-25 12:36:54 INFO Epoch 052 | train_mse=0.089684 | val_loss=0.073600 | best_val_loss=0.409646
2025-12-25 12:37:03 INFO Epoch 053 | 25% complete (batch 46/181)
2025-12-25 12:37:04 INFO Epoch 053 | 50% complete (batch 91/181)
2025-12-25 12:37:05 INFO Epoch 053 | 75% complete (batch 136/181)
2025-12-25 12:37:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.600943
2025-12-25 12:37:19 INFO Tuning ranking metrics: regret=0.101053 spearman=0.197497 (groups=39, skipped=329)
2025-12-25 12:37:19 INFO Epoch 053 | train_mse=0.085203 | val_loss=0.077600 | best_val_loss=0.409646
2025-12-25 12:37:27 INFO Epoch 054 | 25% complete (batch 46/181)
2025-12-25 12:37:28 INFO Epoch 054 | 50% complete (batch 91/181)
2025-12-25 12:37:29 INFO Epoch 054 | 75% complete (batch 136/181)
2025-12-25 12:37:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.584640
2025-12-25 12:37:43 INFO Tuning ranking metrics: regret=0.103339 spearman=0.225641 (groups=39, skipped=329)
2025-12-25 12:37:43 INFO Epoch 054 | train_mse=0.084265 | val_loss=0.073866 | best_val_loss=0.409646
2025-12-25 12:37:52 INFO Epoch 055 | 25% complete (batch 46/181)
2025-12-25 12:37:52 INFO Epoch 055 | 50% complete (batch 91/181)
2025-12-25 12:37:53 INFO Epoch 055 | 75% complete (batch 136/181)
2025-12-25 12:38:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.573921
2025-12-25 12:38:07 INFO Tuning ranking metrics: regret=0.104467 spearman=0.109585 (groups=39, skipped=329)
2025-12-25 12:38:07 INFO Epoch 055 | train_mse=0.073206 | val_loss=0.083814 | best_val_loss=0.409646
2025-12-25 12:38:16 INFO Epoch 056 | 25% complete (batch 46/181)
2025-12-25 12:38:17 INFO Epoch 056 | 50% complete (batch 91/181)
2025-12-25 12:38:18 INFO Epoch 056 | 75% complete (batch 136/181)
2025-12-25 12:38:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.550887
2025-12-25 12:38:32 INFO Tuning ranking metrics: regret=0.115692 spearman=0.092063 (groups=39, skipped=329)
2025-12-25 12:38:32 INFO Epoch 056 | train_mse=0.074718 | val_loss=0.112885 | best_val_loss=0.409646
2025-12-25 12:38:41 INFO Epoch 057 | 25% complete (batch 46/181)
2025-12-25 12:38:41 INFO Epoch 057 | 50% complete (batch 91/181)
2025-12-25 12:38:42 INFO Epoch 057 | 75% complete (batch 136/181)
2025-12-25 12:38:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.445381
2025-12-25 12:38:56 INFO Tuning ranking metrics: regret=0.090780 spearman=0.352381 (groups=39, skipped=329)
2025-12-25 12:38:56 INFO Epoch 057 | train_mse=0.082399 | val_loss=0.093624 | best_val_loss=0.409646
2025-12-25 12:39:05 INFO Epoch 058 | 25% complete (batch 46/181)
2025-12-25 12:39:06 INFO Epoch 058 | 50% complete (batch 91/181)
2025-12-25 12:39:07 INFO Epoch 058 | 75% complete (batch 136/181)
2025-12-25 12:39:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.541975
2025-12-25 12:39:21 INFO Tuning ranking metrics: regret=0.081583 spearman=0.264530 (groups=39, skipped=329)
2025-12-25 12:39:21 INFO Epoch 058 | train_mse=0.110337 | val_loss=0.076592 | best_val_loss=0.409646
Monitored metric tuning_rank_spearman did not improve in the last 40 records. Best score: 0.410. Signaling Trainer to stop.
2025-12-25 12:39:22 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.36203_val-0.10523_epoch012.chkpt, checkpoint.tuning_rank_spearman-0.36429_val-0.11323_epoch005.chkpt, checkpoint.tuning_rank_spearman-0.40965_val-0.10147_epoch018.chkpt
2025-12-25 12:39:22 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-25_12-14-50/model_checkpoints/checkpoint.tuning_rank_spearman-0.40965_val-0.10147_epoch018.chkpt
2025-12-25 12:39:22 INFO Best validation loss: tensor(0.4096)
2025-12-25 12:39:22 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-25_12-14-50/model_checkpoints/checkpoint.tuning_rank_spearman-0.40965_val-0.10147_epoch018.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-25_12-14-50/model_checkpoints/checkpoint.tuning_rank_spearman-0.40965_val-0.10147_epoch018.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-25 12:39:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.101466
2025-12-25 12:39:34 INFO Tuning ranking metrics: regret=0.079793 spearman=0.409646 (groups=39, skipped=329)
2025-12-25 12:39:34 INFO Epoch 059 | val_loss=0.101466 | best_val_loss=0.409646
2025-12-25 12:39:35 INFO Validation metrics: [{'val_loss': 0.10146555304527283, 'tuning_rank_regret': 0.07979333400726318, 'tuning_rank_spearman': 0.4096459150314331, 'val_pearson_corr': 0.621629536151886, 'val_spearman_corr': 0.6108368039131165, 'val_rank_regret': 0.03458143398165703, 'val_rank_spearman': 0.2222222238779068}]
2025-12-25 12:39:35 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.40965_val-0.10147_epoch018.chkpt
2025-12-25 12:39:35 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.36429_val-0.11323_epoch005.chkpt
2025-12-25 12:39:35 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.36203_val-0.10523_epoch012.chkpt
2025-12-25 12:39:35 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.08467_epoch015.ckpt
2025-12-25 12:39:35 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.07979333400726318
  tuning_rank_spearman      0.4096459150314331
        val_loss            0.10146555304527283
    val_pearson_corr         0.621629536151886
     val_rank_regret        0.03458143398165703
    val_rank_spearman       0.2222222238779068
    val_spearman_corr       0.6108368039131165
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run polish_seed555_2025-12-25_12-14-50 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed555_2025-12-25_12-14-50
[train_cli][batch] job 'polish_seed555' finished.
[train_cli][batch] (4/6) running job 'polish_lr_low_seed555' -> run_name=polish_lr_low_seed555_2025-12-25_12-39-37
[train_cli] run_id=polish_lr_low_seed555_2025-12-25_12-39-37 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-25_12-39-37/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-25_12-39-37 --git-commit 9b1bb2b320 --git-dirty
2025-12-25 12:39:41 INFO git_commit = 9b1bb2b320 (dirty)
2025-12-25 12:39:41 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-25 12:39:41 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-25_12-39-37/config/config.yaml
2025-12-25 12:39:41 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data
2025-12-25 12:39:41 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-25 12:39:41 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-25 12:39:41 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-25_12-39-37
2025-12-25 12:39:41 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-25 12:39:41 INFO   metadata_path = None
2025-12-25 12:39:41 INFO   summary_path = None
2025-12-25 12:39:41 INFO   accelerator = cpu
2025-12-25 12:39:41 INFO   devices = 1
2025-12-25 12:39:41 INFO   attention_head = 8
2025-12-25 12:39:41 INFO   pooling_type = mean
2025-12-25 12:39:41 INFO   model_self_loops = False
2025-12-25 12:39:41 INFO   model_self_loop_fill = mean
2025-12-25 12:39:41 INFO   model_residual = False
2025-12-25 12:39:41 INFO   batch_size = 12
2025-12-25 12:39:41 INFO   learning_rate = 0.002
2025-12-25 12:39:41 INFO   num_epochs = 360
2025-12-25 12:39:41 INFO   accumulate_grad_batches = 48
2025-12-25 12:39:41 INFO   seed = 555
2025-12-25 12:39:41 INFO   num_workers = 2
2025-12-25 12:39:41 INFO   precision = 32
2025-12-25 12:39:41 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-25 12:39:41 INFO   early_stopping_patience = 50
2025-12-25 12:39:41 INFO   lr_scheduler_patience = 25
2025-12-25 12:39:41 INFO   lr_scheduler_factor = 0.3
2025-12-25 12:39:41 INFO   fast_dev_run = False
2025-12-25 12:39:41 INFO   limit_train_batches = None
2025-12-25 12:39:41 INFO   limit_val_batches = None
2025-12-25 12:39:41 INFO   log_lr = False
2025-12-25 12:39:41 INFO   progress_bar_refresh_rate = 0
2025-12-25 12:39:41 INFO   log_every_n_steps = 100
2025-12-25 12:39:41 INFO   use_val_spearman_as_secondary = True
2025-12-25 12:39:41 INFO   spearman_secondary_min_delta = 0.0
2025-12-25 12:39:41 INFO   spearman_secondary_weight = 1.0
2025-12-25 12:39:41 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-25 12:39:41 INFO   tuning_max_samples = 500
2025-12-25 12:39:41 INFO   tuning_fraction = None
2025-12-25 12:39:41 INFO   tuning_eval_every = 1
2025-12-25 12:39:41 INFO   rank_loss_weight = 0.0
2025-12-25 12:39:41 INFO   rank_loss_margin = 0.0
2025-12-25 12:39:41 INFO   rank_loss_mode = hinge
2025-12-25 12:39:41 INFO   rank_loss_grouped = True
2025-12-25 12:39:41 INFO   variance_reduction_enabled = False
2025-12-25 12:39:41 INFO   variance_reduction_method = topk_avg
2025-12-25 12:39:41 INFO   variance_reduction_top_k = 3
2025-12-25 12:39:41 INFO   coverage_minimum = 0.0
2025-12-25 12:39:41 INFO   coverage_fail_on_missing = False
2025-12-25 12:39:41 INFO   graph_load_profiling = False
2025-12-25 12:39:41 INFO   graph_load_top_k = 5
2025-12-25 12:39:41 INFO   enable_graph_cache = True
2025-12-25 12:39:41 INFO   graph_cache_size = 256
2025-12-25 12:39:41 INFO   canonicalize_on_load = False
2025-12-25 12:39:41 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-25 12:39:41 INFO   edge_schema = {}
2025-12-25 12:39:41 INFO   topology_schema = {}
Seed set to 555
2025-12-25 12:39:42 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-25 12:39:42 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 12:39:42 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-25 12:39:42 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 12:39:42 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-25 12:39:42 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 12:39:42 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-25 12:39:42 INFO Tuning group stats: groups=368 groups>=2=39 singletons=329 max_group=9
2025-12-25 12:39:42 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-25_12-39-37/dataset_coverage.json
2025-12-25 12:39:42 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-25_12-39-37/dataset_coverage.json for details.
2025-12-25 12:39:42 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-25_12-39-37/dataset_coverage.json for details.
2025-12-25 12:39:42 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-25_12-39-37/dataset_coverage.json for details.
2025-12-25 12:39:42 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-25_12-39-37/schema_summary.json
2025-12-25 12:39:42 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-25_12-39-37/feature_metadata.json
2025-12-25 12:39:42 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-25 12:39:42 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/null_topology/feature-config.yaml.null.10A, sha256=f618659ace5620de7e794485915dadd4243f3ec2ca6726b4a9af3989817a8579
2025-12-25 12:39:42 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/work/edge_features)
2025-12-25 12:39:42 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json
2025-12-25 12:39:42 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-25_12-39-37/schema_summary.json
2025-12-25 12:39:42 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-25 12:39:42 INFO Topology: topology/persistence_null/v1 supporting the 172-dimensional node features.
2025-12-25 12:39:42 INFO Node: node/dssp_topo_merge/v1; metadata lists 172 feature columns matching the .pt tensor.
2025-12-25 12:39:42 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-25 12:39:42 INFO → Total feature dimensionality observed and confirmed: node_dim = 172, edge_dim = 11.
2025-12-25 12:39:42 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-25 12:39:42 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 172,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 172,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-25_12-39-37/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge/v1",
      "alias": "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA",
      "jobs": 16,
      "summary": "DSSP-derived node features merged with topology statistics."
    },
    "topology": {
      "id": "topology/persistence_null/v1",
      "alias": "Null topology (constant zeros) = 140D ablation",
      "jobs": 16,
      "summary": "Topology ablation: constant features with PH-compatible schema."
    }
  },
  "notes": []
}
2025-12-25 12:39:42 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-25 12:39:43 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=41fb6737dac54d23b2565c2ebecd0076)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-25 12:39:43 INFO Starting training (fast_dev_run=False)
2025-12-25 12:39:43 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-25_12-39-37/model_checkpoints exists and is not empty.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 5.5 K  | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
165 K     Trainable params
0         Non-trainable params
165 K     Total params
0.662     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-25 12:40:00 INFO Epoch 000 | 25% complete (batch 181/724)
2025-12-25 12:40:03 INFO Epoch 000 | 50% complete (batch 362/724)
2025-12-25 12:40:06 INFO Epoch 000 | 75% complete (batch 543/724)
2025-12-25 12:40:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.153420
2025-12-25 12:40:24 INFO Tuning ranking metrics: regret=0.118765 spearman=0.073382 (groups=39, skipped=329)
2025-12-25 12:40:24 INFO Epoch 000 | val_loss=0.153420
Metric tuning_rank_spearman improved. New best score: 0.073
2025-12-25 12:40:35 INFO Epoch 001 | 25% complete (batch 181/724)
2025-12-25 12:40:39 INFO Epoch 001 | 50% complete (batch 362/724)
2025-12-25 12:40:42 INFO Epoch 001 | 75% complete (batch 543/724)
2025-12-25 12:40:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.257047
2025-12-25 12:41:00 INFO Tuning ranking metrics: regret=0.142141 spearman=0.011294 (groups=39, skipped=329)
2025-12-25 12:41:00 INFO Epoch 001 | train_mse=0.152816 | val_loss=0.144241 | best_val_loss=0.073382
2025-12-25 12:41:11 INFO Epoch 002 | 25% complete (batch 181/724)
2025-12-25 12:41:15 INFO Epoch 002 | 50% complete (batch 362/724)
2025-12-25 12:41:18 INFO Epoch 002 | 75% complete (batch 543/724)
2025-12-25 12:41:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.272590
2025-12-25 12:41:37 INFO Tuning ranking metrics: regret=0.126844 spearman=0.095055 (groups=39, skipped=329)
2025-12-25 12:41:37 INFO Epoch 002 | train_mse=0.145446 | val_loss=0.141760 | best_val_loss=0.073382
Metric tuning_rank_spearman improved by 0.022 >= min_delta = 0.0. New best score: 0.095
2025-12-25 12:41:48 INFO Epoch 003 | 25% complete (batch 181/724)
2025-12-25 12:41:51 INFO Epoch 003 | 50% complete (batch 362/724)
2025-12-25 12:41:55 INFO Epoch 003 | 75% complete (batch 543/724)
2025-12-25 12:42:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.323345
2025-12-25 12:42:13 INFO Tuning ranking metrics: regret=0.095716 spearman=0.275824 (groups=39, skipped=329)
2025-12-25 12:42:13 INFO Epoch 003 | train_mse=0.143919 | val_loss=0.120261 | best_val_loss=0.095055
Metric tuning_rank_spearman improved by 0.181 >= min_delta = 0.0. New best score: 0.276
2025-12-25 12:42:24 INFO Epoch 004 | 25% complete (batch 181/724)
2025-12-25 12:42:27 INFO Epoch 004 | 50% complete (batch 362/724)
2025-12-25 12:42:31 INFO Epoch 004 | 75% complete (batch 543/724)
2025-12-25 12:42:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.412686
2025-12-25 12:42:50 INFO Tuning ranking metrics: regret=0.087811 spearman=0.288462 (groups=39, skipped=329)
2025-12-25 12:42:50 INFO Epoch 004 | train_mse=0.124095 | val_loss=0.095607 | best_val_loss=0.275824
Metric tuning_rank_spearman improved by 0.013 >= min_delta = 0.0. New best score: 0.288
2025-12-25 12:43:01 INFO Epoch 005 | 25% complete (batch 181/724)
2025-12-25 12:43:04 INFO Epoch 005 | 50% complete (batch 362/724)
2025-12-25 12:43:07 INFO Epoch 005 | 75% complete (batch 543/724)
2025-12-25 12:43:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.435558
2025-12-25 12:43:26 INFO Tuning ranking metrics: regret=0.087811 spearman=0.282234 (groups=39, skipped=329)
2025-12-25 12:43:26 INFO Epoch 005 | train_mse=0.114049 | val_loss=0.090738 | best_val_loss=0.288462
2025-12-25 12:43:37 INFO Epoch 006 | 25% complete (batch 181/724)
2025-12-25 12:43:40 INFO Epoch 006 | 50% complete (batch 362/724)
2025-12-25 12:43:43 INFO Epoch 006 | 75% complete (batch 543/724)
2025-12-25 12:43:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.431693
2025-12-25 12:44:02 INFO Tuning ranking metrics: regret=0.097484 spearman=0.292125 (groups=39, skipped=329)
2025-12-25 12:44:02 INFO Epoch 006 | train_mse=0.101657 | val_loss=0.114393 | best_val_loss=0.288462
Metric tuning_rank_spearman improved by 0.004 >= min_delta = 0.0. New best score: 0.292
2025-12-25 12:44:13 INFO Epoch 007 | 25% complete (batch 181/724)
2025-12-25 12:44:16 INFO Epoch 007 | 50% complete (batch 362/724)
2025-12-25 12:44:20 INFO Epoch 007 | 75% complete (batch 543/724)
2025-12-25 12:44:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.465916
2025-12-25 12:44:39 INFO Tuning ranking metrics: regret=0.091777 spearman=0.289560 (groups=39, skipped=329)
2025-12-25 12:44:39 INFO Epoch 007 | train_mse=0.090077 | val_loss=0.098451 | best_val_loss=0.292125
2025-12-25 12:44:50 INFO Epoch 008 | 25% complete (batch 181/724)
2025-12-25 12:44:53 INFO Epoch 008 | 50% complete (batch 362/724)
2025-12-25 12:44:57 INFO Epoch 008 | 75% complete (batch 543/724)
2025-12-25 12:45:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.486002
2025-12-25 12:45:15 INFO Tuning ranking metrics: regret=0.085147 spearman=0.313614 (groups=39, skipped=329)
2025-12-25 12:45:15 INFO Epoch 008 | train_mse=0.098525 | val_loss=0.085854 | best_val_loss=0.292125
Metric tuning_rank_spearman improved by 0.021 >= min_delta = 0.0. New best score: 0.314
2025-12-25 12:45:26 INFO Epoch 009 | 25% complete (batch 181/724)
2025-12-25 12:45:30 INFO Epoch 009 | 50% complete (batch 362/724)
2025-12-25 12:45:33 INFO Epoch 009 | 75% complete (batch 543/724)
2025-12-25 12:45:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.497032
2025-12-25 12:45:52 INFO Tuning ranking metrics: regret=0.084416 spearman=0.313187 (groups=39, skipped=329)
2025-12-25 12:45:52 INFO Epoch 009 | train_mse=0.094908 | val_loss=0.088096 | best_val_loss=0.313614
2025-12-25 12:46:03 INFO Epoch 010 | 25% complete (batch 181/724)
2025-12-25 12:46:06 INFO Epoch 010 | 50% complete (batch 362/724)
2025-12-25 12:46:10 INFO Epoch 010 | 75% complete (batch 543/724)
2025-12-25 12:46:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.503813
2025-12-25 12:46:28 INFO Tuning ranking metrics: regret=0.109835 spearman=0.192430 (groups=39, skipped=329)
2025-12-25 12:46:28 INFO Epoch 010 | train_mse=0.087975 | val_loss=0.085901 | best_val_loss=0.313614
2025-12-25 12:46:39 INFO Epoch 011 | 25% complete (batch 181/724)
2025-12-25 12:46:43 INFO Epoch 011 | 50% complete (batch 362/724)
2025-12-25 12:46:46 INFO Epoch 011 | 75% complete (batch 543/724)
2025-12-25 12:47:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.507910
2025-12-25 12:47:05 INFO Tuning ranking metrics: regret=0.083942 spearman=0.271123 (groups=39, skipped=329)
2025-12-25 12:47:05 INFO Epoch 011 | train_mse=0.085912 | val_loss=0.085191 | best_val_loss=0.313614
2025-12-25 12:47:16 INFO Epoch 012 | 25% complete (batch 181/724)
2025-12-25 12:47:19 INFO Epoch 012 | 50% complete (batch 362/724)
2025-12-25 12:47:23 INFO Epoch 012 | 75% complete (batch 543/724)
2025-12-25 12:47:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.521533
2025-12-25 12:47:42 INFO Tuning ranking metrics: regret=0.070463 spearman=0.270208 (groups=39, skipped=329)
2025-12-25 12:47:42 INFO Epoch 012 | train_mse=0.093323 | val_loss=0.078810 | best_val_loss=0.313614
2025-12-25 12:47:53 INFO Epoch 013 | 25% complete (batch 181/724)
2025-12-25 12:47:56 INFO Epoch 013 | 50% complete (batch 362/724)
2025-12-25 12:48:00 INFO Epoch 013 | 75% complete (batch 543/724)
2025-12-25 12:48:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.532615
2025-12-25 12:48:19 INFO Tuning ranking metrics: regret=0.108927 spearman=0.222283 (groups=39, skipped=329)
2025-12-25 12:48:19 INFO Epoch 013 | train_mse=0.083399 | val_loss=0.080679 | best_val_loss=0.313614
2025-12-25 12:48:30 INFO Epoch 014 | 25% complete (batch 181/724)
2025-12-25 12:48:33 INFO Epoch 014 | 50% complete (batch 362/724)
2025-12-25 12:48:36 INFO Epoch 014 | 75% complete (batch 543/724)
2025-12-25 12:48:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.531050
2025-12-25 12:48:55 INFO Tuning ranking metrics: regret=0.114348 spearman=0.222039 (groups=39, skipped=329)
2025-12-25 12:48:55 INFO Epoch 014 | train_mse=0.074930 | val_loss=0.083880 | best_val_loss=0.313614
2025-12-25 12:49:06 INFO Epoch 015 | 25% complete (batch 181/724)
2025-12-25 12:49:10 INFO Epoch 015 | 50% complete (batch 362/724)
2025-12-25 12:49:13 INFO Epoch 015 | 75% complete (batch 543/724)
2025-12-25 12:49:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.542927
2025-12-25 12:49:32 INFO Tuning ranking metrics: regret=0.106843 spearman=0.215140 (groups=39, skipped=329)
2025-12-25 12:49:32 INFO Epoch 015 | train_mse=0.073277 | val_loss=0.083267 | best_val_loss=0.313614
2025-12-25 12:49:43 INFO Epoch 016 | 25% complete (batch 181/724)
2025-12-25 12:49:46 INFO Epoch 016 | 50% complete (batch 362/724)
2025-12-25 12:49:50 INFO Epoch 016 | 75% complete (batch 543/724)
2025-12-25 12:50:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.529280
2025-12-25 12:50:08 INFO Tuning ranking metrics: regret=0.122520 spearman=0.164835 (groups=39, skipped=329)
2025-12-25 12:50:08 INFO Epoch 016 | train_mse=0.078541 | val_loss=0.076014 | best_val_loss=0.313614
2025-12-25 12:50:19 INFO Epoch 017 | 25% complete (batch 181/724)
2025-12-25 12:50:23 INFO Epoch 017 | 50% complete (batch 362/724)
2025-12-25 12:50:26 INFO Epoch 017 | 75% complete (batch 543/724)
2025-12-25 12:50:40 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.548383
2025-12-25 12:50:46 INFO Tuning ranking metrics: regret=0.124063 spearman=0.160256 (groups=39, skipped=329)
2025-12-25 12:50:46 INFO Epoch 017 | train_mse=0.076811 | val_loss=0.076848 | best_val_loss=0.313614
2025-12-25 12:50:57 INFO Epoch 018 | 25% complete (batch 181/724)
2025-12-25 12:51:00 INFO Epoch 018 | 50% complete (batch 362/724)
2025-12-25 12:51:04 INFO Epoch 018 | 75% complete (batch 543/724)
2025-12-25 12:51:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.561751
2025-12-25 12:51:23 INFO Tuning ranking metrics: regret=0.122289 spearman=0.226801 (groups=39, skipped=329)
2025-12-25 12:51:23 INFO Epoch 018 | train_mse=0.073643 | val_loss=0.075744 | best_val_loss=0.313614
2025-12-25 12:51:34 INFO Epoch 019 | 25% complete (batch 181/724)
2025-12-25 12:51:38 INFO Epoch 019 | 50% complete (batch 362/724)
2025-12-25 12:51:41 INFO Epoch 019 | 75% complete (batch 543/724)
2025-12-25 12:51:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.575204
2025-12-25 12:52:01 INFO Tuning ranking metrics: regret=0.122259 spearman=0.229792 (groups=39, skipped=329)
2025-12-25 12:52:01 INFO Epoch 019 | train_mse=0.074968 | val_loss=0.077317 | best_val_loss=0.313614
2025-12-25 12:52:12 INFO Epoch 020 | 25% complete (batch 181/724)
2025-12-25 12:52:15 INFO Epoch 020 | 50% complete (batch 362/724)
2025-12-25 12:52:18 INFO Epoch 020 | 75% complete (batch 543/724)
2025-12-25 12:52:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.571096
2025-12-25 12:52:38 INFO Tuning ranking metrics: regret=0.102611 spearman=0.249939 (groups=39, skipped=329)
2025-12-25 12:52:38 INFO Epoch 020 | train_mse=0.077901 | val_loss=0.077301 | best_val_loss=0.313614
2025-12-25 12:52:49 INFO Epoch 021 | 25% complete (batch 181/724)
2025-12-25 12:52:52 INFO Epoch 021 | 50% complete (batch 362/724)
2025-12-25 12:52:55 INFO Epoch 021 | 75% complete (batch 543/724)
2025-12-25 12:53:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.602564
2025-12-25 12:53:15 INFO Tuning ranking metrics: regret=0.127783 spearman=0.094689 (groups=39, skipped=329)
2025-12-25 12:53:15 INFO Epoch 021 | train_mse=0.076440 | val_loss=0.075925 | best_val_loss=0.313614
2025-12-25 12:53:26 INFO Epoch 022 | 25% complete (batch 181/724)
2025-12-25 12:53:29 INFO Epoch 022 | 50% complete (batch 362/724)
2025-12-25 12:53:33 INFO Epoch 022 | 75% complete (batch 543/724)
2025-12-25 12:53:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.638532
2025-12-25 12:53:52 INFO Tuning ranking metrics: regret=0.126057 spearman=0.131685 (groups=39, skipped=329)
2025-12-25 12:53:52 INFO Epoch 022 | train_mse=0.072182 | val_loss=0.070246 | best_val_loss=0.313614
2025-12-25 12:54:03 INFO Epoch 023 | 25% complete (batch 181/724)
2025-12-25 12:54:07 INFO Epoch 023 | 50% complete (batch 362/724)
2025-12-25 12:54:10 INFO Epoch 023 | 75% complete (batch 543/724)
2025-12-25 12:54:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.632862
2025-12-25 12:54:29 INFO Tuning ranking metrics: regret=0.125418 spearman=0.152137 (groups=39, skipped=329)
2025-12-25 12:54:29 INFO Epoch 023 | train_mse=0.075916 | val_loss=0.067575 | best_val_loss=0.313614
2025-12-25 12:54:40 INFO Epoch 024 | 25% complete (batch 181/724)
2025-12-25 12:54:44 INFO Epoch 024 | 50% complete (batch 362/724)
2025-12-25 12:54:47 INFO Epoch 024 | 75% complete (batch 543/724)
2025-12-25 12:55:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.649666
2025-12-25 12:55:06 INFO Tuning ranking metrics: regret=0.125418 spearman=0.128694 (groups=39, skipped=329)
2025-12-25 12:55:06 INFO Epoch 024 | train_mse=0.074371 | val_loss=0.066423 | best_val_loss=0.313614
2025-12-25 12:55:17 INFO Epoch 025 | 25% complete (batch 181/724)
2025-12-25 12:55:21 INFO Epoch 025 | 50% complete (batch 362/724)
2025-12-25 12:55:24 INFO Epoch 025 | 75% complete (batch 543/724)
2025-12-25 12:55:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.632927
2025-12-25 12:55:44 INFO Tuning ranking metrics: regret=0.123719 spearman=0.209890 (groups=39, skipped=329)
2025-12-25 12:55:44 INFO Epoch 025 | train_mse=0.063273 | val_loss=0.077648 | best_val_loss=0.313614
2025-12-25 12:55:55 INFO Epoch 026 | 25% complete (batch 181/724)
2025-12-25 12:55:58 INFO Epoch 026 | 50% complete (batch 362/724)
2025-12-25 12:56:01 INFO Epoch 026 | 75% complete (batch 543/724)
2025-12-25 12:56:15 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.626243
2025-12-25 12:56:21 INFO Tuning ranking metrics: regret=0.126546 spearman=0.125092 (groups=39, skipped=329)
2025-12-25 12:56:21 INFO Epoch 026 | train_mse=0.066484 | val_loss=0.072370 | best_val_loss=0.313614
2025-12-25 12:56:32 INFO Epoch 027 | 25% complete (batch 181/724)
2025-12-25 12:56:35 INFO Epoch 027 | 50% complete (batch 362/724)
2025-12-25 12:56:39 INFO Epoch 027 | 75% complete (batch 543/724)
2025-12-25 12:56:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.646702
2025-12-25 12:56:58 INFO Tuning ranking metrics: regret=0.135908 spearman=0.069475 (groups=39, skipped=329)
2025-12-25 12:56:58 INFO Epoch 027 | train_mse=0.077301 | val_loss=0.071341 | best_val_loss=0.313614
2025-12-25 12:57:09 INFO Epoch 028 | 25% complete (batch 181/724)
2025-12-25 12:57:12 INFO Epoch 028 | 50% complete (batch 362/724)
2025-12-25 12:57:16 INFO Epoch 028 | 75% complete (batch 543/724)
2025-12-25 12:57:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.643845
2025-12-25 12:57:35 INFO Tuning ranking metrics: regret=0.142547 spearman=0.131441 (groups=39, skipped=329)
2025-12-25 12:57:35 INFO Epoch 028 | train_mse=0.065180 | val_loss=0.070219 | best_val_loss=0.313614
2025-12-25 12:57:46 INFO Epoch 029 | 25% complete (batch 181/724)
2025-12-25 12:57:49 INFO Epoch 029 | 50% complete (batch 362/724)
2025-12-25 12:57:52 INFO Epoch 029 | 75% complete (batch 543/724)
2025-12-25 12:58:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.637000
2025-12-25 12:58:11 INFO Tuning ranking metrics: regret=0.123088 spearman=0.189316 (groups=39, skipped=329)
2025-12-25 12:58:11 INFO Epoch 029 | train_mse=0.072681 | val_loss=0.066285 | best_val_loss=0.313614
2025-12-25 12:58:22 INFO Epoch 030 | 25% complete (batch 181/724)
2025-12-25 12:58:26 INFO Epoch 030 | 50% complete (batch 362/724)
2025-12-25 12:58:29 INFO Epoch 030 | 75% complete (batch 543/724)
2025-12-25 12:58:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.625076
2025-12-25 12:58:49 INFO Tuning ranking metrics: regret=0.127969 spearman=0.093773 (groups=39, skipped=329)
2025-12-25 12:58:49 INFO Epoch 030 | train_mse=0.079595 | val_loss=0.063116 | best_val_loss=0.313614
2025-12-25 12:58:59 INFO Epoch 031 | 25% complete (batch 181/724)
2025-12-25 12:59:03 INFO Epoch 031 | 50% complete (batch 362/724)
2025-12-25 12:59:06 INFO Epoch 031 | 75% complete (batch 543/724)
2025-12-25 12:59:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.656386
2025-12-25 12:59:25 INFO Tuning ranking metrics: regret=0.139729 spearman=0.038400 (groups=39, skipped=329)
2025-12-25 12:59:25 INFO Epoch 031 | train_mse=0.068499 | val_loss=0.061594 | best_val_loss=0.313614
2025-12-25 12:59:36 INFO Epoch 032 | 25% complete (batch 181/724)
2025-12-25 12:59:40 INFO Epoch 032 | 50% complete (batch 362/724)
2025-12-25 12:59:43 INFO Epoch 032 | 75% complete (batch 543/724)
2025-12-25 12:59:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.635570
2025-12-25 13:00:02 INFO Tuning ranking metrics: regret=0.155356 spearman=0.075336 (groups=39, skipped=329)
2025-12-25 13:00:02 INFO Epoch 032 | train_mse=0.062738 | val_loss=0.076905 | best_val_loss=0.313614
2025-12-25 13:00:13 INFO Epoch 033 | 25% complete (batch 181/724)
2025-12-25 13:00:17 INFO Epoch 033 | 50% complete (batch 362/724)
2025-12-25 13:00:20 INFO Epoch 033 | 75% complete (batch 543/724)
2025-12-25 13:00:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.645422
2025-12-25 13:00:39 INFO Tuning ranking metrics: regret=0.112474 spearman=0.161722 (groups=39, skipped=329)
2025-12-25 13:00:39 INFO Epoch 033 | train_mse=0.062188 | val_loss=0.064058 | best_val_loss=0.313614
2025-12-25 13:00:50 INFO Epoch 034 | 25% complete (batch 181/724)
2025-12-25 13:00:54 INFO Epoch 034 | 50% complete (batch 362/724)
2025-12-25 13:00:57 INFO Epoch 034 | 75% complete (batch 543/724)
2025-12-25 13:01:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.642757
2025-12-25 13:01:16 INFO Tuning ranking metrics: regret=0.135092 spearman=0.141819 (groups=39, skipped=329)
2025-12-25 13:01:16 INFO Epoch 034 | train_mse=0.070508 | val_loss=0.071342 | best_val_loss=0.313614
2025-12-25 13:01:27 INFO Epoch 035 | 25% complete (batch 181/724)
2025-12-25 13:01:31 INFO Epoch 035 | 50% complete (batch 362/724)
2025-12-25 13:01:34 INFO Epoch 035 | 75% complete (batch 543/724)
2025-12-25 13:01:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.653202
2025-12-25 13:01:53 INFO Tuning ranking metrics: regret=0.121907 spearman=0.145726 (groups=39, skipped=329)
2025-12-25 13:01:53 INFO Epoch 035 | train_mse=0.068592 | val_loss=0.064502 | best_val_loss=0.313614
2025-12-25 13:02:04 INFO Epoch 036 | 25% complete (batch 181/724)
2025-12-25 13:02:08 INFO Epoch 036 | 50% complete (batch 362/724)
2025-12-25 13:02:11 INFO Epoch 036 | 75% complete (batch 543/724)
2025-12-25 13:02:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.645875
2025-12-25 13:02:30 INFO Tuning ranking metrics: regret=0.098590 spearman=0.285592 (groups=39, skipped=329)
2025-12-25 13:02:30 INFO Epoch 036 | train_mse=0.069303 | val_loss=0.064472 | best_val_loss=0.313614
2025-12-25 13:02:41 INFO Epoch 037 | 25% complete (batch 181/724)
2025-12-25 13:02:44 INFO Epoch 037 | 50% complete (batch 362/724)
2025-12-25 13:02:48 INFO Epoch 037 | 75% complete (batch 543/724)
2025-12-25 13:03:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.648676
2025-12-25 13:03:07 INFO Tuning ranking metrics: regret=0.111360 spearman=0.098168 (groups=39, skipped=329)
2025-12-25 13:03:07 INFO Epoch 037 | train_mse=0.064727 | val_loss=0.062668 | best_val_loss=0.313614
2025-12-25 13:03:18 INFO Epoch 038 | 25% complete (batch 181/724)
2025-12-25 13:03:22 INFO Epoch 038 | 50% complete (batch 362/724)
2025-12-25 13:03:25 INFO Epoch 038 | 75% complete (batch 543/724)
2025-12-25 13:03:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.687619
2025-12-25 13:03:44 INFO Tuning ranking metrics: regret=0.125496 spearman=0.053297 (groups=39, skipped=329)
2025-12-25 13:03:44 INFO Epoch 038 | train_mse=0.069818 | val_loss=0.059821 | best_val_loss=0.313614
2025-12-25 13:03:55 INFO Epoch 039 | 25% complete (batch 181/724)
2025-12-25 13:03:58 INFO Epoch 039 | 50% complete (batch 362/724)
2025-12-25 13:04:02 INFO Epoch 039 | 75% complete (batch 543/724)
2025-12-25 13:04:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.683171
2025-12-25 13:04:23 INFO Tuning ranking metrics: regret=0.111110 spearman=0.075214 (groups=39, skipped=329)
2025-12-25 13:04:23 INFO Epoch 039 | train_mse=0.065510 | val_loss=0.062287 | best_val_loss=0.313614
2025-12-25 13:04:35 INFO Epoch 040 | 25% complete (batch 181/724)
2025-12-25 13:04:39 INFO Epoch 040 | 50% complete (batch 362/724)
2025-12-25 13:04:43 INFO Epoch 040 | 75% complete (batch 543/724)
2025-12-25 13:04:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.667905
2025-12-25 13:05:03 INFO Tuning ranking metrics: regret=0.118487 spearman=0.171490 (groups=39, skipped=329)
2025-12-25 13:05:03 INFO Epoch 040 | train_mse=0.061752 | val_loss=0.073509 | best_val_loss=0.313614
2025-12-25 13:05:15 INFO Epoch 041 | 25% complete (batch 181/724)
2025-12-25 13:05:18 INFO Epoch 041 | 50% complete (batch 362/724)
2025-12-25 13:05:22 INFO Epoch 041 | 75% complete (batch 543/724)
2025-12-25 13:05:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.649417
2025-12-25 13:05:41 INFO Tuning ranking metrics: regret=0.128862 spearman=0.167338 (groups=39, skipped=329)
2025-12-25 13:05:41 INFO Epoch 041 | train_mse=0.073312 | val_loss=0.069719 | best_val_loss=0.313614
2025-12-25 13:05:52 INFO Epoch 042 | 25% complete (batch 181/724)
2025-12-25 13:05:56 INFO Epoch 042 | 50% complete (batch 362/724)
2025-12-25 13:06:00 INFO Epoch 042 | 75% complete (batch 543/724)
2025-12-25 13:06:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.663196
2025-12-25 13:06:19 INFO Tuning ranking metrics: regret=0.110995 spearman=0.190354 (groups=39, skipped=329)
2025-12-25 13:06:19 INFO Epoch 042 | train_mse=0.064759 | val_loss=0.063992 | best_val_loss=0.313614
2025-12-25 13:06:30 INFO Epoch 043 | 25% complete (batch 181/724)
2025-12-25 13:06:34 INFO Epoch 043 | 50% complete (batch 362/724)
2025-12-25 13:06:37 INFO Epoch 043 | 75% complete (batch 543/724)
2025-12-25 13:06:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.662026
2025-12-25 13:06:57 INFO Tuning ranking metrics: regret=0.126640 spearman=0.067155 (groups=39, skipped=329)
2025-12-25 13:06:57 INFO Epoch 043 | train_mse=0.067956 | val_loss=0.066527 | best_val_loss=0.313614
2025-12-25 13:07:09 INFO Epoch 044 | 25% complete (batch 181/724)
2025-12-25 13:07:12 INFO Epoch 044 | 50% complete (batch 362/724)
2025-12-25 13:07:16 INFO Epoch 044 | 75% complete (batch 543/724)
2025-12-25 13:07:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.673449
2025-12-25 13:07:35 INFO Tuning ranking metrics: regret=0.160226 spearman=-0.025824 (groups=39, skipped=329)
2025-12-25 13:07:35 INFO Epoch 044 | train_mse=0.061187 | val_loss=0.074240 | best_val_loss=0.313614
2025-12-25 13:07:46 INFO Epoch 045 | 25% complete (batch 181/724)
2025-12-25 13:07:50 INFO Epoch 045 | 50% complete (batch 362/724)
2025-12-25 13:07:53 INFO Epoch 045 | 75% complete (batch 543/724)
2025-12-25 13:08:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.626907
2025-12-25 13:08:14 INFO Tuning ranking metrics: regret=0.110083 spearman=0.275824 (groups=39, skipped=329)
2025-12-25 13:08:14 INFO Epoch 045 | train_mse=0.062190 | val_loss=0.060382 | best_val_loss=0.313614
2025-12-25 13:08:26 INFO Epoch 046 | 25% complete (batch 181/724)
2025-12-25 13:08:30 INFO Epoch 046 | 50% complete (batch 362/724)
2025-12-25 13:08:33 INFO Epoch 046 | 75% complete (batch 543/724)
2025-12-25 13:08:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.649572
2025-12-25 13:08:55 INFO Tuning ranking metrics: regret=0.112554 spearman=0.243223 (groups=39, skipped=329)
2025-12-25 13:08:55 INFO Epoch 046 | train_mse=0.065837 | val_loss=0.067809 | best_val_loss=0.313614
2025-12-25 13:09:07 INFO Epoch 047 | 25% complete (batch 181/724)
2025-12-25 13:09:11 INFO Epoch 047 | 50% complete (batch 362/724)
2025-12-25 13:09:15 INFO Epoch 047 | 75% complete (batch 543/724)
2025-12-25 13:09:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.638441
2025-12-25 13:09:37 INFO Tuning ranking metrics: regret=0.122757 spearman=0.120940 (groups=39, skipped=329)
2025-12-25 13:09:37 INFO Epoch 047 | train_mse=0.070974 | val_loss=0.071116 | best_val_loss=0.313614
2025-12-25 13:09:48 INFO Epoch 048 | 25% complete (batch 181/724)
2025-12-25 13:09:51 INFO Epoch 048 | 50% complete (batch 362/724)
2025-12-25 13:09:54 INFO Epoch 048 | 75% complete (batch 543/724)
2025-12-25 13:10:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.674553
2025-12-25 13:10:14 INFO Tuning ranking metrics: regret=0.119474 spearman=0.170085 (groups=39, skipped=329)
2025-12-25 13:10:14 INFO Epoch 048 | train_mse=0.065337 | val_loss=0.059907 | best_val_loss=0.313614
2025-12-25 13:10:25 INFO Epoch 049 | 25% complete (batch 181/724)
2025-12-25 13:10:28 INFO Epoch 049 | 50% complete (batch 362/724)
2025-12-25 13:10:32 INFO Epoch 049 | 75% complete (batch 543/724)
2025-12-25 13:10:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.665045
2025-12-25 13:10:52 INFO Tuning ranking metrics: regret=0.129070 spearman=0.056838 (groups=39, skipped=329)
2025-12-25 13:10:52 INFO Epoch 049 | train_mse=0.074021 | val_loss=0.068905 | best_val_loss=0.313614
2025-12-25 13:11:03 INFO Epoch 050 | 25% complete (batch 181/724)
2025-12-25 13:11:06 INFO Epoch 050 | 50% complete (batch 362/724)
2025-12-25 13:11:10 INFO Epoch 050 | 75% complete (batch 543/724)
2025-12-25 13:11:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.672983
2025-12-25 13:11:30 INFO Tuning ranking metrics: regret=0.107550 spearman=0.065934 (groups=39, skipped=329)
2025-12-25 13:11:30 INFO Epoch 050 | train_mse=0.062286 | val_loss=0.058462 | best_val_loss=0.313614
2025-12-25 13:11:41 INFO Epoch 051 | 25% complete (batch 181/724)
2025-12-25 13:11:44 INFO Epoch 051 | 50% complete (batch 362/724)
2025-12-25 13:11:48 INFO Epoch 051 | 75% complete (batch 543/724)
2025-12-25 13:12:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.685487
2025-12-25 13:12:07 INFO Tuning ranking metrics: regret=0.133727 spearman=0.150427 (groups=39, skipped=329)
2025-12-25 13:12:07 INFO Epoch 051 | train_mse=0.060295 | val_loss=0.061082 | best_val_loss=0.313614
2025-12-25 13:12:18 INFO Epoch 052 | 25% complete (batch 181/724)
2025-12-25 13:12:21 INFO Epoch 052 | 50% complete (batch 362/724)
2025-12-25 13:12:24 INFO Epoch 052 | 75% complete (batch 543/724)
2025-12-25 13:12:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.684589
2025-12-25 13:12:44 INFO Tuning ranking metrics: regret=0.114669 spearman=0.225885 (groups=39, skipped=329)
2025-12-25 13:12:44 INFO Epoch 052 | train_mse=0.062911 | val_loss=0.058847 | best_val_loss=0.313614
2025-12-25 13:12:55 INFO Epoch 053 | 25% complete (batch 181/724)
2025-12-25 13:12:58 INFO Epoch 053 | 50% complete (batch 362/724)
2025-12-25 13:13:02 INFO Epoch 053 | 75% complete (batch 543/724)
2025-12-25 13:13:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.677324
2025-12-25 13:13:21 INFO Tuning ranking metrics: regret=0.120473 spearman=0.147192 (groups=39, skipped=329)
2025-12-25 13:13:21 INFO Epoch 053 | train_mse=0.063766 | val_loss=0.061047 | best_val_loss=0.313614
2025-12-25 13:13:32 INFO Epoch 054 | 25% complete (batch 181/724)
2025-12-25 13:13:36 INFO Epoch 054 | 50% complete (batch 362/724)
2025-12-25 13:13:39 INFO Epoch 054 | 75% complete (batch 543/724)
2025-12-25 13:13:53 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.679651
2025-12-25 13:13:59 INFO Tuning ranking metrics: regret=0.102104 spearman=0.189316 (groups=39, skipped=329)
2025-12-25 13:13:59 INFO Epoch 054 | train_mse=0.054271 | val_loss=0.057796 | best_val_loss=0.313614
2025-12-25 13:14:10 INFO Epoch 055 | 25% complete (batch 181/724)
2025-12-25 13:14:13 INFO Epoch 055 | 50% complete (batch 362/724)
2025-12-25 13:14:17 INFO Epoch 055 | 75% complete (batch 543/724)
2025-12-25 13:14:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.682841
2025-12-25 13:14:36 INFO Tuning ranking metrics: regret=0.112186 spearman=0.135470 (groups=39, skipped=329)
2025-12-25 13:14:36 INFO Epoch 055 | train_mse=0.063075 | val_loss=0.065454 | best_val_loss=0.313614
2025-12-25 13:14:47 INFO Epoch 056 | 25% complete (batch 181/724)
2025-12-25 13:14:50 INFO Epoch 056 | 50% complete (batch 362/724)
2025-12-25 13:14:54 INFO Epoch 056 | 75% complete (batch 543/724)
2025-12-25 13:15:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.660476
2025-12-25 13:15:13 INFO Tuning ranking metrics: regret=0.118278 spearman=0.180403 (groups=39, skipped=329)
2025-12-25 13:15:13 INFO Epoch 056 | train_mse=0.056413 | val_loss=0.064174 | best_val_loss=0.313614
2025-12-25 13:15:24 INFO Epoch 057 | 25% complete (batch 181/724)
2025-12-25 13:15:28 INFO Epoch 057 | 50% complete (batch 362/724)
2025-12-25 13:15:31 INFO Epoch 057 | 75% complete (batch 543/724)
2025-12-25 13:15:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.665961
2025-12-25 13:15:50 INFO Tuning ranking metrics: regret=0.094007 spearman=0.214347 (groups=39, skipped=329)
2025-12-25 13:15:50 INFO Epoch 057 | train_mse=0.054628 | val_loss=0.072000 | best_val_loss=0.313614
2025-12-25 13:16:01 INFO Epoch 058 | 25% complete (batch 181/724)
2025-12-25 13:16:05 INFO Epoch 058 | 50% complete (batch 362/724)
2025-12-25 13:16:08 INFO Epoch 058 | 75% complete (batch 543/724)
2025-12-25 13:16:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.667795
2025-12-25 13:16:27 INFO Tuning ranking metrics: regret=0.117652 spearman=0.196337 (groups=39, skipped=329)
2025-12-25 13:16:27 INFO Epoch 058 | train_mse=0.056066 | val_loss=0.059427 | best_val_loss=0.313614
Monitored metric tuning_rank_spearman did not improve in the last 50 records. Best score: 0.314. Signaling Trainer to stop.
2025-12-25 13:16:29 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.29212_val-0.11439_epoch006.chkpt, checkpoint.tuning_rank_spearman-0.31319_val-0.08810_epoch009.chkpt, checkpoint.tuning_rank_spearman-0.31361_val-0.08585_epoch008.chkpt
2025-12-25 13:16:29 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-25_12-39-37/model_checkpoints/checkpoint.tuning_rank_spearman-0.31361_val-0.08585_epoch008.chkpt
2025-12-25 13:16:29 INFO Best validation loss: tensor(0.3136)
2025-12-25 13:16:29 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-25_12-39-37/model_checkpoints/checkpoint.tuning_rank_spearman-0.31361_val-0.08585_epoch008.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-25_12-39-37/model_checkpoints/checkpoint.tuning_rank_spearman-0.31361_val-0.08585_epoch008.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-25 13:16:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.085854
2025-12-25 13:16:44 INFO Tuning ranking metrics: regret=0.085147 spearman=0.313614 (groups=39, skipped=329)
2025-12-25 13:16:44 INFO Epoch 059 | val_loss=0.085854 | best_val_loss=0.313614
2025-12-25 13:16:44 INFO Validation metrics: [{'val_loss': 0.08585362881422043, 'tuning_rank_regret': 0.08514747768640518, 'tuning_rank_spearman': 0.313614159822464, 'val_pearson_corr': 0.6447432041168213, 'val_spearman_corr': 0.5851274728775024, 'val_rank_regret': 0.1775633841753006, 'val_rank_spearman': 0.12929293513298035}]
2025-12-25 13:16:44 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.31361_val-0.08585_epoch008.chkpt
2025-12-25 13:16:44 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.29212_val-0.11439_epoch006.chkpt
2025-12-25 13:16:44 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.31319_val-0.08810_epoch009.chkpt
2025-12-25 13:16:44 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.09074_epoch005.ckpt
2025-12-25 13:16:44 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.08514747768640518
  tuning_rank_spearman       0.313614159822464
        val_loss            0.08585362881422043
    val_pearson_corr        0.6447432041168213
     val_rank_regret        0.1775633841753006
    val_rank_spearman       0.12929293513298035
    val_spearman_corr       0.5851274728775024
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run polish_lr_low_seed555_2025-12-25_12-39-37 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed555_2025-12-25_12-39-37
[train_cli][batch] job 'polish_lr_low_seed555' finished.
[train_cli][batch] (5/6) running job 'polish_seed888' -> run_name=polish_seed888_2025-12-25_13-16-47
[train_cli] run_id=polish_seed888_2025-12-25_13-16-47 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-25_13-16-47/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-25_13-16-47 --git-commit 9b1bb2b320 --git-dirty
2025-12-25 13:16:51 INFO git_commit = 9b1bb2b320 (dirty)
2025-12-25 13:16:51 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-25 13:16:51 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-25_13-16-47/config/config.yaml
2025-12-25 13:16:51 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data
2025-12-25 13:16:51 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-25 13:16:51 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-25 13:16:51 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-25_13-16-47
2025-12-25 13:16:51 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-25 13:16:51 INFO   metadata_path = None
2025-12-25 13:16:51 INFO   summary_path = None
2025-12-25 13:16:51 INFO   accelerator = cpu
2025-12-25 13:16:51 INFO   devices = 1
2025-12-25 13:16:51 INFO   attention_head = 8
2025-12-25 13:16:51 INFO   pooling_type = mean
2025-12-25 13:16:51 INFO   model_self_loops = False
2025-12-25 13:16:51 INFO   model_self_loop_fill = mean
2025-12-25 13:16:51 INFO   model_residual = False
2025-12-25 13:16:51 INFO   batch_size = 48
2025-12-25 13:16:51 INFO   learning_rate = 0.003
2025-12-25 13:16:51 INFO   num_epochs = 320
2025-12-25 13:16:51 INFO   accumulate_grad_batches = 8
2025-12-25 13:16:51 INFO   seed = 888
2025-12-25 13:16:51 INFO   num_workers = 2
2025-12-25 13:16:51 INFO   precision = 32
2025-12-25 13:16:51 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-25 13:16:51 INFO   early_stopping_patience = 40
2025-12-25 13:16:51 INFO   lr_scheduler_patience = 20
2025-12-25 13:16:51 INFO   lr_scheduler_factor = 0.3
2025-12-25 13:16:51 INFO   fast_dev_run = False
2025-12-25 13:16:51 INFO   limit_train_batches = None
2025-12-25 13:16:51 INFO   limit_val_batches = None
2025-12-25 13:16:51 INFO   log_lr = False
2025-12-25 13:16:51 INFO   progress_bar_refresh_rate = 0
2025-12-25 13:16:51 INFO   log_every_n_steps = 100
2025-12-25 13:16:51 INFO   use_val_spearman_as_secondary = True
2025-12-25 13:16:51 INFO   spearman_secondary_min_delta = 0.0
2025-12-25 13:16:51 INFO   spearman_secondary_weight = 1.0
2025-12-25 13:16:51 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-25 13:16:51 INFO   tuning_max_samples = 500
2025-12-25 13:16:51 INFO   tuning_fraction = None
2025-12-25 13:16:51 INFO   tuning_eval_every = 1
2025-12-25 13:16:51 INFO   rank_loss_weight = 0.0
2025-12-25 13:16:51 INFO   rank_loss_margin = 0.0
2025-12-25 13:16:51 INFO   rank_loss_mode = hinge
2025-12-25 13:16:51 INFO   rank_loss_grouped = True
2025-12-25 13:16:51 INFO   variance_reduction_enabled = False
2025-12-25 13:16:51 INFO   variance_reduction_method = topk_avg
2025-12-25 13:16:51 INFO   variance_reduction_top_k = 3
2025-12-25 13:16:51 INFO   coverage_minimum = 0.0
2025-12-25 13:16:51 INFO   coverage_fail_on_missing = False
2025-12-25 13:16:51 INFO   graph_load_profiling = False
2025-12-25 13:16:51 INFO   graph_load_top_k = 5
2025-12-25 13:16:51 INFO   enable_graph_cache = True
2025-12-25 13:16:51 INFO   graph_cache_size = 256
2025-12-25 13:16:51 INFO   canonicalize_on_load = False
2025-12-25 13:16:51 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-25 13:16:51 INFO   edge_schema = {}
2025-12-25 13:16:51 INFO   topology_schema = {}
Seed set to 888
2025-12-25 13:16:51 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-25 13:16:51 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 13:16:51 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-25 13:16:51 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 13:16:51 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-25 13:16:51 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 13:16:52 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-25 13:16:52 INFO Tuning group stats: groups=351 groups>=2=40 singletons=311 max_group=10
2025-12-25 13:16:52 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-25_13-16-47/dataset_coverage.json
2025-12-25 13:16:52 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-25_13-16-47/dataset_coverage.json for details.
2025-12-25 13:16:52 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-25_13-16-47/dataset_coverage.json for details.
2025-12-25 13:16:52 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-25_13-16-47/dataset_coverage.json for details.
2025-12-25 13:16:52 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-25_13-16-47/schema_summary.json
2025-12-25 13:16:52 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-25_13-16-47/feature_metadata.json
2025-12-25 13:16:52 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-25 13:16:52 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/null_topology/feature-config.yaml.null.10A, sha256=f618659ace5620de7e794485915dadd4243f3ec2ca6726b4a9af3989817a8579
2025-12-25 13:16:52 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/work/edge_features)
2025-12-25 13:16:52 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json
2025-12-25 13:16:52 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-25_13-16-47/schema_summary.json
2025-12-25 13:16:52 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-25 13:16:52 INFO Topology: topology/persistence_null/v1 supporting the 172-dimensional node features.
2025-12-25 13:16:52 INFO Node: node/dssp_topo_merge/v1; metadata lists 172 feature columns matching the .pt tensor.
2025-12-25 13:16:52 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-25 13:16:52 INFO → Total feature dimensionality observed and confirmed: node_dim = 172, edge_dim = 11.
2025-12-25 13:16:52 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-25 13:16:52 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 172,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 172,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-25_13-16-47/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge/v1",
      "alias": "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA",
      "jobs": 16,
      "summary": "DSSP-derived node features merged with topology statistics."
    },
    "topology": {
      "id": "topology/persistence_null/v1",
      "alias": "Null topology (constant zeros) = 140D ablation",
      "jobs": 16,
      "summary": "Topology ablation: constant features with PH-compatible schema."
    }
  },
  "notes": []
}
2025-12-25 13:16:52 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-25 13:16:53 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=6e034dc2228e4854bff2c9269b89ce50)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-25 13:16:53 INFO Starting training (fast_dev_run=False)
2025-12-25 13:16:53 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-25_13-16-47/model_checkpoints exists and is not empty.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 5.5 K  | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
165 K     Trainable params
0         Non-trainable params
165 K     Total params
0.662     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-25 13:17:07 INFO Epoch 000 | 25% complete (batch 46/181)
2025-12-25 13:17:08 INFO Epoch 000 | 50% complete (batch 91/181)
2025-12-25 13:17:09 INFO Epoch 000 | 75% complete (batch 136/181)
2025-12-25 13:17:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.140494
2025-12-25 13:17:23 INFO Tuning ranking metrics: regret=0.186493 spearman=-0.021699 (groups=40, skipped=311)
2025-12-25 13:17:23 INFO Epoch 000 | val_loss=0.140494
Metric tuning_rank_spearman improved. New best score: -0.022
2025-12-25 13:17:32 INFO Epoch 001 | 25% complete (batch 46/181)
2025-12-25 13:17:33 INFO Epoch 001 | 50% complete (batch 91/181)
2025-12-25 13:17:34 INFO Epoch 001 | 75% complete (batch 136/181)
2025-12-25 13:17:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.279149
2025-12-25 13:17:48 INFO Tuning ranking metrics: regret=0.181993 spearman=-0.135871 (groups=40, skipped=311)
2025-12-25 13:17:48 INFO Epoch 001 | train_mse=0.152628 | val_loss=0.133497 | best_val_loss=-0.021699
2025-12-25 13:17:56 INFO Epoch 002 | 25% complete (batch 46/181)
2025-12-25 13:17:57 INFO Epoch 002 | 50% complete (batch 91/181)
2025-12-25 13:17:58 INFO Epoch 002 | 75% complete (batch 136/181)
2025-12-25 13:18:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.311323
2025-12-25 13:18:12 INFO Tuning ranking metrics: regret=0.146824 spearman=-0.040335 (groups=40, skipped=311)
2025-12-25 13:18:12 INFO Epoch 002 | train_mse=0.148480 | val_loss=0.115458 | best_val_loss=-0.021699
2025-12-25 13:18:21 INFO Epoch 003 | 25% complete (batch 46/181)
2025-12-25 13:18:22 INFO Epoch 003 | 50% complete (batch 91/181)
2025-12-25 13:18:22 INFO Epoch 003 | 75% complete (batch 136/181)
2025-12-25 13:18:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.326709
2025-12-25 13:18:36 INFO Tuning ranking metrics: regret=0.118129 spearman=0.043203 (groups=40, skipped=311)
2025-12-25 13:18:36 INFO Epoch 003 | train_mse=0.124178 | val_loss=0.109327 | best_val_loss=-0.021699
Metric tuning_rank_spearman improved by 0.065 >= min_delta = 0.0. New best score: 0.043
2025-12-25 13:18:45 INFO Epoch 004 | 25% complete (batch 46/181)
2025-12-25 13:18:46 INFO Epoch 004 | 50% complete (batch 91/181)
2025-12-25 13:18:47 INFO Epoch 004 | 75% complete (batch 136/181)
2025-12-25 13:18:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.402068
2025-12-25 13:19:01 INFO Tuning ranking metrics: regret=0.135734 spearman=0.049573 (groups=40, skipped=311)
2025-12-25 13:19:01 INFO Epoch 004 | train_mse=0.125147 | val_loss=0.104291 | best_val_loss=0.043203
Metric tuning_rank_spearman improved by 0.006 >= min_delta = 0.0. New best score: 0.050
2025-12-25 13:19:09 INFO Epoch 005 | 25% complete (batch 46/181)
2025-12-25 13:19:10 INFO Epoch 005 | 50% complete (batch 91/181)
2025-12-25 13:19:11 INFO Epoch 005 | 75% complete (batch 136/181)
2025-12-25 13:19:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.416243
2025-12-25 13:19:25 INFO Tuning ranking metrics: regret=0.127012 spearman=0.089508 (groups=40, skipped=311)
2025-12-25 13:19:25 INFO Epoch 005 | train_mse=0.128038 | val_loss=0.112383 | best_val_loss=0.049573
Metric tuning_rank_spearman improved by 0.040 >= min_delta = 0.0. New best score: 0.090
2025-12-25 13:19:34 INFO Epoch 006 | 25% complete (batch 46/181)
2025-12-25 13:19:35 INFO Epoch 006 | 50% complete (batch 91/181)
2025-12-25 13:19:35 INFO Epoch 006 | 75% complete (batch 136/181)
2025-12-25 13:19:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.436212
2025-12-25 13:19:50 INFO Tuning ranking metrics: regret=0.128106 spearman=0.123404 (groups=40, skipped=311)
2025-12-25 13:19:50 INFO Epoch 006 | train_mse=0.110832 | val_loss=0.098115 | best_val_loss=0.089508
Metric tuning_rank_spearman improved by 0.034 >= min_delta = 0.0. New best score: 0.123
2025-12-25 13:19:58 INFO Epoch 007 | 25% complete (batch 46/181)
2025-12-25 13:19:59 INFO Epoch 007 | 50% complete (batch 91/181)
2025-12-25 13:20:00 INFO Epoch 007 | 75% complete (batch 136/181)
2025-12-25 13:20:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.435051
2025-12-25 13:20:14 INFO Tuning ranking metrics: regret=0.139300 spearman=0.113133 (groups=40, skipped=311)
2025-12-25 13:20:14 INFO Epoch 007 | train_mse=0.103898 | val_loss=0.104927 | best_val_loss=0.123404
2025-12-25 13:20:23 INFO Epoch 008 | 25% complete (batch 46/181)
2025-12-25 13:20:24 INFO Epoch 008 | 50% complete (batch 91/181)
2025-12-25 13:20:24 INFO Epoch 008 | 75% complete (batch 136/181)
2025-12-25 13:20:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.471715
2025-12-25 13:20:38 INFO Tuning ranking metrics: regret=0.148355 spearman=0.135931 (groups=40, skipped=311)
2025-12-25 13:20:38 INFO Epoch 008 | train_mse=0.095351 | val_loss=0.100825 | best_val_loss=0.123404
Metric tuning_rank_spearman improved by 0.013 >= min_delta = 0.0. New best score: 0.136
2025-12-25 13:20:47 INFO Epoch 009 | 25% complete (batch 46/181)
2025-12-25 13:20:48 INFO Epoch 009 | 50% complete (batch 91/181)
2025-12-25 13:20:49 INFO Epoch 009 | 75% complete (batch 136/181)
2025-12-25 13:20:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.481712
2025-12-25 13:21:03 INFO Tuning ranking metrics: regret=0.104100 spearman=0.045335 (groups=40, skipped=311)
2025-12-25 13:21:03 INFO Epoch 009 | train_mse=0.103570 | val_loss=0.092689 | best_val_loss=0.135931
2025-12-25 13:21:11 INFO Epoch 010 | 25% complete (batch 46/181)
2025-12-25 13:21:12 INFO Epoch 010 | 50% complete (batch 91/181)
2025-12-25 13:21:13 INFO Epoch 010 | 75% complete (batch 136/181)
2025-12-25 13:21:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.479997
2025-12-25 13:21:27 INFO Tuning ranking metrics: regret=0.101999 spearman=0.123999 (groups=40, skipped=311)
2025-12-25 13:21:27 INFO Epoch 010 | train_mse=0.088472 | val_loss=0.096333 | best_val_loss=0.135931
2025-12-25 13:21:36 INFO Epoch 011 | 25% complete (batch 46/181)
2025-12-25 13:21:37 INFO Epoch 011 | 50% complete (batch 91/181)
2025-12-25 13:21:38 INFO Epoch 011 | 75% complete (batch 136/181)
2025-12-25 13:21:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.518485
2025-12-25 13:21:52 INFO Tuning ranking metrics: regret=0.101915 spearman=0.124150 (groups=40, skipped=311)
2025-12-25 13:21:52 INFO Epoch 011 | train_mse=0.095978 | val_loss=0.086919 | best_val_loss=0.135931
2025-12-25 13:22:01 INFO Epoch 012 | 25% complete (batch 46/181)
2025-12-25 13:22:01 INFO Epoch 012 | 50% complete (batch 91/181)
2025-12-25 13:22:02 INFO Epoch 012 | 75% complete (batch 136/181)
2025-12-25 13:22:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.540334
2025-12-25 13:22:17 INFO Tuning ranking metrics: regret=0.113941 spearman=0.132067 (groups=40, skipped=311)
2025-12-25 13:22:17 INFO Epoch 012 | train_mse=0.087685 | val_loss=0.085677 | best_val_loss=0.135931
2025-12-25 13:22:26 INFO Epoch 013 | 25% complete (batch 46/181)
2025-12-25 13:22:27 INFO Epoch 013 | 50% complete (batch 91/181)
2025-12-25 13:22:28 INFO Epoch 013 | 75% complete (batch 136/181)
2025-12-25 13:22:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.494393
2025-12-25 13:22:42 INFO Tuning ranking metrics: regret=0.148767 spearman=0.117668 (groups=40, skipped=311)
2025-12-25 13:22:42 INFO Epoch 013 | train_mse=0.095082 | val_loss=0.117399 | best_val_loss=0.135931
2025-12-25 13:22:52 INFO Epoch 014 | 25% complete (batch 46/181)
2025-12-25 13:22:53 INFO Epoch 014 | 50% complete (batch 91/181)
2025-12-25 13:22:55 INFO Epoch 014 | 75% complete (batch 136/181)
2025-12-25 13:23:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.490751
2025-12-25 13:23:11 INFO Tuning ranking metrics: regret=0.114041 spearman=0.097392 (groups=40, skipped=311)
2025-12-25 13:23:11 INFO Epoch 014 | train_mse=0.116776 | val_loss=0.093711 | best_val_loss=0.135931
2025-12-25 13:23:20 INFO Epoch 015 | 25% complete (batch 46/181)
2025-12-25 13:23:22 INFO Epoch 015 | 50% complete (batch 91/181)
2025-12-25 13:23:23 INFO Epoch 015 | 75% complete (batch 136/181)
2025-12-25 13:23:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.526198
2025-12-25 13:23:38 INFO Tuning ranking metrics: regret=0.115318 spearman=0.193339 (groups=40, skipped=311)
2025-12-25 13:23:38 INFO Epoch 015 | train_mse=0.111745 | val_loss=0.088629 | best_val_loss=0.135931
Metric tuning_rank_spearman improved by 0.057 >= min_delta = 0.0. New best score: 0.193
2025-12-25 13:23:46 INFO Epoch 016 | 25% complete (batch 46/181)
2025-12-25 13:23:47 INFO Epoch 016 | 50% complete (batch 91/181)
2025-12-25 13:23:48 INFO Epoch 016 | 75% complete (batch 136/181)
2025-12-25 13:23:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.528383
2025-12-25 13:24:03 INFO Tuning ranking metrics: regret=0.122452 spearman=-0.000628 (groups=40, skipped=311)
2025-12-25 13:24:03 INFO Epoch 016 | train_mse=0.095094 | val_loss=0.086712 | best_val_loss=0.193339
2025-12-25 13:24:12 INFO Epoch 017 | 25% complete (batch 46/181)
2025-12-25 13:24:14 INFO Epoch 017 | 50% complete (batch 91/181)
2025-12-25 13:24:15 INFO Epoch 017 | 75% complete (batch 136/181)
2025-12-25 13:24:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.494064
2025-12-25 13:24:31 INFO Tuning ranking metrics: regret=0.108376 spearman=0.063366 (groups=40, skipped=311)
2025-12-25 13:24:31 INFO Epoch 017 | train_mse=0.093095 | val_loss=0.131947 | best_val_loss=0.193339
2025-12-25 13:24:39 INFO Epoch 018 | 25% complete (batch 46/181)
2025-12-25 13:24:40 INFO Epoch 018 | 50% complete (batch 91/181)
2025-12-25 13:24:41 INFO Epoch 018 | 75% complete (batch 136/181)
2025-12-25 13:24:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.526194
2025-12-25 13:24:55 INFO Tuning ranking metrics: regret=0.147235 spearman=0.007592 (groups=40, skipped=311)
2025-12-25 13:24:55 INFO Epoch 018 | train_mse=0.085124 | val_loss=0.095122 | best_val_loss=0.193339
2025-12-25 13:25:03 INFO Epoch 019 | 25% complete (batch 46/181)
2025-12-25 13:25:04 INFO Epoch 019 | 50% complete (batch 91/181)
2025-12-25 13:25:05 INFO Epoch 019 | 75% complete (batch 136/181)
2025-12-25 13:25:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.478529
2025-12-25 13:25:19 INFO Tuning ranking metrics: regret=0.136484 spearman=0.106824 (groups=40, skipped=311)
2025-12-25 13:25:19 INFO Epoch 019 | train_mse=0.093728 | val_loss=0.099595 | best_val_loss=0.193339
2025-12-25 13:25:28 INFO Epoch 020 | 25% complete (batch 46/181)
2025-12-25 13:25:29 INFO Epoch 020 | 50% complete (batch 91/181)
2025-12-25 13:25:30 INFO Epoch 020 | 75% complete (batch 136/181)
2025-12-25 13:25:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.469473
2025-12-25 13:25:44 INFO Tuning ranking metrics: regret=0.128992 spearman=0.110801 (groups=40, skipped=311)
2025-12-25 13:25:44 INFO Epoch 020 | train_mse=0.096252 | val_loss=0.096108 | best_val_loss=0.193339
2025-12-25 13:25:52 INFO Epoch 021 | 25% complete (batch 46/181)
2025-12-25 13:25:53 INFO Epoch 021 | 50% complete (batch 91/181)
2025-12-25 13:25:54 INFO Epoch 021 | 75% complete (batch 136/181)
2025-12-25 13:26:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.512751
2025-12-25 13:26:08 INFO Tuning ranking metrics: regret=0.112476 spearman=0.177955 (groups=40, skipped=311)
2025-12-25 13:26:08 INFO Epoch 021 | train_mse=0.075800 | val_loss=0.090775 | best_val_loss=0.193339
2025-12-25 13:26:17 INFO Epoch 022 | 25% complete (batch 46/181)
2025-12-25 13:26:17 INFO Epoch 022 | 50% complete (batch 91/181)
2025-12-25 13:26:18 INFO Epoch 022 | 75% complete (batch 136/181)
2025-12-25 13:26:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.508454
2025-12-25 13:26:32 INFO Tuning ranking metrics: regret=0.113304 spearman=0.130260 (groups=40, skipped=311)
2025-12-25 13:26:32 INFO Epoch 022 | train_mse=0.085303 | val_loss=0.084207 | best_val_loss=0.193339
2025-12-25 13:26:41 INFO Epoch 023 | 25% complete (batch 46/181)
2025-12-25 13:26:42 INFO Epoch 023 | 50% complete (batch 91/181)
2025-12-25 13:26:42 INFO Epoch 023 | 75% complete (batch 136/181)
2025-12-25 13:26:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.450720
2025-12-25 13:26:56 INFO Tuning ranking metrics: regret=0.152364 spearman=0.110179 (groups=40, skipped=311)
2025-12-25 13:26:56 INFO Epoch 023 | train_mse=0.091780 | val_loss=0.146770 | best_val_loss=0.193339
2025-12-25 13:27:05 INFO Epoch 024 | 25% complete (batch 46/181)
2025-12-25 13:27:06 INFO Epoch 024 | 50% complete (batch 91/181)
2025-12-25 13:27:07 INFO Epoch 024 | 75% complete (batch 136/181)
2025-12-25 13:27:15 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.508982
2025-12-25 13:27:21 INFO Tuning ranking metrics: regret=0.111373 spearman=0.173950 (groups=40, skipped=311)
2025-12-25 13:27:21 INFO Epoch 024 | train_mse=0.085700 | val_loss=0.090621 | best_val_loss=0.193339
2025-12-25 13:27:29 INFO Epoch 025 | 25% complete (batch 46/181)
2025-12-25 13:27:30 INFO Epoch 025 | 50% complete (batch 91/181)
2025-12-25 13:27:31 INFO Epoch 025 | 75% complete (batch 136/181)
2025-12-25 13:27:40 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.525209
2025-12-25 13:27:45 INFO Tuning ranking metrics: regret=0.093590 spearman=0.156364 (groups=40, skipped=311)
2025-12-25 13:27:45 INFO Epoch 025 | train_mse=0.108944 | val_loss=0.079910 | best_val_loss=0.193339
2025-12-25 13:27:54 INFO Epoch 026 | 25% complete (batch 46/181)
2025-12-25 13:27:55 INFO Epoch 026 | 50% complete (batch 91/181)
2025-12-25 13:27:56 INFO Epoch 026 | 75% complete (batch 136/181)
2025-12-25 13:28:04 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.547519
2025-12-25 13:28:10 INFO Tuning ranking metrics: regret=0.095610 spearman=0.206461 (groups=40, skipped=311)
2025-12-25 13:28:10 INFO Epoch 026 | train_mse=0.097461 | val_loss=0.082534 | best_val_loss=0.193339
Metric tuning_rank_spearman improved by 0.013 >= min_delta = 0.0. New best score: 0.206
2025-12-25 13:28:19 INFO Epoch 027 | 25% complete (batch 46/181)
2025-12-25 13:28:19 INFO Epoch 027 | 50% complete (batch 91/181)
2025-12-25 13:28:20 INFO Epoch 027 | 75% complete (batch 136/181)
2025-12-25 13:28:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.540477
2025-12-25 13:28:34 INFO Tuning ranking metrics: regret=0.096953 spearman=0.097240 (groups=40, skipped=311)
2025-12-25 13:28:34 INFO Epoch 027 | train_mse=0.073883 | val_loss=0.087680 | best_val_loss=0.206461
2025-12-25 13:28:43 INFO Epoch 028 | 25% complete (batch 46/181)
2025-12-25 13:28:44 INFO Epoch 028 | 50% complete (batch 91/181)
2025-12-25 13:28:45 INFO Epoch 028 | 75% complete (batch 136/181)
2025-12-25 13:28:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.547198
2025-12-25 13:28:59 INFO Tuning ranking metrics: regret=0.116302 spearman=0.112370 (groups=40, skipped=311)
2025-12-25 13:28:59 INFO Epoch 028 | train_mse=0.096288 | val_loss=0.090282 | best_val_loss=0.206461
2025-12-25 13:29:08 INFO Epoch 029 | 25% complete (batch 46/181)
2025-12-25 13:29:09 INFO Epoch 029 | 50% complete (batch 91/181)
2025-12-25 13:29:10 INFO Epoch 029 | 75% complete (batch 136/181)
2025-12-25 13:29:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.519952
2025-12-25 13:29:23 INFO Tuning ranking metrics: regret=0.132528 spearman=0.012376 (groups=40, skipped=311)
2025-12-25 13:29:23 INFO Epoch 029 | train_mse=0.090794 | val_loss=0.100711 | best_val_loss=0.206461
2025-12-25 13:29:32 INFO Epoch 030 | 25% complete (batch 46/181)
2025-12-25 13:29:33 INFO Epoch 030 | 50% complete (batch 91/181)
2025-12-25 13:29:34 INFO Epoch 030 | 75% complete (batch 136/181)
2025-12-25 13:29:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.512474
2025-12-25 13:29:47 INFO Tuning ranking metrics: regret=0.126490 spearman=-0.105135 (groups=40, skipped=311)
2025-12-25 13:29:47 INFO Epoch 030 | train_mse=0.081353 | val_loss=0.087867 | best_val_loss=0.206461
2025-12-25 13:29:56 INFO Epoch 031 | 25% complete (batch 46/181)
2025-12-25 13:29:57 INFO Epoch 031 | 50% complete (batch 91/181)
2025-12-25 13:29:58 INFO Epoch 031 | 75% complete (batch 136/181)
2025-12-25 13:30:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.546172
2025-12-25 13:30:12 INFO Tuning ranking metrics: regret=0.122798 spearman=0.101991 (groups=40, skipped=311)
2025-12-25 13:30:12 INFO Epoch 031 | train_mse=0.113861 | val_loss=0.082455 | best_val_loss=0.206461
2025-12-25 13:30:20 INFO Epoch 032 | 25% complete (batch 46/181)
2025-12-25 13:30:21 INFO Epoch 032 | 50% complete (batch 91/181)
2025-12-25 13:30:22 INFO Epoch 032 | 75% complete (batch 136/181)
2025-12-25 13:30:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.547373
2025-12-25 13:30:36 INFO Tuning ranking metrics: regret=0.115639 spearman=0.009968 (groups=40, skipped=311)
2025-12-25 13:30:36 INFO Epoch 032 | train_mse=0.082568 | val_loss=0.087458 | best_val_loss=0.206461
2025-12-25 13:30:45 INFO Epoch 033 | 25% complete (batch 46/181)
2025-12-25 13:30:46 INFO Epoch 033 | 50% complete (batch 91/181)
2025-12-25 13:30:47 INFO Epoch 033 | 75% complete (batch 136/181)
2025-12-25 13:30:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.515901
2025-12-25 13:31:01 INFO Tuning ranking metrics: regret=0.096249 spearman=0.033415 (groups=40, skipped=311)
2025-12-25 13:31:01 INFO Epoch 033 | train_mse=0.092259 | val_loss=0.090207 | best_val_loss=0.206461
2025-12-25 13:31:09 INFO Epoch 034 | 25% complete (batch 46/181)
2025-12-25 13:31:10 INFO Epoch 034 | 50% complete (batch 91/181)
2025-12-25 13:31:11 INFO Epoch 034 | 75% complete (batch 136/181)
2025-12-25 13:31:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.532608
2025-12-25 13:31:25 INFO Tuning ranking metrics: regret=0.112538 spearman=0.055801 (groups=40, skipped=311)
2025-12-25 13:31:25 INFO Epoch 034 | train_mse=0.103816 | val_loss=0.086880 | best_val_loss=0.206461
2025-12-25 13:31:33 INFO Epoch 035 | 25% complete (batch 46/181)
2025-12-25 13:31:34 INFO Epoch 035 | 50% complete (batch 91/181)
2025-12-25 13:31:35 INFO Epoch 035 | 75% complete (batch 136/181)
2025-12-25 13:31:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.522693
2025-12-25 13:31:49 INFO Tuning ranking metrics: regret=0.120957 spearman=0.120557 (groups=40, skipped=311)
2025-12-25 13:31:49 INFO Epoch 035 | train_mse=0.084384 | val_loss=0.093392 | best_val_loss=0.206461
2025-12-25 13:31:57 INFO Epoch 036 | 25% complete (batch 46/181)
2025-12-25 13:31:58 INFO Epoch 036 | 50% complete (batch 91/181)
2025-12-25 13:31:59 INFO Epoch 036 | 75% complete (batch 136/181)
2025-12-25 13:32:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.523776
2025-12-25 13:32:13 INFO Tuning ranking metrics: regret=0.124395 spearman=0.056347 (groups=40, skipped=311)
2025-12-25 13:32:13 INFO Epoch 036 | train_mse=0.083659 | val_loss=0.090314 | best_val_loss=0.206461
2025-12-25 13:32:22 INFO Epoch 037 | 25% complete (batch 46/181)
2025-12-25 13:32:23 INFO Epoch 037 | 50% complete (batch 91/181)
2025-12-25 13:32:24 INFO Epoch 037 | 75% complete (batch 136/181)
2025-12-25 13:32:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.518639
2025-12-25 13:32:38 INFO Tuning ranking metrics: regret=0.094931 spearman=0.052738 (groups=40, skipped=311)
2025-12-25 13:32:38 INFO Epoch 037 | train_mse=0.085079 | val_loss=0.102828 | best_val_loss=0.206461
2025-12-25 13:32:46 INFO Epoch 038 | 25% complete (batch 46/181)
2025-12-25 13:32:47 INFO Epoch 038 | 50% complete (batch 91/181)
2025-12-25 13:32:48 INFO Epoch 038 | 75% complete (batch 136/181)
2025-12-25 13:32:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.511530
2025-12-25 13:33:02 INFO Tuning ranking metrics: regret=0.112821 spearman=0.012819 (groups=40, skipped=311)
2025-12-25 13:33:02 INFO Epoch 038 | train_mse=0.083698 | val_loss=0.088022 | best_val_loss=0.206461
2025-12-25 13:33:10 INFO Epoch 039 | 25% complete (batch 46/181)
2025-12-25 13:33:11 INFO Epoch 039 | 50% complete (batch 91/181)
2025-12-25 13:33:12 INFO Epoch 039 | 75% complete (batch 136/181)
2025-12-25 13:33:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.528450
2025-12-25 13:33:26 INFO Tuning ranking metrics: regret=0.138003 spearman=-0.032744 (groups=40, skipped=311)
2025-12-25 13:33:26 INFO Epoch 039 | train_mse=0.069921 | val_loss=0.088440 | best_val_loss=0.206461
2025-12-25 13:33:35 INFO Epoch 040 | 25% complete (batch 46/181)
2025-12-25 13:33:36 INFO Epoch 040 | 50% complete (batch 91/181)
2025-12-25 13:33:37 INFO Epoch 040 | 75% complete (batch 136/181)
2025-12-25 13:33:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.513606
2025-12-25 13:33:51 INFO Tuning ranking metrics: regret=0.111042 spearman=0.059194 (groups=40, skipped=311)
2025-12-25 13:33:51 INFO Epoch 040 | train_mse=0.079461 | val_loss=0.089719 | best_val_loss=0.206461
2025-12-25 13:33:59 INFO Epoch 041 | 25% complete (batch 46/181)
2025-12-25 13:34:00 INFO Epoch 041 | 50% complete (batch 91/181)
2025-12-25 13:34:01 INFO Epoch 041 | 75% complete (batch 136/181)
2025-12-25 13:34:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.506706
2025-12-25 13:34:15 INFO Tuning ranking metrics: regret=0.113619 spearman=0.090563 (groups=40, skipped=311)
2025-12-25 13:34:15 INFO Epoch 041 | train_mse=0.076177 | val_loss=0.097927 | best_val_loss=0.206461
2025-12-25 13:34:24 INFO Epoch 042 | 25% complete (batch 46/181)
2025-12-25 13:34:25 INFO Epoch 042 | 50% complete (batch 91/181)
2025-12-25 13:34:26 INFO Epoch 042 | 75% complete (batch 136/181)
2025-12-25 13:34:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.508548
2025-12-25 13:34:39 INFO Tuning ranking metrics: regret=0.144678 spearman=-0.066293 (groups=40, skipped=311)
2025-12-25 13:34:39 INFO Epoch 042 | train_mse=0.077493 | val_loss=0.090082 | best_val_loss=0.206461
2025-12-25 13:34:48 INFO Epoch 043 | 25% complete (batch 46/181)
2025-12-25 13:34:49 INFO Epoch 043 | 50% complete (batch 91/181)
2025-12-25 13:34:50 INFO Epoch 043 | 75% complete (batch 136/181)
2025-12-25 13:34:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.513810
2025-12-25 13:35:04 INFO Tuning ranking metrics: regret=0.121816 spearman=0.037998 (groups=40, skipped=311)
2025-12-25 13:35:04 INFO Epoch 043 | train_mse=0.094202 | val_loss=0.090169 | best_val_loss=0.206461
2025-12-25 13:35:12 INFO Epoch 044 | 25% complete (batch 46/181)
2025-12-25 13:35:13 INFO Epoch 044 | 50% complete (batch 91/181)
2025-12-25 13:35:14 INFO Epoch 044 | 75% complete (batch 136/181)
2025-12-25 13:35:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.534492
2025-12-25 13:35:28 INFO Tuning ranking metrics: regret=0.099236 spearman=0.092917 (groups=40, skipped=311)
2025-12-25 13:35:28 INFO Epoch 044 | train_mse=0.075223 | val_loss=0.085935 | best_val_loss=0.206461
2025-12-25 13:35:37 INFO Epoch 045 | 25% complete (batch 46/181)
2025-12-25 13:35:38 INFO Epoch 045 | 50% complete (batch 91/181)
2025-12-25 13:35:39 INFO Epoch 045 | 75% complete (batch 136/181)
2025-12-25 13:35:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.517686
2025-12-25 13:35:53 INFO Tuning ranking metrics: regret=0.148467 spearman=0.010314 (groups=40, skipped=311)
2025-12-25 13:35:53 INFO Epoch 045 | train_mse=0.073248 | val_loss=0.091189 | best_val_loss=0.206461
2025-12-25 13:36:01 INFO Epoch 046 | 25% complete (batch 46/181)
2025-12-25 13:36:02 INFO Epoch 046 | 50% complete (batch 91/181)
2025-12-25 13:36:03 INFO Epoch 046 | 75% complete (batch 136/181)
2025-12-25 13:36:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.509692
2025-12-25 13:36:17 INFO Tuning ranking metrics: regret=0.144691 spearman=-0.004302 (groups=40, skipped=311)
2025-12-25 13:36:17 INFO Epoch 046 | train_mse=0.073437 | val_loss=0.090397 | best_val_loss=0.206461
2025-12-25 13:36:26 INFO Epoch 047 | 25% complete (batch 46/181)
2025-12-25 13:36:27 INFO Epoch 047 | 50% complete (batch 91/181)
2025-12-25 13:36:28 INFO Epoch 047 | 75% complete (batch 136/181)
2025-12-25 13:36:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.522856
2025-12-25 13:36:42 INFO Tuning ranking metrics: regret=0.144767 spearman=-0.029838 (groups=40, skipped=311)
2025-12-25 13:36:42 INFO Epoch 047 | train_mse=0.073913 | val_loss=0.084879 | best_val_loss=0.206461
2025-12-25 13:36:50 INFO Epoch 048 | 25% complete (batch 46/181)
2025-12-25 13:36:51 INFO Epoch 048 | 50% complete (batch 91/181)
2025-12-25 13:36:52 INFO Epoch 048 | 75% complete (batch 136/181)
2025-12-25 13:37:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.516319
2025-12-25 13:37:06 INFO Tuning ranking metrics: regret=0.144616 spearman=-0.023826 (groups=40, skipped=311)
2025-12-25 13:37:06 INFO Epoch 048 | train_mse=0.078301 | val_loss=0.088901 | best_val_loss=0.206461
2025-12-25 13:37:14 INFO Epoch 049 | 25% complete (batch 46/181)
2025-12-25 13:37:15 INFO Epoch 049 | 50% complete (batch 91/181)
2025-12-25 13:37:16 INFO Epoch 049 | 75% complete (batch 136/181)
2025-12-25 13:37:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.522832
2025-12-25 13:37:30 INFO Tuning ranking metrics: regret=0.148666 spearman=-0.071591 (groups=40, skipped=311)
2025-12-25 13:37:30 INFO Epoch 049 | train_mse=0.076548 | val_loss=0.085590 | best_val_loss=0.206461
2025-12-25 13:37:39 INFO Epoch 050 | 25% complete (batch 46/181)
2025-12-25 13:37:40 INFO Epoch 050 | 50% complete (batch 91/181)
2025-12-25 13:37:41 INFO Epoch 050 | 75% complete (batch 136/181)
2025-12-25 13:37:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.519492
2025-12-25 13:37:55 INFO Tuning ranking metrics: regret=0.144591 spearman=0.029848 (groups=40, skipped=311)
2025-12-25 13:37:55 INFO Epoch 050 | train_mse=0.085360 | val_loss=0.084353 | best_val_loss=0.206461
2025-12-25 13:38:03 INFO Epoch 051 | 25% complete (batch 46/181)
2025-12-25 13:38:04 INFO Epoch 051 | 50% complete (batch 91/181)
2025-12-25 13:38:05 INFO Epoch 051 | 75% complete (batch 136/181)
2025-12-25 13:38:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.525588
2025-12-25 13:38:19 INFO Tuning ranking metrics: regret=0.144528 spearman=-0.012175 (groups=40, skipped=311)
2025-12-25 13:38:19 INFO Epoch 051 | train_mse=0.080510 | val_loss=0.086070 | best_val_loss=0.206461
2025-12-25 13:38:27 INFO Epoch 052 | 25% complete (batch 46/181)
2025-12-25 13:38:28 INFO Epoch 052 | 50% complete (batch 91/181)
2025-12-25 13:38:29 INFO Epoch 052 | 75% complete (batch 136/181)
2025-12-25 13:38:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.535612
2025-12-25 13:38:43 INFO Tuning ranking metrics: regret=0.120338 spearman=0.063680 (groups=40, skipped=311)
2025-12-25 13:38:43 INFO Epoch 052 | train_mse=0.072629 | val_loss=0.084916 | best_val_loss=0.206461
2025-12-25 13:38:52 INFO Epoch 053 | 25% complete (batch 46/181)
2025-12-25 13:38:53 INFO Epoch 053 | 50% complete (batch 91/181)
2025-12-25 13:38:54 INFO Epoch 053 | 75% complete (batch 136/181)
2025-12-25 13:39:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.529142
2025-12-25 13:39:08 INFO Tuning ranking metrics: regret=0.107267 spearman=0.091466 (groups=40, skipped=311)
2025-12-25 13:39:08 INFO Epoch 053 | train_mse=0.099104 | val_loss=0.085920 | best_val_loss=0.206461
2025-12-25 13:39:17 INFO Epoch 054 | 25% complete (batch 46/181)
2025-12-25 13:39:17 INFO Epoch 054 | 50% complete (batch 91/181)
2025-12-25 13:39:18 INFO Epoch 054 | 75% complete (batch 136/181)
2025-12-25 13:39:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.515200
2025-12-25 13:39:32 INFO Tuning ranking metrics: regret=0.118326 spearman=0.098263 (groups=40, skipped=311)
2025-12-25 13:39:32 INFO Epoch 054 | train_mse=0.066048 | val_loss=0.096492 | best_val_loss=0.206461
2025-12-25 13:39:41 INFO Epoch 055 | 25% complete (batch 46/181)
2025-12-25 13:39:42 INFO Epoch 055 | 50% complete (batch 91/181)
2025-12-25 13:39:43 INFO Epoch 055 | 75% complete (batch 136/181)
2025-12-25 13:39:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.541827
2025-12-25 13:39:56 INFO Tuning ranking metrics: regret=0.111093 spearman=0.030276 (groups=40, skipped=311)
2025-12-25 13:39:56 INFO Epoch 055 | train_mse=0.070704 | val_loss=0.087002 | best_val_loss=0.206461
2025-12-25 13:40:05 INFO Epoch 056 | 25% complete (batch 46/181)
2025-12-25 13:40:06 INFO Epoch 056 | 50% complete (batch 91/181)
2025-12-25 13:40:07 INFO Epoch 056 | 75% complete (batch 136/181)
2025-12-25 13:40:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.526956
2025-12-25 13:40:21 INFO Tuning ranking metrics: regret=0.108210 spearman=0.042376 (groups=40, skipped=311)
2025-12-25 13:40:21 INFO Epoch 056 | train_mse=0.075963 | val_loss=0.081784 | best_val_loss=0.206461
2025-12-25 13:40:29 INFO Epoch 057 | 25% complete (batch 46/181)
2025-12-25 13:40:30 INFO Epoch 057 | 50% complete (batch 91/181)
2025-12-25 13:40:31 INFO Epoch 057 | 75% complete (batch 136/181)
2025-12-25 13:40:40 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.537532
2025-12-25 13:40:45 INFO Tuning ranking metrics: regret=0.108367 spearman=-0.015482 (groups=40, skipped=311)
2025-12-25 13:40:45 INFO Epoch 057 | train_mse=0.070105 | val_loss=0.081605 | best_val_loss=0.206461
2025-12-25 13:40:54 INFO Epoch 058 | 25% complete (batch 46/181)
2025-12-25 13:40:54 INFO Epoch 058 | 50% complete (batch 91/181)
2025-12-25 13:40:55 INFO Epoch 058 | 75% complete (batch 136/181)
2025-12-25 13:41:04 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.536570
2025-12-25 13:41:09 INFO Tuning ranking metrics: regret=0.116124 spearman=-0.048653 (groups=40, skipped=311)
2025-12-25 13:41:09 INFO Epoch 058 | train_mse=0.060534 | val_loss=0.083523 | best_val_loss=0.206461
2025-12-25 13:41:18 INFO Epoch 059 | 25% complete (batch 46/181)
2025-12-25 13:41:19 INFO Epoch 059 | 50% complete (batch 91/181)
2025-12-25 13:41:20 INFO Epoch 059 | 75% complete (batch 136/181)
2025-12-25 13:41:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.536675
2025-12-25 13:41:33 INFO Tuning ranking metrics: regret=0.125213 spearman=0.022976 (groups=40, skipped=311)
2025-12-25 13:41:33 INFO Epoch 059 | train_mse=0.057330 | val_loss=0.082461 | best_val_loss=0.206461
2025-12-25 13:41:42 INFO Epoch 060 | 25% complete (batch 46/181)
2025-12-25 13:41:43 INFO Epoch 060 | 50% complete (batch 91/181)
2025-12-25 13:41:44 INFO Epoch 060 | 75% complete (batch 136/181)
2025-12-25 13:41:53 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.545622
2025-12-25 13:41:58 INFO Tuning ranking metrics: regret=0.121045 spearman=0.041840 (groups=40, skipped=311)
2025-12-25 13:41:58 INFO Epoch 060 | train_mse=0.064983 | val_loss=0.085470 | best_val_loss=0.206461
2025-12-25 13:42:06 INFO Epoch 061 | 25% complete (batch 46/181)
2025-12-25 13:42:07 INFO Epoch 061 | 50% complete (batch 91/181)
2025-12-25 13:42:08 INFO Epoch 061 | 75% complete (batch 136/181)
2025-12-25 13:42:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.544442
2025-12-25 13:42:22 INFO Tuning ranking metrics: regret=0.088072 spearman=0.069096 (groups=40, skipped=311)
2025-12-25 13:42:22 INFO Epoch 061 | train_mse=0.074690 | val_loss=0.081686 | best_val_loss=0.206461
2025-12-25 13:42:31 INFO Epoch 062 | 25% complete (batch 46/181)
2025-12-25 13:42:32 INFO Epoch 062 | 50% complete (batch 91/181)
2025-12-25 13:42:33 INFO Epoch 062 | 75% complete (batch 136/181)
2025-12-25 13:42:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.549945
2025-12-25 13:42:47 INFO Tuning ranking metrics: regret=0.130493 spearman=0.110465 (groups=40, skipped=311)
2025-12-25 13:42:47 INFO Epoch 062 | train_mse=0.084839 | val_loss=0.084534 | best_val_loss=0.206461
2025-12-25 13:42:55 INFO Epoch 063 | 25% complete (batch 46/181)
2025-12-25 13:42:57 INFO Epoch 063 | 50% complete (batch 91/181)
2025-12-25 13:42:58 INFO Epoch 063 | 75% complete (batch 136/181)
2025-12-25 13:43:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.525298
2025-12-25 13:43:12 INFO Tuning ranking metrics: regret=0.088047 spearman=0.136537 (groups=40, skipped=311)
2025-12-25 13:43:12 INFO Epoch 063 | train_mse=0.074141 | val_loss=0.082118 | best_val_loss=0.206461
2025-12-25 13:43:20 INFO Epoch 064 | 25% complete (batch 46/181)
2025-12-25 13:43:21 INFO Epoch 064 | 50% complete (batch 91/181)
2025-12-25 13:43:22 INFO Epoch 064 | 75% complete (batch 136/181)
2025-12-25 13:43:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.557046
2025-12-25 13:43:36 INFO Tuning ranking metrics: regret=0.101199 spearman=0.100346 (groups=40, skipped=311)
2025-12-25 13:43:36 INFO Epoch 064 | train_mse=0.076617 | val_loss=0.081608 | best_val_loss=0.206461
2025-12-25 13:43:45 INFO Epoch 065 | 25% complete (batch 46/181)
2025-12-25 13:43:46 INFO Epoch 065 | 50% complete (batch 91/181)
2025-12-25 13:43:46 INFO Epoch 065 | 75% complete (batch 136/181)
2025-12-25 13:43:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.563053
2025-12-25 13:44:00 INFO Tuning ranking metrics: regret=0.101199 spearman=0.075649 (groups=40, skipped=311)
2025-12-25 13:44:00 INFO Epoch 065 | train_mse=0.077973 | val_loss=0.083180 | best_val_loss=0.206461
2025-12-25 13:44:09 INFO Epoch 066 | 25% complete (batch 46/181)
2025-12-25 13:44:10 INFO Epoch 066 | 50% complete (batch 91/181)
2025-12-25 13:44:11 INFO Epoch 066 | 75% complete (batch 136/181)
2025-12-25 13:44:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.564828
2025-12-25 13:44:24 INFO Tuning ranking metrics: regret=0.088047 spearman=0.074989 (groups=40, skipped=311)
2025-12-25 13:44:24 INFO Epoch 066 | train_mse=0.075896 | val_loss=0.079644 | best_val_loss=0.206461
Monitored metric tuning_rank_spearman did not improve in the last 40 records. Best score: 0.206. Signaling Trainer to stop.
2025-12-25 13:44:26 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.17795_val-0.09078_epoch021.chkpt, checkpoint.tuning_rank_spearman-0.19334_val-0.08863_epoch015.chkpt, checkpoint.tuning_rank_spearman-0.20646_val-0.08253_epoch026.chkpt
2025-12-25 13:44:26 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-25_13-16-47/model_checkpoints/checkpoint.tuning_rank_spearman-0.20646_val-0.08253_epoch026.chkpt
2025-12-25 13:44:26 INFO Best validation loss: tensor(0.2065)
2025-12-25 13:44:26 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-25_13-16-47/model_checkpoints/checkpoint.tuning_rank_spearman-0.20646_val-0.08253_epoch026.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-25_13-16-47/model_checkpoints/checkpoint.tuning_rank_spearman-0.20646_val-0.08253_epoch026.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-25 13:44:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.082534
2025-12-25 13:44:38 INFO Tuning ranking metrics: regret=0.095610 spearman=0.206461 (groups=40, skipped=311)
2025-12-25 13:44:38 INFO Epoch 067 | val_loss=0.082534 | best_val_loss=0.206461
2025-12-25 13:44:39 INFO Validation metrics: [{'val_loss': 0.0825335755944252, 'tuning_rank_regret': 0.09560961276292801, 'tuning_rank_spearman': 0.20646104216575623, 'val_pearson_corr': 0.6641058921813965, 'val_spearman_corr': 0.6281574964523315, 'val_rank_regret': 0.03174496442079544, 'val_rank_spearman': 0.5}]
2025-12-25 13:44:39 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.20646_val-0.08253_epoch026.chkpt
2025-12-25 13:44:39 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.19334_val-0.08863_epoch015.chkpt
2025-12-25 13:44:39 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.17795_val-0.09078_epoch021.chkpt
2025-12-25 13:44:39 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.07991_epoch025.ckpt
2025-12-25 13:44:39 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.09560961276292801
  tuning_rank_spearman      0.20646104216575623
        val_loss            0.0825335755944252
    val_pearson_corr        0.6641058921813965
     val_rank_regret        0.03174496442079544
    val_rank_spearman               0.5
    val_spearman_corr       0.6281574964523315
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run polish_seed888_2025-12-25_13-16-47 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed888_2025-12-25_13-16-47
[train_cli][batch] job 'polish_seed888' finished.
[train_cli][batch] (6/6) running job 'polish_lr_low_seed888' -> run_name=polish_lr_low_seed888_2025-12-25_13-44-41
[train_cli] run_id=polish_lr_low_seed888_2025-12-25_13-44-41 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-25_13-44-41/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-25_13-44-41 --git-commit 9b1bb2b320 --git-dirty
2025-12-25 13:44:45 INFO git_commit = 9b1bb2b320 (dirty)
2025-12-25 13:44:45 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-25 13:44:45 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-25_13-44-41/config/config.yaml
2025-12-25 13:44:45 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data
2025-12-25 13:44:45 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-25 13:44:45 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-25 13:44:45 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-25_13-44-41
2025-12-25 13:44:45 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-25 13:44:45 INFO   metadata_path = None
2025-12-25 13:44:45 INFO   summary_path = None
2025-12-25 13:44:45 INFO   accelerator = cpu
2025-12-25 13:44:45 INFO   devices = 1
2025-12-25 13:44:45 INFO   attention_head = 8
2025-12-25 13:44:45 INFO   pooling_type = mean
2025-12-25 13:44:45 INFO   model_self_loops = False
2025-12-25 13:44:45 INFO   model_self_loop_fill = mean
2025-12-25 13:44:45 INFO   model_residual = False
2025-12-25 13:44:45 INFO   batch_size = 12
2025-12-25 13:44:45 INFO   learning_rate = 0.002
2025-12-25 13:44:45 INFO   num_epochs = 360
2025-12-25 13:44:45 INFO   accumulate_grad_batches = 48
2025-12-25 13:44:45 INFO   seed = 888
2025-12-25 13:44:45 INFO   num_workers = 2
2025-12-25 13:44:45 INFO   precision = 32
2025-12-25 13:44:45 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-25 13:44:45 INFO   early_stopping_patience = 50
2025-12-25 13:44:45 INFO   lr_scheduler_patience = 25
2025-12-25 13:44:45 INFO   lr_scheduler_factor = 0.3
2025-12-25 13:44:45 INFO   fast_dev_run = False
2025-12-25 13:44:45 INFO   limit_train_batches = None
2025-12-25 13:44:45 INFO   limit_val_batches = None
2025-12-25 13:44:45 INFO   log_lr = False
2025-12-25 13:44:45 INFO   progress_bar_refresh_rate = 0
2025-12-25 13:44:45 INFO   log_every_n_steps = 100
2025-12-25 13:44:45 INFO   use_val_spearman_as_secondary = True
2025-12-25 13:44:45 INFO   spearman_secondary_min_delta = 0.0
2025-12-25 13:44:45 INFO   spearman_secondary_weight = 1.0
2025-12-25 13:44:45 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-25 13:44:45 INFO   tuning_max_samples = 500
2025-12-25 13:44:45 INFO   tuning_fraction = None
2025-12-25 13:44:45 INFO   tuning_eval_every = 1
2025-12-25 13:44:45 INFO   rank_loss_weight = 0.0
2025-12-25 13:44:45 INFO   rank_loss_margin = 0.0
2025-12-25 13:44:45 INFO   rank_loss_mode = hinge
2025-12-25 13:44:45 INFO   rank_loss_grouped = True
2025-12-25 13:44:45 INFO   variance_reduction_enabled = False
2025-12-25 13:44:45 INFO   variance_reduction_method = topk_avg
2025-12-25 13:44:45 INFO   variance_reduction_top_k = 3
2025-12-25 13:44:45 INFO   coverage_minimum = 0.0
2025-12-25 13:44:45 INFO   coverage_fail_on_missing = False
2025-12-25 13:44:45 INFO   graph_load_profiling = False
2025-12-25 13:44:45 INFO   graph_load_top_k = 5
2025-12-25 13:44:45 INFO   enable_graph_cache = True
2025-12-25 13:44:45 INFO   graph_cache_size = 256
2025-12-25 13:44:45 INFO   canonicalize_on_load = False
2025-12-25 13:44:45 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-25 13:44:45 INFO   edge_schema = {}
2025-12-25 13:44:45 INFO   topology_schema = {}
Seed set to 888
2025-12-25 13:44:45 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-25 13:44:45 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 13:44:45 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-25 13:44:45 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 13:44:45 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-25 13:44:45 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 13:44:46 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-25 13:44:46 INFO Tuning group stats: groups=351 groups>=2=40 singletons=311 max_group=10
2025-12-25 13:44:46 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-25_13-44-41/dataset_coverage.json
2025-12-25 13:44:46 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-25_13-44-41/dataset_coverage.json for details.
2025-12-25 13:44:46 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-25_13-44-41/dataset_coverage.json for details.
2025-12-25 13:44:46 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-25_13-44-41/dataset_coverage.json for details.
2025-12-25 13:44:46 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-25_13-44-41/schema_summary.json
2025-12-25 13:44:46 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-25_13-44-41/feature_metadata.json
2025-12-25 13:44:46 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-25 13:44:46 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/null_topology/feature-config.yaml.null.10A, sha256=f618659ace5620de7e794485915dadd4243f3ec2ca6726b4a9af3989817a8579
2025-12-25 13:44:46 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/work/edge_features)
2025-12-25 13:44:46 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json
2025-12-25 13:44:46 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-25_13-44-41/schema_summary.json
2025-12-25 13:44:46 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-25 13:44:46 INFO Topology: topology/persistence_null/v1 supporting the 172-dimensional node features.
2025-12-25 13:44:46 INFO Node: node/dssp_topo_merge/v1; metadata lists 172 feature columns matching the .pt tensor.
2025-12-25 13:44:46 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-25 13:44:46 INFO → Total feature dimensionality observed and confirmed: node_dim = 172, edge_dim = 11.
2025-12-25 13:44:46 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-25 13:44:46 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 172,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 172,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-25_13-44-41/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge/v1",
      "alias": "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA",
      "jobs": 16,
      "summary": "DSSP-derived node features merged with topology statistics."
    },
    "topology": {
      "id": "topology/persistence_null/v1",
      "alias": "Null topology (constant zeros) = 140D ablation",
      "jobs": 16,
      "summary": "Topology ablation: constant features with PH-compatible schema."
    }
  },
  "notes": []
}
2025-12-25 13:44:46 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-25 13:44:47 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=fad9afc8128247dc9c7d2bab599da1d6)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-25 13:44:47 INFO Starting training (fast_dev_run=False)
2025-12-25 13:44:47 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-25_13-44-41/model_checkpoints exists and is not empty.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 5.5 K  | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
165 K     Trainable params
0         Non-trainable params
165 K     Total params
0.662     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-25 13:45:03 INFO Epoch 000 | 25% complete (batch 181/724)
2025-12-25 13:45:07 INFO Epoch 000 | 50% complete (batch 362/724)
2025-12-25 13:45:10 INFO Epoch 000 | 75% complete (batch 543/724)
2025-12-25 13:45:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.146112
2025-12-25 13:45:28 INFO Tuning ranking metrics: regret=0.171834 spearman=-0.031807 (groups=40, skipped=311)
2025-12-25 13:45:28 INFO Epoch 000 | val_loss=0.146112
Metric tuning_rank_spearman improved. New best score: -0.032
2025-12-25 13:45:39 INFO Epoch 001 | 25% complete (batch 181/724)
2025-12-25 13:45:42 INFO Epoch 001 | 50% complete (batch 362/724)
2025-12-25 13:45:45 INFO Epoch 001 | 75% complete (batch 543/724)
2025-12-25 13:45:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.243486
2025-12-25 13:46:03 INFO Tuning ranking metrics: regret=0.171834 spearman=-0.031429 (groups=40, skipped=311)
2025-12-25 13:46:03 INFO Epoch 001 | train_mse=0.143579 | val_loss=0.147951 | best_val_loss=-0.031807
Metric tuning_rank_spearman improved by 0.000 >= min_delta = 0.0. New best score: -0.031
2025-12-25 13:46:14 INFO Epoch 002 | 25% complete (batch 181/724)
2025-12-25 13:46:17 INFO Epoch 002 | 50% complete (batch 362/724)
2025-12-25 13:46:20 INFO Epoch 002 | 75% complete (batch 543/724)
2025-12-25 13:46:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.317359
2025-12-25 13:46:39 INFO Tuning ranking metrics: regret=0.120202 spearman=-0.011299 (groups=40, skipped=311)
2025-12-25 13:46:39 INFO Epoch 002 | train_mse=0.142009 | val_loss=0.102656 | best_val_loss=-0.031429
Metric tuning_rank_spearman improved by 0.020 >= min_delta = 0.0. New best score: -0.011
2025-12-25 13:46:50 INFO Epoch 003 | 25% complete (batch 181/724)
2025-12-25 13:46:53 INFO Epoch 003 | 50% complete (batch 362/724)
2025-12-25 13:46:56 INFO Epoch 003 | 75% complete (batch 543/724)
2025-12-25 13:47:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.378047
2025-12-25 13:47:15 INFO Tuning ranking metrics: regret=0.112998 spearman=0.088247 (groups=40, skipped=311)
2025-12-25 13:47:15 INFO Epoch 003 | train_mse=0.130477 | val_loss=0.114926 | best_val_loss=-0.011299
Metric tuning_rank_spearman improved by 0.100 >= min_delta = 0.0. New best score: 0.088
2025-12-25 13:47:26 INFO Epoch 004 | 25% complete (batch 181/724)
2025-12-25 13:47:29 INFO Epoch 004 | 50% complete (batch 362/724)
2025-12-25 13:47:32 INFO Epoch 004 | 75% complete (batch 543/724)
2025-12-25 13:47:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.427718
2025-12-25 13:47:51 INFO Tuning ranking metrics: regret=0.119775 spearman=0.075990 (groups=40, skipped=311)
2025-12-25 13:47:51 INFO Epoch 004 | train_mse=0.112920 | val_loss=0.097987 | best_val_loss=0.088247
2025-12-25 13:48:02 INFO Epoch 005 | 25% complete (batch 181/724)
2025-12-25 13:48:05 INFO Epoch 005 | 50% complete (batch 362/724)
2025-12-25 13:48:09 INFO Epoch 005 | 75% complete (batch 543/724)
2025-12-25 13:48:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.456283
2025-12-25 13:48:28 INFO Tuning ranking metrics: regret=0.103093 spearman=0.008977 (groups=40, skipped=311)
2025-12-25 13:48:28 INFO Epoch 005 | train_mse=0.101395 | val_loss=0.086054 | best_val_loss=0.088247
2025-12-25 13:48:39 INFO Epoch 006 | 25% complete (batch 181/724)
2025-12-25 13:48:42 INFO Epoch 006 | 50% complete (batch 362/724)
2025-12-25 13:48:46 INFO Epoch 006 | 75% complete (batch 543/724)
2025-12-25 13:48:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.483390
2025-12-25 13:49:04 INFO Tuning ranking metrics: regret=0.088302 spearman=0.072798 (groups=40, skipped=311)
2025-12-25 13:49:04 INFO Epoch 006 | train_mse=0.090638 | val_loss=0.086297 | best_val_loss=0.088247
2025-12-25 13:49:15 INFO Epoch 007 | 25% complete (batch 181/724)
2025-12-25 13:49:18 INFO Epoch 007 | 50% complete (batch 362/724)
2025-12-25 13:49:22 INFO Epoch 007 | 75% complete (batch 543/724)
2025-12-25 13:49:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.476912
2025-12-25 13:49:41 INFO Tuning ranking metrics: regret=0.084220 spearman=0.051997 (groups=40, skipped=311)
2025-12-25 13:49:41 INFO Epoch 007 | train_mse=0.095074 | val_loss=0.097569 | best_val_loss=0.088247
2025-12-25 13:49:52 INFO Epoch 008 | 25% complete (batch 181/724)
2025-12-25 13:49:55 INFO Epoch 008 | 50% complete (batch 362/724)
2025-12-25 13:49:58 INFO Epoch 008 | 75% complete (batch 543/724)
2025-12-25 13:50:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.500781
2025-12-25 13:50:17 INFO Tuning ranking metrics: regret=0.086881 spearman=0.050795 (groups=40, skipped=311)
2025-12-25 13:50:17 INFO Epoch 008 | train_mse=0.090848 | val_loss=0.093677 | best_val_loss=0.088247
2025-12-25 13:50:28 INFO Epoch 009 | 25% complete (batch 181/724)
2025-12-25 13:50:31 INFO Epoch 009 | 50% complete (batch 362/724)
2025-12-25 13:50:35 INFO Epoch 009 | 75% complete (batch 543/724)
2025-12-25 13:50:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.518322
2025-12-25 13:50:54 INFO Tuning ranking metrics: regret=0.114472 spearman=-0.052073 (groups=40, skipped=311)
2025-12-25 13:50:54 INFO Epoch 009 | train_mse=0.093429 | val_loss=0.083588 | best_val_loss=0.088247
2025-12-25 13:51:04 INFO Epoch 010 | 25% complete (batch 181/724)
2025-12-25 13:51:08 INFO Epoch 010 | 50% complete (batch 362/724)
2025-12-25 13:51:11 INFO Epoch 010 | 75% complete (batch 543/724)
2025-12-25 13:51:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.534838
2025-12-25 13:51:30 INFO Tuning ranking metrics: regret=0.089768 spearman=0.042830 (groups=40, skipped=311)
2025-12-25 13:51:30 INFO Epoch 010 | train_mse=0.085299 | val_loss=0.081979 | best_val_loss=0.088247
2025-12-25 13:51:41 INFO Epoch 011 | 25% complete (batch 181/724)
2025-12-25 13:51:44 INFO Epoch 011 | 50% complete (batch 362/724)
2025-12-25 13:51:47 INFO Epoch 011 | 75% complete (batch 543/724)
2025-12-25 13:52:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.524947
2025-12-25 13:52:06 INFO Tuning ranking metrics: regret=0.086615 spearman=0.117835 (groups=40, skipped=311)
2025-12-25 13:52:06 INFO Epoch 011 | train_mse=0.087535 | val_loss=0.087657 | best_val_loss=0.088247
Metric tuning_rank_spearman improved by 0.030 >= min_delta = 0.0. New best score: 0.118
2025-12-25 13:52:17 INFO Epoch 012 | 25% complete (batch 181/724)
2025-12-25 13:52:20 INFO Epoch 012 | 50% complete (batch 362/724)
2025-12-25 13:52:24 INFO Epoch 012 | 75% complete (batch 543/724)
2025-12-25 13:52:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.521052
2025-12-25 13:52:43 INFO Tuning ranking metrics: regret=0.079916 spearman=0.189973 (groups=40, skipped=311)
2025-12-25 13:52:43 INFO Epoch 012 | train_mse=0.080775 | val_loss=0.080303 | best_val_loss=0.117835
Metric tuning_rank_spearman improved by 0.072 >= min_delta = 0.0. New best score: 0.190
2025-12-25 13:52:54 INFO Epoch 013 | 25% complete (batch 181/724)
2025-12-25 13:52:57 INFO Epoch 013 | 50% complete (batch 362/724)
2025-12-25 13:53:00 INFO Epoch 013 | 75% complete (batch 543/724)
2025-12-25 13:53:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.535923
2025-12-25 13:53:18 INFO Tuning ranking metrics: regret=0.084402 spearman=0.078902 (groups=40, skipped=311)
2025-12-25 13:53:18 INFO Epoch 013 | train_mse=0.079693 | val_loss=0.078873 | best_val_loss=0.189973
2025-12-25 13:53:29 INFO Epoch 014 | 25% complete (batch 181/724)
2025-12-25 13:53:32 INFO Epoch 014 | 50% complete (batch 362/724)
2025-12-25 13:53:36 INFO Epoch 014 | 75% complete (batch 543/724)
2025-12-25 13:53:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.546151
2025-12-25 13:53:54 INFO Tuning ranking metrics: regret=0.080832 spearman=0.143366 (groups=40, skipped=311)
2025-12-25 13:53:54 INFO Epoch 014 | train_mse=0.089334 | val_loss=0.084590 | best_val_loss=0.189973
2025-12-25 13:54:05 INFO Epoch 015 | 25% complete (batch 181/724)
2025-12-25 13:54:08 INFO Epoch 015 | 50% complete (batch 362/724)
2025-12-25 13:54:12 INFO Epoch 015 | 75% complete (batch 543/724)
2025-12-25 13:54:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.551375
2025-12-25 13:54:31 INFO Tuning ranking metrics: regret=0.085657 spearman=0.105195 (groups=40, skipped=311)
2025-12-25 13:54:31 INFO Epoch 015 | train_mse=0.076885 | val_loss=0.078600 | best_val_loss=0.189973
2025-12-25 13:54:41 INFO Epoch 016 | 25% complete (batch 181/724)
2025-12-25 13:54:45 INFO Epoch 016 | 50% complete (batch 362/724)
2025-12-25 13:54:48 INFO Epoch 016 | 75% complete (batch 543/724)
2025-12-25 13:55:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.555773
2025-12-25 13:55:06 INFO Tuning ranking metrics: regret=0.081999 spearman=0.128176 (groups=40, skipped=311)
2025-12-25 13:55:06 INFO Epoch 016 | train_mse=0.087990 | val_loss=0.081076 | best_val_loss=0.189973
2025-12-25 13:55:18 INFO Epoch 017 | 25% complete (batch 181/724)
2025-12-25 13:55:21 INFO Epoch 017 | 50% complete (batch 362/724)
2025-12-25 13:55:24 INFO Epoch 017 | 75% complete (batch 543/724)
2025-12-25 13:55:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.551486
2025-12-25 13:55:43 INFO Tuning ranking metrics: regret=0.090681 spearman=0.127933 (groups=40, skipped=311)
2025-12-25 13:55:43 INFO Epoch 017 | train_mse=0.080622 | val_loss=0.086130 | best_val_loss=0.189973
2025-12-25 13:55:54 INFO Epoch 018 | 25% complete (batch 181/724)
2025-12-25 13:55:58 INFO Epoch 018 | 50% complete (batch 362/724)
2025-12-25 13:56:01 INFO Epoch 018 | 75% complete (batch 543/724)
2025-12-25 13:56:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.562433
2025-12-25 13:56:20 INFO Tuning ranking metrics: regret=0.090915 spearman=0.081861 (groups=40, skipped=311)
2025-12-25 13:56:20 INFO Epoch 018 | train_mse=0.075775 | val_loss=0.077677 | best_val_loss=0.189973
2025-12-25 13:56:31 INFO Epoch 019 | 25% complete (batch 181/724)
2025-12-25 13:56:34 INFO Epoch 019 | 50% complete (batch 362/724)
2025-12-25 13:56:37 INFO Epoch 019 | 75% complete (batch 543/724)
2025-12-25 13:56:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.564013
2025-12-25 13:56:56 INFO Tuning ranking metrics: regret=0.095869 spearman=0.060806 (groups=40, skipped=311)
2025-12-25 13:56:56 INFO Epoch 019 | train_mse=0.083743 | val_loss=0.077486 | best_val_loss=0.189973
2025-12-25 13:57:07 INFO Epoch 020 | 25% complete (batch 181/724)
2025-12-25 13:57:11 INFO Epoch 020 | 50% complete (batch 362/724)
2025-12-25 13:57:14 INFO Epoch 020 | 75% complete (batch 543/724)
2025-12-25 13:57:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.554497
2025-12-25 13:57:33 INFO Tuning ranking metrics: regret=0.082893 spearman=0.096466 (groups=40, skipped=311)
2025-12-25 13:57:33 INFO Epoch 020 | train_mse=0.078947 | val_loss=0.086264 | best_val_loss=0.189973
2025-12-25 13:57:44 INFO Epoch 021 | 25% complete (batch 181/724)
2025-12-25 13:57:48 INFO Epoch 021 | 50% complete (batch 362/724)
2025-12-25 13:57:51 INFO Epoch 021 | 75% complete (batch 543/724)
2025-12-25 13:58:04 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.564666
2025-12-25 13:58:10 INFO Tuning ranking metrics: regret=0.096706 spearman=0.066044 (groups=40, skipped=311)
2025-12-25 13:58:10 INFO Epoch 021 | train_mse=0.077190 | val_loss=0.078716 | best_val_loss=0.189973
2025-12-25 13:58:21 INFO Epoch 022 | 25% complete (batch 181/724)
2025-12-25 13:58:24 INFO Epoch 022 | 50% complete (batch 362/724)
2025-12-25 13:58:28 INFO Epoch 022 | 75% complete (batch 543/724)
2025-12-25 13:58:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.582901
2025-12-25 13:58:46 INFO Tuning ranking metrics: regret=0.085025 spearman=-0.027706 (groups=40, skipped=311)
2025-12-25 13:58:46 INFO Epoch 022 | train_mse=0.071994 | val_loss=0.075488 | best_val_loss=0.189973
2025-12-25 13:58:57 INFO Epoch 023 | 25% complete (batch 181/724)
2025-12-25 13:59:01 INFO Epoch 023 | 50% complete (batch 362/724)
2025-12-25 13:59:04 INFO Epoch 023 | 75% complete (batch 543/724)
2025-12-25 13:59:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.576808
2025-12-25 13:59:23 INFO Tuning ranking metrics: regret=0.078019 spearman=0.046304 (groups=40, skipped=311)
2025-12-25 13:59:23 INFO Epoch 023 | train_mse=0.077129 | val_loss=0.089394 | best_val_loss=0.189973
2025-12-25 13:59:34 INFO Epoch 024 | 25% complete (batch 181/724)
2025-12-25 13:59:37 INFO Epoch 024 | 50% complete (batch 362/724)
2025-12-25 13:59:40 INFO Epoch 024 | 75% complete (batch 543/724)
2025-12-25 13:59:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.566307
2025-12-25 13:59:59 INFO Tuning ranking metrics: regret=0.079733 spearman=0.042695 (groups=40, skipped=311)
2025-12-25 13:59:59 INFO Epoch 024 | train_mse=0.082557 | val_loss=0.078329 | best_val_loss=0.189973
2025-12-25 14:00:10 INFO Epoch 025 | 25% complete (batch 181/724)
2025-12-25 14:00:14 INFO Epoch 025 | 50% complete (batch 362/724)
2025-12-25 14:00:17 INFO Epoch 025 | 75% complete (batch 543/724)
2025-12-25 14:00:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.579061
2025-12-25 14:00:36 INFO Tuning ranking metrics: regret=0.078092 spearman=0.085574 (groups=40, skipped=311)
2025-12-25 14:00:36 INFO Epoch 025 | train_mse=0.077919 | val_loss=0.085468 | best_val_loss=0.189973
2025-12-25 14:00:48 INFO Epoch 026 | 25% complete (batch 181/724)
2025-12-25 14:00:51 INFO Epoch 026 | 50% complete (batch 362/724)
2025-12-25 14:00:54 INFO Epoch 026 | 75% complete (batch 543/724)
2025-12-25 14:01:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.590839
2025-12-25 14:01:13 INFO Tuning ranking metrics: regret=0.074917 spearman=0.097597 (groups=40, skipped=311)
2025-12-25 14:01:13 INFO Epoch 026 | train_mse=0.070892 | val_loss=0.074732 | best_val_loss=0.189973
2025-12-25 14:01:25 INFO Epoch 027 | 25% complete (batch 181/724)
2025-12-25 14:01:28 INFO Epoch 027 | 50% complete (batch 362/724)
2025-12-25 14:01:31 INFO Epoch 027 | 75% complete (batch 543/724)
2025-12-25 14:01:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.605847
2025-12-25 14:01:50 INFO Tuning ranking metrics: regret=0.079749 spearman=0.049307 (groups=40, skipped=311)
2025-12-25 14:01:50 INFO Epoch 027 | train_mse=0.078529 | val_loss=0.071740 | best_val_loss=0.189973
2025-12-25 14:02:01 INFO Epoch 028 | 25% complete (batch 181/724)
2025-12-25 14:02:05 INFO Epoch 028 | 50% complete (batch 362/724)
2025-12-25 14:02:08 INFO Epoch 028 | 75% complete (batch 543/724)
2025-12-25 14:02:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.614408
2025-12-25 14:02:27 INFO Tuning ranking metrics: regret=0.081889 spearman=-0.025855 (groups=40, skipped=311)
2025-12-25 14:02:27 INFO Epoch 028 | train_mse=0.075695 | val_loss=0.069884 | best_val_loss=0.189973
2025-12-25 14:02:38 INFO Epoch 029 | 25% complete (batch 181/724)
2025-12-25 14:02:42 INFO Epoch 029 | 50% complete (batch 362/724)
2025-12-25 14:02:45 INFO Epoch 029 | 75% complete (batch 543/724)
2025-12-25 14:02:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.624340
2025-12-25 14:03:04 INFO Tuning ranking metrics: regret=0.100043 spearman=-0.024865 (groups=40, skipped=311)
2025-12-25 14:03:04 INFO Epoch 029 | train_mse=0.067068 | val_loss=0.071298 | best_val_loss=0.189973
2025-12-25 14:03:15 INFO Epoch 030 | 25% complete (batch 181/724)
2025-12-25 14:03:19 INFO Epoch 030 | 50% complete (batch 362/724)
2025-12-25 14:03:23 INFO Epoch 030 | 75% complete (batch 543/724)
2025-12-25 14:03:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.626568
2025-12-25 14:03:41 INFO Tuning ranking metrics: regret=0.097488 spearman=0.012457 (groups=40, skipped=311)
2025-12-25 14:03:41 INFO Epoch 030 | train_mse=0.066977 | val_loss=0.074120 | best_val_loss=0.189973
2025-12-25 14:03:52 INFO Epoch 031 | 25% complete (batch 181/724)
2025-12-25 14:03:56 INFO Epoch 031 | 50% complete (batch 362/724)
2025-12-25 14:03:59 INFO Epoch 031 | 75% complete (batch 543/724)
2025-12-25 14:04:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.601249
2025-12-25 14:04:18 INFO Tuning ranking metrics: regret=0.094994 spearman=-0.018853 (groups=40, skipped=311)
2025-12-25 14:04:18 INFO Epoch 031 | train_mse=0.084592 | val_loss=0.072208 | best_val_loss=0.189973
2025-12-25 14:04:29 INFO Epoch 032 | 25% complete (batch 181/724)
2025-12-25 14:04:32 INFO Epoch 032 | 50% complete (batch 362/724)
2025-12-25 14:04:36 INFO Epoch 032 | 75% complete (batch 543/724)
2025-12-25 14:04:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.608918
2025-12-25 14:04:55 INFO Tuning ranking metrics: regret=0.087936 spearman=-0.001434 (groups=40, skipped=311)
2025-12-25 14:04:55 INFO Epoch 032 | train_mse=0.080176 | val_loss=0.069662 | best_val_loss=0.189973
2025-12-25 14:05:05 INFO Epoch 033 | 25% complete (batch 181/724)
2025-12-25 14:05:09 INFO Epoch 033 | 50% complete (batch 362/724)
2025-12-25 14:05:12 INFO Epoch 033 | 75% complete (batch 543/724)
2025-12-25 14:05:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.612138
2025-12-25 14:05:31 INFO Tuning ranking metrics: regret=0.084608 spearman=0.007738 (groups=40, skipped=311)
2025-12-25 14:05:31 INFO Epoch 033 | train_mse=0.070942 | val_loss=0.069706 | best_val_loss=0.189973
2025-12-25 14:05:42 INFO Epoch 034 | 25% complete (batch 181/724)
2025-12-25 14:05:45 INFO Epoch 034 | 50% complete (batch 362/724)
2025-12-25 14:05:49 INFO Epoch 034 | 75% complete (batch 543/724)
2025-12-25 14:06:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.612248
2025-12-25 14:06:07 INFO Tuning ranking metrics: regret=0.077926 spearman=0.016742 (groups=40, skipped=311)
2025-12-25 14:06:07 INFO Epoch 034 | train_mse=0.073624 | val_loss=0.075049 | best_val_loss=0.189973
2025-12-25 14:06:19 INFO Epoch 035 | 25% complete (batch 181/724)
2025-12-25 14:06:22 INFO Epoch 035 | 50% complete (batch 362/724)
2025-12-25 14:06:25 INFO Epoch 035 | 75% complete (batch 543/724)
2025-12-25 14:06:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.607742
2025-12-25 14:06:44 INFO Tuning ranking metrics: regret=0.104844 spearman=-0.152543 (groups=40, skipped=311)
2025-12-25 14:06:44 INFO Epoch 035 | train_mse=0.059886 | val_loss=0.068855 | best_val_loss=0.189973
2025-12-25 14:06:55 INFO Epoch 036 | 25% complete (batch 181/724)
2025-12-25 14:06:59 INFO Epoch 036 | 50% complete (batch 362/724)
2025-12-25 14:07:02 INFO Epoch 036 | 75% complete (batch 543/724)
2025-12-25 14:07:15 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.643223
2025-12-25 14:07:21 INFO Tuning ranking metrics: regret=0.092915 spearman=-0.111044 (groups=40, skipped=311)
2025-12-25 14:07:21 INFO Epoch 036 | train_mse=0.066160 | val_loss=0.066043 | best_val_loss=0.189973
2025-12-25 14:07:32 INFO Epoch 037 | 25% complete (batch 181/724)
2025-12-25 14:07:35 INFO Epoch 037 | 50% complete (batch 362/724)
2025-12-25 14:07:39 INFO Epoch 037 | 75% complete (batch 543/724)
2025-12-25 14:07:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.611624
2025-12-25 14:07:58 INFO Tuning ranking metrics: regret=0.087054 spearman=-0.012608 (groups=40, skipped=311)
2025-12-25 14:07:58 INFO Epoch 037 | train_mse=0.067896 | val_loss=0.084221 | best_val_loss=0.189973
2025-12-25 14:08:09 INFO Epoch 038 | 25% complete (batch 181/724)
2025-12-25 14:08:12 INFO Epoch 038 | 50% complete (batch 362/724)
2025-12-25 14:08:16 INFO Epoch 038 | 75% complete (batch 543/724)
2025-12-25 14:08:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.611715
2025-12-25 14:08:35 INFO Tuning ranking metrics: regret=0.105926 spearman=-0.113561 (groups=40, skipped=311)
2025-12-25 14:08:35 INFO Epoch 038 | train_mse=0.067747 | val_loss=0.064008 | best_val_loss=0.189973
2025-12-25 14:08:46 INFO Epoch 039 | 25% complete (batch 181/724)
2025-12-25 14:08:49 INFO Epoch 039 | 50% complete (batch 362/724)
2025-12-25 14:08:52 INFO Epoch 039 | 75% complete (batch 543/724)
2025-12-25 14:09:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.644244
2025-12-25 14:09:12 INFO Tuning ranking metrics: regret=0.115599 spearman=-0.084156 (groups=40, skipped=311)
2025-12-25 14:09:12 INFO Epoch 039 | train_mse=0.071903 | val_loss=0.069309 | best_val_loss=0.189973
2025-12-25 14:09:23 INFO Epoch 040 | 25% complete (batch 181/724)
2025-12-25 14:09:26 INFO Epoch 040 | 50% complete (batch 362/724)
2025-12-25 14:09:30 INFO Epoch 040 | 75% complete (batch 543/724)
2025-12-25 14:09:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.649319
2025-12-25 14:09:48 INFO Tuning ranking metrics: regret=0.102941 spearman=-0.054551 (groups=40, skipped=311)
2025-12-25 14:09:48 INFO Epoch 040 | train_mse=0.071045 | val_loss=0.064131 | best_val_loss=0.189973
2025-12-25 14:10:00 INFO Epoch 041 | 25% complete (batch 181/724)
2025-12-25 14:10:03 INFO Epoch 041 | 50% complete (batch 362/724)
2025-12-25 14:10:06 INFO Epoch 041 | 75% complete (batch 543/724)
2025-12-25 14:10:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.641559
2025-12-25 14:10:25 INFO Tuning ranking metrics: regret=0.102954 spearman=-0.082527 (groups=40, skipped=311)
2025-12-25 14:10:25 INFO Epoch 041 | train_mse=0.067666 | val_loss=0.065243 | best_val_loss=0.189973
2025-12-25 14:10:36 INFO Epoch 042 | 25% complete (batch 181/724)
2025-12-25 14:10:39 INFO Epoch 042 | 50% complete (batch 362/724)
2025-12-25 14:10:43 INFO Epoch 042 | 75% complete (batch 543/724)
2025-12-25 14:10:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.656172
2025-12-25 14:11:02 INFO Tuning ranking metrics: regret=0.093045 spearman=-0.052408 (groups=40, skipped=311)
2025-12-25 14:11:02 INFO Epoch 042 | train_mse=0.070335 | val_loss=0.061596 | best_val_loss=0.189973
2025-12-25 14:11:13 INFO Epoch 043 | 25% complete (batch 181/724)
2025-12-25 14:11:16 INFO Epoch 043 | 50% complete (batch 362/724)
2025-12-25 14:11:20 INFO Epoch 043 | 75% complete (batch 543/724)
2025-12-25 14:11:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.649913
2025-12-25 14:11:39 INFO Tuning ranking metrics: regret=0.092921 spearman=-0.054567 (groups=40, skipped=311)
2025-12-25 14:11:39 INFO Epoch 043 | train_mse=0.066611 | val_loss=0.062702 | best_val_loss=0.189973
2025-12-25 14:11:50 INFO Epoch 044 | 25% complete (batch 181/724)
2025-12-25 14:11:53 INFO Epoch 044 | 50% complete (batch 362/724)
2025-12-25 14:11:57 INFO Epoch 044 | 75% complete (batch 543/724)
2025-12-25 14:12:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.651835
2025-12-25 14:12:15 INFO Tuning ranking metrics: regret=0.100684 spearman=-0.063084 (groups=40, skipped=311)
2025-12-25 14:12:15 INFO Epoch 044 | train_mse=0.063240 | val_loss=0.060443 | best_val_loss=0.189973
2025-12-25 14:12:26 INFO Epoch 045 | 25% complete (batch 181/724)
2025-12-25 14:12:30 INFO Epoch 045 | 50% complete (batch 362/724)
2025-12-25 14:12:33 INFO Epoch 045 | 75% complete (batch 543/724)
2025-12-25 14:12:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.667354
2025-12-25 14:12:52 INFO Tuning ranking metrics: regret=0.094361 spearman=-0.040969 (groups=40, skipped=311)
2025-12-25 14:12:52 INFO Epoch 045 | train_mse=0.056915 | val_loss=0.060607 | best_val_loss=0.189973
2025-12-25 14:13:03 INFO Epoch 046 | 25% complete (batch 181/724)
2025-12-25 14:13:06 INFO Epoch 046 | 50% complete (batch 362/724)
2025-12-25 14:13:10 INFO Epoch 046 | 75% complete (batch 543/724)
2025-12-25 14:13:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.665247
2025-12-25 14:13:29 INFO Tuning ranking metrics: regret=0.101859 spearman=-0.062543 (groups=40, skipped=311)
2025-12-25 14:13:29 INFO Epoch 046 | train_mse=0.060313 | val_loss=0.056790 | best_val_loss=0.189973
2025-12-25 14:13:40 INFO Epoch 047 | 25% complete (batch 181/724)
2025-12-25 14:13:44 INFO Epoch 047 | 50% complete (batch 362/724)
2025-12-25 14:13:47 INFO Epoch 047 | 75% complete (batch 543/724)
2025-12-25 14:14:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.668635
2025-12-25 14:14:06 INFO Tuning ranking metrics: regret=0.098808 spearman=-0.010774 (groups=40, skipped=311)
2025-12-25 14:14:06 INFO Epoch 047 | train_mse=0.057175 | val_loss=0.062138 | best_val_loss=0.189973
2025-12-25 14:14:17 INFO Epoch 048 | 25% complete (batch 181/724)
2025-12-25 14:14:21 INFO Epoch 048 | 50% complete (batch 362/724)
2025-12-25 14:14:24 INFO Epoch 048 | 75% complete (batch 543/724)
2025-12-25 14:14:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.642865
2025-12-25 14:14:44 INFO Tuning ranking metrics: regret=0.102951 spearman=0.047825 (groups=40, skipped=311)
2025-12-25 14:14:44 INFO Epoch 048 | train_mse=0.056807 | val_loss=0.083483 | best_val_loss=0.189973
2025-12-25 14:14:56 INFO Epoch 049 | 25% complete (batch 181/724)
2025-12-25 14:14:59 INFO Epoch 049 | 50% complete (batch 362/724)
2025-12-25 14:15:03 INFO Epoch 049 | 75% complete (batch 543/724)
2025-12-25 14:15:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.619742
2025-12-25 14:15:23 INFO Tuning ranking metrics: regret=0.086365 spearman=0.016558 (groups=40, skipped=311)
2025-12-25 14:15:23 INFO Epoch 049 | train_mse=0.060396 | val_loss=0.058073 | best_val_loss=0.189973
2025-12-25 14:15:34 INFO Epoch 050 | 25% complete (batch 181/724)
2025-12-25 14:15:37 INFO Epoch 050 | 50% complete (batch 362/724)
2025-12-25 14:15:40 INFO Epoch 050 | 75% complete (batch 543/724)
2025-12-25 14:15:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.663409
2025-12-25 14:16:00 INFO Tuning ranking metrics: regret=0.080716 spearman=-0.023977 (groups=40, skipped=311)
2025-12-25 14:16:00 INFO Epoch 050 | train_mse=0.064901 | val_loss=0.057572 | best_val_loss=0.189973
2025-12-25 14:16:11 INFO Epoch 051 | 25% complete (batch 181/724)
2025-12-25 14:16:14 INFO Epoch 051 | 50% complete (batch 362/724)
2025-12-25 14:16:18 INFO Epoch 051 | 75% complete (batch 543/724)
2025-12-25 14:16:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.672508
2025-12-25 14:16:37 INFO Tuning ranking metrics: regret=0.091854 spearman=0.071991 (groups=40, skipped=311)
2025-12-25 14:16:37 INFO Epoch 051 | train_mse=0.056415 | val_loss=0.057414 | best_val_loss=0.189973
2025-12-25 14:16:48 INFO Epoch 052 | 25% complete (batch 181/724)
2025-12-25 14:16:52 INFO Epoch 052 | 50% complete (batch 362/724)
2025-12-25 14:16:55 INFO Epoch 052 | 75% complete (batch 543/724)
2025-12-25 14:17:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.659197
2025-12-25 14:17:14 INFO Tuning ranking metrics: regret=0.099711 spearman=-0.043831 (groups=40, skipped=311)
2025-12-25 14:17:14 INFO Epoch 052 | train_mse=0.064008 | val_loss=0.056938 | best_val_loss=0.189973
2025-12-25 14:17:25 INFO Epoch 053 | 25% complete (batch 181/724)
2025-12-25 14:17:28 INFO Epoch 053 | 50% complete (batch 362/724)
2025-12-25 14:17:31 INFO Epoch 053 | 75% complete (batch 543/724)
2025-12-25 14:17:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.674144
2025-12-25 14:17:51 INFO Tuning ranking metrics: regret=0.099721 spearman=-0.049740 (groups=40, skipped=311)
2025-12-25 14:17:51 INFO Epoch 053 | train_mse=0.065785 | val_loss=0.056118 | best_val_loss=0.189973
2025-12-25 14:18:02 INFO Epoch 054 | 25% complete (batch 181/724)
2025-12-25 14:18:06 INFO Epoch 054 | 50% complete (batch 362/724)
2025-12-25 14:18:09 INFO Epoch 054 | 75% complete (batch 543/724)
2025-12-25 14:18:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.677988
2025-12-25 14:18:29 INFO Tuning ranking metrics: regret=0.115526 spearman=-0.108431 (groups=40, skipped=311)
2025-12-25 14:18:29 INFO Epoch 054 | train_mse=0.052440 | val_loss=0.055359 | best_val_loss=0.189973
2025-12-25 14:18:40 INFO Epoch 055 | 25% complete (batch 181/724)
2025-12-25 14:18:43 INFO Epoch 055 | 50% complete (batch 362/724)
2025-12-25 14:18:47 INFO Epoch 055 | 75% complete (batch 543/724)
2025-12-25 14:19:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.678724
2025-12-25 14:19:07 INFO Tuning ranking metrics: regret=0.099729 spearman=-0.054648 (groups=40, skipped=311)
2025-12-25 14:19:07 INFO Epoch 055 | train_mse=0.060117 | val_loss=0.056407 | best_val_loss=0.189973
2025-12-25 14:19:18 INFO Epoch 056 | 25% complete (batch 181/724)
2025-12-25 14:19:21 INFO Epoch 056 | 50% complete (batch 362/724)
2025-12-25 14:19:25 INFO Epoch 056 | 75% complete (batch 543/724)
2025-12-25 14:19:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.682238
2025-12-25 14:19:44 INFO Tuning ranking metrics: regret=0.095190 spearman=-0.072982 (groups=40, skipped=311)
2025-12-25 14:19:44 INFO Epoch 056 | train_mse=0.054253 | val_loss=0.052634 | best_val_loss=0.189973
2025-12-25 14:19:55 INFO Epoch 057 | 25% complete (batch 181/724)
2025-12-25 14:19:59 INFO Epoch 057 | 50% complete (batch 362/724)
2025-12-25 14:20:02 INFO Epoch 057 | 75% complete (batch 543/724)
2025-12-25 14:20:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.686561
2025-12-25 14:20:21 INFO Tuning ranking metrics: regret=0.094216 spearman=0.045795 (groups=40, skipped=311)
2025-12-25 14:20:21 INFO Epoch 057 | train_mse=0.059394 | val_loss=0.052568 | best_val_loss=0.189973
2025-12-25 14:20:33 INFO Epoch 058 | 25% complete (batch 181/724)
2025-12-25 14:20:36 INFO Epoch 058 | 50% complete (batch 362/724)
2025-12-25 14:20:39 INFO Epoch 058 | 75% complete (batch 543/724)
2025-12-25 14:20:53 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.681993
2025-12-25 14:20:58 INFO Tuning ranking metrics: regret=0.102009 spearman=-0.079838 (groups=40, skipped=311)
2025-12-25 14:20:58 INFO Epoch 058 | train_mse=0.050286 | val_loss=0.054748 | best_val_loss=0.189973
2025-12-25 14:21:09 INFO Epoch 059 | 25% complete (batch 181/724)
2025-12-25 14:21:13 INFO Epoch 059 | 50% complete (batch 362/724)
2025-12-25 14:21:16 INFO Epoch 059 | 75% complete (batch 543/724)
2025-12-25 14:21:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.680685
2025-12-25 14:21:35 INFO Tuning ranking metrics: regret=0.089369 spearman=0.070308 (groups=40, skipped=311)
2025-12-25 14:21:35 INFO Epoch 059 | train_mse=0.061489 | val_loss=0.054845 | best_val_loss=0.189973
2025-12-25 14:21:46 INFO Epoch 060 | 25% complete (batch 181/724)
2025-12-25 14:21:49 INFO Epoch 060 | 50% complete (batch 362/724)
2025-12-25 14:21:53 INFO Epoch 060 | 75% complete (batch 543/724)
2025-12-25 14:22:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.671616
2025-12-25 14:22:12 INFO Tuning ranking metrics: regret=0.099644 spearman=-0.007089 (groups=40, skipped=311)
2025-12-25 14:22:12 INFO Epoch 060 | train_mse=0.058559 | val_loss=0.059381 | best_val_loss=0.189973
2025-12-25 14:22:23 INFO Epoch 061 | 25% complete (batch 181/724)
2025-12-25 14:22:26 INFO Epoch 061 | 50% complete (batch 362/724)
2025-12-25 14:22:29 INFO Epoch 061 | 75% complete (batch 543/724)
2025-12-25 14:22:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.673375
2025-12-25 14:22:49 INFO Tuning ranking metrics: regret=0.110053 spearman=0.011358 (groups=40, skipped=311)
2025-12-25 14:22:49 INFO Epoch 061 | train_mse=0.062146 | val_loss=0.059595 | best_val_loss=0.189973
2025-12-25 14:23:00 INFO Epoch 062 | 25% complete (batch 181/724)
2025-12-25 14:23:03 INFO Epoch 062 | 50% complete (batch 362/724)
2025-12-25 14:23:07 INFO Epoch 062 | 75% complete (batch 543/724)
2025-12-25 14:23:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.656484
2025-12-25 14:23:26 INFO Tuning ranking metrics: regret=0.104566 spearman=0.069605 (groups=40, skipped=311)
2025-12-25 14:23:26 INFO Epoch 062 | train_mse=0.062718 | val_loss=0.058788 | best_val_loss=0.189973
Monitored metric tuning_rank_spearman did not improve in the last 50 records. Best score: 0.190. Signaling Trainer to stop.
2025-12-25 14:23:27 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.12818_val-0.08108_epoch016.chkpt, checkpoint.tuning_rank_spearman-0.14337_val-0.08459_epoch014.chkpt, checkpoint.tuning_rank_spearman-0.18997_val-0.08030_epoch012.chkpt
2025-12-25 14:23:27 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-25_13-44-41/model_checkpoints/checkpoint.tuning_rank_spearman-0.18997_val-0.08030_epoch012.chkpt
2025-12-25 14:23:27 INFO Best validation loss: tensor(0.1900)
2025-12-25 14:23:27 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-25_13-44-41/model_checkpoints/checkpoint.tuning_rank_spearman-0.18997_val-0.08030_epoch012.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-25_13-44-41/model_checkpoints/checkpoint.tuning_rank_spearman-0.18997_val-0.08030_epoch012.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-25 14:23:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.080303
2025-12-25 14:23:42 INFO Tuning ranking metrics: regret=0.079916 spearman=0.189973 (groups=40, skipped=311)
2025-12-25 14:23:42 INFO Epoch 063 | val_loss=0.080303 | best_val_loss=0.189973
2025-12-25 14:23:42 INFO Validation metrics: [{'val_loss': 0.08030327409505844, 'tuning_rank_regret': 0.07991574704647064, 'tuning_rank_spearman': 0.18997293710708618, 'val_pearson_corr': 0.6675230860710144, 'val_spearman_corr': 0.6147957444190979, 'val_rank_regret': 0.1689118593931198, 'val_rank_spearman': 0.2001202553510666}]
2025-12-25 14:23:42 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.18997_val-0.08030_epoch012.chkpt
2025-12-25 14:23:42 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.14337_val-0.08459_epoch014.chkpt
2025-12-25 14:23:42 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.12818_val-0.08108_epoch016.chkpt
2025-12-25 14:23:42 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.08198_epoch010.ckpt
2025-12-25 14:23:42 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.07991574704647064
  tuning_rank_spearman      0.18997293710708618
        val_loss            0.08030327409505844
    val_pearson_corr        0.6675230860710144
     val_rank_regret        0.1689118593931198
    val_rank_spearman       0.2001202553510666
    val_spearman_corr       0.6147957444190979
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run polish_lr_low_seed888_2025-12-25_13-44-41 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_lr_low_seed888_2025-12-25_13-44-41
[train_cli][batch] job 'polish_lr_low_seed888' finished.
[run_full_pipeline] Best run: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57 (tuning_rank_spearman=0.18076518177986145)
[run_full_pipeline] Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57/model_checkpoints/checkpoint.tuning_rank_spearman-0.18077_val-0.09186_epoch065.chkpt
[run_full_pipeline] Phase 1 fine-tuning -> polish_seed101_2025-12-25_09-39-57_phase1
[train_cli] run_id=polish_seed101_2025-12-25_09-39-57_phase1 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase1/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase1 --git-commit 9b1bb2b320 --git-dirty --resume-from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57/model_checkpoints/checkpoint.tuning_rank_spearman-0.18077_val-0.09186_epoch065.chkpt
2025-12-25 14:23:49 INFO git_commit = 9b1bb2b320 (dirty)
2025-12-25 14:23:49 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-25 14:23:49 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase1/config/config.yaml
2025-12-25 14:23:49 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data
2025-12-25 14:23:49 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-25 14:23:49 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-25 14:23:49 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase1
2025-12-25 14:23:49 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-25 14:23:49 INFO   metadata_path = None
2025-12-25 14:23:49 INFO   summary_path = None
2025-12-25 14:23:49 INFO   accelerator = cpu
2025-12-25 14:23:49 INFO   devices = 1
2025-12-25 14:23:49 INFO   attention_head = 8
2025-12-25 14:23:49 INFO   pooling_type = mean
2025-12-25 14:23:49 INFO   model_self_loops = False
2025-12-25 14:23:49 INFO   model_self_loop_fill = mean
2025-12-25 14:23:49 INFO   model_residual = False
2025-12-25 14:23:49 INFO   batch_size = 48
2025-12-25 14:23:49 INFO   learning_rate = 0.001
2025-12-25 14:23:49 INFO   num_epochs = 320
2025-12-25 14:23:49 INFO   accumulate_grad_batches = 8
2025-12-25 14:23:49 INFO   seed = 222
2025-12-25 14:23:49 INFO   num_workers = 2
2025-12-25 14:23:49 INFO   precision = 32
2025-12-25 14:23:49 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-25 14:23:49 INFO   early_stopping_patience = 20
2025-12-25 14:23:49 INFO   lr_scheduler_patience = 4
2025-12-25 14:23:49 INFO   lr_scheduler_factor = 0.2
2025-12-25 14:23:49 INFO   fast_dev_run = False
2025-12-25 14:23:49 INFO   limit_train_batches = None
2025-12-25 14:23:49 INFO   limit_val_batches = None
2025-12-25 14:23:49 INFO   log_lr = False
2025-12-25 14:23:49 INFO   progress_bar_refresh_rate = 0
2025-12-25 14:23:49 INFO   log_every_n_steps = 100
2025-12-25 14:23:49 INFO   use_val_spearman_as_secondary = True
2025-12-25 14:23:49 INFO   spearman_secondary_min_delta = 0.0
2025-12-25 14:23:49 INFO   spearman_secondary_weight = 1.0
2025-12-25 14:23:49 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-25 14:23:49 INFO   tuning_max_samples = 500
2025-12-25 14:23:49 INFO   tuning_fraction = None
2025-12-25 14:23:49 INFO   tuning_eval_every = 1
2025-12-25 14:23:49 INFO   rank_loss_weight = 0.0
2025-12-25 14:23:49 INFO   rank_loss_margin = 0.0
2025-12-25 14:23:49 INFO   rank_loss_mode = hinge
2025-12-25 14:23:49 INFO   rank_loss_grouped = True
2025-12-25 14:23:49 INFO   variance_reduction_enabled = False
2025-12-25 14:23:49 INFO   variance_reduction_method = topk_avg
2025-12-25 14:23:49 INFO   variance_reduction_top_k = 3
2025-12-25 14:23:49 INFO   coverage_minimum = 0.0
2025-12-25 14:23:49 INFO   coverage_fail_on_missing = False
2025-12-25 14:23:49 INFO   graph_load_profiling = False
2025-12-25 14:23:49 INFO   graph_load_top_k = 5
2025-12-25 14:23:49 INFO   enable_graph_cache = True
2025-12-25 14:23:49 INFO   graph_cache_size = 256
2025-12-25 14:23:49 INFO   canonicalize_on_load = False
2025-12-25 14:23:49 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-25 14:23:49 INFO   edge_schema = {}
2025-12-25 14:23:49 INFO   topology_schema = {}
Seed set to 222
2025-12-25 14:23:49 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-25 14:23:49 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 14:23:49 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-25 14:23:49 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 14:23:49 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-25 14:23:49 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 14:23:50 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-25 14:23:50 INFO Tuning group stats: groups=352 groups>=2=34 singletons=318 max_group=11
2025-12-25 14:23:50 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase1/dataset_coverage.json
2025-12-25 14:23:50 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase1/dataset_coverage.json for details.
2025-12-25 14:23:50 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase1/dataset_coverage.json for details.
2025-12-25 14:23:50 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase1/dataset_coverage.json for details.
2025-12-25 14:23:50 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase1/schema_summary.json
2025-12-25 14:23:50 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase1/feature_metadata.json
2025-12-25 14:23:50 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-25 14:23:50 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/null_topology/feature-config.yaml.null.10A, sha256=f618659ace5620de7e794485915dadd4243f3ec2ca6726b4a9af3989817a8579
2025-12-25 14:23:50 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/work/edge_features)
2025-12-25 14:23:50 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json
2025-12-25 14:23:50 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase1/schema_summary.json
2025-12-25 14:23:50 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-25 14:23:50 INFO Topology: topology/persistence_null/v1 supporting the 172-dimensional node features.
2025-12-25 14:23:50 INFO Node: node/dssp_topo_merge/v1; metadata lists 172 feature columns matching the .pt tensor.
2025-12-25 14:23:50 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-25 14:23:50 INFO → Total feature dimensionality observed and confirmed: node_dim = 172, edge_dim = 11.
2025-12-25 14:23:50 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-25 14:23:50 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 172,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 172,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase1/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge/v1",
      "alias": "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA",
      "jobs": 16,
      "summary": "DSSP-derived node features merged with topology statistics."
    },
    "topology": {
      "id": "topology/persistence_null/v1",
      "alias": "Null topology (constant zeros) = 140D ablation",
      "jobs": 16,
      "summary": "Topology ablation: constant features with PH-compatible schema."
    }
  },
  "notes": []
}
2025-12-25 14:23:50 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-25 14:23:50 INFO Resuming from checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57/model_checkpoints/checkpoint.tuning_rank_spearman-0.18077_val-0.09186_epoch065.chkpt (epoch=65)
2025-12-25 14:23:50 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=8e4f4de212a04dc487427efa3d0fe7c6)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-25 14:23:50 INFO Starting training (fast_dev_run=False)
2025-12-25 14:23:50 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase1/model_checkpoints exists and is not empty.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57/model_checkpoints/checkpoint.tuning_rank_spearman-0.18077_val-0.09186_epoch065.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57/model_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase1/model_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57/model_checkpoints/val_loss_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase1/model_checkpoints/val_loss_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 5.5 K  | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
165 K     Trainable params
0         Non-trainable params
165 K     Total params
0.662     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
Restored all states from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57/model_checkpoints/checkpoint.tuning_rank_spearman-0.18077_val-0.09186_epoch065.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-25 14:24:05 INFO Epoch 066 | 25% complete (batch 46/181)
2025-12-25 14:24:06 INFO Epoch 066 | 50% complete (batch 91/181)
2025-12-25 14:24:07 INFO Epoch 066 | 75% complete (batch 136/181)
2025-12-25 14:24:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.093237
2025-12-25 14:24:21 INFO Tuning ranking metrics: regret=0.079332 spearman=0.055672 (groups=34, skipped=318)
2025-12-25 14:24:21 INFO Epoch 066 | val_loss=0.093237
2025-12-25 14:24:29 INFO Epoch 067 | 25% complete (batch 46/181)
2025-12-25 14:24:30 INFO Epoch 067 | 50% complete (batch 91/181)
2025-12-25 14:24:31 INFO Epoch 067 | 75% complete (batch 136/181)
2025-12-25 14:24:40 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.505312
2025-12-25 14:24:45 INFO Tuning ranking metrics: regret=0.073955 spearman=0.067201 (groups=34, skipped=318)
2025-12-25 14:24:45 INFO Epoch 067 | train_mse=0.065952 | val_loss=0.086276 | best_val_loss=0.055672
2025-12-25 14:24:53 INFO Epoch 068 | 25% complete (batch 46/181)
2025-12-25 14:24:54 INFO Epoch 068 | 50% complete (batch 91/181)
2025-12-25 14:24:55 INFO Epoch 068 | 75% complete (batch 136/181)
2025-12-25 14:25:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.513029
2025-12-25 14:25:09 INFO Tuning ranking metrics: regret=0.076272 spearman=0.052998 (groups=34, skipped=318)
2025-12-25 14:25:09 INFO Epoch 068 | train_mse=0.068956 | val_loss=0.099820 | best_val_loss=0.067201
2025-12-25 14:25:17 INFO Epoch 069 | 25% complete (batch 46/181)
2025-12-25 14:25:18 INFO Epoch 069 | 50% complete (batch 91/181)
2025-12-25 14:25:19 INFO Epoch 069 | 75% complete (batch 136/181)
2025-12-25 14:25:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.506054
2025-12-25 14:25:33 INFO Tuning ranking metrics: regret=0.081807 spearman=-0.032582 (groups=34, skipped=318)
2025-12-25 14:25:33 INFO Epoch 069 | train_mse=0.074765 | val_loss=0.087344 | best_val_loss=0.067201
2025-12-25 14:25:42 INFO Epoch 070 | 25% complete (batch 46/181)
2025-12-25 14:25:43 INFO Epoch 070 | 50% complete (batch 91/181)
2025-12-25 14:25:44 INFO Epoch 070 | 75% complete (batch 136/181)
2025-12-25 14:25:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.512201
2025-12-25 14:25:57 INFO Tuning ranking metrics: regret=0.091495 spearman=-0.000929 (groups=34, skipped=318)
2025-12-25 14:25:57 INFO Epoch 070 | train_mse=0.075332 | val_loss=0.091727 | best_val_loss=0.067201
2025-12-25 14:26:06 INFO Epoch 071 | 25% complete (batch 46/181)
2025-12-25 14:26:07 INFO Epoch 071 | 50% complete (batch 91/181)
2025-12-25 14:26:08 INFO Epoch 071 | 75% complete (batch 136/181)
2025-12-25 14:26:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.537824
2025-12-25 14:26:22 INFO Tuning ranking metrics: regret=0.078553 spearman=0.004953 (groups=34, skipped=318)
2025-12-25 14:26:22 INFO Epoch 071 | train_mse=0.078113 | val_loss=0.088925 | best_val_loss=0.067201
2025-12-25 14:26:30 INFO Epoch 072 | 25% complete (batch 46/181)
2025-12-25 14:26:31 INFO Epoch 072 | 50% complete (batch 91/181)
2025-12-25 14:26:32 INFO Epoch 072 | 75% complete (batch 136/181)
2025-12-25 14:26:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.531957
2025-12-25 14:26:46 INFO Tuning ranking metrics: regret=0.075446 spearman=-0.030169 (groups=34, skipped=318)
2025-12-25 14:26:46 INFO Epoch 072 | train_mse=0.072070 | val_loss=0.087918 | best_val_loss=0.067201
2025-12-25 14:26:56 INFO Epoch 073 | 25% complete (batch 46/181)
2025-12-25 14:26:57 INFO Epoch 073 | 50% complete (batch 91/181)
2025-12-25 14:26:58 INFO Epoch 073 | 75% complete (batch 136/181)
2025-12-25 14:27:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.541814
2025-12-25 14:27:12 INFO Tuning ranking metrics: regret=0.077597 spearman=-0.034619 (groups=34, skipped=318)
2025-12-25 14:27:12 INFO Epoch 073 | train_mse=0.073508 | val_loss=0.091290 | best_val_loss=0.067201
2025-12-25 14:27:21 INFO Epoch 074 | 25% complete (batch 46/181)
2025-12-25 14:27:22 INFO Epoch 074 | 50% complete (batch 91/181)
2025-12-25 14:27:23 INFO Epoch 074 | 75% complete (batch 136/181)
2025-12-25 14:27:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.521267
2025-12-25 14:27:37 INFO Tuning ranking metrics: regret=0.081769 spearman=-0.065648 (groups=34, skipped=318)
2025-12-25 14:27:37 INFO Epoch 074 | train_mse=0.076737 | val_loss=0.097937 | best_val_loss=0.067201
2025-12-25 14:27:46 INFO Epoch 075 | 25% complete (batch 46/181)
2025-12-25 14:27:47 INFO Epoch 075 | 50% complete (batch 91/181)
2025-12-25 14:27:48 INFO Epoch 075 | 75% complete (batch 136/181)
2025-12-25 14:27:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.525386
2025-12-25 14:28:03 INFO Tuning ranking metrics: regret=0.092791 spearman=-0.018602 (groups=34, skipped=318)
2025-12-25 14:28:03 INFO Epoch 075 | train_mse=0.056266 | val_loss=0.083372 | best_val_loss=0.067201
2025-12-25 14:28:12 INFO Epoch 076 | 25% complete (batch 46/181)
2025-12-25 14:28:13 INFO Epoch 076 | 50% complete (batch 91/181)
2025-12-25 14:28:14 INFO Epoch 076 | 75% complete (batch 136/181)
2025-12-25 14:28:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.544864
2025-12-25 14:28:29 INFO Tuning ranking metrics: regret=0.092791 spearman=-0.011064 (groups=34, skipped=318)
2025-12-25 14:28:29 INFO Epoch 076 | train_mse=0.068620 | val_loss=0.084317 | best_val_loss=0.067201
2025-12-25 14:28:38 INFO Epoch 077 | 25% complete (batch 46/181)
2025-12-25 14:28:39 INFO Epoch 077 | 50% complete (batch 91/181)
2025-12-25 14:28:40 INFO Epoch 077 | 75% complete (batch 136/181)
2025-12-25 14:28:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.543770
2025-12-25 14:28:55 INFO Tuning ranking metrics: regret=0.092791 spearman=-0.017571 (groups=34, skipped=318)
2025-12-25 14:28:55 INFO Epoch 077 | train_mse=0.067203 | val_loss=0.083247 | best_val_loss=0.067201
2025-12-25 14:29:04 INFO Epoch 078 | 25% complete (batch 46/181)
2025-12-25 14:29:05 INFO Epoch 078 | 50% complete (batch 91/181)
2025-12-25 14:29:06 INFO Epoch 078 | 75% complete (batch 136/181)
2025-12-25 14:29:15 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.549353
2025-12-25 14:29:21 INFO Tuning ranking metrics: regret=0.076454 spearman=0.015368 (groups=34, skipped=318)
2025-12-25 14:29:21 INFO Epoch 078 | train_mse=0.084299 | val_loss=0.080498 | best_val_loss=0.067201
2025-12-25 14:29:30 INFO Epoch 079 | 25% complete (batch 46/181)
2025-12-25 14:29:31 INFO Epoch 079 | 50% complete (batch 91/181)
2025-12-25 14:29:32 INFO Epoch 079 | 75% complete (batch 136/181)
2025-12-25 14:29:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.540731
2025-12-25 14:29:47 INFO Tuning ranking metrics: regret=0.076454 spearman=0.044245 (groups=34, skipped=318)
2025-12-25 14:29:47 INFO Epoch 079 | train_mse=0.075664 | val_loss=0.091551 | best_val_loss=0.067201
2025-12-25 14:29:56 INFO Epoch 080 | 25% complete (batch 46/181)
2025-12-25 14:29:57 INFO Epoch 080 | 50% complete (batch 91/181)
2025-12-25 14:29:58 INFO Epoch 080 | 75% complete (batch 136/181)
2025-12-25 14:30:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.562012
2025-12-25 14:30:13 INFO Tuning ranking metrics: regret=0.055085 spearman=0.032016 (groups=34, skipped=318)
2025-12-25 14:30:13 INFO Epoch 080 | train_mse=0.056561 | val_loss=0.078536 | best_val_loss=0.067201
2025-12-25 14:30:22 INFO Epoch 081 | 25% complete (batch 46/181)
2025-12-25 14:30:23 INFO Epoch 081 | 50% complete (batch 91/181)
2025-12-25 14:30:24 INFO Epoch 081 | 75% complete (batch 136/181)
2025-12-25 14:30:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.584282
2025-12-25 14:30:39 INFO Tuning ranking metrics: regret=0.076454 spearman=0.019391 (groups=34, skipped=318)
2025-12-25 14:30:39 INFO Epoch 081 | train_mse=0.083738 | val_loss=0.077209 | best_val_loss=0.067201
2025-12-25 14:30:48 INFO Epoch 082 | 25% complete (batch 46/181)
2025-12-25 14:30:49 INFO Epoch 082 | 50% complete (batch 91/181)
2025-12-25 14:30:50 INFO Epoch 082 | 75% complete (batch 136/181)
2025-12-25 14:30:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.576129
2025-12-25 14:31:05 INFO Tuning ranking metrics: regret=0.076454 spearman=0.019659 (groups=34, skipped=318)
2025-12-25 14:31:05 INFO Epoch 082 | train_mse=0.071950 | val_loss=0.077917 | best_val_loss=0.067201
2025-12-25 14:31:14 INFO Epoch 083 | 25% complete (batch 46/181)
2025-12-25 14:31:15 INFO Epoch 083 | 50% complete (batch 91/181)
2025-12-25 14:31:16 INFO Epoch 083 | 75% complete (batch 136/181)
2025-12-25 14:31:26 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.573166
2025-12-25 14:31:31 INFO Tuning ranking metrics: regret=0.073628 spearman=-0.053641 (groups=34, skipped=318)
2025-12-25 14:31:31 INFO Epoch 083 | train_mse=0.087469 | val_loss=0.075011 | best_val_loss=0.067201
2025-12-25 14:31:40 INFO Epoch 084 | 25% complete (batch 46/181)
2025-12-25 14:31:41 INFO Epoch 084 | 50% complete (batch 91/181)
2025-12-25 14:31:42 INFO Epoch 084 | 75% complete (batch 136/181)
2025-12-25 14:31:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.573746
2025-12-25 14:31:57 INFO Tuning ranking metrics: regret=0.076454 spearman=-0.003196 (groups=34, skipped=318)
2025-12-25 14:31:57 INFO Epoch 084 | train_mse=0.055691 | val_loss=0.078590 | best_val_loss=0.067201
2025-12-25 14:32:06 INFO Epoch 085 | 25% complete (batch 46/181)
2025-12-25 14:32:07 INFO Epoch 085 | 50% complete (batch 91/181)
2025-12-25 14:32:09 INFO Epoch 085 | 75% complete (batch 136/181)
2025-12-25 14:32:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.580269
2025-12-25 14:32:24 INFO Tuning ranking metrics: regret=0.076454 spearman=0.013700 (groups=34, skipped=318)
2025-12-25 14:32:24 INFO Epoch 085 | train_mse=0.075098 | val_loss=0.075001 | best_val_loss=0.067201
2025-12-25 14:32:33 INFO Epoch 086 | 25% complete (batch 46/181)
2025-12-25 14:32:34 INFO Epoch 086 | 50% complete (batch 91/181)
2025-12-25 14:32:35 INFO Epoch 086 | 75% complete (batch 136/181)
2025-12-25 14:32:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.579105
2025-12-25 14:32:50 INFO Tuning ranking metrics: regret=0.076454 spearman=0.006353 (groups=34, skipped=318)
2025-12-25 14:32:50 INFO Epoch 086 | train_mse=0.060420 | val_loss=0.073902 | best_val_loss=0.067201
2025-12-25 14:32:59 INFO Epoch 087 | 25% complete (batch 46/181)
2025-12-25 14:33:00 INFO Epoch 087 | 50% complete (batch 91/181)
2025-12-25 14:33:01 INFO Epoch 087 | 75% complete (batch 136/181)
2025-12-25 14:33:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.575917
2025-12-25 14:33:16 INFO Tuning ranking metrics: regret=0.076454 spearman=0.004819 (groups=34, skipped=318)
2025-12-25 14:33:16 INFO Epoch 087 | train_mse=0.065937 | val_loss=0.079470 | best_val_loss=0.067201
2025-12-25 14:33:26 INFO Epoch 088 | 25% complete (batch 46/181)
2025-12-25 14:33:26 INFO Epoch 088 | 50% complete (batch 91/181)
2025-12-25 14:33:28 INFO Epoch 088 | 75% complete (batch 136/181)
2025-12-25 14:33:37 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.584307
2025-12-25 14:33:42 INFO Tuning ranking metrics: regret=0.076513 spearman=0.003336 (groups=34, skipped=318)
2025-12-25 14:33:42 INFO Epoch 088 | train_mse=0.070529 | val_loss=0.072322 | best_val_loss=0.067201
2025-12-25 14:33:52 INFO Epoch 089 | 25% complete (batch 46/181)
2025-12-25 14:33:53 INFO Epoch 089 | 50% complete (batch 91/181)
2025-12-25 14:33:54 INFO Epoch 089 | 75% complete (batch 136/181)
2025-12-25 14:34:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.595116
2025-12-25 14:34:08 INFO Tuning ranking metrics: regret=0.073510 spearman=0.000006 (groups=34, skipped=318)
2025-12-25 14:34:08 INFO Epoch 089 | train_mse=0.067766 | val_loss=0.071976 | best_val_loss=0.067201
2025-12-25 14:34:18 INFO Epoch 090 | 25% complete (batch 46/181)
2025-12-25 14:34:19 INFO Epoch 090 | 50% complete (batch 91/181)
2025-12-25 14:34:20 INFO Epoch 090 | 75% complete (batch 136/181)
2025-12-25 14:34:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.592195
2025-12-25 14:34:35 INFO Tuning ranking metrics: regret=0.057524 spearman=0.010027 (groups=34, skipped=318)
2025-12-25 14:34:35 INFO Epoch 090 | train_mse=0.061326 | val_loss=0.073488 | best_val_loss=0.067201
2025-12-25 14:34:44 INFO Epoch 091 | 25% complete (batch 46/181)
2025-12-25 14:34:45 INFO Epoch 091 | 50% complete (batch 91/181)
2025-12-25 14:34:46 INFO Epoch 091 | 75% complete (batch 136/181)
2025-12-25 14:34:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.599883
2025-12-25 14:35:01 INFO Tuning ranking metrics: regret=0.058235 spearman=0.007353 (groups=34, skipped=318)
2025-12-25 14:35:01 INFO Epoch 091 | train_mse=0.056223 | val_loss=0.072507 | best_val_loss=0.067201
2025-12-25 14:35:10 INFO Epoch 092 | 25% complete (batch 46/181)
2025-12-25 14:35:11 INFO Epoch 092 | 50% complete (batch 91/181)
2025-12-25 14:35:12 INFO Epoch 092 | 75% complete (batch 136/181)
2025-12-25 14:35:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.564639
2025-12-25 14:35:27 INFO Tuning ranking metrics: regret=0.076690 spearman=-0.064680 (groups=34, skipped=318)
2025-12-25 14:35:27 INFO Epoch 092 | train_mse=0.065266 | val_loss=0.096231 | best_val_loss=0.067201
2025-12-25 14:35:36 INFO Epoch 093 | 25% complete (batch 46/181)
2025-12-25 14:35:37 INFO Epoch 093 | 50% complete (batch 91/181)
2025-12-25 14:35:38 INFO Epoch 093 | 75% complete (batch 136/181)
2025-12-25 14:35:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.585873
2025-12-25 14:35:53 INFO Tuning ranking metrics: regret=0.062745 spearman=-0.048039 (groups=34, skipped=318)
2025-12-25 14:35:53 INFO Epoch 093 | train_mse=0.055764 | val_loss=0.078401 | best_val_loss=0.067201
2025-12-25 14:36:03 INFO Epoch 094 | 25% complete (batch 46/181)
2025-12-25 14:36:04 INFO Epoch 094 | 50% complete (batch 91/181)
2025-12-25 14:36:05 INFO Epoch 094 | 75% complete (batch 136/181)
2025-12-25 14:36:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.580973
2025-12-25 14:36:19 INFO Tuning ranking metrics: regret=0.058939 spearman=-0.017284 (groups=34, skipped=318)
2025-12-25 14:36:19 INFO Epoch 094 | train_mse=0.054055 | val_loss=0.078053 | best_val_loss=0.067201
2025-12-25 14:36:29 INFO Epoch 095 | 25% complete (batch 46/181)
2025-12-25 14:36:30 INFO Epoch 095 | 50% complete (batch 91/181)
2025-12-25 14:36:31 INFO Epoch 095 | 75% complete (batch 136/181)
2025-12-25 14:36:40 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.566711
2025-12-25 14:36:46 INFO Tuning ranking metrics: regret=0.057811 spearman=-0.020722 (groups=34, skipped=318)
2025-12-25 14:36:46 INFO Epoch 095 | train_mse=0.061118 | val_loss=0.091343 | best_val_loss=0.067201
2025-12-25 14:36:55 INFO Epoch 096 | 25% complete (batch 46/181)
2025-12-25 14:36:56 INFO Epoch 096 | 50% complete (batch 91/181)
2025-12-25 14:36:57 INFO Epoch 096 | 75% complete (batch 136/181)
2025-12-25 14:37:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.561168
2025-12-25 14:37:12 INFO Tuning ranking metrics: regret=0.061319 spearman=-0.030736 (groups=34, skipped=318)
2025-12-25 14:37:12 INFO Epoch 096 | train_mse=0.072031 | val_loss=0.076648 | best_val_loss=0.067201
2025-12-25 14:37:21 INFO Epoch 097 | 25% complete (batch 46/181)
2025-12-25 14:37:22 INFO Epoch 097 | 50% complete (batch 91/181)
2025-12-25 14:37:23 INFO Epoch 097 | 75% complete (batch 136/181)
2025-12-25 14:37:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.578731
2025-12-25 14:37:38 INFO Tuning ranking metrics: regret=0.061319 spearman=-0.029635 (groups=34, skipped=318)
2025-12-25 14:37:38 INFO Epoch 097 | train_mse=0.077781 | val_loss=0.075768 | best_val_loss=0.067201
2025-12-25 14:37:47 INFO Epoch 098 | 25% complete (batch 46/181)
2025-12-25 14:37:48 INFO Epoch 098 | 50% complete (batch 91/181)
2025-12-25 14:37:49 INFO Epoch 098 | 75% complete (batch 136/181)
2025-12-25 14:37:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.582859
2025-12-25 14:38:03 INFO Tuning ranking metrics: regret=0.058085 spearman=0.016221 (groups=34, skipped=318)
2025-12-25 14:38:03 INFO Epoch 098 | train_mse=0.066259 | val_loss=0.076703 | best_val_loss=0.067201
2025-12-25 14:38:13 INFO Epoch 099 | 25% complete (batch 46/181)
2025-12-25 14:38:14 INFO Epoch 099 | 50% complete (batch 91/181)
2025-12-25 14:38:15 INFO Epoch 099 | 75% complete (batch 136/181)
2025-12-25 14:38:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.587247
2025-12-25 14:38:29 INFO Tuning ranking metrics: regret=0.062682 spearman=-0.036924 (groups=34, skipped=318)
2025-12-25 14:38:29 INFO Epoch 099 | train_mse=0.069750 | val_loss=0.076089 | best_val_loss=0.067201
2025-12-25 14:38:39 INFO Epoch 100 | 25% complete (batch 46/181)
2025-12-25 14:38:40 INFO Epoch 100 | 50% complete (batch 91/181)
2025-12-25 14:38:41 INFO Epoch 100 | 75% complete (batch 136/181)
2025-12-25 14:38:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.554666
2025-12-25 14:38:57 INFO Tuning ranking metrics: regret=0.057811 spearman=-0.013344 (groups=34, skipped=318)
2025-12-25 14:38:57 INFO Epoch 100 | train_mse=0.056362 | val_loss=0.105064 | best_val_loss=0.067201
2025-12-25 14:39:07 INFO Epoch 101 | 25% complete (batch 46/181)
2025-12-25 14:39:08 INFO Epoch 101 | 50% complete (batch 91/181)
2025-12-25 14:39:09 INFO Epoch 101 | 75% complete (batch 136/181)
2025-12-25 14:39:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.572514
2025-12-25 14:39:25 INFO Tuning ranking metrics: regret=0.062346 spearman=-0.049739 (groups=34, skipped=318)
2025-12-25 14:39:25 INFO Epoch 101 | train_mse=0.050688 | val_loss=0.073417 | best_val_loss=0.067201
2025-12-25 14:39:35 INFO Epoch 102 | 25% complete (batch 46/181)
2025-12-25 14:39:36 INFO Epoch 102 | 50% complete (batch 91/181)
2025-12-25 14:39:37 INFO Epoch 102 | 75% complete (batch 136/181)
2025-12-25 14:39:47 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.567058
2025-12-25 14:39:53 INFO Tuning ranking metrics: regret=0.057748 spearman=-0.010886 (groups=34, skipped=318)
2025-12-25 14:39:53 INFO Epoch 102 | train_mse=0.077489 | val_loss=0.084189 | best_val_loss=0.067201
2025-12-25 14:40:03 INFO Epoch 103 | 25% complete (batch 46/181)
2025-12-25 14:40:04 INFO Epoch 103 | 50% complete (batch 91/181)
2025-12-25 14:40:06 INFO Epoch 103 | 75% complete (batch 136/181)
2025-12-25 14:40:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.583686
2025-12-25 14:40:21 INFO Tuning ranking metrics: regret=0.058876 spearman=-0.021078 (groups=34, skipped=318)
2025-12-25 14:40:21 INFO Epoch 103 | train_mse=0.075058 | val_loss=0.074485 | best_val_loss=0.067201
2025-12-25 14:40:31 INFO Epoch 104 | 25% complete (batch 46/181)
2025-12-25 14:40:31 INFO Epoch 104 | 50% complete (batch 91/181)
2025-12-25 14:40:33 INFO Epoch 104 | 75% complete (batch 136/181)
2025-12-25 14:40:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.582808
2025-12-25 14:40:47 INFO Tuning ranking metrics: regret=0.076450 spearman=-0.013452 (groups=34, skipped=318)
2025-12-25 14:40:47 INFO Epoch 104 | train_mse=0.060343 | val_loss=0.078113 | best_val_loss=0.067201
2025-12-25 14:40:56 INFO Epoch 105 | 25% complete (batch 46/181)
2025-12-25 14:40:57 INFO Epoch 105 | 50% complete (batch 91/181)
2025-12-25 14:40:59 INFO Epoch 105 | 75% complete (batch 136/181)
2025-12-25 14:41:08 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.593730
2025-12-25 14:41:13 INFO Tuning ranking metrics: regret=0.076450 spearman=-0.008072 (groups=34, skipped=318)
2025-12-25 14:41:13 INFO Epoch 105 | train_mse=0.077298 | val_loss=0.071651 | best_val_loss=0.067201
Monitored metric tuning_rank_spearman did not improve in the last 40 records. Best score: 0.181. Signaling Trainer to stop.
2025-12-25 14:41:14 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.05300_val-0.09982_epoch068.chkpt, checkpoint.tuning_rank_spearman-0.05567_val-0.09324_epoch066.chkpt, checkpoint.tuning_rank_spearman-0.06720_val-0.08628_epoch067.chkpt
2025-12-25 14:41:14 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.06720_val-0.08628_epoch067.chkpt
2025-12-25 14:41:14 INFO Best validation loss: tensor(0.0672)
2025-12-25 14:41:14 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.06720_val-0.08628_epoch067.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.06720_val-0.08628_epoch067.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-25 14:41:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.086276
2025-12-25 14:41:27 INFO Tuning ranking metrics: regret=0.073955 spearman=0.067201 (groups=34, skipped=318)
2025-12-25 14:41:27 INFO Epoch 106 | val_loss=0.086276 | best_val_loss=0.067201
2025-12-25 14:41:27 INFO Validation metrics: [{'val_loss': 0.0862755998969078, 'tuning_rank_regret': 0.07395511865615845, 'tuning_rank_spearman': 0.06720142811536789, 'val_pearson_corr': 0.6349987387657166, 'val_spearman_corr': 0.6128488779067993, 'val_rank_regret': 0.03362634405493736, 'val_rank_spearman': 0.4444444477558136}]
2025-12-25 14:41:27 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.06720_val-0.08628_epoch067.chkpt
2025-12-25 14:41:27 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.05567_val-0.09324_epoch066.chkpt
2025-12-25 14:41:27 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.05300_val-0.09982_epoch068.chkpt
2025-12-25 14:41:27 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.09324_epoch066.ckpt
2025-12-25 14:41:27 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.07395511865615845
  tuning_rank_spearman      0.06720142811536789
        val_loss            0.0862755998969078
    val_pearson_corr        0.6349987387657166
     val_rank_regret        0.03362634405493736
    val_rank_spearman       0.4444444477558136
    val_spearman_corr       0.6128488779067993
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run polish_seed101_2025-12-25_09-39-57_phase1 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase1
[run_full_pipeline] Phase 1 best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.06720_val-0.08628_epoch067.chkpt (tuning_rank_spearman=0.06720142811536789)
[run_full_pipeline] Phase 2 fine-tuning (seed 101) -> polish_seed101_2025-12-25_09-39-57_phase2_seed101
[train_cli] run_id=polish_seed101_2025-12-25_09-39-57_phase2_seed101 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed101/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed101 --git-commit 9b1bb2b320 --git-dirty --resume-from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.06720_val-0.08628_epoch067.chkpt
2025-12-25 14:41:34 INFO git_commit = 9b1bb2b320 (dirty)
2025-12-25 14:41:34 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-25 14:41:34 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed101/config/config.yaml
2025-12-25 14:41:34 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data
2025-12-25 14:41:34 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-25 14:41:34 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-25 14:41:34 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed101
2025-12-25 14:41:34 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-25 14:41:34 INFO   metadata_path = None
2025-12-25 14:41:34 INFO   summary_path = None
2025-12-25 14:41:34 INFO   accelerator = cpu
2025-12-25 14:41:34 INFO   devices = 1
2025-12-25 14:41:34 INFO   attention_head = 8
2025-12-25 14:41:34 INFO   pooling_type = mean
2025-12-25 14:41:34 INFO   model_self_loops = False
2025-12-25 14:41:34 INFO   model_self_loop_fill = mean
2025-12-25 14:41:34 INFO   model_residual = False
2025-12-25 14:41:34 INFO   batch_size = 48
2025-12-25 14:41:34 INFO   learning_rate = 0.001
2025-12-25 14:41:34 INFO   num_epochs = 320
2025-12-25 14:41:34 INFO   accumulate_grad_batches = 8
2025-12-25 14:41:34 INFO   seed = 101
2025-12-25 14:41:34 INFO   num_workers = 2
2025-12-25 14:41:34 INFO   precision = 32
2025-12-25 14:41:34 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-25 14:41:34 INFO   early_stopping_patience = 20
2025-12-25 14:41:34 INFO   lr_scheduler_patience = 4
2025-12-25 14:41:34 INFO   lr_scheduler_factor = 0.2
2025-12-25 14:41:34 INFO   fast_dev_run = False
2025-12-25 14:41:34 INFO   limit_train_batches = None
2025-12-25 14:41:34 INFO   limit_val_batches = None
2025-12-25 14:41:34 INFO   log_lr = False
2025-12-25 14:41:34 INFO   progress_bar_refresh_rate = 0
2025-12-25 14:41:34 INFO   log_every_n_steps = 100
2025-12-25 14:41:34 INFO   use_val_spearman_as_secondary = True
2025-12-25 14:41:34 INFO   spearman_secondary_min_delta = 0.0
2025-12-25 14:41:34 INFO   spearman_secondary_weight = 1.0
2025-12-25 14:41:34 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-25 14:41:34 INFO   tuning_max_samples = 500
2025-12-25 14:41:34 INFO   tuning_fraction = None
2025-12-25 14:41:34 INFO   tuning_eval_every = 1
2025-12-25 14:41:34 INFO   rank_loss_weight = 0.0
2025-12-25 14:41:34 INFO   rank_loss_margin = 0.0
2025-12-25 14:41:34 INFO   rank_loss_mode = hinge
2025-12-25 14:41:34 INFO   rank_loss_grouped = True
2025-12-25 14:41:34 INFO   variance_reduction_enabled = False
2025-12-25 14:41:34 INFO   variance_reduction_method = topk_avg
2025-12-25 14:41:34 INFO   variance_reduction_top_k = 3
2025-12-25 14:41:34 INFO   coverage_minimum = 0.0
2025-12-25 14:41:34 INFO   coverage_fail_on_missing = False
2025-12-25 14:41:34 INFO   graph_load_profiling = False
2025-12-25 14:41:34 INFO   graph_load_top_k = 5
2025-12-25 14:41:34 INFO   enable_graph_cache = True
2025-12-25 14:41:34 INFO   graph_cache_size = 256
2025-12-25 14:41:34 INFO   canonicalize_on_load = False
2025-12-25 14:41:34 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-25 14:41:34 INFO   edge_schema = {}
2025-12-25 14:41:34 INFO   topology_schema = {}
Seed set to 101
2025-12-25 14:41:34 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-25 14:41:34 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 14:41:34 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-25 14:41:34 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 14:41:34 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-25 14:41:34 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 14:41:35 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-25 14:41:35 INFO Tuning group stats: groups=348 groups>=2=37 singletons=311 max_group=11
2025-12-25 14:41:35 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed101/dataset_coverage.json
2025-12-25 14:41:35 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed101/dataset_coverage.json for details.
2025-12-25 14:41:35 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed101/dataset_coverage.json for details.
2025-12-25 14:41:35 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed101/dataset_coverage.json for details.
2025-12-25 14:41:35 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed101/schema_summary.json
2025-12-25 14:41:35 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed101/feature_metadata.json
2025-12-25 14:41:35 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-25 14:41:35 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/null_topology/feature-config.yaml.null.10A, sha256=f618659ace5620de7e794485915dadd4243f3ec2ca6726b4a9af3989817a8579
2025-12-25 14:41:35 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/work/edge_features)
2025-12-25 14:41:35 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json
2025-12-25 14:41:35 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed101/schema_summary.json
2025-12-25 14:41:35 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-25 14:41:35 INFO Topology: topology/persistence_null/v1 supporting the 172-dimensional node features.
2025-12-25 14:41:35 INFO Node: node/dssp_topo_merge/v1; metadata lists 172 feature columns matching the .pt tensor.
2025-12-25 14:41:35 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-25 14:41:35 INFO → Total feature dimensionality observed and confirmed: node_dim = 172, edge_dim = 11.
2025-12-25 14:41:35 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-25 14:41:35 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 172,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 172,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed101/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge/v1",
      "alias": "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA",
      "jobs": 16,
      "summary": "DSSP-derived node features merged with topology statistics."
    },
    "topology": {
      "id": "topology/persistence_null/v1",
      "alias": "Null topology (constant zeros) = 140D ablation",
      "jobs": 16,
      "summary": "Topology ablation: constant features with PH-compatible schema."
    }
  },
  "notes": []
}
2025-12-25 14:41:35 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-25 14:41:35 INFO Resuming from checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.06720_val-0.08628_epoch067.chkpt (epoch=67)
2025-12-25 14:41:36 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=b1c3ec3cb421466fa39a4caa4614dd3c)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-25 14:41:36 INFO Starting training (fast_dev_run=False)
2025-12-25 14:41:36 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed101/model_checkpoints exists and is not empty.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.06720_val-0.08628_epoch067.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase1/model_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed101/model_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase1/model_checkpoints/val_loss_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed101/model_checkpoints/val_loss_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 5.5 K  | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
165 K     Trainable params
0         Non-trainable params
165 K     Total params
0.662     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
Restored all states from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.06720_val-0.08628_epoch067.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-25 14:41:51 INFO Epoch 068 | 25% complete (batch 46/181)
2025-12-25 14:41:52 INFO Epoch 068 | 50% complete (batch 91/181)
2025-12-25 14:41:52 INFO Epoch 068 | 75% complete (batch 136/181)
2025-12-25 14:42:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.089819
2025-12-25 14:42:06 INFO Tuning ranking metrics: regret=0.109456 spearman=-0.027261 (groups=37, skipped=311)
2025-12-25 14:42:06 INFO Epoch 068 | val_loss=0.089819
2025-12-25 14:42:15 INFO Epoch 069 | 25% complete (batch 46/181)
2025-12-25 14:42:16 INFO Epoch 069 | 50% complete (batch 91/181)
2025-12-25 14:42:17 INFO Epoch 069 | 75% complete (batch 136/181)
2025-12-25 14:42:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.544517
2025-12-25 14:42:31 INFO Tuning ranking metrics: regret=0.130362 spearman=-0.018860 (groups=37, skipped=311)
2025-12-25 14:42:31 INFO Epoch 069 | train_mse=0.076389 | val_loss=0.085770 | best_val_loss=-0.027261
2025-12-25 14:42:39 INFO Epoch 070 | 25% complete (batch 46/181)
2025-12-25 14:42:40 INFO Epoch 070 | 50% complete (batch 91/181)
2025-12-25 14:42:41 INFO Epoch 070 | 75% complete (batch 136/181)
2025-12-25 14:42:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.534349
2025-12-25 14:42:55 INFO Tuning ranking metrics: regret=0.160425 spearman=-0.072277 (groups=37, skipped=311)
2025-12-25 14:42:55 INFO Epoch 070 | train_mse=0.097134 | val_loss=0.081115 | best_val_loss=-0.018860
2025-12-25 14:43:04 INFO Epoch 071 | 25% complete (batch 46/181)
2025-12-25 14:43:05 INFO Epoch 071 | 50% complete (batch 91/181)
2025-12-25 14:43:06 INFO Epoch 071 | 75% complete (batch 136/181)
2025-12-25 14:43:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.541485
2025-12-25 14:43:20 INFO Tuning ranking metrics: regret=0.095515 spearman=0.006499 (groups=37, skipped=311)
2025-12-25 14:43:20 INFO Epoch 071 | train_mse=0.082173 | val_loss=0.089775 | best_val_loss=-0.018860
2025-12-25 14:43:28 INFO Epoch 072 | 25% complete (batch 46/181)
2025-12-25 14:43:29 INFO Epoch 072 | 50% complete (batch 91/181)
2025-12-25 14:43:30 INFO Epoch 072 | 75% complete (batch 136/181)
2025-12-25 14:43:40 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.524266
2025-12-25 14:43:45 INFO Tuning ranking metrics: regret=0.138833 spearman=0.132005 (groups=37, skipped=311)
2025-12-25 14:43:45 INFO Epoch 072 | train_mse=0.071383 | val_loss=0.089085 | best_val_loss=0.006499
2025-12-25 14:43:54 INFO Epoch 073 | 25% complete (batch 46/181)
2025-12-25 14:43:55 INFO Epoch 073 | 50% complete (batch 91/181)
2025-12-25 14:43:56 INFO Epoch 073 | 75% complete (batch 136/181)
2025-12-25 14:44:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.528318
2025-12-25 14:44:11 INFO Tuning ranking metrics: regret=0.141327 spearman=0.001509 (groups=37, skipped=311)
2025-12-25 14:44:11 INFO Epoch 073 | train_mse=0.092243 | val_loss=0.082854 | best_val_loss=0.132005
2025-12-25 14:44:20 INFO Epoch 074 | 25% complete (batch 46/181)
2025-12-25 14:44:21 INFO Epoch 074 | 50% complete (batch 91/181)
2025-12-25 14:44:22 INFO Epoch 074 | 75% complete (batch 136/181)
2025-12-25 14:44:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.571869
2025-12-25 14:44:37 INFO Tuning ranking metrics: regret=0.140973 spearman=0.033719 (groups=37, skipped=311)
2025-12-25 14:44:37 INFO Epoch 074 | train_mse=0.081933 | val_loss=0.075018 | best_val_loss=0.132005
2025-12-25 14:44:46 INFO Epoch 075 | 25% complete (batch 46/181)
2025-12-25 14:44:47 INFO Epoch 075 | 50% complete (batch 91/181)
2025-12-25 14:44:48 INFO Epoch 075 | 75% complete (batch 136/181)
2025-12-25 14:44:57 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.559415
2025-12-25 14:45:03 INFO Tuning ranking metrics: regret=0.136819 spearman=0.054370 (groups=37, skipped=311)
2025-12-25 14:45:03 INFO Epoch 075 | train_mse=0.068239 | val_loss=0.092552 | best_val_loss=0.132005
2025-12-25 14:45:12 INFO Epoch 076 | 25% complete (batch 46/181)
2025-12-25 14:45:13 INFO Epoch 076 | 50% complete (batch 91/181)
2025-12-25 14:45:14 INFO Epoch 076 | 75% complete (batch 136/181)
2025-12-25 14:45:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.541501
2025-12-25 14:45:29 INFO Tuning ranking metrics: regret=0.140534 spearman=0.081011 (groups=37, skipped=311)
2025-12-25 14:45:29 INFO Epoch 076 | train_mse=0.070054 | val_loss=0.082883 | best_val_loss=0.132005
2025-12-25 14:45:38 INFO Epoch 077 | 25% complete (batch 46/181)
2025-12-25 14:45:39 INFO Epoch 077 | 50% complete (batch 91/181)
2025-12-25 14:45:40 INFO Epoch 077 | 75% complete (batch 136/181)
2025-12-25 14:45:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.507084
2025-12-25 14:45:54 INFO Tuning ranking metrics: regret=0.128311 spearman=0.056160 (groups=37, skipped=311)
2025-12-25 14:45:54 INFO Epoch 077 | train_mse=0.074974 | val_loss=0.118474 | best_val_loss=0.132005
2025-12-25 14:46:04 INFO Epoch 078 | 25% complete (batch 46/181)
2025-12-25 14:46:05 INFO Epoch 078 | 50% complete (batch 91/181)
2025-12-25 14:46:06 INFO Epoch 078 | 75% complete (batch 136/181)
2025-12-25 14:46:15 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.491913
2025-12-25 14:46:20 INFO Tuning ranking metrics: regret=0.127810 spearman=0.086100 (groups=37, skipped=311)
2025-12-25 14:46:20 INFO Epoch 078 | train_mse=0.077945 | val_loss=0.129336 | best_val_loss=0.132005
2025-12-25 14:46:30 INFO Epoch 079 | 25% complete (batch 46/181)
2025-12-25 14:46:31 INFO Epoch 079 | 50% complete (batch 91/181)
2025-12-25 14:46:32 INFO Epoch 079 | 75% complete (batch 136/181)
2025-12-25 14:46:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.536701
2025-12-25 14:46:46 INFO Tuning ranking metrics: regret=0.129599 spearman=0.053036 (groups=37, skipped=311)
2025-12-25 14:46:46 INFO Epoch 079 | train_mse=0.081176 | val_loss=0.079652 | best_val_loss=0.132005
2025-12-25 14:46:56 INFO Epoch 080 | 25% complete (batch 46/181)
2025-12-25 14:46:57 INFO Epoch 080 | 50% complete (batch 91/181)
2025-12-25 14:46:58 INFO Epoch 080 | 75% complete (batch 136/181)
2025-12-25 14:47:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.562944
2025-12-25 14:47:12 INFO Tuning ranking metrics: regret=0.152278 spearman=0.057675 (groups=37, skipped=311)
2025-12-25 14:47:12 INFO Epoch 080 | train_mse=0.094745 | val_loss=0.079231 | best_val_loss=0.132005
2025-12-25 14:47:22 INFO Epoch 081 | 25% complete (batch 46/181)
2025-12-25 14:47:23 INFO Epoch 081 | 50% complete (batch 91/181)
2025-12-25 14:47:24 INFO Epoch 081 | 75% complete (batch 136/181)
2025-12-25 14:47:33 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.573373
2025-12-25 14:47:38 INFO Tuning ranking metrics: regret=0.144544 spearman=0.089166 (groups=37, skipped=311)
2025-12-25 14:47:38 INFO Epoch 081 | train_mse=0.066482 | val_loss=0.078376 | best_val_loss=0.132005
2025-12-25 14:47:48 INFO Epoch 082 | 25% complete (batch 46/181)
2025-12-25 14:47:49 INFO Epoch 082 | 50% complete (batch 91/181)
2025-12-25 14:47:50 INFO Epoch 082 | 75% complete (batch 136/181)
2025-12-25 14:47:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.575013
2025-12-25 14:48:05 INFO Tuning ranking metrics: regret=0.145165 spearman=0.084884 (groups=37, skipped=311)
2025-12-25 14:48:05 INFO Epoch 082 | train_mse=0.061879 | val_loss=0.078530 | best_val_loss=0.132005
2025-12-25 14:48:14 INFO Epoch 083 | 25% complete (batch 46/181)
2025-12-25 14:48:15 INFO Epoch 083 | 50% complete (batch 91/181)
2025-12-25 14:48:16 INFO Epoch 083 | 75% complete (batch 136/181)
2025-12-25 14:48:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.563176
2025-12-25 14:48:31 INFO Tuning ranking metrics: regret=0.138752 spearman=0.028729 (groups=37, skipped=311)
2025-12-25 14:48:31 INFO Epoch 083 | train_mse=0.080726 | val_loss=0.113221 | best_val_loss=0.132005
2025-12-25 14:48:40 INFO Epoch 084 | 25% complete (batch 46/181)
2025-12-25 14:48:41 INFO Epoch 084 | 50% complete (batch 91/181)
2025-12-25 14:48:42 INFO Epoch 084 | 75% complete (batch 136/181)
2025-12-25 14:48:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.524333
2025-12-25 14:48:57 INFO Tuning ranking metrics: regret=0.145473 spearman=0.042635 (groups=37, skipped=311)
2025-12-25 14:48:57 INFO Epoch 084 | train_mse=0.093385 | val_loss=0.110397 | best_val_loss=0.132005
2025-12-25 14:49:06 INFO Epoch 085 | 25% complete (batch 46/181)
2025-12-25 14:49:08 INFO Epoch 085 | 50% complete (batch 91/181)
2025-12-25 14:49:09 INFO Epoch 085 | 75% complete (batch 136/181)
2025-12-25 14:49:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.563563
2025-12-25 14:49:23 INFO Tuning ranking metrics: regret=0.154116 spearman=-0.104645 (groups=37, skipped=311)
2025-12-25 14:49:23 INFO Epoch 085 | train_mse=0.076132 | val_loss=0.082452 | best_val_loss=0.132005
2025-12-25 14:49:33 INFO Epoch 086 | 25% complete (batch 46/181)
2025-12-25 14:49:34 INFO Epoch 086 | 50% complete (batch 91/181)
2025-12-25 14:49:35 INFO Epoch 086 | 75% complete (batch 136/181)
2025-12-25 14:49:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.559703
2025-12-25 14:49:50 INFO Tuning ranking metrics: regret=0.149540 spearman=-0.025559 (groups=37, skipped=311)
2025-12-25 14:49:50 INFO Epoch 086 | train_mse=0.053605 | val_loss=0.102358 | best_val_loss=0.132005
2025-12-25 14:49:58 INFO Epoch 087 | 25% complete (batch 46/181)
2025-12-25 14:50:00 INFO Epoch 087 | 50% complete (batch 91/181)
2025-12-25 14:50:01 INFO Epoch 087 | 75% complete (batch 136/181)
2025-12-25 14:50:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.575974
2025-12-25 14:50:14 INFO Tuning ranking metrics: regret=0.129677 spearman=0.030426 (groups=37, skipped=311)
2025-12-25 14:50:14 INFO Epoch 087 | train_mse=0.077086 | val_loss=0.071047 | best_val_loss=0.132005
2025-12-25 14:50:23 INFO Epoch 088 | 25% complete (batch 46/181)
2025-12-25 14:50:24 INFO Epoch 088 | 50% complete (batch 91/181)
2025-12-25 14:50:25 INFO Epoch 088 | 75% complete (batch 136/181)
2025-12-25 14:50:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.605665
2025-12-25 14:50:40 INFO Tuning ranking metrics: regret=0.113486 spearman=0.083006 (groups=37, skipped=311)
2025-12-25 14:50:40 INFO Epoch 088 | train_mse=0.057246 | val_loss=0.073331 | best_val_loss=0.132005
2025-12-25 14:50:48 INFO Epoch 089 | 25% complete (batch 46/181)
2025-12-25 14:50:49 INFO Epoch 089 | 50% complete (batch 91/181)
2025-12-25 14:50:50 INFO Epoch 089 | 75% complete (batch 136/181)
2025-12-25 14:50:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.587070
2025-12-25 14:51:04 INFO Tuning ranking metrics: regret=0.128643 spearman=0.031145 (groups=37, skipped=311)
2025-12-25 14:51:04 INFO Epoch 089 | train_mse=0.048223 | val_loss=0.080005 | best_val_loss=0.132005
2025-12-25 14:51:13 INFO Epoch 090 | 25% complete (batch 46/181)
2025-12-25 14:51:14 INFO Epoch 090 | 50% complete (batch 91/181)
2025-12-25 14:51:15 INFO Epoch 090 | 75% complete (batch 136/181)
2025-12-25 14:51:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.586237
2025-12-25 14:51:29 INFO Tuning ranking metrics: regret=0.130709 spearman=-0.003808 (groups=37, skipped=311)
2025-12-25 14:51:29 INFO Epoch 090 | train_mse=0.084073 | val_loss=0.091569 | best_val_loss=0.132005
2025-12-25 14:51:37 INFO Epoch 091 | 25% complete (batch 46/181)
2025-12-25 14:51:38 INFO Epoch 091 | 50% complete (batch 91/181)
2025-12-25 14:51:39 INFO Epoch 091 | 75% complete (batch 136/181)
2025-12-25 14:51:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.576102
2025-12-25 14:51:54 INFO Tuning ranking metrics: regret=0.143781 spearman=0.055944 (groups=37, skipped=311)
2025-12-25 14:51:54 INFO Epoch 091 | train_mse=0.059806 | val_loss=0.072042 | best_val_loss=0.132005
2025-12-25 14:52:03 INFO Epoch 092 | 25% complete (batch 46/181)
2025-12-25 14:52:03 INFO Epoch 092 | 50% complete (batch 91/181)
2025-12-25 14:52:04 INFO Epoch 092 | 75% complete (batch 136/181)
2025-12-25 14:52:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.578912
2025-12-25 14:52:19 INFO Tuning ranking metrics: regret=0.092500 spearman=0.082707 (groups=37, skipped=311)
2025-12-25 14:52:19 INFO Epoch 092 | train_mse=0.071413 | val_loss=0.083083 | best_val_loss=0.132005
2025-12-25 14:52:27 INFO Epoch 093 | 25% complete (batch 46/181)
2025-12-25 14:52:28 INFO Epoch 093 | 50% complete (batch 91/181)
2025-12-25 14:52:29 INFO Epoch 093 | 75% complete (batch 136/181)
2025-12-25 14:52:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.593717
2025-12-25 14:52:43 INFO Tuning ranking metrics: regret=0.127864 spearman=0.095297 (groups=37, skipped=311)
2025-12-25 14:52:43 INFO Epoch 093 | train_mse=0.077828 | val_loss=0.074951 | best_val_loss=0.132005
2025-12-25 14:52:52 INFO Epoch 094 | 25% complete (batch 46/181)
2025-12-25 14:52:53 INFO Epoch 094 | 50% complete (batch 91/181)
2025-12-25 14:52:54 INFO Epoch 094 | 75% complete (batch 136/181)
2025-12-25 14:53:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.596158
2025-12-25 14:53:08 INFO Tuning ranking metrics: regret=0.131865 spearman=0.025056 (groups=37, skipped=311)
2025-12-25 14:53:08 INFO Epoch 094 | train_mse=0.068433 | val_loss=0.085303 | best_val_loss=0.132005
2025-12-25 14:53:17 INFO Epoch 095 | 25% complete (batch 46/181)
2025-12-25 14:53:17 INFO Epoch 095 | 50% complete (batch 91/181)
2025-12-25 14:53:18 INFO Epoch 095 | 75% complete (batch 136/181)
2025-12-25 14:53:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.602363
2025-12-25 14:53:32 INFO Tuning ranking metrics: regret=0.113438 spearman=0.108272 (groups=37, skipped=311)
2025-12-25 14:53:32 INFO Epoch 095 | train_mse=0.077608 | val_loss=0.072173 | best_val_loss=0.132005
2025-12-25 14:53:41 INFO Epoch 096 | 25% complete (batch 46/181)
2025-12-25 14:53:42 INFO Epoch 096 | 50% complete (batch 91/181)
2025-12-25 14:53:43 INFO Epoch 096 | 75% complete (batch 136/181)
2025-12-25 14:53:51 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.587972
2025-12-25 14:53:57 INFO Tuning ranking metrics: regret=0.132881 spearman=0.142945 (groups=37, skipped=311)
2025-12-25 14:53:57 INFO Epoch 096 | train_mse=0.067016 | val_loss=0.076084 | best_val_loss=0.132005
2025-12-25 14:54:05 INFO Epoch 097 | 25% complete (batch 46/181)
2025-12-25 14:54:06 INFO Epoch 097 | 50% complete (batch 91/181)
2025-12-25 14:54:07 INFO Epoch 097 | 75% complete (batch 136/181)
2025-12-25 14:54:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.573383
2025-12-25 14:54:21 INFO Tuning ranking metrics: regret=0.114618 spearman=-0.042021 (groups=37, skipped=311)
2025-12-25 14:54:21 INFO Epoch 097 | train_mse=0.066681 | val_loss=0.079188 | best_val_loss=0.142945
2025-12-25 14:54:30 INFO Epoch 098 | 25% complete (batch 46/181)
2025-12-25 14:54:31 INFO Epoch 098 | 50% complete (batch 91/181)
2025-12-25 14:54:32 INFO Epoch 098 | 75% complete (batch 136/181)
2025-12-25 14:54:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.562539
2025-12-25 14:54:46 INFO Tuning ranking metrics: regret=0.121003 spearman=-0.006464 (groups=37, skipped=311)
2025-12-25 14:54:46 INFO Epoch 098 | train_mse=0.079050 | val_loss=0.083325 | best_val_loss=0.142945
2025-12-25 14:54:55 INFO Epoch 099 | 25% complete (batch 46/181)
2025-12-25 14:54:56 INFO Epoch 099 | 50% complete (batch 91/181)
2025-12-25 14:54:57 INFO Epoch 099 | 75% complete (batch 136/181)
2025-12-25 14:55:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.575746
2025-12-25 14:55:11 INFO Tuning ranking metrics: regret=0.145266 spearman=-0.091085 (groups=37, skipped=311)
2025-12-25 14:55:11 INFO Epoch 099 | train_mse=0.082259 | val_loss=0.083397 | best_val_loss=0.142945
2025-12-25 14:55:19 INFO Epoch 100 | 25% complete (batch 46/181)
2025-12-25 14:55:20 INFO Epoch 100 | 50% complete (batch 91/181)
2025-12-25 14:55:21 INFO Epoch 100 | 75% complete (batch 136/181)
2025-12-25 14:55:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.509251
2025-12-25 14:55:35 INFO Tuning ranking metrics: regret=0.150385 spearman=0.051006 (groups=37, skipped=311)
2025-12-25 14:55:35 INFO Epoch 100 | train_mse=0.074668 | val_loss=0.113490 | best_val_loss=0.142945
2025-12-25 14:55:44 INFO Epoch 101 | 25% complete (batch 46/181)
2025-12-25 14:55:45 INFO Epoch 101 | 50% complete (batch 91/181)
2025-12-25 14:55:46 INFO Epoch 101 | 75% complete (batch 136/181)
2025-12-25 14:55:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.533899
2025-12-25 14:56:00 INFO Tuning ranking metrics: regret=0.137982 spearman=0.177466 (groups=37, skipped=311)
2025-12-25 14:56:00 INFO Epoch 101 | train_mse=0.072497 | val_loss=0.090821 | best_val_loss=0.142945
2025-12-25 14:56:08 INFO Epoch 102 | 25% complete (batch 46/181)
2025-12-25 14:56:09 INFO Epoch 102 | 50% complete (batch 91/181)
2025-12-25 14:56:10 INFO Epoch 102 | 75% complete (batch 136/181)
2025-12-25 14:56:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.555059
2025-12-25 14:56:25 INFO Tuning ranking metrics: regret=0.150325 spearman=0.062191 (groups=37, skipped=311)
2025-12-25 14:56:25 INFO Epoch 102 | train_mse=0.082882 | val_loss=0.079319 | best_val_loss=0.177466
2025-12-25 14:56:33 INFO Epoch 103 | 25% complete (batch 46/181)
2025-12-25 14:56:34 INFO Epoch 103 | 50% complete (batch 91/181)
2025-12-25 14:56:35 INFO Epoch 103 | 75% complete (batch 136/181)
2025-12-25 14:56:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.574881
2025-12-25 14:56:49 INFO Tuning ranking metrics: regret=0.149758 spearman=-0.056540 (groups=37, skipped=311)
2025-12-25 14:56:49 INFO Epoch 103 | train_mse=0.052569 | val_loss=0.075678 | best_val_loss=0.177466
2025-12-25 14:56:58 INFO Epoch 104 | 25% complete (batch 46/181)
2025-12-25 14:56:59 INFO Epoch 104 | 50% complete (batch 91/181)
2025-12-25 14:57:00 INFO Epoch 104 | 75% complete (batch 136/181)
2025-12-25 14:57:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.573475
2025-12-25 14:57:14 INFO Tuning ranking metrics: regret=0.117552 spearman=0.031438 (groups=37, skipped=311)
2025-12-25 14:57:14 INFO Epoch 104 | train_mse=0.078691 | val_loss=0.082567 | best_val_loss=0.177466
2025-12-25 14:57:23 INFO Epoch 105 | 25% complete (batch 46/181)
2025-12-25 14:57:24 INFO Epoch 105 | 50% complete (batch 91/181)
2025-12-25 14:57:25 INFO Epoch 105 | 75% complete (batch 136/181)
2025-12-25 14:57:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.526914
2025-12-25 14:57:39 INFO Tuning ranking metrics: regret=0.141818 spearman=0.090324 (groups=37, skipped=311)
2025-12-25 14:57:39 INFO Epoch 105 | train_mse=0.072419 | val_loss=0.105939 | best_val_loss=0.177466
Monitored metric tuning_rank_spearman did not improve in the last 40 records. Best score: 0.181. Signaling Trainer to stop.
2025-12-25 14:57:40 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.13201_val-0.08909_epoch072.chkpt, checkpoint.tuning_rank_spearman-0.14294_val-0.07608_epoch096.chkpt, checkpoint.tuning_rank_spearman-0.17747_val-0.09082_epoch101.chkpt
2025-12-25 14:57:40 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed101/model_checkpoints/checkpoint.tuning_rank_spearman-0.17747_val-0.09082_epoch101.chkpt
2025-12-25 14:57:40 INFO Best validation loss: tensor(0.1775)
2025-12-25 14:57:40 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed101/model_checkpoints/checkpoint.tuning_rank_spearman-0.17747_val-0.09082_epoch101.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed101/model_checkpoints/checkpoint.tuning_rank_spearman-0.17747_val-0.09082_epoch101.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-25 14:57:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.090821
2025-12-25 14:57:53 INFO Tuning ranking metrics: regret=0.137982 spearman=0.177466 (groups=37, skipped=311)
2025-12-25 14:57:53 INFO Epoch 106 | val_loss=0.090821 | best_val_loss=0.177466
2025-12-25 14:57:54 INFO Validation metrics: [{'val_loss': 0.09082143753767014, 'tuning_rank_regret': 0.137981578707695, 'tuning_rank_spearman': 0.1774657815694809, 'val_pearson_corr': 0.6450737118721008, 'val_spearman_corr': 0.63437819480896, 'val_rank_regret': 0.03826449066400528, 'val_rank_spearman': 0.1111111119389534}]
2025-12-25 14:57:54 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.17747_val-0.09082_epoch101.chkpt
2025-12-25 14:57:54 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.13201_val-0.08909_epoch072.chkpt
2025-12-25 14:57:54 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.14294_val-0.07608_epoch096.chkpt
2025-12-25 14:57:54 INFO Renamed checkpoint file: alt_val.val-0.07105_epoch087.ckpt -> alt_val.val-0.07105_epoch087.chkpt
2025-12-25 14:57:54 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.07105_epoch087.chkpt
2025-12-25 14:57:54 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret        0.137981578707695
  tuning_rank_spearman      0.1774657815694809
        val_loss            0.09082143753767014
    val_pearson_corr        0.6450737118721008
     val_rank_regret        0.03826449066400528
    val_rank_spearman       0.1111111119389534
    val_spearman_corr        0.63437819480896
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run polish_seed101_2025-12-25_09-39-57_phase2_seed101 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed101
[run_full_pipeline] Phase 2 (seed 101) best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed101/model_checkpoints/checkpoint.tuning_rank_spearman-0.17747_val-0.09082_epoch101.chkpt (tuning_rank_spearman=0.1774657815694809)
[run_full_pipeline] Phase 2 fine-tuning (seed 555) -> polish_seed101_2025-12-25_09-39-57_phase2_seed555
[train_cli] run_id=polish_seed101_2025-12-25_09-39-57_phase2_seed555 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed555/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed555 --git-commit 9b1bb2b320 --git-dirty --resume-from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.06720_val-0.08628_epoch067.chkpt
2025-12-25 14:58:00 INFO git_commit = 9b1bb2b320 (dirty)
2025-12-25 14:58:00 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-25 14:58:00 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed555/config/config.yaml
2025-12-25 14:58:00 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data
2025-12-25 14:58:00 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-25 14:58:00 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-25 14:58:00 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed555
2025-12-25 14:58:00 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-25 14:58:00 INFO   metadata_path = None
2025-12-25 14:58:00 INFO   summary_path = None
2025-12-25 14:58:00 INFO   accelerator = cpu
2025-12-25 14:58:00 INFO   devices = 1
2025-12-25 14:58:00 INFO   attention_head = 8
2025-12-25 14:58:00 INFO   pooling_type = mean
2025-12-25 14:58:00 INFO   model_self_loops = False
2025-12-25 14:58:00 INFO   model_self_loop_fill = mean
2025-12-25 14:58:00 INFO   model_residual = False
2025-12-25 14:58:00 INFO   batch_size = 48
2025-12-25 14:58:00 INFO   learning_rate = 0.001
2025-12-25 14:58:00 INFO   num_epochs = 320
2025-12-25 14:58:00 INFO   accumulate_grad_batches = 8
2025-12-25 14:58:00 INFO   seed = 555
2025-12-25 14:58:00 INFO   num_workers = 2
2025-12-25 14:58:00 INFO   precision = 32
2025-12-25 14:58:00 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-25 14:58:00 INFO   early_stopping_patience = 20
2025-12-25 14:58:00 INFO   lr_scheduler_patience = 4
2025-12-25 14:58:00 INFO   lr_scheduler_factor = 0.2
2025-12-25 14:58:00 INFO   fast_dev_run = False
2025-12-25 14:58:00 INFO   limit_train_batches = None
2025-12-25 14:58:00 INFO   limit_val_batches = None
2025-12-25 14:58:00 INFO   log_lr = False
2025-12-25 14:58:00 INFO   progress_bar_refresh_rate = 0
2025-12-25 14:58:00 INFO   log_every_n_steps = 100
2025-12-25 14:58:00 INFO   use_val_spearman_as_secondary = True
2025-12-25 14:58:00 INFO   spearman_secondary_min_delta = 0.0
2025-12-25 14:58:00 INFO   spearman_secondary_weight = 1.0
2025-12-25 14:58:00 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-25 14:58:00 INFO   tuning_max_samples = 500
2025-12-25 14:58:00 INFO   tuning_fraction = None
2025-12-25 14:58:00 INFO   tuning_eval_every = 1
2025-12-25 14:58:00 INFO   rank_loss_weight = 0.0
2025-12-25 14:58:00 INFO   rank_loss_margin = 0.0
2025-12-25 14:58:00 INFO   rank_loss_mode = hinge
2025-12-25 14:58:00 INFO   rank_loss_grouped = True
2025-12-25 14:58:00 INFO   variance_reduction_enabled = False
2025-12-25 14:58:00 INFO   variance_reduction_method = topk_avg
2025-12-25 14:58:00 INFO   variance_reduction_top_k = 3
2025-12-25 14:58:00 INFO   coverage_minimum = 0.0
2025-12-25 14:58:00 INFO   coverage_fail_on_missing = False
2025-12-25 14:58:00 INFO   graph_load_profiling = False
2025-12-25 14:58:00 INFO   graph_load_top_k = 5
2025-12-25 14:58:00 INFO   enable_graph_cache = True
2025-12-25 14:58:00 INFO   graph_cache_size = 256
2025-12-25 14:58:00 INFO   canonicalize_on_load = False
2025-12-25 14:58:00 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-25 14:58:00 INFO   edge_schema = {}
2025-12-25 14:58:00 INFO   topology_schema = {}
Seed set to 555
2025-12-25 14:58:01 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-25 14:58:01 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 14:58:01 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-25 14:58:01 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 14:58:01 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-25 14:58:01 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 14:58:02 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-25 14:58:02 INFO Tuning group stats: groups=368 groups>=2=39 singletons=329 max_group=9
2025-12-25 14:58:02 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed555/dataset_coverage.json
2025-12-25 14:58:02 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed555/dataset_coverage.json for details.
2025-12-25 14:58:02 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed555/dataset_coverage.json for details.
2025-12-25 14:58:02 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed555/dataset_coverage.json for details.
2025-12-25 14:58:02 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed555/schema_summary.json
2025-12-25 14:58:02 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed555/feature_metadata.json
2025-12-25 14:58:02 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-25 14:58:02 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/null_topology/feature-config.yaml.null.10A, sha256=f618659ace5620de7e794485915dadd4243f3ec2ca6726b4a9af3989817a8579
2025-12-25 14:58:02 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/work/edge_features)
2025-12-25 14:58:02 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json
2025-12-25 14:58:02 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed555/schema_summary.json
2025-12-25 14:58:02 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-25 14:58:02 INFO Topology: topology/persistence_null/v1 supporting the 172-dimensional node features.
2025-12-25 14:58:02 INFO Node: node/dssp_topo_merge/v1; metadata lists 172 feature columns matching the .pt tensor.
2025-12-25 14:58:02 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-25 14:58:02 INFO → Total feature dimensionality observed and confirmed: node_dim = 172, edge_dim = 11.
2025-12-25 14:58:02 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-25 14:58:02 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 172,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 172,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed555/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge/v1",
      "alias": "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA",
      "jobs": 16,
      "summary": "DSSP-derived node features merged with topology statistics."
    },
    "topology": {
      "id": "topology/persistence_null/v1",
      "alias": "Null topology (constant zeros) = 140D ablation",
      "jobs": 16,
      "summary": "Topology ablation: constant features with PH-compatible schema."
    }
  },
  "notes": []
}
2025-12-25 14:58:02 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-25 14:58:02 INFO Resuming from checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.06720_val-0.08628_epoch067.chkpt (epoch=67)
2025-12-25 14:58:02 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=eceab0c9e853458c918aa5b5d37d6f49)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-25 14:58:02 INFO Starting training (fast_dev_run=False)
2025-12-25 14:58:02 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed555/model_checkpoints exists and is not empty.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.06720_val-0.08628_epoch067.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase1/model_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed555/model_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase1/model_checkpoints/val_loss_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed555/model_checkpoints/val_loss_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 5.5 K  | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
165 K     Trainable params
0         Non-trainable params
165 K     Total params
0.662     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
Restored all states from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.06720_val-0.08628_epoch067.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-25 14:58:17 INFO Epoch 068 | 25% complete (batch 46/181)
2025-12-25 14:58:18 INFO Epoch 068 | 50% complete (batch 91/181)
2025-12-25 14:58:19 INFO Epoch 068 | 75% complete (batch 136/181)
2025-12-25 14:58:27 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.116195
2025-12-25 14:58:33 INFO Tuning ranking metrics: regret=0.099073 spearman=0.298718 (groups=39, skipped=329)
2025-12-25 14:58:33 INFO Epoch 068 | val_loss=0.116195
Metric tuning_rank_spearman improved by 0.118 >= min_delta = 0.0. New best score: 0.299
2025-12-25 14:58:41 INFO Epoch 069 | 25% complete (batch 46/181)
2025-12-25 14:58:42 INFO Epoch 069 | 50% complete (batch 91/181)
2025-12-25 14:58:43 INFO Epoch 069 | 75% complete (batch 136/181)
2025-12-25 14:58:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.529296
2025-12-25 14:58:57 INFO Tuning ranking metrics: regret=0.102694 spearman=0.250611 (groups=39, skipped=329)
2025-12-25 14:58:57 INFO Epoch 069 | train_mse=0.093931 | val_loss=0.081742 | best_val_loss=0.298718
2025-12-25 14:59:06 INFO Epoch 070 | 25% complete (batch 46/181)
2025-12-25 14:59:07 INFO Epoch 070 | 50% complete (batch 91/181)
2025-12-25 14:59:08 INFO Epoch 070 | 75% complete (batch 136/181)
2025-12-25 14:59:16 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.545572
2025-12-25 14:59:22 INFO Tuning ranking metrics: regret=0.118183 spearman=0.116606 (groups=39, skipped=329)
2025-12-25 14:59:22 INFO Epoch 070 | train_mse=0.099454 | val_loss=0.086174 | best_val_loss=0.298718
2025-12-25 14:59:30 INFO Epoch 071 | 25% complete (batch 46/181)
2025-12-25 14:59:31 INFO Epoch 071 | 50% complete (batch 91/181)
2025-12-25 14:59:32 INFO Epoch 071 | 75% complete (batch 136/181)
2025-12-25 14:59:40 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.540507
2025-12-25 14:59:46 INFO Tuning ranking metrics: regret=0.119459 spearman=0.162027 (groups=39, skipped=329)
2025-12-25 14:59:46 INFO Epoch 071 | train_mse=0.098323 | val_loss=0.080189 | best_val_loss=0.298718
2025-12-25 14:59:54 INFO Epoch 072 | 25% complete (batch 46/181)
2025-12-25 14:59:55 INFO Epoch 072 | 50% complete (batch 91/181)
2025-12-25 14:59:56 INFO Epoch 072 | 75% complete (batch 136/181)
2025-12-25 15:00:05 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.548403
2025-12-25 15:00:10 INFO Tuning ranking metrics: regret=0.097296 spearman=0.240659 (groups=39, skipped=329)
2025-12-25 15:00:10 INFO Epoch 072 | train_mse=0.084454 | val_loss=0.081498 | best_val_loss=0.298718
2025-12-25 15:00:19 INFO Epoch 073 | 25% complete (batch 46/181)
2025-12-25 15:00:20 INFO Epoch 073 | 50% complete (batch 91/181)
2025-12-25 15:00:21 INFO Epoch 073 | 75% complete (batch 136/181)
2025-12-25 15:00:29 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.530553
2025-12-25 15:00:35 INFO Tuning ranking metrics: regret=0.125849 spearman=0.216239 (groups=39, skipped=329)
2025-12-25 15:00:35 INFO Epoch 073 | train_mse=0.088550 | val_loss=0.098879 | best_val_loss=0.298718
2025-12-25 15:00:43 INFO Epoch 074 | 25% complete (batch 46/181)
2025-12-25 15:00:44 INFO Epoch 074 | 50% complete (batch 91/181)
2025-12-25 15:00:45 INFO Epoch 074 | 75% complete (batch 136/181)
2025-12-25 15:00:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.517356
2025-12-25 15:00:59 INFO Tuning ranking metrics: regret=0.109229 spearman=0.205739 (groups=39, skipped=329)
2025-12-25 15:00:59 INFO Epoch 074 | train_mse=0.064352 | val_loss=0.113132 | best_val_loss=0.298718
2025-12-25 15:01:08 INFO Epoch 075 | 25% complete (batch 46/181)
2025-12-25 15:01:09 INFO Epoch 075 | 50% complete (batch 91/181)
2025-12-25 15:01:10 INFO Epoch 075 | 75% complete (batch 136/181)
2025-12-25 15:01:18 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.556290
2025-12-25 15:01:23 INFO Tuning ranking metrics: regret=0.090872 spearman=0.172650 (groups=39, skipped=329)
2025-12-25 15:01:23 INFO Epoch 075 | train_mse=0.073114 | val_loss=0.079933 | best_val_loss=0.298718
2025-12-25 15:01:32 INFO Epoch 076 | 25% complete (batch 46/181)
2025-12-25 15:01:33 INFO Epoch 076 | 50% complete (batch 91/181)
2025-12-25 15:01:34 INFO Epoch 076 | 75% complete (batch 136/181)
2025-12-25 15:01:43 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.568040
2025-12-25 15:01:48 INFO Tuning ranking metrics: regret=0.110570 spearman=0.185165 (groups=39, skipped=329)
2025-12-25 15:01:48 INFO Epoch 076 | train_mse=0.068789 | val_loss=0.080574 | best_val_loss=0.298718
2025-12-25 15:01:57 INFO Epoch 077 | 25% complete (batch 46/181)
2025-12-25 15:01:58 INFO Epoch 077 | 50% complete (batch 91/181)
2025-12-25 15:01:58 INFO Epoch 077 | 75% complete (batch 136/181)
2025-12-25 15:02:07 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.564583
2025-12-25 15:02:13 INFO Tuning ranking metrics: regret=0.107554 spearman=0.195360 (groups=39, skipped=329)
2025-12-25 15:02:13 INFO Epoch 077 | train_mse=0.078461 | val_loss=0.085473 | best_val_loss=0.298718
2025-12-25 15:02:21 INFO Epoch 078 | 25% complete (batch 46/181)
2025-12-25 15:02:22 INFO Epoch 078 | 50% complete (batch 91/181)
2025-12-25 15:02:23 INFO Epoch 078 | 75% complete (batch 136/181)
2025-12-25 15:02:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.558336
2025-12-25 15:02:37 INFO Tuning ranking metrics: regret=0.111044 spearman=0.186508 (groups=39, skipped=329)
2025-12-25 15:02:37 INFO Epoch 078 | train_mse=0.066358 | val_loss=0.082079 | best_val_loss=0.298718
2025-12-25 15:02:46 INFO Epoch 079 | 25% complete (batch 46/181)
2025-12-25 15:02:47 INFO Epoch 079 | 50% complete (batch 91/181)
2025-12-25 15:02:48 INFO Epoch 079 | 75% complete (batch 136/181)
2025-12-25 15:02:56 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.560298
2025-12-25 15:03:02 INFO Tuning ranking metrics: regret=0.111044 spearman=0.197558 (groups=39, skipped=329)
2025-12-25 15:03:02 INFO Epoch 079 | train_mse=0.073572 | val_loss=0.081995 | best_val_loss=0.298718
2025-12-25 15:03:11 INFO Epoch 080 | 25% complete (batch 46/181)
2025-12-25 15:03:11 INFO Epoch 080 | 50% complete (batch 91/181)
2025-12-25 15:03:12 INFO Epoch 080 | 75% complete (batch 136/181)
2025-12-25 15:03:21 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.544556
2025-12-25 15:03:26 INFO Tuning ranking metrics: regret=0.106926 spearman=0.269780 (groups=39, skipped=329)
2025-12-25 15:03:26 INFO Epoch 080 | train_mse=0.070599 | val_loss=0.090006 | best_val_loss=0.298718
2025-12-25 15:03:35 INFO Epoch 081 | 25% complete (batch 46/181)
2025-12-25 15:03:36 INFO Epoch 081 | 50% complete (batch 91/181)
2025-12-25 15:03:37 INFO Epoch 081 | 75% complete (batch 136/181)
2025-12-25 15:03:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.551257
2025-12-25 15:03:51 INFO Tuning ranking metrics: regret=0.111044 spearman=0.201343 (groups=39, skipped=329)
2025-12-25 15:03:51 INFO Epoch 081 | train_mse=0.063267 | val_loss=0.082568 | best_val_loss=0.298718
2025-12-25 15:04:00 INFO Epoch 082 | 25% complete (batch 46/181)
2025-12-25 15:04:00 INFO Epoch 082 | 50% complete (batch 91/181)
2025-12-25 15:04:01 INFO Epoch 082 | 75% complete (batch 136/181)
2025-12-25 15:04:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.554337
2025-12-25 15:04:15 INFO Tuning ranking metrics: regret=0.111099 spearman=0.208486 (groups=39, skipped=329)
2025-12-25 15:04:15 INFO Epoch 082 | train_mse=0.077240 | val_loss=0.085105 | best_val_loss=0.298718
2025-12-25 15:04:24 INFO Epoch 083 | 25% complete (batch 46/181)
2025-12-25 15:04:24 INFO Epoch 083 | 50% complete (batch 91/181)
2025-12-25 15:04:25 INFO Epoch 083 | 75% complete (batch 136/181)
2025-12-25 15:04:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.542622
2025-12-25 15:04:39 INFO Tuning ranking metrics: regret=0.108782 spearman=0.218132 (groups=39, skipped=329)
2025-12-25 15:04:39 INFO Epoch 083 | train_mse=0.066932 | val_loss=0.085670 | best_val_loss=0.298718
2025-12-25 15:04:48 INFO Epoch 084 | 25% complete (batch 46/181)
2025-12-25 15:04:49 INFO Epoch 084 | 50% complete (batch 91/181)
2025-12-25 15:04:50 INFO Epoch 084 | 75% complete (batch 136/181)
2025-12-25 15:04:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.542603
2025-12-25 15:05:04 INFO Tuning ranking metrics: regret=0.108727 spearman=0.223871 (groups=39, skipped=329)
2025-12-25 15:05:04 INFO Epoch 084 | train_mse=0.062414 | val_loss=0.087416 | best_val_loss=0.298718
2025-12-25 15:05:12 INFO Epoch 085 | 25% complete (batch 46/181)
2025-12-25 15:05:14 INFO Epoch 085 | 50% complete (batch 91/181)
2025-12-25 15:05:14 INFO Epoch 085 | 75% complete (batch 136/181)
2025-12-25 15:05:23 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.546137
2025-12-25 15:05:29 INFO Tuning ranking metrics: regret=0.108727 spearman=0.223077 (groups=39, skipped=329)
2025-12-25 15:05:29 INFO Epoch 085 | train_mse=0.076833 | val_loss=0.085323 | best_val_loss=0.298718
2025-12-25 15:05:37 INFO Epoch 086 | 25% complete (batch 46/181)
2025-12-25 15:05:38 INFO Epoch 086 | 50% complete (batch 91/181)
2025-12-25 15:05:39 INFO Epoch 086 | 75% complete (batch 136/181)
2025-12-25 15:05:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.544210
2025-12-25 15:05:53 INFO Tuning ranking metrics: regret=0.110324 spearman=0.218071 (groups=39, skipped=329)
2025-12-25 15:05:53 INFO Epoch 086 | train_mse=0.065502 | val_loss=0.088425 | best_val_loss=0.298718
2025-12-25 15:06:01 INFO Epoch 087 | 25% complete (batch 46/181)
2025-12-25 15:06:02 INFO Epoch 087 | 50% complete (batch 91/181)
2025-12-25 15:06:03 INFO Epoch 087 | 75% complete (batch 136/181)
2025-12-25 15:06:12 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.558521
2025-12-25 15:06:17 INFO Tuning ranking metrics: regret=0.110509 spearman=0.220513 (groups=39, skipped=329)
2025-12-25 15:06:17 INFO Epoch 087 | train_mse=0.065810 | val_loss=0.083821 | best_val_loss=0.298718
2025-12-25 15:06:26 INFO Epoch 088 | 25% complete (batch 46/181)
2025-12-25 15:06:27 INFO Epoch 088 | 50% complete (batch 91/181)
2025-12-25 15:06:27 INFO Epoch 088 | 75% complete (batch 136/181)
2025-12-25 15:06:36 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.564608
2025-12-25 15:06:41 INFO Tuning ranking metrics: regret=0.117324 spearman=0.168498 (groups=39, skipped=329)
2025-12-25 15:06:41 INFO Epoch 088 | train_mse=0.054894 | val_loss=0.082949 | best_val_loss=0.298718
2025-12-25 15:06:50 INFO Epoch 089 | 25% complete (batch 46/181)
2025-12-25 15:06:51 INFO Epoch 089 | 50% complete (batch 91/181)
2025-12-25 15:06:52 INFO Epoch 089 | 75% complete (batch 136/181)
2025-12-25 15:07:01 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.565914
2025-12-25 15:07:06 INFO Tuning ranking metrics: regret=0.137188 spearman=0.137057 (groups=39, skipped=329)
2025-12-25 15:07:06 INFO Epoch 089 | train_mse=0.065180 | val_loss=0.078256 | best_val_loss=0.298718
2025-12-25 15:07:14 INFO Epoch 090 | 25% complete (batch 46/181)
2025-12-25 15:07:15 INFO Epoch 090 | 50% complete (batch 91/181)
2025-12-25 15:07:16 INFO Epoch 090 | 75% complete (batch 136/181)
2025-12-25 15:07:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.563002
2025-12-25 15:07:30 INFO Tuning ranking metrics: regret=0.133657 spearman=0.116972 (groups=39, skipped=329)
2025-12-25 15:07:30 INFO Epoch 090 | train_mse=0.060559 | val_loss=0.084035 | best_val_loss=0.298718
2025-12-25 15:07:39 INFO Epoch 091 | 25% complete (batch 46/181)
2025-12-25 15:07:40 INFO Epoch 091 | 50% complete (batch 91/181)
2025-12-25 15:07:41 INFO Epoch 091 | 75% complete (batch 136/181)
2025-12-25 15:07:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.529039
2025-12-25 15:07:55 INFO Tuning ranking metrics: regret=0.107297 spearman=0.227350 (groups=39, skipped=329)
2025-12-25 15:07:55 INFO Epoch 091 | train_mse=0.079992 | val_loss=0.099319 | best_val_loss=0.298718
2025-12-25 15:08:03 INFO Epoch 092 | 25% complete (batch 46/181)
2025-12-25 15:08:04 INFO Epoch 092 | 50% complete (batch 91/181)
2025-12-25 15:08:05 INFO Epoch 092 | 75% complete (batch 136/181)
2025-12-25 15:08:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.572275
2025-12-25 15:08:19 INFO Tuning ranking metrics: regret=0.115727 spearman=0.156471 (groups=39, skipped=329)
2025-12-25 15:08:19 INFO Epoch 092 | train_mse=0.063063 | val_loss=0.081335 | best_val_loss=0.298718
2025-12-25 15:08:28 INFO Epoch 093 | 25% complete (batch 46/181)
2025-12-25 15:08:29 INFO Epoch 093 | 50% complete (batch 91/181)
2025-12-25 15:08:30 INFO Epoch 093 | 75% complete (batch 136/181)
2025-12-25 15:08:39 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.601017
2025-12-25 15:08:44 INFO Tuning ranking metrics: regret=0.115881 spearman=0.115018 (groups=39, skipped=329)
2025-12-25 15:08:44 INFO Epoch 093 | train_mse=0.064299 | val_loss=0.071440 | best_val_loss=0.298718
2025-12-25 15:08:53 INFO Epoch 094 | 25% complete (batch 46/181)
2025-12-25 15:08:54 INFO Epoch 094 | 50% complete (batch 91/181)
2025-12-25 15:08:55 INFO Epoch 094 | 75% complete (batch 136/181)
2025-12-25 15:09:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.599955
2025-12-25 15:09:09 INFO Tuning ranking metrics: regret=0.114297 spearman=0.153236 (groups=39, skipped=329)
2025-12-25 15:09:09 INFO Epoch 094 | train_mse=0.066196 | val_loss=0.083183 | best_val_loss=0.298718
2025-12-25 15:09:17 INFO Epoch 095 | 25% complete (batch 46/181)
2025-12-25 15:09:18 INFO Epoch 095 | 50% complete (batch 91/181)
2025-12-25 15:09:19 INFO Epoch 095 | 75% complete (batch 136/181)
2025-12-25 15:09:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.593795
2025-12-25 15:09:33 INFO Tuning ranking metrics: regret=0.115727 spearman=0.144078 (groups=39, skipped=329)
2025-12-25 15:09:33 INFO Epoch 095 | train_mse=0.065682 | val_loss=0.075845 | best_val_loss=0.298718
2025-12-25 15:09:42 INFO Epoch 096 | 25% complete (batch 46/181)
2025-12-25 15:09:43 INFO Epoch 096 | 50% complete (batch 91/181)
2025-12-25 15:09:44 INFO Epoch 096 | 75% complete (batch 136/181)
2025-12-25 15:09:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.599843
2025-12-25 15:09:58 INFO Tuning ranking metrics: regret=0.115727 spearman=0.133944 (groups=39, skipped=329)
2025-12-25 15:09:58 INFO Epoch 096 | train_mse=0.068256 | val_loss=0.079505 | best_val_loss=0.298718
2025-12-25 15:10:06 INFO Epoch 097 | 25% complete (batch 46/181)
2025-12-25 15:10:07 INFO Epoch 097 | 50% complete (batch 91/181)
2025-12-25 15:10:08 INFO Epoch 097 | 75% complete (batch 136/181)
2025-12-25 15:10:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.605311
2025-12-25 15:10:22 INFO Tuning ranking metrics: regret=0.108738 spearman=0.189683 (groups=39, skipped=329)
2025-12-25 15:10:22 INFO Epoch 097 | train_mse=0.061924 | val_loss=0.078162 | best_val_loss=0.298718
2025-12-25 15:10:31 INFO Epoch 098 | 25% complete (batch 46/181)
2025-12-25 15:10:32 INFO Epoch 098 | 50% complete (batch 91/181)
2025-12-25 15:10:32 INFO Epoch 098 | 75% complete (batch 136/181)
2025-12-25 15:10:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.592743
2025-12-25 15:10:47 INFO Tuning ranking metrics: regret=0.116139 spearman=0.103236 (groups=39, skipped=329)
2025-12-25 15:10:47 INFO Epoch 098 | train_mse=0.066961 | val_loss=0.080049 | best_val_loss=0.298718
2025-12-25 15:10:55 INFO Epoch 099 | 25% complete (batch 46/181)
2025-12-25 15:10:56 INFO Epoch 099 | 50% complete (batch 91/181)
2025-12-25 15:10:57 INFO Epoch 099 | 75% complete (batch 136/181)
2025-12-25 15:11:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.600147
2025-12-25 15:11:11 INFO Tuning ranking metrics: regret=0.115881 spearman=0.101038 (groups=39, skipped=329)
2025-12-25 15:11:11 INFO Epoch 099 | train_mse=0.087311 | val_loss=0.074993 | best_val_loss=0.298718
2025-12-25 15:11:20 INFO Epoch 100 | 25% complete (batch 46/181)
2025-12-25 15:11:21 INFO Epoch 100 | 50% complete (batch 91/181)
2025-12-25 15:11:22 INFO Epoch 100 | 75% complete (batch 136/181)
2025-12-25 15:11:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.603902
2025-12-25 15:11:36 INFO Tuning ranking metrics: regret=0.108727 spearman=0.180342 (groups=39, skipped=329)
2025-12-25 15:11:36 INFO Epoch 100 | train_mse=0.069792 | val_loss=0.073133 | best_val_loss=0.298718
2025-12-25 15:11:45 INFO Epoch 101 | 25% complete (batch 46/181)
2025-12-25 15:11:46 INFO Epoch 101 | 50% complete (batch 91/181)
2025-12-25 15:11:47 INFO Epoch 101 | 75% complete (batch 136/181)
2025-12-25 15:11:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.591077
2025-12-25 15:12:01 INFO Tuning ranking metrics: regret=0.110597 spearman=0.207570 (groups=39, skipped=329)
2025-12-25 15:12:01 INFO Epoch 101 | train_mse=0.059307 | val_loss=0.083879 | best_val_loss=0.298718
2025-12-25 15:12:10 INFO Epoch 102 | 25% complete (batch 46/181)
2025-12-25 15:12:11 INFO Epoch 102 | 50% complete (batch 91/181)
2025-12-25 15:12:11 INFO Epoch 102 | 75% complete (batch 136/181)
2025-12-25 15:12:20 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.584467
2025-12-25 15:12:25 INFO Tuning ranking metrics: regret=0.114200 spearman=0.213126 (groups=39, skipped=329)
2025-12-25 15:12:25 INFO Epoch 102 | train_mse=0.062128 | val_loss=0.075817 | best_val_loss=0.298718
2025-12-25 15:12:34 INFO Epoch 103 | 25% complete (batch 46/181)
2025-12-25 15:12:35 INFO Epoch 103 | 50% complete (batch 91/181)
2025-12-25 15:12:36 INFO Epoch 103 | 75% complete (batch 136/181)
2025-12-25 15:12:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.592473
2025-12-25 15:12:50 INFO Tuning ranking metrics: regret=0.121647 spearman=0.135714 (groups=39, skipped=329)
2025-12-25 15:12:50 INFO Epoch 103 | train_mse=0.053500 | val_loss=0.076262 | best_val_loss=0.298718
2025-12-25 15:12:59 INFO Epoch 104 | 25% complete (batch 46/181)
2025-12-25 15:13:00 INFO Epoch 104 | 50% complete (batch 91/181)
2025-12-25 15:13:01 INFO Epoch 104 | 75% complete (batch 136/181)
2025-12-25 15:13:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.596133
2025-12-25 15:13:15 INFO Tuning ranking metrics: regret=0.108727 spearman=0.181074 (groups=39, skipped=329)
2025-12-25 15:13:15 INFO Epoch 104 | train_mse=0.063866 | val_loss=0.072904 | best_val_loss=0.298718
2025-12-25 15:13:24 INFO Epoch 105 | 25% complete (batch 46/181)
2025-12-25 15:13:25 INFO Epoch 105 | 50% complete (batch 91/181)
2025-12-25 15:13:26 INFO Epoch 105 | 75% complete (batch 136/181)
2025-12-25 15:13:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.583222
2025-12-25 15:13:40 INFO Tuning ranking metrics: regret=0.107641 spearman=0.183028 (groups=39, skipped=329)
2025-12-25 15:13:40 INFO Epoch 105 | train_mse=0.068413 | val_loss=0.084590 | best_val_loss=0.298718
2025-12-25 15:13:48 INFO Epoch 106 | 25% complete (batch 46/181)
2025-12-25 15:13:49 INFO Epoch 106 | 50% complete (batch 91/181)
2025-12-25 15:13:50 INFO Epoch 106 | 75% complete (batch 136/181)
2025-12-25 15:13:59 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.576926
2025-12-25 15:14:04 INFO Tuning ranking metrics: regret=0.109809 spearman=0.170391 (groups=39, skipped=329)
2025-12-25 15:14:04 INFO Epoch 106 | train_mse=0.058784 | val_loss=0.088807 | best_val_loss=0.298718
2025-12-25 15:14:13 INFO Epoch 107 | 25% complete (batch 46/181)
2025-12-25 15:14:14 INFO Epoch 107 | 50% complete (batch 91/181)
2025-12-25 15:14:15 INFO Epoch 107 | 75% complete (batch 136/181)
2025-12-25 15:14:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.606995
2025-12-25 15:14:29 INFO Tuning ranking metrics: regret=0.108738 spearman=0.186142 (groups=39, skipped=329)
2025-12-25 15:14:29 INFO Epoch 107 | train_mse=0.059118 | val_loss=0.076780 | best_val_loss=0.298718
2025-12-25 15:14:38 INFO Epoch 108 | 25% complete (batch 46/181)
2025-12-25 15:14:39 INFO Epoch 108 | 50% complete (batch 91/181)
2025-12-25 15:14:40 INFO Epoch 108 | 75% complete (batch 136/181)
2025-12-25 15:14:48 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.603195
2025-12-25 15:14:54 INFO Tuning ranking metrics: regret=0.108725 spearman=0.180891 (groups=39, skipped=329)
2025-12-25 15:14:54 INFO Epoch 108 | train_mse=0.056755 | val_loss=0.076774 | best_val_loss=0.298718
Monitored metric tuning_rank_spearman did not improve in the last 40 records. Best score: 0.299. Signaling Trainer to stop.
2025-12-25 15:14:55 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.25061_val-0.08174_epoch069.chkpt, checkpoint.tuning_rank_spearman-0.26978_val-0.09001_epoch080.chkpt, checkpoint.tuning_rank_spearman-0.29872_val-0.11619_epoch068.chkpt
2025-12-25 15:14:55 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed555/model_checkpoints/checkpoint.tuning_rank_spearman-0.29872_val-0.11619_epoch068.chkpt
2025-12-25 15:14:55 INFO Best validation loss: tensor(0.2987)
2025-12-25 15:14:55 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed555/model_checkpoints/checkpoint.tuning_rank_spearman-0.29872_val-0.11619_epoch068.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed555/model_checkpoints/checkpoint.tuning_rank_spearman-0.29872_val-0.11619_epoch068.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-25 15:15:02 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.116195
2025-12-25 15:15:08 INFO Tuning ranking metrics: regret=0.099073 spearman=0.298718 (groups=39, skipped=329)
2025-12-25 15:15:08 INFO Epoch 109 | val_loss=0.116195 | best_val_loss=0.298718
2025-12-25 15:15:08 INFO Validation metrics: [{'val_loss': 0.1161946952342987, 'tuning_rank_regret': 0.09907342493534088, 'tuning_rank_spearman': 0.2987179458141327, 'val_pearson_corr': 0.5770618319511414, 'val_spearman_corr': 0.6110379695892334, 'val_rank_regret': 0.03609996661543846, 'val_rank_spearman': 0.3333333432674408}]
2025-12-25 15:15:08 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.29872_val-0.11619_epoch068.chkpt
2025-12-25 15:15:08 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.25061_val-0.08174_epoch069.chkpt
2025-12-25 15:15:08 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.26978_val-0.09001_epoch080.chkpt
2025-12-25 15:15:08 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.09324_epoch066.ckpt
2025-12-25 15:15:08 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret       0.09907342493534088
  tuning_rank_spearman      0.2987179458141327
        val_loss            0.1161946952342987
    val_pearson_corr        0.5770618319511414
     val_rank_regret        0.03609996661543846
    val_rank_spearman       0.3333333432674408
    val_spearman_corr       0.6110379695892334
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run polish_seed101_2025-12-25_09-39-57_phase2_seed555 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed555
[run_full_pipeline] Phase 2 (seed 555) best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed555/model_checkpoints/checkpoint.tuning_rank_spearman-0.29872_val-0.11619_epoch068.chkpt (tuning_rank_spearman=0.2987179458141327)
[run_full_pipeline] Phase 2 fine-tuning (seed 888) -> polish_seed101_2025-12-25_09-39-57_phase2_seed888
[train_cli] run_id=polish_seed101_2025-12-25_09-39-57_phase2_seed888 | command=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/bin/python /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/model_train_topoqa_cpu.py --config /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed888/config/config.yaml --run-dir /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed888 --git-commit 9b1bb2b320 --git-dirty --resume-from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.06720_val-0.08628_epoch067.chkpt
2025-12-25 15:15:15 INFO git_commit = 9b1bb2b320 (dirty)
2025-12-25 15:15:15 INFO Training package root: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2
2025-12-25 15:15:15 INFO Configuration loaded from /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed888/config/config.yaml
2025-12-25 15:15:15 INFO   graph_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data
2025-12-25 15:15:15 INFO   train_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.train.csv
2025-12-25 15:15:15 INFO   val_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/data.validate.csv
2025-12-25 15:15:15 INFO   save_dir = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed888
2025-12-25 15:15:15 INFO   tuning_label_file = /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/stats_split_helper.tuning.csv
2025-12-25 15:15:15 INFO   metadata_path = None
2025-12-25 15:15:15 INFO   summary_path = None
2025-12-25 15:15:15 INFO   accelerator = cpu
2025-12-25 15:15:15 INFO   devices = 1
2025-12-25 15:15:15 INFO   attention_head = 8
2025-12-25 15:15:15 INFO   pooling_type = mean
2025-12-25 15:15:15 INFO   model_self_loops = False
2025-12-25 15:15:15 INFO   model_self_loop_fill = mean
2025-12-25 15:15:15 INFO   model_residual = False
2025-12-25 15:15:15 INFO   batch_size = 48
2025-12-25 15:15:15 INFO   learning_rate = 0.001
2025-12-25 15:15:15 INFO   num_epochs = 320
2025-12-25 15:15:15 INFO   accumulate_grad_batches = 8
2025-12-25 15:15:15 INFO   seed = 888
2025-12-25 15:15:15 INFO   num_workers = 2
2025-12-25 15:15:15 INFO   precision = 32
2025-12-25 15:15:15 INFO   lr_scheduler_type = reduce_on_plateau
2025-12-25 15:15:15 INFO   early_stopping_patience = 20
2025-12-25 15:15:15 INFO   lr_scheduler_patience = 4
2025-12-25 15:15:15 INFO   lr_scheduler_factor = 0.2
2025-12-25 15:15:15 INFO   fast_dev_run = False
2025-12-25 15:15:15 INFO   limit_train_batches = None
2025-12-25 15:15:15 INFO   limit_val_batches = None
2025-12-25 15:15:15 INFO   log_lr = False
2025-12-25 15:15:15 INFO   progress_bar_refresh_rate = 0
2025-12-25 15:15:15 INFO   log_every_n_steps = 100
2025-12-25 15:15:15 INFO   use_val_spearman_as_secondary = True
2025-12-25 15:15:15 INFO   spearman_secondary_min_delta = 0.0
2025-12-25 15:15:15 INFO   spearman_secondary_weight = 1.0
2025-12-25 15:15:15 INFO   selection_primary_metric = tuning_rank_spearman
2025-12-25 15:15:15 INFO   tuning_max_samples = 500
2025-12-25 15:15:15 INFO   tuning_fraction = None
2025-12-25 15:15:15 INFO   tuning_eval_every = 1
2025-12-25 15:15:15 INFO   rank_loss_weight = 0.0
2025-12-25 15:15:15 INFO   rank_loss_margin = 0.0
2025-12-25 15:15:15 INFO   rank_loss_mode = hinge
2025-12-25 15:15:15 INFO   rank_loss_grouped = True
2025-12-25 15:15:15 INFO   variance_reduction_enabled = False
2025-12-25 15:15:15 INFO   variance_reduction_method = topk_avg
2025-12-25 15:15:15 INFO   variance_reduction_top_k = 3
2025-12-25 15:15:15 INFO   coverage_minimum = 0.0
2025-12-25 15:15:15 INFO   coverage_fail_on_missing = False
2025-12-25 15:15:15 INFO   graph_load_profiling = False
2025-12-25 15:15:15 INFO   graph_load_top_k = 5
2025-12-25 15:15:15 INFO   enable_graph_cache = True
2025-12-25 15:15:15 INFO   graph_cache_size = 256
2025-12-25 15:15:15 INFO   canonicalize_on_load = False
2025-12-25 15:15:15 INFO   mlflow = MlflowConfig(enabled=True, tracking_uri='./ml_runs2', experiment='dynamic_topoqa', run_name=None, log_artifacts=True, tags={})
2025-12-25 15:15:15 INFO   edge_schema = {}
2025-12-25 15:15:15 INFO   topology_schema = {}
Seed set to 888
2025-12-25 15:15:15 INFO [train] label rows: 8723 | usable graphs: 8686 | coverage: 99.58%
2025-12-25 15:15:15 ERROR [train] 37 label entries missing matching .pt graphs (first examples: 1A9X, 1FLE, 1HT9, 1OAO, 1R0R). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 15:15:15 INFO [val] label rows: 3397 | usable graphs: 3376 | coverage: 99.38%
2025-12-25 15:15:15 ERROR [val] 21 label entries missing matching .pt graphs (first examples: 1H59, 2B5L, 2C7M, 2GZH, 2W19). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 15:15:15 INFO [tuning] label rows: 873 | usable graphs: 871 | coverage: 99.77%
2025-12-25 15:15:15 ERROR [tuning] 2 label entries missing matching .pt graphs (first examples: 6K7C, 4MLG). Regenerate graph tensors or adjust coverage settings to proceed safely.
2025-12-25 15:15:16 INFO Graph cache enabled (max_items=256). Disable via selection cache.enable_graph_cache=false in config.
2025-12-25 15:15:16 INFO Tuning group stats: groups=351 groups>=2=40 singletons=311 max_group=10
2025-12-25 15:15:16 INFO Dataset coverage report written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed888/dataset_coverage.json
2025-12-25 15:15:16 ERROR [coverage] train split: 37/8723 labels missing graph tensors (coverage 99.58%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed888/dataset_coverage.json for details.
2025-12-25 15:15:16 ERROR [coverage] val split: 21/3397 labels missing graph tensors (coverage 99.38%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed888/dataset_coverage.json for details.
2025-12-25 15:15:16 ERROR [coverage] tuning split: 2/873 labels missing graph tensors (coverage 57.27%). See /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed888/dataset_coverage.json for details.
2025-12-25 15:15:16 INFO Schema summary written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed888/schema_summary.json
2025-12-25 15:15:16 INFO Feature metadata written to /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed888/feature_metadata.json
2025-12-25 15:15:16 INFO Graph builder: graph_builder2 (version 2.0.0)
2025-12-25 15:15:16 INFO Feature config snapshot: path=/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/feature_configs/null_topology/feature-config.yaml.null.10A, sha256=f618659ace5620de7e794485915dadd4243f3ec2ca6726b4a9af3989817a8579
2025-12-25 15:15:16 INFO Edge dumps: enabled (output: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/work/edge_features)
2025-12-25 15:15:16 INFO Feature metadata source: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json
2025-12-25 15:15:16 INFO Graph builder summary: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed888/schema_summary.json
2025-12-25 15:15:16 INFO Interface: interface/polar_cutoff/v1 (cutoff 10 Å), yielding 10 interface residues.
2025-12-25 15:15:16 INFO Topology: topology/persistence_null/v1 supporting the 172-dimensional node features.
2025-12-25 15:15:16 INFO Node: node/dssp_topo_merge/v1; metadata lists 172 feature columns matching the .pt tensor.
2025-12-25 15:15:16 INFO Edge: edge/legacy_band/v11 (variant legacy_v11); .pt confirms 40 directed edges with 11 feature values each.
2025-12-25 15:15:16 INFO → Total feature dimensionality observed and confirmed: node_dim = 172, edge_dim = 11.
2025-12-25 15:15:16 INFO Secondary selection metric enabled: val_spearman_corr (weight=1.000, min_delta=0.000)
2025-12-25 15:15:16 INFO Resolved feature metadata: {
  "edge_schema": {
    "dim": 11,
    "module": "edge/legacy_band/v11",
    "variant": "legacy_v11",
    "module_params": {
      "distance_max": 10.0,
      "distance_min": 0.0,
      "jobs": 16,
      "scale_features": true
    },
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
    "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
    "jobs": 16,
    "summary": "11-D legacy edge features (distance + atom distance histogram)."
  },
  "node_schema": {
    "dim": 172,
    "source": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
    "module": "node/dssp_topo_merge/v1",
    "module_params": {
      "drop_na": true,
      "jobs": 16
    },
    "column_count": 172,
    "columns_preview": [
      "rasa",
      "phi",
      "psi",
      "SS8_0",
      "SS8_1"
    ]
  },
  "metadata_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/graph_builder2/output/null_topology_10A_ARM/graph_data/graph_metadata.json",
  "summary_path": "/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed888/schema_summary.json",
  "module_registry": {
    "edge": {
      "id": "edge/legacy_band/v11",
      "alias": "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA",
      "jobs": 16,
      "summary": "11-D legacy edge features (distance + atom distance histogram)."
    },
    "interface": {
      "id": "interface/polar_cutoff/v1",
      "alias": "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA",
      "jobs": 16,
      "summary": "Polar interface detection using distance cutoff. ID + coords for downstream stages"
    },
    "node": {
      "id": "node/dssp_topo_merge/v1",
      "alias": "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA",
      "jobs": 16,
      "summary": "DSSP-derived node features merged with topology statistics."
    },
    "topology": {
      "id": "topology/persistence_null/v1",
      "alias": "Null topology (constant zeros) = 140D ablation",
      "jobs": 16,
      "summary": "Topology ablation: constant features with PH-compatible schema."
    }
  },
  "notes": []
}
2025-12-25 15:15:16 INFO Detected macOS with num_workers=2. If you observe instability, revert to 0 in config.yaml.
2025-12-25 15:15:16 INFO Resuming from checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.06720_val-0.08628_epoch067.chkpt (epoch=67)
2025-12-25 15:15:16 INFO MLflow logging enabled (experiment=dynamic_topoqa, run_id=f0336300c6b24b70ac59aff68018dee1)
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
2025-12-25 15:15:16 INFO Starting training (fast_dev_run=False)
2025-12-25 15:15:16 INFO Detected GPU/MPS hardware. Current run uses accelerator='cpu' (configurable via config.yaml -> accelerator).
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:701: Checkpoint directory /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed888/model_checkpoints exists and is not empty.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.06720_val-0.08628_epoch067.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase1/model_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed888/model_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:395: The dirpath has changed from '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase1/model_checkpoints/val_loss_checkpoints' to '/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed888/model_checkpoints/val_loss_checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.

   | Name         | Type             | Params | Mode 
-----------------------------------------------------------
0  | criterion    | MeanSquaredError | 0      | train
1  | relu         | ReLU             | 0      | train
2  | sigmoid      | Sigmoid          | 0      | train
3  | edge_embed   | ModuleList       | 1.5 K  | train
4  | embed        | ModuleList       | 5.5 K  | train
5  | conv1        | ModuleList       | 50.2 K | train
6  | conv2        | ModuleList       | 50.2 K | train
7  | conv3        | ModuleList       | 50.2 K | train
8  | fc_edge      | Linear           | 528    | train
9  | protein_fc_1 | ModuleList       | 3.1 K  | train
10 | fc1          | Linear           | 4.2 K  | train
11 | out          | Linear           | 65     | train
-----------------------------------------------------------
165 K     Trainable params
0         Non-trainable params
165 K     Total params
0.662     Total estimated model params size (MB)
37        Modules in train mode
0         Modules in eval mode
Restored all states from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase1/model_checkpoints/checkpoint.tuning_rank_spearman-0.06720_val-0.08628_epoch067.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
USING ADAM
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
2025-12-25 15:15:31 INFO Epoch 068 | 25% complete (batch 46/181)
2025-12-25 15:15:32 INFO Epoch 068 | 50% complete (batch 91/181)
2025-12-25 15:15:33 INFO Epoch 068 | 75% complete (batch 136/181)
2025-12-25 15:15:42 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.084843
2025-12-25 15:15:47 INFO Tuning ranking metrics: regret=0.069681 spearman=0.013003 (groups=40, skipped=311)
2025-12-25 15:15:47 INFO Epoch 068 | val_loss=0.084843
2025-12-25 15:15:56 INFO Epoch 069 | 25% complete (batch 46/181)
2025-12-25 15:15:56 INFO Epoch 069 | 50% complete (batch 91/181)
2025-12-25 15:15:57 INFO Epoch 069 | 75% complete (batch 136/181)
2025-12-25 15:16:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.547540
2025-12-25 15:16:11 INFO Tuning ranking metrics: regret=0.055925 spearman=0.090828 (groups=40, skipped=311)
2025-12-25 15:16:11 INFO Epoch 069 | train_mse=0.082628 | val_loss=0.075554 | best_val_loss=0.013003
2025-12-25 15:16:20 INFO Epoch 070 | 25% complete (batch 46/181)
2025-12-25 15:16:21 INFO Epoch 070 | 50% complete (batch 91/181)
2025-12-25 15:16:22 INFO Epoch 070 | 75% complete (batch 136/181)
2025-12-25 15:16:31 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.561913
2025-12-25 15:16:36 INFO Tuning ranking metrics: regret=0.075151 spearman=0.046304 (groups=40, skipped=311)
2025-12-25 15:16:36 INFO Epoch 070 | train_mse=0.065067 | val_loss=0.090004 | best_val_loss=0.090828
2025-12-25 15:16:45 INFO Epoch 071 | 25% complete (batch 46/181)
2025-12-25 15:16:46 INFO Epoch 071 | 50% complete (batch 91/181)
2025-12-25 15:16:47 INFO Epoch 071 | 75% complete (batch 136/181)
2025-12-25 15:16:55 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.541227
2025-12-25 15:17:01 INFO Tuning ranking metrics: regret=0.089089 spearman=0.055996 (groups=40, skipped=311)
2025-12-25 15:17:01 INFO Epoch 071 | train_mse=0.075800 | val_loss=0.095465 | best_val_loss=0.090828
2025-12-25 15:17:09 INFO Epoch 072 | 25% complete (batch 46/181)
2025-12-25 15:17:10 INFO Epoch 072 | 50% complete (batch 91/181)
2025-12-25 15:17:11 INFO Epoch 072 | 75% complete (batch 136/181)
2025-12-25 15:17:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.553708
2025-12-25 15:17:25 INFO Tuning ranking metrics: regret=0.069929 spearman=0.166677 (groups=40, skipped=311)
2025-12-25 15:17:25 INFO Epoch 072 | train_mse=0.075383 | val_loss=0.087846 | best_val_loss=0.090828
2025-12-25 15:17:33 INFO Epoch 073 | 25% complete (batch 46/181)
2025-12-25 15:17:34 INFO Epoch 073 | 50% complete (batch 91/181)
2025-12-25 15:17:35 INFO Epoch 073 | 75% complete (batch 136/181)
2025-12-25 15:17:45 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.547685
2025-12-25 15:17:50 INFO Tuning ranking metrics: regret=0.119441 spearman=0.065233 (groups=40, skipped=311)
2025-12-25 15:17:50 INFO Epoch 073 | train_mse=0.091411 | val_loss=0.079667 | best_val_loss=0.166677
2025-12-25 15:17:59 INFO Epoch 074 | 25% complete (batch 46/181)
2025-12-25 15:18:00 INFO Epoch 074 | 50% complete (batch 91/181)
2025-12-25 15:18:01 INFO Epoch 074 | 75% complete (batch 136/181)
2025-12-25 15:18:09 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.546263
2025-12-25 15:18:15 INFO Tuning ranking metrics: regret=0.125268 spearman=0.060032 (groups=40, skipped=311)
2025-12-25 15:18:15 INFO Epoch 074 | train_mse=0.076165 | val_loss=0.085616 | best_val_loss=0.166677
2025-12-25 15:18:23 INFO Epoch 075 | 25% complete (batch 46/181)
2025-12-25 15:18:24 INFO Epoch 075 | 50% complete (batch 91/181)
2025-12-25 15:18:25 INFO Epoch 075 | 75% complete (batch 136/181)
2025-12-25 15:18:34 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.550987
2025-12-25 15:18:39 INFO Tuning ranking metrics: regret=0.101208 spearman=0.014665 (groups=40, skipped=311)
2025-12-25 15:18:39 INFO Epoch 075 | train_mse=0.083104 | val_loss=0.077036 | best_val_loss=0.166677
2025-12-25 15:18:48 INFO Epoch 076 | 25% complete (batch 46/181)
2025-12-25 15:18:48 INFO Epoch 076 | 50% complete (batch 91/181)
2025-12-25 15:18:49 INFO Epoch 076 | 75% complete (batch 136/181)
2025-12-25 15:18:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.527411
2025-12-25 15:19:03 INFO Tuning ranking metrics: regret=0.107754 spearman=-0.013079 (groups=40, skipped=311)
2025-12-25 15:19:03 INFO Epoch 076 | train_mse=0.080072 | val_loss=0.093067 | best_val_loss=0.166677
2025-12-25 15:19:12 INFO Epoch 077 | 25% complete (batch 46/181)
2025-12-25 15:19:12 INFO Epoch 077 | 50% complete (batch 91/181)
2025-12-25 15:19:13 INFO Epoch 077 | 75% complete (batch 136/181)
2025-12-25 15:19:22 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.561928
2025-12-25 15:19:27 INFO Tuning ranking metrics: regret=0.112167 spearman=0.067679 (groups=40, skipped=311)
2025-12-25 15:19:27 INFO Epoch 077 | train_mse=0.079111 | val_loss=0.078855 | best_val_loss=0.166677
2025-12-25 15:19:36 INFO Epoch 078 | 25% complete (batch 46/181)
2025-12-25 15:19:37 INFO Epoch 078 | 50% complete (batch 91/181)
2025-12-25 15:19:38 INFO Epoch 078 | 75% complete (batch 136/181)
2025-12-25 15:19:46 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.540229
2025-12-25 15:19:51 INFO Tuning ranking metrics: regret=0.110125 spearman=0.118079 (groups=40, skipped=311)
2025-12-25 15:19:51 INFO Epoch 078 | train_mse=0.075887 | val_loss=0.116014 | best_val_loss=0.166677
2025-12-25 15:20:00 INFO Epoch 079 | 25% complete (batch 46/181)
2025-12-25 15:20:01 INFO Epoch 079 | 50% complete (batch 91/181)
2025-12-25 15:20:02 INFO Epoch 079 | 75% complete (batch 136/181)
2025-12-25 15:20:11 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.541931
2025-12-25 15:20:16 INFO Tuning ranking metrics: regret=0.119195 spearman=0.114859 (groups=40, skipped=311)
2025-12-25 15:20:16 INFO Epoch 079 | train_mse=0.079453 | val_loss=0.098316 | best_val_loss=0.166677
2025-12-25 15:20:25 INFO Epoch 080 | 25% complete (batch 46/181)
2025-12-25 15:20:26 INFO Epoch 080 | 50% complete (batch 91/181)
2025-12-25 15:20:26 INFO Epoch 080 | 75% complete (batch 136/181)
2025-12-25 15:20:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.565588
2025-12-25 15:20:40 INFO Tuning ranking metrics: regret=0.096601 spearman=0.072657 (groups=40, skipped=311)
2025-12-25 15:20:40 INFO Epoch 080 | train_mse=0.084794 | val_loss=0.078850 | best_val_loss=0.166677
2025-12-25 15:20:49 INFO Epoch 081 | 25% complete (batch 46/181)
2025-12-25 15:20:50 INFO Epoch 081 | 50% complete (batch 91/181)
2025-12-25 15:20:51 INFO Epoch 081 | 75% complete (batch 136/181)
2025-12-25 15:21:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.571243
2025-12-25 15:21:05 INFO Tuning ranking metrics: regret=0.077296 spearman=0.098534 (groups=40, skipped=311)
2025-12-25 15:21:05 INFO Epoch 081 | train_mse=0.073633 | val_loss=0.076298 | best_val_loss=0.166677
2025-12-25 15:21:14 INFO Epoch 082 | 25% complete (batch 46/181)
2025-12-25 15:21:15 INFO Epoch 082 | 50% complete (batch 91/181)
2025-12-25 15:21:16 INFO Epoch 082 | 75% complete (batch 136/181)
2025-12-25 15:21:24 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.559704
2025-12-25 15:21:30 INFO Tuning ranking metrics: regret=0.106147 spearman=0.104302 (groups=40, skipped=311)
2025-12-25 15:21:30 INFO Epoch 082 | train_mse=0.090019 | val_loss=0.101368 | best_val_loss=0.166677
2025-12-25 15:21:39 INFO Epoch 083 | 25% complete (batch 46/181)
2025-12-25 15:21:39 INFO Epoch 083 | 50% complete (batch 91/181)
2025-12-25 15:21:40 INFO Epoch 083 | 75% complete (batch 136/181)
2025-12-25 15:21:49 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.549224
2025-12-25 15:21:54 INFO Tuning ranking metrics: regret=0.108931 spearman=0.110395 (groups=40, skipped=311)
2025-12-25 15:21:54 INFO Epoch 083 | train_mse=0.054472 | val_loss=0.082103 | best_val_loss=0.166677
2025-12-25 15:22:03 INFO Epoch 084 | 25% complete (batch 46/181)
2025-12-25 15:22:04 INFO Epoch 084 | 50% complete (batch 91/181)
2025-12-25 15:22:05 INFO Epoch 084 | 75% complete (batch 136/181)
2025-12-25 15:22:14 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.588130
2025-12-25 15:22:19 INFO Tuning ranking metrics: regret=0.103585 spearman=0.113528 (groups=40, skipped=311)
2025-12-25 15:22:19 INFO Epoch 084 | train_mse=0.090569 | val_loss=0.074635 | best_val_loss=0.166677
2025-12-25 15:22:28 INFO Epoch 085 | 25% complete (batch 46/181)
2025-12-25 15:22:29 INFO Epoch 085 | 50% complete (batch 91/181)
2025-12-25 15:22:30 INFO Epoch 085 | 75% complete (batch 136/181)
2025-12-25 15:22:38 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.561739
2025-12-25 15:22:44 INFO Tuning ranking metrics: regret=0.100957 spearman=0.095698 (groups=40, skipped=311)
2025-12-25 15:22:44 INFO Epoch 085 | train_mse=0.063682 | val_loss=0.103760 | best_val_loss=0.166677
2025-12-25 15:22:52 INFO Epoch 086 | 25% complete (batch 46/181)
2025-12-25 15:22:53 INFO Epoch 086 | 50% complete (batch 91/181)
2025-12-25 15:22:54 INFO Epoch 086 | 75% complete (batch 136/181)
2025-12-25 15:23:03 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.531927
2025-12-25 15:23:08 INFO Tuning ranking metrics: regret=0.129400 spearman=0.044551 (groups=40, skipped=311)
2025-12-25 15:23:08 INFO Epoch 086 | train_mse=0.078408 | val_loss=0.075791 | best_val_loss=0.166677
2025-12-25 15:23:17 INFO Epoch 087 | 25% complete (batch 46/181)
2025-12-25 15:23:18 INFO Epoch 087 | 50% complete (batch 91/181)
2025-12-25 15:23:19 INFO Epoch 087 | 75% complete (batch 136/181)
2025-12-25 15:23:28 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.593268
2025-12-25 15:23:33 INFO Tuning ranking metrics: regret=0.130561 spearman=0.059064 (groups=40, skipped=311)
2025-12-25 15:23:33 INFO Epoch 087 | train_mse=0.075847 | val_loss=0.074628 | best_val_loss=0.166677
2025-12-25 15:23:42 INFO Epoch 088 | 25% complete (batch 46/181)
2025-12-25 15:23:43 INFO Epoch 088 | 50% complete (batch 91/181)
2025-12-25 15:23:43 INFO Epoch 088 | 75% complete (batch 136/181)
2025-12-25 15:23:52 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.618410
2025-12-25 15:23:57 INFO Tuning ranking metrics: regret=0.109091 spearman=0.088382 (groups=40, skipped=311)
2025-12-25 15:23:57 INFO Epoch 088 | train_mse=0.069780 | val_loss=0.070663 | best_val_loss=0.166677
2025-12-25 15:24:06 INFO Epoch 089 | 25% complete (batch 46/181)
2025-12-25 15:24:07 INFO Epoch 089 | 50% complete (batch 91/181)
2025-12-25 15:24:08 INFO Epoch 089 | 75% complete (batch 136/181)
2025-12-25 15:24:17 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.603679
2025-12-25 15:24:22 INFO Tuning ranking metrics: regret=0.106334 spearman=0.074416 (groups=40, skipped=311)
2025-12-25 15:24:22 INFO Epoch 089 | train_mse=0.065547 | val_loss=0.074479 | best_val_loss=0.166677
2025-12-25 15:24:31 INFO Epoch 090 | 25% complete (batch 46/181)
2025-12-25 15:24:32 INFO Epoch 090 | 50% complete (batch 91/181)
2025-12-25 15:24:33 INFO Epoch 090 | 75% complete (batch 136/181)
2025-12-25 15:24:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.599440
2025-12-25 15:24:46 INFO Tuning ranking metrics: regret=0.106694 spearman=0.089048 (groups=40, skipped=311)
2025-12-25 15:24:46 INFO Epoch 090 | train_mse=0.068321 | val_loss=0.072782 | best_val_loss=0.166677
2025-12-25 15:24:55 INFO Epoch 091 | 25% complete (batch 46/181)
2025-12-25 15:24:56 INFO Epoch 091 | 50% complete (batch 91/181)
2025-12-25 15:24:57 INFO Epoch 091 | 75% complete (batch 136/181)
2025-12-25 15:25:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.586599
2025-12-25 15:25:11 INFO Tuning ranking metrics: regret=0.096114 spearman=0.117722 (groups=40, skipped=311)
2025-12-25 15:25:11 INFO Epoch 091 | train_mse=0.083415 | val_loss=0.082857 | best_val_loss=0.166677
2025-12-25 15:25:20 INFO Epoch 092 | 25% complete (batch 46/181)
2025-12-25 15:25:20 INFO Epoch 092 | 50% complete (batch 91/181)
2025-12-25 15:25:21 INFO Epoch 092 | 75% complete (batch 136/181)
2025-12-25 15:25:30 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.573388
2025-12-25 15:25:35 INFO Tuning ranking metrics: regret=0.119337 spearman=0.114513 (groups=40, skipped=311)
2025-12-25 15:25:35 INFO Epoch 092 | train_mse=0.089577 | val_loss=0.083593 | best_val_loss=0.166677
2025-12-25 15:25:44 INFO Epoch 093 | 25% complete (batch 46/181)
2025-12-25 15:25:45 INFO Epoch 093 | 50% complete (batch 91/181)
2025-12-25 15:25:46 INFO Epoch 093 | 75% complete (batch 136/181)
2025-12-25 15:25:54 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.587466
2025-12-25 15:26:00 INFO Tuning ranking metrics: regret=0.121882 spearman=0.033588 (groups=40, skipped=311)
2025-12-25 15:26:00 INFO Epoch 093 | train_mse=0.082264 | val_loss=0.074126 | best_val_loss=0.166677
2025-12-25 15:26:08 INFO Epoch 094 | 25% complete (batch 46/181)
2025-12-25 15:26:09 INFO Epoch 094 | 50% complete (batch 91/181)
2025-12-25 15:26:10 INFO Epoch 094 | 75% complete (batch 136/181)
2025-12-25 15:26:19 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.577979
2025-12-25 15:26:25 INFO Tuning ranking metrics: regret=0.087794 spearman=0.076396 (groups=40, skipped=311)
2025-12-25 15:26:25 INFO Epoch 094 | train_mse=0.067977 | val_loss=0.089967 | best_val_loss=0.166677
2025-12-25 15:26:34 INFO Epoch 095 | 25% complete (batch 46/181)
2025-12-25 15:26:34 INFO Epoch 095 | 50% complete (batch 91/181)
2025-12-25 15:26:35 INFO Epoch 095 | 75% complete (batch 136/181)
2025-12-25 15:26:44 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.595907
2025-12-25 15:26:50 INFO Tuning ranking metrics: regret=0.115548 spearman=0.123588 (groups=40, skipped=311)
2025-12-25 15:26:50 INFO Epoch 095 | train_mse=0.064991 | val_loss=0.069776 | best_val_loss=0.166677
2025-12-25 15:26:59 INFO Epoch 096 | 25% complete (batch 46/181)
2025-12-25 15:27:00 INFO Epoch 096 | 50% complete (batch 91/181)
2025-12-25 15:27:01 INFO Epoch 096 | 75% complete (batch 136/181)
2025-12-25 15:27:10 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.608986
2025-12-25 15:27:16 INFO Tuning ranking metrics: regret=0.115461 spearman=0.051304 (groups=40, skipped=311)
2025-12-25 15:27:16 INFO Epoch 096 | train_mse=0.070782 | val_loss=0.074387 | best_val_loss=0.166677
2025-12-25 15:27:24 INFO Epoch 097 | 25% complete (batch 46/181)
2025-12-25 15:27:25 INFO Epoch 097 | 50% complete (batch 91/181)
2025-12-25 15:27:26 INFO Epoch 097 | 75% complete (batch 136/181)
2025-12-25 15:27:35 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.589856
2025-12-25 15:27:40 INFO Tuning ranking metrics: regret=0.139279 spearman=0.015568 (groups=40, skipped=311)
2025-12-25 15:27:40 INFO Epoch 097 | train_mse=0.084703 | val_loss=0.086776 | best_val_loss=0.166677
2025-12-25 15:27:49 INFO Epoch 098 | 25% complete (batch 46/181)
2025-12-25 15:27:50 INFO Epoch 098 | 50% complete (batch 91/181)
2025-12-25 15:27:51 INFO Epoch 098 | 75% complete (batch 136/181)
2025-12-25 15:28:00 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.572137
2025-12-25 15:28:05 INFO Tuning ranking metrics: regret=0.105848 spearman=0.051088 (groups=40, skipped=311)
2025-12-25 15:28:05 INFO Epoch 098 | train_mse=0.059537 | val_loss=0.072016 | best_val_loss=0.166677
2025-12-25 15:28:14 INFO Epoch 099 | 25% complete (batch 46/181)
2025-12-25 15:28:15 INFO Epoch 099 | 50% complete (batch 91/181)
2025-12-25 15:28:16 INFO Epoch 099 | 75% complete (batch 136/181)
2025-12-25 15:28:25 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.604382
2025-12-25 15:28:30 INFO Tuning ranking metrics: regret=0.119479 spearman=0.027792 (groups=40, skipped=311)
2025-12-25 15:28:30 INFO Epoch 099 | train_mse=0.096571 | val_loss=0.083669 | best_val_loss=0.166677
2025-12-25 15:28:39 INFO Epoch 100 | 25% complete (batch 46/181)
2025-12-25 15:28:40 INFO Epoch 100 | 50% complete (batch 91/181)
2025-12-25 15:28:41 INFO Epoch 100 | 75% complete (batch 136/181)
2025-12-25 15:28:50 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.556573
2025-12-25 15:28:55 INFO Tuning ranking metrics: regret=0.124966 spearman=0.025081 (groups=40, skipped=311)
2025-12-25 15:28:55 INFO Epoch 100 | train_mse=0.066561 | val_loss=0.083640 | best_val_loss=0.166677
2025-12-25 15:29:04 INFO Epoch 101 | 25% complete (batch 46/181)
2025-12-25 15:29:05 INFO Epoch 101 | 50% complete (batch 91/181)
2025-12-25 15:29:06 INFO Epoch 101 | 75% complete (batch 136/181)
2025-12-25 15:29:15 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.567947
2025-12-25 15:29:21 INFO Tuning ranking metrics: regret=0.117663 spearman=-0.026109 (groups=40, skipped=311)
2025-12-25 15:29:21 INFO Epoch 101 | train_mse=0.089143 | val_loss=0.081723 | best_val_loss=0.166677
2025-12-25 15:29:30 INFO Epoch 102 | 25% complete (batch 46/181)
2025-12-25 15:29:31 INFO Epoch 102 | 50% complete (batch 91/181)
2025-12-25 15:29:32 INFO Epoch 102 | 75% complete (batch 136/181)
2025-12-25 15:29:41 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.579851
2025-12-25 15:29:46 INFO Tuning ranking metrics: regret=0.084605 spearman=0.020725 (groups=40, skipped=311)
2025-12-25 15:29:46 INFO Epoch 102 | train_mse=0.081717 | val_loss=0.077448 | best_val_loss=0.166677
2025-12-25 15:29:55 INFO Epoch 103 | 25% complete (batch 46/181)
2025-12-25 15:29:56 INFO Epoch 103 | 50% complete (batch 91/181)
2025-12-25 15:29:57 INFO Epoch 103 | 75% complete (batch 136/181)
2025-12-25 15:30:06 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.594614
2025-12-25 15:30:12 INFO Tuning ranking metrics: regret=0.100774 spearman=0.092738 (groups=40, skipped=311)
2025-12-25 15:30:12 INFO Epoch 103 | train_mse=0.070872 | val_loss=0.073417 | best_val_loss=0.166677
2025-12-25 15:30:21 INFO Epoch 104 | 25% complete (batch 46/181)
2025-12-25 15:30:22 INFO Epoch 104 | 50% complete (batch 91/181)
2025-12-25 15:30:23 INFO Epoch 104 | 75% complete (batch 136/181)
2025-12-25 15:30:32 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.564477
2025-12-25 15:30:38 INFO Tuning ranking metrics: regret=0.100785 spearman=0.073966 (groups=40, skipped=311)
2025-12-25 15:30:38 INFO Epoch 104 | train_mse=0.061142 | val_loss=0.105733 | best_val_loss=0.166677
2025-12-25 15:30:47 INFO Epoch 105 | 25% complete (batch 46/181)
2025-12-25 15:30:48 INFO Epoch 105 | 50% complete (batch 91/181)
2025-12-25 15:30:49 INFO Epoch 105 | 75% complete (batch 136/181)
2025-12-25 15:30:58 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = -0.563116
2025-12-25 15:31:04 INFO Tuning ranking metrics: regret=0.077150 spearman=0.115406 (groups=40, skipped=311)
2025-12-25 15:31:04 INFO Epoch 105 | train_mse=0.063610 | val_loss=0.086805 | best_val_loss=0.166677
Monitored metric tuning_rank_spearman did not improve in the last 40 records. Best score: 0.181. Signaling Trainer to stop.
2025-12-25 15:31:05 INFO Renamed checkpoint files: checkpoint.tuning_rank_spearman-0.11808_val-0.11601_epoch078.chkpt, checkpoint.tuning_rank_spearman-0.12359_val-0.06978_epoch095.chkpt, checkpoint.tuning_rank_spearman-0.16668_val-0.08785_epoch072.chkpt
2025-12-25 15:31:05 INFO Training completed. Best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed888/model_checkpoints/checkpoint.tuning_rank_spearman-0.16668_val-0.08785_epoch072.chkpt
2025-12-25 15:31:05 INFO Best validation loss: tensor(0.1667)
2025-12-25 15:31:05 INFO Running final validation/evaluation pass on full validation set.
Restoring states from the checkpoint path at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed888/model_checkpoints/checkpoint.tuning_rank_spearman-0.16668_val-0.08785_epoch072.chkpt
Loaded model weights from the checkpoint at /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed888/model_checkpoints/checkpoint.tuning_rank_spearman-0.16668_val-0.08785_epoch072.chkpt
/Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/venv_qtopo/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
2025-12-25 15:31:13 INFO Selection metric (val_loss - 1.000*max(0,val_spearman_corr-0.000)) = 0.087846
2025-12-25 15:31:18 INFO Tuning ranking metrics: regret=0.069929 spearman=0.166677 (groups=40, skipped=311)
2025-12-25 15:31:18 INFO Epoch 106 | val_loss=0.087846 | best_val_loss=0.166677
2025-12-25 15:31:19 INFO Validation metrics: [{'val_loss': 0.08784627169370651, 'tuning_rank_regret': 0.069928839802742, 'tuning_rank_spearman': 0.16667748987674713, 'val_pearson_corr': 0.6394863724708557, 'val_spearman_corr': 0.6273526549339294, 'val_rank_regret': 0.034090809524059296, 'val_rank_spearman': 0.3333333432674408}]
2025-12-25 15:31:19 INFO Symlinked best.ckpt to checkpoint.tuning_rank_spearman-0.16668_val-0.08785_epoch072.chkpt
2025-12-25 15:31:19 INFO Symlinked second_best.ckpt to checkpoint.tuning_rank_spearman-0.11808_val-0.11601_epoch078.chkpt
2025-12-25 15:31:19 INFO Symlinked third_best.ckpt to checkpoint.tuning_rank_spearman-0.12359_val-0.06978_epoch095.chkpt
2025-12-25 15:31:19 INFO Symlinked val_loss_best.ckpt to alt_val.val-0.07555_epoch069.ckpt
2025-12-25 15:31:19 WARNING Training proceeded with missing graphs. Consider regenerating .pt files to close the gap and potentially improve MSE.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   tuning_rank_regret        0.069928839802742
  tuning_rank_spearman      0.16667748987674713
        val_loss            0.08784627169370651
    val_pearson_corr        0.6394863724708557
     val_rank_regret       0.034090809524059296
    val_rank_spearman       0.3333333432674408
    val_spearman_corr       0.6273526549339294
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[train_cli] completed run polish_seed101_2025-12-25_09-39-57_phase2_seed888 -> /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed888
[run_full_pipeline] Phase 2 (seed 888) best checkpoint: /Volumes/PData/Data/Dev/Github/Repos/phd3/qtopo/QTopoQA/qtdaqa/new_dynamic_features/model_training2/training_runs2/polish_seed101_2025-12-25_09-39-57_phase2_seed888/model_checkpoints/checkpoint.tuning_rank_spearman-0.16668_val-0.08785_epoch072.chkpt (tuning_rank_spearman=0.16667748987674713)
[run_full_pipeline] Pipeline complete at 2025-12-25T15:31:21Z
    27817.13 real     46018.08 user     80989.84 sys
