topology:
  module: topology/persistence_k_partite_advanced/v1  # alias: Advanced k-partite PH (heavy) ≈ 700D
  alias: "Advanced k-partite PH (heavy) \u2248 700D"
  summary: "Advanced k-partite persistent homology with optional typed-contact and weighted/polar blocks."
  description: "Extends the full k-partite module with optional typed-contact blocks and hooks for weighted filtrations, power/landmark modes. Primary partitions are chains; optional secondary stratification (chemotype/DSSP). Presets keep backward compatibility while allowing richer chemistry-aware variants."
  # dim: 700
  params:
    preset: heavy  # minimal=140D, lean=base+cross-pair+per-partition, heavy=~700D (adds bias/polar/typed), heavy_stratified=~900D (adds secondary strat), rich=heavy_stratified + typed/weighted toggles on
    neighbor_distance: 8.0
    filtration_cutoff: 8.0
    min_persistence: 0.01
    element_filters:
      - [C]
      - [N]
      - [O]
      - [C, N]
      - [C, O]
      - [N, O]
      - [C, N, O]
    element_filters_stratified:
      - - C
        - N
        - O
    dedup_sort: false
    jobs: 16
    secondary_partition: none  # none|dssp|chemotype (ignored by minimal/lean/heavy; used by heavy_stratified/rich)
    k_max: 4  # Cap on number of primary partitions; blocks beyond cap are skipped (lean/heavy/stratified/rich)
    secondary_k_max: 4  # Cap on number of secondary partitions (stratified only); ignored otherwise
    enable_cross_bias: true  # Used in heavy/heavy_stratified/rich; ignored by lean/minimal even if true
    intra_penalty_mode: default  # default(=nd/2), light(=nd/4), heavy(=nd/1.34), none(=0), custom(use intra_penalty_lambda numeric); ignored by lean/minimal
    intra_penalty_lambda: null  # Used only when intra_penalty_mode=custom; otherwise derived from neighbor_distance; heavy/heavy_stratified/rich only
    max_atoms: 25000  # Guardrail to skip heavy blocks; ignored by lean/minimal
    max_block_seconds: 60.0  # Per-block time cap (s) for lean/heavy/stratified/rich; ignored by minimal
    enable_polar_block: true  # Used in heavy/heavy_stratified/rich; ignored by lean/minimal
    polar_hbond_weight: true  # Toggle H-bond weighting for polar block (heavy/heavy_stratified/rich); ignored by lean/minimal
    polar_hbond_weight_factor: 0.5  # Distance multiplier for H-bonded polar atoms (default=0.5); heavy/heavy_stratified/rich
    polar_hbond_energy_cutoff: -0.5  # DSSP H-bond energy cutoff (kcal/mol) (default=-0.5); heavy/heavy_stratified/rich
    polar_hbond_inter_only: false  # If true, only weight inter-chain H-bonded atoms; heavy/heavy_stratified/rich
    enable_typed_block: true  # Enable typed-contact PH (hydrophobic/salt/H-bond); heavy/heavy_stratified/rich
    enable_weighted_filtration: false  # Enable distance scaling by chemistry/energetics (simple scalar); default off; rich default on
    enable_power_block: false  # vdW-aware power/alpha mini-block (placeholder); default off
    enable_landmark_mode: false  # Landmark/witness approximation (placeholder); default off
    dssp_timeout_seconds: 10.0  # Per-PDB timeout for DSSP call (skip if exceeded).
    dssp_slow_threshold: 2.0  # Log a note if DSSP exceeds this time (seconds).

topology:
  module: topology/persistence_k_partite_advanced/v1  # alias: Advanced k-partite PH (heavy stratified) ≈ 900D
  alias: "Advanced k-partite PH (heavy stratified) \u2248 900D"
  summary: "Advanced k-partite persistent homology with optional typed-contact and weighted/polar blocks."
  description: "Extends the full k-partite module with optional typed-contact blocks and hooks for weighted filtrations, power/landmark modes. Primary partitions are chains; optional secondary stratification (chemotype/DSSP). Presets keep backward compatibility while allowing richer chemistry-aware variants."
  # dim: 900
  params:
    preset: heavy_stratified  # minimal=140D, lean=base+cross-pair+per-partition, heavy=~700D (adds bias/polar/typed), heavy_stratified=~900D (adds secondary strat), rich=heavy_stratified + typed/weighted toggles on
    neighbor_distance: 8.0
    filtration_cutoff: 8.0
    min_persistence: 0.01
    element_filters:
      - [C]
      - [N]
      - [O]
      - [C, N]
      - [C, O]
      - [N, O]
      - [C, N, O]
    element_filters_stratified:
      - - C
        - N
        - O
    dedup_sort: false
    jobs: 16
    secondary_partition: chemotype  # none|dssp|chemotype (ignored by minimal/lean/heavy; used by heavy_stratified/rich)
    k_max: 4  # Cap on number of primary partitions; blocks beyond cap are skipped (lean/heavy/stratified/rich)
    secondary_k_max: 4  # Cap on number of secondary partitions (stratified only); ignored otherwise
    enable_cross_bias: true  # Used in heavy/heavy_stratified/rich; ignored by lean/minimal even if true
    intra_penalty_mode: default  # default(=nd/2), light(=nd/4), heavy(=nd/1.34), none(=0), custom(use intra_penalty_lambda numeric); ignored by lean/minimal
    intra_penalty_lambda: null  # Used only when intra_penalty_mode=custom; otherwise derived from neighbor_distance; heavy/heavy_stratified/rich only
    max_atoms: 25000  # Guardrail to skip heavy blocks; ignored by lean/minimal
    max_block_seconds: 60.0  # Per-block time cap (s) for lean/heavy/stratified/rich; ignored by minimal
    enable_polar_block: true  # Used in heavy/heavy_stratified/rich; ignored by lean/minimal
    polar_hbond_weight: true  # Toggle H-bond weighting for polar block (heavy/heavy_stratified/rich); ignored by lean/minimal
    polar_hbond_weight_factor: 0.5  # Distance multiplier for H-bonded polar atoms (default=0.5); heavy/heavy_stratified/rich
    polar_hbond_energy_cutoff: -0.5  # DSSP H-bond energy cutoff (kcal/mol) (default=-0.5); heavy/heavy_stratified/rich
    polar_hbond_inter_only: false  # If true, only weight inter-chain H-bonded atoms; heavy/heavy_stratified/rich
    enable_typed_block: true  # Enable typed-contact PH (hydrophobic/salt/H-bond); heavy/heavy_stratified/rich
    enable_weighted_filtration: false  # Enable distance scaling by chemistry/energetics (simple scalar); default off; rich default on
    enable_power_block: false  # vdW-aware power/alpha mini-block (placeholder); default off
    enable_landmark_mode: false  # Landmark/witness approximation (placeholder); default off
    dssp_timeout_seconds: 10.0  # Per-PDB timeout for DSSP call (skip if exceeded).
    dssp_slow_threshold: 2.0  # Log a note if DSSP exceeds this time (seconds).

topology:
  module: topology/persistence_k_partite_advanced/v1  # alias: Advanced k-partite PH (rich) ≈ 1000D+
  alias: "Advanced k-partite PH (rich) \u2248 1000D+"
  summary: "Advanced k-partite persistent homology with optional typed-contact and weighted/polar blocks."
  description: "Extends the full k-partite module with optional typed-contact blocks and hooks for weighted filtrations, power/landmark modes. Primary partitions are chains; optional secondary stratification (chemotype/DSSP). Presets keep backward compatibility while allowing richer chemistry-aware variants."
  # dim: 1000
  params:
    preset: rich  # minimal=140D, lean=base+cross-pair+per-partition, heavy=~700D (adds bias/polar/typed), heavy_stratified=~900D (adds secondary strat), rich=heavy_stratified + typed/weighted toggles on
    neighbor_distance: 8.0
    filtration_cutoff: 8.0
    min_persistence: 0.01
    element_filters:
      - [C]
      - [N]
      - [O]
      - [C, N]
      - [C, O]
      - [N, O]
      - [C, N, O]
    element_filters_stratified:
      - - C
        - N
        - O
    dedup_sort: false
    jobs: 16
    secondary_partition: chemotype  # none|dssp|chemotype (ignored by minimal/lean/heavy; used by heavy_stratified/rich)
    k_max: 4  # Cap on number of primary partitions; blocks beyond cap are skipped (lean/heavy/stratified/rich)
    secondary_k_max: 4  # Cap on number of secondary partitions (stratified only); ignored otherwise
    enable_cross_bias: true  # Used in heavy/heavy_stratified/rich; ignored by lean/minimal even if true
    intra_penalty_mode: default  # default(=nd/2), light(=nd/4), heavy(=nd/1.34), none(=0), custom(use intra_penalty_lambda numeric); ignored by lean/minimal
    intra_penalty_lambda: null  # Used only when intra_penalty_mode=custom; otherwise derived from neighbor_distance; heavy/heavy_stratified/rich only
    max_atoms: 25000  # Guardrail to skip heavy blocks; ignored by lean/minimal
    max_block_seconds: 60.0  # Per-block time cap (s) for lean/heavy/stratified/rich; ignored by minimal
    enable_polar_block: true  # Used in heavy/heavy_stratified/rich; ignored by lean/minimal
    polar_hbond_weight: true  # Toggle H-bond weighting for polar block (heavy/heavy_stratified/rich); ignored by lean/minimal
    polar_hbond_weight_factor: 0.5  # Distance multiplier for H-bonded polar atoms (default=0.5); heavy/heavy_stratified/rich
    polar_hbond_energy_cutoff: -0.5  # DSSP H-bond energy cutoff (kcal/mol) (default=-0.5); heavy/heavy_stratified/rich
    polar_hbond_inter_only: false  # If true, only weight inter-chain H-bonded atoms; heavy/heavy_stratified/rich
    enable_typed_block: true  # Enable typed-contact PH (hydrophobic/salt/H-bond); heavy/heavy_stratified/rich
    enable_weighted_filtration: true  # Enable distance scaling by chemistry/energetics (simple scalar); default off; rich default on
    enable_power_block: false  # vdW-aware power/alpha mini-block (placeholder); default off
    enable_landmark_mode: false  # Landmark/witness approximation (placeholder); default off
    dssp_timeout_seconds: 10.0  # Per-PDB timeout for DSSP call (skip if exceeded).
    dssp_slow_threshold: 2.0  # Log a note if DSSP exceeds this time (seconds).
