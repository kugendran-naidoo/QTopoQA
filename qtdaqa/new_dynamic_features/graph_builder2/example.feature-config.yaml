# Auto-generated feature-config template
# Pick one module per required stage. Edit parameter values as needed.
# Run `./run_graph_builder2.sh --list-modules` for detailed descriptions.
defaults:
  jobs: 16  # Optional global worker override; remove if unused.

options:
  # topology_round_decimals: 12  # Round topology numeric columns to N decimals (0-15); -1 or omit to disable (recommended 12 when enabling).

# REQUIRED stage: interface
interface:
  module: interface/polar_cutoff/v1  # alias: residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA
  alias: "residue ID + 3D coordinates (x,y,z) default cutoff 10A | TopoQA"
  summary: "Polar interface detection using distance cutoff. ID + coords for downstream stages"
  description: "Identifies interface residues across chains using the polar interface routine (new_calculate_interface.process_pdb_file) with configurable distance cutoff and coordinate rounding."
  # dim: 3
  params:
    cutoff: 10.0  # Distance cutoff in Å for interface detection (cost grows with larger cutoff)
    coordinate_decimals: -1  # Decimal places for coords; set -1 to skip rounding
    jobs: 16  # Optional override; CLI --jobs takes precedence

# OPTIONAL stage: topology
topology:
  module: topology/persistence_basic/v1  # alias: Betti 0 and Betti 1 topology summaries on interface coords = 140D PH | TopoQA
  alias: "Betti 0 and Betti 1 topology summaries on interface coords = 140D PH | TopoQA"
  summary: "Persistent homology features with configurable distance thresholds."
  description: "Generates per-residue topological descriptors using the persistent homology pipeline from new_topological_features. Interface residues are required as input."
  # dim: 140
  params:
    neighbor_distance: 8.0  # Neighbourhood radius (Å) for building complexes; default 8.0
    filtration_cutoff: 8.0  # Max filtration value (Å); cost grows with larger cutoff (default 8.0)
    min_persistence: 0.01  # Minimum persistence to keep (default 0.01)
    dedup_sort: false  # Deduplicate/sort persistence pairs for determinism; may add slight cost
    element_filters:
      - [C]
      - [N]
      - [O]
      - [C, N]
      - [C, O]
      - [N, O]
      - [C, N, O]
    jobs: 16  # Optional override for worker count

# Alternate topology modules (uncomment to use):
# topology:
#   module: topology/lightweight_MoL/v1  # alias: 140D PH + 8D unweighted Lap moments (mu1-4, kappa2-4) = Topology 148D (lean MoL)
#   alias: "140D PH + 8D unweighted Lap moments (mu1-4, kappa2-4) = Topology 148D (lean MoL)"
#   summary: "Persistent homology plus lean unweighted Laplacian moments per interface residue (no per-eigen outputs)."
#   description: "Keeps the 140D persistent homology block and adds 8D unweighted normalized-Laplacian moments (mu1-4, kappa2-4) on local cross-chain bipartite neighborhoods (cutoff 8 A by default). Uses exact eigenvalues when node_count <= size_threshold (80), otherwise SLQ (probes=8, steps=32). Deterministic; no heat trace in v1."
#   # dim: 148
#   params:
#     neighbor_distance: 8.0
#     filtration_cutoff: 8.0
#     min_persistence: 0.01
#     dedup_sort: false
#     element_filters:
#       - [C]
#       - [N]
#       - [O]
#       - [C, N]
#       - [C, O]
#       - [N, O]
#       - [C, N, O]
#     lap_k_neighbors: null  # Optional deterministic k-NN cap; otherwise cutoff-based
#     lap_max_neighbors: 128  # Cap neighborhood size (includes target residue)
#     lap_size_threshold: 80  # Node-count threshold for switching from exact eigs to SLQ (default 80)
#     lap_estimator: exact  # exact (default) or slq
#     lap_slq_probes: 8  # Probe vectors for SLQ (default 8)
#     lap_slq_steps: 32  # Lanczos steps placeholder (default 32; kept for compatibility)
#     lap_profile: false  # Profile Laplacian moment wall time (writes to log)
#     jobs: 16
#
# topology:
#   module: topology/persistence_full_k_partite/v1  # alias: Fully k-partite PH (lean) = 560D
#   alias: "Fully k-partite PH (lean) = 560D"
#   summary: "Persistent homology with partition-aware blocks (primary partitions and optional secondary stratification)."
#   description: "Extends partial k-partite PH to arbitrary primary partitions (chains by default) and an optional secondary layer (DSSP or chemotype). Builds per-partition and per-pair PH blocks, with stratified variants in the heavy_stratified preset. Emits dims/schemas for downstream adaptation."
#   # dim: 560
#   params:
#     preset: lean  # minimal=140D, lean=base+cross-pair+per-partition (minimum 560D for k=2), heavy=~700+ D (cross-bias+options), heavy_stratified=~900+ D (heavy + secondary stratification)
#     neighbor_distance: 8.0
#     filtration_cutoff: 8.0
#     min_persistence: 0.01
#     element_filters:
#       - [C]
#       - [N]
#       - [O]
#       - [C, N]
#       - [C, O]
#       - [N, O]
#       - [C, N, O]
#     element_filters_stratified:
#       - - C
#         - N
#         - O
#     dedup_sort: false
#     jobs: 16
#     secondary_partition: none  # none|dssp|chemotype (mutually exclusive; ignored by lean/minimal; heavy_stratified uses one secondary layer)
#     k_max: 4  # Cap on number of primary partitions; blocks beyond cap are skipped (used by lean/heavy/stratified)
#     secondary_k_max: 4  # Cap on number of secondary partitions (for stratified); ignored by lean/minimal/heavy
#     enable_cross_bias: false  # Used only in heavy/heavy_stratified; ignored by lean/minimal even if true
#     intra_penalty_mode: default  # default(=nd/2), light(=nd/4), heavy(=nd/1.34), none(=0), custom(use intra_penalty_lambda numeric); ignored by lean/minimal
#     intra_penalty_lambda: null  # Used only when intra_penalty_mode=custom; otherwise derived from neighbor_distance; heavy/heavy_stratified only (ignored by lean/minimal)
#     max_atoms: 25000  # Guardrail to skip heavy blocks; ignored by lean/minimal
#     max_block_seconds: 60.0  # Per-block time cap (s) for lean/heavy/stratified; ignored by minimal
#     enable_polar_block: false  # Used only in heavy/heavy_stratified; ignored by lean/minimal
#     polar_hbond_weight: false  # Toggle H-bond weighting for polar block (heavy/heavy_stratified only); ignored by lean/minimal
#     polar_hbond_weight_factor: 0.5  # Distance multiplier for H-bonded polar atoms (default=0.5); heavy/heavy_stratified only
#     polar_hbond_energy_cutoff: -0.5  # DSSP H-bond energy cutoff (kcal/mol) to consider bonded (default=-0.5); heavy/heavy_stratified only
#     polar_hbond_inter_only: false  # If true, only weight inter-chain H-bonded atoms in polar block; heavy/heavy_stratified only
#     dssp_timeout_seconds: 10.0
#     dssp_slow_threshold: 2.0
#
# topology:
#   module: topology/persistence_full_k_partite/v1  # alias: Fully k-partite PH minimal (base only) = 140D
#   alias: "Fully k-partite PH minimal (base only) = 140D"
#   summary: "Persistent homology with partition-aware blocks (primary partitions and optional secondary stratification)."
#   description: "Extends partial k-partite PH to arbitrary primary partitions (chains by default) and an optional secondary layer (DSSP or chemotype). Builds per-partition and per-pair PH blocks, with stratified variants in the heavy_stratified preset. Emits dims/schemas for downstream adaptation."
#   # dim: 140
#   params:
#     preset: minimal  # standard topoqa = 140D = topology/persistence_basic/v1
#     neighbor_distance: 8.0
#     filtration_cutoff: 8.0
#     min_persistence: 0.01
#     element_filters:
#       - [C]
#       - [N]
#       - [O]
#       - [C, N]
#       - [C, O]
#       - [N, O]
#       - [C, N, O]
#     element_filters_stratified:
#       - - C
#         - N
#         - O
#     dedup_sort: false
#     jobs: 16
#     secondary_partition: none  # ignored for minimal preset
#     k_max: 4  # ignored for minimal preset
#     secondary_k_max: 4  # ignored for minimal preset
#     enable_cross_bias: false  # ignored for minimal preset
#     intra_penalty_mode: default  # ignored for minimal preset
#     intra_penalty_lambda: null  # ignored for minimal preset
#     max_atoms: 25000  # ignored for minimal preset
#     max_block_seconds: 60.0  # ignored for minimal preset
#     enable_polar_block: false  # ignored for minimal preset
#     polar_hbond_weight: false  # ignored for minimal preset
#     polar_hbond_weight_factor: 0.5  # ignored for minimal preset
#     polar_hbond_energy_cutoff: -0.5  # ignored for minimal preset
#     polar_hbond_inter_only: false  # ignored for minimal preset
#     dssp_timeout_seconds: 10.0
#     dssp_slow_threshold: 2.0
#
# topology:
#   module: topology/persistence_full_k_partite/v1  # alias: Fully k-partite PH (heavy) = 700+ D
#   alias: "Fully k-partite PH (heavy) = 700+ D"
#   summary: "Persistent homology with partition-aware blocks (primary partitions and optional secondary stratification)."
#   description: "Extends partial k-partite PH to arbitrary primary partitions (chains by default) and an optional secondary layer (DSSP or chemotype). Builds per-partition and per-pair PH blocks, with stratified variants in the heavy_stratified preset. Emits dims/schemas for downstream adaptation."
#   params:
#     preset: heavy  # minimal=140D, lean=base+cross-pair+per-partition (minimum 560D for k=2), heavy=~700+ D (cross-bias+options), heavy_stratified=~900+ D (heavy + secondary stratification)
#     neighbor_distance: 8.0
#     filtration_cutoff: 8.0
#     min_persistence: 0.01
#     element_filters:
#       - [C]
#       - [N]
#       - [O]
#       - [C, N]
#       - [C, O]
#       - [N, O]
#       - [C, N, O]
#     element_filters_stratified:
#       - - C
#         - N
#         - O
#     dedup_sort: false
#     jobs: 16
#     secondary_partition: none  # none|dssp|chemotype (mutually exclusive; ignored by lean/minimal; heavy_stratified uses one secondary layer)
#     k_max: 4  # Cap on number of primary partitions; blocks beyond cap are skipped (used by lean/heavy/stratified)
#     secondary_k_max: 4  # Cap on number of secondary partitions (for stratified); ignored by lean/minimal/heavy
#     enable_cross_bias: true  # Used only in heavy/heavy_stratified; ignored by lean/minimal even if true
#     intra_penalty_mode: default  # default(=nd/2), light(=nd/4), heavy(=nd/1.34), none(=0), custom(use intra_penalty_lambda numeric); ignored by lean/minimal
#     intra_penalty_lambda: null  # Used only when intra_penalty_mode=custom; otherwise derived from neighbor_distance; heavy/heavy_stratified only (ignored by lean/minimal)
#     max_atoms: 25000  # Guardrail to skip heavy blocks; ignored by lean/minimal
#     max_block_seconds: 60.0  # Per-block time cap (s) for lean/heavy/stratified; ignored by minimal
#     enable_polar_block: false  # Used only in heavy/heavy_stratified; ignored by lean/minimal
#     polar_hbond_weight: false  # Toggle H-bond weighting for polar block (heavy/heavy_stratified only); ignored by lean/minimal
#     polar_hbond_weight_factor: 0.5  # Distance multiplier for H-bonded polar atoms (default=0.5); heavy/heavy_stratified only
#     polar_hbond_energy_cutoff: -0.5  # DSSP H-bond energy cutoff (kcal/mol) to consider bonded (default=-0.5); heavy/heavy_stratified only
#     polar_hbond_inter_only: false  # If true, only weight inter-chain H-bonded atoms in polar block; heavy/heavy_stratified only
#     dssp_timeout_seconds: 10.0
#     dssp_slow_threshold: 2.0
#
# topology:
#   module: topology/persistence_full_k_partite/v1  # alias: Fully k-partite PH (heavy stratified) = 900+ D
#   alias: "Fully k-partite PH (heavy stratified) = 900+ D"
#   summary: "Persistent homology with partition-aware blocks (primary partitions and optional secondary stratification)."
#   description: "Extends partial k-partite PH to arbitrary primary partitions (chains by default) and an optional secondary layer (DSSP or chemotype). Builds per-partition and per-pair PH blocks, with stratified variants in the heavy_stratified preset. Emits dims/schemas for downstream adaptation."
#   params:
#     preset: heavy_stratified  # minimal=140D, lean=base+cross-pair+per-partition (minimum 560D for k=2), heavy=~700+ D (cross-bias+options), heavy_stratified=~900+ D (heavy + secondary stratification)
#     neighbor_distance: 8.0
#     filtration_cutoff: 8.0
#     min_persistence: 0.01
#     element_filters:
#       - [C]
#       - [N]
#       - [O]
#       - [C, N]
#       - [C, O]
#       - [N, O]
#       - [C, N, O]
#     element_filters_stratified:
#       - - C
#         - N
#         - O
#     dedup_sort: false
#     jobs: 16
#     secondary_partition: chemotype  # none|dssp|chemotype (mutually exclusive; ignored by lean/minimal; heavy_stratified uses one secondary layer)
#     k_max: 4  # Cap on number of primary partitions; blocks beyond cap are skipped (used by lean/heavy/stratified)
#     secondary_k_max: 4  # Cap on number of secondary partitions (for stratified); ignored by lean/minimal/heavy
#     enable_cross_bias: true  # Used only in heavy/heavy_stratified; ignored by lean/minimal even if true
#     intra_penalty_mode: default  # default(=nd/2), light(=nd/4), heavy(=nd/1.34), none(=0), custom(use intra_penalty_lambda numeric); ignored by lean/minimal
#     intra_penalty_lambda: null  # Used only when intra_penalty_mode=custom; otherwise derived from neighbor_distance; heavy/heavy_stratified only (ignored by lean/minimal)
#     max_atoms: 25000  # Guardrail to skip heavy blocks; ignored by lean/minimal
#     max_block_seconds: 60.0  # Per-block time cap (s) for lean/heavy/stratified; ignored by minimal
#     enable_polar_block: true  # Used only in heavy/heavy_stratified; ignored by lean/minimal
#     polar_hbond_weight: true  # Toggle H-bond weighting for polar block (heavy/heavy_stratified only); ignored by lean/minimal
#     polar_hbond_weight_factor: 0.5  # Distance multiplier for H-bonded polar atoms (default=0.5); heavy/heavy_stratified only
#     polar_hbond_energy_cutoff: -0.5  # DSSP H-bond energy cutoff (kcal/mol) to consider bonded (default=-0.5); heavy/heavy_stratified only
#     polar_hbond_inter_only: false  # If true, only weight inter-chain H-bonded atoms in polar block; heavy/heavy_stratified only
#     dssp_timeout_seconds: 10.0
#     dssp_slow_threshold: 2.0
#
# topology:
#   module: topology/persistence_k_partite_advanced/v1  # alias: Advanced k-partite PH (lean) = 560D+
#   alias: "Advanced k-partite PH (lean) = 560D+"
#   summary: "Advanced k-partite persistent homology with optional typed-contact and weighted/polar blocks."
#   description: "Extends the full k-partite module with optional typed-contact blocks and hooks for weighted filtrations, power/landmark modes. Primary partitions are chains; optional secondary stratification (chemotype/DSSP). Presets keep backward compatibility while allowing richer chemistry-aware variants."
#   # dim: 560
#   params:
#     preset: lean  # minimal=140D, lean=base+cross-pair+per-partition, heavy=~700D (bias+polar+typed, no secondary), heavy_stratified=~900D (adds secondary strat)
#     neighbor_distance: 8.0
#     filtration_cutoff: 8.0
#     min_persistence: 0.01
#     element_filters:
#       - [C]
#       - [N]
#       - [O]
#       - [C, N]
#       - [C, O]
#       - [N, O]
#       - [C, N, O]
#     element_filters_stratified:
#       - - C
#         - N
#         - O
#     dedup_sort: false
#     jobs: 16
#     secondary_partition: none  # none|dssp|chemotype (ignored by minimal/lean/heavy; used by heavy_stratified)
#     k_max: 4  # Cap on number of primary partitions; blocks beyond cap are skipped (lean/heavy/stratified)
#     secondary_k_max: 4  # Cap on number of secondary partitions (stratified only); ignored otherwise
#     enable_cross_bias: false  # Used in heavy/heavy_stratified; ignored by lean/minimal even if true
#     intra_penalty_mode: default  # default(=nd/2), light(=nd/4), heavy(=nd/1.34), none(=0), custom(use intra_penalty_lambda numeric); ignored by lean/minimal
#     intra_penalty_lambda: null  # Used only when intra_penalty_mode=custom; otherwise derived from neighbor_distance; heavy/heavy_stratified only
#     max_atoms: 25000  # Guardrail to skip heavy blocks; ignored by lean/minimal
#     max_block_seconds: 60.0  # Per-block time cap (s) for lean/heavy/stratified; ignored by minimal
#     enable_polar_block: false  # Used in heavy/heavy_stratified; ignored by lean/minimal
#     polar_hbond_weight: false  # Toggle H-bond weighting for polar block (heavy/heavy_stratified); ignored by lean/minimal
#     polar_hbond_weight_factor: 0.5  # Distance multiplier for H-bonded polar atoms (default=0.5); heavy/heavy_stratified
#     polar_hbond_energy_cutoff: -0.5  # DSSP H-bond energy cutoff (kcal/mol) (default=-0.5); heavy/heavy_stratified
#     polar_hbond_inter_only: false  # If true, only weight inter-chain H-bonded atoms; heavy/heavy_stratified
#     enable_typed_block: false  # Enable typed-contact PH (hydrophobic/salt/H-bond); heavy/heavy_stratified default ON
#     dssp_timeout_seconds: 10.0  # Per-PDB timeout for DSSP call (skip if exceeded).
#     dssp_slow_threshold: 2.0  # Log a note if DSSP exceeds this time (seconds).
#
# topology:
#   module: topology/persistence_k_partite_advanced/v1  # alias: Advanced k-partite PH minimal (base only) = 140D
#   alias: "Advanced k-partite PH minimal (base only) = 140D"
#   summary: "Advanced k-partite persistent homology with optional typed-contact and weighted/polar blocks."
#   description: "Extends the full k-partite module with optional typed-contact blocks and hooks for weighted filtrations, power/landmark modes. Primary partitions are chains; optional secondary stratification (chemotype/DSSP). Presets keep backward compatibility while allowing richer chemistry-aware variants."
#   # dim: 140
#   params:
#     preset: minimal  # standard topoqa = 140D
#     neighbor_distance: 8.0
#     filtration_cutoff: 8.0
#     min_persistence: 0.01
#     element_filters:
#       - [C]
#       - [N]
#       - [O]
#       - [C, N]
#       - [C, O]
#       - [N, O]
#       - [C, N, O]
#     element_filters_stratified:
#       - - C
#         - N
#         - O
#     dedup_sort: false
#     jobs: 16
#     secondary_partition: none  # ignored for minimal preset
#     k_max: 4  # ignored for minimal preset
#     secondary_k_max: 4  # ignored for minimal preset
#     enable_cross_bias: false  # ignored for minimal preset
#     intra_penalty_mode: default  # ignored for minimal preset
#     intra_penalty_lambda: null  # ignored for minimal preset
#     max_atoms: 25000  # ignored for minimal preset
#     max_block_seconds: 60.0  # ignored for minimal preset
#     enable_polar_block: false  # ignored for minimal preset
#     polar_hbond_weight: false  # ignored for minimal preset
#     polar_hbond_weight_factor: 0.5  # ignored for minimal preset
#     polar_hbond_energy_cutoff: -0.5  # ignored for minimal preset
#     polar_hbond_inter_only: false  # ignored for minimal preset
#     enable_typed_block: false  # ignored for minimal preset
#     dssp_timeout_seconds: 10.0  # Per-PDB timeout for DSSP call (skip if exceeded).
#     dssp_slow_threshold: 2.0  # Log a note if DSSP exceeds this time (seconds).
#
# topology:
#   module: topology/persistence_k_partite_advanced/v1  # alias: Advanced k-partite PH (heavy) ≈ 700D (bias+polar+typed)
#   alias: "Advanced k-partite PH (heavy) \u2248 700D (bias+polar+typed)"
#   summary: "Advanced k-partite persistent homology with optional typed-contact and weighted/polar blocks."
#   description: "Extends the full k-partite module with optional typed-contact blocks and hooks for weighted filtrations, power/landmark modes. Primary partitions are chains; optional secondary stratification (chemotype/DSSP). Presets keep backward compatibility while allowing richer chemistry-aware variants."
#   # dim: 700
#   params:
#     preset: heavy  # minimal=140D, lean=base+cross-pair+per-partition, heavy=~700D (bias+polar+typed, no secondary), heavy_stratified=~900D (adds secondary strat)
#     neighbor_distance: 8.0
#     filtration_cutoff: 8.0
#     min_persistence: 0.01
#     element_filters:
#       - [C]
#       - [N]
#       - [O]
#       - [C, N]
#       - [C, O]
#       - [N, O]
#       - [C, N, O]
#     element_filters_stratified:
#       - - C
#         - N
#         - O
#     dedup_sort: false
#     jobs: 16
#     secondary_partition: none  # none|dssp|chemotype (ignored by minimal/lean/heavy; used by heavy_stratified)
#     k_max: 4  # Cap on number of primary partitions; blocks beyond cap are skipped (lean/heavy/stratified)
#     secondary_k_max: 4  # Cap on number of secondary partitions (stratified only); ignored otherwise
#     enable_cross_bias: true  # Used in heavy/heavy_stratified; ignored by lean/minimal even if true
#     intra_penalty_mode: default  # default(=nd/2), light(=nd/4), heavy(=nd/1.34), none(=0), custom(use intra_penalty_lambda numeric); ignored by lean/minimal
#     intra_penalty_lambda: null  # Used only when intra_penalty_mode=custom; otherwise derived from neighbor_distance; heavy/heavy_stratified only
#     max_atoms: 25000  # Guardrail to skip heavy blocks; ignored by lean/minimal
#     max_block_seconds: 60.0  # Per-block time cap (s) for lean/heavy/stratified; ignored by minimal
#     enable_polar_block: true  # Used in heavy/heavy_stratified; ignored by lean/minimal
#     polar_hbond_weight: true  # Toggle H-bond weighting for polar block (heavy/heavy_stratified); ignored by lean/minimal
#     polar_hbond_weight_factor: 0.5  # Distance multiplier for H-bonded polar atoms (default=0.5); heavy/heavy_stratified
#     polar_hbond_energy_cutoff: -0.5  # DSSP H-bond energy cutoff (kcal/mol) (default=-0.5); heavy/heavy_stratified
#     polar_hbond_inter_only: false  # If true, only weight inter-chain H-bonded atoms; heavy/heavy_stratified
#     enable_typed_block: true  # Enable typed-contact PH (hydrophobic/salt/H-bond); heavy/heavy_stratified default ON
#     dssp_timeout_seconds: 10.0  # Per-PDB timeout for DSSP call (skip if exceeded).
#     dssp_slow_threshold: 2.0  # Log a note if DSSP exceeds this time (seconds).
#
# topology:
#   module: topology/persistence_k_partite_advanced/v1  # alias: Advanced k-partite PH (heavy stratified) ≈ 900D (chemotype + polar + typed)
#   alias: "Advanced k-partite PH (heavy stratified) \u2248 900D (chemotype + polar + typed)"
#   summary: "Advanced k-partite persistent homology with optional typed-contact and weighted/polar blocks."
#   description: "Extends the full k-partite module with optional typed-contact blocks and hooks for weighted filtrations, power/landmark modes. Primary partitions are chains; optional secondary stratification (chemotype/DSSP). Presets keep backward compatibility while allowing richer chemistry-aware variants."
#   # dim: 900
#   params:
#     preset: heavy_stratified  # minimal=140D, lean=base+cross-pair+per-partition, heavy=~700D (bias+polar+typed, no secondary), heavy_stratified=~900D (adds secondary strat)
#     neighbor_distance: 8.0
#     filtration_cutoff: 8.0
#     min_persistence: 0.01
#     element_filters:
#       - [C]
#       - [N]
#       - [O]
#       - [C, N]
#       - [C, O]
#       - [N, O]
#       - [C, N, O]
#     element_filters_stratified:
#       - - C
#         - N
#         - O
#     dedup_sort: false
#     jobs: 16
#     secondary_partition: chemotype  # none|dssp|chemotype (ignored by minimal/lean/heavy; used by heavy_stratified)
#     k_max: 4  # Cap on number of primary partitions; blocks beyond cap are skipped (lean/heavy/stratified)
#     secondary_k_max: 4  # Cap on number of secondary partitions (stratified only); ignored otherwise
#     enable_cross_bias: true  # Used in heavy/heavy_stratified; ignored by lean/minimal even if true
#     intra_penalty_mode: default  # default(=nd/2), light(=nd/4), heavy(=nd/1.34), none(=0), custom(use intra_penalty_lambda numeric); ignored by lean/minimal
#     intra_penalty_lambda: null  # Used only when intra_penalty_mode=custom; otherwise derived from neighbor_distance; heavy/heavy_stratified only
#     max_atoms: 25000  # Guardrail to skip heavy blocks; ignored by lean/minimal
#     max_block_seconds: 60.0  # Per-block time cap (s) for lean/heavy/stratified; ignored by minimal
#     enable_polar_block: true  # Used in heavy/heavy_stratified; ignored by lean/minimal
#     polar_hbond_weight: true  # Toggle H-bond weighting for polar block (heavy/heavy_stratified); ignored by lean/minimal
#     polar_hbond_weight_factor: 0.5  # Distance multiplier for H-bonded polar atoms (default=0.5); heavy/heavy_stratified
#     polar_hbond_energy_cutoff: -0.5  # DSSP H-bond energy cutoff (kcal/mol) (default=-0.5); heavy/heavy_stratified
#     polar_hbond_inter_only: false  # If true, only weight inter-chain H-bonded atoms; heavy/heavy_stratified
#     enable_typed_block: true  # Enable typed-contact PH (hydrophobic/salt/H-bond); heavy/heavy_stratified default ON
#     dssp_timeout_seconds: 10.0  # Per-PDB timeout for DSSP call (skip if exceeded).
#     dssp_slow_threshold: 2.0  # Log a note if DSSP exceeds this time (seconds).
#
# topology:
#   module: topology/persistence_k_partite_advanced/v2  # alias: Advanced k-partite PH (v2 fixed-width) = preset-dependent
#   alias: "Advanced k-partite PH (v2 fixed-width) = preset-dependent"
#   summary: "Fixed-width k-partite persistent homology with slot padding + missingness channels."
#   description: "Produces a fixed-width topology CSV per structure by padding missing chain/pair/typed/stratified slots up to configured caps and prefixing every feature column with a block identifier. Always appends slot-level missingness channels (present/size/reason) so padded zeros are not ambiguous."
#   params:
#     preset: lean  # minimal=base only; lean=base+per-primary+per-pair (fixed slots); heavy=lean+cross-bias+polar+typed; heavy_stratified=heavy+secondary stratification
#     neighbor_distance: 8.0
#     filtration_cutoff: 8.0
#     min_persistence: 0.01
#     element_filters:
#       - [C]
#       - [N]
#       - [O]
#       - [C, N]
#       - [C, O]
#       - [N, O]
#       - [C, N, O]
#     element_filters_stratified:
#       - - C
#         - N
#         - O
#     dedup_sort: false
#     jobs: 16
#     secondary_partition: none  # none|dssp|chemotype (heavy_stratified only)
#     k_max: 2  # Number of primary slots (chains) in fixed schema; missing slots padded with reason_missing_slot
#     secondary_k_max: 4  # Max secondary classes used (DSSP fixed 3-state H/E/C; chemotype fixed 4-class POS/NEG/POLAR/HYDRO); extra classes truncated deterministically
#     enable_cross_bias: false
#     intra_penalty_mode: default
#     intra_penalty_lambda: null
#     max_atoms: 25000  # Guardrail: if atom_count > max_atoms, heavy blocks are padded with reason_guardrail_skip
#     max_block_seconds: 60.0  # Time cap per block; on timeout, slot is padded with reason_timeout
#     enable_polar_block: false
#     polar_hbond_weight: false
#     polar_hbond_weight_factor: 0.5
#     polar_hbond_energy_cutoff: -0.5
#     polar_hbond_inter_only: false
#     enable_typed_block: false
#     dssp_timeout_seconds: 10.0
#     dssp_slow_threshold: 2.0
#     write_slot_maps: false  # If true, write work/topology_slot_maps/<pdb_id>.slot_map.json for debugging
#     max_topology_dim_allowed: null  # Optional safety: warn/fail if expected worst-case topo_dim exceeds this limit
#     fail_fast_topology_dim: false  # If true, raise error when expected worst-case topo_dim exceeds limit; otherwise warn only
#
# topology:
#   module: topology/persistence_k_partite_advanced/v2  # alias: Advanced k-partite PH (v2 minimal) ≈ topo_dim 149
#   alias: "Advanced k-partite PH (v2 minimal) \u2248 topo_dim 149"
#   summary: "Fixed-width k-partite persistent homology with slot padding + missingness channels."
#   description: "Produces a fixed-width topology CSV per structure by padding missing chain/pair/typed/stratified slots up to configured caps and prefixing every feature column with a block identifier. Always appends slot-level missingness channels (present/size/reason) so padded zeros are not ambiguous."
#   params:
#     preset: minimal  # minimal=base only; lean=base+per-primary+per-pair (fixed slots); heavy=lean+cross-bias+polar+typed; heavy_stratified=heavy+secondary stratification
#     neighbor_distance: 8.0
#     filtration_cutoff: 8.0
#     min_persistence: 0.01
#     element_filters:
#       - [C]
#       - [N]
#       - [O]
#       - [C, N]
#       - [C, O]
#       - [N, O]
#       - [C, N, O]
#     element_filters_stratified:
#       - - C
#         - N
#         - O
#     dedup_sort: false
#     jobs: 16
#     secondary_partition: none  # none|dssp|chemotype (heavy_stratified only)
#     k_max: 2  # Number of primary slots (chains) in fixed schema; missing slots padded with reason_missing_slot
#     secondary_k_max: 4  # Max secondary classes used (DSSP fixed 3-state H/E/C; chemotype fixed 4-class POS/NEG/POLAR/HYDRO); extra classes truncated deterministically
#     enable_cross_bias: false
#     intra_penalty_mode: default
#     intra_penalty_lambda: null
#     max_atoms: 25000  # Guardrail: if atom_count > max_atoms, heavy blocks are padded with reason_guardrail_skip
#     max_block_seconds: 60.0  # Time cap per block; on timeout, slot is padded with reason_timeout
#     enable_polar_block: false
#     polar_hbond_weight: false
#     polar_hbond_weight_factor: 0.5
#     polar_hbond_energy_cutoff: -0.5
#     polar_hbond_inter_only: false
#     enable_typed_block: false
#     dssp_timeout_seconds: 10.0
#     dssp_slow_threshold: 2.0
#     write_slot_maps: false  # If true, write work/topology_slot_maps/<pdb_id>.slot_map.json for debugging
#     max_topology_dim_allowed: null  # Optional safety: warn/fail if expected worst-case topo_dim exceeds this limit
#     fail_fast_topology_dim: false  # If true, raise error when expected worst-case topo_dim exceeds limit; otherwise warn only
#
# topology:
#   module: topology/persistence_k_partite_advanced/v2  # alias: Advanced k-partite PH (v2 lean) ≈ topo_dim 596
#   alias: "Advanced k-partite PH (v2 lean) \u2248 topo_dim 596"
#   summary: "Fixed-width k-partite persistent homology with slot padding + missingness channels."
#   description: "Produces a fixed-width topology CSV per structure by padding missing chain/pair/typed/stratified slots up to configured caps and prefixing every feature column with a block identifier. Always appends slot-level missingness channels (present/size/reason) so padded zeros are not ambiguous."
#   params:
#     preset: lean  # minimal=base only; lean=base+per-primary+per-pair (fixed slots); heavy=lean+cross-bias+polar+typed; heavy_stratified=heavy+secondary stratification
#     neighbor_distance: 8.0
#     filtration_cutoff: 8.0
#     min_persistence: 0.01
#     element_filters:
#       - [C]
#       - [N]
#       - [O]
#       - [C, N]
#       - [C, O]
#       - [N, O]
#       - [C, N, O]
#     element_filters_stratified:
#       - - C
#         - N
#         - O
#     dedup_sort: false
#     jobs: 16
#     secondary_partition: none  # none|dssp|chemotype (heavy_stratified only)
#     k_max: 2  # Number of primary slots (chains) in fixed schema; missing slots padded with reason_missing_slot
#     secondary_k_max: 4  # Max secondary classes used (DSSP fixed 3-state H/E/C; chemotype fixed 4-class POS/NEG/POLAR/HYDRO); extra classes truncated deterministically
#     enable_cross_bias: false
#     intra_penalty_mode: default
#     intra_penalty_lambda: null
#     max_atoms: 25000  # Guardrail: if atom_count > max_atoms, heavy blocks are padded with reason_guardrail_skip
#     max_block_seconds: 60.0  # Time cap per block; on timeout, slot is padded with reason_timeout
#     enable_polar_block: false
#     polar_hbond_weight: false
#     polar_hbond_weight_factor: 0.5
#     polar_hbond_energy_cutoff: -0.5
#     polar_hbond_inter_only: false
#     enable_typed_block: false
#     dssp_timeout_seconds: 10.0
#     dssp_slow_threshold: 2.0
#     write_slot_maps: false  # If true, write work/topology_slot_maps/<pdb_id>.slot_map.json for debugging
#     max_topology_dim_allowed: null  # Optional safety: warn/fail if expected worst-case topo_dim exceeds this limit
#     fail_fast_topology_dim: false  # If true, raise error when expected worst-case topo_dim exceeds limit; otherwise warn only
#
# topology:
#   module: topology/persistence_k_partite_advanced/v2  # alias: Advanced k-partite PH (v2 heavy) ≈ topo_dim 1688
#   alias: "Advanced k-partite PH (v2 heavy) \u2248 topo_dim 1688"
#   summary: "Fixed-width k-partite persistent homology with slot padding + missingness channels."
#   description: "Produces a fixed-width topology CSV per structure by padding missing chain/pair/typed/stratified slots up to configured caps and prefixing every feature column with a block identifier. Always appends slot-level missingness channels (present/size/reason) so padded zeros are not ambiguous."
#   params:
#     preset: heavy  # minimal=base only; lean=base+per-primary+per-pair (fixed slots); heavy=lean+cross-bias+polar+typed; heavy_stratified=heavy+secondary stratification
#     neighbor_distance: 8.0
#     filtration_cutoff: 8.0
#     min_persistence: 0.01
#     element_filters:
#       - [C]
#       - [N]
#       - [O]
#       - [C, N]
#       - [C, O]
#       - [N, O]
#       - [C, N, O]
#     element_filters_stratified:
#       - - C
#         - N
#         - O
#     dedup_sort: false
#     jobs: 16
#     secondary_partition: none  # none|dssp|chemotype (heavy_stratified only)
#     k_max: 2  # Number of primary slots (chains) in fixed schema; missing slots padded with reason_missing_slot
#     secondary_k_max: 4  # Max secondary classes used (DSSP fixed 3-state H/E/C; chemotype fixed 4-class POS/NEG/POLAR/HYDRO); extra classes truncated deterministically
#     enable_cross_bias: true
#     intra_penalty_mode: default
#     intra_penalty_lambda: null
#     max_atoms: 25000  # Guardrail: if atom_count > max_atoms, heavy blocks are padded with reason_guardrail_skip
#     max_block_seconds: 60.0  # Time cap per block; on timeout, slot is padded with reason_timeout
#     enable_polar_block: true
#     polar_hbond_weight: true
#     polar_hbond_weight_factor: 0.5
#     polar_hbond_energy_cutoff: -0.5
#     polar_hbond_inter_only: false
#     enable_typed_block: true
#     dssp_timeout_seconds: 10.0
#     dssp_slow_threshold: 2.0
#     write_slot_maps: false  # If true, write work/topology_slot_maps/<pdb_id>.slot_map.json for debugging
#     max_topology_dim_allowed: null  # Optional safety: warn/fail if expected worst-case topo_dim exceeds this limit
#     fail_fast_topology_dim: false  # If true, raise error when expected worst-case topo_dim exceeds limit; otherwise warn only
#
# topology:
#   module: topology/persistence_k_partite_advanced/v2  # alias: Advanced k-partite PH (v2 heavy_stratified) ≈ topo_dim 2036
#   alias: "Advanced k-partite PH (v2 heavy_stratified) \u2248 topo_dim 2036"
#   summary: "Fixed-width k-partite persistent homology with slot padding + missingness channels."
#   description: "Produces a fixed-width topology CSV per structure by padding missing chain/pair/typed/stratified slots up to configured caps and prefixing every feature column with a block identifier. Always appends slot-level missingness channels (present/size/reason) so padded zeros are not ambiguous."
#   params:
#     preset: heavy_stratified  # minimal=base only; lean=base+per-primary+per-pair (fixed slots); heavy=lean+cross-bias+polar+typed; heavy_stratified=heavy+secondary stratification
#     neighbor_distance: 8.0
#     filtration_cutoff: 8.0
#     min_persistence: 0.01
#     element_filters:
#       - [C]
#       - [N]
#       - [O]
#       - [C, N]
#       - [C, O]
#       - [N, O]
#       - [C, N, O]
#     element_filters_stratified:
#       - - C
#         - N
#         - O
#     dedup_sort: false
#     jobs: 16
#     secondary_partition: chemotype  # none|dssp|chemotype (heavy_stratified only)
#     k_max: 2  # Number of primary slots (chains) in fixed schema; missing slots padded with reason_missing_slot
#     secondary_k_max: 4  # Max secondary classes used (DSSP fixed 3-state H/E/C; chemotype fixed 4-class POS/NEG/POLAR/HYDRO); extra classes truncated deterministically
#     enable_cross_bias: true
#     intra_penalty_mode: default
#     intra_penalty_lambda: null
#     max_atoms: 25000  # Guardrail: if atom_count > max_atoms, heavy blocks are padded with reason_guardrail_skip
#     max_block_seconds: 60.0  # Time cap per block; on timeout, slot is padded with reason_timeout
#     enable_polar_block: true
#     polar_hbond_weight: true
#     polar_hbond_weight_factor: 0.5
#     polar_hbond_energy_cutoff: -0.5
#     polar_hbond_inter_only: false
#     enable_typed_block: true
#     dssp_timeout_seconds: 10.0
#     dssp_slow_threshold: 2.0
#     write_slot_maps: false  # If true, write work/topology_slot_maps/<pdb_id>.slot_map.json for debugging
#     max_topology_dim_allowed: null  # Optional safety: warn/fail if expected worst-case topo_dim exceeds this limit
#     fail_fast_topology_dim: false  # If true, raise error when expected worst-case topo_dim exceeds limit; otherwise warn only
#
# topology:
#   module: topology/persistence_laplacian_hybrid/v1  # alias: 140D PH (Betti 0 and Betti 1 topology summaries on interface coords) + 32D Laplacian = 172D
#   alias: "140D PH (Betti 0 and Betti 1 topology summaries on interface coords) + 32D Laplacian = 172D"
#   summary: "Persistent homology + Laplacian spectral moments per interface residue."
#   description: "Extends the 140D persistent homology descriptors with Laplacian spectral features computed on local interface residue graphs (cross-chain by default). Laplacian block includes per-eigen values, spectral stats, entropy, moments, and heat traces."
#   # dim: 172
#   params:
#     neighbor_distance: 8.0
#     filtration_cutoff: 8.0
#     min_persistence: 0.01
#     dedup_sort: false
#     element_filters:
#       - [C]
#       - [N]
#       - [O]
#       - [C, N]
#       - [C, O]
#       - [N, O]
#       - [C, N, O]
#     lap_graph_mode: cross_chain  # cross_chain (default) or all to include same-chain neighbors
#     lap_distance_cutoff: 8.0
#     lap_k_neighbors: null  # optional deterministic k-NN cap; otherwise cutoff-based
#     lap_edge_weight: gaussian  # gaussian (default, sigma ~ neighbor_distance/2), inverse, or binary
#     lap_sigma: 4.0
#     lap_eigs_count: 16
#     lap_moment_orders: [1, 2, 3, 4]
#     lap_heat_times: [0.1, 1.0, 5.0]
#     lap_include_entropy: true
#     lap_max_neighbors: 128  # cap neighborhood size (includes target residue)
#     lap_normalize: sym
#     jobs: 16
#
# topology:
#   module: topology/persistence_null/v1  # alias: Null topology (constant zeros) = 140D ablation
#   alias: "Null topology (constant zeros) = 140D ablation"
#   summary: "Topology ablation: constant features with PH-compatible schema."
#   description: "Writes per-residue constant vectors matching the baseline PH schema (default 140D) to enable no-topology ablation experiments without changing downstream dimensions or schemas."
#   # dim: 140
#   params:
#     element_filters:
#       - [C]
#       - [N]
#       - [O]
#       - [C, N]
#       - [C, O]
#       - [N, O]
#       - [C, N, O]
#     constant_value: 0.0  # Fill value for all topology features (default 0.0).
#     jobs: 16  # Optional worker override (simple IO-bound stage; sequential is usually fine).
#
# topology:
#   module: topology/persistence_partial_k_partite/v1  # alias: Part-aware PH (minimal/lean/heavy presets; cross-biased + cross-only default) = 420D (lean)
#   alias: "Part-aware PH (minimal/lean/heavy presets; cross-biased + cross-only default) = 420D (lean)"
#   summary: "Persistent homology with chain-aware blocks (cross-biased/cross-only) and optional per-chain/DSSP/polar blocks."
#   description: "Extends the basic PH module with part-aware variants: base PH (140D), cross-biased block (penalize intra-chain distances), cross-only block (inter-chain atoms only), optional per-chain PH (capped), optional DSSP-stratified block, and optional polar-only mini block. Presets: minimal (140D), lean (default, ~420D), heavy (adds opt-in blocks)."
#   # dim: 420
#   params:
#     preset: lean  # minimal=140D, lean=base+cross-biased+cross-only (~420D default), heavy=lean+optional per-chain/DSSP/polar
#     neighbor_distance: 8.0
#     filtration_cutoff: 8.0
#     min_persistence: 0.01
#     element_filters:
#       - [C]
#       - [N]
#       - [O]
#       - [C, N]
#       - [C, O]
#       - [N, O]
#       - [C, N, O]
#     dedup_sort: false
#     jobs: 16
#     enable_cross_bias: true
#     intra_penalty_mode: default  # default(=nd/2), light(=nd/4), heavy(=nd/1.34), none(=0), custom(use intra_penalty_lambda numeric)
#     intra_penalty_lambda: null  # Used only when intra_penalty_mode=custom; otherwise derived from neighbor_distance
#     enable_cross_only: true
#     enable_per_chain: false
#     max_chains: 2  # Only used when enable_per_chain=true; ignored otherwise
#     enable_dssp_block: false
#     enable_polar_block: false
#     polar_hbond_weight: false  # Toggle H-bond weighting for polar block (heavy only)
#     polar_hbond_weight_factor: 0.5  # Distance multiplier for H-bonded polar atoms (default=0.5)
#     polar_hbond_energy_cutoff: -0.5  # DSSP H-bond energy cutoff (kcal/mol) to consider bonded (default=-0.5)
#     polar_hbond_inter_only: false  # If true, only weight inter-chain H-bonded atoms in polar block
#     dssp_timeout_seconds: 10.0  # Per-PDB timeout for DSSP call (skip on exceed)
#     dssp_slow_threshold: 2.0  # Log a note if DSSP exceeds this time (seconds)
#     max_atoms: 25000  # Guardrail to skip heavy blocks; ignored for minimal/lean
#     max_block_seconds: 60.0  # Per-block time cap (s) for heavy blocks; ignored for minimal/lean
#
# topology:
#   module: topology/persistence_partial_k_partite/v1  # alias: Part-aware PH minimal (base only) = 140D
#   alias: "Part-aware PH minimal (base only) = 140D"
#   summary: "Persistent homology with chain-aware blocks (cross-biased/cross-only) and optional per-chain/DSSP/polar blocks."
#   description: "Extends the basic PH module with part-aware variants: base PH (140D), cross-biased block (penalize intra-chain distances), cross-only block (inter-chain atoms only), optional per-chain PH (capped), optional DSSP-stratified block, and optional polar-only mini block. Presets: minimal (140D), lean (default, ~420D), heavy (adds opt-in blocks)."
#   # dim: 140
#   params:
#     preset: minimal  # minimal=140D, lean=base+cross-biased+cross-only (~420D default), heavy=lean+optional per-chain/DSSP/polar
#     neighbor_distance: 8.0
#     filtration_cutoff: 8.0
#     min_persistence: 0.01
#     element_filters:
#       - [C]
#       - [N]
#       - [O]
#       - [C, N]
#       - [C, O]
#       - [N, O]
#       - [C, N, O]
#     dedup_sort: false
#     jobs: 16
#     enable_cross_bias: false
#     intra_penalty_mode: none  # none for minimal preset
#     intra_penalty_lambda: null  # Used only when intra_penalty_mode=custom; otherwise derived from neighbor_distance
#     enable_cross_only: false
#     enable_per_chain: false
#     max_chains: 2  # Only used when enable_per_chain=true; ignored otherwise
#     enable_dssp_block: false
#     enable_polar_block: false
#     polar_hbond_weight: false  # ignored for minimal preset
#     polar_hbond_weight_factor: 0.5  # ignored for minimal preset
#     polar_hbond_energy_cutoff: -0.5  # ignored for minimal preset
#     polar_hbond_inter_only: false  # ignored for minimal preset
#     dssp_timeout_seconds: 10.0  # ignored for minimal preset
#     dssp_slow_threshold: 2.0  # ignored for minimal preset
#     max_atoms: 25000  # Guardrail to skip heavy blocks; ignored for minimal/lean
#     max_block_seconds: 60.0  # Per-block time cap (s) for heavy blocks; ignored for minimal/lean
#
# topology:
#   module: topology/persistence_partial_k_partite/v1  # alias: Part-aware PH heavy (lean + optional per-chain/DSSP/polar) ≈ 420D+
#   alias: "Part-aware PH heavy (lean + optional per-chain/DSSP/polar) \u2248 420D+"
#   summary: "Persistent homology with chain-aware blocks (cross-biased/cross-only) and optional per-chain/DSSP/polar blocks."
#   description: "Extends the basic PH module with part-aware variants: base PH (140D), cross-biased block (penalize intra-chain distances), cross-only block (inter-chain atoms only), optional per-chain PH (capped), optional DSSP-stratified block, and optional polar-only mini block. Presets: minimal (140D), lean (default, ~420D), heavy (adds opt-in blocks)."
#   # dim: 420
#   params:
#     preset: heavy  # minimal=140D, lean=base+cross-biased+cross-only (~420D default), heavy=lean+optional per-chain/DSSP/polar
#     neighbor_distance: 8.0
#     filtration_cutoff: 8.0
#     min_persistence: 0.01
#     element_filters:
#       - [C]
#       - [N]
#       - [O]
#       - [C, N]
#       - [C, O]
#       - [N, O]
#       - [C, N, O]
#     dedup_sort: false
#     jobs: 16
#     enable_cross_bias: true
#     intra_penalty_mode: default  # default(=nd/2), light(=nd/4), heavy(=nd/1.34), none(=0), custom(use intra_penalty_lambda numeric)
#     intra_penalty_lambda: null  # Used only when intra_penalty_mode=custom; otherwise derived from neighbor_distance
#     enable_cross_only: true
#     enable_per_chain: true
#     max_chains: 2  # Only used when enable_per_chain=true; ignored otherwise
#     enable_dssp_block: true
#     enable_polar_block: true
#     polar_hbond_weight: false  # Toggle H-bond weighting for polar block (heavy only)
#     polar_hbond_weight_factor: 0.5  # Distance multiplier for H-bonded polar atoms (default=0.5)
#     polar_hbond_energy_cutoff: -0.5  # DSSP H-bond energy cutoff (kcal/mol) to consider bonded (default=-0.5)
#     polar_hbond_inter_only: false  # If true, only weight inter-chain H-bonded atoms in polar block
#     dssp_timeout_seconds: 10.0  # Per-PDB timeout for DSSP call (skip on exceed)
#     dssp_slow_threshold: 2.0  # Log a note if DSSP exceeds this time (seconds)
#     max_atoms: 25000  # Guardrail to skip heavy blocks; ignored for minimal/lean
#     max_block_seconds: 60.0  # Per-block time cap (s) for heavy blocks; ignored for minimal/lean
#
# topology:
#   module: topology/standalone_MoL_replace_topology/v1  # alias: Laplacian-only spectral topology (32 eigs, entropy+Fiedler+Kirchhoff, multi-scale 6/8/10 Å)
#   alias: "Laplacian-only spectral topology (32 eigs, entropy+Fiedler+Kirchhoff, multi-scale 6/8/10 \u00c5)"
#   summary: "Per-residue Laplacian spectral features (no PH): eigen blocks, stats, moments, heat traces, Fiedler, Kirchhoff; multi-scale defaults to 6/8/10 \u00c5."
#   description: "Builds Laplacian neighborhoods on interface residues and emits spectral summaries only (no persistent homology). Defaults to unweighted symmetric normalized Laplacian, 32 smallest nonzero eigenvalues, entropy, raw+centered moments, heat traces, Fiedler stats, and a Kirchhoff proxy. Defaults to multi-scale radii (6/8/10 \u00c5) to match or exceed PH richness; set lap_multi_radii=null for single-scale."
#   params:
#     neighbor_distance: 8.0  # single-scale cutoff (Å) when lap_multi_radii is null; default 8.0
#     lap_multi_radii: [6.0, 8.0, 10.0]  # multi-scale cutoffs; default [6.0, 8.0, 10.0] to concatenate 3 blocks; set null for single-scale
#     lap_k_neighbors: null  # optional deterministic k-NN cap; null uses distance cutoff only
#     lap_max_neighbors: 128  # hard cap on neighborhood size (includes target); guards cost
#     lap_estimator: exact  # exact for small neighborhoods; slq for faster moments when node_count > size_threshold
#     lap_size_threshold: 80  # switch to SLQ when node_count exceeds this
#     lap_slq_probes: 8  # SLQ probes (higher = more accurate, slower)
#     lap_slq_steps: 32  # SLQ Lanczos steps (higher = more accurate, slower)
#     lap_weight: unweighted  # unweighted (stable) default; gaussian uses sigma=cutoff/2; inverse = 1/d
#     lap_sigma: null  # only for gaussian weight; default to cutoff/2 when unset
#     lap_normalize: sym  # sym (default) or rw Laplacian
#     lap_eigs_count: 32  # default 32 for richness; 24 for leaner/faster
#     lap_heat_times: [0.1, 1.0, 5.0]  # heat trace times; shorter=local, longer=global
#     lap_include_entropy: true  # add spectral entropy (on by default)
#     lap_include_fiedler: true  # add Fiedler vector stats (on by default)
#     lap_include_kirchhoff: true  # add Kirchhoff/effective resistance proxy (on by default)
#     lap_use_centered_moments: true  # include centered moments k2-4 (on by default)
#     lap_profile: false  # log Laplacian timing per structure when true
#     jobs: 16
#
# topology:
#   module: topology/standalone_MoL_replace_topology/v1  # alias: Laplacian-only spectral topology (single-scale 8 Å, 32 eigs)
#   alias: "Laplacian-only spectral topology (single-scale 8 \u00c5, 32 eigs)"
#   summary: "Per-residue Laplacian spectral features (no PH): eigen blocks, stats, moments, heat traces, Fiedler, Kirchhoff; multi-scale defaults to 6/8/10 \u00c5."
#   description: "Builds Laplacian neighborhoods on interface residues and emits spectral summaries only (no persistent homology). Defaults to unweighted symmetric normalized Laplacian, 32 smallest nonzero eigenvalues, entropy, raw+centered moments, heat traces, Fiedler stats, and a Kirchhoff proxy. Defaults to multi-scale radii (6/8/10 \u00c5) to match or exceed PH richness; set lap_multi_radii=null for single-scale."
#   params:
#     neighbor_distance: 8.0
#     lap_multi_radii: null
#     lap_k_neighbors: null
#     lap_max_neighbors: 128
#     lap_estimator: exact
#     lap_size_threshold: 80
#     lap_slq_probes: 8
#     lap_slq_steps: 32
#     lap_weight: unweighted
#     lap_sigma: null
#     lap_normalize: sym
#     lap_eigs_count: 32
#     lap_heat_times: [0.1, 1.0, 5.0]
#     lap_include_entropy: true
#     lap_include_fiedler: true
#     lap_include_kirchhoff: true
#     lap_use_centered_moments: true
#     lap_profile: false
#     jobs: 16
#

# REQUIRED stage: node
node:
  module: node/dssp_topo_merge/v1  # alias: 140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA
  alias: "140D PH (topology summaries on interface coords) + 32D DSSP = Node 172D | TopoQA"
  summary: "DSSP-derived node features merged with topology statistics."
  description: "Runs the DSSP-based node feature extractor (node_fea) and merges results with persistent homology statistics aligned by residue IDs."
  # dim: 172
  params:
    drop_na: true  # Drop rows with NA after merge (default on); matches fea_df_clean behavior in inference.
    jobs: 16  # Optional worker override (CLI --jobs takes precedence over config/module default).

# Alternate node modules (uncomment to use):
# node:
#   module: node/dssp_topo_merge_passthrough/v1  # alias: Passthrough (all dims from topology module) + 32D DSSP = Node Dynamic Dims
#   alias: "Passthrough (all dims from topology module) + 32D DSSP = Node Dynamic Dims"
#   summary: "DSSP/basic features merged with all topology columns (passthrough)."
#   description: "Runs DSSP/basic feature extraction and merges with the provided topology CSV using all non-ID topology columns (no hardcoded list). Topology columns are MinMax scaled per file; output columns ordered as ID, DSSP/basic 32D, then topology columns in file order. Suitable for hybrid topology (PH+Lap) or any dynamic topo layout."
#   params:
#     drop_na: true  # Drop rows with NA after merge (default on); aligns with inference cleaning.
#     jobs: 16  # Optional worker override (CLI --jobs takes precedence).
#

# REQUIRED stage: edge
edge:
  module: edge/legacy_band/v11  # alias: 10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA
  alias: "10D atomic distances between two residues + 1D distance between C (alpha) = Edge 11D | TopoQA"
  summary: "11-D legacy edge features (distance + atom distance histogram)."
  description: "Reproduces the original 11-dimensional edge attributes consisting of residue pair distance and a 10-bin histogram of inter-atomic distances, scaled to [0, 1]."
  # dim: 11
  params:
    distance_min: 0.0  # Minimum Cα distance (Å) to include an edge; must be < distance_max
    distance_max: 10.0  # Maximum Cα distance (Å) to include an edge (default 10.0 Å)
    scale_features: true  # MinMax scale distance+histogram columns per graph (default on)
    jobs: 16  # Optional override for worker count (CLI --jobs takes precedence)

# Alternate edge modules (uncomment to use):
# edge:
#   module: edge/edge_plus_bal_agg_lap_hybrid/v1  # alias: Legacy 11D Edge + 691D {(hist + agg + norms + cosine) from 172D laplacian_hybrid} = Edge 702D (Lean) | Legacy 11D Edge + 1035D {(hist + agg + norms + cosine + minmax) from laplacian_hybrid} = Edge 1046D (Heavy)
#   alias: "Legacy 11D Edge + 691D {(hist + agg + norms + cosine) from 172D laplacian_hybrid} = Edge 702D (Lean) | Legacy 11D Edge + 1035D {(hist + agg + norms + cosine + minmax) from laplacian_hybrid} = Edge 1046D (Heavy)"
#   summary: "Legacy 11D histogram + hybrid balanced topo agg (PH+Lap 172D)."
#   description: "Same aggregation as edge_plus_bal_agg_topo/v1, intended for use with topology/persistence_laplacian_hybrid/v1 (per-residue PH + Laplacian vectors, expected topo_dim\u2248172). Prepends the legacy 11D distance histogram, then concatenates (u_topo, v_topo, mean(u,v), |u-v|) with optional norms/cosine; heavy variant adds per-dimension min/max. Preserves deterministic edge ordering (src_idx, dst_idx, distance)."
#   # dim: 702
#   params:
#     distance_min: 0.0  # Cα distance window start; edges with distance <= min are skipped
#     distance_max: 10.0  # Cα distance window end; edges with distance >= max are skipped
#     scale_histogram: true  # Scale only the legacy 11D (distance + 10-bin) block across each graph
#     include_norms: true  # Add L2 norms of endpoint topology vectors (PH+Lap 172D)
#     include_cosine: true  # Add cosine similarity between endpoint topology vectors
#     include_minmax: false  # heavy variant only; adds per-dimension min/max blocks
#     variant: lean  # lean or heavy; heavy adds per-dimension min/max blocks
#     jobs: 16  # Honors CLI --jobs > config default_jobs > module jobs; deterministic ordering; dumps resorted by edge_runner
#
# edge:
#   module: edge/edge_plus_bal_agg_lap_hybrid/v1  # alias: Legacy 11D Edge + 691D {(hist + agg + norms + cosine) from 172D laplacian_hybrid} = Edge 702D (Lean) | Legacy 11D Edge + 1035D {(hist + agg + norms + cosine + minmax) from laplacian_hybrid} = Edge 1046D (Heavy)
#   alias: "Legacy 11D Edge + 691D {(hist + agg + norms + cosine) from 172D laplacian_hybrid} = Edge 702D (Lean) | Legacy 11D Edge + 1035D {(hist + agg + norms + cosine + minmax) from laplacian_hybrid} = Edge 1046D (Heavy)"
#   summary: "Legacy 11D histogram + hybrid balanced topo agg (PH+Lap 172D)."
#   description: "Same aggregation as edge_plus_bal_agg_topo/v1, intended for use with topology/persistence_laplacian_hybrid/v1 (per-residue PH + Laplacian vectors, expected topo_dim\u2248172). Prepends the legacy 11D distance histogram, then concatenates (u_topo, v_topo, mean(u,v), |u-v|) with optional norms/cosine; heavy variant adds per-dimension min/max. Preserves deterministic edge ordering (src_idx, dst_idx, distance)."
#   # dim: 1046
#   params:
#     distance_min: 0.0  # Cα distance window start; edges with distance <= min are skipped
#     distance_max: 10.0  # Cα distance window end; edges with distance >= max are skipped
#     scale_histogram: true  # Scale only the legacy 11D (distance + 10-bin) block across each graph
#     include_norms: true  # Add L2 norms of endpoint topology vectors (PH+Lap 172D)
#     include_cosine: true  # Add cosine similarity between endpoint topology vectors
#     include_minmax: true  # heavy variant only; adds per-dimension min/max blocks
#     variant: heavy  # lean or heavy; heavy adds per-dimension min/max blocks
#     jobs: 16  # Honors CLI --jobs > config default_jobs > module jobs; deterministic ordering; dumps resorted by edge_runner
#
# edge:
#   module: edge/edge_plus_bal_agg_topo/v1  # alias: Legacy 11D Edge + 563D {(norm + cosine) from 140D PH} = Edge 574D (Lean) | Legacy 11D Edge + 843D {(norm + cosine + minmax) from 140D PH} = Edge 854D (Heavy)
#   alias: "Legacy 11D Edge + 563D {(norm + cosine) from 140D PH} = Edge 574D (Lean) | Legacy 11D Edge + 843D {(norm + cosine + minmax) from 140D PH} = Edge 854D (Heavy)"
#   summary: "Legacy 11D histogram plus balanced topo concat+mean+abs-diff+cosine (lean)."
#   description: "Reuses per-residue topology vectors to build edge features without rerunning persistence. For each cross-chain edge, concatenates (u_topo, v_topo, mean(u,v), |u-v|) and appends cosine similarity and optional endpoint norms. Legacy 11D histogram (distance + 10-bin atom distance histogram) is prepended. Deterministic edge ordering is preserved (src_idx, dst_idx, distance)."
#   # dim: 574
#   params:
#     distance_min: 0.0  # Minimum Cα distance (Å); must be < distance_max
#     distance_max: 10.0  # Maximum Cα distance (Å) to include an edge (default 10.0 Å)
#     scale_histogram: true  # MinMax scale only the legacy distance+histogram block (default on)
#     include_norms: true  # Include L2 norms of endpoint topology vectors (default on)
#     include_cosine: true  # Include cosine similarity between endpoint topology vectors (default on)
#     include_minmax: false  # heavy variant only; adds per-dimension min/max blocks
#     variant: lean  # Aggregation variant: lean (default) or heavy (adds min/max block)
#     jobs: 16  # Honors CLI --jobs > config default_jobs > module jobs; deterministic ordering; dumps resorted by edge_runner
#
# edge:
#   module: edge/edge_plus_bal_agg_topo/v1  # alias: Legacy 11D Edge + 563D {(norm + cosine) from 140D PH} = Edge 574D (Lean) | Legacy 11D Edge + 843D {(norm + cosine + minmax) from 140D PH} = Edge 854D (Heavy)
#   alias: "Legacy 11D Edge + 563D {(norm + cosine) from 140D PH} = Edge 574D (Lean) | Legacy 11D Edge + 843D {(norm + cosine + minmax) from 140D PH} = Edge 854D (Heavy)"
#   summary: "Legacy 11D histogram plus balanced topo concat+mean+abs-diff+cosine (lean)."
#   description: "Reuses per-residue topology vectors to build edge features without rerunning persistence. For each cross-chain edge, concatenates (u_topo, v_topo, mean(u,v), |u-v|) and appends cosine similarity and optional endpoint norms. Legacy 11D histogram (distance + 10-bin atom distance histogram) is prepended. Deterministic edge ordering is preserved (src_idx, dst_idx, distance)."
#   # dim: 854
#   params:
#     distance_min: 0.0  # Minimum Cα distance (Å); must be < distance_max
#     distance_max: 10.0  # Maximum Cα distance (Å) to include an edge (default 10.0 Å)
#     scale_histogram: true  # MinMax scale only the legacy distance+histogram block (default on)
#     include_norms: true  # Include L2 norms of endpoint topology vectors (default on)
#     include_cosine: true  # Include cosine similarity between endpoint topology vectors (default on)
#     include_minmax: true  # heavy variant only; adds per-dimension min/max blocks
#     variant: heavy  # Aggregation variant: lean (default) or heavy (adds min/max block)
#     jobs: 16  # Honors CLI --jobs > config default_jobs > module jobs; deterministic ordering; dumps resorted by edge_runner
#
# edge:
#   module: edge/edge_plus_lightweight_MoL/v1  # alias: Legacy 11D Edge + 5D unweighted Lap moments (mu1-3, kappa2, kappa3) on pair neighborhood = Edge 16D (lean MoL)
#   alias: "Legacy 11D Edge + 5D unweighted Lap moments (mu1-3, kappa2, kappa3) on pair neighborhood = Edge 16D (lean MoL)"
#   summary: "Legacy histogram plus lean Laplacian moment context on the induced bipartite pair neighborhood (unweighted)."
#   description: "Prepends the legacy 11D distance histogram, then adds 5D unweighted normalized-Laplacian moments (mu1-3, kappa2, kappa3) on the induced bipartite neighborhood of each inter-chain edge (0-10 A window). Uses exact eigs when nodes <= size_threshold (80), otherwise SLQ (probes=8, steps=32). Deterministic ordering; optional CSV dumps."
#   # dim: 16
#   params:
#     distance_min: 0.0  # Cα distance window start; edges with distance <= min are skipped
#     distance_max: 10.0  # Cα distance window end; edges with distance >= max are skipped
#     scale_histogram: true  # Scale only the legacy 11D (distance + 10-bin) block across each graph
#     lap_size_threshold: 80  # Node-count threshold for switching from exact eigs to SLQ (default 80)
#     lap_estimator: exact  # exact (default) or slq
#     lap_slq_probes: 8  # Probe vectors for SLQ (default 8)
#     lap_slq_steps: 32  # Lanczos steps placeholder (default 32; kept for compatibility)
#     lap_max_neighbors: 128  # Cap neighborhood size for Laplacian context (includes endpoints)
#     lap_profile: false  # Profile Laplacian moment wall time (writes to metadata)
#     jobs: 16  # Honors CLI --jobs > config default_jobs > module jobs; edge ordering deterministic; dumps resorted by edge_runner
#
# edge:
#   module: edge/edge_plus_min_agg_lap_hybrid/v1  # alias: Legacy 11D Edge + 519D {(hist + agg + norms + cosine) from 172D laplacian_hybrid} = Edge 530D (Lean) | Legacy 11D Edge + 863D {(hist + agg + norms + cosine + minmax) from laplacian_hybrid} = Edge 874D (Heavy)
#   alias: "Legacy 11D Edge + 519D {(hist + agg + norms + cosine) from 172D laplacian_hybrid} = Edge 530D (Lean) | Legacy 11D Edge + 863D {(hist + agg + norms + cosine + minmax) from laplacian_hybrid} = Edge 874D (Heavy)"
#   summary: "Legacy 11D histogram + hybrid topo concat/abs-diff (PH+Lap 172D)."
#   description: "Same aggregation as edge_plus_min_agg_topo/v1, intended for use with topology/persistence_laplacian_hybrid/v1 (per-residue PH + Laplacian vectors, expected topo_dim\u2248172). Concatenates (u_topo, v_topo, |u-v|) and optional norms/cosine; heavy variant adds min/max. Prepends the legacy 11D distance histogram and preserves deterministic edge ordering (src_idx, dst_idx, distance)."
#   # dim: 530
#   params:
#     distance_min: 0.0  # Cα distance window start; edges with distance <= min are skipped
#     distance_max: 10.0  # Cα distance window end; edges with distance >= max are skipped
#     scale_histogram: true  # Scale only the legacy 11D (distance + 10-bin) block across each graph
#     include_norms: true  # Add L2 norms of endpoint topology vectors (PH+Lap 172D)
#     include_cosine: true  # Add cosine similarity between endpoint topology vectors
#     include_minmax: false  # heavy variant only; adds per-dimension min/max blocks
#     variant: lean  # lean or heavy; heavy adds per-dimension min/max blocks
#     jobs: 16  # Honors CLI --jobs > config default_jobs > module jobs; deterministic ordering; dumps resorted by edge_runner
#
# edge:
#   module: edge/edge_plus_min_agg_lap_hybrid/v1  # alias: Legacy 11D Edge + 519D {(hist + agg + norms + cosine) from 172D laplacian_hybrid} = Edge 530D (Lean) | Legacy 11D Edge + 863D {(hist + agg + norms + cosine + minmax) from laplacian_hybrid} = Edge 874D (Heavy)
#   alias: "Legacy 11D Edge + 519D {(hist + agg + norms + cosine) from 172D laplacian_hybrid} = Edge 530D (Lean) | Legacy 11D Edge + 863D {(hist + agg + norms + cosine + minmax) from laplacian_hybrid} = Edge 874D (Heavy)"
#   summary: "Legacy 11D histogram + hybrid topo concat/abs-diff (PH+Lap 172D)."
#   description: "Same aggregation as edge_plus_min_agg_topo/v1, intended for use with topology/persistence_laplacian_hybrid/v1 (per-residue PH + Laplacian vectors, expected topo_dim\u2248172). Concatenates (u_topo, v_topo, |u-v|) and optional norms/cosine; heavy variant adds min/max. Prepends the legacy 11D distance histogram and preserves deterministic edge ordering (src_idx, dst_idx, distance)."
#   # dim: 874
#   params:
#     distance_min: 0.0  # Cα distance window start; edges with distance <= min are skipped
#     distance_max: 10.0  # Cα distance window end; edges with distance >= max are skipped
#     scale_histogram: true  # Scale only the legacy 11D (distance + 10-bin) block across each graph
#     include_norms: true  # Add L2 norms of endpoint topology vectors (PH+Lap 172D)
#     include_cosine: true  # Add cosine similarity between endpoint topology vectors
#     include_minmax: true  # heavy variant only; adds per-dimension min/max blocks
#     variant: heavy  # lean or heavy; heavy adds per-dimension min/max blocks
#     jobs: 16  # Honors CLI --jobs > config default_jobs > module jobs; deterministic ordering; dumps resorted by edge_runner
#
# edge:
#   module: edge/edge_plus_min_agg_topo/v1  # alias: Legacy 11D Edge + 423D {(norm + cosine) from 140D PH} = Edge 434D (Lean) | Legacy 11D Edge + 703D {(norm + cosine + minmax) from 140D PH} = Edge 714D (Heavy)
#   alias: "Legacy 11D Edge + 423D {(norm + cosine) from 140D PH} = Edge 434D (Lean) | Legacy 11D Edge + 703D {(norm + cosine + minmax) from 140D PH} = Edge 714D (Heavy)"
#   summary: "Legacy 11D histogram plus per-residue topology concat+abs-diff+cosine (lean)."
#   description: "Reuses per-residue topology vectors to build edge features without rerunning persistence. For each cross-chain edge, concatenates (u_topo, v_topo, |u-v|) and appends cosine similarity and optional endpoint norms. Legacy 11D histogram (distance + 10-bin atom distance histogram) is prepended. Deterministic edge ordering is preserved (src_idx, dst_idx, distance)."
#   # dim: 434
#   params:
#     distance_min: 0.0  # Minimum Cα distance (Å); must be < distance_max
#     distance_max: 10.0  # Maximum Cα distance (Å) to include an edge (default 10.0 Å)
#     scale_histogram: true  # MinMax scale only the legacy distance+histogram block (default on)
#     include_norms: true  # Include L2 norms of endpoint topology vectors (default on)
#     include_cosine: true  # Include cosine similarity between endpoint topology vectors (default on)
#     include_minmax: false  # heavy variant only; adds per-dimension min/max blocks
#     variant: lean  # lean (default) or heavy (adds min/max block)
#     jobs: 16  # Optional worker override (CLI --jobs takes precedence)
#
# edge:
#   module: edge/edge_plus_min_agg_topo/v1  # alias: Legacy 11D Edge + 423D {(norm + cosine) from 140D PH} = Edge 434D (Lean) | Legacy 11D Edge + 703D {(norm + cosine + minmax) from 140D PH} = Edge 714D (Heavy)
#   alias: "Legacy 11D Edge + 423D {(norm + cosine) from 140D PH} = Edge 434D (Lean) | Legacy 11D Edge + 703D {(norm + cosine + minmax) from 140D PH} = Edge 714D (Heavy)"
#   summary: "Legacy 11D histogram plus per-residue topology concat+abs-diff+cosine (lean)."
#   description: "Reuses per-residue topology vectors to build edge features without rerunning persistence. For each cross-chain edge, concatenates (u_topo, v_topo, |u-v|) and appends cosine similarity and optional endpoint norms. Legacy 11D histogram (distance + 10-bin atom distance histogram) is prepended. Deterministic edge ordering is preserved (src_idx, dst_idx, distance)."
#   # dim: 714
#   params:
#     distance_min: 0.0  # Minimum Cα distance (Å); must be < distance_max
#     distance_max: 10.0  # Maximum Cα distance (Å) to include an edge (default 10.0 Å)
#     scale_histogram: true  # MinMax scale only the legacy distance+histogram block (default on)
#     include_norms: true  # Include L2 norms of endpoint topology vectors (default on)
#     include_cosine: true  # Include cosine similarity between endpoint topology vectors (default on)
#     include_minmax: true  # heavy variant only; adds per-dimension min/max blocks
#     variant: heavy  # lean (default) or heavy (adds min/max block)
#     jobs: 16  # Optional worker override (CLI --jobs takes precedence)
#
# edge:
#   module: edge/edge_plus_pool_agg_lap_hybrid/v1  # alias: Legacy 11D Edge + 1382D {(hist + endpoint agg + pooled agg) from 172D laplacian_hybrid} = Edge 1393D (Lean) | Legacy 11D Edge + 2070D {(hist + endpoint agg + pooled agg + minmax) from laplacian_hybrid} = Edge 2081D (Heavy)
#   alias: "Legacy 11D Edge + 1382D {(hist + endpoint agg + pooled agg) from 172D laplacian_hybrid} = Edge 1393D (Lean) | Legacy 11D Edge + 2070D {(hist + endpoint agg + pooled agg + minmax) from laplacian_hybrid} = Edge 2081D (Heavy)"
#   summary: "Legacy 11D histogram + hybrid pooled topo agg (PH+Lap 172D)."
#   description: "Same aggregation as edge_plus_pool_agg_topo/v1, intended for use with topology/persistence_laplacian_hybrid/v1 (per-residue PH + Laplacian vectors, expected topo_dim\u2248172). Prepends the legacy 11D distance histogram, then applies balanced aggregation on endpoints and pooled neighbor means (concat, mean, abs-diff, optional norms/cosine); heavy variant adds per-dimension min/max. Deterministic edge ordering (src_idx, dst_idx, distance) preserved."
#   # dim: 1393
#   params:
#     distance_min: 0.0  # Cα distance window start; edges with distance <= min are skipped
#     distance_max: 10.0  # Cα distance window end; edges with distance >= max are skipped
#     scale_histogram: true  # Scale only the legacy 11D (distance + 10-bin) block across each graph
#     include_norms: true  # Add L2 norms of endpoint and pooled topology vectors (PH+Lap 172D)
#     include_cosine: true  # Add cosine similarities for endpoint and pooled topology vectors
#     pool_k: 5  # Nearest interface residues pooled per endpoint (default 5); larger k increases cost
#     include_minmax: false  # heavy variant only; adds per-dimension min/max blocks to endpoint and pooled agg
#     variant: lean  # lean or heavy; heavy adds per-dimension min/max blocks to endpoint and pooled agg
#     jobs: 16  # Honors CLI --jobs > config default_jobs > module jobs; deterministic ordering; dumps resorted by edge_runner
#
# edge:
#   module: edge/edge_plus_pool_agg_lap_hybrid/v1  # alias: Legacy 11D Edge + 1382D {(hist + endpoint agg + pooled agg) from 172D laplacian_hybrid} = Edge 1393D (Lean) | Legacy 11D Edge + 2070D {(hist + endpoint agg + pooled agg + minmax) from laplacian_hybrid} = Edge 2081D (Heavy)
#   alias: "Legacy 11D Edge + 1382D {(hist + endpoint agg + pooled agg) from 172D laplacian_hybrid} = Edge 1393D (Lean) | Legacy 11D Edge + 2070D {(hist + endpoint agg + pooled agg + minmax) from laplacian_hybrid} = Edge 2081D (Heavy)"
#   summary: "Legacy 11D histogram + hybrid pooled topo agg (PH+Lap 172D)."
#   description: "Same aggregation as edge_plus_pool_agg_topo/v1, intended for use with topology/persistence_laplacian_hybrid/v1 (per-residue PH + Laplacian vectors, expected topo_dim\u2248172). Prepends the legacy 11D distance histogram, then applies balanced aggregation on endpoints and pooled neighbor means (concat, mean, abs-diff, optional norms/cosine); heavy variant adds per-dimension min/max. Deterministic edge ordering (src_idx, dst_idx, distance) preserved."
#   # dim: 2081
#   params:
#     distance_min: 0.0  # Cα distance window start; edges with distance <= min are skipped
#     distance_max: 10.0  # Cα distance window end; edges with distance >= max are skipped
#     scale_histogram: true  # Scale only the legacy 11D (distance + 10-bin) block across each graph
#     include_norms: true  # Add L2 norms of endpoint and pooled topology vectors (PH+Lap 172D)
#     include_cosine: true  # Add cosine similarities for endpoint and pooled topology vectors
#     pool_k: 5  # Nearest interface residues pooled per endpoint (default 5); larger k increases cost
#     include_minmax: true  # heavy variant only; adds per-dimension min/max blocks to endpoint and pooled agg
#     variant: heavy  # lean or heavy; heavy adds per-dimension min/max blocks to endpoint and pooled agg
#     jobs: 16  # Honors CLI --jobs > config default_jobs > module jobs; deterministic ordering; dumps resorted by edge_runner
#
# edge:
#   module: edge/edge_plus_pool_agg_topo/v1  # alias: Legacy 11D Edge + 1126D {(hist + endpoint agg + pooled agg) from 140D PH} = Edge 1137D (Lean) | Legacy 11D Edge + 1686D {(hist + endpoint agg + pooled agg + minmax) from 140D PH} = Edge 1697D (Heavy)
#   alias: "Legacy 11D Edge + 1126D {(hist + endpoint agg + pooled agg) from 140D PH} = Edge 1137D (Lean) | Legacy 11D Edge + 1686D {(hist + endpoint agg + pooled agg + minmax) from 140D PH} = Edge 1697D (Heavy)"
#   summary: "Legacy 11D histogram plus balanced topo agg with pooled neighbor means (lean)."
#   description: "Extends balanced aggregation by adding pooled neighbor topology means per endpoint (k-nearest), then computing mean/abs-diff/cosine (and optional norms) on both endpoints and pooled summaries. Legacy 11D histogram (distance + 10-bin atom distance histogram) is prepended. Deterministic edge ordering is preserved (src_idx, dst_idx, distance)."
#   # dim: 1137
#   params:
#     distance_min: 0.0  # Cα distance window start; edges with distance <= min are skipped
#     distance_max: 10.0  # Cα distance window end; edges with distance >= max are skipped
#     scale_histogram: true  # scale only the legacy 11D (distance + 10-bin) block across each graph
#     include_norms: true  # add L2 norms of endpoint and pooled topo vectors
#     include_cosine: true  # add cosine similarities for endpoint and pooled topo vectors
#     pool_k: 5  # nearest interface residues pooled per endpoint (default 5); larger k increases cost/feature coupling
#     include_minmax: false  # heavy variant only; adds per-dimension min/max blocks to endpoint and pooled agg
#     variant: lean  # lean or heavy; heavy adds min/max blocks to both endpoint and pooled aggs
#     jobs: 16  # honors CLI --jobs > config defaults > module jobs; edge ordering deterministic (src,dst,distance); dumps resorted by edge_runner
#
# edge:
#   module: edge/edge_plus_pool_agg_topo/v1  # alias: Legacy 11D Edge + 1126D {(hist + endpoint agg + pooled agg) from 140D PH} = Edge 1137D (Lean) | Legacy 11D Edge + 1686D {(hist + endpoint agg + pooled agg + minmax) from 140D PH} = Edge 1697D (Heavy)
#   alias: "Legacy 11D Edge + 1126D {(hist + endpoint agg + pooled agg) from 140D PH} = Edge 1137D (Lean) | Legacy 11D Edge + 1686D {(hist + endpoint agg + pooled agg + minmax) from 140D PH} = Edge 1697D (Heavy)"
#   summary: "Legacy 11D histogram plus balanced topo agg with pooled neighbor means (lean)."
#   description: "Extends balanced aggregation by adding pooled neighbor topology means per endpoint (k-nearest), then computing mean/abs-diff/cosine (and optional norms) on both endpoints and pooled summaries. Legacy 11D histogram (distance + 10-bin atom distance histogram) is prepended. Deterministic edge ordering is preserved (src_idx, dst_idx, distance)."
#   # dim: 1697
#   params:
#     distance_min: 0.0  # Cα distance window start; edges with distance <= min are skipped
#     distance_max: 10.0  # Cα distance window end; edges with distance >= max are skipped
#     scale_histogram: true  # scale only the legacy 11D (distance + 10-bin) block across each graph
#     include_norms: true  # add L2 norms of endpoint and pooled topo vectors
#     include_cosine: true  # add cosine similarities for endpoint and pooled topo vectors
#     pool_k: 5  # nearest interface residues pooled per endpoint (default 5); larger k increases cost/feature coupling
#     include_minmax: true  # heavy variant only; adds per-dimension min/max blocks to endpoint and pooled agg
#     variant: heavy  # lean or heavy; heavy adds min/max blocks to both endpoint and pooled aggs
#     jobs: 16  # honors CLI --jobs > config defaults > module jobs; edge ordering deterministic (src,dst,distance); dumps resorted by edge_runner
#

# OPTIONAL custom stages ------------------------------------------------
# Add new top-level keys (e.g., `mol`) only if the builder has logic to process them.
# Each custom block must still follow the `module` + `params` structure shown above.
# Example:
# mol:
#   module: custom/mol_stage/v1
#   params: {}
